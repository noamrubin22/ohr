/*! For license information please see main.295907cf.js.LICENSE.txt */
!function(){var e={2600:function(e,t,r){"use strict";r.r(t),r.d(t,{AccountNameRequiredError:function(){return p},AccountNotSupported:function(){return m},AmountRequired:function(){return g},BluetoothRequired:function(){return y},BtcUnmatchedApp:function(){return v},CantOpenDevice:function(){return _},CantScanQRCode:function(){return qe},CashAddrNotSupported:function(){return b},CurrencyNotSupported:function(){return x},DBNotReset:function(){return ct},DBWrongPassword:function(){return ut},DeviceAppVerifyNotSupported:function(){return w},DeviceExtractOnboardingStateError:function(){return L},DeviceGenuineSocketEarlyClose:function(){return k},DeviceHalted:function(){return M},DeviceInOSUExpected:function(){return T},DeviceNameInvalid:function(){return I},DeviceNotGenuineError:function(){return A},DeviceOnDashboardExpected:function(){return E},DeviceOnDashboardUnexpected:function(){return S},DeviceOnboardingStatePollingError:function(){return O},DeviceShouldStayInApp:function(){return je},DeviceSocketFail:function(){return P},DeviceSocketNoBulkStatus:function(){return C},DisconnectedDevice:function(){return D},DisconnectedDeviceDuringOperation:function(){return R},DustLimit:function(){return $e},ETHAddressNonEIP:function(){return He},EnpointConfigError:function(){return z},EthAppPleaseEnableContractData:function(){return N},FeeEstimationFailed:function(){return U},FeeNotLoaded:function(){return Ye},FeeRequired:function(){return Xe},FeeTooHigh:function(){return Qe},FirmwareNotRecognized:function(){return Z},FirmwareOrAppUpdateRequired:function(){return ot},GasLessThanEstimate:function(){return pe},GenuineCheckFailed:function(){return rt},HardResetFail:function(){return F},HwTransportError:function(){return lt},HwTransportErrorType:function(){return f},InvalidAddress:function(){return V},InvalidAddressBecauseDestinationIsAlsoSource:function(){return W},InvalidXRPTag:function(){return j},LanguageNotFound:function(){return at},LatestMCUInstalledError:function(){return K},LedgerAPI4xx:function(){return nt},LedgerAPI5xx:function(){return it},LedgerAPIError:function(){return H},LedgerAPIErrorWithMessage:function(){return q},LedgerAPINotAvailable:function(){return Y},LockedDeviceError:function(){return B},MCUNotGenuineToDashboard:function(){return Ee},ManagerAppAlreadyInstalledError:function(){return X},ManagerAppDepInstallRequired:function(){return $},ManagerAppDepUninstallRequired:function(){return J},ManagerAppRelyOnBTCError:function(){return Q},ManagerDeviceLockedError:function(){return ee},ManagerFirmwareNotEnoughSpaceError:function(){return te},ManagerNotEnoughSpaceError:function(){return re},ManagerUninstallBTCDep:function(){return ne},MaxFeeTooLow:function(){return ve},NetworkDown:function(){return ie},NoAccessToCamera:function(){return he},NoAddressesFound:function(){return oe},NoDBPathGiven:function(){return st},NotEnoughBalance:function(){return ae},NotEnoughBalanceBecauseDestinationNotCreated:function(){return le},NotEnoughBalanceInParentAccount:function(){return ue},NotEnoughBalanceToDelegate:function(){return se},NotEnoughGas:function(){return fe},NotEnoughSpendableBalance:function(){return ce},NotSupportedLegacyAddress:function(){return de},PairingFailed:function(){return tt},PasswordIncorrectError:function(){return be},PasswordsDontMatchError:function(){return _e},PendingOperation:function(){return Je},PriorityFeeHigherThanMaxFee:function(){return ye},PriorityFeeTooHigh:function(){return ge},PriorityFeeTooLow:function(){return me},RecipientRequired:function(){return Se},RecommendSubAccountsToEmpty:function(){return xe},RecommendUndelegation:function(){return we},StatusCodes:function(){return ft},SyncError:function(){return et},TimeoutTagged:function(){return ke},TransportError:function(){return ht},TransportInterfaceNotAvailable:function(){return Ue},TransportOpenUserCancelled:function(){return Ne},TransportRaceCondition:function(){return Ze},TransportStatusError:function(){return pt},TransportWebUSBGestureRequired:function(){return Fe},UnavailableTezosOriginatedAccountReceive:function(){return Te},UnavailableTezosOriginatedAccountSend:function(){return Me},UnexpectedBootloader:function(){return Ae},UnknownMCU:function(){return G},UpdateFetchFileFail:function(){return Ie},UpdateIncorrectHash:function(){return Pe},UpdateIncorrectSig:function(){return Ce},UpdateYourApp:function(){return Be},UserRefusedAddress:function(){return Re},UserRefusedAllowManager:function(){return Oe},UserRefusedDeviceNameChange:function(){return De},UserRefusedFirmwareUpdate:function(){return Le},UserRefusedOnDevice:function(){return ze},WebsocketConnectionError:function(){return Ve},WebsocketConnectionFailed:function(){return We},WrongAppForCurrency:function(){return Ge},WrongDeviceForAccount:function(){return Ke},addCustomErrorDeserializer:function(){return s},createCustomErrorClass:function(){return u},deserializeError:function(){return c},getAltStatusMessage:function(){return dt},serializeError:function(){return l}});var n=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!==typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),i=function(e){var t="function"===typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},o={},a={},s=function(e,t){a[e]=t},u=function(e){var t=function(t){function r(n,i,o){var a=t.call(this,n||e,o)||this;if(Object.setPrototypeOf(a,r.prototype),a.name=e,i)for(var s in i)a[s]=i[s];if(o&&"object"===typeof o&&"cause"in o&&!("cause"in a)){var u=o.cause;a.cause=u,"stack"in u&&(a.stack=a.stack+"\nCAUSE: "+u.stack)}return a}return n(r,t),r}(Error);return o[e]=t,t};var c=function e(t){if(t&&"object"===typeof t){try{if("string"===typeof t.message){var r=JSON.parse(t.message);r.message&&r.name&&(t=r)}}catch(h){}var n=void 0;if("string"===typeof t.name){var i=t.name,s=a[i];if(s)n=s(t);else{var c="Error"===i?Error:o[i];c||(console.warn("deserializing an unknown class '"+i+"'"),c=u(i)),n=Object.create(c.prototype);try{for(var l in t)t.hasOwnProperty(l)&&(n[l]=t[l])}catch(h){}}}else"string"===typeof t.message&&(n=new Error(t.message));return n&&!n.stack&&Error.captureStackTrace&&Error.captureStackTrace(n,e),n}return new Error(String(t))},l=function(e){return e?"object"===typeof e?h(e,[]):"function"===typeof e?"[Function: ".concat(e.name||"anonymous","]"):e:e};function h(e,t){var r,n,o={};t.push(e);try{for(var a=i(Object.keys(e)),s=a.next();!s.done;s=a.next()){var u=s.value,c=e[u];"function"!==typeof c&&(c&&"object"===typeof c?-1!==t.indexOf(e[u])?o[u]="[Circular]":o[u]=h(e[u],t.slice(0)):o[u]=c)}}catch(l){r={error:l}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(r)throw r.error}}return"string"===typeof e.name&&(o.name=e.name),"string"===typeof e.message&&(o.message=e.message),"string"===typeof e.stack&&(o.stack=e.stack),o}var f,d=function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!==typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),p=u("AccountNameRequired"),m=u("AccountNotSupported"),g=u("AmountRequired"),y=u("BluetoothRequired"),v=u("BtcUnmatchedApp"),_=u("CantOpenDevice"),b=u("CashAddrNotSupported"),x=u("CurrencyNotSupported"),w=u("DeviceAppVerifyNotSupported"),k=u("DeviceGenuineSocketEarlyClose"),A=u("DeviceNotGenuine"),E=u("DeviceOnDashboardExpected"),S=u("DeviceOnDashboardUnexpected"),T=u("DeviceInOSUExpected"),M=u("DeviceHalted"),I=u("DeviceNameInvalid"),P=u("DeviceSocketFail"),C=u("DeviceSocketNoBulkStatus"),B=u("LockedDeviceError"),D=u("DisconnectedDevice"),R=u("DisconnectedDeviceDuringOperation"),L=u("DeviceExtractOnboardingStateError"),O=u("DeviceOnboardingStatePollingError"),z=u("EnpointConfig"),N=u("EthAppPleaseEnableContractData"),U=u("FeeEstimationFailed"),Z=u("FirmwareNotRecognized"),F=u("HardResetFail"),j=u("InvalidXRPTag"),V=u("InvalidAddress"),W=u("InvalidAddressBecauseDestinationIsAlsoSource"),K=u("LatestMCUInstalledError"),G=u("UnknownMCU"),H=u("LedgerAPIError"),q=u("LedgerAPIErrorWithMessage"),Y=u("LedgerAPINotAvailable"),X=u("ManagerAppAlreadyInstalled"),Q=u("ManagerAppRelyOnBTC"),$=u("ManagerAppDepInstallRequired"),J=u("ManagerAppDepUninstallRequired"),ee=u("ManagerDeviceLocked"),te=u("ManagerFirmwareNotEnoughSpace"),re=u("ManagerNotEnoughSpace"),ne=u("ManagerUninstallBTCDep"),ie=u("NetworkDown"),oe=u("NoAddressesFound"),ae=u("NotEnoughBalance"),se=u("NotEnoughBalanceToDelegate"),ue=u("NotEnoughBalanceInParentAccount"),ce=u("NotEnoughSpendableBalance"),le=u("NotEnoughBalanceBecauseDestinationNotCreated"),he=u("NoAccessToCamera"),fe=u("NotEnoughGas"),de=u("NotSupportedLegacyAddress"),pe=u("GasLessThanEstimate"),me=u("PriorityFeeTooLow"),ge=u("PriorityFeeTooHigh"),ye=u("PriorityFeeHigherThanMaxFee"),ve=u("MaxFeeTooLow"),_e=u("PasswordsDontMatch"),be=u("PasswordIncorrect"),xe=u("RecommendSubAccountsToEmpty"),we=u("RecommendUndelegation"),ke=u("TimeoutTagged"),Ae=u("UnexpectedBootloader"),Ee=u("MCUNotGenuineToDashboard"),Se=u("RecipientRequired"),Te=u("UnavailableTezosOriginatedAccountReceive"),Me=u("UnavailableTezosOriginatedAccountSend"),Ie=u("UpdateFetchFileFail"),Pe=u("UpdateIncorrectHash"),Ce=u("UpdateIncorrectSig"),Be=u("UpdateYourApp"),De=u("UserRefusedDeviceNameChange"),Re=u("UserRefusedAddress"),Le=u("UserRefusedFirmwareUpdate"),Oe=u("UserRefusedAllowManager"),ze=u("UserRefusedOnDevice"),Ne=u("TransportOpenUserCancelled"),Ue=u("TransportInterfaceNotAvailable"),Ze=u("TransportRaceCondition"),Fe=u("TransportWebUSBGestureRequired"),je=u("DeviceShouldStayInApp"),Ve=u("WebsocketConnectionError"),We=u("WebsocketConnectionFailed"),Ke=u("WrongDeviceForAccount"),Ge=u("WrongAppForCurrency"),He=u("ETHAddressNonEIP"),qe=u("CantScanQRCode"),Ye=u("FeeNotLoaded"),Xe=u("FeeRequired"),Qe=u("FeeTooHigh"),$e=u("DustLimit"),Je=u("PendingOperation"),et=u("SyncError"),tt=u("PairingFailed"),rt=u("GenuineCheckFailed"),nt=u("LedgerAPI4xx"),it=u("LedgerAPI5xx"),ot=u("FirmwareOrAppUpdateRequired"),at=u("LanguageNotFound"),st=u("NoDBPathGiven"),ut=u("DBWrongPassword"),ct=u("DBNotReset");!function(e){e[e.Unknown=0]="Unknown",e[e.BleLocationServicesDisabled=1]="BleLocationServicesDisabled",e[e.BleBluetoothUnauthorized=2]="BleBluetoothUnauthorized",e[e.BleScanStartFailed=3]="BleScanStartFailed"}(f||(f={}));var lt=function(e){function t(r,n){var i=e.call(this,n)||this;return i.name="HwTransportError",i.type=r,Object.setPrototypeOf(i,t.prototype),i}return d(t,e),t}(Error),ht=function(e){function t(t,r){var n=this,i="TransportError";return(n=e.call(this,t||i)||this).name=i,n.message=t,n.stack=(new Error).stack,n.id=r,n}return d(t,e),t}(Error);s("TransportError",(function(e){return new ht(e.message,e.id)}));var ft={ACCESS_CONDITION_NOT_FULFILLED:38916,ALGORITHM_NOT_SUPPORTED:38020,CLA_NOT_SUPPORTED:28160,CODE_BLOCKED:38976,CODE_NOT_INITIALIZED:38914,COMMAND_INCOMPATIBLE_FILE_STRUCTURE:27009,CONDITIONS_OF_USE_NOT_SATISFIED:27013,CONTRADICTION_INVALIDATION:38928,CONTRADICTION_SECRET_CODE_STATUS:38920,CUSTOM_IMAGE_BOOTLOADER:26159,CUSTOM_IMAGE_EMPTY:26158,FILE_ALREADY_EXISTS:27273,FILE_NOT_FOUND:37892,GP_AUTH_FAILED:25344,HALTED:28586,INCONSISTENT_FILE:37896,INCORRECT_DATA:27264,INCORRECT_LENGTH:26368,INCORRECT_P1_P2:27392,INS_NOT_SUPPORTED:27904,INVALID_KCV:38021,INVALID_OFFSET:37890,LICENSING:28482,LOCKED_DEVICE:21781,MAX_VALUE_REACHED:38992,MEMORY_PROBLEM:37440,MISSING_CRITICAL_PARAMETER:26624,NO_EF_SELECTED:37888,NOT_ENOUGH_MEMORY_SPACE:27268,OK:36864,PIN_REMAINING_ATTEMPTS:25536,REFERENCED_DATA_NOT_FOUND:27272,SECURITY_STATUS_NOT_SATISFIED:27010,TECHNICAL_PROBLEM:28416,UNKNOWN_APDU:27906,USER_REFUSED_ON_DEVICE:21761};function dt(e){switch(e){case 26368:return"Incorrect length";case 26624:return"Missing critical parameter";case 27010:return"Security not satisfied (dongle locked or have invalid access rights)";case 27013:return"Condition of use not satisfied (denied by the user?)";case 27264:return"Invalid data received";case 27392:return"Invalid parameter received";case 21781:return"Locked device"}if(28416<=e&&e<=28671)return"Internal error, please report"}function pt(e){var t=Object.keys(ft).find((function(t){return ft[t]===e}))||"UNKNOWN_ERROR",r=dt(e)||t,n=e.toString(16),i="Ledger device: ".concat(r," (0x").concat(n,")");if(e===ft.LOCKED_DEVICE)throw new B(i);this.name="TransportStatusError",this.message=i,this.stack=(new Error).stack,this.statusCode=e,this.statusText=t}pt.prototype=new Error,s("TransportStatusError",(function(e){return new pt(e.statusCode)}))},670:function(e,t,r){"use strict";r.d(t,{WC:function(){return o.StatusCodes},rZ:function(){return o.TransportStatusError}});var n=r(7465),i=r.n(n),o=r(2600),a=r(9778).Buffer,s=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{u(n.next(e))}catch(t){o(t)}}function s(e){try{u(n.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))},u=function(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(i=2&o[0]?n.return:o[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,o[1])).done)return i;switch(n=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,n=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(s){o=[6,s],n=0}finally{r=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}},c=function(e,t){var r="function"===typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)a.push(n.value)}catch(s){i={error:s}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return a},l=function(e,t,r){if(r||2===arguments.length)for(var n,i=0,o=t.length;i<o;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},h=function(e){var t="function"===typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},f=function(){function e(){var e=this;this.exchangeTimeout=3e4,this.unresponsiveTimeout=15e3,this.deviceModel=null,this._events=new(i()),this.send=function(t,r,n,i,c,l){return void 0===c&&(c=a.alloc(0)),void 0===l&&(l=[o.StatusCodes.OK]),s(e,void 0,void 0,(function(){var e,s;return u(this,(function(u){switch(u.label){case 0:if(c.length>=256)throw new o.TransportError("data.length exceed 256 bytes limit. Got: "+c.length,"DataLengthTooBig");return[4,this.exchange(a.concat([a.from([t,r,n,i]),a.from([c.length]),c]))];case 1:if(e=u.sent(),s=e.readUInt16BE(e.length-2),!l.some((function(e){return e===s})))throw new o.TransportStatusError(s);return[2,e]}}))}))},this.exchangeAtomicImpl=function(t){return s(e,void 0,void 0,(function(){var e,r,n,i,a,s=this;return u(this,(function(u){switch(u.label){case 0:if(this.exchangeBusyPromise)throw new o.TransportRaceCondition("An action was already pending on the Ledger device. Please deny or reconnect.");r=new Promise((function(t){e=t})),this.exchangeBusyPromise=r,n=!1,i=setTimeout((function(){n=!0,s.emit("unresponsive")}),this.unresponsiveTimeout),u.label=1;case 1:return u.trys.push([1,,3,4]),[4,t()];case 2:return a=u.sent(),n&&this.emit("responsive"),[2,a];case 3:return clearTimeout(i),e&&e(),this.exchangeBusyPromise=null,[7];case 4:return[2]}}))}))},this._appAPIlock=null}return e.prototype.exchange=function(e){throw new Error("exchange not implemented")},e.prototype.setScrambleKey=function(e){},e.prototype.close=function(){return Promise.resolve()},e.prototype.on=function(e,t){this._events.on(e,t)},e.prototype.off=function(e,t){this._events.removeListener(e,t)},e.prototype.emit=function(e){for(var t,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];(t=this._events).emit.apply(t,l([e],c(r),!1))},e.prototype.setDebugMode=function(){console.warn("setDebugMode is deprecated. use @ledgerhq/logs instead. No logs are emitted in this anymore.")},e.prototype.setExchangeTimeout=function(e){this.exchangeTimeout=e},e.prototype.setExchangeUnresponsiveTimeout=function(e){this.unresponsiveTimeout=e},e.create=function(e,t){var r=this;return void 0===e&&(e=3e3),new Promise((function(n,i){var a=!1,s=r.listen({next:function(t){a=!0,s&&s.unsubscribe(),u&&clearTimeout(u),r.open(t.descriptor,e).then(n,i)},error:function(e){u&&clearTimeout(u),i(e)},complete:function(){u&&clearTimeout(u),a||i(new o.TransportError(r.ErrorMessage_NoDeviceFound,"NoDeviceFound"))}}),u=t?setTimeout((function(){s.unsubscribe(),i(new o.TransportError(r.ErrorMessage_ListenTimeout,"ListenTimeout"))}),t):null}))},e.prototype.decorateAppAPIMethods=function(e,t,r){var n,i;try{for(var o=h(t),a=o.next();!a.done;a=o.next()){var s=a.value;e[s]=this.decorateAppAPIMethod(s,e[s],e,r)}}catch(u){n={error:u}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(n)throw n.error}}},e.prototype.decorateAppAPIMethod=function(e,t,r,n){var i=this;return function(){for(var a=[],c=0;c<arguments.length;c++)a[c]=arguments[c];return s(i,void 0,void 0,(function(){var i;return u(this,(function(s){switch(s.label){case 0:if(i=this._appAPIlock)return[2,Promise.reject(new o.TransportError("Ledger Device is busy (lock "+i+")","TransportLocked"))];s.label=1;case 1:return s.trys.push([1,,3,4]),this._appAPIlock=e,this.setScrambleKey(n),[4,t.apply(r,a)];case 2:return[2,s.sent()];case 3:return this._appAPIlock=null,[7];case 4:return[2]}}))}))}},e.ErrorMessage_ListenTimeout="No Ledger device found (timeout)",e.ErrorMessage_NoDeviceFound="No Ledger device found",e}();t.ZP=f},9458:function(e,t,r){"use strict";var n=r(9728).default,i=r(6690).default,o=r(1655).default,a=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.AuctionProgram=void 0;var s=r(6322),u=r(3340),c=function(e){o(r,e);var t=a(r);function r(){return i(this,r),t.apply(this,arguments)}return n(r)}(u.Program);t.AuctionProgram=c,c.PREFIX="auction",c.EXTENDED="extended",c.PUBKEY=new s.PublicKey(u.config.programs.auction)},9330:function(e,t,r){"use strict";var n=r(7061).default,i=r(861).default,o=r(9728).default,a=r(6690).default,s=r(1655).default,u=r(6389).default,c=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{u(n.next(e))}catch(t){o(t)}}function s(e){try{u(n.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Auction=t.AuctionData=t.PriceFloor=t.BidState=t.Bid=t.PriceFloorType=t.BidStateType=t.AuctionState=void 0;var h,f=r(3340),d=r(6322),p=l(r(518)),m=r(9778),g=r(9458),y=r(3413),v=r(5581);!function(e){e[e.Created=0]="Created",e[e.Started=1]="Started",e[e.Ended=2]="Ended"}(t.AuctionState||(t.AuctionState={})),function(e){e[e.EnglishAuction=0]="EnglishAuction",e[e.OpenEdition=1]="OpenEdition"}(t.BidStateType||(t.BidStateType={})),function(e){e[e.None=0]="None",e[e.Minimum=1]="Minimum",e[e.BlindedPrice=2]="BlindedPrice"}(h=t.PriceFloorType||(t.PriceFloorType={}));var _=function(e){s(r,e);var t=u(r);function r(){return a(this,r),t.apply(this,arguments)}return o(r)}(f.Borsh.Data);t.Bid=_,_.SCHEMA=_.struct([["key","pubkeyAsString"],["amount","u64"]]);var b=function(e){s(r,e);var t=u(r);function r(){return a(this,r),t.apply(this,arguments)}return o(r,[{key:"getWinnerAt",value:function(e){var t=this.bids.length-e-1;return t>=0&&t<this.bids.length?this.bids[t].key:null}},{key:"getAmountAt",value:function(e){var t=this.bids.length-e-1;return t>=0&&t<this.bids.length?this.bids[t].amount:null}},{key:"getWinnerIndex",value:function(e){if(!this.bids)return null;var t=this.bids.findIndex((function(t){return t.key===e}));if(-1!==t){var r=this.bids.length-t-1;return r<this.max.toNumber()?r:null}return null}}]),r}(f.Borsh.Data);t.BidState=b,b.SCHEMA=new Map([].concat(i(_.SCHEMA),i(b.struct([["type","u8"],["bids",[_]],["max","u64"]]))));var x=function(e){s(r,e);var t=u(r);function r(e){var n;return a(this,r),(n=t.call(this)).type=e.type,n.hash=e.hash||new Uint8Array(32),n.type===h.Minimum&&(e.minPrice?n.hash.set(e.minPrice.toArrayLike(m.Buffer,"le",8),0):n.minPrice=new p.default((e.hash||new Uint8Array(0)).slice(0,8),"le")),n}return o(r)}(f.Borsh.Data);t.PriceFloor=x,x.SCHEMA=x.struct([["type","u8"],["hash",[32]]]);var w=function(e){s(r,e);var t=u(r);function r(){return a(this,r),t.apply(this,arguments)}return o(r)}(f.Borsh.Data);t.AuctionData=w,w.SCHEMA=new Map([].concat(i(b.SCHEMA),i(x.SCHEMA),i(w.struct([["authority","pubkeyAsString"],["tokenMint","pubkeyAsString"],["lastBid",{kind:"option",type:"u64"}],["endedAt",{kind:"option",type:"u64"}],["endAuctionAt",{kind:"option",type:"u64"}],["auctionGap",{kind:"option",type:"u64"}],["priceFloor",x],["state","u8"],["bidState",b]]))));var k=function(e){s(r,e);var t=u(r);function r(e,n){var i;if(a(this,r),!(i=t.call(this,e,n)).assertOwner(g.AuctionProgram.PUBKEY))throw(0,f.ERROR_INVALID_OWNER)();return i.data=w.deserialize(i.info.data),i}return o(r,[{key:"getBidderPots",value:function(e){return c(this,void 0,void 0,n().mark((function t(){return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g.AuctionProgram.getProgramAccounts(e,{filters:[{dataSize:v.BidderPot.DATA_SIZE},{memcmp:{offset:64,bytes:this.pubkey.toBase58()}}]});case 2:return t.abrupt("return",t.sent.map((function(e){return v.BidderPot.from(e)})));case 3:case"end":return t.stop()}}),t,this)})))}},{key:"getBidderMetadata",value:function(e){return c(this,void 0,void 0,n().mark((function t(){return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,g.AuctionProgram.getProgramAccounts(e,{filters:[{dataSize:y.BidderMetadata.DATA_SIZE},{memcmp:{offset:32,bytes:this.pubkey.toBase58()}}]});case 2:return t.abrupt("return",t.sent.map((function(e){return y.BidderMetadata.from(e)})));case 3:case"end":return t.stop()}}),t,this)})))}}],[{key:"getPDA",value:function(e){return g.AuctionProgram.findProgramAddress([m.Buffer.from(g.AuctionProgram.PREFIX),g.AuctionProgram.PUBKEY.toBuffer(),new d.PublicKey(e).toBuffer()])}},{key:"findMany",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return c(this,void 0,void 0,n().mark((function i(){return n().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,g.AuctionProgram.getProgramAccounts(e,{filters:[t.authority&&{memcmp:{offset:0,bytes:new d.PublicKey(t.authority).toBase58()}}].filter(Boolean)});case 2:return n.abrupt("return",n.sent.map((function(e){try{return r.from(e)}catch(t){}})).filter(Boolean));case 3:case"end":return n.stop()}}),i)})))}}]),r}(f.Account);t.Auction=k,k.EXTENDED_DATA_SIZE=219},2634:function(e,t,r){"use strict";var n=r(9728).default,i=r(6690).default,o=r(1655).default,a=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.AuctionExtended=t.AuctionDataExtended=void 0;var s=r(3340),u=r(9458),c=r(9778),l=r(6322),h=function(e){o(r,e);var t=a(r);function r(){return i(this,r),t.apply(this,arguments)}return n(r)}(s.Borsh.Data);t.AuctionDataExtended=h,h.SCHEMA=h.struct([["totalUncancelledBids","u64"],["tickSize",{kind:"option",type:"u64"}],["gapTickSizePercentage",{kind:"option",type:"u8"}],["instantSalePrice",{kind:"option",type:"u64"}],["name",{kind:"option",type:[32]}]]);var f=function(e){o(r,e);var t=a(r);function r(e,n){var o;if(i(this,r),!(o=t.call(this,e,n)).assertOwner(u.AuctionProgram.PUBKEY))throw(0,s.ERROR_INVALID_OWNER)();if(!r.isCompatible(o.info.data))throw(0,s.ERROR_INVALID_ACCOUNT_DATA)();return o.data=h.deserialize(o.info.data),o}return n(r,null,[{key:"isCompatible",value:function(e){return e.length===r.DATA_SIZE}},{key:"getPDA",value:function(e){return u.AuctionProgram.findProgramAddress([c.Buffer.from(u.AuctionProgram.PREFIX),u.AuctionProgram.PUBKEY.toBuffer(),new l.PublicKey(e).toBuffer(),c.Buffer.from(u.AuctionProgram.EXTENDED)])}}]),r}(s.Account);t.AuctionExtended=f,f.DATA_SIZE=219},3413:function(e,t,r){"use strict";var n=r(9728).default,i=r(6690).default,o=r(1655).default,a=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.BidderMetadata=t.BidderMetadataData=void 0;var s=r(3340),u=r(6322),c=r(9458),l=r(9778),h=function(e){o(r,e);var t=a(r);function r(){return i(this,r),t.apply(this,arguments)}return n(r)}(s.Borsh.Data);t.BidderMetadataData=h,h.SCHEMA=h.struct([["bidderPubkey","pubkeyAsString"],["auctionPubkey","pubkeyAsString"],["lastBid","u64"],["lastBidTimestamp","u64"],["cancelled","u8"]]);var f=function(e){o(r,e);var t=a(r);function r(e,n){var o;if(i(this,r),!(o=t.call(this,e,n)).assertOwner(c.AuctionProgram.PUBKEY))throw(0,s.ERROR_INVALID_OWNER)();if(!r.isCompatible(o.info.data))throw(0,s.ERROR_INVALID_ACCOUNT_DATA)();return o.data=h.deserialize(o.info.data),o}return n(r,null,[{key:"isCompatible",value:function(e){return e.length===r.DATA_SIZE}},{key:"getPDA",value:function(e,t){return c.AuctionProgram.findProgramAddress([l.Buffer.from(c.AuctionProgram.PREFIX),c.AuctionProgram.PUBKEY.toBuffer(),new u.PublicKey(e).toBuffer(),new u.PublicKey(t).toBuffer(),l.Buffer.from("metadata")])}}]),r}(s.Account);t.BidderMetadata=f,f.DATA_SIZE=81},5581:function(e,t,r){"use strict";var n=r(9728).default,i=r(6690).default,o=r(1655).default,a=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.BidderPot=t.BidderPotData=void 0;var s=r(3340),u=r(9458),c=r(6322),l=r(9778),h=function(e){o(r,e);var t=a(r);function r(){return i(this,r),t.apply(this,arguments)}return n(r)}(s.Borsh.Data);t.BidderPotData=h,h.SCHEMA=h.struct([["bidderPot","pubkeyAsString"],["bidderAct","pubkeyAsString"],["auctionAct","pubkeyAsString"],["emptied","u8"]]);var f=function(e){o(r,e);var t=a(r);function r(e,n){var o;if(i(this,r),!(o=t.call(this,e,n)).assertOwner(u.AuctionProgram.PUBKEY))throw(0,s.ERROR_INVALID_OWNER)();if(!r.isCompatible(o.info.data))throw(0,s.ERROR_INVALID_ACCOUNT_DATA)();return o.data=h.deserialize(o.info.data),o}return n(r,null,[{key:"isCompatible",value:function(e){return e.length===r.DATA_SIZE}},{key:"getPDA",value:function(e,t){return u.AuctionProgram.findProgramAddress([l.Buffer.from(u.AuctionProgram.PREFIX),u.AuctionProgram.PUBKEY.toBuffer(),new c.PublicKey(e).toBuffer(),new c.PublicKey(t).toBuffer()])}}]),r}(s.Account);t.BidderPot=f,f.DATA_SIZE=97},3258:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r(9330),t),i(r(2634),t),i(r(3413),t),i(r(5581),t),i(r(9458),t),i(r(2578),t)},8563:function(e,t,r){"use strict";var n=r(9728).default,i=r(6690).default,o=r(1655).default,a=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.CancelBid=t.CancelBidArgs=void 0;var s=r(3340),u=r(3717),c=r(6322),l=r(9458),h=function(e){o(r,e);var t=a(r);function r(){var e;return i(this,r),(e=t.apply(this,arguments)).instruction=0,e}return n(r)}(s.Borsh.Data);t.CancelBidArgs=h,h.SCHEMA=h.struct([["instruction","u8"],["resource","pubkeyAsString"]]);var f=function(e){o(r,e);var t=a(r);function r(e,n){var o;i(this,r),o=t.call(this,e);var a=n.auction,s=n.auctionExtended,f=n.bidderPot,d=n.bidderMeta,p=n.bidder,m=n.bidderToken,g=n.bidderPotToken,y=n.tokenMint,v=n.resource,_=h.serialize({resource:v.toString()});return o.add(new c.TransactionInstruction({keys:[{pubkey:p,isSigner:!0,isWritable:!1},{pubkey:m,isSigner:!1,isWritable:!0},{pubkey:f,isSigner:!1,isWritable:!0},{pubkey:g,isSigner:!1,isWritable:!0},{pubkey:d,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:y,isSigner:!1,isWritable:!0},{pubkey:c.SYSVAR_CLOCK_PUBKEY,isSigner:!1,isWritable:!1},{pubkey:c.SYSVAR_RENT_PUBKEY,isSigner:!1,isWritable:!1},{pubkey:c.SystemProgram.programId,isSigner:!1,isWritable:!1},{pubkey:u.TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1}],programId:l.AuctionProgram.PUBKEY,data:_})),o}return n(r)}(s.Transaction);t.CancelBid=f},9885:function(e,t,r){"use strict";var n=r(861).default,i=r(9728).default,o=r(6690).default,a=r(1655).default,s=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.CreateAuction=t.CreateAuctionArgs=t.WinnerLimit=t.WinnerLimitType=void 0;var u=r(3340),c=r(6322),l=r(9458),h=r(9330);!function(e){e[e.Unlimited=0]="Unlimited",e[e.Capped=1]="Capped"}(t.WinnerLimitType||(t.WinnerLimitType={}));var f=function(e){a(r,e);var t=s(r);function r(){return o(this,r),t.apply(this,arguments)}return i(r)}(u.Borsh.Data);t.WinnerLimit=f,f.SCHEMA=f.struct([["type","u8"],["usize","u64"]]);var d=function(e){a(r,e);var t=s(r);function r(){var e;return o(this,r),(e=t.apply(this,arguments)).instruction=1,e}return i(r)}(u.Borsh.Data);t.CreateAuctionArgs=d,d.SCHEMA=new Map([].concat(n(f.SCHEMA),n(h.PriceFloor.SCHEMA),n(d.struct([["instruction","u8"],["winners",f],["endAuctionAt",{kind:"option",type:"u64"}],["auctionGap",{kind:"option",type:"u64"}],["tokenMint","pubkeyAsString"],["authority","pubkeyAsString"],["resource","pubkeyAsString"],["priceFloor",h.PriceFloor],["tickSize",{kind:"option",type:"u64"}],["gapTickSizePercentage",{kind:"option",type:"u8"}]]))));var p=function(e){a(r,e);var t=s(r);function r(e,n){var i;o(this,r),i=t.call(this,e);var a=n.args,s=n.auction,u=n.auctionExtended,h=n.creator,f=d.serialize(a);return i.add(new c.TransactionInstruction({keys:[{pubkey:h,isSigner:!0,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:u,isSigner:!1,isWritable:!0},{pubkey:c.SYSVAR_RENT_PUBKEY,isSigner:!1,isWritable:!1},{pubkey:c.SystemProgram.programId,isSigner:!1,isWritable:!1}],programId:l.AuctionProgram.PUBKEY,data:f})),i}return i(r)}(u.Transaction);t.CreateAuction=p},6774:function(e,t,r){"use strict";var n,i=r(861).default,o=r(9728).default,a=r(6690).default,s=r(1655).default,u=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.CreateAuctionV2=t.CreateAuctionV2Args=void 0;var c=r(3340),l=r(6322),h=r(9458),f=r(9330),d=r(9885),p=function(e){s(r,e);var t=u(r);function r(){var e;return a(this,r),(e=t.apply(this,arguments)).instruction=7,e}return o(r)}(c.Borsh.Data);t.CreateAuctionV2Args=p,n=p,p.SCHEMA=new Map([].concat(i(d.WinnerLimit.SCHEMA),i(f.PriceFloor.SCHEMA),i(n.struct([["instruction","u8"],["winners",d.WinnerLimit],["endAuctionAt",{kind:"option",type:"u64"}],["auctionGap",{kind:"option",type:"u64"}],["tokenMint","pubkeyAsString"],["authority","pubkeyAsString"],["resource","pubkeyAsString"],["priceFloor",f.PriceFloor],["tickSize",{kind:"option",type:"u64"}],["gapTickSizePercentage",{kind:"option",type:"u8"}],["instantSalePrice",{kind:"option",type:"u64"}],["name",{kind:"option",type:[32]}]]))));var m=function(e){s(r,e);var t=u(r);function r(e,n){var i;a(this,r),i=t.call(this,e);var o=n.args,s=n.auction,u=n.auctionExtended,c=n.creator,f=p.serialize(o);return i.add(new l.TransactionInstruction({keys:[{pubkey:c,isSigner:!0,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:u,isSigner:!1,isWritable:!0},{pubkey:l.SYSVAR_RENT_PUBKEY,isSigner:!1,isWritable:!1},{pubkey:l.SystemProgram.programId,isSigner:!1,isWritable:!1}],programId:h.AuctionProgram.PUBKEY,data:f})),i}return o(r)}(c.Transaction);t.CreateAuctionV2=m},4065:function(e,t,r){"use strict";var n=r(9728).default,i=r(6690).default,o=r(1655).default,a=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.PlaceBid=t.PlaceBidArgs=void 0;var s=r(3340),u=r(6322),c=r(9458),l=r(3717),h=function(e){o(r,e);var t=a(r);function r(){var e;return i(this,r),(e=t.apply(this,arguments)).instruction=6,e}return n(r)}(s.Borsh.Data);t.PlaceBidArgs=h,h.SCHEMA=h.struct([["instruction","u8"],["amount","u64"],["resource","pubkeyAsString"]]);var f=function(e){o(r,e);var t=a(r);function r(e,n){var o;i(this,r),o=t.call(this,e);var a=e.feePayer,s=n.auction,f=n.auctionExtended,d=n.bidderPot,p=n.bidderMeta,m=n.bidder,g=n.bidderToken,y=n.bidderPotToken,v=n.tokenMint,_=n.transferAuthority,b=n.resource,x=n.amount,w=h.serialize({resource:b.toString(),amount:x});return o.add(new u.TransactionInstruction({keys:[{pubkey:m,isSigner:!0,isWritable:!1},{pubkey:g,isSigner:!1,isWritable:!0},{pubkey:d,isSigner:!1,isWritable:!0},{pubkey:y,isSigner:!1,isWritable:!0},{pubkey:p,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:f,isSigner:!1,isWritable:!0},{pubkey:v,isSigner:!1,isWritable:!0},{pubkey:_,isSigner:!0,isWritable:!1},{pubkey:a,isSigner:!0,isWritable:!1},{pubkey:u.SYSVAR_CLOCK_PUBKEY,isSigner:!1,isWritable:!1},{pubkey:u.SYSVAR_RENT_PUBKEY,isSigner:!1,isWritable:!1},{pubkey:u.SystemProgram.programId,isSigner:!1,isWritable:!1},{pubkey:l.TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1}],programId:c.AuctionProgram.PUBKEY,data:w})),o}return n(r)}(s.Transaction);t.PlaceBid=f},2900:function(e,t,r){"use strict";var n=r(9728).default,i=r(6690).default,o=r(1655).default,a=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.SetAuctionAuthority=t.SetAuctionAuthorityArgs=void 0;var s=r(3340),u=r(6322),c=r(9458),l=function(e){o(r,e);var t=a(r);function r(){var e;return i(this,r),(e=t.apply(this,arguments)).instruction=5,e}return n(r)}(s.Borsh.Data);t.SetAuctionAuthorityArgs=l,l.SCHEMA=l.struct([["instruction","u8"]]);var h=function(e){o(r,e);var t=a(r);function r(e,n){var o;i(this,r),o=t.call(this,e);var a=n.auction,s=n.currentAuthority,h=n.newAuthority,f=l.serialize();return o.add(new u.TransactionInstruction({keys:[{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!0,isWritable:!1},{pubkey:h,isSigner:!1,isWritable:!1}],programId:c.AuctionProgram.PUBKEY,data:f})),o}return n(r)}(s.Transaction);t.SetAuctionAuthority=h},2578:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r(8563),t),i(r(9885),t),i(r(6774),t),i(r(4065),t),i(r(2900),t)},8686:function(e,t,r){"use strict";var n=r(7061).default,i=r(6690).default,o=r(9728).default,a=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{u(n.next(e))}catch(t){o(t)}}function s(e){try{u(n.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Program=void 0;var s=r(6322),u=r(757),c=r(9778),l=function(){function e(){i(this,e)}return o(e,null,[{key:"findProgramAddress",value:function(e){return a(this,void 0,void 0,n().mark((function t(){return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,s.PublicKey.findProgramAddress(e,this.PUBKEY);case 2:return t.abrupt("return",t.sent[0]);case 3:case"end":return t.stop()}}),t,this)})))}},{key:"getProgramAccounts",value:function(e,t){return a(this,void 0,void 0,n().mark((function r(){var i,o,a,l;return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return i={},t&&("string"===typeof t?o=t:(o=t.commitment,t.dataSlice&&(i.dataSlice=t.dataSlice),t.filters&&(i.filters=t.filters))),a=e._buildArgs([this.PUBKEY.toBase58()],o,"base64",i),r.next=5,e._rpcRequest("getProgramAccounts",a);case 5:return l=r.sent,r.abrupt("return",l.result.map((function(e){var t=e.account,r=t.data,n=t.executable,i=t.lamports,o=t.owner,a=e.pubkey;return{account:{data:c.Buffer.from(r[0],"base64"),executable:n,lamports:i,owner:new s.PublicKey(o)},pubkey:new s.PublicKey(a)}})).map((function(e){var t=e.pubkey,r=e.account;return new u.Account(t,r)})));case 7:case"end":return r.stop()}}),r,this)})))}}]),e}();t.Program=l},3807:function(e,t,r){"use strict";var n=r(6690).default,i=r(9728).default,o=r(1655).default,a=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.Transaction=void 0;var s=function(e){o(r,e);var t=a(r);function r(e){return n(this,r),t.call(this,e)}return i(r,null,[{key:"fromCombined",value:function(e){var t=new r(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{});return e.forEach((function(e){return e.instructions.forEach((function(e){t.add(e)}))})),t}}]),r}(r(6322).Transaction);t.Transaction=s},4590:function(e,t,r){"use strict";var n=r(7424).default,i=r(861).default,o=r(7061).default,a=r(6690).default,s=r(9728).default,u=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{u(n.next(e))}catch(t){o(t)}}function s(e){try{u(n.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Account=void 0;var c=r(6322),l=r(9778),h=r(2091),f=function(){function e(t,r){a(this,e),this.pubkey=new c.PublicKey(t),this.info=r}return s(e,[{key:"assertOwner",value:function(e){var t;return null===(t=this.info)||void 0===t?void 0:t.owner.equals(new c.PublicKey(e))}},{key:"toJSON",value:function(){var e,t,r,n,i;return{pubkey:this.pubkey.toString(),info:{executable:!!(null===(e=this.info)||void 0===e?void 0:e.executable),owner:(null===(t=this.info)||void 0===t?void 0:t.owner)?new c.PublicKey(null===(r=this.info)||void 0===r?void 0:r.owner):null,lamports:null===(n=this.info)||void 0===n?void 0:n.lamports,data:null===(i=this.info)||void 0===i?void 0:i.data.toJSON()},data:this.data}}},{key:"toString",value:function(){return JSON.stringify(this.toJSON())}}],[{key:"from",value:function(e){return new this(e.pubkey,e.info)}},{key:"load",value:function(t,r){return u(this,void 0,void 0,o().mark((function n(){var i;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,e.getInfo(t,r);case 2:return i=n.sent,n.abrupt("return",new this(r,i));case 4:case"end":return n.stop()}}),n,this)})))}},{key:"isCompatible",value:function(e){throw new Error("method 'isCompatible' is not implemented")}},{key:"getInfo",value:function(e,t){return u(this,void 0,void 0,o().mark((function r(){var n;return o().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.getAccountInfo(new c.PublicKey(t));case 2:if(n=r.sent){r.next=5;break}throw(0,h.ERROR_ACCOUNT_NOT_FOUND)(t);case 5:return r.abrupt("return",Object.assign(Object.assign({},n),{data:l.Buffer.from(null===n||void 0===n?void 0:n.data)}));case 6:case"end":return r.stop()}}),r)})))}},{key:"getInfos",value:function(t,r){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"recent";return u(this,void 0,void 0,o().mark((function s(){var u,c,l;return o().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:for(99,u=[],c=0;c<r.length;c+=99)u.push(e.getMultipleAccounts(t,r.slice(c,Math.min(r.length,c+99)),a));return l=new Map,o.next=6,Promise.all(u);case 6:return o.sent.forEach((function(e){var t;return i(null!==(t=null===e||void 0===e?void 0:e.entries())&&void 0!==t?t:[]).forEach((function(e){var t=n(e,2),r=t[0],i=t[1];return l.set(r,i)}))})),o.abrupt("return",l);case 8:case"end":return o.stop()}}),s)})))}},{key:"getMultipleAccounts",value:function(e,t,r){return u(this,void 0,void 0,o().mark((function n(){var i,a,s;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=e._buildArgs([t.map((function(e){return e.toString()}))],r,"base64"),n.next=3,e._rpcRequest("getMultipleAccounts",i);case 3:if(!(a=n.sent).error){n.next=6;break}throw new Error("failed to get info about accounts "+a.error.message);case 6:if(a.result.value){n.next=8;break}return n.abrupt("return");case 8:return s=a.result.value.filter(Boolean).map((function(e){return Object.assign(Object.assign({},e),{data:l.Buffer.from(e.data[0],"base64")})})),n.abrupt("return",s.reduce((function(e,r,n){return e.set(t[n],r),e}),new Map));case 10:case"end":return n.stop()}}),n)})))}}]),e}();t.Account=f},4521:function(e,t,r){"use strict";var n=r(7061).default,i=r(6690).default,o=r(9728).default,a=r(1655).default,s=r(6389).default,u=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{u(n.next(e))}catch(t){o(t)}}function s(e){try{u(n.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.deserialize=t.TokenAccount=void 0;var c=r(2091),l=r(4590),h=r(3717),f=r(6322),d=function(e){a(l,e);var r=s(l);function l(e,n){var o;if(i(this,l),!(o=r.call(this,e,n)).assertOwner(h.TOKEN_PROGRAM_ID))throw(0,c.ERROR_INVALID_OWNER)();if(!l.isCompatible(o.info.data))throw(0,c.ERROR_INVALID_ACCOUNT_DATA)();return o.data=(0,t.deserialize)(o.info.data),o}return o(l,null,[{key:"isCompatible",value:function(e){return e.length===h.AccountLayout.span}},{key:"getTokenAccountsByOwner",value:function(e,t){return u(this,void 0,void 0,n().mark((function r(){return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.getTokenAccountsByOwner(new f.PublicKey(t),{programId:h.TOKEN_PROGRAM_ID});case 2:return r.abrupt("return",r.sent.value.map((function(e){return new l(e.pubkey,e.account)})));case 3:case"end":return r.stop()}}),r)})))}}]),l}(l.Account);t.TokenAccount=d;t.deserialize=function(e){var t=h.AccountLayout.decode(e);return t.mint=new f.PublicKey(t.mint),t.owner=new f.PublicKey(t.owner),t.amount=h.u64.fromBuffer(t.amount),0===t.delegateOption?(t.delegate=null,t.delegatedAmount=new h.u64(0)):(t.delegate=new f.PublicKey(t.delegate),t.delegatedAmount=h.u64.fromBuffer(t.delegatedAmount)),t.isInitialized=0!==t.state,t.isFrozen=2===t.state,1===t.isNativeOption?(t.rentExemptReserve=h.u64.fromBuffer(t.isNative),t.isNative=!0):(t.rentExemptReserve=null,t.isNative=!1),0===t.closeAuthorityOption?t.closeAuthority=null:t.closeAuthority=new f.PublicKey(t.closeAuthority),t}},757:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r(4590),t),i(r(4521),t)},5883:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.config=void 0,t.config={arweaveWallet:"HvwC9QSAzvGXhhVrgPmauVwFWcYZhne3hVot9EbHuFTm",programs:{auction:"auctxRXPeJoc4817jDhf4HbjnhEcr1cCXenosMhK5R8",metadata:"metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s",metaplex:"p1exdMJcjVao65QdewkaZRUnU6VPSXhus9n2GzWfh98",vault:"vau1zxA2LbssAUEF7Gpw91zMM1LvXrvpzJtmZ58rPsn",packs:"BNRmGgciUJuyznkYHnmitA9an1BcDDiU9JmjEQwvBYVR",memo:"MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr",token:"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"},maxCreatorLimit:5}},2091:function(e,t,r){"use strict";var n,i=r(9728).default,o=r(6690).default,a=r(1655).default,s=r(6389).default,u=r(3496).default;Object.defineProperty(t,"__esModule",{value:!0}),t.ERROR_ACCOUNT_NOT_FOUND=t.ERROR_DEPRECATED_ACCOUNT_DATA=t.ERROR_INVALID_ACCOUNT_DATA=t.ERROR_INVALID_OWNER=t.MetaplexError=t.ErrorCode=void 0,function(e){e[e.ERROR_INVALID_OWNER=0]="ERROR_INVALID_OWNER",e[e.ERROR_INVALID_ACCOUNT_DATA=1]="ERROR_INVALID_ACCOUNT_DATA",e[e.ERROR_DEPRECATED_ACCOUNT_DATA=2]="ERROR_DEPRECATED_ACCOUNT_DATA",e[e.ERROR_ACCOUNT_NOT_FOUND=3]="ERROR_ACCOUNT_NOT_FOUND"}(n=t.ErrorCode||(t.ErrorCode={}));var c=function(e){a(r,e);var t=s(r);function r(e,n){var i;return o(this,r),(i=t.call(this,n)).errorCode=e,i}return i(r)}(u(Error));t.MetaplexError=c;t.ERROR_INVALID_OWNER=function(){return new c(n.ERROR_INVALID_OWNER,"Invalid owner")};t.ERROR_INVALID_ACCOUNT_DATA=function(){return new c(n.ERROR_INVALID_ACCOUNT_DATA,"Invalid data")};t.ERROR_DEPRECATED_ACCOUNT_DATA=function(){return new c(n.ERROR_DEPRECATED_ACCOUNT_DATA,"Account data is deprecated")};t.ERROR_ACCOUNT_NOT_FOUND=function(e){return new c(n.ERROR_ACCOUNT_NOT_FOUND,"Unable to find account: ".concat(e))}},3340:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r(757),t),i(r(5883),t),i(r(2091),t),i(r(8686),t),i(r(3807),t),i(r(8396),t),i(r(359),t)},8396:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},1211:function(e,t,r){"use strict";var n=r(9778).Buffer,i=r(6690).default,o=r(9728).default,a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.serialize=t.deserializeUnchecked=t.deserialize=t.struct=t.Data=t.extendBorsh=void 0;var s=r(6322),u=r(5127);Object.defineProperty(t,"deserializeUnchecked",{enumerable:!0,get:function(){return u.deserializeUnchecked}}),Object.defineProperty(t,"serialize",{enumerable:!0,get:function(){return u.serialize}}),Object.defineProperty(t,"deserialize",{enumerable:!0,get:function(){return u.deserialize}});var c=a(r(7541));t.extendBorsh=function(){u.BinaryReader.prototype.readPubkey=function(){var e=this.readFixedArray(32);return new s.PublicKey(e)},u.BinaryWriter.prototype.writePubkey=function(e){this.writeFixedArray(e.toBuffer())},u.BinaryReader.prototype.readPubkeyAsString=function(){var e=this.readFixedArray(32);return c.default.encode(e)},u.BinaryWriter.prototype.writePubkeyAsString=function(e){this.writeFixedArray(c.default.decode(e))}},(0,t.extendBorsh)();var l=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i(this,e),Object.assign(this,t)}return o(e,null,[{key:"struct",value:function(e){return(0,t.struct)(this,e)}},{key:"serialize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n.from((0,u.serialize)(this.SCHEMA,new this(e)))}},{key:"deserialize",value:function(e){return(0,u.deserializeUnchecked)(this.SCHEMA,this,e)}}]),e}();t.Data=l;t.struct=function(e,t){return new Map([[e,{kind:"struct",fields:t}]])}},359:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return i(t,e),t},a=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.Borsh=void 0,t.Borsh=o(r(1211)),a(r(8988),t)},8988:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.getBNFromData=t.TupleNumericType=void 0;var i,o=n(r(518));!function(e){e[e.U8=1]="U8",e[e.U16=2]="U16",e[e.U32=4]="U32",e[e.U64=8]="U64"}(i=t.TupleNumericType||(t.TupleNumericType={}));t.getBNFromData=function(e,t,r){switch(r){case i.U8:return new o.default(e[t],"le");case i.U16:return new o.default(e.slice(t,t+2),"le");case i.U32:return new o.default(e.slice(t,t+4),"le");case i.U64:return new o.default(e.slice(t,t+8),"le")}}},7541:function(e,t,r){var n=r(2307);e.exports=n("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz")},3410:function(e,t,r){"use strict";var n=r(9728).default,i=r(6690).default,o=r(1655).default,a=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.MetaplexProgram=t.MetaplexKey=void 0;var s=r(3340),u=r(6322);!function(e){e[e.Uninitialized=0]="Uninitialized",e[e.OriginalAuthorityLookupV1=1]="OriginalAuthorityLookupV1",e[e.BidRedemptionTicketV1=2]="BidRedemptionTicketV1",e[e.StoreV1=3]="StoreV1",e[e.WhitelistedCreatorV1=4]="WhitelistedCreatorV1",e[e.PayoutTicketV1=5]="PayoutTicketV1",e[e.SafetyDepositValidationTicketV1=6]="SafetyDepositValidationTicketV1",e[e.AuctionManagerV1=7]="AuctionManagerV1",e[e.PrizeTrackingTicketV1=8]="PrizeTrackingTicketV1",e[e.SafetyDepositConfigV1=9]="SafetyDepositConfigV1",e[e.AuctionManagerV2=10]="AuctionManagerV2",e[e.BidRedemptionTicketV2=11]="BidRedemptionTicketV2",e[e.AuctionWinnerTokenTypeTrackerV1=12]="AuctionWinnerTokenTypeTrackerV1",e[e.StoreIndexerV1=13]="StoreIndexerV1",e[e.AuctionCacheV1=14]="AuctionCacheV1",e[e.StoreConfigV1=15]="StoreConfigV1"}(t.MetaplexKey||(t.MetaplexKey={}));var c=function(e){o(r,e);var t=a(r);function r(){return i(this,r),t.apply(this,arguments)}return n(r)}(s.Program);t.MetaplexProgram=c,c.PREFIX="metaplex",c.CONFIG="config",c.TOTALS="totals",c.PUBKEY=new u.PublicKey(s.config.programs.metaplex)},9093:function(e,t,r){"use strict";var n,i,o=r(7061).default,a=r(861).default,s=r(9728).default,u=r(6690).default,c=r(1655).default,l=r(6389).default,h=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{u(n.next(e))}catch(t){o(t)}}function s(e){try{u(n.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))},f=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.AuctionManager=t.AuctionManagerV2Data=t.AuctionManagerStateV2=t.AuctionManagerStatus=void 0;var d,p=r(6322),m=f(r(518)),g=f(r(6315)),y=r(5562),v=r(3410),_=r(9778),b=r(3258),x=r(3340);!function(e){e[e.Initialized=0]="Initialized",e[e.Validated=1]="Validated",e[e.Running=2]="Running",e[e.Disbursing=3]="Disbursing",e[e.Finished=4]="Finished"}(d=t.AuctionManagerStatus||(t.AuctionManagerStatus={}));var w=function(e){c(r,e);var t=l(r);function r(){var e;return u(this,r),(e=t.apply(this,arguments)).status=d.Initialized,e.safetyConfigItemsValidated=new m.default(0),e.bidsPushedToAcceptPayment=new m.default(0),e.hasParticipation=!1,e}return s(r)}(x.Borsh.Data);t.AuctionManagerStateV2=w,n=w,w.SCHEMA=n.struct([["status","u8"],["safetyConfigItemsValidated","u64"],["bidsPushedToAcceptPayment","u64"],["hasParticipation","u8"]]);var k=function(e){c(r,e);var t=l(r);function r(e){var n;return u(this,r),(n=t.call(this,e)).key=v.MetaplexKey.AuctionManagerV2,n}return s(r)}(x.Borsh.Data);t.AuctionManagerV2Data=k,i=k,k.SCHEMA=new Map([].concat(a(w.SCHEMA),a(i.struct([["key","u8"],["store","pubkeyAsString"],["authority","pubkeyAsString"],["auction","pubkeyAsString"],["vault","pubkeyAsString"],["acceptPayment","pubkeyAsString"],["state",w]]))));var A=function(e){c(r,e);var t=l(r);function r(e,n){var i;if(u(this,r),!(i=t.call(this,e,n)).assertOwner(v.MetaplexProgram.PUBKEY))throw(0,x.ERROR_INVALID_OWNER)();if(r.isAuctionManagerV1(i.info.data))throw(0,x.ERROR_DEPRECATED_ACCOUNT_DATA)();if(!r.isAuctionManagerV2(i.info.data))throw(0,x.ERROR_INVALID_ACCOUNT_DATA)();return i.data=k.deserialize(i.info.data),i}return s(r,[{key:"getAuction",value:function(e){return h(this,void 0,void 0,o().mark((function t(){return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",b.Auction.load(e,this.data.auction));case 1:case"end":return t.stop()}}),t,this)})))}},{key:"getBidRedemptionTickets",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return h(this,void 0,void 0,o().mark((function r(){return o().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,v.MetaplexProgram.getProgramAccounts(e,{filters:[{memcmp:{offset:0,bytes:g.default.encode(_.Buffer.from([v.MetaplexKey.BidRedemptionTicketV2]))}},{memcmp:{offset:y.WINNER_INDEX_OFFSETS[+t],bytes:this.pubkey.toBase58()}}]});case 2:return r.abrupt("return",r.sent.map((function(e){return y.BidRedemptionTicket.from(e)})));case 3:case"end":return r.stop()}}),r,this)})))}}],[{key:"isCompatible",value:function(e){return r.isAuctionManagerV1(e)||r.isAuctionManagerV2(e)}},{key:"isAuctionManagerV1",value:function(e){return e[0]===v.MetaplexKey.AuctionManagerV1}},{key:"isAuctionManagerV2",value:function(e){return e[0]===v.MetaplexKey.AuctionManagerV2}},{key:"getPDA",value:function(e){return v.MetaplexProgram.findProgramAddress([_.Buffer.from(v.MetaplexProgram.PREFIX),new p.PublicKey(e).toBuffer()])}},{key:"findMany",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return h(this,void 0,void 0,o().mark((function n(){return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,v.MetaplexProgram.getProgramAccounts(e,{filters:[{memcmp:{offset:0,bytes:g.default.encode(_.Buffer.from([v.MetaplexKey.AuctionManagerV2]))}},t.store&&{memcmp:{offset:1,bytes:new p.PublicKey(t.store).toBase58()}},t.authority&&{memcmp:{offset:33,bytes:new p.PublicKey(t.authority).toBase58()}}].filter(Boolean)});case 2:return n.abrupt("return",n.sent.map((function(e){return r.from(e)})));case 3:case"end":return n.stop()}}),n)})))}}]),r}(x.Account);t.AuctionManager=A},7236:function(e,t,r){"use strict";var n=r(7061).default,i=r(6690).default,o=r(9728).default,a=r(1655).default,s=r(6389).default,u=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{u(n.next(e))}catch(t){o(t)}}function s(e){try{u(n.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.AuctionWinnerTokenTypeTracker=void 0;var l=r(3340),h=r(6322),f=c(r(518)),d=r(9778),p=r(3410),m=function(e){a(r,e);var t=s(r);function r(e,n){var o;if(i(this,r),!(o=t.call(this,e,n)).assertOwner(p.MetaplexProgram.PUBKEY))throw(0,l.ERROR_INVALID_OWNER)();if(!r.isCompatible(o.info.data))throw(0,l.ERROR_INVALID_ACCOUNT_DATA)();return o.data=g(o.info.data),o}return o(r,null,[{key:"isCompatible",value:function(e){return e[0]===p.MetaplexKey.AuctionWinnerTokenTypeTrackerV1}},{key:"getPDA",value:function(e){return u(this,void 0,void 0,n().mark((function t(){return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",p.MetaplexProgram.findProgramAddress([d.Buffer.from(p.MetaplexProgram.PREFIX),p.MetaplexProgram.PUBKEY.toBuffer(),new h.PublicKey(e).toBuffer(),d.Buffer.from(p.MetaplexProgram.TOTALS)]));case 1:case"end":return t.stop()}}),t)})))}}]),r}(l.Account);t.AuctionWinnerTokenTypeTracker=m;var g=function(e){for(var t={key:p.MetaplexKey.SafetyDepositConfigV1,amountType:e[1],lengthType:e[2],amountRanges:[]},r=new f.default(e.slice(3,7),"le"),n=7,i=0;i<r.toNumber();i++){var o=(0,l.getBNFromData)(e,n,t.amountType);n+=t.amountType;var a=(0,l.getBNFromData)(e,n,t.lengthType);n+=t.lengthType,t.amountRanges.push({amount:o,length:a})}return t}},5562:function(e,t,r){"use strict";var n=r(6690).default,i=r(9728).default,o=r(1655).default,a=r(6389).default,s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.BidRedemptionTicket=t.WINNER_INDEX_OFFSETS=void 0;var u=s(r(518)),c=s(r(6315)),l=r(3410),h=r(3340);t.WINNER_INDEX_OFFSETS=[2,10];var f=function(e){o(s,e);var r=a(s);function s(e,i){var o;if(n(this,s),!(o=r.call(this,e,i)).assertOwner(l.MetaplexProgram.PUBKEY))throw(0,h.ERROR_INVALID_OWNER)();if(s.isBidRedemptionTicketV1(o.info.data))throw(0,h.ERROR_DEPRECATED_ACCOUNT_DATA)();if(!s.isBidRedemptionTicketV2(o.info.data))throw(0,h.ERROR_INVALID_ACCOUNT_DATA)();var a=o.info.data.toJSON().data,f=0!==a[1]&&new u.default(a.slice(1,9),"le"),d=t.WINNER_INDEX_OFFSETS[+!!f];return o.data={key:l.MetaplexKey.BidRedemptionTicketV2,winnerIndex:f,data:a,auctionManager:c.default.encode(a.slice(d,d+32))},o}return i(s,null,[{key:"isCompatible",value:function(e){return s.isBidRedemptionTicketV1(e)||s.isBidRedemptionTicketV2(e)}},{key:"isBidRedemptionTicketV1",value:function(e){return e[0]===l.MetaplexKey.BidRedemptionTicketV1}},{key:"isBidRedemptionTicketV2",value:function(e){return e[0]===l.MetaplexKey.BidRedemptionTicketV2}}]),s}(h.Account);t.BidRedemptionTicket=f},6671:function(e,t,r){"use strict";var n,i=r(7061).default,o=r(9728).default,a=r(6690).default,s=r(1655).default,u=r(6389).default,c=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{u(n.next(e))}catch(t){o(t)}}function s(e){try{u(n.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PayoutTicket=t.PayoutTicketData=void 0;var h=r(6322),f=l(r(6315)),d=r(3340),p=r(3410),m=r(9778),g=function(e){s(r,e);var t=u(r);function r(e){var n;return a(this,r),(n=t.call(this,e)).key=p.MetaplexKey.PayoutTicketV1,n}return o(r)}(d.Borsh.Data);t.PayoutTicketData=g,n=g,g.SCHEMA=n.struct([["key","u8"],["recipient","pubkeyAsString"],["amountPaid","u64"]]);var y=function(e){s(r,e);var t=u(r);function r(e,n){var i;if(a(this,r),!(i=t.call(this,e,n)).assertOwner(p.MetaplexProgram.PUBKEY))throw(0,d.ERROR_INVALID_OWNER)();if(!r.isCompatible(i.info.data))throw(0,d.ERROR_INVALID_ACCOUNT_DATA)();return i.data=g.deserialize(i.info.data),i}return o(r,null,[{key:"isCompatible",value:function(e){return e[0]===p.MetaplexKey.PayoutTicketV1}},{key:"getPayoutTicketsByRecipient",value:function(e,t){return c(this,void 0,void 0,i().mark((function n(){return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,p.MetaplexProgram.getProgramAccounts(e,{filters:[{memcmp:{offset:0,bytes:f.default.encode(m.Buffer.from([p.MetaplexKey.PayoutTicketV1]))}},{memcmp:{offset:1,bytes:new h.PublicKey(t).toBase58()}}]});case 2:return n.abrupt("return",n.sent.map((function(e){return r.from(e)})));case 3:case"end":return n.stop()}}),n)})))}}]),r}(d.Account);t.PayoutTicket=y},9714:function(e,t,r){"use strict";var n,i=r(7061).default,o=r(9728).default,a=r(6690).default,s=r(1655).default,u=r(6389).default,c=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{u(n.next(e))}catch(t){o(t)}}function s(e){try{u(n.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.PrizeTrackingTicket=t.PrizeTrackingTicketData=void 0;var l=r(6322),h=r(3340),f=r(3410),d=r(9778),p=function(e){s(r,e);var t=u(r);function r(e){var n;return a(this,r),(n=t.call(this,e)).key=f.MetaplexKey.PrizeTrackingTicketV1,n.key=f.MetaplexKey.PrizeTrackingTicketV1,n}return o(r)}(h.Borsh.Data);t.PrizeTrackingTicketData=p,n=p,p.SCHEMA=n.struct([["key","u8"],["metadata","pubkeyAsString"],["supplySnapshot","u64"],["expectedRedemptions","u64"],["redemptions","u64"]]);var m=function(e){s(r,e);var t=u(r);function r(e,n){var i;if(a(this,r),!(i=t.call(this,e,n)).assertOwner(f.MetaplexProgram.PUBKEY))throw(0,h.ERROR_INVALID_OWNER)();if(!r.isCompatible(i.info.data))throw(0,h.ERROR_INVALID_ACCOUNT_DATA)();return i.data=p.deserialize(i.info.data),i}return o(r,null,[{key:"isCompatible",value:function(e){return e[0]===f.MetaplexKey.PrizeTrackingTicketV1}},{key:"getPDA",value:function(e,t){return c(this,void 0,void 0,i().mark((function r(){return i().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",f.MetaplexProgram.findProgramAddress([d.Buffer.from(f.MetaplexProgram.PREFIX),f.MetaplexProgram.PUBKEY.toBuffer(),new l.PublicKey(e).toBuffer(),new l.PublicKey(t).toBuffer()]));case 1:case"end":return r.stop()}}),r)})))}}]),r}(h.Account);t.PrizeTrackingTicket=m},9370:function(e,t,r){"use strict";var n=r(7061).default,i=r(6690).default,o=r(9728).default,a=r(1655).default,s=r(6389).default,u=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{u(n.next(e))}catch(t){o(t)}}function s(e){try{u(n.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.SafetyDepositConfig=t.NonWinningConstraint=t.WinningConstraint=t.WinningConfigType=void 0;var l=r(6322),h=c(r(518)),f=c(r(6315)),d=r(3340),p=r(3410),m=r(9778);!function(e){e[e.TokenOnlyTransfer=0]="TokenOnlyTransfer",e[e.FullRightsTransfer=1]="FullRightsTransfer",e[e.PrintingV1=2]="PrintingV1",e[e.PrintingV2=3]="PrintingV2",e[e.Participation=4]="Participation"}(t.WinningConfigType||(t.WinningConfigType={})),function(e){e[e.NoParticipationPrize=0]="NoParticipationPrize",e[e.ParticipationPrizeGiven=1]="ParticipationPrizeGiven"}(t.WinningConstraint||(t.WinningConstraint={})),function(e){e[e.NoParticipationPrize=0]="NoParticipationPrize",e[e.GivenForFixedPrice=1]="GivenForFixedPrice",e[e.GivenForBidPrice=2]="GivenForBidPrice"}(t.NonWinningConstraint||(t.NonWinningConstraint={}));var g=function(e){a(r,e);var t=s(r);function r(e,n){var o;if(i(this,r),!(o=t.call(this,e,n)).assertOwner(p.MetaplexProgram.PUBKEY))throw(0,d.ERROR_INVALID_OWNER)();if(!r.isCompatible(o.info.data))throw(0,d.ERROR_INVALID_ACCOUNT_DATA)();return o.data=y(o.info.data),o}return o(r,null,[{key:"isCompatible",value:function(e){return e[0]===p.MetaplexKey.SafetyDepositConfigV1}},{key:"getPDA",value:function(e,t){return u(this,void 0,void 0,n().mark((function r(){return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",p.MetaplexProgram.findProgramAddress([m.Buffer.from(p.MetaplexProgram.PREFIX),p.MetaplexProgram.PUBKEY.toBuffer(),new l.PublicKey(e).toBuffer(),new l.PublicKey(t).toBuffer()]));case 1:case"end":return r.stop()}}),r)})))}}]),r}(d.Account);t.SafetyDepositConfig=g;var y=function(e){for(var t={key:p.MetaplexKey.SafetyDepositConfigV1,auctionManager:f.default.encode(e.slice(1,33)),order:new h.default(e.slice(33,41),"le"),winningConfigType:e[41],amountType:e[42],lengthType:e[43],amountRanges:[],participationConfig:null,participationState:null},r=new h.default(e.slice(44,48),"le"),n=48,i=0;i<r.toNumber();i++){var o=(0,d.getBNFromData)(e,n,t.amountType);n+=t.amountType;var a=(0,d.getBNFromData)(e,n,t.lengthType);n+=t.lengthType,t.amountRanges.push({amount:o,length:a})}if(0==e[n])n+=1,t.participationConfig=null;else{var s=e[n+1],u=e[n+2],c=null;1==e[n+=3]?(c=new h.default(e.slice(n+1,n+9),"le"),n+=9):n+=1,t.participationConfig={winnerConstraint:s,nonWinningConstraint:u,fixedPrice:c}}if(0==e[n])n+=1,t.participationState=null;else{var l=new h.default(e.slice(n+1,n+9),"le");n+=9,t.participationState={collectedToAcceptPayment:l}}return t}},801:function(e,t,r){"use strict";var n,i=r(7061).default,o=r(9728).default,a=r(6690).default,s=r(1655).default,u=r(6389).default,c=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{u(n.next(e))}catch(t){o(t)}}function s(e){try{u(n.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Store=t.StoreData=void 0;var h=r(3340),f=r(3410),d=r(6322),p=l(r(6315)),m=r(3511),g=r(9093),y=r(9778),v=function(e){s(r,e);var t=u(r);function r(e){var n;return a(this,r),(n=t.call(this,e)).key=f.MetaplexKey.StoreV1,n.public=!0,n.key=f.MetaplexKey.StoreV1,n}return o(r)}(h.Borsh.Data);t.StoreData=v,n=v,v.SCHEMA=n.struct([["key","u8"],["public","u8"],["auctionProgram","pubkeyAsString"],["tokenVaultProgram","pubkeyAsString"],["tokenMetadataProgram","pubkeyAsString"],["tokenProgram","pubkeyAsString"]]);var _=function(e){s(r,e);var t=u(r);function r(e,n){var i;if(a(this,r),!(i=t.call(this,e,n)).assertOwner(f.MetaplexProgram.PUBKEY))throw(0,h.ERROR_INVALID_OWNER)();if(!r.isCompatible(i.info.data))throw(0,h.ERROR_INVALID_ACCOUNT_DATA)();return i.data=v.deserialize(i.info.data),i}return o(r,[{key:"getWhitelistedCreators",value:function(e){return c(this,void 0,void 0,i().mark((function t(){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,f.MetaplexProgram.getProgramAccounts(e,{filters:[{memcmp:{offset:0,bytes:p.default.encode(y.Buffer.from([f.MetaplexKey.WhitelistedCreatorV1]))}}]});case 2:return t.abrupt("return",t.sent.map((function(e){return m.WhitelistedCreator.from(e)})));case 3:case"end":return t.stop()}}),t)})))}},{key:"getAuctionManagers",value:function(e){return c(this,void 0,void 0,i().mark((function t(){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,f.MetaplexProgram.getProgramAccounts(e,{filters:[{memcmp:{offset:0,bytes:p.default.encode(y.Buffer.from([f.MetaplexKey.AuctionManagerV2]))}},{memcmp:{offset:1,bytes:this.pubkey.toBase58()}}]});case 2:return t.abrupt("return",t.sent.map((function(e){return g.AuctionManager.from(e)})));case 3:case"end":return t.stop()}}),t,this)})))}}],[{key:"isCompatible",value:function(e){return e[0]===f.MetaplexKey.StoreV1}},{key:"getPDA",value:function(e){return c(this,void 0,void 0,i().mark((function t(){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",f.MetaplexProgram.findProgramAddress([y.Buffer.from(f.MetaplexProgram.PREFIX),f.MetaplexProgram.PUBKEY.toBuffer(),new d.PublicKey(e).toBuffer()]));case 1:case"end":return t.stop()}}),t)})))}}]),r}(h.Account);t.Store=_},6450:function(e,t,r){"use strict";var n,i=r(7061).default,o=r(9728).default,a=r(6690).default,s=r(1655).default,u=r(6389).default,c=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{u(n.next(e))}catch(t){o(t)}}function s(e){try{u(n.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.StoreConfig=t.StoreConfigData=void 0;var l=r(3340),h=r(6322),f=r(9778),d=r(3410),p=function(e){s(r,e);var t=u(r);function r(e){var n;return a(this,r),(n=t.call(this,e)).key=d.MetaplexKey.StoreConfigV1,n.key=d.MetaplexKey.StoreConfigV1,n}return o(r)}(l.Borsh.Data);t.StoreConfigData=p,n=p,p.SCHEMA=n.struct([["key","u8"],["settingsUri",{kind:"option",type:"string"}]]);var m=function(e){s(r,e);var t=u(r);function r(e,n){var i;if(a(this,r),!(i=t.call(this,e,n)).assertOwner(d.MetaplexProgram.PUBKEY))throw(0,l.ERROR_INVALID_OWNER)();if(!r.isCompatible(i.info.data))throw(0,l.ERROR_INVALID_ACCOUNT_DATA)();return i.data=p.deserialize(i.info.data),i}return o(r,null,[{key:"isCompatible",value:function(e){return e[0]===d.MetaplexKey.StoreConfigV1}},{key:"getPDA",value:function(e){return c(this,void 0,void 0,i().mark((function t(){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",d.MetaplexProgram.findProgramAddress([f.Buffer.from(d.MetaplexProgram.PREFIX),d.MetaplexProgram.PUBKEY.toBuffer(),f.Buffer.from(d.MetaplexProgram.CONFIG),new h.PublicKey(e).toBuffer()]));case 1:case"end":return t.stop()}}),t)})))}}]),r}(l.Account);t.StoreConfig=m},3511:function(e,t,r){"use strict";var n,i=r(7061).default,o=r(9728).default,a=r(6690).default,s=r(1655).default,u=r(6389).default,c=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{u(n.next(e))}catch(t){o(t)}}function s(e){try{u(n.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.WhitelistedCreator=t.WhitelistedCreatorData=void 0;var l=r(3340),h=r(3410),f=r(9778),d=r(6322),p=function(e){s(r,e);var t=u(r);function r(e){var n;return a(this,r),(n=t.call(this,e)).key=h.MetaplexKey.WhitelistedCreatorV1,n.activated=!0,n.key=h.MetaplexKey.WhitelistedCreatorV1,n}return o(r)}(l.Borsh.Data);t.WhitelistedCreatorData=p,n=p,p.SCHEMA=n.struct([["key","u8"],["address","pubkeyAsString"],["activated","u8"]]);var m=function(e){s(r,e);var t=u(r);function r(e,n){var i;if(a(this,r),!(i=t.call(this,e,n)).assertOwner(h.MetaplexProgram.PUBKEY))throw(0,l.ERROR_INVALID_OWNER)();if(!r.isCompatible(i.info.data))throw(0,l.ERROR_INVALID_ACCOUNT_DATA)();return i.data=p.deserialize(i.info.data),i}return o(r,null,[{key:"isCompatible",value:function(e){return e[0]===h.MetaplexKey.WhitelistedCreatorV1}},{key:"getPDA",value:function(e,t){return c(this,void 0,void 0,i().mark((function r(){return i().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",h.MetaplexProgram.findProgramAddress([f.Buffer.from(h.MetaplexProgram.PREFIX),h.MetaplexProgram.PUBKEY.toBuffer(),new d.PublicKey(e).toBuffer(),new d.PublicKey(t).toBuffer()]));case 1:case"end":return r.stop()}}),r)})))}}]),r}(l.Account);t.WhitelistedCreator=m},3604:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r(9093),t),i(r(5562),t),i(r(6671),t),i(r(9714),t),i(r(9370),t),i(r(801),t),i(r(6450),t),i(r(3511),t),i(r(7236),t),i(r(3410),t),i(r(2374),t)},8845:function(e,t,r){"use strict";var n,i=r(9728).default,o=r(6690).default,a=r(1655).default,s=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.ClaimBid=t.ClaimBidArgs=void 0;var u=r(3340),c=r(3258),l=r(3717),h=r(6322),f=r(3410),d=function(e){a(r,e);var t=s(r);function r(){var e;return o(this,r),(e=t.apply(this,arguments)).instruction=6,e}return i(r)}(u.Borsh.Data);t.ClaimBidArgs=d,n=d,d.SCHEMA=n.struct([["instruction","u8"]]);var p=function(e){a(r,e);var t=s(r);function r(e,n){var i;o(this,r),i=t.call(this,e);var a=n.store,s=n.vault,u=n.auction,p=n.auctionExtended,m=n.auctionManager,g=n.bidder,y=n.bidderPot,v=n.bidderPotToken,_=n.acceptPayment,b=n.tokenMint,x=d.serialize();return i.add(new h.TransactionInstruction({keys:[{pubkey:_,isSigner:!1,isWritable:!0},{pubkey:v,isSigner:!1,isWritable:!0},{pubkey:y,isSigner:!1,isWritable:!0},{pubkey:m,isSigner:!1,isWritable:!0},{pubkey:u,isSigner:!1,isWritable:!1},{pubkey:g,isSigner:!1,isWritable:!1},{pubkey:b,isSigner:!1,isWritable:!1},{pubkey:s,isSigner:!1,isWritable:!1},{pubkey:a,isSigner:!1,isWritable:!1},{pubkey:c.AuctionProgram.PUBKEY,isSigner:!1,isWritable:!1},{pubkey:h.SYSVAR_CLOCK_PUBKEY,isSigner:!1,isWritable:!1},{pubkey:l.TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1},{pubkey:p,isSigner:!1,isWritable:!1}],programId:f.MetaplexProgram.PUBKEY,data:x})),i}return i(r)}(u.Transaction);t.ClaimBid=p},9767:function(e,t,r){"use strict";var n,i=r(9728).default,o=r(6690).default,a=r(1655).default,s=r(6389).default,u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.EndAuction=t.EndAuctionArgs=void 0;var c=u(r(518)),l=r(3340),h=r(6322),f=r(3258),d=r(3410),p=function(e){a(r,e);var t=s(r);function r(){var e;return o(this,r),(e=t.apply(this,arguments)).instruction=20,e}return i(r)}(l.Borsh.Data);t.EndAuctionArgs=p,n=p,p.SCHEMA=n.struct([["instruction","u8"],["reveal",{kind:"option",type:[c.default,c.default]}]]);var m=function(e){a(r,e);var t=s(r);function r(e,n){var i;o(this,r),i=t.call(this,e);var a=n.store,s=n.auction,u=n.auctionExtended,c=n.auctionManager,l=n.auctionManagerAuthority,m=n.reveal,g=void 0===m?null:m,y=p.serialize({reveal:g});return i.add(new h.TransactionInstruction({keys:[{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:u,isSigner:!1,isWritable:!1},{pubkey:l,isSigner:!0,isWritable:!1},{pubkey:a,isSigner:!1,isWritable:!1},{pubkey:f.AuctionProgram.PUBKEY,isSigner:!1,isWritable:!1},{pubkey:h.SYSVAR_CLOCK_PUBKEY,isSigner:!1,isWritable:!1}],programId:d.MetaplexProgram.PUBKEY,data:y})),i}return i(r)}(l.Transaction);t.EndAuction=m},6057:function(e,t,r){"use strict";var n,i=r(9728).default,o=r(6690).default,a=r(1655).default,s=r(6389).default,u=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.InitAuctionManagerV2=t.InitAuctionManagerV2Args=void 0;var c=r(3340),l=r(6322),h=u(r(518)),f=r(3410),d=function(e){a(r,e);var t=s(r);function r(){var e;return o(this,r),(e=t.apply(this,arguments)).instruction=17,e.amountType=c.TupleNumericType.U8,e.lengthType=c.TupleNumericType.U8,e.maxRanges=new h.default(1),e}return i(r)}(c.Borsh.Data);t.InitAuctionManagerV2Args=d,n=d,d.SCHEMA=n.struct([["instruction","u8"],["amountType","u8"],["lengthType","u8"],["maxRanges","u64"]]);var p=function(e){a(r,e);var t=s(r);function r(e,n){var i;o(this,r),i=t.call(this,e);var a=e.feePayer,s=n.store,u=n.vault,c=n.auction,h=n.auctionManager,p=n.auctionManagerAuthority,m=n.acceptPaymentAccount,g=n.tokenTracker,y=n.amountType,v=n.lengthType,_=n.maxRanges,b=d.serialize({amountType:y,lengthType:v,maxRanges:_});return i.add(new l.TransactionInstruction({keys:[{pubkey:h,isSigner:!1,isWritable:!0},{pubkey:g,isSigner:!1,isWritable:!0},{pubkey:u,isSigner:!1,isWritable:!1},{pubkey:c,isSigner:!1,isWritable:!1},{pubkey:p,isSigner:!1,isWritable:!1},{pubkey:a,isSigner:!0,isWritable:!1},{pubkey:m,isSigner:!1,isWritable:!1},{pubkey:s,isSigner:!1,isWritable:!1},{pubkey:l.SystemProgram.programId,isSigner:!1,isWritable:!1},{pubkey:l.SYSVAR_RENT_PUBKEY,isSigner:!1,isWritable:!1}],programId:f.MetaplexProgram.PUBKEY,data:b})),i}return i(r)}(c.Transaction);t.InitAuctionManagerV2=p},5081:function(e,t,r){"use strict";var n,i,o=r(861).default,a=r(9728).default,s=r(6690).default,u=r(1655).default,c=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.RedeemBid=t.RedeemUnusedWinningConfigItemsAsAuctioneerArgs=t.ProxyCallAddress=t.RedeemBidArgs=void 0;var l,h=r(3340),f=r(3717),d=r(6322),p=r(7398),m=r(261),g=r(3410),y=function(e){u(r,e);var t=c(r);function r(){var e;return s(this,r),(e=t.apply(this,arguments)).instruction=2,e}return a(r)}(h.Borsh.Data);t.RedeemBidArgs=y,n=y,y.SCHEMA=n.struct([["instruction","u8"]]),function(e){e[e.RedeemBid=0]="RedeemBid",e[e.RedeemFullRightsTransferBid=1]="RedeemFullRightsTransferBid"}(l=t.ProxyCallAddress||(t.ProxyCallAddress={}));var v=function(e){u(r,e);var t=c(r);function r(){var e;return s(this,r),(e=t.apply(this,arguments)).instruction=12,e}return a(r)}(h.Borsh.Data);t.RedeemUnusedWinningConfigItemsAsAuctioneerArgs=v,i=v,v.SCHEMA=i.struct([["instruction","u8"],["winningConfigItemIndex","u8"],["proxyCall","u8"]]);var _=function(e){u(r,e);var t=c(r);function r(e,n){var i;s(this,r),i=t.call(this,e);var a=e.feePayer,u=n.store,c=n.vault,h=n.auction,_=n.auctionExtended,b=n.auctionManager,x=n.bidRedemption,w=n.bidderMeta,k=n.safetyDepositTokenStore,A=n.destination,E=n.safetyDeposit,S=n.fractionMint,T=n.bidder,M=n.isPrintingType,I=n.safetyDepositConfig,P=n.transferAuthority,C=n.masterEdition,B=n.reservationList,D=n.auctioneerReclaimIndex,R=D?v.serialize({winningConfigItemIndex:D,proxyCall:l.RedeemBid}):y.serialize();return i.add(new d.TransactionInstruction({keys:[{pubkey:b,isSigner:!1,isWritable:!0},{pubkey:k,isSigner:!1,isWritable:!0},{pubkey:A,isSigner:!1,isWritable:!0},{pubkey:x,isSigner:!1,isWritable:!0},{pubkey:E,isSigner:!1,isWritable:!0},{pubkey:c,isSigner:!1,isWritable:!0},{pubkey:S,isSigner:!1,isWritable:!0},{pubkey:h,isSigner:!1,isWritable:!1},{pubkey:w,isSigner:!1,isWritable:!1},{pubkey:T,isSigner:!1,isWritable:!1},{pubkey:a,isSigner:!0,isWritable:!1},{pubkey:f.TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1},{pubkey:m.VaultProgram.PUBKEY,isSigner:!1,isWritable:!1},{pubkey:p.MetadataProgram.PUBKEY,isSigner:!1,isWritable:!1},{pubkey:u,isSigner:!1,isWritable:!1},{pubkey:d.SystemProgram.programId,isSigner:!1,isWritable:!1},{pubkey:d.SYSVAR_RENT_PUBKEY,isSigner:!1,isWritable:!1},{pubkey:P,isSigner:!1,isWritable:!1},{pubkey:I,isSigner:!1,isWritable:!1},{pubkey:_,isSigner:!1,isWritable:!1}].concat(o(M&&C&&B?[{pubkey:C,isSigner:!1,isWritable:!0},{pubkey:B,isSigner:!1,isWritable:!0}]:[])),programId:g.MetaplexProgram.PUBKEY,data:R})),i}return a(r)}(h.Transaction);t.RedeemBid=_},1231:function(e,t,r){"use strict";var n,i=r(9728).default,o=r(6690).default,a=r(1655).default,s=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.RedeemFullRightsTransferBid=t.RedeemFullRightsTransferBidArgs=void 0;var u=r(3340),c=r(3717),l=r(6322),h=r(7398),f=r(261),d=r(3410),p=r(5081),m=function(e){a(r,e);var t=s(r);function r(){var e;return o(this,r),(e=t.apply(this,arguments)).instruction=3,e}return i(r)}(u.Borsh.Data);t.RedeemFullRightsTransferBidArgs=m,n=m,m.SCHEMA=n.struct([["instruction","u8"]]);var g=function(e){a(r,e);var t=s(r);function r(e,n){var i;o(this,r),i=t.call(this,e);var a=e.feePayer,s=n.store,u=n.vault,g=n.auction,y=n.auctionExtended,v=n.auctionManager,_=n.bidRedemption,b=n.bidMetadata,x=n.safetyDepositTokenStore,w=n.destination,k=n.safetyDeposit,A=n.fractionMint,E=n.bidder,S=n.safetyDepositConfig,T=n.transferAuthority,M=n.masterMetadata,I=n.newAuthority,P=n.auctioneerReclaimIndex,C=P?p.RedeemUnusedWinningConfigItemsAsAuctioneerArgs.serialize({winningConfigItemIndex:P,proxyCall:p.ProxyCallAddress.RedeemFullRightsTransferBid}):m.serialize();return i.add(new l.TransactionInstruction({keys:[{pubkey:v,isSigner:!1,isWritable:!0},{pubkey:x,isSigner:!1,isWritable:!0},{pubkey:w,isSigner:!1,isWritable:!0},{pubkey:_,isSigner:!1,isWritable:!0},{pubkey:k,isSigner:!1,isWritable:!0},{pubkey:u,isSigner:!1,isWritable:!0},{pubkey:A,isSigner:!1,isWritable:!0},{pubkey:g,isSigner:!1,isWritable:!1},{pubkey:b,isSigner:!1,isWritable:!1},{pubkey:E,isSigner:!1,isWritable:!1},{pubkey:a,isSigner:!0,isWritable:!1},{pubkey:c.TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1},{pubkey:f.VaultProgram.PUBKEY,isSigner:!1,isWritable:!1},{pubkey:h.MetadataProgram.PUBKEY,isSigner:!1,isWritable:!1},{pubkey:s,isSigner:!1,isWritable:!1},{pubkey:l.SystemProgram.programId,isSigner:!1,isWritable:!1},{pubkey:l.SYSVAR_RENT_PUBKEY,isSigner:!1,isWritable:!1},{pubkey:M,isSigner:!1,isWritable:!0},{pubkey:I,isSigner:!1,isWritable:!1},{pubkey:T,isSigner:!1,isWritable:!1},{pubkey:S,isSigner:!1,isWritable:!1},{pubkey:y,isSigner:!1,isWritable:!1}],programId:d.MetaplexProgram.PUBKEY,data:C})),i}return i(r)}(u.Transaction);t.RedeemFullRightsTransferBid=g},9658:function(e,t,r){"use strict";var n,i=r(9728).default,o=r(6690).default,a=r(1655).default,s=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.RedeemParticipationBidV3=t.RedeemParticipationBidV3Args=void 0;var u=r(3340),c=r(7398),l=r(261),h=r(3717),f=r(6322),d=r(3410),p=function(e){a(r,e);var t=s(r);function r(){var e;return o(this,r),(e=t.apply(this,arguments)).instruction=19,e}return i(r)}(u.Borsh.Data);t.RedeemParticipationBidV3Args=p,n=p,p.SCHEMA=n.struct([["instruction","u8"],["winIndex",{kind:"option",type:"u64"}]]);var m=function(e){a(r,e);var t=s(r);function r(e,n){var i;o(this,r),i=t.call(this,e);var a=e.feePayer,s=n.store,u=n.vault,m=n.auction,g=n.auctionExtended,y=n.auctionManager,v=n.bidRedemption,_=n.bidMetadata,b=n.safetyDepositTokenStore,x=n.destination,w=n.safetyDeposit,k=n.bidder,A=n.safetyDepositConfig,E=n.metadata,S=n.prizeTrackingTicket,T=n.newMetadata,M=n.newEdition,I=n.masterEdition,P=n.newMint,C=n.editionMark,B=n.winIndex,D=n.transferAuthority,R=n.acceptPaymentAccount,L=n.tokenPaymentAccount,O=p.serialize({winIndex:B});return i.add(new f.TransactionInstruction({keys:[{pubkey:y,isSigner:!1,isWritable:!0},{pubkey:b,isSigner:!1,isWritable:!0},{pubkey:x,isSigner:!1,isWritable:!0},{pubkey:v,isSigner:!1,isWritable:!0},{pubkey:w,isSigner:!1,isWritable:!1},{pubkey:u,isSigner:!1,isWritable:!1},{pubkey:A,isSigner:!1,isWritable:!0},{pubkey:m,isSigner:!1,isWritable:!1},{pubkey:_,isSigner:!1,isWritable:!1},{pubkey:k,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!0,isWritable:!0},{pubkey:h.TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1},{pubkey:l.VaultProgram.PUBKEY,isSigner:!1,isWritable:!1},{pubkey:c.MetadataProgram.PUBKEY,isSigner:!1,isWritable:!1},{pubkey:s,isSigner:!1,isWritable:!1},{pubkey:f.SystemProgram.programId,isSigner:!1,isWritable:!1},{pubkey:f.SYSVAR_RENT_PUBKEY,isSigner:!1,isWritable:!1},{pubkey:D,isSigner:!0,isWritable:!1},{pubkey:R,isSigner:!1,isWritable:!0},{pubkey:L,isSigner:!1,isWritable:!0},{pubkey:S,isSigner:!1,isWritable:!0},{pubkey:T,isSigner:!1,isWritable:!0},{pubkey:M,isSigner:!1,isWritable:!0},{pubkey:I,isSigner:!1,isWritable:!0},{pubkey:P,isSigner:!1,isWritable:!0},{pubkey:C,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!0,isWritable:!1},{pubkey:E,isSigner:!1,isWritable:!1},{pubkey:g,isSigner:!1,isWritable:!1}],programId:d.MetaplexProgram.PUBKEY,data:O})),i}return i(r)}(u.Transaction);t.RedeemParticipationBidV3=m},8667:function(e,t,r){"use strict";var n,i=r(9728).default,o=r(6690).default,a=r(1655).default,s=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.RedeemPrintingV2Bid=t.RedeemPrintingV2BidArgs=void 0;var u=r(3340),c=r(261),l=r(7398),h=r(3717),f=r(6322),d=r(3410),p=function(e){a(r,e);var t=s(r);function r(){var e;return o(this,r),(e=t.apply(this,arguments)).instruction=14,e}return i(r)}(u.Borsh.Data);t.RedeemPrintingV2BidArgs=p,n=p,p.SCHEMA=n.struct([["instruction","u8"],["editionOffset","u64"],["winIndex","u64"]]);var m=function(e){a(r,e);var t=s(r);function r(e,n){var i;o(this,r),i=t.call(this,e);var a=e.feePayer,s=n.store,u=n.vault,m=n.auction,g=n.auctionExtended,y=n.auctionManager,v=n.bidRedemption,_=n.bidMetadata,b=n.safetyDepositTokenStore,x=n.destination,w=n.safetyDeposit,k=n.bidder,A=n.safetyDepositConfig,E=n.metadata,S=n.prizeTrackingTicket,T=n.newMetadata,M=n.newEdition,I=n.masterEdition,P=n.newMint,C=n.editionMark,B=n.winIndex,D=n.editionOffset,R=p.serialize({winIndex:B,editionOffset:D});return i.add(new f.TransactionInstruction({keys:[{pubkey:y,isSigner:!1,isWritable:!0},{pubkey:b,isSigner:!1,isWritable:!0},{pubkey:x,isSigner:!1,isWritable:!0},{pubkey:v,isSigner:!1,isWritable:!0},{pubkey:w,isSigner:!1,isWritable:!0},{pubkey:u,isSigner:!1,isWritable:!0},{pubkey:A,isSigner:!1,isWritable:!1},{pubkey:m,isSigner:!1,isWritable:!1},{pubkey:_,isSigner:!1,isWritable:!1},{pubkey:k,isSigner:!1,isWritable:!1},{pubkey:a,isSigner:!0,isWritable:!0},{pubkey:h.TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1},{pubkey:c.VaultProgram.PUBKEY,isSigner:!1,isWritable:!1},{pubkey:l.MetadataProgram.PUBKEY,isSigner:!1,isWritable:!1},{pubkey:s,isSigner:!1,isWritable:!1},{pubkey:f.SystemProgram.programId,isSigner:!1,isWritable:!1},{pubkey:f.SYSVAR_RENT_PUBKEY,isSigner:!1,isWritable:!1},{pubkey:S,isSigner:!1,isWritable:!0},{pubkey:T,isSigner:!1,isWritable:!0},{pubkey:M,isSigner:!1,isWritable:!0},{pubkey:I,isSigner:!1,isWritable:!0},{pubkey:P,isSigner:!1,isWritable:!0},{pubkey:C,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!0,isWritable:!1},{pubkey:E,isSigner:!1,isWritable:!1},{pubkey:g,isSigner:!1,isWritable:!1}],programId:d.MetaplexProgram.PUBKEY,data:R})),i}return i(r)}(u.Transaction);t.RedeemPrintingV2Bid=m},4731:function(e,t,r){"use strict";var n,i=r(9728).default,o=r(6690).default,a=r(1655).default,s=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.SetStore=t.SetStoreArgs=void 0;var u=r(3340),c=r(3717),l=r(6322),h=r(7398),f=r(261),d=r(3258),p=r(3410),m=function(e){a(r,e);var t=s(r);function r(){var e;return o(this,r),(e=t.apply(this,arguments)).instruction=8,e}return i(r)}(u.Borsh.Data);t.SetStoreArgs=m,n=m,m.SCHEMA=n.struct([["instruction","u8"],["public","u8"]]);var g=function(e){a(r,e);var t=s(r);function r(e,n){var i;o(this,r),i=t.call(this,e);var a=e.feePayer,s=n.admin,u=n.store,g=n.isPublic,y=m.serialize({public:g});return i.add(new l.TransactionInstruction({keys:[{pubkey:u,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!0,isWritable:!1},{pubkey:a,isSigner:!0,isWritable:!1},{pubkey:c.TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1},{pubkey:f.VaultProgram.PUBKEY,isSigner:!1,isWritable:!1},{pubkey:h.MetadataProgram.PUBKEY,isSigner:!1,isWritable:!1},{pubkey:d.AuctionProgram.PUBKEY,isSigner:!1,isWritable:!1},{pubkey:l.SystemProgram.programId,isSigner:!1,isWritable:!1},{pubkey:l.SYSVAR_RENT_PUBKEY,isSigner:!1,isWritable:!1}],programId:p.MetaplexProgram.PUBKEY,data:y})),i}return i(r)}(u.Transaction);t.SetStore=g},8976:function(e,t,r){"use strict";var n,i=r(9728).default,o=r(6690).default,a=r(1655).default,s=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.SetStoreV2=t.SetStoreV2Args=void 0;var u=r(3717),c=r(6322),l=r(3340),h=r(261),f=r(7398),d=r(3258),p=r(3410),m=function(e){a(r,e);var t=s(r);function r(){var e;return o(this,r),(e=t.apply(this,arguments)).instruction=23,e}return i(r)}(l.Borsh.Data);t.SetStoreV2Args=m,n=m,m.SCHEMA=n.struct([["instruction","u8"],["public","u8"],["settingsUri",{kind:"option",type:"string"}]]);var g=function(e){a(r,e);var t=s(r);function r(e,n){var i;o(this,r),i=t.call(this,e);var a=e.feePayer,s=n.admin,l=n.store,g=n.config,y=n.isPublic,v=n.settingsUri,_=m.serialize({public:y,settingsUri:v});return i.add(new c.TransactionInstruction({keys:[{pubkey:l,isSigner:!1,isWritable:!0},{pubkey:g,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!0,isWritable:!1},{pubkey:a,isSigner:!0,isWritable:!1},{pubkey:u.TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1},{pubkey:h.VaultProgram.PUBKEY,isSigner:!1,isWritable:!1},{pubkey:f.MetadataProgram.PUBKEY,isSigner:!1,isWritable:!1},{pubkey:d.AuctionProgram.PUBKEY,isSigner:!1,isWritable:!1},{pubkey:c.SystemProgram.programId,isSigner:!1,isWritable:!1},{pubkey:c.SYSVAR_RENT_PUBKEY,isSigner:!1,isWritable:!1}],programId:p.MetaplexProgram.PUBKEY,data:_})),i}return i(r)}(l.Transaction);t.SetStoreV2=g},9106:function(e,t,r){"use strict";var n,i=r(9728).default,o=r(6690).default,a=r(1655).default,s=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.SetWhitelistedCreator=t.SetWhitelistedCreatorArgs=void 0;var u=r(3340),c=r(6322),l=r(3410),h=function(e){a(r,e);var t=s(r);function r(){var e;return o(this,r),(e=t.apply(this,arguments)).instruction=9,e}return i(r)}(u.Borsh.Data);t.SetWhitelistedCreatorArgs=h,n=h,h.SCHEMA=n.struct([["instruction","u8"],["activated","u8"]]);var f=function(e){a(r,e);var t=s(r);function r(e,n){var i;o(this,r),i=t.call(this,e);var a=e.feePayer,s=n.admin,u=n.whitelistedCreatorPDA,f=n.store,d=n.creator,p=n.activated,m=h.serialize({activated:p});return i.add(new c.TransactionInstruction({keys:[{pubkey:u,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!0,isWritable:!1},{pubkey:a,isSigner:!0,isWritable:!1},{pubkey:d,isSigner:!1,isWritable:!1},{pubkey:f,isSigner:!1,isWritable:!1},{pubkey:c.SystemProgram.programId,isSigner:!1,isWritable:!1},{pubkey:c.SYSVAR_RENT_PUBKEY,isSigner:!1,isWritable:!1}],programId:l.MetaplexProgram.PUBKEY,data:m})),i}return i(r)}(u.Transaction);t.SetWhitelistedCreator=f},105:function(e,t,r){"use strict";var n,i=r(9728).default,o=r(6690).default,a=r(1655).default,s=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.StartAuction=t.StartAuctionArgs=void 0;var u=r(3340),c=r(6322),l=r(3258),h=r(3410),f=function(e){a(r,e);var t=s(r);function r(){var e;return o(this,r),(e=t.apply(this,arguments)).instruction=5,e}return i(r)}(u.Borsh.Data);t.StartAuctionArgs=f,n=f,f.SCHEMA=n.struct([["instruction","u8"]]);var d=function(e){a(r,e);var t=s(r);function r(e,n){var i;o(this,r),i=t.call(this,e);var a=n.store,s=n.auction,u=n.auctionManager,d=n.auctionManagerAuthority,p=f.serialize();return i.add(new c.TransactionInstruction({keys:[{pubkey:u,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:d,isSigner:!0,isWritable:!1},{pubkey:a,isSigner:!1,isWritable:!1},{pubkey:l.AuctionProgram.PUBKEY,isSigner:!1,isWritable:!1},{pubkey:c.SYSVAR_CLOCK_PUBKEY,isSigner:!1,isWritable:!1}],programId:h.MetaplexProgram.PUBKEY,data:p})),i}return i(r)}(u.Transaction);t.StartAuction=d},2374:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r(8845),t),i(r(9767),t),i(r(6057),t),i(r(5081),t),i(r(1231),t),i(r(8667),t),i(r(4731),t),i(r(8976),t),i(r(9106),t),i(r(105),t),i(r(9658),t)},5397:function(e,t,r){"use strict";var n=r(9728).default,i=r(6690).default,o=r(1655).default,a=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.MetadataProgram=t.MetadataKey=void 0;var s=r(6322),u=r(3340);!function(e){e[e.Uninitialized=0]="Uninitialized",e[e.MetadataV1=4]="MetadataV1",e[e.EditionV1=1]="EditionV1",e[e.MasterEditionV1=2]="MasterEditionV1",e[e.MasterEditionV2=6]="MasterEditionV2",e[e.EditionMarker=7]="EditionMarker"}(t.MetadataKey||(t.MetadataKey={}));var c=function(e){o(r,e);var t=a(r);function r(){return i(this,r),t.apply(this,arguments)}return n(r)}(u.Program);t.MetadataProgram=c,c.PREFIX="metadata",c.PUBKEY=new s.PublicKey(u.config.programs.metadata)},4520:function(e,t,r){"use strict";var n=r(7061).default,i=r(9728).default,o=r(6690).default,a=r(1655).default,s=r(6389).default,u=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{u(n.next(e))}catch(t){o(t)}}function s(e){try{u(n.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Edition=t.EditionData=void 0;var c=r(3340),l=r(5397),h=r(6322),f=r(9778),d=function(e){a(r,e);var t=s(r);function r(e){var n;return o(this,r),(n=t.call(this,e)).key=l.MetadataKey.EditionV1,n}return i(r)}(c.Borsh.Data);t.EditionData=d,d.SCHEMA=d.struct([["key","u8"],["parent","pubkeyAsString"],["edition","u64"]]);var p=function(e){a(r,e);var t=s(r);function r(e,n){var i;if(o(this,r),!(i=t.call(this,e,n)).assertOwner(l.MetadataProgram.PUBKEY))throw(0,c.ERROR_INVALID_OWNER)();if(!r.isCompatible(i.info.data))throw(0,c.ERROR_INVALID_ACCOUNT_DATA)();return i.data=d.deserialize(i.info.data),i}return i(r,null,[{key:"getPDA",value:function(e){return u(this,void 0,void 0,n().mark((function t(){return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",l.MetadataProgram.findProgramAddress([f.Buffer.from(l.MetadataProgram.PREFIX),l.MetadataProgram.PUBKEY.toBuffer(),new h.PublicKey(e).toBuffer(),f.Buffer.from(r.EDITION_PREFIX)]));case 1:case"end":return t.stop()}}),t)})))}},{key:"isCompatible",value:function(e){return e[0]===l.MetadataKey.EditionV1}}]),r}(c.Account);t.Edition=p,p.EDITION_PREFIX="edition"},4231:function(e,t,r){"use strict";var n=r(7061).default,i=r(6690).default,o=r(9728).default,a=r(1655).default,s=r(6389).default,u=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{u(n.next(e))}catch(t){o(t)}}function s(e){try{u(n.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.EditionMarker=t.EditionMarkerData=void 0;var c=r(3340),l=r(6322),h=r(4520),f=r(5397),d=r(9778),p=function(e){a(r,e);var t=s(r);function r(e){var n;return i(this,r),(n=t.call(this,e)).key=f.MetadataKey.EditionMarker,n}return o(r,[{key:"editionTaken",value:function(e){var t=e%m.DATA_SIZE,r=Math.floor(t/8);if(r>30)throw Error("Bad index for edition");var n=7-t%8,i=Math.pow(2,n);return 0!=(this.ledger[r]&i)}}]),r}(c.Borsh.Data);t.EditionMarkerData=p,p.SCHEMA=p.struct([["key","u8"],["ledger",[31]]]);var m=function(e){a(r,e);var t=s(r);function r(e,n){var o;if(i(this,r),!(o=t.call(this,e,n)).assertOwner(f.MetadataProgram.PUBKEY))throw(0,c.ERROR_INVALID_OWNER)();if(!r.isCompatible(o.info.data))throw(0,c.ERROR_INVALID_ACCOUNT_DATA)();return o.data=p.deserialize(o.info.data),o}return o(r,null,[{key:"getPDA",value:function(e,t){return u(this,void 0,void 0,n().mark((function r(){var i;return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return i=Math.floor(t.toNumber()/248),r.abrupt("return",f.MetadataProgram.findProgramAddress([d.Buffer.from(f.MetadataProgram.PREFIX),f.MetadataProgram.PUBKEY.toBuffer(),new l.PublicKey(e).toBuffer(),d.Buffer.from(h.Edition.EDITION_PREFIX),d.Buffer.from(i.toString())]));case 2:case"end":return r.stop()}}),r)})))}},{key:"isCompatible",value:function(e){return e[0]===f.MetadataKey.EditionMarker}}]),r}(c.Account);t.EditionMarker=m,m.DATA_SIZE=248},7520:function(e,t,r){"use strict";var n=r(7061).default,i=r(9728).default,o=r(6690).default,a=r(1655).default,s=r(6389).default,u=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{u(n.next(e))}catch(t){o(t)}}function s(e){try{u(n.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.MasterEdition=t.MasterEditionV2Data=t.MasterEditionV1Data=void 0;var l=r(3340),h=c(r(6315)),f=r(4520),d=r(5397),p=r(9778),m=r(6322),g=function(e){a(r,e);var t=s(r);function r(e){var n;return o(this,r),(n=t.call(this,e)).key=d.MetadataKey.MasterEditionV1,n}return i(r)}(l.Borsh.Data);t.MasterEditionV1Data=g,g.SCHEMA=g.struct([["key","u8"],["supply","u64"],["maxSupply",{kind:"option",type:"u64"}],["printingMint","pubkeyAsString"],["oneTimePrintingAuthorizationMint","pubkeyAsString"]]);var y=function(e){a(r,e);var t=s(r);function r(e){var n;return o(this,r),(n=t.call(this,e)).key=d.MetadataKey.MasterEditionV2,n}return i(r)}(l.Borsh.Data);t.MasterEditionV2Data=y,y.SCHEMA=y.struct([["key","u8"],["supply","u64"],["maxSupply",{kind:"option",type:"u64"}]]);var v=function(e){a(r,e);var t=s(r);function r(e,n){var i;if(o(this,r),!(i=t.call(this,e,n)).assertOwner(d.MetadataProgram.PUBKEY))throw(0,l.ERROR_INVALID_OWNER)();if(r.isMasterEditionV1(i.info.data))i.data=g.deserialize(i.info.data);else{if(!r.isMasterEditionV2(i.info.data))throw(0,l.ERROR_INVALID_ACCOUNT_DATA)();i.data=y.deserialize(i.info.data)}return i}return i(r,[{key:"getEditions",value:function(e){return u(this,void 0,void 0,n().mark((function t(){return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,d.MetadataProgram.getProgramAccounts(e,{filters:[{memcmp:{offset:0,bytes:h.default.encode(p.Buffer.from([d.MetadataKey.EditionV1]))}},{memcmp:{offset:1,bytes:this.pubkey.toBase58()}}]});case 2:return t.abrupt("return",t.sent.map((function(e){return f.Edition.from(e)})));case 3:case"end":return t.stop()}}),t,this)})))}}],[{key:"getPDA",value:function(e){return u(this,void 0,void 0,n().mark((function t(){return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",d.MetadataProgram.findProgramAddress([p.Buffer.from(d.MetadataProgram.PREFIX),d.MetadataProgram.PUBKEY.toBuffer(),new m.PublicKey(e).toBuffer(),p.Buffer.from(r.EDITION_PREFIX)]));case 1:case"end":return t.stop()}}),t)})))}},{key:"isCompatible",value:function(e){return r.isMasterEditionV1(e)||r.isMasterEditionV2(e)}},{key:"isMasterEditionV1",value:function(e){return e[0]===d.MetadataKey.MasterEditionV1}},{key:"isMasterEditionV2",value:function(e){return e[0]===d.MetadataKey.MasterEditionV2}}]),r}(l.Account);t.MasterEdition=v,v.EDITION_PREFIX="edition"},6050:function(e,t,r){"use strict";var n=r(7061).default,i=r(861).default,o=r(9728).default,a=r(6690).default,s=r(1655).default,u=r(6389).default,c=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{u(n.next(e))}catch(t){o(t)}}function s(e){try{u(n.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.computeCreatorOffset=t.MAX_CREATOR_LEN=t.MAX_URI_LENGTH=t.MAX_SYMBOL_LENGTH=t.MAX_NAME_LENGTH=t.Metadata=t.MetadataData=t.MetadataDataData=t.Creator=void 0;var h=r(3340),f=r(6322),d=l(r(518)),p=l(r(6315)),m=r(9778),g=r(5397),y=r(4520),v=r(7520),_=function(e){s(r,e);var t=u(r);function r(){return a(this,r),t.apply(this,arguments)}return o(r)}(h.Borsh.Data);t.Creator=_,_.SCHEMA=_.struct([["address","pubkeyAsString"],["verified","u8"],["share","u8"]]);var b=function(e){s(r,e);var t=u(r);function r(e){var n;a(this,r),n=t.call(this,e);var i=new RegExp("\0","g");return n.name=e.name.replace(i,""),n.uri=e.uri.replace(i,""),n.symbol=e.symbol.replace(i,""),n}return o(r)}(h.Borsh.Data);t.MetadataDataData=b,b.SCHEMA=new Map([].concat(i(_.SCHEMA),i(b.struct([["name","string"],["symbol","string"],["uri","string"],["sellerFeeBasisPoints","u16"],["creators",{kind:"option",type:[_]}]]))));var x=function(e){s(r,e);var t=u(r);function r(e){var n;return a(this,r),(n=t.call(this,e)).key=g.MetadataKey.MetadataV1,n}return o(r)}(h.Borsh.Data);t.MetadataData=x,x.SCHEMA=new Map([].concat(i(b.SCHEMA),i(x.struct([["key","u8"],["updateAuthority","pubkeyAsString"],["mint","pubkeyAsString"],["data",b],["primarySaleHappened","u8"],["isMutable","u8"]]))));var w=function(e){s(l,e);var r=u(l);function l(e,t){var n;if(a(this,l),!(n=r.call(this,e,t)).assertOwner(g.MetadataProgram.PUBKEY))throw(0,h.ERROR_INVALID_OWNER)();if(!l.isCompatible(n.info.data))throw(0,h.ERROR_INVALID_ACCOUNT_DATA)();return n.data=x.deserialize(n.info.data),n}return o(l,null,[{key:"isCompatible",value:function(e){return e[0]===g.MetadataKey.MetadataV1}},{key:"getPDA",value:function(e){return c(this,void 0,void 0,n().mark((function t(){return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",g.MetadataProgram.findProgramAddress([m.Buffer.from(g.MetadataProgram.PREFIX),g.MetadataProgram.PUBKEY.toBuffer(),new f.PublicKey(e).toBuffer()]));case 1:case"end":return t.stop()}}),t)})))}},{key:"findMany",value:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return c(this,void 0,void 0,n().mark((function o(){var a;return n().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a=[{memcmp:{offset:0,bytes:p.default.encode(m.Buffer.from([g.MetadataKey.MetadataV1]))}},r.updateAuthority&&{memcmp:{offset:1,bytes:new f.PublicKey(r.updateAuthority).toBase58()}},r.mint&&{memcmp:{offset:33,bytes:new f.PublicKey(r.mint).toBase58()}}].filter(Boolean),!r.creators){n.next=7;break}return n.next=4,Promise.all(Array.from(Array(h.config.maxCreatorLimit).keys()).reduce((function(n,o){return[].concat(i(n),i(r.creators.map((function(r){return g.MetadataProgram.getProgramAccounts(e,{filters:[].concat(i(a),[{memcmp:{offset:(0,t.computeCreatorOffset)(o),bytes:new f.PublicKey(r).toBase58()}}])})}))))}),[]));case 4:return n.abrupt("return",n.sent.flat().map((function(e){return l.from(e)})));case 7:return n.next=9,g.MetadataProgram.getProgramAccounts(e,{filters:a});case 9:return n.abrupt("return",n.sent.map((function(e){return l.from(e)})));case 10:case"end":return n.stop()}}),o)})))}},{key:"findByOwner",value:function(e,t){return c(this,void 0,void 0,n().mark((function r(){var i,o,a;return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,h.TokenAccount.getTokenAccountsByOwner(e,t);case 2:return i=r.sent,o=new Map(i.map((function(e){var t=e.data;return[t.mint.toString(),t]}))),r.next=6,l.findMany(e);case 6:return a=r.sent,r.abrupt("return",a.filter((function(e){var t,r;return o.has(e.data.mint)&&((null===(r=null===(t=null===o||void 0===o?void 0:o.get(e.data.mint))||void 0===t?void 0:t.amount)||void 0===r?void 0:r.toNumber())||0)>0})));case 8:case"end":return r.stop()}}),r)})))}},{key:"findByOwnerV2",value:function(e,t){return c(this,void 0,void 0,n().mark((function r(){var i,o;return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,h.TokenAccount.getTokenAccountsByOwner(e,t);case 2:return i=r.sent,o=i.map((function(e){return e.data})).filter((function(e){var t=e.amount;return(null===t||void 0===t?void 0:t.toNumber())>0})),r.next=6,Promise.all(o.map((function(t){var r=t.mint;return l.findMany(e,{mint:r})})));case 6:return r.abrupt("return",r.sent.flat());case 7:case"end":return r.stop()}}),r)})))}},{key:"findDataByOwner",value:function(e,t){return c(this,void 0,void 0,n().mark((function r(){var o,a,s,u;return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,h.TokenAccount.getTokenAccountsByOwner(e,t);case 2:return o=r.sent,a=o.reduce((function(e,t){var r,n=t.data;return(null===(r=n.amount)||void 0===r?void 0:r.eq(new d.default(1)))?[].concat(i(e),[l.getPDA(n.mint)]):e}),[]),r.next=6,Promise.all(a);case 6:return s=r.sent,r.next=9,h.Account.getInfos(e,s);case 9:return u=r.sent,r.abrupt("return",Array.from(u.values()).map((function(e){return x.deserialize(e.data)})));case 11:case"end":return r.stop()}}),r)})))}},{key:"getEdition",value:function(e,t){return c(this,void 0,void 0,n().mark((function r(){var i,o,a;return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,y.Edition.getPDA(t);case 2:return i=r.sent,r.next=5,h.Account.getInfo(e,i);case 5:o=r.sent,a=null===o||void 0===o?void 0:o.data[0],r.t0=a,r.next=r.t0===g.MetadataKey.EditionV1?10:r.t0===g.MetadataKey.MasterEditionV1||r.t0===g.MetadataKey.MasterEditionV2?11:12;break;case 10:return r.abrupt("return",new y.Edition(i,o));case 11:return r.abrupt("return",new v.MasterEdition(i,o));case 12:return r.abrupt("return");case 13:case"end":return r.stop()}}),r)})))}}]),l}(h.Account);t.Metadata=w,t.MAX_NAME_LENGTH=32,t.MAX_SYMBOL_LENGTH=10,t.MAX_URI_LENGTH=200,t.MAX_CREATOR_LEN=34;t.computeCreatorOffset=function(e){return 69+t.MAX_NAME_LENGTH+4+t.MAX_URI_LENGTH+4+t.MAX_SYMBOL_LENGTH+2+1+4+e*t.MAX_CREATOR_LEN}},7398:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r(4520),t),i(r(4231),t),i(r(7520),t),i(r(6050),t),i(r(5397),t),i(r(3296),t)},333:function(e,t,r){"use strict";var n=r(9728).default,i=r(6690).default,o=r(1655).default,a=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.CreateMasterEdition=t.CreateMasterEditionArgs=void 0;var s=r(3340),u=r(3717),c=r(6322),l=r(5397),h=function(e){o(r,e);var t=a(r);function r(){var e;return i(this,r),(e=t.apply(this,arguments)).instruction=10,e}return n(r)}(s.Borsh.Data);t.CreateMasterEditionArgs=h,h.SCHEMA=h.struct([["instruction","u8"],["maxSupply",{kind:"option",type:"u64"}]]);var f=function(e){o(r,e);var t=a(r);function r(e,n){var o;i(this,r),o=t.call(this,e);var a=e.feePayer,s=n.edition,f=n.metadata,d=n.updateAuthority,p=n.mint,m=n.mintAuthority,g=n.maxSupply,y=h.serialize({maxSupply:g||null});return o.add(new c.TransactionInstruction({keys:[{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:p,isSigner:!1,isWritable:!0},{pubkey:d,isSigner:!0,isWritable:!1},{pubkey:m,isSigner:!0,isWritable:!1},{pubkey:a,isSigner:!0,isWritable:!1},{pubkey:f,isSigner:!1,isWritable:!1},{pubkey:u.TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1},{pubkey:c.SystemProgram.programId,isSigner:!1,isWritable:!1},{pubkey:c.SYSVAR_RENT_PUBKEY,isSigner:!1,isWritable:!1}],programId:l.MetadataProgram.PUBKEY,data:y})),o}return n(r)}(s.Transaction);t.CreateMasterEdition=f},7089:function(e,t,r){"use strict";var n=r(861).default,i=r(9728).default,o=r(6690).default,a=r(1655).default,s=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.CreateMetadata=t.CreateMetadataArgs=void 0;var u=r(3340),c=r(6322),l=r(6050),h=r(5397),f=function(e){a(r,e);var t=s(r);function r(){var e;return o(this,r),(e=t.apply(this,arguments)).instruction=0,e}return i(r)}(u.Borsh.Data);t.CreateMetadataArgs=f,f.SCHEMA=new Map([].concat(n(l.MetadataDataData.SCHEMA),n(f.struct([["instruction","u8"],["data",l.MetadataDataData],["isMutable","u8"]]))));var d=function(e){a(r,e);var t=s(r);function r(e,n){var i;o(this,r),i=t.call(this,e);var a=e.feePayer,s=n.metadata,u=n.metadataData,l=n.updateAuthority,d=n.mint,p=n.mintAuthority,m=f.serialize({data:u,isMutable:!0});return i.add(new c.TransactionInstruction({keys:[{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:d,isSigner:!1,isWritable:!1},{pubkey:p,isSigner:!0,isWritable:!1},{pubkey:a,isSigner:!0,isWritable:!1},{pubkey:l,isSigner:!1,isWritable:!1},{pubkey:c.SystemProgram.programId,isSigner:!1,isWritable:!1},{pubkey:c.SYSVAR_RENT_PUBKEY,isSigner:!1,isWritable:!1}],programId:h.MetadataProgram.PUBKEY,data:m})),i}return i(r)}(u.Transaction);t.CreateMetadata=d},269:function(e,t,r){"use strict";var n=r(9728).default,i=r(6690).default,o=r(1655).default,a=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.MintNewEditionFromMasterEditionViaToken=t.MintNewEditionFromMasterEditionViaTokenArgs=void 0;var s=r(3340),u=r(3717),c=r(6322),l=r(5397),h=function(e){o(r,e);var t=a(r);function r(){var e;return i(this,r),(e=t.apply(this,arguments)).instruction=11,e}return n(r)}(s.Borsh.Data);t.MintNewEditionFromMasterEditionViaTokenArgs=h,h.SCHEMA=h.struct([["instruction","u8"],["edition","u64"]]);var f=function(e){o(r,e);var t=a(r);function r(e,n){var o;i(this,r),o=t.call(this,e);var a=e.feePayer,s=n.edition,f=n.metadata,d=n.updateAuthority,p=n.masterEdition,m=n.masterMetadata,g=n.mint,y=n.editionMarker,v=n.mintAuthority,_=n.tokenOwner,b=n.tokenAccount,x=n.editionValue,w=h.serialize({edition:x});return o.add(new c.TransactionInstruction({keys:[{pubkey:f,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:p,isSigner:!1,isWritable:!0},{pubkey:g,isSigner:!1,isWritable:!0},{pubkey:y,isSigner:!1,isWritable:!0},{pubkey:v,isSigner:!0,isWritable:!1},{pubkey:a,isSigner:!0,isWritable:!1},{pubkey:_,isSigner:!0,isWritable:!1},{pubkey:b,isSigner:!1,isWritable:!1},{pubkey:d,isSigner:!1,isWritable:!1},{pubkey:m,isSigner:!1,isWritable:!1},{pubkey:u.TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1},{pubkey:c.SystemProgram.programId,isSigner:!1,isWritable:!1},{pubkey:c.SYSVAR_RENT_PUBKEY,isSigner:!1,isWritable:!1}],programId:l.MetadataProgram.PUBKEY,data:w})),o}return n(r)}(s.Transaction);t.MintNewEditionFromMasterEditionViaToken=f},8289:function(e,t,r){"use strict";var n=r(9728).default,i=r(6690).default,o=r(1655).default,a=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.SignMetadata=t.SignMetadataArgs=void 0;var s=r(3340),u=r(6322),c=r(5397),l=function(e){o(r,e);var t=a(r);function r(){var e;return i(this,r),(e=t.apply(this,arguments)).instruction=7,e}return n(r)}(s.Borsh.Data);t.SignMetadataArgs=l,l.SCHEMA=l.struct([["instruction","u8"]]);var h=function(e){o(r,e);var t=a(r);function r(e,n){var o;i(this,r),o=t.call(this,e);var a=n.metadata,s=n.creator,h=l.serialize();return o.add(new u.TransactionInstruction({keys:[{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!0,isWritable:!1}],programId:c.MetadataProgram.PUBKEY,data:h})),o}return n(r)}(s.Transaction);t.SignMetadata=h},7106:function(e,t,r){"use strict";var n=r(861).default,i=r(9728).default,o=r(6690).default,a=r(1655).default,s=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.UpdateMetadata=t.UpdateMetadataArgs=void 0;var u=r(3340),c=r(6322),l=r(6050),h=r(5397),f=function(e){a(r,e);var t=s(r);function r(){var e;return o(this,r),(e=t.apply(this,arguments)).instruction=1,e}return i(r)}(u.Borsh.Data);t.UpdateMetadataArgs=f,f.SCHEMA=new Map([].concat(n(l.MetadataDataData.SCHEMA),n(f.struct([["instruction","u8"],["data",{kind:"option",type:l.MetadataDataData}],["updateAuthority",{kind:"option",type:"pubkeyAsString"}],["primarySaleHappened",{kind:"option",type:"u8"}]]))));var d=function(e){a(r,e);var t=s(r);function r(e,n){var i;o(this,r),i=t.call(this,e);var a=n.metadata,s=n.metadataData,u=n.updateAuthority,l=n.newUpdateAuthority,d=n.primarySaleHappened,p=f.serialize({data:s,updateAuthority:l&&l.toString(),primarySaleHappened:d||null});return i.add(new c.TransactionInstruction({keys:[{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:u,isSigner:!0,isWritable:!1}],programId:h.MetadataProgram.PUBKEY,data:p})),i}return i(r)}(u.Transaction);t.UpdateMetadata=d},7345:function(e,t,r){"use strict";var n=r(9728).default,i=r(6690).default,o=r(1655).default,a=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.UpdatePrimarySaleHappenedViaToken=t.UpdatePrimarySaleHappenedViaTokenArgs=void 0;var s=r(3340),u=r(6322),c=r(5397),l=function(e){o(r,e);var t=a(r);function r(){var e;return i(this,r),(e=t.apply(this,arguments)).instruction=4,e}return n(r)}(s.Borsh.Data);t.UpdatePrimarySaleHappenedViaTokenArgs=l,l.SCHEMA=l.struct([["instruction","u8"]]);var h=function(e){o(r,e);var t=a(r);function r(e,n){var o;i(this,r),o=t.call(this,e);var a=n.metadata,s=n.owner,h=n.tokenAccount,f=l.serialize();return o.add(new u.TransactionInstruction({keys:[{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!0,isWritable:!1},{pubkey:h,isSigner:!1,isWritable:!1}],programId:c.MetadataProgram.PUBKEY,data:f})),o}return n(r)}(s.Transaction);t.UpdatePrimarySaleHappenedViaToken=h},3296:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r(7089),t),i(r(7106),t),i(r(333),t),i(r(269),t),i(r(7345),t),i(r(8289),t)},4329:function(e,t,r){"use strict";var n=r(9728).default,i=r(6690).default,o=r(1655).default,a=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.VaultProgram=t.VaultInstructions=t.VaultKey=void 0;var s=r(3340),u=r(6322);!function(e){e[e.Uninitialized=0]="Uninitialized",e[e.VaultV1=3]="VaultV1",e[e.SafetyDepositBoxV1=1]="SafetyDepositBoxV1",e[e.ExternalPriceAccountV1=2]="ExternalPriceAccountV1"}(t.VaultKey||(t.VaultKey={})),function(e){e[e.InitVault=0]="InitVault",e[e.AddTokenToInactiveVault=1]="AddTokenToInactiveVault",e[e.ActivateVault=2]="ActivateVault",e[e.CombineVault=3]="CombineVault",e[e.RedeemShares=4]="RedeemShares",e[e.WithdrawTokenFromSafetyDepositBox=5]="WithdrawTokenFromSafetyDepositBox",e[e.MintFractionalShares=6]="MintFractionalShares",e[e.WithdrawSharesFromTreasury=7]="WithdrawSharesFromTreasury",e[e.AddSharesToTreasury=8]="AddSharesToTreasury",e[e.UpdateExternalPriceAccount=9]="UpdateExternalPriceAccount",e[e.SetVaultAuthority=10]="SetVaultAuthority"}(t.VaultInstructions||(t.VaultInstructions={}));var c=function(e){o(r,e);var t=a(r);function r(){return i(this,r),t.apply(this,arguments)}return n(r)}(s.Program);t.VaultProgram=c,c.PREFIX="vault",c.PUBKEY=new u.PublicKey(s.config.programs.vault)},393:function(e,t,r){"use strict";var n,i=r(9728).default,o=r(6690).default,a=r(1655).default,s=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.ExternalPriceAccount=t.ExternalPriceAccountData=void 0;var u=r(3340),c=r(4329),l=function(e){a(r,e);var t=s(r);function r(e){var n;return o(this,r),(n=t.call(this,e)).key=c.VaultKey.ExternalPriceAccountV1,n}return i(r)}(u.Borsh.Data);t.ExternalPriceAccountData=l,n=l,l.SCHEMA=n.struct([["key","u8"],["pricePerShare","u64"],["priceMint","pubkeyAsString"],["allowedToCombine","u8"]]);var h=function(e){a(r,e);var t=s(r);function r(e,n){var i;if(o(this,r),!(i=t.call(this,e,n)).assertOwner(c.VaultProgram.PUBKEY))throw(0,u.ERROR_INVALID_OWNER)();if(!r.isCompatible(i.info.data))throw(0,u.ERROR_INVALID_ACCOUNT_DATA)();return i.data=l.deserialize(i.info.data),i}return i(r,null,[{key:"isCompatible",value:function(e){return e[0]===c.VaultKey.ExternalPriceAccountV1}}]),r}(u.Account);t.ExternalPriceAccount=h},6041:function(e,t,r){"use strict";var n,i=r(7061).default,o=r(9728).default,a=r(6690).default,s=r(1655).default,u=r(6389).default,c=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{u(n.next(e))}catch(t){o(t)}}function s(e){try{u(n.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.SafetyDepositBox=t.SafetyDepositBoxData=void 0;var l=r(6322),h=r(4329),f=r(9778),d=r(3340),p=function(e){s(r,e);var t=u(r);function r(e){var n;return a(this,r),(n=t.call(this,e)).key=h.VaultKey.SafetyDepositBoxV1,n}return o(r)}(d.Borsh.Data);t.SafetyDepositBoxData=p,n=p,p.SCHEMA=n.struct([["key","u8"],["vault","pubkeyAsString"],["tokenMint","pubkeyAsString"],["store","pubkeyAsString"],["order","u8"]]);var m=function(e){s(r,e);var t=u(r);function r(e,n){var i;if(a(this,r),!(i=t.call(this,e,n)).assertOwner(h.VaultProgram.PUBKEY))throw(0,d.ERROR_INVALID_OWNER)();if(!r.isCompatible(i.info.data))throw(0,d.ERROR_INVALID_ACCOUNT_DATA)();return i.data=p.deserialize(i.info.data),i}return o(r,null,[{key:"getPDA",value:function(e,t){return c(this,void 0,void 0,i().mark((function r(){return i().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.abrupt("return",h.VaultProgram.findProgramAddress([f.Buffer.from(h.VaultProgram.PREFIX),new l.PublicKey(e).toBuffer(),new l.PublicKey(t).toBuffer()]));case 1:case"end":return r.stop()}}),r)})))}},{key:"isCompatible",value:function(e){return e[0]===h.VaultKey.SafetyDepositBoxV1}}]),r}(d.Account);t.SafetyDepositBox=m},9980:function(e,t,r){"use strict";var n,i,o,a=r(7061).default,s=r(9728).default,u=r(6690).default,c=r(1655).default,l=r(6389).default,h=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{u(n.next(e))}catch(t){o(t)}}function s(e){try{u(n.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))},f=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Vault=t.VaultData=t.VaultState=t.NumberOfShareArgs=t.AmountArgs=void 0;var d=r(6322),p=f(r(6315)),m=r(3340),g=r(6041),y=r(4329),v=r(9778),_=function(e){c(r,e);var t=l(r);function r(){return u(this,r),t.apply(this,arguments)}return s(r)}(m.Borsh.Data);t.AmountArgs=_,n=_,_.SCHEMA=n.struct([["instruction","u8"],["amount","u64"]]);var b=function(e){c(r,e);var t=l(r);function r(){return u(this,r),t.apply(this,arguments)}return s(r)}(m.Borsh.Data);t.NumberOfShareArgs=b,i=b,b.SCHEMA=i.struct([["instruction","u8"],["numberOfShares","u64"]]),function(e){e[e.Inactive=0]="Inactive",e[e.Active=1]="Active",e[e.Combined=2]="Combined",e[e.Deactivated=3]="Deactivated"}(t.VaultState||(t.VaultState={}));var x=function(e){c(r,e);var t=l(r);function r(e){var n;return u(this,r),(n=t.call(this,e)).key=y.VaultKey.VaultV1,n}return s(r)}(m.Borsh.Data);t.VaultData=x,o=x,x.SCHEMA=o.struct([["key","u8"],["tokenProgram","pubkeyAsString"],["fractionMint","pubkeyAsString"],["authority","pubkeyAsString"],["fractionTreasury","pubkeyAsString"],["redeemTreasury","pubkeyAsString"],["allowFurtherShareCreation","u8"],["pricingLookupAddress","pubkeyAsString"],["tokenTypeCount","u8"],["state","u8"],["lockedPricePerShare","u64"]]);var w=function(e){c(r,e);var t=l(r);function r(e,n){var i;if(u(this,r),!(i=t.call(this,e,n)).assertOwner(y.VaultProgram.PUBKEY))throw(0,m.ERROR_INVALID_OWNER)();if(!r.isCompatible(i.info.data))throw(0,m.ERROR_INVALID_ACCOUNT_DATA)();return i.data=x.deserialize(i.info.data),i}return s(r,[{key:"getSafetyDepositBoxes",value:function(e){return h(this,void 0,void 0,a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,y.VaultProgram.getProgramAccounts(e,{filters:[{memcmp:{offset:0,bytes:p.default.encode(v.Buffer.from([y.VaultKey.SafetyDepositBoxV1]))}},{memcmp:{offset:1,bytes:this.pubkey.toBase58()}}]});case 2:return t.abrupt("return",t.sent.map((function(e){return g.SafetyDepositBox.from(e)})));case 3:case"end":return t.stop()}}),t,this)})))}}],[{key:"getPDA",value:function(e){return h(this,void 0,void 0,a().mark((function t(){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",y.VaultProgram.findProgramAddress([v.Buffer.from(y.VaultProgram.PREFIX),y.VaultProgram.PUBKEY.toBuffer(),new d.PublicKey(e).toBuffer()]));case 1:case"end":return t.stop()}}),t)})))}},{key:"isCompatible",value:function(e){return e[0]===y.VaultKey.VaultV1}}]),r}(m.Account);t.Vault=w,w.MAX_VAULT_SIZE=205,w.MAX_EXTERNAL_ACCOUNT_SIZE=42},261:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r(6041),t),i(r(9980),t),i(r(393),t),i(r(4329),t),i(r(5546),t),i(r(6533),t)},5971:function(e,t,r){"use strict";var n=r(9728).default,i=r(6690).default,o=r(1655).default,a=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.ActivateVault=void 0;var s=r(3717),u=r(6322),c=r(4329),l=r(9980),h=r(4329),f=function(e){o(r,e);var t=a(r);function r(e,n){var o;i(this,r),o=t.call(this,e);var a=n.vault,f=n.vaultAuthority,d=n.fractionMint,p=n.fractionTreasury,m=n.fractionMintAuthority,g=n.numberOfShares,y=l.NumberOfShareArgs.serialize({instruction:c.VaultInstructions.ActivateVault,numberOfShares:g});return o.add(new u.TransactionInstruction({keys:[{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:d,isSigner:!1,isWritable:!0},{pubkey:p,isSigner:!1,isWritable:!0},{pubkey:m,isSigner:!1,isWritable:!1},{pubkey:f,isSigner:!0,isWritable:!1},{pubkey:s.TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1}],programId:h.VaultProgram.PUBKEY,data:y})),o}return n(r)}(r(3340).Transaction);t.ActivateVault=f},8213:function(e,t,r){"use strict";var n=r(9728).default,i=r(6690).default,o=r(1655).default,a=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.AddSharesToTreasury=void 0;var s=r(3717),u=r(6322),c=r(4329),l=r(9980),h=r(4329),f=function(e){o(r,e);var t=a(r);function r(e,n){var o;i(this,r),o=t.call(this,e);var a=n.vault,f=n.vaultAuthority,d=n.source,p=n.transferAuthority,m=n.fractionTreasury,g=n.numberOfShares,y=l.NumberOfShareArgs.serialize({instruction:c.VaultInstructions.AddSharesToTreasury,numberOfShares:g});return o.add(new u.TransactionInstruction({keys:[{pubkey:d,isSigner:!1,isWritable:!0},{pubkey:m,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!1},{pubkey:p,isSigner:!1,isWritable:!1},{pubkey:f,isSigner:!1,isWritable:!0},{pubkey:s.TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1},{pubkey:u.SYSVAR_RENT_PUBKEY,isSigner:!1,isWritable:!1}],programId:h.VaultProgram.PUBKEY,data:y})),o}return n(r)}(r(3340).Transaction);t.AddSharesToTreasury=f},3102:function(e,t,r){"use strict";var n=r(9728).default,i=r(6690).default,o=r(1655).default,a=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.AddTokenToInactiveVault=void 0;var s=r(3340),u=r(3717),c=r(6322),l=r(9980),h=r(4329),f=r(4329),d=function(e){o(r,e);var t=a(r);function r(e,n){var o;i(this,r),o=t.call(this,e);var a=e.feePayer,s=n.vault,d=n.vaultAuthority,p=n.tokenAccount,m=n.tokenStoreAccount,g=n.transferAuthority,y=n.safetyDepositBox,v=n.amount,_=l.AmountArgs.serialize({instruction:f.VaultInstructions.AddTokenToInactiveVault,amount:v});return o.add(new c.TransactionInstruction({keys:[{pubkey:y,isSigner:!1,isWritable:!0},{pubkey:p,isSigner:!1,isWritable:!0},{pubkey:m,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:d,isSigner:!0,isWritable:!1},{pubkey:a,isSigner:!0,isWritable:!1},{pubkey:g,isSigner:!0,isWritable:!1},{pubkey:u.TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1},{pubkey:c.SYSVAR_RENT_PUBKEY,isSigner:!1,isWritable:!1},{pubkey:c.SystemProgram.programId,isSigner:!1,isWritable:!1}],programId:h.VaultProgram.PUBKEY,data:_})),o}return n(r)}(s.Transaction);t.AddTokenToInactiveVault=d},4518:function(e,t,r){"use strict";var n,i=r(9728).default,o=r(6690).default,a=r(1655).default,s=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.CombineVault=t.CombineVaultArgs=void 0;var u=r(3340),c=r(3717),l=r(6322),h=r(4329),f=r(4329),d=function(e){a(r,e);var t=s(r);function r(){var e;return o(this,r),(e=t.apply(this,arguments)).instruction=h.VaultInstructions.CombineVault,e}return i(r)}(u.Borsh.Data);t.CombineVaultArgs=d,n=d,d.SCHEMA=n.struct([["instruction","u8"]]);var p=function(e){a(r,e);var t=s(r);function r(e,n){var i;o(this,r),i=t.call(this,e);var a=n.vault,s=n.vaultAuthority,u=n.fractionMint,h=n.fractionTreasury,p=n.outstandingShareTokenAccount,m=n.payingTokenAccount,g=n.redeemTreasury,y=n.newVaultAuthority,v=n.transferAuthority,_=n.externalPriceAccount,b=n.burnAuthority,x=d.serialize();return i.add(new l.TransactionInstruction({keys:[{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:p,isSigner:!1,isWritable:!0},{pubkey:m,isSigner:!1,isWritable:!0},{pubkey:u,isSigner:!1,isWritable:!0},{pubkey:h,isSigner:!1,isWritable:!0},{pubkey:g,isSigner:!1,isWritable:!0},{pubkey:y||s,isSigner:!1,isWritable:!1},{pubkey:s,isSigner:!0,isWritable:!1},{pubkey:v,isSigner:!0,isWritable:!1},{pubkey:b,isSigner:!1,isWritable:!1},{pubkey:_,isSigner:!1,isWritable:!1},{pubkey:c.TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1}],programId:f.VaultProgram.PUBKEY,data:x})),i}return i(r)}(u.Transaction);t.CombineVault=p},7546:function(e,t,r){"use strict";var n,i=r(9728).default,o=r(6690).default,a=r(1655).default,s=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.InitVault=t.InitVaultArgs=void 0;var u=r(3340),c=r(3717),l=r(6322),h=r(4329),f=r(4329),d=function(e){a(r,e);var t=s(r);function r(){var e;return o(this,r),(e=t.apply(this,arguments)).instruction=h.VaultInstructions.InitVault,e.allowFurtherShareCreation=!1,e}return i(r)}(u.Borsh.Data);t.InitVaultArgs=d,n=d,d.SCHEMA=n.struct([["instruction","u8"],["allowFurtherShareCreation","u8"]]);var p=function(e){a(r,e);var t=s(r);function r(e,n){var i;o(this,r),i=t.call(this,e);var a=n.vault,s=n.vaultAuthority,u=n.fractionalMint,h=n.redeemTreasury,p=n.fractionalTreasury,m=n.pricingLookupAddress,g=n.allowFurtherShareCreation,y=d.serialize({allowFurtherShareCreation:g});return i.add(new l.TransactionInstruction({keys:[{pubkey:u,isSigner:!1,isWritable:!0},{pubkey:h,isSigner:!1,isWritable:!0},{pubkey:p,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!1},{pubkey:m,isSigner:!1,isWritable:!1},{pubkey:c.TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1},{pubkey:l.SYSVAR_RENT_PUBKEY,isSigner:!1,isWritable:!1}],programId:f.VaultProgram.PUBKEY,data:y})),i}return i(r)}(u.Transaction);t.InitVault=p},2385:function(e,t,r){"use strict";var n=r(9728).default,i=r(6690).default,o=r(1655).default,a=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.MintFractionalShares=void 0;var s=r(3717),u=r(6322),c=r(4329),l=r(3340),h=r(9980),f=r(4329),d=function(e){o(r,e);var t=a(r);function r(e,n){var o;i(this,r),o=t.call(this,e);var a=n.vault,l=n.vaultAuthority,d=n.fractionMint,p=n.fractionTreasury,m=n.fractionMintAuthority,g=n.numberOfShares,y=h.NumberOfShareArgs.serialize({instruction:c.VaultInstructions.MintFractionalShares,numberOfShares:g});return o.add(new u.TransactionInstruction({keys:[{pubkey:p,isSigner:!1,isWritable:!0},{pubkey:d,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!1},{pubkey:m,isSigner:!1,isWritable:!1},{pubkey:l,isSigner:!1,isWritable:!1},{pubkey:s.TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1}],programId:f.VaultProgram.PUBKEY,data:y})),o}return n(r)}(l.Transaction);t.MintFractionalShares=d},6510:function(e,t,r){"use strict";var n,i=r(9728).default,o=r(6690).default,a=r(1655).default,s=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.RedeemShares=t.RedeemSharesArgs=void 0;var u=r(3340),c=r(3717),l=r(6322),h=r(4329),f=r(4329),d=function(e){a(r,e);var t=s(r);function r(){var e;return o(this,r),(e=t.apply(this,arguments)).instruction=h.VaultInstructions.RedeemShares,e}return i(r)}(u.Borsh.Data);t.RedeemSharesArgs=d,n=d,d.SCHEMA=n.struct([["instruction","u8"]]);var p=function(e){a(r,e);var t=s(r);function r(e,n){var i;o(this,r),i=t.call(this,e);var a=n.vault,s=n.burnAuthority,u=n.fractionMint,h=n.outstandingSharesAccount,p=n.proceedsAccount,m=n.redeemTreasury,g=n.transferAuthority,y=d.serialize();return i.add(new l.TransactionInstruction({keys:[{pubkey:h,isSigner:!1,isWritable:!0},{pubkey:p,isSigner:!1,isWritable:!0},{pubkey:u,isSigner:!1,isWritable:!0},{pubkey:m,isSigner:!1,isWritable:!0},{pubkey:g,isSigner:!1,isWritable:!1},{pubkey:s,isSigner:!0,isWritable:!1},{pubkey:a,isSigner:!1,isWritable:!1},{pubkey:c.TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1},{pubkey:l.SYSVAR_RENT_PUBKEY,isSigner:!1,isWritable:!1}],programId:f.VaultProgram.PUBKEY,data:y})),i}return i(r)}(u.Transaction);t.RedeemShares=p},3775:function(e,t,r){"use strict";var n,i=r(9728).default,o=r(6690).default,a=r(1655).default,s=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.SetVaultAuthority=t.SetVaultAuthorityArgs=void 0;var u=r(3340),c=r(6322),l=r(4329),h=r(4329),f=function(e){a(r,e);var t=s(r);function r(){var e;return o(this,r),(e=t.apply(this,arguments)).instruction=l.VaultInstructions.SetVaultAuthority,e}return i(r)}(u.Borsh.Data);t.SetVaultAuthorityArgs=f,n=f,f.SCHEMA=n.struct([["instruction","u8"]]);var d=function(e){a(r,e);var t=s(r);function r(e,n){var i;o(this,r),i=t.call(this,e);var a=n.vault,s=n.currentAuthority,u=n.newAuthority,l=f.serialize();return i.add(new c.TransactionInstruction({keys:[{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!0,isWritable:!1},{pubkey:u,isSigner:!1,isWritable:!1}],programId:h.VaultProgram.PUBKEY,data:l})),i}return i(r)}(u.Transaction);t.SetVaultAuthority=d},4750:function(e,t,r){"use strict";var n,i=r(861).default,o=r(9728).default,a=r(6690).default,s=r(1655).default,u=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.UpdateExternalPriceAccount=t.UpdateExternalPriceAccountArgs=void 0;var c=r(3340),l=r(6322),h=r(4329),f=r(393),d=r(4329),p=function(e){s(r,e);var t=u(r);function r(){var e;return a(this,r),(e=t.apply(this,arguments)).instruction=h.VaultInstructions.UpdateExternalPriceAccount,e}return o(r)}(c.Borsh.Data);t.UpdateExternalPriceAccountArgs=p,n=p,p.SCHEMA=new Map([].concat(i(f.ExternalPriceAccountData.SCHEMA),i(n.struct([["instruction","u8"],["externalPriceAccount",f.ExternalPriceAccountData]]))));var m=function(e){s(r,e);var t=u(r);function r(e,n){var i;a(this,r),i=t.call(this,e);var o=n.externalPriceAccount,s=n.externalPriceAccountData,u=p.serialize({externalPriceAccount:s});return i.add(new l.TransactionInstruction({keys:[{pubkey:o,isSigner:!1,isWritable:!0}],programId:d.VaultProgram.PUBKEY,data:u})),i}return o(r)}(c.Transaction);t.UpdateExternalPriceAccount=m},4456:function(e,t,r){"use strict";var n=r(9728).default,i=r(6690).default,o=r(1655).default,a=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.WithdrawSharesFromTreasury=void 0;var s=r(3340),u=r(3717),c=r(6322),l=r(4329),h=r(9980),f=r(4329),d=function(e){o(r,e);var t=a(r);function r(e,n){var o;i(this,r),o=t.call(this,e);var a=n.vault,s=n.vaultAuthority,d=n.destination,p=n.transferAuthority,m=n.fractionTreasury,g=n.numberOfShares,y=h.NumberOfShareArgs.serialize({instruction:l.VaultInstructions.WithdrawSharesFromTreasury,numberOfShares:g});return o.add(new c.TransactionInstruction({keys:[{pubkey:d,isSigner:!1,isWritable:!0},{pubkey:m,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!1},{pubkey:p,isSigner:!1,isWritable:!1},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:u.TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1},{pubkey:c.SYSVAR_RENT_PUBKEY,isSigner:!1,isWritable:!1}],programId:f.VaultProgram.PUBKEY,data:y})),o}return n(r)}(s.Transaction);t.WithdrawSharesFromTreasury=d},4957:function(e,t,r){"use strict";var n=r(9728).default,i=r(6690).default,o=r(1655).default,a=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.WithdrawTokenFromSafetyDepositBox=void 0;var s=r(3340),u=r(3717),c=r(6322),l=r(4329),h=r(9980),f=r(4329),d=function(e){o(r,e);var t=a(r);function r(e,n){var o;i(this,r),o=t.call(this,e);var a=n.vault,s=n.vaultAuthority,d=n.store,p=n.destination,m=n.fractionMint,g=n.transferAuthority,y=n.safetyDepositBox,v=n.amount,_=h.AmountArgs.serialize({instruction:l.VaultInstructions.WithdrawTokenFromSafetyDepositBox,amount:v});return o.add(new c.TransactionInstruction({keys:[{pubkey:p,isSigner:!1,isWritable:!0},{pubkey:y,isSigner:!1,isWritable:!0},{pubkey:d,isSigner:!1,isWritable:!0},{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:m,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!0,isWritable:!1},{pubkey:g,isSigner:!1,isWritable:!1},{pubkey:u.TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1},{pubkey:c.SYSVAR_RENT_PUBKEY,isSigner:!1,isWritable:!1}],programId:f.VaultProgram.PUBKEY,data:_})),o}return n(r)}(s.Transaction);t.WithdrawTokenFromSafetyDepositBox=d},5546:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r(5971),t),i(r(8213),t),i(r(3102),t),i(r(4518),t),i(r(7546),t),i(r(2385),t),i(r(6510),t),i(r(3775),t),i(r(4750),t),i(r(4456),t),i(r(4957),t)},6533:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},262:function(e,t,r){"use strict";var n=r(9778).Buffer,i=r(7061).default,o=r(6690).default,a=r(9728).default,s=r(1655).default,u=r(6389).default,c=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{u(n.next(e))}catch(t){o(t)}}function s(e){try{u(n.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.MetadataProgram=void 0;var l=r(6322),h=r(3340),f=function(e){s(r,e);var t=u(r);function r(){return o(this,r),t.apply(this,arguments)}return a(r,null,[{key:"findEditionAccount",value:function(e,t){return c(this,void 0,void 0,i().mark((function o(){return i().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",l.PublicKey.findProgramAddress([n.from(r.PREFIX,"utf8"),r.PUBKEY.toBuffer(),e.toBuffer(),n.from(r.EDITION,"utf8"),n.from(t,"utf8")],r.PUBKEY));case 1:case"end":return i.stop()}}),o)})))}},{key:"findMasterEditionAccount",value:function(e){return c(this,void 0,void 0,i().mark((function t(){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",l.PublicKey.findProgramAddress([n.from(r.PREFIX,"utf8"),r.PUBKEY.toBuffer(),e.toBuffer(),n.from(r.EDITION,"utf8")],r.PUBKEY));case 1:case"end":return t.stop()}}),t)})))}},{key:"findMetadataAccount",value:function(e){return c(this,void 0,void 0,i().mark((function t(){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",l.PublicKey.findProgramAddress([n.from(r.PREFIX,"utf8"),r.PUBKEY.toBuffer(),e.toBuffer()],r.PUBKEY));case 1:case"end":return t.stop()}}),t)})))}},{key:"findUseAuthorityAccount",value:function(e,t){return c(this,void 0,void 0,i().mark((function o(){return i().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",l.PublicKey.findProgramAddress([n.from(r.PREFIX,"utf8"),r.PUBKEY.toBuffer(),e.toBuffer(),n.from(r.USER,"utf8"),t.toBuffer()],r.PUBKEY));case 1:case"end":return i.stop()}}),o)})))}},{key:"findCollectionAuthorityAccount",value:function(e,t){return c(this,void 0,void 0,i().mark((function o(){return i().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",l.PublicKey.findProgramAddress([n.from(r.PREFIX,"utf8"),r.PUBKEY.toBuffer(),e.toBuffer(),n.from(r.COLLECTION_AUTHORITY,"utf8"),t.toBuffer()],r.PUBKEY));case 1:case"end":return i.stop()}}),o)})))}},{key:"findProgramAsBurnerAccount",value:function(){return c(this,void 0,void 0,i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",l.PublicKey.findProgramAddress([n.from(r.PREFIX,"utf8"),r.PUBKEY.toBuffer(),n.from(r.BURN,"utf8")],r.PUBKEY));case 1:case"end":return e.stop()}}),e)})))}}]),r}(h.Program);t.MetadataProgram=f,f.PREFIX="metadata",f.EDITION="edition",f.USER="user",f.COLLECTION_AUTHORITY="collection_authority",f.BURN="burn",f.PUBKEY=new l.PublicKey(h.config.programs.metadata)},4778:function(e,t,r){"use strict";var n=r(9728).default,i=r(6690).default,o=r(1655).default,a=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.CollctionAuthorityRecord=t.Collection=void 0;var s=r(3340),u=r(1657),c=function(e){o(r,e);var t=a(r);function r(e){var n;return i(this,r),(n=t.call(this,e)).key=e.key,n.verified=e.verified,n}return n(r)}(s.Borsh.Data);t.Collection=c,c.SCHEMA=c.struct([["verified","u8"],["key","pubkeyAsString"]]);var l=function(e){o(r,e);var t=a(r);function r(e){var n;return i(this,r),(n=t.call(this,e)).key=u.MetadataKey.CollectionAuthorityRecord,n.bump=e.bump,n}return n(r)}(s.Borsh.Data);t.CollctionAuthorityRecord=l,l.SCHEMA=l.struct([["key","u8"],["bump","u8"]])},612:function(e,t,r){"use strict";var n=r(7061).default,i=r(9728).default,o=r(6690).default,a=r(1655).default,s=r(6389).default,u=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{u(n.next(e))}catch(t){o(t)}}function s(e){try{u(n.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.Edition=t.EditionData=void 0;var c=r(3340),l=r(262),h=r(6322),f=r(9778),d=r(1657),p=function(e){a(r,e);var t=s(r);function r(e){var n;return o(this,r),(n=t.call(this,e)).key=d.MetadataKey.EditionV1,n}return i(r)}(c.Borsh.Data);t.EditionData=p,p.SCHEMA=p.struct([["key","u8"],["parent","pubkeyAsString"],["edition","u64"]]);var m=function(e){a(r,e);var t=s(r);function r(e,n){var i;if(o(this,r),!(i=t.call(this,e,n)).assertOwner(l.MetadataProgram.PUBKEY))throw(0,c.ERROR_INVALID_OWNER)();if(!r.isCompatible(i.info.data))throw(0,c.ERROR_INVALID_ACCOUNT_DATA)();return i.data=p.deserialize(i.info.data),i}return i(r,null,[{key:"getPDA",value:function(e){return u(this,void 0,void 0,n().mark((function t(){return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",l.MetadataProgram.findProgramAddress([f.Buffer.from(l.MetadataProgram.PREFIX),l.MetadataProgram.PUBKEY.toBuffer(),new h.PublicKey(e).toBuffer(),f.Buffer.from(r.EDITION_PREFIX)]));case 1:case"end":return t.stop()}}),t)})))}},{key:"isCompatible",value:function(e){return e[0]===d.MetadataKey.EditionV1}}]),r}(c.Account);t.Edition=m,m.EDITION_PREFIX="edition"},2708:function(e,t,r){"use strict";var n=r(7061).default,i=r(6690).default,o=r(9728).default,a=r(1655).default,s=r(6389).default,u=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{u(n.next(e))}catch(t){o(t)}}function s(e){try{u(n.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.EditionMarker=t.EditionMarkerData=void 0;var c=r(3340),l=r(6322),h=r(612),f=r(262),d=r(9778),p=r(1657),m=function(e){a(r,e);var t=s(r);function r(e){var n;return i(this,r),(n=t.call(this,e)).key=p.MetadataKey.EditionMarker,n}return o(r,[{key:"editionTaken",value:function(e){var t=e%g.DATA_SIZE,r=Math.floor(t/8);if(r>30)throw Error("Bad index for edition");var n=7-t%8,i=Math.pow(2,n);return 0!=(this.ledger[r]&i)}}]),r}(c.Borsh.Data);t.EditionMarkerData=m,m.SCHEMA=m.struct([["key","u8"],["ledger",[31]]]);var g=function(e){a(r,e);var t=s(r);function r(e,n){var o;if(i(this,r),!(o=t.call(this,e,n)).assertOwner(f.MetadataProgram.PUBKEY))throw(0,c.ERROR_INVALID_OWNER)();if(!r.isCompatible(o.info.data))throw(0,c.ERROR_INVALID_ACCOUNT_DATA)();return o.data=m.deserialize(o.info.data),o}return o(r,null,[{key:"getPDA",value:function(e,t){return u(this,void 0,void 0,n().mark((function r(){var i;return n().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return i=Math.floor(t.toNumber()/248),r.abrupt("return",f.MetadataProgram.findProgramAddress([d.Buffer.from(f.MetadataProgram.PREFIX),f.MetadataProgram.PUBKEY.toBuffer(),new l.PublicKey(e).toBuffer(),d.Buffer.from(h.Edition.EDITION_PREFIX),d.Buffer.from(i.toString())]));case 2:case"end":return r.stop()}}),r)})))}},{key:"isCompatible",value:function(e){return e[0]===p.MetadataKey.EditionMarker}}]),r}(c.Account);t.EditionMarker=g,g.DATA_SIZE=248},5010:function(e,t,r){"use strict";var n=r(7061).default,i=r(9728).default,o=r(6690).default,a=r(1655).default,s=r(6389).default,u=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{u(n.next(e))}catch(t){o(t)}}function s(e){try{u(n.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.MasterEdition=t.MasterEditionV2Data=t.MasterEditionV1Data=void 0;var l=r(3340),h=c(r(73)),f=r(612),d=r(262),p=r(9778),m=r(6322),g=r(1657),y=function(e){a(r,e);var t=s(r);function r(e){var n;return o(this,r),(n=t.call(this,e)).key=g.MetadataKey.MasterEditionV1,n}return i(r)}(l.Borsh.Data);t.MasterEditionV1Data=y,y.SCHEMA=y.struct([["key","u8"],["supply","u64"],["maxSupply",{kind:"option",type:"u64"}],["printingMint","pubkeyAsString"],["oneTimePrintingAuthorizationMint","pubkeyAsString"]]);var v=function(e){a(r,e);var t=s(r);function r(e){var n;return o(this,r),(n=t.call(this,e)).key=g.MetadataKey.MasterEditionV2,n}return i(r)}(l.Borsh.Data);t.MasterEditionV2Data=v,v.SCHEMA=v.struct([["key","u8"],["supply","u64"],["maxSupply",{kind:"option",type:"u64"}]]);var _=function(e){a(r,e);var t=s(r);function r(e,n){var i;if(o(this,r),!(i=t.call(this,e,n)).assertOwner(d.MetadataProgram.PUBKEY))throw(0,l.ERROR_INVALID_OWNER)();if(r.isMasterEditionV1(i.info.data))i.data=y.deserialize(i.info.data);else{if(!r.isMasterEditionV2(i.info.data))throw(0,l.ERROR_INVALID_ACCOUNT_DATA)();i.data=v.deserialize(i.info.data)}return i}return i(r,[{key:"getEditions",value:function(e){return u(this,void 0,void 0,n().mark((function t(){return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,d.MetadataProgram.getProgramAccounts(e,{filters:[{memcmp:{offset:0,bytes:h.default.encode(p.Buffer.from([g.MetadataKey.EditionV1]))}},{memcmp:{offset:1,bytes:this.pubkey.toBase58()}}]});case 2:return t.abrupt("return",t.sent.map((function(e){return f.Edition.from(e)})));case 3:case"end":return t.stop()}}),t,this)})))}}],[{key:"getPDA",value:function(e){return u(this,void 0,void 0,n().mark((function t(){return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",d.MetadataProgram.findProgramAddress([p.Buffer.from(d.MetadataProgram.PREFIX),d.MetadataProgram.PUBKEY.toBuffer(),new m.PublicKey(e).toBuffer(),p.Buffer.from(r.EDITION_PREFIX)]));case 1:case"end":return t.stop()}}),t)})))}},{key:"isCompatible",value:function(e){return r.isMasterEditionV1(e)||r.isMasterEditionV2(e)}},{key:"isMasterEditionV1",value:function(e){return e[0]===g.MetadataKey.MasterEditionV1}},{key:"isMasterEditionV2",value:function(e){return e[0]===g.MetadataKey.MasterEditionV2}}]),r}(l.Account);t.MasterEdition=_,_.EDITION_PREFIX="edition"},6981:function(e,t,r){"use strict";var n=r(7424).default,i=r(7061).default,o=r(861).default,a=r(9728).default,s=r(6690).default,u=r(1655).default,c=r(6389).default,l=this&&this.__awaiter||function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{u(n.next(e))}catch(t){o(t)}}function s(e){try{u(n.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))},h=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.computeCreatorOffset=t.MAX_CREATOR_LEN=t.MAX_URI_LENGTH=t.MAX_SYMBOL_LENGTH=t.MAX_NAME_LENGTH=t.Metadata=t.MetadataData=t.MetadataDataData=t.DataV2=t.Creator=void 0;var f=r(3340),d=r(6322),p=h(r(518)),m=h(r(73)),g=r(9778),y=r(262),v=r(612),_=r(5010),b=r(8358),x=r(4778),w=r(1657),k=function(e){u(r,e);var t=c(r);function r(){return s(this,r),t.apply(this,arguments)}return a(r)}(f.Borsh.Data);t.Creator=k,k.SCHEMA=k.struct([["address","pubkeyAsString"],["verified","u8"],["share","u8"]]);var A=function(e){u(r,e);var t=c(r);function r(){return s(this,r),t.apply(this,arguments)}return a(r)}(f.Borsh.Data);t.DataV2=A,A.SCHEMA=new Map([].concat(o(k.SCHEMA),o(x.Collection.SCHEMA),o(b.Uses.SCHEMA),o(A.struct([["name","string"],["symbol","string"],["uri","string"],["sellerFeeBasisPoints","u16"],["creators",{kind:"option",type:[k]}],["collection",{kind:"option",type:x.Collection}],["uses",{kind:"option",type:b.Uses}]]))));var E=function(e){u(r,e);var t=c(r);function r(e){var n;s(this,r),n=t.call(this,e);var i=new RegExp("\0","g");return n.name=e.name.replace(i,""),n.uri=e.uri.replace(i,""),n.symbol=e.symbol.replace(i,""),n}return a(r)}(f.Borsh.Data);t.MetadataDataData=E,E.SCHEMA=new Map([].concat(o(k.SCHEMA),o(E.struct([["name","string"],["symbol","string"],["uri","string"],["sellerFeeBasisPoints","u16"],["creators",{kind:"option",type:[k]}]]))));var S=function(e){u(r,e);var t=c(r);function r(e){var n;return s(this,r),(n=t.call(this,e)).key=w.MetadataKey.MetadataV1,n}return a(r)}(f.Borsh.Data);t.MetadataData=S,S.SCHEMA=new Map([].concat(o(E.SCHEMA),o(x.Collection.SCHEMA),o(b.Uses.SCHEMA),o(S.struct([["key","u8"],["updateAuthority","pubkeyAsString"],["mint","pubkeyAsString"],["data",E],["primarySaleHappened","u8"],["isMutable","u8"],["editionNonce",{kind:"option",type:"u8"}],["tokenStandard",{kind:"option",type:"u8"}],["collection",{kind:"option",type:x.Collection}],["uses",{kind:"option",type:b.Uses}]]))));var T=function(e){u(h,e);var r=c(h);function h(e,t){var n;if(s(this,h),!(n=r.call(this,e,t)).assertOwner(y.MetadataProgram.PUBKEY))throw(0,f.ERROR_INVALID_OWNER)();if(!h.isCompatible(n.info.data))throw(0,f.ERROR_INVALID_ACCOUNT_DATA)();return n.data=S.deserialize(n.info.data),n}return a(h,null,[{key:"isCompatible",value:function(e){return e[0]===w.MetadataKey.MetadataV1}},{key:"getPDA",value:function(e){return l(this,void 0,void 0,i().mark((function t(){return i().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",y.MetadataProgram.findProgramAddress([g.Buffer.from(y.MetadataProgram.PREFIX),y.MetadataProgram.PUBKEY.toBuffer(),new d.PublicKey(e).toBuffer()]));case 1:case"end":return t.stop()}}),t)})))}},{key:"findMany",value:function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return l(this,void 0,void 0,i().mark((function n(){var a;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(a=[{memcmp:{offset:0,bytes:m.default.encode(g.Buffer.from([w.MetadataKey.MetadataV1]))}},r.updateAuthority&&{memcmp:{offset:1,bytes:new d.PublicKey(r.updateAuthority).toBase58()}},r.mint&&{memcmp:{offset:33,bytes:new d.PublicKey(r.mint).toBase58()}}].filter(Boolean),!r.creators){n.next=7;break}return n.next=4,Promise.all(Array.from(Array(f.config.maxCreatorLimit).keys()).reduce((function(n,i){return[].concat(o(n),o(r.creators.map((function(r){return y.MetadataProgram.getProgramAccounts(e,{filters:[].concat(o(a),[{memcmp:{offset:(0,t.computeCreatorOffset)(i),bytes:new d.PublicKey(r).toBase58()}}])})}))))}),[]));case 4:return n.abrupt("return",n.sent.flat().map((function(e){return h.from(e)})));case 7:return n.next=9,y.MetadataProgram.getProgramAccounts(e,{filters:a});case 9:return n.abrupt("return",n.sent.map((function(e){return h.from(e)})));case 10:case"end":return n.stop()}}),n)})))}},{key:"findByMint",value:function(e,t){return l(this,void 0,void 0,i().mark((function r(){var n;return i().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,h.getPDA(t);case 2:return n=r.sent,r.abrupt("return",h.load(e,n));case 4:case"end":return r.stop()}}),r)})))}},{key:"findByOwner",value:function(e,t){return l(this,void 0,void 0,i().mark((function r(){var n,o,a;return i().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,f.TokenAccount.getTokenAccountsByOwner(e,t);case 2:return n=r.sent,o=new Map(n.map((function(e){var t=e.data;return[t.mint.toString(),t]}))),r.next=6,h.findMany(e);case 6:return a=r.sent,r.abrupt("return",a.filter((function(e){var t,r;return o.has(e.data.mint)&&((null===(r=null===(t=null===o||void 0===o?void 0:o.get(e.data.mint))||void 0===t?void 0:t.amount)||void 0===r?void 0:r.toNumber())||0)>0})));case 8:case"end":return r.stop()}}),r)})))}},{key:"findByOwnerV2",value:function(e,t){return l(this,void 0,void 0,i().mark((function r(){var n,o;return i().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,f.TokenAccount.getTokenAccountsByOwner(e,t);case 2:return n=r.sent,o=n.map((function(e){return e.data})).filter((function(e){var t=e.amount;return(null===t||void 0===t?void 0:t.toNumber())>0})),r.next=6,Promise.all(o.map((function(t){var r=t.mint;return h.findMany(e,{mint:r})})));case 6:return r.abrupt("return",r.sent.flat());case 7:case"end":return r.stop()}}),r)})))}},{key:"findByOwnerV3",value:function(e,t){return l(this,void 0,void 0,i().mark((function r(){var o;return i().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,h.findInfoByOwner(e,t);case 2:return o=r.sent,r.abrupt("return",Array.from(o.entries()).map((function(e){var t=n(e,2);return new h(t[0],t[1])})));case 4:case"end":return r.stop()}}),r)})))}},{key:"findInfoByOwner",value:function(e,t){return l(this,void 0,void 0,i().mark((function r(){var n,a,s;return i().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,f.TokenAccount.getTokenAccountsByOwner(e,t);case 2:return n=r.sent,a=n.reduce((function(e,t){var r,n=t.data;return(null===(r=n.amount)||void 0===r?void 0:r.eq(new p.default(1)))?[].concat(o(e),[h.getPDA(n.mint)]):e}),[]),r.next=6,Promise.all(a);case 6:return s=r.sent,r.abrupt("return",f.Account.getInfos(e,s));case 8:case"end":return r.stop()}}),r)})))}},{key:"findDataByOwner",value:function(e,t){return l(this,void 0,void 0,i().mark((function r(){var n;return i().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,h.findInfoByOwner(e,t);case 2:return n=r.sent,r.abrupt("return",Array.from(n.values()).map((function(e){return S.deserialize(e.data)})));case 4:case"end":return r.stop()}}),r)})))}},{key:"getEdition",value:function(e,t){return l(this,void 0,void 0,i().mark((function r(){var n,o,a;return i().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,v.Edition.getPDA(t);case 2:return n=r.sent,r.next=5,f.Account.getInfo(e,n);case 5:o=r.sent,a=null===o||void 0===o?void 0:o.data[0],r.t0=a,r.next=r.t0===w.MetadataKey.EditionV1?10:r.t0===w.MetadataKey.MasterEditionV1||r.t0===w.MetadataKey.MasterEditionV2?11:12;break;case 10:return r.abrupt("return",new v.Edition(n,o));case 11:return r.abrupt("return",new _.MasterEdition(n,o));case 12:return r.abrupt("return");case 13:case"end":return r.stop()}}),r)})))}}]),h}(f.Account);t.Metadata=T,t.MAX_NAME_LENGTH=32,t.MAX_SYMBOL_LENGTH=10,t.MAX_URI_LENGTH=200,t.MAX_CREATOR_LEN=34;t.computeCreatorOffset=function(e){return 69+t.MAX_NAME_LENGTH+4+t.MAX_URI_LENGTH+4+t.MAX_SYMBOL_LENGTH+2+1+4+e*t.MAX_CREATOR_LEN}},8358:function(e,t,r){"use strict";var n=r(9728).default,i=r(6690).default,o=r(1655).default,a=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.UseAuthorityRecord=t.Uses=void 0;var s=r(3340),u=r(3646),c=function(e){o(r,e);var t=a(r);function r(e){var n;return i(this,r),(n=t.call(this,e)).useMethod=e.useMethod,n.total=e.total,n.remaining=e.remaining,n}return n(r)}(s.Borsh.Data);t.Uses=c,c.SCHEMA=c.struct([["useMethod","u8"],["total","u64"],["remaining","u64"]]);var l=function(e){o(r,e);var t=a(r);function r(e){var n;return i(this,r),(n=t.call(this,e)).key=u.MetadataKey.UseAuthorityRecord,n.allowedUses=e.allowedUses,n.bump=e.bump,n}return n(r)}(s.Borsh.Data);t.UseAuthorityRecord=l,l.SCHEMA=l.struct([["key","u8"],["allowedUses","u64"],["bump","u8"]])},1657:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TokenStandard=t.UseMethod=t.MetadataKey=void 0,function(e){e[e.Uninitialized=0]="Uninitialized",e[e.MetadataV1=4]="MetadataV1",e[e.EditionV1=1]="EditionV1",e[e.MasterEditionV1=2]="MasterEditionV1",e[e.MasterEditionV2=6]="MasterEditionV2",e[e.EditionMarker=7]="EditionMarker",e[e.UseAuthorityRecord=8]="UseAuthorityRecord",e[e.CollectionAuthorityRecord=9]="CollectionAuthorityRecord"}(t.MetadataKey||(t.MetadataKey={})),function(e){e[e.Burn=0]="Burn",e[e.Single=1]="Single",e[e.Multiple=2]="Multiple"}(t.UseMethod||(t.UseMethod={})),function(e){e[e.NonFungible=0]="NonFungible",e[e.FungibleAsset=1]="FungibleAsset",e[e.Fungible=2]="Fungible",e[e.NonFungibleEdition=3]="NonFungibleEdition"}(t.TokenStandard||(t.TokenStandard={}))},3646:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r(1657),t),i(r(6981),t),i(r(5010),t),i(r(612),t),i(r(2708),t),i(r(4778),t),i(r(8358),t)},6493:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r(3646),t),i(r(262),t),i(r(2667),t)},7646:function(e,t,r){"use strict";var n=r(861).default,i=r(9728).default,o=r(6690).default,a=r(1655).default,s=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.ApproveCollectionAuthority=t.ApproveCollectionAuthorityArgs=void 0;var u=r(3340),c=r(6322),l=r(262),h=function(e){a(r,e);var t=s(r);function r(){var e;return o(this,r),(e=t.apply(this,arguments)).instruction=23,e}return i(r)}(u.Borsh.Data);t.ApproveCollectionAuthorityArgs=h,h.SCHEMA=new Map(n(h.struct([["instruction","u8"]])));var f=function(e){a(r,e);var t=s(r);function r(e,n){var i;o(this,r),i=t.call(this,e);var a=e.feePayer,s=n.metadata,u=n.collectionAuthorityRecord,f=n.newCollectionAuthority,d=n.updateAuthority,p=n.mint,m=h.serialize(),g=[{pubkey:u,isSigner:!1,isWritable:!0},{pubkey:f,isSigner:!1,isWritable:!1},{pubkey:d,isSigner:!0,isWritable:!1},{pubkey:a,isSigner:!0,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!1},{pubkey:p,isSigner:!1,isWritable:!1},{pubkey:c.SystemProgram.programId,isSigner:!1,isWritable:!1},{pubkey:c.SYSVAR_RENT_PUBKEY,isSigner:!1,isWritable:!1}];return i.add(new c.TransactionInstruction({keys:g,programId:l.MetadataProgram.PUBKEY,data:m})),i}return i(r)}(u.Transaction);t.ApproveCollectionAuthority=f},1087:function(e,t,r){"use strict";var n=r(861).default,i=r(9728).default,o=r(6690).default,a=r(1655).default,s=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.ApproveUseAuthority=t.ApproveUseAuthorityArgs=void 0;var u=r(3340),c=r(3717),l=r(6322),h=r(262),f=function(e){a(r,e);var t=s(r);function r(){var e;return o(this,r),(e=t.apply(this,arguments)).instruction=20,e}return i(r)}(u.Borsh.Data);t.ApproveUseAuthorityArgs=f,f.SCHEMA=new Map(n(f.struct([["instruction","u8"],["numberOfUses","u8"]])));var d=function(e){a(r,e);var t=s(r);function r(e,n){var i;o(this,r),i=t.call(this,e);var a=e.feePayer,s=n.useAuthorityRecord,u=n.user,d=n.owner,p=n.ownerTokenAccount,m=n.metadata,g=n.mint,y=n.burner,v=n.numberOfUses,_=f.serialize({numberOfUses:v}),b=[{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:d,isSigner:!0,isWritable:!0},{pubkey:a,isSigner:!0,isWritable:!0},{pubkey:u,isSigner:!1,isWritable:!1},{pubkey:p,isSigner:!1,isWritable:!0},{pubkey:m,isSigner:!1,isWritable:!1},{pubkey:g,isSigner:!1,isWritable:!1},{pubkey:y,isSigner:!1,isWritable:!1},{pubkey:c.TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1},{pubkey:l.SystemProgram.programId,isSigner:!1,isWritable:!1},{pubkey:l.SYSVAR_RENT_PUBKEY,isSigner:!1,isWritable:!1}];return i.add(new l.TransactionInstruction({keys:b,programId:h.MetadataProgram.PUBKEY,data:_})),i}return i(r)}(u.Transaction);t.ApproveUseAuthority=d},9557:function(e,t,r){"use strict";var n=r(9728).default,i=r(6690).default,o=r(1655).default,a=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.CreateMasterEdition=t.CreateMasterEditionArgs=void 0;var s=r(3340),u=r(3717),c=r(6322),l=r(262),h=function(e){o(r,e);var t=a(r);function r(){var e;return i(this,r),(e=t.apply(this,arguments)).instruction=10,e}return n(r)}(s.Borsh.Data);t.CreateMasterEditionArgs=h,h.SCHEMA=h.struct([["instruction","u8"],["maxSupply",{kind:"option",type:"u64"}]]);var f=function(e){o(r,e);var t=a(r);function r(e,n){var o;i(this,r),o=t.call(this,e);var a=e.feePayer,s=n.edition,f=n.metadata,d=n.updateAuthority,p=n.mint,m=n.mintAuthority,g=n.maxSupply,y=h.serialize({maxSupply:g||null});return o.add(new c.TransactionInstruction({keys:[{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:p,isSigner:!1,isWritable:!0},{pubkey:d,isSigner:!0,isWritable:!1},{pubkey:m,isSigner:!0,isWritable:!1},{pubkey:a,isSigner:!0,isWritable:!1},{pubkey:f,isSigner:!1,isWritable:!1},{pubkey:u.TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1},{pubkey:c.SystemProgram.programId,isSigner:!1,isWritable:!1},{pubkey:c.SYSVAR_RENT_PUBKEY,isSigner:!1,isWritable:!1}],programId:l.MetadataProgram.PUBKEY,data:y})),o}return n(r)}(s.Transaction);t.CreateMasterEdition=f},2973:function(e,t,r){"use strict";var n=r(9728).default,i=r(6690).default,o=r(1655).default,a=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.CreateMasterEditionV3=t.CreateMasterEditionV3Args=void 0;var s=r(3340),u=r(3717),c=r(6322),l=r(262),h=function(e){o(r,e);var t=a(r);function r(){var e;return i(this,r),(e=t.apply(this,arguments)).instruction=17,e}return n(r)}(s.Borsh.Data);t.CreateMasterEditionV3Args=h,h.SCHEMA=h.struct([["instruction","u8"],["maxSupply",{kind:"option",type:"u64"}]]);var f=function(e){o(r,e);var t=a(r);function r(e,n){var o;i(this,r),o=t.call(this,e);var a=e.feePayer,s=n.edition,f=n.metadata,d=n.updateAuthority,p=n.mint,m=n.mintAuthority,g=n.maxSupply,y=h.serialize({maxSupply:g||null});return o.add(new c.TransactionInstruction({keys:[{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:p,isSigner:!1,isWritable:!0},{pubkey:d,isSigner:!0,isWritable:!1},{pubkey:m,isSigner:!0,isWritable:!1},{pubkey:a,isSigner:!0,isWritable:!1},{pubkey:f,isSigner:!1,isWritable:!0},{pubkey:u.TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1},{pubkey:c.SystemProgram.programId,isSigner:!1,isWritable:!1},{pubkey:c.SYSVAR_RENT_PUBKEY,isSigner:!1,isWritable:!1}],programId:l.MetadataProgram.PUBKEY,data:y})),o}return n(r)}(s.Transaction);t.CreateMasterEditionV3=f},9880:function(e,t,r){"use strict";var n=r(861).default,i=r(9728).default,o=r(6690).default,a=r(1655).default,s=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.CreateMetadata=t.CreateMetadataArgs=void 0;var u=r(3340),c=r(6322),l=r(6981),h=r(262),f=function(e){a(r,e);var t=s(r);function r(){var e;return o(this,r),(e=t.apply(this,arguments)).instruction=0,e}return i(r)}(u.Borsh.Data);t.CreateMetadataArgs=f,f.SCHEMA=new Map([].concat(n(l.MetadataDataData.SCHEMA),n(f.struct([["instruction","u8"],["data",l.MetadataDataData],["isMutable","u8"]]))));var d=function(e){a(r,e);var t=s(r);function r(e,n){var i;o(this,r),i=t.call(this,e);var a=e.feePayer,s=n.metadata,u=n.metadataData,l=n.updateAuthority,d=n.mint,p=n.mintAuthority,m=f.serialize({data:u,isMutable:!0});return i.add(new c.TransactionInstruction({keys:[{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:d,isSigner:!1,isWritable:!1},{pubkey:p,isSigner:!0,isWritable:!1},{pubkey:a,isSigner:!0,isWritable:!1},{pubkey:l,isSigner:!1,isWritable:!1},{pubkey:c.SystemProgram.programId,isSigner:!1,isWritable:!1},{pubkey:c.SYSVAR_RENT_PUBKEY,isSigner:!1,isWritable:!1}],programId:h.MetadataProgram.PUBKEY,data:m})),i}return i(r)}(u.Transaction);t.CreateMetadata=d},3257:function(e,t,r){"use strict";var n=r(861).default,i=r(9728).default,o=r(6690).default,a=r(1655).default,s=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.CreateMetadataV2=t.CreateMetadataV2Args=void 0;var u=r(3340),c=r(6322),l=r(6981),h=r(262),f=function(e){a(r,e);var t=s(r);function r(){var e;return o(this,r),(e=t.apply(this,arguments)).instruction=16,e}return i(r)}(u.Borsh.Data);t.CreateMetadataV2Args=f,f.SCHEMA=new Map([].concat(n(l.DataV2.SCHEMA),n(f.struct([["instruction","u8"],["data",l.DataV2],["isMutable","u8"]]))));var d=function(e){a(r,e);var t=s(r);function r(e,n){var i;o(this,r),i=t.call(this,e);var a=e.feePayer,s=n.metadata,u=n.metadataData,l=n.updateAuthority,d=n.mint,p=n.mintAuthority,m=f.serialize({data:u,isMutable:!0});return i.add(new c.TransactionInstruction({keys:[{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:d,isSigner:!1,isWritable:!1},{pubkey:p,isSigner:!0,isWritable:!1},{pubkey:a,isSigner:!0,isWritable:!1},{pubkey:l,isSigner:!1,isWritable:!1},{pubkey:c.SystemProgram.programId,isSigner:!1,isWritable:!1},{pubkey:c.SYSVAR_RENT_PUBKEY,isSigner:!1,isWritable:!1}],programId:h.MetadataProgram.PUBKEY,data:m})),i}return i(r)}(u.Transaction);t.CreateMetadataV2=d},5713:function(e,t,r){"use strict";var n=r(861).default,i=r(9728).default,o=r(6690).default,a=r(1655).default,s=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.FreezeDelegatedAccount=t.FreezeDelegatedAccountArgs=void 0;var u=r(3340),c=r(6322),l=r(262),h=r(3717),f=function(e){a(r,e);var t=s(r);function r(){var e;return o(this,r),(e=t.apply(this,arguments)).instruction=26,e}return i(r)}(u.Borsh.Data);t.FreezeDelegatedAccountArgs=f,f.SCHEMA=new Map(n(f.struct([["instruction","u8"]])));var d=function(e){a(r,e);var t=s(r);function r(e,n){var i;o(this,r),i=t.call(this,e);var a=n.delegate,s=n.token_account,u=n.edition,d=n.mint,p=f.serialize();return i.add(new c.TransactionInstruction({keys:[{pubkey:a,isSigner:!0,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:u,isSigner:!1,isWritable:!1},{pubkey:d,isSigner:!1,isWritable:!1},{pubkey:h.TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1}],programId:l.MetadataProgram.PUBKEY,data:p})),i}return i(r)}(u.Transaction);t.FreezeDelegatedAccount=d},2871:function(e,t,r){"use strict";var n=r(9728).default,i=r(6690).default,o=r(1655).default,a=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.MintNewEditionFromMasterEditionViaToken=t.MintNewEditionFromMasterEditionViaTokenArgs=void 0;var s=r(3340),u=r(3717),c=r(6322),l=r(262),h=function(e){o(r,e);var t=a(r);function r(){var e;return i(this,r),(e=t.apply(this,arguments)).instruction=11,e}return n(r)}(s.Borsh.Data);t.MintNewEditionFromMasterEditionViaTokenArgs=h,h.SCHEMA=h.struct([["instruction","u8"],["edition","u64"]]);var f=function(e){o(r,e);var t=a(r);function r(e,n){var o;i(this,r),o=t.call(this,e);var a=e.feePayer,s=n.edition,f=n.metadata,d=n.updateAuthority,p=n.masterEdition,m=n.masterMetadata,g=n.mint,y=n.editionMarker,v=n.mintAuthority,_=n.tokenOwner,b=n.tokenAccount,x=n.editionValue,w=h.serialize({edition:x});return o.add(new c.TransactionInstruction({keys:[{pubkey:f,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:p,isSigner:!1,isWritable:!0},{pubkey:g,isSigner:!1,isWritable:!0},{pubkey:y,isSigner:!1,isWritable:!0},{pubkey:v,isSigner:!0,isWritable:!1},{pubkey:a,isSigner:!0,isWritable:!1},{pubkey:_,isSigner:!0,isWritable:!1},{pubkey:b,isSigner:!1,isWritable:!1},{pubkey:d,isSigner:!1,isWritable:!1},{pubkey:m,isSigner:!1,isWritable:!1},{pubkey:u.TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1},{pubkey:c.SystemProgram.programId,isSigner:!1,isWritable:!1},{pubkey:c.SYSVAR_RENT_PUBKEY,isSigner:!1,isWritable:!1}],programId:l.MetadataProgram.PUBKEY,data:w})),o}return n(r)}(s.Transaction);t.MintNewEditionFromMasterEditionViaToken=f},4364:function(e,t,r){"use strict";var n=r(9728).default,i=r(6690).default,o=r(1655).default,a=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.RemoveCreatorVerification=t.RemoveCreatorVerificationArgs=void 0;var s=r(3340),u=r(6322),c=r(262),l=function(e){o(r,e);var t=a(r);function r(){var e;return i(this,r),(e=t.apply(this,arguments)).instruction=28,e}return n(r)}(s.Borsh.Data);t.RemoveCreatorVerificationArgs=l,l.SCHEMA=l.struct([["instruction","u8"]]);var h=function(e){o(r,e);var t=a(r);function r(e,n){var o;i(this,r),o=t.call(this,e);var a=n.metadata,s=n.creator,h=l.serialize();return o.add(new u.TransactionInstruction({keys:[{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!0,isWritable:!1}],programId:c.MetadataProgram.PUBKEY,data:h})),o}return n(r)}(s.Transaction);t.RemoveCreatorVerification=h},8702:function(e,t,r){"use strict";var n=r(861).default,i=r(9728).default,o=r(6690).default,a=r(1655).default,s=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.RevokeCollectionAuthority=t.RevokeCollectionAuthorityArgs=void 0;var u=r(3340),c=r(6322),l=r(262),h=function(e){a(r,e);var t=s(r);function r(){var e;return o(this,r),(e=t.apply(this,arguments)).instruction=24,e}return i(r)}(u.Borsh.Data);t.RevokeCollectionAuthorityArgs=h,h.SCHEMA=new Map(n(h.struct([["instruction","u8"]])));var f=function(e){a(r,e);var t=s(r);function r(e,n){var i;o(this,r),i=t.call(this,e);var a=n.metadata,s=n.collectionAuthorityRecord,u=n.delegateAuthority,f=n.newCollectionAuthority,d=n.updateAuthority,p=n.mint,m=u||f;if(!m)throw new Error("Must provide either a delegateAuthority");var g=h.serialize(),y=[{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:m,isSigner:!1,isWritable:!1},{pubkey:d,isSigner:!0,isWritable:!1},{pubkey:a,isSigner:!1,isWritable:!1},{pubkey:p,isSigner:!1,isWritable:!1},{pubkey:c.SystemProgram.programId,isSigner:!1,isWritable:!1},{pubkey:c.SYSVAR_RENT_PUBKEY,isSigner:!1,isWritable:!1}];return i.add(new c.TransactionInstruction({keys:y,programId:l.MetadataProgram.PUBKEY,data:g})),i}return i(r)}(u.Transaction);t.RevokeCollectionAuthority=f},81:function(e,t,r){"use strict";var n=r(861).default,i=r(9728).default,o=r(6690).default,a=r(1655).default,s=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.RevokeUseAuthority=t.RevokeUseAuthorityArgs=void 0;var u=r(3340),c=r(3717),l=r(6322),h=r(262),f=function(e){a(r,e);var t=s(r);function r(){var e;return o(this,r),(e=t.apply(this,arguments)).instruction=21,e}return i(r)}(u.Borsh.Data);t.RevokeUseAuthorityArgs=f,f.SCHEMA=new Map(n(f.struct([["instruction","u8"]])));var d=function(e){a(r,e);var t=s(r);function r(e,n){var i;o(this,r),i=t.call(this,e);var a=n.useAuthorityRecord,s=n.user,u=n.owner,d=n.ownerTokenAccount,p=n.metadata,m=n.mint,g=f.serialize(),y=[{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:u,isSigner:!0,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!1},{pubkey:d,isSigner:!1,isWritable:!0},{pubkey:m,isSigner:!1,isWritable:!1},{pubkey:p,isSigner:!1,isWritable:!1},{pubkey:c.TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1},{pubkey:l.SystemProgram.programId,isSigner:!1,isWritable:!1},{pubkey:l.SYSVAR_RENT_PUBKEY,isSigner:!1,isWritable:!1}];return i.add(new l.TransactionInstruction({keys:y,programId:h.MetadataProgram.PUBKEY,data:g})),i}return i(r)}(u.Transaction);t.RevokeUseAuthority=d},8865:function(e,t,r){"use strict";var n=r(861).default,i=r(9728).default,o=r(6690).default,a=r(1655).default,s=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.SetAndVerifyCollectionCollection=t.SetAndVerifyCollectionArgs=void 0;var u=r(3340),c=r(6322),l=r(262),h=function(e){a(r,e);var t=s(r);function r(){var e;return o(this,r),(e=t.apply(this,arguments)).instruction=25,e}return i(r)}(u.Borsh.Data);t.SetAndVerifyCollectionArgs=h,h.SCHEMA=new Map(n(h.struct([["instruction","u8"]])));var f=function(e){a(r,e);var t=s(r);function r(e,n){var i;o(this,r),i=t.call(this,e);var a=e.feePayer,s=n.metadata,u=n.collectionAuthority,f=n.collectionMint,d=n.updateAuthority,p=n.collectionMetadata,m=n.collectionMasterEdition,g=n.collectionAuthorityRecord,y=h.serialize(),v=[{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:u,isSigner:!0,isWritable:!0},{pubkey:a,isSigner:!0,isWritable:!0},{pubkey:d,isSigner:!1,isWritable:!1},{pubkey:f,isSigner:!1,isWritable:!1},{pubkey:p,isSigner:!1,isWritable:!1},{pubkey:m,isSigner:!1,isWritable:!1}];return g&&v.push({pubkey:g,isSigner:!1,isWritable:!1}),i.add(new c.TransactionInstruction({keys:v,programId:l.MetadataProgram.PUBKEY,data:y})),i}return i(r)}(u.Transaction);t.SetAndVerifyCollectionCollection=f},1996:function(e,t,r){"use strict";var n=r(9728).default,i=r(6690).default,o=r(1655).default,a=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.SignMetadata=t.SignMetadataArgs=void 0;var s=r(3340),u=r(6322),c=r(262),l=function(e){o(r,e);var t=a(r);function r(){var e;return i(this,r),(e=t.apply(this,arguments)).instruction=7,e}return n(r)}(s.Borsh.Data);t.SignMetadataArgs=l,l.SCHEMA=l.struct([["instruction","u8"]]);var h=function(e){o(r,e);var t=a(r);function r(e,n){var o;i(this,r),o=t.call(this,e);var a=n.metadata,s=n.creator,h=l.serialize();return o.add(new u.TransactionInstruction({keys:[{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!0,isWritable:!1}],programId:c.MetadataProgram.PUBKEY,data:h})),o}return n(r)}(s.Transaction);t.SignMetadata=h},6378:function(e,t,r){"use strict";var n=r(861).default,i=r(9728).default,o=r(6690).default,a=r(1655).default,s=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.ThawDelegatedAccount=t.ThawDelegatedAccountArgs=void 0;var u=r(3340),c=r(6322),l=r(262),h=r(3717),f=function(e){a(r,e);var t=s(r);function r(){var e;return o(this,r),(e=t.apply(this,arguments)).instruction=27,e}return i(r)}(u.Borsh.Data);t.ThawDelegatedAccountArgs=f,f.SCHEMA=new Map(n(f.struct([["instruction","u8"]])));var d=function(e){a(r,e);var t=s(r);function r(e,n){var i;o(this,r),i=t.call(this,e);var a=n.delegate,s=n.token_account,u=n.edition,d=n.mint,p=f.serialize();return i.add(new c.TransactionInstruction({keys:[{pubkey:a,isSigner:!0,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:u,isSigner:!1,isWritable:!1},{pubkey:d,isSigner:!1,isWritable:!1},{pubkey:h.TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1}],programId:l.MetadataProgram.PUBKEY,data:p})),i}return i(r)}(u.Transaction);t.ThawDelegatedAccount=d},4045:function(e,t,r){"use strict";var n=r(861).default,i=r(9728).default,o=r(6690).default,a=r(1655).default,s=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.UnVerifyCollection=t.UnVerifyCollectionArgs=void 0;var u=r(3340),c=r(6322),l=r(262),h=function(e){a(r,e);var t=s(r);function r(){var e;return o(this,r),(e=t.apply(this,arguments)).instruction=22,e}return i(r)}(u.Borsh.Data);t.UnVerifyCollectionArgs=h,h.SCHEMA=new Map(n(h.struct([["instruction","u8"]])));var f=function(e){a(r,e);var t=s(r);function r(e,n){var i;o(this,r),i=t.call(this,e);var a=e.feePayer,s=n.metadata,u=n.collectionAuthority,f=n.collectionMint,d=n.collectionMetadata,p=n.collectionMasterEdition,m=n.collectionAuthorityRecord,g=h.serialize(),y=[{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:u,isSigner:!0,isWritable:!0},{pubkey:a,isSigner:!0,isWritable:!0},{pubkey:f,isSigner:!1,isWritable:!1},{pubkey:d,isSigner:!1,isWritable:!1},{pubkey:p,isSigner:!1,isWritable:!1}];return m&&y.push({pubkey:m,isSigner:!1,isWritable:!1}),i.add(new c.TransactionInstruction({keys:y,programId:l.MetadataProgram.PUBKEY,data:g})),i}return i(r)}(u.Transaction);t.UnVerifyCollection=f},2202:function(e,t,r){"use strict";var n=r(861).default,i=r(9728).default,o=r(6690).default,a=r(1655).default,s=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.UpdateMetadata=t.UpdateMetadataArgs=void 0;var u=r(3340),c=r(6322),l=r(6981),h=r(262),f=function(e){a(r,e);var t=s(r);function r(){var e;return o(this,r),(e=t.apply(this,arguments)).instruction=1,e}return i(r)}(u.Borsh.Data);t.UpdateMetadataArgs=f,f.SCHEMA=new Map([].concat(n(l.MetadataDataData.SCHEMA),n(f.struct([["instruction","u8"],["data",{kind:"option",type:l.MetadataDataData}],["updateAuthority",{kind:"option",type:"pubkeyAsString"}],["primarySaleHappened",{kind:"option",type:"u8"}]]))));var d=function(e){a(r,e);var t=s(r);function r(e,n){var i;o(this,r),i=t.call(this,e);var a=n.metadata,s=n.metadataData,u=n.updateAuthority,l=n.newUpdateAuthority,d=n.primarySaleHappened,p=f.serialize({data:s,updateAuthority:l&&l.toString(),primarySaleHappened:d||null});return i.add(new c.TransactionInstruction({keys:[{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:u,isSigner:!0,isWritable:!1}],programId:h.MetadataProgram.PUBKEY,data:p})),i}return i(r)}(u.Transaction);t.UpdateMetadata=d},4939:function(e,t,r){"use strict";var n=r(861).default,i=r(9728).default,o=r(6690).default,a=r(1655).default,s=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.UpdateMetadataV2=t.UpdateMetadataV2Args=void 0;var u=r(3340),c=r(6322),l=r(6981),h=r(262),f=function(e){a(r,e);var t=s(r);function r(){var e;return o(this,r),(e=t.apply(this,arguments)).instruction=15,e}return i(r)}(u.Borsh.Data);t.UpdateMetadataV2Args=f,f.SCHEMA=new Map([].concat(n(l.DataV2.SCHEMA),n(f.struct([["instruction","u8"],["data",{kind:"option",type:l.DataV2}],["updateAuthority",{kind:"option",type:"pubkeyAsString"}],["primarySaleHappened",{kind:"option",type:"u8"}],["isMutable",{kind:"option",type:"u8"}]]))));var d=function(e){a(r,e);var t=s(r);function r(e,n){var i;o(this,r),i=t.call(this,e);var a=n.metadata,s=n.metadataData,u=n.updateAuthority,l=n.newUpdateAuthority,d=n.primarySaleHappened,p=n.isMutable,m=f.serialize({data:s,updateAuthority:l&&l.toString(),primarySaleHappened:d||null,isMutable:p||null});return i.add(new c.TransactionInstruction({keys:[{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:u,isSigner:!0,isWritable:!1}],programId:h.MetadataProgram.PUBKEY,data:m})),i}return i(r)}(u.Transaction);t.UpdateMetadataV2=d},7159:function(e,t,r){"use strict";var n=r(9728).default,i=r(6690).default,o=r(1655).default,a=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.UpdatePrimarySaleHappenedViaToken=t.UpdatePrimarySaleHappenedViaTokenArgs=void 0;var s=r(3340),u=r(6322),c=r(262),l=function(e){o(r,e);var t=a(r);function r(){var e;return i(this,r),(e=t.apply(this,arguments)).instruction=4,e}return n(r)}(s.Borsh.Data);t.UpdatePrimarySaleHappenedViaTokenArgs=l,l.SCHEMA=l.struct([["instruction","u8"]]);var h=function(e){o(r,e);var t=a(r);function r(e,n){var o;i(this,r),o=t.call(this,e);var a=n.metadata,s=n.owner,h=n.tokenAccount,f=l.serialize();return o.add(new u.TransactionInstruction({keys:[{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!0,isWritable:!1},{pubkey:h,isSigner:!1,isWritable:!1}],programId:c.MetadataProgram.PUBKEY,data:f})),o}return n(r)}(s.Transaction);t.UpdatePrimarySaleHappenedViaToken=h},9428:function(e,t,r){"use strict";var n=r(861).default,i=r(9728).default,o=r(6690).default,a=r(1655).default,s=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.Utilize=t.UtilizeArgs=void 0;var u=r(3340),c=r(3717),l=r(6322),h=r(262),f=function(e){a(r,e);var t=s(r);function r(){var e;return o(this,r),(e=t.apply(this,arguments)).instruction=19,e}return i(r)}(u.Borsh.Data);t.UtilizeArgs=f,f.SCHEMA=new Map(n(f.struct([["instruction","u8"],["numberOfUses","u8"]])));var d=function(e){a(r,e);var t=s(r);function r(e,n){var i;o(this,r),i=t.call(this,e);var a=n.metadata,s=n.useAuthority,u=n.numberOfUses,d=n.burner,p=n.tokenAccount,m=f.serialize({numberOfUses:u}),g=[{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:p,isSigner:!1,isWritable:!0},{pubkey:s,isSigner:!0,isWritable:!1},{pubkey:c.TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1},{pubkey:l.SystemProgram.programId,isSigner:!1,isWritable:!1},{pubkey:l.SYSVAR_RENT_PUBKEY,isSigner:!1,isWritable:!1}];return s&&(g.push({pubkey:s,isSigner:!1,isWritable:!1}),g.push({pubkey:d,isSigner:!1,isWritable:!1})),i.add(new l.TransactionInstruction({keys:g,programId:h.MetadataProgram.PUBKEY,data:m})),i}return i(r)}(u.Transaction);t.Utilize=d},7929:function(e,t,r){"use strict";var n=r(861).default,i=r(9728).default,o=r(6690).default,a=r(1655).default,s=r(6389).default;Object.defineProperty(t,"__esModule",{value:!0}),t.VerifyCollection=t.VerifyCollectionArgs=void 0;var u=r(3340),c=r(6322),l=r(262),h=function(e){a(r,e);var t=s(r);function r(){var e;return o(this,r),(e=t.apply(this,arguments)).instruction=18,e}return i(r)}(u.Borsh.Data);t.VerifyCollectionArgs=h,h.SCHEMA=new Map(n(h.struct([["instruction","u8"]])));var f=function(e){a(r,e);var t=s(r);function r(e,n){var i;o(this,r),i=t.call(this,e);var a=e.feePayer,s=n.metadata,u=n.collectionAuthority,f=n.collectionMint,d=n.collectionMetadata,p=n.collectionMasterEdition,m=n.collectionAuthorityRecord,g=h.serialize(),y=[{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:u,isSigner:!0,isWritable:!0},{pubkey:a,isSigner:!0,isWritable:!0},{pubkey:f,isSigner:!1,isWritable:!1},{pubkey:d,isSigner:!1,isWritable:!1},{pubkey:p,isSigner:!1,isWritable:!1}];return m&&y.push({pubkey:m,isSigner:!1,isWritable:!1}),i.add(new c.TransactionInstruction({keys:y,programId:l.MetadataProgram.PUBKEY,data:g})),i}return i(r)}(u.Transaction);t.VerifyCollection=f},2667:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),i=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),i(r(9880),t),i(r(2202),t),i(r(9557),t),i(r(2871),t),i(r(7159),t),i(r(1996),t),i(r(4939),t),i(r(3257),t),i(r(2973),t),i(r(7929),t),i(r(4045),t),i(r(1996),t),i(r(8865),t),i(r(1087),t),i(r(81),t),i(r(7646),t),i(r(8702),t),i(r(9428),t),i(r(5713),t),i(r(6378),t),i(r(4364),t)},73:function(e,t,r){var n=r(2307);e.exports=n("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz")},2576:function(e,t,r){"use strict";var n=r(1588).default,i=r(3808).default,o=r(6115).default,a=r(4704).default,s=r(1655).default,u=r(6389).default,c=r(6690).default,l=r(9728).default;Object.defineProperty(t,"__esModule",{value:!0}),t.s16=t.s8=t.nu64be=t.u48be=t.u40be=t.u32be=t.u24be=t.u16be=t.nu64=t.u48=t.u40=t.u32=t.u24=t.u16=t.u8=t.offset=t.greedy=t.Constant=t.UTF8=t.CString=t.Blob=t.Boolean=t.BitField=t.BitStructure=t.VariantLayout=t.Union=t.UnionLayoutDiscriminator=t.UnionDiscriminator=t.Structure=t.Sequence=t.DoubleBE=t.Double=t.FloatBE=t.Float=t.NearInt64BE=t.NearInt64=t.NearUInt64BE=t.NearUInt64=t.IntBE=t.Int=t.UIntBE=t.UInt=t.OffsetLayout=t.GreedyCount=t.ExternalLayout=t.bindConstructorLayout=t.nameWithProperty=t.Layout=t.uint8ArrayToBuffer=t.checkUint8Array=void 0,t.constant=t.utf8=t.cstr=t.blob=t.unionLayoutDiscriminator=t.union=t.seq=t.bits=t.struct=t.f64be=t.f64=t.f32be=t.f32=t.ns64be=t.s48be=t.s40be=t.s32be=t.s24be=t.s16be=t.ns64=t.s48=t.s40=t.s32=t.s24=void 0;var h=r(9778);function f(e){if(!(e instanceof Uint8Array))throw new TypeError("b must be a Uint8Array")}function d(e){return f(e),h.Buffer.from(e.buffer,e.byteOffset,e.length)}t.checkUint8Array=f,t.uint8ArrayToBuffer=d;var p=function(){function e(t,r){if(c(this,e),!Number.isInteger(t))throw new TypeError("span must be an integer");this.span=t,this.property=r}return l(e,[{key:"makeDestinationObject",value:function(){return{}}},{key:"getSpan",value:function(e,t){if(0>this.span)throw new RangeError("indeterminate span");return this.span}},{key:"replicate",value:function(e){var t=Object.create(this.constructor.prototype);return Object.assign(t,this),t.property=e,t}},{key:"fromArray",value:function(e){}}]),e}();function m(e,t){return t.property?e+"["+t.property+"]":e}t.Layout=p,t.nameWithProperty=m,t.bindConstructorLayout=function(e,t){if("function"!==typeof e)throw new TypeError("Class must be constructor");if(Object.prototype.hasOwnProperty.call(e,"layout_"))throw new Error("Class is already bound to a layout");if(!(t&&t instanceof p))throw new TypeError("layout must be a Layout");if(Object.prototype.hasOwnProperty.call(t,"boundConstructor_"))throw new Error("layout is already bound to a constructor");e.layout_=t,t.boundConstructor_=e,t.makeDestinationObject=function(){return new e},Object.defineProperty(e.prototype,"encode",{value:function(e,r){return t.encode(this,e,r)},writable:!0}),Object.defineProperty(e,"decode",{value:function(e,r){return t.decode(e,r)},writable:!0})};var g=function(e){s(r,e);var t=u(r);function r(){return c(this,r),t.apply(this,arguments)}return l(r,[{key:"isCount",value:function(){throw new Error("ExternalLayout is abstract")}}]),r}(p);t.ExternalLayout=g;var y=function(e){s(r,e);var t=u(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,i=arguments.length>1?arguments[1]:void 0;if(c(this,r),!Number.isInteger(n)||0>=n)throw new TypeError("elementSpan must be a (positive) integer");return(e=t.call(this,-1,i)).elementSpan=n,e}return l(r,[{key:"isCount",value:function(){return!0}},{key:"decode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;f(e);var r=e.length-t;return Math.floor(r/this.elementSpan)}},{key:"encode",value:function(e,t,r){return 0}}]),r}(g);t.GreedyCount=y;var v=function(e){s(r,e);var t=u(r);function r(e){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2?arguments[2]:void 0;if(c(this,r),!(e instanceof p))throw new TypeError("layout must be a Layout");if(!Number.isInteger(i))throw new TypeError("offset must be integer or undefined");return(n=t.call(this,e.span,o||e.property)).layout=e,n.offset=i,n}return l(r,[{key:"isCount",value:function(){return this.layout instanceof _||this.layout instanceof b}},{key:"decode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.layout.decode(e,t+this.offset)}},{key:"encode",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.layout.encode(e,t,r+this.offset)}}]),r}(g);t.OffsetLayout=v;var _=function(e){s(r,e);var t=u(r);function r(e,n){var i;if(c(this,r),6<(i=t.call(this,e,n)).span)throw new RangeError("span must not exceed 6 bytes");return i}return l(r,[{key:"decode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return d(e).readUIntLE(t,this.span)}},{key:"encode",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return d(t).writeUIntLE(e,r,this.span),this.span}}]),r}(p);t.UInt=_;var b=function(e){s(r,e);var t=u(r);function r(e,n){var i;if(c(this,r),6<(i=t.call(this,e,n)).span)throw new RangeError("span must not exceed 6 bytes");return i}return l(r,[{key:"decode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return d(e).readUIntBE(t,this.span)}},{key:"encode",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return d(t).writeUIntBE(e,r,this.span),this.span}}]),r}(p);t.UIntBE=b;var x=function(e){s(r,e);var t=u(r);function r(e,n){var i;if(c(this,r),6<(i=t.call(this,e,n)).span)throw new RangeError("span must not exceed 6 bytes");return i}return l(r,[{key:"decode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return d(e).readIntLE(t,this.span)}},{key:"encode",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return d(t).writeIntLE(e,r,this.span),this.span}}]),r}(p);t.Int=x;var w=function(e){s(r,e);var t=u(r);function r(e,n){var i;if(c(this,r),6<(i=t.call(this,e,n)).span)throw new RangeError("span must not exceed 6 bytes");return i}return l(r,[{key:"decode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return d(e).readIntBE(t,this.span)}},{key:"encode",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return d(t).writeIntBE(e,r,this.span),this.span}}]),r}(p);t.IntBE=w;var k=Math.pow(2,32);function A(e){var t=Math.floor(e/k);return{hi32:t,lo32:e-t*k}}function E(e,t){return e*k+t}var S=function(e){s(r,e);var t=u(r);function r(e){return c(this,r),t.call(this,8,e)}return l(r,[{key:"decode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=d(e),n=r.readUInt32LE(t);return E(r.readUInt32LE(t+4),n)}},{key:"encode",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=A(e),i=d(t);return i.writeUInt32LE(n.lo32,r),i.writeUInt32LE(n.hi32,r+4),8}}]),r}(p);t.NearUInt64=S;var T=function(e){s(r,e);var t=u(r);function r(e){return c(this,r),t.call(this,8,e)}return l(r,[{key:"decode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=d(e);return E(r.readUInt32BE(t),r.readUInt32BE(t+4))}},{key:"encode",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=A(e),i=d(t);return i.writeUInt32BE(n.hi32,r),i.writeUInt32BE(n.lo32,r+4),8}}]),r}(p);t.NearUInt64BE=T;var M=function(e){s(r,e);var t=u(r);function r(e){return c(this,r),t.call(this,8,e)}return l(r,[{key:"decode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=d(e),n=r.readUInt32LE(t);return E(r.readInt32LE(t+4),n)}},{key:"encode",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=A(e),i=d(t);return i.writeUInt32LE(n.lo32,r),i.writeInt32LE(n.hi32,r+4),8}}]),r}(p);t.NearInt64=M;var I=function(e){s(r,e);var t=u(r);function r(e){return c(this,r),t.call(this,8,e)}return l(r,[{key:"decode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=d(e);return E(r.readInt32BE(t),r.readUInt32BE(t+4))}},{key:"encode",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=A(e),i=d(t);return i.writeInt32BE(n.hi32,r),i.writeUInt32BE(n.lo32,r+4),8}}]),r}(p);t.NearInt64BE=I;var P=function(e){s(r,e);var t=u(r);function r(e){return c(this,r),t.call(this,4,e)}return l(r,[{key:"decode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return d(e).readFloatLE(t)}},{key:"encode",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return d(t).writeFloatLE(e,r),4}}]),r}(p);t.Float=P;var C=function(e){s(r,e);var t=u(r);function r(e){return c(this,r),t.call(this,4,e)}return l(r,[{key:"decode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return d(e).readFloatBE(t)}},{key:"encode",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return d(t).writeFloatBE(e,r),4}}]),r}(p);t.FloatBE=C;var B=function(e){s(r,e);var t=u(r);function r(e){return c(this,r),t.call(this,8,e)}return l(r,[{key:"decode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return d(e).readDoubleLE(t)}},{key:"encode",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return d(t).writeDoubleLE(e,r),8}}]),r}(p);t.Double=B;var D=function(e){s(r,e);var t=u(r);function r(e){return c(this,r),t.call(this,8,e)}return l(r,[{key:"decode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return d(e).readDoubleBE(t)}},{key:"encode",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return d(t).writeDoubleBE(e,r),8}}]),r}(p);t.DoubleBE=D;var R=function(e){s(r,e);var t=u(r);function r(e,n,i){var o;if(c(this,r),!(e instanceof p))throw new TypeError("elementLayout must be a Layout");if(!(n instanceof g&&n.isCount()||Number.isInteger(n)&&0<=n))throw new TypeError("count must be non-negative integer or an unsigned integer ExternalLayout");var a=-1;return!(n instanceof g)&&0<e.span&&(a=n*e.span),(o=t.call(this,a,i)).elementLayout=e,o.count=n,o}return l(r,[{key:"getSpan",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(0<=this.span)return this.span;var r=0,n=this.count;if(n instanceof g&&(n=n.decode(e,t)),0<this.elementLayout.span)r=n*this.elementLayout.span;else for(var i=0;i<n;)r+=this.elementLayout.getSpan(e,t+r),++i;return r}},{key:"decode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=[],n=0,i=this.count;for(i instanceof g&&(i=i.decode(e,t));n<i;)r.push(this.elementLayout.decode(e,t)),t+=this.elementLayout.getSpan(e,t),n+=1;return r}},{key:"encode",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=this.elementLayout,i=e.reduce((function(e,i){return e+n.encode(i,t,r+e)}),0);return this.count instanceof g&&this.count.encode(e.length,t,r),i}}]),r}(p);t.Sequence=R;var L=function(e){s(r,e);var t=u(r);function r(e,n,i){var o;if(c(this,r),!Array.isArray(e)||!e.reduce((function(e,t){return e&&t instanceof p}),!0))throw new TypeError("fields must be array of Layout instances");"boolean"===typeof n&&void 0===i&&(i=n,n=void 0);var s,u=a(e);try{for(u.s();!(s=u.n()).done;){var l=s.value;if(0>l.span&&void 0===l.property)throw new Error("fields cannot contain unnamed variable-length layout")}}catch(f){u.e(f)}finally{u.f()}var h=-1;try{h=e.reduce((function(e,t){return e+t.getSpan()}),0)}catch(d){}return(o=t.call(this,h,n)).fields=e,o.decodePrefixes=!!i,o}return l(r,[{key:"getSpan",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(0<=this.span)return this.span;var r=0;try{r=this.fields.reduce((function(r,n){var i=n.getSpan(e,t);return t+=i,r+i}),0)}catch(n){throw new RangeError("indeterminate span")}return r}},{key:"decode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;f(e);var r,n=this.makeDestinationObject(),i=a(this.fields);try{for(i.s();!(r=i.n()).done;){var o=r.value;if(void 0!==o.property&&(n[o.property]=o.decode(e,t)),t+=o.getSpan(e,t),this.decodePrefixes&&e.length===t)break}}catch(s){i.e(s)}finally{i.f()}return n}},{key:"encode",value:function(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=n,o=0,s=0,u=a(this.fields);try{for(u.s();!(r=u.n()).done;){var c=r.value,l=c.span;if(s=0<l?l:0,void 0!==c.property){var h=e[c.property];void 0!==h&&(s=c.encode(h,t,n),0>l&&(l=c.getSpan(t,n)))}o=n,n+=l}}catch(f){u.e(f)}finally{u.f()}return o+s-i}},{key:"fromArray",value:function(e){var t,r=this.makeDestinationObject(),n=a(this.fields);try{for(n.s();!(t=n.n()).done;){var i=t.value;void 0!==i.property&&0<e.length&&(r[i.property]=e.shift())}}catch(o){n.e(o)}finally{n.f()}return r}},{key:"layoutFor",value:function(e){if("string"!==typeof e)throw new TypeError("property must be string");var t,r=a(this.fields);try{for(r.s();!(t=r.n()).done;){var n=t.value;if(n.property===e)return n}}catch(i){r.e(i)}finally{r.f()}}},{key:"offsetOf",value:function(e){if("string"!==typeof e)throw new TypeError("property must be string");var t,r=0,n=a(this.fields);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(i.property===e)return r;0>i.span?r=-1:0<=r&&(r+=i.span)}}catch(o){n.e(o)}finally{n.f()}}}]),r}(p);t.Structure=L;var O=function(){function e(t){c(this,e),this.property=t}return l(e,[{key:"decode",value:function(e,t){throw new Error("UnionDiscriminator is abstract")}},{key:"encode",value:function(e,t,r){throw new Error("UnionDiscriminator is abstract")}}]),e}();t.UnionDiscriminator=O;var z=function(e){s(r,e);var t=u(r);function r(e,n){var i;if(c(this,r),!(e instanceof g&&e.isCount()))throw new TypeError("layout must be an unsigned integer ExternalLayout");return(i=t.call(this,n||e.property||"variant")).layout=e,i}return l(r,[{key:"decode",value:function(e,t){return this.layout.decode(e,t)}},{key:"encode",value:function(e,t,r){return this.layout.encode(e,t,r)}}]),r}(O);t.UnionLayoutDiscriminator=z;var N=function(e){s(r,e);var t=u(r);function r(e,n,i){var a,s;if(c(this,r),e instanceof _||e instanceof b)s=new z(new v(e));else if(e instanceof g&&e.isCount())s=new z(e);else{if(!(e instanceof O))throw new TypeError("discr must be a UnionDiscriminator or an unsigned integer layout");s=e}if(void 0===n&&(n=null),!(null===n||n instanceof p))throw new TypeError("defaultLayout must be null or a Layout");if(null!==n){if(0>n.span)throw new Error("defaultLayout must have constant span");void 0===n.property&&(n=n.replicate("content"))}var u=-1;n&&0<=(u=n.span)&&(e instanceof _||e instanceof b)&&(u+=s.layout.span),(a=t.call(this,u,i)).discriminator=s,a.usesPrefixDiscriminator=e instanceof _||e instanceof b,a.defaultLayout=n,a.registry={};var l=a.defaultGetSourceVariant.bind(o(a));return a.getSourceVariant=function(e){return l(e)},a.configGetSourceVariant=function(e){l=e.bind(this)},a}return l(r,[{key:"getSpan",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(0<=this.span)return this.span;var r=this.getVariant(e,t);if(!r)throw new Error("unable to determine span for unrecognized variant");return r.getSpan(e,t)}},{key:"defaultGetSourceVariant",value:function(e){if(Object.prototype.hasOwnProperty.call(e,this.discriminator.property)){if(this.defaultLayout&&this.defaultLayout.property&&Object.prototype.hasOwnProperty.call(e,this.defaultLayout.property))return;var t=this.registry[e[this.discriminator.property]];if(t&&(!t.layout||t.property&&Object.prototype.hasOwnProperty.call(e,t.property)))return t}else for(var r in this.registry){var n=this.registry[r];if(n.property&&Object.prototype.hasOwnProperty.call(e,n.property))return n}throw new Error("unable to infer src variant")}},{key:"decode",value:function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.discriminator,i=n.decode(e,r),o=this.registry[i];if(void 0===o){var a=this.defaultLayout,s=0;this.usesPrefixDiscriminator&&(s=n.layout.span),(t=this.makeDestinationObject())[n.property]=i,t[a.property]=a.decode(e,r+s)}else t=o.decode(e,r);return t}},{key:"encode",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=this.getSourceVariant(e);if(void 0===n){var i=this.discriminator,o=this.defaultLayout,a=0;return this.usesPrefixDiscriminator&&(a=i.layout.span),i.encode(e[i.property],t,r),a+o.encode(e[o.property],t,r+a)}return n.encode(e,t,r)}},{key:"addVariant",value:function(e,t,r){var n=new U(this,e,t,r);return this.registry[e]=n,n}},{key:"getVariant",value:function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t=e instanceof Uint8Array?this.discriminator.decode(e,r):e,this.registry[t]}}]),r}(p);t.Union=N;var U=function(e){s(r,e);var t=u(r);function r(e,n,i,o){var a;if(c(this,r),!(e instanceof N))throw new TypeError("union must be a Union");if(!Number.isInteger(n)||0>n)throw new TypeError("variant must be a (non-negative) integer");if("string"===typeof i&&void 0===o&&(o=i,i=null),i){if(!(i instanceof p))throw new TypeError("layout must be a Layout");if(null!==e.defaultLayout&&0<=i.span&&i.span>e.defaultLayout.span)throw new Error("variant span exceeds span of containing union");if("string"!==typeof o)throw new TypeError("variant must have a String property")}var s=e.span;return 0>e.span&&0<=(s=i?i.span:0)&&e.usesPrefixDiscriminator&&(s+=e.discriminator.layout.span),(a=t.call(this,s,o)).union=e,a.variant=n,a.layout=i||null,a}return l(r,[{key:"getSpan",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(0<=this.span)return this.span;var r=0;this.union.usesPrefixDiscriminator&&(r=this.union.discriminator.layout.span);var n=0;return this.layout&&(n=this.layout.getSpan(e,t+r)),r+n}},{key:"decode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=this.makeDestinationObject();if(this!==this.union.getVariant(e,t))throw new Error("variant mismatch");var n=0;return this.union.usesPrefixDiscriminator&&(n=this.union.discriminator.layout.span),this.layout?r[this.property]=this.layout.decode(e,t+n):this.property?r[this.property]=!0:this.union.usesPrefixDiscriminator&&(r[this.union.discriminator.property]=this.variant),r}},{key:"encode",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=0;if(this.union.usesPrefixDiscriminator&&(n=this.union.discriminator.layout.span),this.layout&&!Object.prototype.hasOwnProperty.call(e,this.property))throw new TypeError("variant lacks property "+this.property);this.union.discriminator.encode(this.variant,t,r);var i=n;if(this.layout&&(this.layout.encode(e[this.property],t,r+n),i+=this.layout.getSpan(t,r+n),0<=this.union.span&&i>this.union.span))throw new Error("encoded variant overruns containing union");return i}},{key:"fromArray",value:function(e){if(this.layout)return this.layout.fromArray(e)}}]),r}(p);function Z(e){return 0>e&&(e+=4294967296),e}t.VariantLayout=U;var F=function(e){s(r,e);var t=u(r);function r(e,n,i){var o;if(c(this,r),!(e instanceof _||e instanceof b))throw new TypeError("word must be a UInt or UIntBE layout");if("string"===typeof n&&void 0===i&&(i=n,n=!1),4<e.span)throw new RangeError("word cannot exceed 32 bits");(o=t.call(this,e.span,i)).word=e,o.msb=!!n,o.fields=[];var a=0;return o._packedSetValue=function(e){return a=Z(e),this},o._packedGetValue=function(){return a},o}return l(r,[{key:"decode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=this.makeDestinationObject(),n=this.word.decode(e,t);this._packedSetValue(n);var i,o=a(this.fields);try{for(o.s();!(i=o.n()).done;){var s=i.value;void 0!==s.property&&(r[s.property]=s.decode(e))}}catch(u){o.e(u)}finally{o.f()}return r}},{key:"encode",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=this.word.decode(t,r);this._packedSetValue(n);var i,o=a(this.fields);try{for(o.s();!(i=o.n()).done;){var s=i.value;if(void 0!==s.property){var u=e[s.property];void 0!==u&&s.encode(u)}}}catch(c){o.e(c)}finally{o.f()}return this.word.encode(this._packedGetValue(),t,r)}},{key:"addField",value:function(e,t){var r=new j(this,e,t);return this.fields.push(r),r}},{key:"addBoolean",value:function(e){var t=new V(this,e);return this.fields.push(t),t}},{key:"fieldFor",value:function(e){if("string"!==typeof e)throw new TypeError("property must be string");var t,r=a(this.fields);try{for(r.s();!(t=r.n()).done;){var n=t.value;if(n.property===e)return n}}catch(i){r.e(i)}finally{r.f()}}}]),r}(p);t.BitStructure=F;var j=function(){function e(t,r,n){if(c(this,e),!(t instanceof F))throw new TypeError("container must be a BitStructure");if(!Number.isInteger(r)||0>=r)throw new TypeError("bits must be positive integer");var i=8*t.span,o=t.fields.reduce((function(e,t){return e+t.bits}),0);if(r+o>i)throw new Error("bits too long for span remainder ("+(i-o)+" of "+i+" remain)");this.container=t,this.bits=r,this.valueMask=(1<<r)-1,32===r&&(this.valueMask=4294967295),this.start=o,this.container.msb&&(this.start=i-o-r),this.wordMask=Z(this.valueMask<<this.start),this.property=n}return l(e,[{key:"decode",value:function(e,t){return Z(this.container._packedGetValue()&this.wordMask)>>>this.start}},{key:"encode",value:function(e){if("number"!==typeof e||!Number.isInteger(e)||e!==Z(e&this.valueMask))throw new TypeError(m("BitField.encode",this)+" value must be integer not exceeding "+this.valueMask);var t=this.container._packedGetValue(),r=Z(e<<this.start);this.container._packedSetValue(Z(t&~this.wordMask)|r)}}]),e}();t.BitField=j;var V=function(e){s(r,e);var t=u(r);function r(e,n){return c(this,r),t.call(this,e,1,n)}return l(r,[{key:"decode",value:function(e,t){return!!n(i(r.prototype),"decode",this).call(this,e,t)}},{key:"encode",value:function(e){"boolean"===typeof e&&(e=+e),n(i(r.prototype),"encode",this).call(this,e)}}]),r}(j);t.Boolean=V;var W=function(e){s(r,e);var t=u(r);function r(e,n){var i;if(c(this,r),!(e instanceof g&&e.isCount()||Number.isInteger(e)&&0<=e))throw new TypeError("length must be positive integer or an unsigned integer ExternalLayout");var o=-1;return e instanceof g||(o=e),(i=t.call(this,o,n)).length=e,i}return l(r,[{key:"getSpan",value:function(e,t){var r=this.span;return 0>r&&(r=this.length.decode(e,t)),r}},{key:"decode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=this.span;return 0>r&&(r=this.length.decode(e,t)),d(e).slice(t,t+r)}},{key:"encode",value:function(e,t,r){var n=this.length;if(this.length instanceof g&&(n=e.length),!(e instanceof Uint8Array&&n===e.length))throw new TypeError(m("Blob.encode",this)+" requires (length "+n+") Uint8Array as src");if(r+n>t.length)throw new RangeError("encoding overruns Uint8Array");var i=d(e);return d(t).write(i.toString("hex"),r,n,"hex"),this.length instanceof g&&this.length.encode(n,t,r),n}}]),r}(p);t.Blob=W;var K=function(e){s(r,e);var t=u(r);function r(e){return c(this,r),t.call(this,-1,e)}return l(r,[{key:"getSpan",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;f(e);for(var r=t;r<e.length&&0!==e[r];)r+=1;return 1+r-t}},{key:"decode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=this.getSpan(e,t);return d(e).slice(t,t+r-1).toString("utf-8")}},{key:"encode",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;"string"!==typeof e&&(e=String(e));var n=h.Buffer.from(e,"utf8"),i=n.length;if(r+i>t.length)throw new RangeError("encoding overruns Buffer");var o=d(t);return n.copy(o,r),o[r+i]=0,i+1}}]),r}(p);t.CString=K;var G=function(e){s(r,e);var t=u(r);function r(e,n){var i;if(c(this,r),"string"===typeof e&&void 0===n&&(n=e,e=void 0),void 0===e)e=-1;else if(!Number.isInteger(e))throw new TypeError("maxSpan must be an integer");return(i=t.call(this,-1,n)).maxSpan=e,i}return l(r,[{key:"getSpan",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return f(e),e.length-t}},{key:"decode",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=this.getSpan(e,t);if(0<=this.maxSpan&&this.maxSpan<r)throw new RangeError("text length exceeds maxSpan");return d(e).slice(t,t+r).toString("utf-8")}},{key:"encode",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;"string"!==typeof e&&(e=String(e));var n=h.Buffer.from(e,"utf8"),i=n.length;if(0<=this.maxSpan&&this.maxSpan<i)throw new RangeError("text length exceeds maxSpan");if(r+i>t.length)throw new RangeError("encoding overruns Buffer");return n.copy(d(t),r),i}}]),r}(p);t.UTF8=G;var H=function(e){s(r,e);var t=u(r);function r(e,n){var i;return c(this,r),(i=t.call(this,0,n)).value=e,i}return l(r,[{key:"decode",value:function(e,t){return this.value}},{key:"encode",value:function(e,t,r){return 0}}]),r}(p);t.Constant=H,t.greedy=function(e,t){return new y(e,t)},t.offset=function(e,t,r){return new v(e,t,r)},t.u8=function(e){return new _(1,e)},t.u16=function(e){return new _(2,e)},t.u24=function(e){return new _(3,e)},t.u32=function(e){return new _(4,e)},t.u40=function(e){return new _(5,e)},t.u48=function(e){return new _(6,e)},t.nu64=function(e){return new S(e)},t.u16be=function(e){return new b(2,e)},t.u24be=function(e){return new b(3,e)},t.u32be=function(e){return new b(4,e)},t.u40be=function(e){return new b(5,e)},t.u48be=function(e){return new b(6,e)},t.nu64be=function(e){return new T(e)},t.s8=function(e){return new x(1,e)},t.s16=function(e){return new x(2,e)},t.s24=function(e){return new x(3,e)},t.s32=function(e){return new x(4,e)},t.s40=function(e){return new x(5,e)},t.s48=function(e){return new x(6,e)},t.ns64=function(e){return new M(e)},t.s16be=function(e){return new w(2,e)},t.s24be=function(e){return new w(3,e)},t.s32be=function(e){return new w(4,e)},t.s40be=function(e){return new w(5,e)},t.s48be=function(e){return new w(6,e)},t.ns64be=function(e){return new I(e)},t.f32=function(e){return new P(e)},t.f32be=function(e){return new C(e)},t.f64=function(e){return new B(e)},t.f64be=function(e){return new D(e)},t.struct=function(e,t,r){return new L(e,t,r)},t.bits=function(e,t,r){return new F(e,t,r)},t.seq=function(e,t,r){return new R(e,t,r)},t.union=function(e,t,r){return new N(e,t,r)},t.unionLayoutDiscriminator=function(e,t){return new z(e,t)},t.blob=function(e,t){return new W(e,t)},t.cstr=function(e){return new K(e)},t.utf8=function(e,t){return new G(e,t)},t.constant=function(e,t){return new H(e,t)}},3717:function(e,t,r){"use strict";r.r(t),r.d(t,{ASSOCIATED_TOKEN_PROGRAM_ID:function(){return it},AccountLayout:function(){return dt},MintLayout:function(){return ft},NATIVE_MINT:function(){return ht},TOKEN_PROGRAM_ID:function(){return nt},Token:function(){return mt},u64:function(){return ut}});for(var n=r(4165),i=r(5861),o=r(3433),a=r(1752),s=r(1120),u=r(7762),c=r(5671),l=r(3144),h=r(7326),f=r(136),d=r(9388),p=r(4942),m=r(518),g=r.n(m),y=r(6322),v={},_={byteLength:function(e){var t=S(e),r=t[0],n=t[1];return 3*(r+n)/4-n},toByteArray:function(e){var t,r,n=S(e),i=n[0],o=n[1],a=new w(function(e,t,r){return 3*(t+r)/4-r}(0,i,o)),s=0,u=o>0?i-4:i;for(r=0;r<u;r+=4)t=x[e.charCodeAt(r)]<<18|x[e.charCodeAt(r+1)]<<12|x[e.charCodeAt(r+2)]<<6|x[e.charCodeAt(r+3)],a[s++]=t>>16&255,a[s++]=t>>8&255,a[s++]=255&t;2===o&&(t=x[e.charCodeAt(r)]<<2|x[e.charCodeAt(r+1)]>>4,a[s++]=255&t);1===o&&(t=x[e.charCodeAt(r)]<<10|x[e.charCodeAt(r+1)]<<4|x[e.charCodeAt(r+2)]>>2,a[s++]=t>>8&255,a[s++]=255&t);return a},fromByteArray:function(e){for(var t,r=e.length,n=r%3,i=[],o=16383,a=0,s=r-n;a<s;a+=o)i.push(T(e,a,a+o>s?s:a+o));1===n?(t=e[r-1],i.push(b[t>>2]+b[t<<4&63]+"==")):2===n&&(t=(e[r-2]<<8)+e[r-1],i.push(b[t>>10]+b[t>>4&63]+b[t<<2&63]+"="));return i.join("")}},b=[],x=[],w="undefined"!==typeof Uint8Array?Uint8Array:Array,k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",A=0,E=k.length;A<E;++A)b[A]=k[A],x[k.charCodeAt(A)]=A;function S(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function T(e,t,r){for(var n,i,o=[],a=t;a<r;a+=3)n=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),o.push(b[(i=n)>>18&63]+b[i>>12&63]+b[i>>6&63]+b[63&i]);return o.join("")}x["-".charCodeAt(0)]=62,x["_".charCodeAt(0)]=63;var M={read:function(e,t,r,n,i){var o,a,s=8*i-n-1,u=(1<<s)-1,c=u>>1,l=-7,h=r?i-1:0,f=r?-1:1,d=e[t+h];for(h+=f,o=d&(1<<-l)-1,d>>=-l,l+=s;l>0;o=256*o+e[t+h],h+=f,l-=8);for(a=o&(1<<-l)-1,o>>=-l,l+=n;l>0;a=256*a+e[t+h],h+=f,l-=8);if(0===o)o=1-c;else{if(o===u)return a?NaN:1/0*(d?-1:1);a+=Math.pow(2,n),o-=c}return(d?-1:1)*a*Math.pow(2,o-n)},write:function(e,t,r,n,i,o){var a,s,u,c=8*o-i-1,l=(1<<c)-1,h=l>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=n?0:o-1,p=n?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=l):(a=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-a))<1&&(a--,u*=2),(t+=a+h>=1?f/u:f*Math.pow(2,1-h))*u>=2&&(a++,u/=2),a+h>=l?(s=0,a=l):a+h>=1?(s=(t*u-1)*Math.pow(2,i),a+=h):(s=t*Math.pow(2,h-1)*Math.pow(2,i),a=0));i>=8;e[r+d]=255&s,d+=p,s/=256,i-=8);for(a=a<<i|s,c+=i;c>0;e[r+d]=255&a,d+=p,a/=256,c-=8);e[r+d-p]|=128*m}};!function(e){var t=_,r=M,n="function"===typeof Symbol&&"function"===typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=a,e.SlowBuffer=function(e){+e!=e&&(e=0);return a.alloc(+e)},e.INSPECT_MAX_BYTES=50;var i=2147483647;function o(e){if(e>i)throw new RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return Object.setPrototypeOf(t,a.prototype),t}function a(e,t,r){if("number"===typeof e){if("string"===typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return p(e)}return s(e,t,r)}function s(e,t,r){if("string"===typeof e)return function(e,t){"string"===typeof t&&""!==t||(t="utf8");if(!a.isEncoding(t))throw new TypeError("Unknown encoding: "+t);var r=0|v(e,t),n=o(r),i=n.write(e,t);i!==r&&(n=n.slice(0,i));return n}(e,t);if(ArrayBuffer.isView(e))return function(e){if(ee(e,Uint8Array)){var t=new Uint8Array(e);return g(t.buffer,t.byteOffset,t.byteLength)}return m(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(ee(e,ArrayBuffer)||e&&ee(e.buffer,ArrayBuffer))return g(e,t,r);if("undefined"!==typeof SharedArrayBuffer&&(ee(e,SharedArrayBuffer)||e&&ee(e.buffer,SharedArrayBuffer)))return g(e,t,r);if("number"===typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return a.from(n,t,r);var i=function(e){if(a.isBuffer(e)){var t=0|y(e.length),r=o(t);return 0===r.length||e.copy(r,0,0,t),r}if(void 0!==e.length)return"number"!==typeof e.length||te(e.length)?o(0):m(e);if("Buffer"===e.type&&Array.isArray(e.data))return m(e.data)}(e);if(i)return i;if("undefined"!==typeof Symbol&&null!=Symbol.toPrimitive&&"function"===typeof e[Symbol.toPrimitive])return a.from(e[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function u(e){if("number"!==typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function p(e){return u(e),o(e<0?0:0|y(e))}function m(e){for(var t=e.length<0?0:0|y(e.length),r=o(t),n=0;n<t;n+=1)r[n]=255&e[n];return r}function g(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');var n;return n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),Object.setPrototypeOf(n,a.prototype),n}function y(e){if(e>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return 0|e}function v(e,t){if(a.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||ee(e,ArrayBuffer))return e.byteLength;if("string"!==typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var r=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return Q(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return $(e).length;default:if(i)return n?-1:Q(e).length;t=(""+t).toLowerCase(),i=!0}}function b(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return L(this,t,r);case"utf8":case"utf-8":return C(this,t,r);case"ascii":return D(this,t,r);case"latin1":case"binary":return R(this,t,r);case"base64":return P(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function x(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function w(e,t,r,n,i){if(0===e.length)return-1;if("string"===typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),te(r=+r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"===typeof t&&(t=a.from(t,n)),a.isBuffer(t))return 0===t.length?-1:k(e,t,r,n,i);if("number"===typeof t)return t&=255,"function"===typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):k(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function k(e,t,r,n,i){var o,a=1,s=e.length,u=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;a=2,s/=2,u/=2,r/=2}function c(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(i){var l=-1;for(o=r;o<s;o++)if(c(e,o)===c(t,-1===l?0:o-l)){if(-1===l&&(l=o),o-l+1===u)return l*a}else-1!==l&&(o-=o-l),l=-1}else for(r+u>s&&(r=s-u),o=r;o>=0;o--){for(var h=!0,f=0;f<u;f++)if(c(e,o+f)!==c(t,f)){h=!1;break}if(h)return o}return-1}function A(e,t,r,n){r=Number(r)||0;var i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;var o,a=t.length;for(n>a/2&&(n=a/2),o=0;o<n;++o){var s=parseInt(t.substr(2*o,2),16);if(te(s))return o;e[r+o]=s}return o}function E(e,t,r,n){return J(Q(t,e.length-r),e,r,n)}function S(e,t,r,n){return J(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function T(e,t,r,n){return J($(t),e,r,n)}function I(e,t,r,n){return J(function(e,t){for(var r,n,i,o=[],a=0;a<e.length&&!((t-=2)<0);++a)n=(r=e.charCodeAt(a))>>8,i=r%256,o.push(i),o.push(n);return o}(t,e.length-r),e,r,n)}function P(e,r,n){return 0===r&&n===e.length?t.fromByteArray(e):t.fromByteArray(e.slice(r,n))}function C(e,t,r){r=Math.min(e.length,r);for(var n=[],i=t;i<r;){var o=e[i],a=null,s=o>239?4:o>223?3:o>191?2:1;if(i+s<=r){var u=void 0,c=void 0,l=void 0,h=void 0;switch(s){case 1:o<128&&(a=o);break;case 2:128===(192&(u=e[i+1]))&&(h=(31&o)<<6|63&u)>127&&(a=h);break;case 3:u=e[i+1],c=e[i+2],128===(192&u)&&128===(192&c)&&(h=(15&o)<<12|(63&u)<<6|63&c)>2047&&(h<55296||h>57343)&&(a=h);break;case 4:u=e[i+1],c=e[i+2],l=e[i+3],128===(192&u)&&128===(192&c)&&128===(192&l)&&(h=(15&o)<<18|(63&u)<<12|(63&c)<<6|63&l)>65535&&h<1114112&&(a=h)}}null===a?(a=65533,s=1):a>65535&&(a-=65536,n.push(a>>>10&1023|55296),a=56320|1023&a),n.push(a),i+=s}return function(e){var t=e.length;if(t<=B)return String.fromCharCode.apply(String,e);var r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=B));return r}(n)}e.kMaxLength=i,a.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(r){return!1}}(),a.TYPED_ARRAY_SUPPORT||"undefined"===typeof console||"function"!==typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}}),a.poolSize=8192,a.from=function(e,t,r){return s(e,t,r)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array),a.alloc=function(e,t,r){return function(e,t,r){return u(e),e<=0?o(e):void 0!==t?"string"===typeof r?o(e).fill(t,r):o(e).fill(t):o(e)}(e,t,r)},a.allocUnsafe=function(e){return p(e)},a.allocUnsafeSlow=function(e){return p(e)},a.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==a.prototype},a.compare=function(e,t){if(ee(e,Uint8Array)&&(e=a.from(e,e.offset,e.byteLength)),ee(t,Uint8Array)&&(t=a.from(t,t.offset,t.byteLength)),!a.isBuffer(e)||!a.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var r=e.length,n=t.length,i=0,o=Math.min(r,n);i<o;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},a.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return a.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=a.allocUnsafe(t),i=0;for(r=0;r<e.length;++r){var o=e[r];if(ee(o,Uint8Array))i+o.length>n.length?(a.isBuffer(o)||(o=a.from(o)),o.copy(n,i)):Uint8Array.prototype.set.call(n,o,i);else{if(!a.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(n,i)}i+=o.length}return n},a.byteLength=v,a.prototype._isBuffer=!0,a.prototype.swap16=function(){var e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)x(this,t,t+1);return this},a.prototype.swap32=function(){var e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)x(this,t,t+3),x(this,t+1,t+2);return this},a.prototype.swap64=function(){var e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)x(this,t,t+7),x(this,t+1,t+6),x(this,t+2,t+5),x(this,t+3,t+4);return this},a.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?C(this,0,e):b.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(e){if(!a.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===a.compare(this,e)},a.prototype.inspect=function(){var t="",r=e.INSPECT_MAX_BYTES;return t=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(t+=" ... "),"<Buffer "+t+">"},n&&(a.prototype[n]=a.prototype.inspect),a.prototype.compare=function(e,t,r,n,i){if(ee(e,Uint8Array)&&(e=a.from(e,e.offset,e.byteLength)),!a.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(this===e)return 0;for(var o=(i>>>=0)-(n>>>=0),s=(r>>>=0)-(t>>>=0),u=Math.min(o,s),c=this.slice(n,i),l=e.slice(t,r),h=0;h<u;++h)if(c[h]!==l[h]){o=c[h],s=l[h];break}return o<s?-1:s<o?1:0},a.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},a.prototype.indexOf=function(e,t,r){return w(this,e,t,r,!0)},a.prototype.lastIndexOf=function(e,t,r){return w(this,e,t,r,!1)},a.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"===typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return A(this,e,t,r);case"utf8":case"utf-8":return E(this,e,t,r);case"ascii":case"latin1":case"binary":return S(this,e,t,r);case"base64":return T(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,e,t,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var B=4096;function D(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function R(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function L(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var i="",o=t;o<r;++o)i+=re[e[o]];return i}function O(e,t,r){for(var n=e.slice(t,r),i="",o=0;o<n.length-1;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function z(e,t,r){if(e%1!==0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function N(e,t,r,n,i,o){if(!a.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function U(e,t,r,n,i){H(t,n,i,e,r,7);var o=Number(t&BigInt(4294967295));e[r++]=o,o>>=8,e[r++]=o,o>>=8,e[r++]=o,o>>=8,e[r++]=o;var a=Number(t>>BigInt(32)&BigInt(4294967295));return e[r++]=a,a>>=8,e[r++]=a,a>>=8,e[r++]=a,a>>=8,e[r++]=a,r}function Z(e,t,r,n,i){H(t,n,i,e,r,7);var o=Number(t&BigInt(4294967295));e[r+7]=o,o>>=8,e[r+6]=o,o>>=8,e[r+5]=o,o>>=8,e[r+4]=o;var a=Number(t>>BigInt(32)&BigInt(4294967295));return e[r+3]=a,a>>=8,e[r+2]=a,a>>=8,e[r+1]=a,a>>=8,e[r]=a,r+8}function F(e,t,r,n,i,o){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function j(e,t,n,i,o){return t=+t,n>>>=0,o||F(e,0,n,4),r.write(e,t,n,i,23,4),n+4}function V(e,t,n,i,o){return t=+t,n>>>=0,o||F(e,0,n,8),r.write(e,t,n,i,52,8),n+8}a.prototype.slice=function(e,t){var r=this.length;(e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);var n=this.subarray(e,t);return Object.setPrototypeOf(n,a.prototype),n},a.prototype.readUintLE=a.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||z(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n},a.prototype.readUintBE=a.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||z(e,t,this.length);for(var n=this[e+--t],i=1;t>0&&(i*=256);)n+=this[e+--t]*i;return n},a.prototype.readUint8=a.prototype.readUInt8=function(e,t){return e>>>=0,t||z(e,1,this.length),this[e]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(e,t){return e>>>=0,t||z(e,2,this.length),this[e]|this[e+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(e,t){return e>>>=0,t||z(e,2,this.length),this[e]<<8|this[e+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(e,t){return e>>>=0,t||z(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(e,t){return e>>>=0,t||z(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},a.prototype.readBigUInt64LE=ne((function(e){q(e>>>=0,"offset");var t=this[e],r=this[e+7];void 0!==t&&void 0!==r||Y(e,this.length-8);var n=t+this[++e]*Math.pow(2,8)+this[++e]*Math.pow(2,16)+this[++e]*Math.pow(2,24),i=this[++e]+this[++e]*Math.pow(2,8)+this[++e]*Math.pow(2,16)+r*Math.pow(2,24);return BigInt(n)+(BigInt(i)<<BigInt(32))})),a.prototype.readBigUInt64BE=ne((function(e){q(e>>>=0,"offset");var t=this[e],r=this[e+7];void 0!==t&&void 0!==r||Y(e,this.length-8);var n=t*Math.pow(2,24)+this[++e]*Math.pow(2,16)+this[++e]*Math.pow(2,8)+this[++e],i=this[++e]*Math.pow(2,24)+this[++e]*Math.pow(2,16)+this[++e]*Math.pow(2,8)+r;return(BigInt(n)<<BigInt(32))+BigInt(i)})),a.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||z(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*t)),n},a.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||z(e,t,this.length);for(var n=t,i=1,o=this[e+--n];n>0&&(i*=256);)o+=this[e+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},a.prototype.readInt8=function(e,t){return e>>>=0,t||z(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},a.prototype.readInt16LE=function(e,t){e>>>=0,t||z(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},a.prototype.readInt16BE=function(e,t){e>>>=0,t||z(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},a.prototype.readInt32LE=function(e,t){return e>>>=0,t||z(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},a.prototype.readInt32BE=function(e,t){return e>>>=0,t||z(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},a.prototype.readBigInt64LE=ne((function(e){q(e>>>=0,"offset");var t=this[e],r=this[e+7];void 0!==t&&void 0!==r||Y(e,this.length-8);var n=this[e+4]+this[e+5]*Math.pow(2,8)+this[e+6]*Math.pow(2,16)+(r<<24);return(BigInt(n)<<BigInt(32))+BigInt(t+this[++e]*Math.pow(2,8)+this[++e]*Math.pow(2,16)+this[++e]*Math.pow(2,24))})),a.prototype.readBigInt64BE=ne((function(e){q(e>>>=0,"offset");var t=this[e],r=this[e+7];void 0!==t&&void 0!==r||Y(e,this.length-8);var n=(t<<24)+this[++e]*Math.pow(2,16)+this[++e]*Math.pow(2,8)+this[++e];return(BigInt(n)<<BigInt(32))+BigInt(this[++e]*Math.pow(2,24)+this[++e]*Math.pow(2,16)+this[++e]*Math.pow(2,8)+r)})),a.prototype.readFloatLE=function(e,t){return e>>>=0,t||z(e,4,this.length),r.read(this,e,!0,23,4)},a.prototype.readFloatBE=function(e,t){return e>>>=0,t||z(e,4,this.length),r.read(this,e,!1,23,4)},a.prototype.readDoubleLE=function(e,t){return e>>>=0,t||z(e,8,this.length),r.read(this,e,!0,52,8)},a.prototype.readDoubleBE=function(e,t){return e>>>=0,t||z(e,8,this.length),r.read(this,e,!1,52,8)},a.prototype.writeUintLE=a.prototype.writeUIntLE=function(e,t,r,n){(e=+e,t>>>=0,r>>>=0,n)||N(this,e,t,r,Math.pow(2,8*r)-1,0);var i=1,o=0;for(this[t]=255&e;++o<r&&(i*=256);)this[t+o]=e/i&255;return t+r},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(e,t,r,n){(e=+e,t>>>=0,r>>>=0,n)||N(this,e,t,r,Math.pow(2,8*r)-1,0);var i=r-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+r},a.prototype.writeUint8=a.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,1,255,0),this[t]=255&e,t+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},a.prototype.writeBigUInt64LE=ne((function(e){return U(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,BigInt(0),BigInt("0xffffffffffffffff"))})),a.prototype.writeBigUInt64BE=ne((function(e){return Z(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,BigInt(0),BigInt("0xffffffffffffffff"))})),a.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var i=Math.pow(2,8*r-1);N(this,e,t,r,i-1,-i)}var o=0,a=1,s=0;for(this[t]=255&e;++o<r&&(a*=256);)e<0&&0===s&&0!==this[t+o-1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+r},a.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var i=Math.pow(2,8*r-1);N(this,e,t,r,i-1,-i)}var o=r-1,a=1,s=0;for(this[t+o]=255&e;--o>=0&&(a*=256);)e<0&&0===s&&0!==this[t+o+1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+r},a.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},a.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},a.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},a.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},a.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},a.prototype.writeBigInt64LE=ne((function(e){return U(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),a.prototype.writeBigInt64BE=ne((function(e){return Z(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),a.prototype.writeFloatLE=function(e,t,r){return j(this,e,t,!0,r)},a.prototype.writeFloatBE=function(e,t,r){return j(this,e,t,!1,r)},a.prototype.writeDoubleLE=function(e,t,r){return V(this,e,t,!0,r)},a.prototype.writeDoubleBE=function(e,t,r){return V(this,e,t,!1,r)},a.prototype.copy=function(e,t,r,n){if(!a.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var i=n-r;return this===e&&"function"===typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,r,n):Uint8Array.prototype.set.call(e,this.subarray(r,n),t),i},a.prototype.fill=function(e,t,r,n){if("string"===typeof e){if("string"===typeof t?(n=t,t=0,r=this.length):"string"===typeof r&&(n=r,r=this.length),void 0!==n&&"string"!==typeof n)throw new TypeError("encoding must be a string");if("string"===typeof n&&!a.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===e.length){var i=e.charCodeAt(0);("utf8"===n&&i<128||"latin1"===n)&&(e=i)}}else"number"===typeof e?e&=255:"boolean"===typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var o;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"===typeof e)for(o=t;o<r;++o)this[o]=e;else{var s=a.isBuffer(e)?e:a.from(e,n),u=s.length;if(0===u)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(o=0;o<r-t;++o)this[o+t]=s[o%u]}return this};var W={};function K(e,t,r){W[e]=function(r){(0,f.Z)(i,r);var n=(0,d.Z)(i);function i(){var r;return(0,c.Z)(this,i),r=n.call(this),Object.defineProperty((0,h.Z)(r),"message",{value:t.apply((0,h.Z)(r),arguments),writable:!0,configurable:!0}),r.name="".concat(r.name," [").concat(e,"]"),r.stack,delete r.name,r}return(0,l.Z)(i,[{key:"code",get:function(){return e},set:function(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}},{key:"toString",value:function(){return"".concat(this.name," [").concat(e,"]: ").concat(this.message)}}]),i}(r)}function G(e){for(var t="",r=e.length,n="-"===e[0]?1:0;r>=n+4;r-=3)t="_".concat(e.slice(r-3,r)).concat(t);return"".concat(e.slice(0,r)).concat(t)}function H(e,t,r,n,i,o){if(e>r||e<t){var a,s="bigint"===typeof t?"n":"";throw a=o>3?0===t||t===BigInt(0)?">= 0".concat(s," and < 2").concat(s," ** ").concat(8*(o+1)).concat(s):">= -(2".concat(s," ** ").concat(8*(o+1)-1).concat(s,") and < 2 ** ")+"".concat(8*(o+1)-1).concat(s):">= ".concat(t).concat(s," and <= ").concat(r).concat(s),new W.ERR_OUT_OF_RANGE("value",a,e)}!function(e,t,r){q(t,"offset"),void 0!==e[t]&&void 0!==e[t+r]||Y(t,e.length-(r+1))}(n,i,o)}function q(e,t){if("number"!==typeof e)throw new W.ERR_INVALID_ARG_TYPE(t,"number",e)}function Y(e,t,r){if(Math.floor(e)!==e)throw q(e,r),new W.ERR_OUT_OF_RANGE(r||"offset","an integer",e);if(t<0)throw new W.ERR_BUFFER_OUT_OF_BOUNDS;throw new W.ERR_OUT_OF_RANGE(r||"offset",">= ".concat(r?1:0," and <= ").concat(t),e)}K("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?"".concat(e," is outside of buffer bounds"):"Attempt to access memory outside buffer bounds"}),RangeError),K("ERR_INVALID_ARG_TYPE",(function(e,t){return'The "'.concat(e,'" argument must be of type number. Received type ').concat(typeof t)}),TypeError),K("ERR_OUT_OF_RANGE",(function(e,t,r){var n='The value of "'.concat(e,'" is out of range.'),i=r;return Number.isInteger(r)&&Math.abs(r)>Math.pow(2,32)?i=G(String(r)):"bigint"===typeof r&&(i=String(r),(r>Math.pow(BigInt(2),BigInt(32))||r<-Math.pow(BigInt(2),BigInt(32)))&&(i=G(i)),i+="n"),n+=" It must be ".concat(t,". Received ").concat(i)}),RangeError);var X=/[^+/0-9A-Za-z-_]/g;function Q(e,t){var r;t=t||1/0;for(var n=e.length,i=null,o=[],a=0;a<n;++a){if((r=e.charCodeAt(a))>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===n){(t-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function $(e){return t.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(X,"")).length<2)return"";for(;e.length%4!==0;)e+="=";return e}(e))}function J(e,t,r,n){var i;for(i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function ee(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function te(e){return e!==e}var re=function(){for(var e="0123456789abcdef",t=new Array(256),r=0;r<16;++r)for(var n=16*r,i=0;i<16;++i)t[n+i]=e[r]+e[i];return t}();function ne(e){return"undefined"===typeof BigInt?ie:e}function ie(){throw new Error("BigInt not supported")}}(v);var I="undefined"!==typeof r.g?r.g:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{},P="function"===typeof Object.create?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e};function C(e,t){var r={seen:[],stylize:D};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),z(t)?r.showHidden=t:t&&function(e,t){if(!t||!j(t))return e;var r=Object.keys(t),n=r.length;for(;n--;)e[r[n]]=t[r[n]]}(r,t),Z(r.showHidden)&&(r.showHidden=!1),Z(r.depth)&&(r.depth=2),Z(r.colors)&&(r.colors=!1),Z(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=B),R(r,e,r.depth)}function B(e,t){var r=C.styles[t];return r?"\x1b["+C.colors[r][0]+"m"+e+"\x1b["+C.colors[r][1]+"m":e}function D(e,t){return e}function R(e,t,r){if(e.customInspect&&t&&K(t.inspect)&&t.inspect!==C&&(!t.constructor||t.constructor.prototype!==t)){var n=t.inspect(r,e);return U(n)||(n=R(e,n,r)),n}var i=function(e,t){if(Z(t))return e.stylize("undefined","undefined");if(U(t)){var r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string")}if(n=t,"number"===typeof n)return e.stylize(""+t,"number");var n;if(z(t))return e.stylize(""+t,"boolean");if(N(t))return e.stylize("null","null")}(e,t);if(i)return i;var o=Object.keys(t),a=function(e){var t={};return e.forEach((function(e,r){t[e]=!0})),t}(o);if(e.showHidden&&(o=Object.getOwnPropertyNames(t)),W(t)&&(o.indexOf("message")>=0||o.indexOf("description")>=0))return L(t);if(0===o.length){if(K(t)){var s=t.name?": "+t.name:"";return e.stylize("[Function"+s+"]","special")}if(F(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(V(t))return e.stylize(Date.prototype.toString.call(t),"date");if(W(t))return L(t)}var u,c,l="",h=!1,f=["{","}"];(u=t,Array.isArray(u)&&(h=!0,f=["[","]"]),K(t))&&(l=" [Function"+(t.name?": "+t.name:"")+"]");return F(t)&&(l=" "+RegExp.prototype.toString.call(t)),V(t)&&(l=" "+Date.prototype.toUTCString.call(t)),W(t)&&(l=" "+L(t)),0!==o.length||h&&0!=t.length?r<0?F(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special"):(e.seen.push(t),c=h?function(e,t,r,n,i){for(var o=[],a=0,s=t.length;a<s;++a)q(t,String(a))?o.push(O(e,t,r,n,String(a),!0)):o.push("");return i.forEach((function(i){i.match(/^\d+$/)||o.push(O(e,t,r,n,i,!0))})),o}(e,t,r,a,o):o.map((function(n){return O(e,t,r,a,n,h)})),e.seen.pop(),function(e,t,r){var n=e.reduce((function(e,t){return t.indexOf("\n"),e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0);if(n>60)return r[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+r[1];return r[0]+t+" "+e.join(", ")+" "+r[1]}(c,l,f)):f[0]+l+f[1]}function L(e){return"["+Error.prototype.toString.call(e)+"]"}function O(e,t,r,n,i,o){var a,s,u;if((u=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]}).get?s=u.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):u.set&&(s=e.stylize("[Setter]","special")),q(n,i)||(a="["+i+"]"),s||(e.seen.indexOf(u.value)<0?(s=N(r)?R(e,u.value,null):R(e,u.value,r-1)).indexOf("\n")>-1&&(s=o?s.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+s.split("\n").map((function(e){return"   "+e})).join("\n")):s=e.stylize("[Circular]","special")),Z(a)){if(o&&i.match(/^\d+$/))return s;(a=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+s}function z(e){return"boolean"===typeof e}function N(e){return null===e}function U(e){return"string"===typeof e}function Z(e){return void 0===e}function F(e){return j(e)&&"[object RegExp]"===H(e)}function j(e){return"object"===typeof e&&null!==e}function V(e){return j(e)&&"[object Date]"===H(e)}function W(e){return j(e)&&("[object Error]"===H(e)||e instanceof Error)}function K(e){return"function"===typeof e}function G(e){return null===e||"boolean"===typeof e||"number"===typeof e||"string"===typeof e||"symbol"===typeof e||"undefined"===typeof e}function H(e){return Object.prototype.toString.call(e)}function q(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function Y(e,t){if(e===t)return 0;for(var r=e.length,n=t.length,i=0,o=Math.min(r,n);i<o;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0}C.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},C.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};var X,Q=Object.prototype.hasOwnProperty,$=Object.keys||function(e){var t=[];for(var r in e)Q.call(e,r)&&t.push(r);return t},J=Array.prototype.slice;function ee(){return"undefined"!==typeof X?X:X="foo"===function(){}.name}function te(e){return Object.prototype.toString.call(e)}function re(e){return!v.isBuffer(e)&&("function"===typeof I.ArrayBuffer&&("function"===typeof ArrayBuffer.isView?ArrayBuffer.isView(e):!!e&&(e instanceof DataView||!!(e.buffer&&e.buffer instanceof ArrayBuffer))))}function ne(e,t){e||ce(e,!0,t,"==",le)}var ie=/\s*function\s+([^\(\s]*)\s*/;function oe(e){if(K(e)){if(ee())return e.name;var t=e.toString().match(ie);return t&&t[1]}}function ae(e){this.name="AssertionError",this.actual=e.actual,this.expected=e.expected,this.operator=e.operator,e.message?(this.message=e.message,this.generatedMessage=!1):(this.message=function(e){return se(ue(e.actual),128)+" "+e.operator+" "+se(ue(e.expected),128)}(this),this.generatedMessage=!0);var t=e.stackStartFunction||ce;if(Error.captureStackTrace)Error.captureStackTrace(this,t);else{var r=new Error;if(r.stack){var n=r.stack,i=oe(t),o=n.indexOf("\n"+i);if(o>=0){var a=n.indexOf("\n",o+1);n=n.substring(a+1)}this.stack=n}}}function se(e,t){return"string"===typeof e?e.length<t?e:e.slice(0,t):e}function ue(e){if(ee()||!K(e))return C(e);var t=oe(e);return"[Function"+(t?": "+t:"")+"]"}function ce(e,t,r,n,i){throw new ae({message:r,actual:e,expected:t,operator:n,stackStartFunction:i})}function le(e,t){e||ce(e,!0,t,"==",le)}function he(e,t,r,n){if(e===t)return!0;if(v.isBuffer(e)&&v.isBuffer(t))return 0===Y(e,t);if(V(e)&&V(t))return e.getTime()===t.getTime();if(F(e)&&F(t))return e.source===t.source&&e.global===t.global&&e.multiline===t.multiline&&e.lastIndex===t.lastIndex&&e.ignoreCase===t.ignoreCase;if(null!==e&&"object"===typeof e||null!==t&&"object"===typeof t){if(re(e)&&re(t)&&te(e)===te(t)&&!(e instanceof Float32Array||e instanceof Float64Array))return 0===Y(new Uint8Array(e.buffer),new Uint8Array(t.buffer));if(v.isBuffer(e)!==v.isBuffer(t))return!1;var i=(n=n||{actual:[],expected:[]}).actual.indexOf(e);return-1!==i&&i===n.expected.indexOf(t)||(n.actual.push(e),n.expected.push(t),function(e,t,r,n){if(null===e||void 0===e||null===t||void 0===t)return!1;if(G(e)||G(t))return e===t;if(r&&Object.getPrototypeOf(e)!==Object.getPrototypeOf(t))return!1;var i=fe(e),o=fe(t);if(i&&!o||!i&&o)return!1;if(i)return he(e=J.call(e),t=J.call(t),r);var a,s,u=$(e),c=$(t);if(u.length!==c.length)return!1;for(u.sort(),c.sort(),s=u.length-1;s>=0;s--)if(u[s]!==c[s])return!1;for(s=u.length-1;s>=0;s--)if(!he(e[a=u[s]],t[a],r,n))return!1;return!0}(e,t,r,n))}return r?e===t:e==t}function fe(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function de(e,t){if(!e||!t)return!1;if("[object RegExp]"==Object.prototype.toString.call(t))return t.test(e);try{if(e instanceof t)return!0}catch(r){}return!Error.isPrototypeOf(t)&&!0===t.call({},e)}function pe(e,t,r,n){var i;if("function"!==typeof t)throw new TypeError('"block" argument must be a function');"string"===typeof r&&(n=r,r=null),i=function(e){var t;try{e()}catch(r){t=r}return t}(t),n=(r&&r.name?" ("+r.name+").":".")+(n?" "+n:"."),e&&!i&&ce(i,r,"Missing expected exception"+n);var o="string"===typeof n,a=!e&&i&&!r;if((!e&&W(i)&&o&&de(i,r)||a)&&ce(i,r,"Got unwanted exception"+n),e&&i&&r&&!de(i,r)||!e&&i)throw i}ne.AssertionError=ae,P(ae,Error),ne.fail=ce,ne.ok=le,ne.equal=function e(t,r,n){t!=r&&ce(t,r,n,"==",e)},ne.notEqual=function e(t,r,n){t==r&&ce(t,r,n,"!=",e)},ne.deepEqual=function e(t,r,n){he(t,r,!1)||ce(t,r,n,"deepEqual",e)},ne.deepStrictEqual=function e(t,r,n){he(t,r,!0)||ce(t,r,n,"deepStrictEqual",e)},ne.notDeepEqual=function e(t,r,n){he(t,r,!1)&&ce(t,r,n,"notDeepEqual",e)},ne.notDeepStrictEqual=function e(t,r,n){he(t,r,!0)&&ce(t,r,n,"notDeepStrictEqual",e)},ne.strictEqual=function e(t,r,n){t!==r&&ce(t,r,n,"===",e)},ne.notStrictEqual=function e(t,r,n){t===r&&ce(t,r,n,"!==",e)},ne.throws=function(e,t,r){pe(!0,e,t,r)},ne.doesNotThrow=function(e,t,r){pe(!1,e,t,r)},ne.ifError=function(e){if(e)throw e};var me={},ge=function(){function e(t,r){if((0,c.Z)(this,e),!Number.isInteger(t))throw new TypeError("span must be an integer");this.span=t,this.property=r}return(0,l.Z)(e,[{key:"makeDestinationObject",value:function(){return{}}},{key:"decode",value:function(e,t){throw new Error("Layout is abstract")}},{key:"encode",value:function(e,t,r){throw new Error("Layout is abstract")}},{key:"getSpan",value:function(e,t){if(0>this.span)throw new RangeError("indeterminate span");return this.span}},{key:"replicate",value:function(e){var t=Object.create(this.constructor.prototype);return Object.assign(t,this),t.property=e,t}},{key:"fromArray",value:function(e){}}]),e}();function ye(e,t){return t.property?e+"["+t.property+"]":e}me.Layout=ge,me.nameWithProperty=ye,me.bindConstructorLayout=function(e,t){if("function"!==typeof e)throw new TypeError("Class must be constructor");if(e.hasOwnProperty("layout_"))throw new Error("Class is already bound to a layout");if(!(t&&t instanceof ge))throw new TypeError("layout must be a Layout");if(t.hasOwnProperty("boundConstructor_"))throw new Error("layout is already bound to a constructor");e.layout_=t,t.boundConstructor_=e,t.makeDestinationObject=function(){return new e},Object.defineProperty(e.prototype,"encode",{value:function(e,r){return t.encode(this,e,r)},writable:!0}),Object.defineProperty(e,"decode",{value:function(e,r){return t.decode(e,r)},writable:!0})};var ve=function(e){(0,f.Z)(r,e);var t=(0,d.Z)(r);function r(){return(0,c.Z)(this,r),t.apply(this,arguments)}return(0,l.Z)(r,[{key:"isCount",value:function(){throw new Error("ExternalLayout is abstract")}}]),r}(ge),_e=function(e){(0,f.Z)(r,e);var t=(0,d.Z)(r);function r(e,n){var i;if((0,c.Z)(this,r),void 0===e&&(e=1),!Number.isInteger(e)||0>=e)throw new TypeError("elementSpan must be a (positive) integer");return(i=t.call(this,-1,n)).elementSpan=e,i}return(0,l.Z)(r,[{key:"isCount",value:function(){return!0}},{key:"decode",value:function(e,t){void 0===t&&(t=0);var r=e.length-t;return Math.floor(r/this.elementSpan)}},{key:"encode",value:function(e,t,r){return 0}}]),r}(ve),be=function(e){(0,f.Z)(r,e);var t=(0,d.Z)(r);function r(e,n,i){var o;if((0,c.Z)(this,r),!(e instanceof ge))throw new TypeError("layout must be a Layout");if(void 0===n)n=0;else if(!Number.isInteger(n))throw new TypeError("offset must be integer or undefined");return(o=t.call(this,e.span,i||e.property)).layout=e,o.offset=n,o}return(0,l.Z)(r,[{key:"isCount",value:function(){return this.layout instanceof xe||this.layout instanceof we}},{key:"decode",value:function(e,t){return void 0===t&&(t=0),this.layout.decode(e,t+this.offset)}},{key:"encode",value:function(e,t,r){return void 0===r&&(r=0),this.layout.encode(e,t,r+this.offset)}}]),r}(ve),xe=function(e){(0,f.Z)(r,e);var t=(0,d.Z)(r);function r(e,n){var i;if((0,c.Z)(this,r),6<(i=t.call(this,e,n)).span)throw new RangeError("span must not exceed 6 bytes");return i}return(0,l.Z)(r,[{key:"decode",value:function(e,t){return void 0===t&&(t=0),e.readUIntLE(t,this.span)}},{key:"encode",value:function(e,t,r){return void 0===r&&(r=0),t.writeUIntLE(e,r,this.span),this.span}}]),r}(ge),we=function(e){(0,f.Z)(r,e);var t=(0,d.Z)(r);function r(e,n){var i;if((0,c.Z)(this,r),6<(i=t.call(this,e,n)).span)throw new RangeError("span must not exceed 6 bytes");return i}return(0,l.Z)(r,[{key:"decode",value:function(e,t){return void 0===t&&(t=0),e.readUIntBE(t,this.span)}},{key:"encode",value:function(e,t,r){return void 0===r&&(r=0),t.writeUIntBE(e,r,this.span),this.span}}]),r}(ge),ke=function(e){(0,f.Z)(r,e);var t=(0,d.Z)(r);function r(e,n){var i;if((0,c.Z)(this,r),6<(i=t.call(this,e,n)).span)throw new RangeError("span must not exceed 6 bytes");return i}return(0,l.Z)(r,[{key:"decode",value:function(e,t){return void 0===t&&(t=0),e.readIntLE(t,this.span)}},{key:"encode",value:function(e,t,r){return void 0===r&&(r=0),t.writeIntLE(e,r,this.span),this.span}}]),r}(ge),Ae=function(e){(0,f.Z)(r,e);var t=(0,d.Z)(r);function r(e,n){var i;if((0,c.Z)(this,r),6<(i=t.call(this,e,n)).span)throw new RangeError("span must not exceed 6 bytes");return i}return(0,l.Z)(r,[{key:"decode",value:function(e,t){return void 0===t&&(t=0),e.readIntBE(t,this.span)}},{key:"encode",value:function(e,t,r){return void 0===r&&(r=0),t.writeIntBE(e,r,this.span),this.span}}]),r}(ge),Ee=Math.pow(2,32);function Se(e){var t=Math.floor(e/Ee);return{hi32:t,lo32:e-t*Ee}}function Te(e,t){return e*Ee+t}var Me=function(e){(0,f.Z)(r,e);var t=(0,d.Z)(r);function r(e){return(0,c.Z)(this,r),t.call(this,8,e)}return(0,l.Z)(r,[{key:"decode",value:function(e,t){void 0===t&&(t=0);var r=e.readUInt32LE(t);return Te(e.readUInt32LE(t+4),r)}},{key:"encode",value:function(e,t,r){void 0===r&&(r=0);var n=Se(e);return t.writeUInt32LE(n.lo32,r),t.writeUInt32LE(n.hi32,r+4),8}}]),r}(ge),Ie=function(e){(0,f.Z)(r,e);var t=(0,d.Z)(r);function r(e){return(0,c.Z)(this,r),t.call(this,8,e)}return(0,l.Z)(r,[{key:"decode",value:function(e,t){return void 0===t&&(t=0),Te(e.readUInt32BE(t),e.readUInt32BE(t+4))}},{key:"encode",value:function(e,t,r){void 0===r&&(r=0);var n=Se(e);return t.writeUInt32BE(n.hi32,r),t.writeUInt32BE(n.lo32,r+4),8}}]),r}(ge),Pe=function(e){(0,f.Z)(r,e);var t=(0,d.Z)(r);function r(e){return(0,c.Z)(this,r),t.call(this,8,e)}return(0,l.Z)(r,[{key:"decode",value:function(e,t){void 0===t&&(t=0);var r=e.readUInt32LE(t);return Te(e.readInt32LE(t+4),r)}},{key:"encode",value:function(e,t,r){void 0===r&&(r=0);var n=Se(e);return t.writeUInt32LE(n.lo32,r),t.writeInt32LE(n.hi32,r+4),8}}]),r}(ge),Ce=function(e){(0,f.Z)(r,e);var t=(0,d.Z)(r);function r(e){return(0,c.Z)(this,r),t.call(this,8,e)}return(0,l.Z)(r,[{key:"decode",value:function(e,t){return void 0===t&&(t=0),Te(e.readInt32BE(t),e.readUInt32BE(t+4))}},{key:"encode",value:function(e,t,r){void 0===r&&(r=0);var n=Se(e);return t.writeInt32BE(n.hi32,r),t.writeUInt32BE(n.lo32,r+4),8}}]),r}(ge),Be=function(e){(0,f.Z)(r,e);var t=(0,d.Z)(r);function r(e){return(0,c.Z)(this,r),t.call(this,4,e)}return(0,l.Z)(r,[{key:"decode",value:function(e,t){return void 0===t&&(t=0),e.readFloatLE(t)}},{key:"encode",value:function(e,t,r){return void 0===r&&(r=0),t.writeFloatLE(e,r),4}}]),r}(ge),De=function(e){(0,f.Z)(r,e);var t=(0,d.Z)(r);function r(e){return(0,c.Z)(this,r),t.call(this,4,e)}return(0,l.Z)(r,[{key:"decode",value:function(e,t){return void 0===t&&(t=0),e.readFloatBE(t)}},{key:"encode",value:function(e,t,r){return void 0===r&&(r=0),t.writeFloatBE(e,r),4}}]),r}(ge),Re=function(e){(0,f.Z)(r,e);var t=(0,d.Z)(r);function r(e){return(0,c.Z)(this,r),t.call(this,8,e)}return(0,l.Z)(r,[{key:"decode",value:function(e,t){return void 0===t&&(t=0),e.readDoubleLE(t)}},{key:"encode",value:function(e,t,r){return void 0===r&&(r=0),t.writeDoubleLE(e,r),8}}]),r}(ge),Le=function(e){(0,f.Z)(r,e);var t=(0,d.Z)(r);function r(e){return(0,c.Z)(this,r),t.call(this,8,e)}return(0,l.Z)(r,[{key:"decode",value:function(e,t){return void 0===t&&(t=0),e.readDoubleBE(t)}},{key:"encode",value:function(e,t,r){return void 0===r&&(r=0),t.writeDoubleBE(e,r),8}}]),r}(ge),Oe=function(e){(0,f.Z)(r,e);var t=(0,d.Z)(r);function r(e,n,i){var o;if((0,c.Z)(this,r),!(e instanceof ge))throw new TypeError("elementLayout must be a Layout");if(!(n instanceof ve&&n.isCount()||Number.isInteger(n)&&0<=n))throw new TypeError("count must be non-negative integer or an unsigned integer ExternalLayout");var a=-1;return!(n instanceof ve)&&0<e.span&&(a=n*e.span),(o=t.call(this,a,i)).elementLayout=e,o.count=n,o}return(0,l.Z)(r,[{key:"getSpan",value:function(e,t){if(0<=this.span)return this.span;void 0===t&&(t=0);var r=0,n=this.count;if(n instanceof ve&&(n=n.decode(e,t)),0<this.elementLayout.span)r=n*this.elementLayout.span;else for(var i=0;i<n;)r+=this.elementLayout.getSpan(e,t+r),++i;return r}},{key:"decode",value:function(e,t){void 0===t&&(t=0);var r=[],n=0,i=this.count;for(i instanceof ve&&(i=i.decode(e,t));n<i;)r.push(this.elementLayout.decode(e,t)),t+=this.elementLayout.getSpan(e,t),n+=1;return r}},{key:"encode",value:function(e,t,r){void 0===r&&(r=0);var n=this.elementLayout,i=e.reduce((function(e,i){return e+n.encode(i,t,r+e)}),0);return this.count instanceof ve&&this.count.encode(e.length,t,r),i}}]),r}(ge),ze=function(e){(0,f.Z)(r,e);var t=(0,d.Z)(r);function r(e,n,i){var o;if((0,c.Z)(this,r),!Array.isArray(e)||!e.reduce((function(e,t){return e&&t instanceof ge}),!0))throw new TypeError("fields must be array of Layout instances");"boolean"===typeof n&&void 0===i&&(i=n,n=void 0);var a,s=(0,u.Z)(e);try{for(s.s();!(a=s.n()).done;){var l=a.value;if(0>l.span&&void 0===l.property)throw new Error("fields cannot contain unnamed variable-length layout")}}catch(f){s.e(f)}finally{s.f()}var h=-1;try{h=e.reduce((function(e,t){return e+t.getSpan()}),0)}catch(d){}return(o=t.call(this,h,n)).fields=e,o.decodePrefixes=!!i,o}return(0,l.Z)(r,[{key:"getSpan",value:function(e,t){if(0<=this.span)return this.span;void 0===t&&(t=0);var r=0;try{r=this.fields.reduce((function(r,n){var i=n.getSpan(e,t);return t+=i,r+i}),0)}catch(n){throw new RangeError("indeterminate span")}return r}},{key:"decode",value:function(e,t){void 0===t&&(t=0);var r,n=this.makeDestinationObject(),i=(0,u.Z)(this.fields);try{for(i.s();!(r=i.n()).done;){var o=r.value;if(void 0!==o.property&&(n[o.property]=o.decode(e,t)),t+=o.getSpan(e,t),this.decodePrefixes&&e.length===t)break}}catch(a){i.e(a)}finally{i.f()}return n}},{key:"encode",value:function(e,t,r){void 0===r&&(r=0);var n,i=r,o=0,a=0,s=(0,u.Z)(this.fields);try{for(s.s();!(n=s.n()).done;){var c=n.value,l=c.span;if(a=0<l?l:0,void 0!==c.property){var h=e[c.property];void 0!==h&&(a=c.encode(h,t,r),0>l&&(l=c.getSpan(t,r)))}o=r,r+=l}}catch(f){s.e(f)}finally{s.f()}return o+a-i}},{key:"fromArray",value:function(e){var t,r=this.makeDestinationObject(),n=(0,u.Z)(this.fields);try{for(n.s();!(t=n.n()).done;){var i=t.value;void 0!==i.property&&0<e.length&&(r[i.property]=e.shift())}}catch(o){n.e(o)}finally{n.f()}return r}},{key:"layoutFor",value:function(e){if("string"!==typeof e)throw new TypeError("property must be string");var t,r=(0,u.Z)(this.fields);try{for(r.s();!(t=r.n()).done;){var n=t.value;if(n.property===e)return n}}catch(i){r.e(i)}finally{r.f()}}},{key:"offsetOf",value:function(e){if("string"!==typeof e)throw new TypeError("property must be string");var t,r=0,n=(0,u.Z)(this.fields);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(i.property===e)return r;0>i.span?r=-1:0<=r&&(r+=i.span)}}catch(o){n.e(o)}finally{n.f()}}}]),r}(ge),Ne=function(){function e(t){(0,c.Z)(this,e),this.property=t}return(0,l.Z)(e,[{key:"decode",value:function(){throw new Error("UnionDiscriminator is abstract")}},{key:"encode",value:function(){throw new Error("UnionDiscriminator is abstract")}}]),e}(),Ue=function(e){(0,f.Z)(r,e);var t=(0,d.Z)(r);function r(e,n){var i;if((0,c.Z)(this,r),!(e instanceof ve&&e.isCount()))throw new TypeError("layout must be an unsigned integer ExternalLayout");return(i=t.call(this,n||e.property||"variant")).layout=e,i}return(0,l.Z)(r,[{key:"decode",value:function(e,t){return this.layout.decode(e,t)}},{key:"encode",value:function(e,t,r){return this.layout.encode(e,t,r)}}]),r}(Ne),Ze=function(e){(0,f.Z)(r,e);var t=(0,d.Z)(r);function r(e,n,i){var o;(0,c.Z)(this,r);var a=e instanceof xe||e instanceof we;if(a)e=new Ue(new be(e));else if(e instanceof ve&&e.isCount())e=new Ue(e);else if(!(e instanceof Ne))throw new TypeError("discr must be a UnionDiscriminator or an unsigned integer layout");if(void 0===n&&(n=null),!(null===n||n instanceof ge))throw new TypeError("defaultLayout must be null or a Layout");if(null!==n){if(0>n.span)throw new Error("defaultLayout must have constant span");void 0===n.property&&(n=n.replicate("content"))}var s=-1;n&&0<=(s=n.span)&&a&&(s+=e.layout.span),(o=t.call(this,s,i)).discriminator=e,o.usesPrefixDiscriminator=a,o.defaultLayout=n,o.registry={};var u=o.defaultGetSourceVariant.bind((0,h.Z)(o));return o.getSourceVariant=function(e){return u(e)},o.configGetSourceVariant=function(e){u=e.bind(this)},o}return(0,l.Z)(r,[{key:"getSpan",value:function(e,t){if(0<=this.span)return this.span;void 0===t&&(t=0);var r=this.getVariant(e,t);if(!r)throw new Error("unable to determine span for unrecognized variant");return r.getSpan(e,t)}},{key:"defaultGetSourceVariant",value:function(e){if(e.hasOwnProperty(this.discriminator.property)){if(this.defaultLayout&&e.hasOwnProperty(this.defaultLayout.property))return;var t=this.registry[e[this.discriminator.property]];if(t&&(!t.layout||e.hasOwnProperty(t.property)))return t}else for(var r in this.registry){var n=this.registry[r];if(e.hasOwnProperty(n.property))return n}throw new Error("unable to infer src variant")}},{key:"decode",value:function(e,t){var r;void 0===t&&(t=0);var n=this.discriminator,i=n.decode(e,t),o=this.registry[i];if(void 0===o){var a=0;o=this.defaultLayout,this.usesPrefixDiscriminator&&(a=n.layout.span),(r=this.makeDestinationObject())[n.property]=i,r[o.property]=this.defaultLayout.decode(e,t+a)}else r=o.decode(e,t);return r}},{key:"encode",value:function(e,t,r){void 0===r&&(r=0);var n=this.getSourceVariant(e);if(void 0===n){var i=this.discriminator,o=this.defaultLayout,a=0;return this.usesPrefixDiscriminator&&(a=i.layout.span),i.encode(e[i.property],t,r),a+o.encode(e[o.property],t,r+a)}return n.encode(e,t,r)}},{key:"addVariant",value:function(e,t,r){var n=new Fe(this,e,t,r);return this.registry[e]=n,n}},{key:"getVariant",value:function(e,t){var r=e;return v.Buffer.isBuffer(e)&&(void 0===t&&(t=0),r=this.discriminator.decode(e,t)),this.registry[r]}}]),r}(ge),Fe=function(e){(0,f.Z)(r,e);var t=(0,d.Z)(r);function r(e,n,i,o){var a;if((0,c.Z)(this,r),!(e instanceof Ze))throw new TypeError("union must be a Union");if(!Number.isInteger(n)||0>n)throw new TypeError("variant must be a (non-negative) integer");if("string"===typeof i&&void 0===o&&(o=i,i=null),i){if(!(i instanceof ge))throw new TypeError("layout must be a Layout");if(null!==e.defaultLayout&&0<=i.span&&i.span>e.defaultLayout.span)throw new Error("variant span exceeds span of containing union");if("string"!==typeof o)throw new TypeError("variant must have a String property")}var s=e.span;return 0>e.span&&0<=(s=i?i.span:0)&&e.usesPrefixDiscriminator&&(s+=e.discriminator.layout.span),(a=t.call(this,s,o)).union=e,a.variant=n,a.layout=i||null,a}return(0,l.Z)(r,[{key:"getSpan",value:function(e,t){if(0<=this.span)return this.span;void 0===t&&(t=0);var r=0;return this.union.usesPrefixDiscriminator&&(r=this.union.discriminator.layout.span),r+this.layout.getSpan(e,t+r)}},{key:"decode",value:function(e,t){var r=this.makeDestinationObject();if(void 0===t&&(t=0),this!==this.union.getVariant(e,t))throw new Error("variant mismatch");var n=0;return this.union.usesPrefixDiscriminator&&(n=this.union.discriminator.layout.span),this.layout?r[this.property]=this.layout.decode(e,t+n):this.property?r[this.property]=!0:this.union.usesPrefixDiscriminator&&(r[this.union.discriminator.property]=this.variant),r}},{key:"encode",value:function(e,t,r){void 0===r&&(r=0);var n=0;if(this.union.usesPrefixDiscriminator&&(n=this.union.discriminator.layout.span),this.layout&&!e.hasOwnProperty(this.property))throw new TypeError("variant lacks property "+this.property);this.union.discriminator.encode(this.variant,t,r);var i=n;if(this.layout&&(this.layout.encode(e[this.property],t,r+n),i+=this.layout.getSpan(t,r+n),0<=this.union.span&&i>this.union.span))throw new Error("encoded variant overruns containing union");return i}},{key:"fromArray",value:function(e){if(this.layout)return this.layout.fromArray(e)}}]),r}(ge);function je(e){return 0>e&&(e+=4294967296),e}var Ve=function(e){(0,f.Z)(r,e);var t=(0,d.Z)(r);function r(e,n,i){var o;if((0,c.Z)(this,r),!(e instanceof xe||e instanceof we))throw new TypeError("word must be a UInt or UIntBE layout");if("string"===typeof n&&void 0===i&&(i=n,n=void 0),4<e.span)throw new RangeError("word cannot exceed 32 bits");(o=t.call(this,e.span,i)).word=e,o.msb=!!n,o.fields=[];var a=0;return o._packedSetValue=function(e){return a=je(e),this},o._packedGetValue=function(){return a},o}return(0,l.Z)(r,[{key:"decode",value:function(e,t){var r=this.makeDestinationObject();void 0===t&&(t=0);var n=this.word.decode(e,t);this._packedSetValue(n);var i,o=(0,u.Z)(this.fields);try{for(o.s();!(i=o.n()).done;){var a=i.value;void 0!==a.property&&(r[a.property]=a.decode(n))}}catch(s){o.e(s)}finally{o.f()}return r}},{key:"encode",value:function(e,t,r){void 0===r&&(r=0);var n=this.word.decode(t,r);this._packedSetValue(n);var i,o=(0,u.Z)(this.fields);try{for(o.s();!(i=o.n()).done;){var a=i.value;if(void 0!==a.property){var s=e[a.property];void 0!==s&&a.encode(s)}}}catch(c){o.e(c)}finally{o.f()}return this.word.encode(this._packedGetValue(),t,r)}},{key:"addField",value:function(e,t){var r=new We(this,e,t);return this.fields.push(r),r}},{key:"addBoolean",value:function(e){var t=new Ke(this,e);return this.fields.push(t),t}},{key:"fieldFor",value:function(e){if("string"!==typeof e)throw new TypeError("property must be string");var t,r=(0,u.Z)(this.fields);try{for(r.s();!(t=r.n()).done;){var n=t.value;if(n.property===e)return n}}catch(i){r.e(i)}finally{r.f()}}}]),r}(ge),We=function(){function e(t,r,n){if((0,c.Z)(this,e),!(t instanceof Ve))throw new TypeError("container must be a BitStructure");if(!Number.isInteger(r)||0>=r)throw new TypeError("bits must be positive integer");var i=8*t.span,o=t.fields.reduce((function(e,t){return e+t.bits}),0);if(r+o>i)throw new Error("bits too long for span remainder ("+(i-o)+" of "+i+" remain)");this.container=t,this.bits=r,this.valueMask=(1<<r)-1,32===r&&(this.valueMask=4294967295),this.start=o,this.container.msb&&(this.start=i-o-r),this.wordMask=je(this.valueMask<<this.start),this.property=n}return(0,l.Z)(e,[{key:"decode",value:function(){return je(this.container._packedGetValue()&this.wordMask)>>>this.start}},{key:"encode",value:function(e){if(!Number.isInteger(e)||e!==je(e&this.valueMask))throw new TypeError(ye("BitField.encode",this)+" value must be integer not exceeding "+this.valueMask);var t=this.container._packedGetValue(),r=je(e<<this.start);this.container._packedSetValue(je(t&~this.wordMask)|r)}}]),e}(),Ke=function(e){(0,f.Z)(r,e);var t=(0,d.Z)(r);function r(e,n){return(0,c.Z)(this,r),t.call(this,e,1,n)}return(0,l.Z)(r,[{key:"decode",value:function(e,t){return!!We.prototype.decode.call(this,e,t)}},{key:"encode",value:function(e){return"boolean"===typeof e&&(e=+e),We.prototype.encode.call(this,e)}}]),r}(We),Ge=function(e){(0,f.Z)(r,e);var t=(0,d.Z)(r);function r(e,n){var i;if((0,c.Z)(this,r),!(e instanceof ve&&e.isCount()||Number.isInteger(e)&&0<=e))throw new TypeError("length must be positive integer or an unsigned integer ExternalLayout");var o=-1;return e instanceof ve||(o=e),(i=t.call(this,o,n)).length=e,i}return(0,l.Z)(r,[{key:"getSpan",value:function(e,t){var r=this.span;return 0>r&&(r=this.length.decode(e,t)),r}},{key:"decode",value:function(e,t){void 0===t&&(t=0);var r=this.span;return 0>r&&(r=this.length.decode(e,t)),e.slice(t,t+r)}},{key:"encode",value:function(e,t,r){var n=this.length;if(this.length instanceof ve&&(n=e.length),!v.Buffer.isBuffer(e)||n!==e.length)throw new TypeError(ye("Blob.encode",this)+" requires (length "+n+") Buffer as src");if(r+n>t.length)throw new RangeError("encoding overruns Buffer");return t.write(e.toString("hex"),r,n,"hex"),this.length instanceof ve&&this.length.encode(n,t,r),n}}]),r}(ge),He=function(e){(0,f.Z)(r,e);var t=(0,d.Z)(r);function r(e){return(0,c.Z)(this,r),t.call(this,-1,e)}return(0,l.Z)(r,[{key:"getSpan",value:function(e,t){if(!v.Buffer.isBuffer(e))throw new TypeError("b must be a Buffer");void 0===t&&(t=0);for(var r=t;r<e.length&&0!==e[r];)r+=1;return 1+r-t}},{key:"decode",value:function(e,t,r){void 0===t&&(t=0);var n=this.getSpan(e,t);return e.slice(t,t+n-1).toString("utf-8")}},{key:"encode",value:function(e,t,r){void 0===r&&(r=0),"string"!==typeof e&&(e=e.toString());var n=new v.Buffer(e,"utf8"),i=n.length;if(r+i>t.length)throw new RangeError("encoding overruns Buffer");return n.copy(t,r),t[r+i]=0,i+1}}]),r}(ge),qe=function(e){(0,f.Z)(r,e);var t=(0,d.Z)(r);function r(e,n){var i;if((0,c.Z)(this,r),"string"===typeof e&&void 0===n&&(n=e,e=void 0),void 0===e)e=-1;else if(!Number.isInteger(e))throw new TypeError("maxSpan must be an integer");return(i=t.call(this,-1,n)).maxSpan=e,i}return(0,l.Z)(r,[{key:"getSpan",value:function(e,t){if(!v.Buffer.isBuffer(e))throw new TypeError("b must be a Buffer");return void 0===t&&(t=0),e.length-t}},{key:"decode",value:function(e,t,r){void 0===t&&(t=0);var n=this.getSpan(e,t);if(0<=this.maxSpan&&this.maxSpan<n)throw new RangeError("text length exceeds maxSpan");return e.slice(t,t+n).toString("utf-8")}},{key:"encode",value:function(e,t,r){void 0===r&&(r=0),"string"!==typeof e&&(e=e.toString());var n=new v.Buffer(e,"utf8"),i=n.length;if(0<=this.maxSpan&&this.maxSpan<i)throw new RangeError("text length exceeds maxSpan");if(r+i>t.length)throw new RangeError("encoding overruns Buffer");return n.copy(t,r),i}}]),r}(ge),Ye=function(e){(0,f.Z)(r,e);var t=(0,d.Z)(r);function r(e,n){var i;return(0,c.Z)(this,r),(i=t.call(this,0,n)).value=e,i}return(0,l.Z)(r,[{key:"decode",value:function(e,t,r){return this.value}},{key:"encode",value:function(e,t,r){return 0}}]),r}(ge);me.ExternalLayout=ve,me.GreedyCount=_e,me.OffsetLayout=be,me.UInt=xe,me.UIntBE=we,me.Int=ke,me.IntBE=Ae,me.Float=Be,me.FloatBE=De,me.Double=Re,me.DoubleBE=Le,me.Sequence=Oe,me.Structure=ze,me.UnionDiscriminator=Ne,me.UnionLayoutDiscriminator=Ue,me.Union=Ze,me.VariantLayout=Fe,me.BitStructure=Ve,me.BitField=We,me.Boolean=Ke,me.Blob=Ge,me.CString=He,me.UTF8=qe,me.Constant=Ye,me.greedy=function(e,t){return new _e(e,t)},me.offset=function(e,t,r){return new be(e,t,r)};var Xe=me.u8=function(e){return new xe(1,e)};me.u16=function(e){return new xe(2,e)},me.u24=function(e){return new xe(3,e)};var Qe=me.u32=function(e){return new xe(4,e)};me.u40=function(e){return new xe(5,e)},me.u48=function(e){return new xe(6,e)},me.nu64=function(e){return new Me(e)},me.u16be=function(e){return new we(2,e)},me.u24be=function(e){return new we(3,e)},me.u32be=function(e){return new we(4,e)},me.u40be=function(e){return new we(5,e)},me.u48be=function(e){return new we(6,e)},me.nu64be=function(e){return new Ie(e)},me.s8=function(e){return new ke(1,e)},me.s16=function(e){return new ke(2,e)},me.s24=function(e){return new ke(3,e)},me.s32=function(e){return new ke(4,e)},me.s40=function(e){return new ke(5,e)},me.s48=function(e){return new ke(6,e)},me.ns64=function(e){return new Pe(e)},me.s16be=function(e){return new Ae(2,e)},me.s24be=function(e){return new Ae(3,e)},me.s32be=function(e){return new Ae(4,e)},me.s40be=function(e){return new Ae(5,e)},me.s48be=function(e){return new Ae(6,e)},me.ns64be=function(e){return new Ce(e)},me.f32=function(e){return new Be(e)},me.f32be=function(e){return new De(e)},me.f64=function(e){return new Re(e)},me.f64be=function(e){return new Le(e)};var $e=me.struct=function(e,t,r){return new ze(e,t,r)};me.bits=function(e,t,r){return new Ve(e,t,r)},me.seq=function(e,t,r){return new Oe(e,t,r)},me.union=function(e,t,r){return new Ze(e,t,r)},me.unionLayoutDiscriminator=function(e,t){return new Ue(e,t)};var Je=me.blob=function(e,t){return new Ge(e,t)};me.cstr=function(e){return new He(e)},me.utf8=function(e,t){return new qe(e,t)},me.const=function(e,t){return new Ye(e,t)};var et=function(){return Je(32,arguments.length>0&&void 0!==arguments[0]?arguments[0]:"publicKey")},tt=function(){return Je(8,arguments.length>0&&void 0!==arguments[0]?arguments[0]:"uint64")};function rt(e,t,r){for(var n=arguments.length,i=new Array(n>3?n-3:0),o=3;o<n;o++)i[o-3]=arguments[o];return(0,y.sendAndConfirmTransaction)(t,r,i,{skipPreflight:!1})}var nt=new y.PublicKey("TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA"),it=new y.PublicKey("ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL"),ot="Failed to find account",at="Invalid account owner";function st(e){return v.Buffer.from(e.toBuffer())}var ut=function(e){(0,f.Z)(r,e);var t=(0,d.Z)(r);function r(){return(0,c.Z)(this,r),t.apply(this,arguments)}return(0,l.Z)(r,[{key:"toBuffer",value:function(){var e=(0,a.Z)((0,s.Z)(r.prototype),"toArray",this).call(this).reverse(),t=v.Buffer.from(e);if(8===t.length)return t;ne(t.length<8,"u64 too large");var n=v.Buffer.alloc(8);return t.copy(n),n}}],[{key:"fromBuffer",value:function(e){return ne(8===e.length,"Invalid buffer length: ".concat(e.length)),new r((0,o.Z)(e).reverse().map((function(e){return"00".concat(e.toString(16)).slice(-2)})).join(""),16)}}]),r}(g());function ct(e){return"publicKey"in e}var lt={MintTokens:0,FreezeAccount:1,AccountOwner:2,CloseAccount:3},ht=new y.PublicKey("So11111111111111111111111111111111111111112"),ft=$e([Qe("mintAuthorityOption"),et("mintAuthority"),tt("supply"),Xe("decimals"),Xe("isInitialized"),Qe("freezeAuthorityOption"),et("freezeAuthority")]),dt=$e([et("mint"),et("owner"),tt("amount"),Qe("delegateOption"),et("delegate"),Xe("state"),Qe("isNativeOption"),tt("isNative"),tt("delegatedAmount"),Qe("closeAuthorityOption"),et("closeAuthority")]),pt=$e([Xe("m"),Xe("n"),Xe("is_initialized"),et("signer1"),et("signer2"),et("signer3"),et("signer4"),et("signer5"),et("signer6"),et("signer7"),et("signer8"),et("signer9"),et("signer10"),et("signer11")]),mt=function(){function e(t,r,n,i){(0,c.Z)(this,e),(0,p.Z)(this,"connection",void 0),(0,p.Z)(this,"publicKey",void 0),(0,p.Z)(this,"programId",void 0),(0,p.Z)(this,"associatedProgramId",void 0),(0,p.Z)(this,"payer",void 0),Object.assign(this,{connection:t,publicKey:r,programId:n,payer:i,associatedProgramId:it})}return(0,l.Z)(e,[{key:"createAccount",value:function(){var t=(0,i.Z)((0,n.Z)().mark((function t(r){var i,o,a,s;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getMinBalanceRentForExemptAccount(this.connection);case 2:return i=t.sent,o=y.Keypair.generate(),(a=new y.Transaction).add(y.SystemProgram.createAccount({fromPubkey:this.payer.publicKey,newAccountPubkey:o.publicKey,lamports:i,space:dt.span,programId:this.programId})),s=this.publicKey,a.add(e.createInitAccountInstruction(this.programId,s,o.publicKey,r)),t.next=10,rt("createAccount and InitializeAccount",this.connection,a,this.payer,o);case 10:return t.abrupt("return",o.publicKey);case 11:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"createAssociatedTokenAccount",value:function(){var t=(0,i.Z)((0,n.Z)().mark((function t(r){var i;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getAssociatedTokenAddress(this.associatedProgramId,this.programId,this.publicKey,r);case 2:return i=t.sent,t.abrupt("return",this.createAssociatedTokenAccountInternal(r,i));case 4:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"createAssociatedTokenAccountInternal",value:function(){var t=(0,i.Z)((0,n.Z)().mark((function t(r,i){return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,rt("CreateAssociatedTokenAccount",this.connection,(new y.Transaction).add(e.createAssociatedTokenAccountInstruction(this.associatedProgramId,this.programId,this.publicKey,i,r,this.payer.publicKey)),this.payer);case 2:return t.abrupt("return",i);case 3:case"end":return t.stop()}}),t,this)})));return function(e,r){return t.apply(this,arguments)}}()},{key:"getOrCreateAssociatedAccountInfo",value:function(){var t=(0,i.Z)((0,n.Z)().mark((function t(r){var i;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getAssociatedTokenAddress(this.associatedProgramId,this.programId,this.publicKey,r);case 2:return i=t.sent,t.prev=3,t.next=6,this.getAccountInfo(i);case 6:return t.abrupt("return",t.sent);case 9:if(t.prev=9,t.t0=t.catch(3),t.t0.message!==ot&&t.t0.message!==at){t.next=24;break}return t.prev=12,t.next=15,this.createAssociatedTokenAccountInternal(r,i);case 15:t.next=19;break;case 17:t.prev=17,t.t1=t.catch(12);case 19:return t.next=21,this.getAccountInfo(i);case 21:return t.abrupt("return",t.sent);case 24:throw t.t0;case 25:case"end":return t.stop()}}),t,this,[[3,9],[12,17]])})));return function(e){return t.apply(this,arguments)}}()},{key:"createMultisig",value:function(){var t=(0,i.Z)((0,n.Z)().mark((function t(r,i){var o,a,s,u,c,l;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o=y.Keypair.generate(),t.next=3,e.getMinBalanceRentForExemptMultisig(this.connection);case 3:return a=t.sent,(s=new y.Transaction).add(y.SystemProgram.createAccount({fromPubkey:this.payer.publicKey,newAccountPubkey:o.publicKey,lamports:a,space:pt.span,programId:this.programId})),u=[{pubkey:o.publicKey,isSigner:!1,isWritable:!0},{pubkey:y.SYSVAR_RENT_PUBKEY,isSigner:!1,isWritable:!1}],i.forEach((function(e){return u.push({pubkey:e,isSigner:!1,isWritable:!1})})),c=$e([Xe("instruction"),Xe("m")]),l=v.Buffer.alloc(c.span),c.encode({instruction:2,m:r},l),s.add({keys:u,programId:this.programId,data:l}),t.next=14,rt("createAccount and InitializeMultisig",this.connection,s,this.payer,o);case 14:return t.abrupt("return",o.publicKey);case 15:case"end":return t.stop()}}),t,this)})));return function(e,r){return t.apply(this,arguments)}}()},{key:"getMintInfo",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(){var t,r,i;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.connection.getAccountInfo(this.publicKey);case 2:if(null!==(t=e.sent)){e.next=5;break}throw new Error("Failed to find mint account");case 5:if(t.owner.equals(this.programId)){e.next=7;break}throw new Error("Invalid mint owner: ".concat(JSON.stringify(t.owner)));case 7:if(t.data.length==ft.span){e.next=9;break}throw new Error("Invalid mint size");case 9:return r=v.Buffer.from(t.data),0===(i=ft.decode(r)).mintAuthorityOption?i.mintAuthority=null:i.mintAuthority=new y.PublicKey(i.mintAuthority),i.supply=ut.fromBuffer(i.supply),i.isInitialized=0!=i.isInitialized,0===i.freezeAuthorityOption?i.freezeAuthority=null:i.freezeAuthority=new y.PublicKey(i.freezeAuthority),e.abrupt("return",i);case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getAccountInfo",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,r){var i,o,a;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.connection.getAccountInfo(t,r);case 2:if(null!==(i=e.sent)){e.next=5;break}throw new Error(ot);case 5:if(i.owner.equals(this.programId)){e.next=7;break}throw new Error(at);case 7:if(i.data.length==dt.span){e.next=9;break}throw new Error("Invalid account size");case 9:if(o=v.Buffer.from(i.data),(a=dt.decode(o)).address=t,a.mint=new y.PublicKey(a.mint),a.owner=new y.PublicKey(a.owner),a.amount=ut.fromBuffer(a.amount),0===a.delegateOption?(a.delegate=null,a.delegatedAmount=new ut):(a.delegate=new y.PublicKey(a.delegate),a.delegatedAmount=ut.fromBuffer(a.delegatedAmount)),a.isInitialized=0!==a.state,a.isFrozen=2===a.state,1===a.isNativeOption?(a.rentExemptReserve=ut.fromBuffer(a.isNative),a.isNative=!0):(a.rentExemptReserve=null,a.isNative=!1),0===a.closeAuthorityOption?a.closeAuthority=null:a.closeAuthority=new y.PublicKey(a.closeAuthority),a.mint.equals(this.publicKey)){e.next=22;break}throw new Error("Invalid account mint: ".concat(JSON.stringify(a.mint)," !== ").concat(JSON.stringify(this.publicKey)));case 22:return e.abrupt("return",a);case 23:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getMultisigInfo",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){var r,i,o;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.connection.getAccountInfo(t);case 2:if(null!==(r=e.sent)){e.next=5;break}throw new Error("Failed to find multisig");case 5:if(r.owner.equals(this.programId)){e.next=7;break}throw new Error("Invalid multisig owner");case 7:if(r.data.length==pt.span){e.next=9;break}throw new Error("Invalid multisig size");case 9:return i=v.Buffer.from(r.data),(o=pt.decode(i)).signer1=new y.PublicKey(o.signer1),o.signer2=new y.PublicKey(o.signer2),o.signer3=new y.PublicKey(o.signer3),o.signer4=new y.PublicKey(o.signer4),o.signer5=new y.PublicKey(o.signer5),o.signer6=new y.PublicKey(o.signer6),o.signer7=new y.PublicKey(o.signer7),o.signer8=new y.PublicKey(o.signer8),o.signer9=new y.PublicKey(o.signer9),o.signer10=new y.PublicKey(o.signer10),o.signer11=new y.PublicKey(o.signer11),e.abrupt("return",o);case 23:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"transfer",value:function(){var t=(0,i.Z)((0,n.Z)().mark((function t(r,i,a,s,u){var c,l;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return ct(a)?(c=a.publicKey,l=[a]):(c=a,l=s),t.next=3,rt.apply(void 0,["Transfer",this.connection,(new y.Transaction).add(e.createTransferInstruction(this.programId,r,i,c,s,u)),this.payer].concat((0,o.Z)(l)));case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t,this)})));return function(e,r,n,i,o){return t.apply(this,arguments)}}()},{key:"approve",value:function(){var t=(0,i.Z)((0,n.Z)().mark((function t(r,i,a,s,u){var c,l;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return ct(a)?(c=a.publicKey,l=[a]):(c=a,l=s),t.next=3,rt.apply(void 0,["Approve",this.connection,(new y.Transaction).add(e.createApproveInstruction(this.programId,r,i,c,s,u)),this.payer].concat((0,o.Z)(l)));case 3:case"end":return t.stop()}}),t,this)})));return function(e,r,n,i,o){return t.apply(this,arguments)}}()},{key:"revoke",value:function(){var t=(0,i.Z)((0,n.Z)().mark((function t(r,i,a){var s,u;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return ct(i)?(s=i.publicKey,u=[i]):(s=i,u=a),t.next=3,rt.apply(void 0,["Revoke",this.connection,(new y.Transaction).add(e.createRevokeInstruction(this.programId,r,s,a)),this.payer].concat((0,o.Z)(u)));case 3:case"end":return t.stop()}}),t,this)})));return function(e,r,n){return t.apply(this,arguments)}}()},{key:"setAuthority",value:function(){var t=(0,i.Z)((0,n.Z)().mark((function t(r,i,a,s,u){var c,l;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return ct(s)?(c=s.publicKey,l=[s]):(c=s,l=u),t.next=3,rt.apply(void 0,["SetAuthority",this.connection,(new y.Transaction).add(e.createSetAuthorityInstruction(this.programId,r,i,a,c,u)),this.payer].concat((0,o.Z)(l)));case 3:case"end":return t.stop()}}),t,this)})));return function(e,r,n,i,o){return t.apply(this,arguments)}}()},{key:"mintTo",value:function(){var t=(0,i.Z)((0,n.Z)().mark((function t(r,i,a,s){var u,c;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return ct(i)?(u=i.publicKey,c=[i]):(u=i,c=a),t.next=3,rt.apply(void 0,["MintTo",this.connection,(new y.Transaction).add(e.createMintToInstruction(this.programId,this.publicKey,r,u,a,s)),this.payer].concat((0,o.Z)(c)));case 3:case"end":return t.stop()}}),t,this)})));return function(e,r,n,i){return t.apply(this,arguments)}}()},{key:"burn",value:function(){var t=(0,i.Z)((0,n.Z)().mark((function t(r,i,a,s){var u,c;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return ct(i)?(u=i.publicKey,c=[i]):(u=i,c=a),t.next=3,rt.apply(void 0,["Burn",this.connection,(new y.Transaction).add(e.createBurnInstruction(this.programId,this.publicKey,r,u,a,s)),this.payer].concat((0,o.Z)(c)));case 3:case"end":return t.stop()}}),t,this)})));return function(e,r,n,i){return t.apply(this,arguments)}}()},{key:"closeAccount",value:function(){var t=(0,i.Z)((0,n.Z)().mark((function t(r,i,a,s){var u,c;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return ct(a)?(u=a.publicKey,c=[a]):(u=a,c=s),t.next=3,rt.apply(void 0,["CloseAccount",this.connection,(new y.Transaction).add(e.createCloseAccountInstruction(this.programId,r,i,u,s)),this.payer].concat((0,o.Z)(c)));case 3:case"end":return t.stop()}}),t,this)})));return function(e,r,n,i){return t.apply(this,arguments)}}()},{key:"freezeAccount",value:function(){var t=(0,i.Z)((0,n.Z)().mark((function t(r,i,a){var s,u;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return ct(i)?(s=i.publicKey,u=[i]):(s=i,u=a),t.next=3,rt.apply(void 0,["FreezeAccount",this.connection,(new y.Transaction).add(e.createFreezeAccountInstruction(this.programId,r,this.publicKey,s,a)),this.payer].concat((0,o.Z)(u)));case 3:case"end":return t.stop()}}),t,this)})));return function(e,r,n){return t.apply(this,arguments)}}()},{key:"thawAccount",value:function(){var t=(0,i.Z)((0,n.Z)().mark((function t(r,i,a){var s,u;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return ct(i)?(s=i.publicKey,u=[i]):(s=i,u=a),t.next=3,rt.apply(void 0,["ThawAccount",this.connection,(new y.Transaction).add(e.createThawAccountInstruction(this.programId,r,this.publicKey,s,a)),this.payer].concat((0,o.Z)(u)));case 3:case"end":return t.stop()}}),t,this)})));return function(e,r,n){return t.apply(this,arguments)}}()},{key:"transferChecked",value:function(){var t=(0,i.Z)((0,n.Z)().mark((function t(r,i,a,s,u,c){var l,h;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return ct(a)?(l=a.publicKey,h=[a]):(l=a,h=s),t.next=3,rt.apply(void 0,["TransferChecked",this.connection,(new y.Transaction).add(e.createTransferCheckedInstruction(this.programId,r,this.publicKey,i,l,s,u,c)),this.payer].concat((0,o.Z)(h)));case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t,this)})));return function(e,r,n,i,o,a){return t.apply(this,arguments)}}()},{key:"approveChecked",value:function(){var t=(0,i.Z)((0,n.Z)().mark((function t(r,i,a,s,u,c){var l,h;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return ct(a)?(l=a.publicKey,h=[a]):(l=a,h=s),t.next=3,rt.apply(void 0,["ApproveChecked",this.connection,(new y.Transaction).add(e.createApproveCheckedInstruction(this.programId,r,this.publicKey,i,l,s,u,c)),this.payer].concat((0,o.Z)(h)));case 3:case"end":return t.stop()}}),t,this)})));return function(e,r,n,i,o,a){return t.apply(this,arguments)}}()},{key:"mintToChecked",value:function(){var t=(0,i.Z)((0,n.Z)().mark((function t(r,i,a,s,u){var c,l;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return ct(i)?(c=i.publicKey,l=[i]):(c=i,l=a),t.next=3,rt.apply(void 0,["MintToChecked",this.connection,(new y.Transaction).add(e.createMintToCheckedInstruction(this.programId,this.publicKey,r,c,a,s,u)),this.payer].concat((0,o.Z)(l)));case 3:case"end":return t.stop()}}),t,this)})));return function(e,r,n,i,o){return t.apply(this,arguments)}}()},{key:"burnChecked",value:function(){var t=(0,i.Z)((0,n.Z)().mark((function t(r,i,a,s,u){var c,l;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return ct(i)?(c=i.publicKey,l=[i]):(c=i,l=a),t.next=3,rt.apply(void 0,["BurnChecked",this.connection,(new y.Transaction).add(e.createBurnCheckedInstruction(this.programId,this.publicKey,r,c,a,s,u)),this.payer].concat((0,o.Z)(l)));case 3:case"end":return t.stop()}}),t,this)})));return function(e,r,n,i,o){return t.apply(this,arguments)}}()},{key:"syncNative",value:function(){var t=(0,i.Z)((0,n.Z)().mark((function t(r){return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,rt("SyncNative",this.connection,(new y.Transaction).add(e.createSyncNativeInstruction(this.programId,r)),this.payer);case 2:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()}],[{key:"getMinBalanceRentForExemptMint",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getMinimumBalanceForRentExemption(ft.span);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getMinBalanceRentForExemptAccount",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getMinimumBalanceForRentExemption(dt.span);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"getMinBalanceRentForExemptMultisig",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t){return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getMinimumBalanceForRentExemption(pt.span);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"createMint",value:function(){var t=(0,i.Z)((0,n.Z)().mark((function t(r,i,o,a,s,u){var c,l,h,f;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=y.Keypair.generate(),l=new e(r,c.publicKey,u,i),t.next=4,e.getMinBalanceRentForExemptMint(r);case 4:return h=t.sent,(f=new y.Transaction).add(y.SystemProgram.createAccount({fromPubkey:i.publicKey,newAccountPubkey:c.publicKey,lamports:h,space:ft.span,programId:u})),f.add(e.createInitMintInstruction(u,c.publicKey,s,o,a)),t.next=10,rt("createAccount and InitializeMint",r,f,i,c);case 10:return t.abrupt("return",l);case 11:case"end":return t.stop()}}),t)})));return function(e,r,n,i,o,a){return t.apply(this,arguments)}}()},{key:"createWrappedNativeAccount",value:function(){var t=(0,i.Z)((0,n.Z)().mark((function t(r,i,o,a,s){var u,c,l;return(0,n.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getMinBalanceRentForExemptAccount(r);case 2:return u=t.sent,c=y.Keypair.generate(),(l=new y.Transaction).add(y.SystemProgram.createAccount({fromPubkey:a.publicKey,newAccountPubkey:c.publicKey,lamports:u,space:dt.span,programId:i})),l.add(y.SystemProgram.transfer({fromPubkey:a.publicKey,toPubkey:c.publicKey,lamports:s})),l.add(e.createInitAccountInstruction(i,ht,c.publicKey,o)),t.next=10,rt("createAccount, transfer, and initializeAccount",r,l,a,c);case 10:return t.abrupt("return",c.publicKey);case 11:case"end":return t.stop()}}),t)})));return function(e,r,n,i,o){return t.apply(this,arguments)}}()},{key:"createInitMintInstruction",value:function(e,t,r,n,i){var o=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:y.SYSVAR_RENT_PUBKEY,isSigner:!1,isWritable:!1}],a=$e([Xe("instruction"),Xe("decimals"),et("mintAuthority"),Xe("option"),et("freezeAuthority")]),s=v.Buffer.alloc(1024),u=a.encode({instruction:0,decimals:r,mintAuthority:st(n),option:null===i?0:1,freezeAuthority:st(i||new y.PublicKey(0))},s);return s=s.slice(0,u),new y.TransactionInstruction({keys:o,programId:e,data:s})}},{key:"createInitAccountInstruction",value:function(e,t,r,n){var i=[{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:y.SYSVAR_RENT_PUBKEY,isSigner:!1,isWritable:!1}],o=$e([Xe("instruction")]),a=v.Buffer.alloc(o.span);return o.encode({instruction:1},a),new y.TransactionInstruction({keys:i,programId:e,data:a})}},{key:"createTransferInstruction",value:function(e,t,r,n,i,o){var a=$e([Xe("instruction"),tt("amount")]),s=v.Buffer.alloc(a.span);a.encode({instruction:3,amount:new ut(o).toBuffer()},s);var u=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0}];return 0===i.length?u.push({pubkey:n,isSigner:!0,isWritable:!1}):(u.push({pubkey:n,isSigner:!1,isWritable:!1}),i.forEach((function(e){return u.push({pubkey:e.publicKey,isSigner:!0,isWritable:!1})}))),new y.TransactionInstruction({keys:u,programId:e,data:s})}},{key:"createApproveInstruction",value:function(e,t,r,n,i,o){var a=$e([Xe("instruction"),tt("amount")]),s=v.Buffer.alloc(a.span);a.encode({instruction:4,amount:new ut(o).toBuffer()},s);var u=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!1}];return 0===i.length?u.push({pubkey:n,isSigner:!0,isWritable:!1}):(u.push({pubkey:n,isSigner:!1,isWritable:!1}),i.forEach((function(e){return u.push({pubkey:e.publicKey,isSigner:!0,isWritable:!1})}))),new y.TransactionInstruction({keys:u,programId:e,data:s})}},{key:"createRevokeInstruction",value:function(e,t,r,n){var i=$e([Xe("instruction")]),o=v.Buffer.alloc(i.span);i.encode({instruction:5},o);var a=[{pubkey:t,isSigner:!1,isWritable:!0}];return 0===n.length?a.push({pubkey:r,isSigner:!0,isWritable:!1}):(a.push({pubkey:r,isSigner:!1,isWritable:!1}),n.forEach((function(e){return a.push({pubkey:e.publicKey,isSigner:!0,isWritable:!1})}))),new y.TransactionInstruction({keys:a,programId:e,data:o})}},{key:"createSetAuthorityInstruction",value:function(e,t,r,n,i,o){var a=$e([Xe("instruction"),Xe("authorityType"),Xe("option"),et("newAuthority")]),s=v.Buffer.alloc(1024),u=a.encode({instruction:6,authorityType:lt[n],option:null===r?0:1,newAuthority:st(r||new y.PublicKey(0))},s);s=s.slice(0,u);var c=[{pubkey:t,isSigner:!1,isWritable:!0}];return 0===o.length?c.push({pubkey:i,isSigner:!0,isWritable:!1}):(c.push({pubkey:i,isSigner:!1,isWritable:!1}),o.forEach((function(e){return c.push({pubkey:e.publicKey,isSigner:!0,isWritable:!1})}))),new y.TransactionInstruction({keys:c,programId:e,data:s})}},{key:"createMintToInstruction",value:function(e,t,r,n,i,o){var a=$e([Xe("instruction"),tt("amount")]),s=v.Buffer.alloc(a.span);a.encode({instruction:7,amount:new ut(o).toBuffer()},s);var u=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0}];return 0===i.length?u.push({pubkey:n,isSigner:!0,isWritable:!1}):(u.push({pubkey:n,isSigner:!1,isWritable:!1}),i.forEach((function(e){return u.push({pubkey:e.publicKey,isSigner:!0,isWritable:!1})}))),new y.TransactionInstruction({keys:u,programId:e,data:s})}},{key:"createBurnInstruction",value:function(e,t,r,n,i,o){var a=$e([Xe("instruction"),tt("amount")]),s=v.Buffer.alloc(a.span);a.encode({instruction:8,amount:new ut(o).toBuffer()},s);var u=[{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!0}];return 0===i.length?u.push({pubkey:n,isSigner:!0,isWritable:!1}):(u.push({pubkey:n,isSigner:!1,isWritable:!1}),i.forEach((function(e){return u.push({pubkey:e.publicKey,isSigner:!0,isWritable:!1})}))),new y.TransactionInstruction({keys:u,programId:e,data:s})}},{key:"createCloseAccountInstruction",value:function(e,t,r,n,i){var o=$e([Xe("instruction")]),a=v.Buffer.alloc(o.span);o.encode({instruction:9},a);var s=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0}];return 0===i.length?s.push({pubkey:n,isSigner:!0,isWritable:!1}):(s.push({pubkey:n,isSigner:!1,isWritable:!1}),i.forEach((function(e){return s.push({pubkey:e.publicKey,isSigner:!0,isWritable:!1})}))),new y.TransactionInstruction({keys:s,programId:e,data:a})}},{key:"createFreezeAccountInstruction",value:function(e,t,r,n,i){var o=$e([Xe("instruction")]),a=v.Buffer.alloc(o.span);o.encode({instruction:10},a);var s=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!1}];return 0===i.length?s.push({pubkey:n,isSigner:!0,isWritable:!1}):(s.push({pubkey:n,isSigner:!1,isWritable:!1}),i.forEach((function(e){return s.push({pubkey:e.publicKey,isSigner:!0,isWritable:!1})}))),new y.TransactionInstruction({keys:s,programId:e,data:a})}},{key:"createThawAccountInstruction",value:function(e,t,r,n,i){var o=$e([Xe("instruction")]),a=v.Buffer.alloc(o.span);o.encode({instruction:11},a);var s=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!1}];return 0===i.length?s.push({pubkey:n,isSigner:!0,isWritable:!1}):(s.push({pubkey:n,isSigner:!1,isWritable:!1}),i.forEach((function(e){return s.push({pubkey:e.publicKey,isSigner:!0,isWritable:!1})}))),new y.TransactionInstruction({keys:s,programId:e,data:a})}},{key:"createTransferCheckedInstruction",value:function(e,t,r,n,i,o,a,s){var u=$e([Xe("instruction"),tt("amount"),Xe("decimals")]),c=v.Buffer.alloc(u.span);u.encode({instruction:12,amount:new ut(a).toBuffer(),decimals:s},c);var l=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!0}];return 0===o.length?l.push({pubkey:i,isSigner:!0,isWritable:!1}):(l.push({pubkey:i,isSigner:!1,isWritable:!1}),o.forEach((function(e){return l.push({pubkey:e.publicKey,isSigner:!0,isWritable:!1})}))),new y.TransactionInstruction({keys:l,programId:e,data:c})}},{key:"createApproveCheckedInstruction",value:function(e,t,r,n,i,o,a,s){var u=$e([Xe("instruction"),tt("amount"),Xe("decimals")]),c=v.Buffer.alloc(u.span);u.encode({instruction:13,amount:new ut(a).toBuffer(),decimals:s},c);var l=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!1,isWritable:!1}];return 0===o.length?l.push({pubkey:i,isSigner:!0,isWritable:!1}):(l.push({pubkey:i,isSigner:!1,isWritable:!1}),o.forEach((function(e){return l.push({pubkey:e.publicKey,isSigner:!0,isWritable:!1})}))),new y.TransactionInstruction({keys:l,programId:e,data:c})}},{key:"createMintToCheckedInstruction",value:function(e,t,r,n,i,o,a){var s=$e([Xe("instruction"),tt("amount"),Xe("decimals")]),u=v.Buffer.alloc(s.span);s.encode({instruction:14,amount:new ut(o).toBuffer(),decimals:a},u);var c=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0}];return 0===i.length?c.push({pubkey:n,isSigner:!0,isWritable:!1}):(c.push({pubkey:n,isSigner:!1,isWritable:!1}),i.forEach((function(e){return c.push({pubkey:e.publicKey,isSigner:!0,isWritable:!1})}))),new y.TransactionInstruction({keys:c,programId:e,data:u})}},{key:"createBurnCheckedInstruction",value:function(e,t,r,n,i,o,a){var s=$e([Xe("instruction"),tt("amount"),Xe("decimals")]),u=v.Buffer.alloc(s.span);s.encode({instruction:15,amount:new ut(o).toBuffer(),decimals:a},u);var c=[{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:t,isSigner:!1,isWritable:!0}];return 0===i.length?c.push({pubkey:n,isSigner:!0,isWritable:!1}):(c.push({pubkey:n,isSigner:!1,isWritable:!1}),i.forEach((function(e){return c.push({pubkey:e.publicKey,isSigner:!0,isWritable:!1})}))),new y.TransactionInstruction({keys:c,programId:e,data:u})}},{key:"createSyncNativeInstruction",value:function(e,t){var r=$e([Xe("instruction")]),n=v.Buffer.alloc(r.span);r.encode({instruction:17},n);var i=[{pubkey:t,isSigner:!1,isWritable:!0}];return new y.TransactionInstruction({keys:i,programId:e,data:n})}},{key:"getAssociatedTokenAddress",value:function(){var e=(0,i.Z)((0,n.Z)().mark((function e(t,r,i,o){var a=arguments;return(0,n.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.length>4&&void 0!==a[4]&&a[4]||y.PublicKey.isOnCurve(o.toBuffer())){e.next=3;break}throw new Error("Owner cannot sign: ".concat(o.toString()));case 3:return e.next=5,y.PublicKey.findProgramAddress([o.toBuffer(),r.toBuffer(),i.toBuffer()],t);case 5:return e.abrupt("return",e.sent[0]);case 6:case"end":return e.stop()}}),e)})));return function(t,r,n,i){return e.apply(this,arguments)}}()},{key:"createAssociatedTokenAccountInstruction",value:function(e,t,r,n,i,o){var a=v.Buffer.alloc(0),s=[{pubkey:o,isSigner:!0,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!1,isWritable:!1},{pubkey:y.SystemProgram.programId,isSigner:!1,isWritable:!1},{pubkey:t,isSigner:!1,isWritable:!1},{pubkey:y.SYSVAR_RENT_PUBKEY,isSigner:!1,isWritable:!1}];return new y.TransactionInstruction({keys:s,programId:e,data:a})}}]),e}()},792:function(e,t,r){var n=r(2307);e.exports=n("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz")},2812:function(e,t,r){var n=r(2307);e.exports=n("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz")},6322:function(e,t,r){"use strict";r.r(t),r.d(t,{Account:function(){return Vn},AddressLookupTableAccount:function(){return Ji},AddressLookupTableInstruction:function(){return Ka},AddressLookupTableProgram:function(){return Ga},Authorized:function(){return ns},BLOCKHASH_CACHE_TIMEOUT_MS:function(){return oo},BPF_LOADER_DEPRECATED_PROGRAM_ID:function(){return Wn},BPF_LOADER_PROGRAM_ID:function(){return Zi},BpfLoader:function(){return Fi},COMPUTE_BUDGET_INSTRUCTION_LAYOUTS:function(){return qa},ComputeBudgetInstruction:function(){return Ha},ComputeBudgetProgram:function(){return Ya},Connection:function(){return ja},Ed25519Program:function(){return Qa},Enum:function(){return zn},EpochSchedule:function(){return Hi},FeeCalculatorLayout:function(){return Pi},Keypair:function(){return Va},LAMPORTS_PER_SOL:function(){return Ts},LOOKUP_TABLE_INSTRUCTION_LAYOUTS:function(){return Wa},Loader:function(){return Ui},Lockup:function(){return is},MAX_SEED_LENGTH:function(){return Un},Message:function(){return si},MessageAccountKeys:function(){return Qn},MessageV0:function(){return ui},NONCE_ACCOUNT_LENGTH:function(){return Bi},NonceAccount:function(){return Di},PACKET_DATA_SIZE:function(){return Kn},PUBLIC_KEY_LENGTH:function(){return Zn},PublicKey:function(){return jn},SIGNATURE_LENGTH_IN_BYTES:function(){return Hn},SOLANA_SCHEMA:function(){return Nn},STAKE_CONFIG_ID:function(){return rs},STAKE_INSTRUCTION_LAYOUTS:function(){return as},SYSTEM_INSTRUCTION_LAYOUTS:function(){return Oi},SYSVAR_CLOCK_PUBKEY:function(){return mi},SYSVAR_EPOCH_SCHEDULE_PUBKEY:function(){return gi},SYSVAR_INSTRUCTIONS_PUBKEY:function(){return yi},SYSVAR_RECENT_BLOCKHASHES_PUBKEY:function(){return vi},SYSVAR_RENT_PUBKEY:function(){return _i},SYSVAR_REWARDS_PUBKEY:function(){return bi},SYSVAR_SLOT_HASHES_PUBKEY:function(){return xi},SYSVAR_SLOT_HISTORY_PUBKEY:function(){return wi},SYSVAR_STAKE_HISTORY_PUBKEY:function(){return ki},Secp256k1Program:function(){return ts},SendTransactionError:function(){return qi},SolanaJSONRPCError:function(){return Xi},SolanaJSONRPCErrorCode:function(){return Yi},StakeAuthorizationLayout:function(){return ss},StakeInstruction:function(){return os},StakeProgram:function(){return us},Struct:function(){return On},SystemInstruction:function(){return Li},SystemProgram:function(){return zi},Transaction:function(){return fi},TransactionExpiredBlockheightExceededError:function(){return qn},TransactionExpiredNonceInvalidError:function(){return Xn},TransactionExpiredTimeoutError:function(){return Yn},TransactionInstruction:function(){return hi},TransactionMessage:function(){return di},TransactionStatus:function(){return oi},VALIDATOR_INFO_KEY:function(){return ps},VERSION_PREFIX_MASK:function(){return Gn},VOTE_PROGRAM_ID:function(){return ys},ValidatorInfo:function(){return gs},VersionedMessage:function(){return ci},VersionedTransaction:function(){return pi},VoteAccount:function(){return _s},VoteAuthorizationLayout:function(){return fs},VoteInit:function(){return cs},VoteInstruction:function(){return ls},VoteProgram:function(){return ds},clusterApiUrl:function(){return As},sendAndConfirmRawTransaction:function(){return Es},sendAndConfirmTransaction:function(){return Ai}});var n=r(4925),i=r(1752),o=r(1120),a=r(1413),s=r(9439),u=r(3433),c=r(7762),l=r(8737),h=r(4165),f=r(5861),d=r(136),p=r(9388),m=r(5671),g=r(3144),y=r(8443);function v(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("Wrong positive integer: ".concat(e))}function _(e){if(!(e instanceof Uint8Array))throw new TypeError("Expected Uint8Array");for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];if(r.length>0&&!r.includes(e.length))throw new TypeError("Expected Uint8Array of length ".concat(r,", not of length=").concat(e.length))}var b={number:v,bool:function(e){if("boolean"!==typeof e)throw new Error("Expected boolean, not ".concat(e))},bytes:_,hash:function(e){if("function"!==typeof e||"function"!==typeof e.create)throw new Error("Hash should be wrapped by utils.wrapConstructor");v(e.outputLen),v(e.blockLen)},exists:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")},output:function(e,t){_(e);var r=t.outputLen;if(e.length<r)throw new Error("digestInto() expects output buffer of length at least ".concat(r))}},x=b,w=("object"===typeof self&&"crypto"in self&&self.crypto,function(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}),k=function(e,t){return e<<32-t|e>>>t};if(!(68===new Uint8Array(new Uint32Array([287454020]).buffer)[0]))throw new Error("Non little-endian hardware is not supported");Array.from({length:256},(function(e,t){return t.toString(16).padStart(2,"0")}));function A(e){if("string"===typeof e&&(e=function(e){if("string"!==typeof e)throw new TypeError("utf8ToBytes expected string, got ".concat(typeof e));return(new TextEncoder).encode(e)}(e)),!(e instanceof Uint8Array))throw new TypeError("Expected input type is Uint8Array (got ".concat(typeof e,")"));return e}var E=function(){function e(){(0,m.Z)(this,e)}return(0,g.Z)(e,[{key:"clone",value:function(){return this._cloneInto()}}]),e}();function S(e){var t=function(t){return e().update(A(t)).digest()},r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=function(){return e()},t}var T=function(e){(0,d.Z)(r,e);var t=(0,p.Z)(r);function r(e,n,i,o){var a;return(0,m.Z)(this,r),(a=t.call(this)).blockLen=e,a.outputLen=n,a.padOffset=i,a.isLE=o,a.finished=!1,a.length=0,a.pos=0,a.destroyed=!1,a.buffer=new Uint8Array(e),a.view=w(a.buffer),a}return(0,g.Z)(r,[{key:"update",value:function(e){x.exists(this);for(var t=this.view,r=this.buffer,n=this.blockLen,i=(e=A(e)).length,o=0;o<i;){var a=Math.min(n-this.pos,i-o);if(a!==n)r.set(e.subarray(o,o+a),this.pos),this.pos+=a,o+=a,this.pos===n&&(this.process(t,0),this.pos=0);else for(var s=w(e);n<=i-o;o+=n)this.process(s,o)}return this.length+=e.length,this.roundClean(),this}},{key:"digestInto",value:function(e){x.exists(this),x.output(e,this),this.finished=!0;var t=this.buffer,r=this.view,n=this.blockLen,i=this.isLE,o=this.pos;t[o++]=128,this.buffer.subarray(o).fill(0),this.padOffset>n-o&&(this.process(r,0),o=0);for(var a=o;a<n;a++)t[a]=0;!function(e,t,r,n){if("function"===typeof e.setBigUint64)return e.setBigUint64(t,r,n);var i=BigInt(32),o=BigInt(4294967295),a=Number(r>>i&o),s=Number(r&o),u=n?4:0,c=n?0:4;e.setUint32(t+u,a,n),e.setUint32(t+c,s,n)}(r,n-8,BigInt(8*this.length),i),this.process(r,0);var s=w(e),u=this.outputLen;if(u%4)throw new Error("_sha2: outputLen should be aligned to 32bit");var c=u/4,l=this.get();if(c>l.length)throw new Error("_sha2: outputLen bigger than state");for(var h=0;h<c;h++)s.setUint32(4*h,l[h],i)}},{key:"digest",value:function(){var e=this.buffer,t=this.outputLen;this.digestInto(e);var r=e.slice(0,t);return this.destroy(),r}},{key:"_cloneInto",value:function(e){var t;e||(e=new this.constructor),(t=e).set.apply(t,(0,u.Z)(this.get()));var r=this.blockLen,n=this.buffer,i=this.length,o=this.finished,a=this.destroyed,s=this.pos;return e.length=i,e.pos=s,e.finished=o,e.destroyed=a,i%r&&e.buffer.set(n),e}}]),r}(E),M=BigInt(Math.pow(2,32)-1),I=BigInt(32);function P(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]?{h:Number(e&M),l:Number(e>>I&M)}:{h:0|Number(e>>I&M),l:0|Number(e&M)}}var C={fromBig:P,split:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=new Uint32Array(e.length),n=new Uint32Array(e.length),i=0;i<e.length;i++){var o=P(e[i],t),a=[o.h,o.l];r[i]=a[0],n[i]=a[1]}return[r,n]},toBig:function(e,t){return BigInt(e>>>0)<<I|BigInt(t>>>0)},shrSH:function(e,t,r){return e>>>r},shrSL:function(e,t,r){return e<<32-r|t>>>r},rotrSH:function(e,t,r){return e>>>r|t<<32-r},rotrSL:function(e,t,r){return e<<32-r|t>>>r},rotrBH:function(e,t,r){return e<<64-r|t>>>r-32},rotrBL:function(e,t,r){return e>>>r-32|t<<64-r},rotr32H:function(e,t){return t},rotr32L:function(e,t){return e},rotlSH:function(e,t,r){return e<<r|t>>>32-r},rotlSL:function(e,t,r){return t<<r|e>>>32-r},rotlBH:function(e,t,r){return t<<r-32|e>>>64-r},rotlBL:function(e,t,r){return e<<r-32|t>>>64-r},add:function(e,t,r,n){var i=(t>>>0)+(n>>>0);return{h:e+r+(i/Math.pow(2,32)|0)|0,l:0|i}},add3L:function(e,t,r){return(e>>>0)+(t>>>0)+(r>>>0)},add3H:function(e,t,r,n){return t+r+n+(e/Math.pow(2,32)|0)|0},add4L:function(e,t,r,n){return(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0)},add4H:function(e,t,r,n,i){return t+r+n+i+(e/Math.pow(2,32)|0)|0},add5H:function(e,t,r,n,i,o){return t+r+n+i+o+(e/Math.pow(2,32)|0)|0},add5L:function(e,t,r,n,i){return(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0)+(i>>>0)}},B=C,D=B.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map((function(e){return BigInt(e)}))),R=(0,s.Z)(D,2),L=R[0],O=R[1],z=new Uint32Array(80),N=new Uint32Array(80),U=function(e){(0,d.Z)(r,e);var t=(0,p.Z)(r);function r(){var e;return(0,m.Z)(this,r),(e=t.call(this,128,64,16,!1)).Ah=1779033703,e.Al=-205731576,e.Bh=-1150833019,e.Bl=-2067093701,e.Ch=1013904242,e.Cl=-23791573,e.Dh=-1521486534,e.Dl=1595750129,e.Eh=1359893119,e.El=-1377402159,e.Fh=-1694144372,e.Fl=725511199,e.Gh=528734635,e.Gl=-79577749,e.Hh=1541459225,e.Hl=327033209,e}return(0,g.Z)(r,[{key:"get",value:function(){return[this.Ah,this.Al,this.Bh,this.Bl,this.Ch,this.Cl,this.Dh,this.Dl,this.Eh,this.El,this.Fh,this.Fl,this.Gh,this.Gl,this.Hh,this.Hl]}},{key:"set",value:function(e,t,r,n,i,o,a,s,u,c,l,h,f,d,p,m){this.Ah=0|e,this.Al=0|t,this.Bh=0|r,this.Bl=0|n,this.Ch=0|i,this.Cl=0|o,this.Dh=0|a,this.Dl=0|s,this.Eh=0|u,this.El=0|c,this.Fh=0|l,this.Fl=0|h,this.Gh=0|f,this.Gl=0|d,this.Hh=0|p,this.Hl=0|m}},{key:"process",value:function(e,t){for(var r=0;r<16;r++,t+=4)z[r]=e.getUint32(t),N[r]=e.getUint32(t+=4);for(var n=16;n<80;n++){var i=0|z[n-15],o=0|N[n-15],a=B.rotrSH(i,o,1)^B.rotrSH(i,o,8)^B.shrSH(i,o,7),s=B.rotrSL(i,o,1)^B.rotrSL(i,o,8)^B.shrSL(i,o,7),u=0|z[n-2],c=0|N[n-2],l=B.rotrSH(u,c,19)^B.rotrBH(u,c,61)^B.shrSH(u,c,6),h=B.rotrSL(u,c,19)^B.rotrBL(u,c,61)^B.shrSL(u,c,6),f=B.add4L(s,h,N[n-7],N[n-16]),d=B.add4H(f,a,l,z[n-7],z[n-16]);z[n]=0|d,N[n]=0|f}for(var p=this.Ah,m=this.Al,g=this.Bh,y=this.Bl,v=this.Ch,_=this.Cl,b=this.Dh,x=this.Dl,w=this.Eh,k=this.El,A=this.Fh,E=this.Fl,S=this.Gh,T=this.Gl,M=this.Hh,I=this.Hl,P=0;P<80;P++){var C=B.rotrSH(w,k,14)^B.rotrSH(w,k,18)^B.rotrBH(w,k,41),D=B.rotrSL(w,k,14)^B.rotrSL(w,k,18)^B.rotrBL(w,k,41),R=w&A^~w&S,U=k&E^~k&T,Z=B.add5L(I,D,U,O[P],N[P]),F=B.add5H(Z,M,C,R,L[P],z[P]),j=0|Z,V=B.rotrSH(p,m,28)^B.rotrBH(p,m,34)^B.rotrBH(p,m,39),W=B.rotrSL(p,m,28)^B.rotrBL(p,m,34)^B.rotrBL(p,m,39),K=p&g^p&v^g&v,G=m&y^m&_^y&_;M=0|S,I=0|T,S=0|A,T=0|E,A=0|w,E=0|k;var H=B.add(0|b,0|x,0|F,0|j);w=H.h,k=H.l,b=0|v,x=0|_,v=0|g,_=0|y,g=0|p,y=0|m;var q=B.add3L(j,W,G);p=B.add3H(q,F,V,K),m=0|q}var Y=B.add(0|this.Ah,0|this.Al,0|p,0|m);p=Y.h,m=Y.l;var X=B.add(0|this.Bh,0|this.Bl,0|g,0|y);g=X.h,y=X.l;var Q=B.add(0|this.Ch,0|this.Cl,0|v,0|_);v=Q.h,_=Q.l;var $=B.add(0|this.Dh,0|this.Dl,0|b,0|x);b=$.h,x=$.l;var J=B.add(0|this.Eh,0|this.El,0|w,0|k);w=J.h,k=J.l;var ee=B.add(0|this.Fh,0|this.Fl,0|A,0|E);A=ee.h,E=ee.l;var te=B.add(0|this.Gh,0|this.Gl,0|S,0|T);S=te.h,T=te.l;var re=B.add(0|this.Hh,0|this.Hl,0|M,0|I);M=re.h,I=re.l,this.set(p,m,g,y,v,_,b,x,w,k,A,E,S,T,M,I)}},{key:"roundClean",value:function(){z.fill(0),N.fill(0)}},{key:"destroy",value:function(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}]),r}(T),Z=function(e){(0,d.Z)(r,e);var t=(0,p.Z)(r);function r(){var e;return(0,m.Z)(this,r),(e=t.call(this)).Ah=-1942145080,e.Al=424955298,e.Bh=1944164710,e.Bl=-1982016298,e.Ch=502970286,e.Cl=855612546,e.Dh=1738396948,e.Dl=1479516111,e.Eh=258812777,e.El=2077511080,e.Fh=2011393907,e.Fl=79989058,e.Gh=1067287976,e.Gl=1780299464,e.Hh=286451373,e.Hl=-1848208735,e.outputLen=28,e}return(0,g.Z)(r)}(U),F=function(e){(0,d.Z)(r,e);var t=(0,p.Z)(r);function r(){var e;return(0,m.Z)(this,r),(e=t.call(this)).Ah=573645204,e.Al=-64227540,e.Bh=-1621794909,e.Bl=-934517566,e.Ch=596883563,e.Cl=1867755857,e.Dh=-1774684391,e.Dl=1497426621,e.Eh=-1775747358,e.El=-1467023389,e.Fh=-1101128155,e.Fl=1401305490,e.Gh=721525244,e.Gl=746961066,e.Hh=246885852,e.Hl=-2117784414,e.outputLen=32,e}return(0,g.Z)(r)}(U),j=function(e){(0,d.Z)(r,e);var t=(0,p.Z)(r);function r(){var e;return(0,m.Z)(this,r),(e=t.call(this)).Ah=-876896931,e.Al=-1056596264,e.Bh=1654270250,e.Bl=914150663,e.Ch=-1856437926,e.Cl=812702999,e.Dh=355462360,e.Dl=-150054599,e.Eh=1731405415,e.El=-4191439,e.Fh=-1900787065,e.Fl=1750603025,e.Gh=-619958771,e.Gl=1694076839,e.Hh=1203062813,e.Hl=-1090891868,e.outputLen=48,e}return(0,g.Z)(r)}(U),V=S((function(){return new U})),W=(S((function(){return new Z})),S((function(){return new F})),S((function(){return new j})),r(7420)),K=r.t(W,2),G=BigInt(0),H=BigInt(1),q=BigInt(2),Y=BigInt(8),X=BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),Q=Object.freeze({a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),P:BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),l:X,n:X,h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960")}),$=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000"),J=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),ee=(BigInt("6853475219497561581579357271197624642482790079785650197046958215289687604742"),BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235")),te=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),re=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),ne=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952"),ie=function(){function e(t,r,n,i){(0,m.Z)(this,e),this.x=t,this.y=r,this.z=n,this.t=i}return(0,g.Z)(e,[{key:"equals",value:function(e){ae(e);var t=this.x,r=this.y,n=this.z,i=e.x,o=e.y,a=e.z,s=Ae(t*a),u=Ae(i*n),c=Ae(r*a),l=Ae(o*n);return s===u&&c===l}},{key:"negate",value:function(){return new e(Ae(-this.x),this.y,this.z,Ae(-this.t))}},{key:"double",value:function(){var t=this.x,r=this.y,n=this.z,i=Q.a,o=Ae(t*t),a=Ae(r*r),s=Ae(q*Ae(n*n)),u=Ae(i*o),c=t+r,l=Ae(Ae(c*c)-o-a),h=u+a,f=h-s,d=u-a,p=Ae(l*f),m=Ae(h*d),g=Ae(l*d);return new e(p,m,Ae(f*h),g)}},{key:"add",value:function(t){ae(t);var r=this.x,n=this.y,i=this.z,o=this.t,a=t.x,s=t.y,u=t.z,c=t.t,l=Ae((n-r)*(s+a)),h=Ae((n+r)*(s-a)),f=Ae(h-l);if(f===G)return this.double();var d=Ae(i*q*c),p=Ae(o*q*u),m=p+d,g=h+l,y=p-d,v=Ae(m*f),_=Ae(g*y),b=Ae(m*y);return new e(v,_,Ae(f*g),b)}},{key:"subtract",value:function(e){return this.add(e.negate())}},{key:"precomputeWindow",value:function(e){for(var t=1+256/e,r=[],n=this,i=n,o=0;o<t;o++){i=n,r.push(i);for(var a=1;a<Math.pow(2,e-1);a++)i=i.add(n),r.push(i);n=i.double()}return r}},{key:"wNAF",value:function(t,r){!r&&this.equals(e.BASE)&&(r=he.BASE);var n=r&&r._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");var i=r&&le.get(r);i||(i=this.precomputeWindow(n),r&&1!==n&&(i=e.normalizeZ(i),le.set(r,i)));for(var o=e.ZERO,a=e.BASE,s=1+256/n,u=Math.pow(2,n-1),c=BigInt(Math.pow(2,n)-1),l=Math.pow(2,n),h=BigInt(n),f=0;f<s;f++){var d=f*u,p=Number(t&c);t>>=h,p>u&&(p-=l,t+=H);var m=d,g=d+Math.abs(p)-1,y=f%2!==0,v=p<0;0===p?a=a.add(oe(y,i[m])):o=o.add(oe(v,i[g]))}return e.normalizeZ([o,a])[0]}},{key:"multiply",value:function(e,t){return this.wNAF(Be(e,Q.l),t)}},{key:"multiplyUnsafe",value:function(t){var r=Be(t,Q.l,!1),n=e.BASE,i=e.ZERO;if(r===G)return i;if(this.equals(i)||r===H)return this;if(this.equals(n))return this.wNAF(r);for(var o=i,a=this;r>G;)r&H&&(o=o.add(a)),a=a.double(),r>>=H;return o}},{key:"isSmallOrder",value:function(){return this.multiplyUnsafe(Q.h).equals(e.ZERO)}},{key:"isTorsionFree",value:function(){var t=this.multiplyUnsafe(Q.l/q).double();return Q.l%q&&(t=t.add(this)),t.equals(e.ZERO)}},{key:"toAffine",value:function(t){var r=this.x,n=this.y,i=this.z,o=this.equals(e.ZERO);null==t&&(t=o?Y:Ee(i));var a=Ae(r*t),s=Ae(n*t),u=Ae(i*t);if(o)return he.ZERO;if(u!==H)throw new Error("invZ was invalid");return new he(a,s)}},{key:"fromRistrettoBytes",value:function(){ue()}},{key:"toRistrettoBytes",value:function(){ue()}},{key:"fromRistrettoHash",value:function(){ue()}}],[{key:"fromAffine",value:function(t){if(!(t instanceof he))throw new TypeError("ExtendedPoint#fromAffine: expected Point");return t.equals(he.ZERO)?e.ZERO:new e(t.x,t.y,H,Ae(t.x*t.y))}},{key:"toAffineBatch",value:function(e){var t=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Q.P,r=new Array(e.length),n=Ee(e.reduce((function(e,n,i){return n===G?e:(r[i]=e,Ae(e*n,t))}),H),t);return e.reduceRight((function(e,n,i){return n===G?e:(r[i]=Ae(e*r[i],t),Ae(e*n,t))}),n),r}(e.map((function(e){return e.z})));return e.map((function(e,r){return e.toAffine(t[r])}))}},{key:"normalizeZ",value:function(e){return this.toAffineBatch(e).map(this.fromAffine)}}]),e}();function oe(e,t){var r=t.negate();return e?r:t}function ae(e){if(!(e instanceof ie))throw new TypeError("ExtendedPoint expected")}function se(e){if(!(e instanceof ce))throw new TypeError("RistrettoPoint expected")}function ue(){throw new Error("Legacy method: switch to RistrettoPoint")}ie.BASE=new ie(Q.Gx,Q.Gy,H,Ae(Q.Gx*Q.Gy)),ie.ZERO=new ie(G,H,H,G);var ce=function(){function e(t){(0,m.Z)(this,e),this.ep=t}return(0,g.Z)(e,[{key:"toRawBytes",value:function(){var e,t=this.ep,r=t.x,n=t.y,i=t.z,o=t.t,a=Ae(Ae(i+n)*Ae(i-n)),s=Ae(r*n),u=Ae(s*s),c=Ie(Ae(a*u)).value,l=Ae(c*a),h=Ae(c*s),f=Ae(l*h*o);if(_e(o*f)){var d=Ae(n*J),p=Ae(r*J);r=d,n=p,e=Ae(l*te)}else e=h;_e(r*f)&&(n=Ae(-n));var m=Ae((i-n)*e);return _e(m)&&(m=Ae(-m)),ve(m)}},{key:"toHex",value:function(){return me(this.toRawBytes())}},{key:"toString",value:function(){return this.toHex()}},{key:"equals",value:function(e){se(e);var t=this.ep,r=e.ep,n=Ae(t.x*r.y)===Ae(t.y*r.x),i=Ae(t.y*r.y)===Ae(t.x*r.x);return n||i}},{key:"add",value:function(t){return se(t),new e(this.ep.add(t.ep))}},{key:"subtract",value:function(t){return se(t),new e(this.ep.subtract(t.ep))}},{key:"multiply",value:function(t){return new e(this.ep.multiply(t))}},{key:"multiplyUnsafe",value:function(t){return new e(this.ep.multiplyUnsafe(t))}}],[{key:"calcElligatorRistrettoMap",value:function(e){var t=Q.d,r=Ae(J*e*e),n=Ae((r+H)*re),i=BigInt(-1),o=Ae((i-t*r)*Ae(r+t)),a=Me(n,o),s=a.isValid,u=a.value,c=Ae(u*e);_e(c)||(c=Ae(-c)),s||(u=c),s||(i=r);var l=Ae(i*(r-H)*ne-o),h=u*u,f=Ae((u+u)*o),d=Ae(l*ee),p=Ae(H-h),m=Ae(H+h);return new ie(Ae(f*m),Ae(p*d),Ae(d*m),Ae(f*p))}},{key:"hashToCurve",value:function(t){var r=ke((t=Ce(t,64)).slice(0,32)),n=this.calcElligatorRistrettoMap(r),i=ke(t.slice(32,64)),o=this.calcElligatorRistrettoMap(i);return new e(n.add(o))}},{key:"fromHex",value:function(t){t=Ce(t,32);var r=Q.a,n=Q.d,i="RistrettoPoint.fromHex: the hex is not valid encoding of RistrettoPoint",o=ke(t);if(!function(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}(ve(o),t)||_e(o))throw new Error(i);var a=Ae(o*o),s=Ae(H+r*a),u=Ae(H-r*a),c=Ae(s*s),l=Ae(u*u),h=Ae(r*n*c-l),f=Ie(Ae(h*l)),d=f.isValid,p=f.value,m=Ae(p*u),g=Ae(p*m*h),y=Ae((o+o)*m);_e(y)&&(y=Ae(-y));var v=Ae(s*g),_=Ae(y*v);if(!d||_e(_)||v===G)throw new Error(i);return new e(new ie(y,v,H,_))}}]),e}();ce.BASE=new ce(ie.BASE),ce.ZERO=new ce(ie.ZERO);var le=new WeakMap,he=function(){function e(t,r){(0,m.Z)(this,e),this.x=t,this.y=r}return(0,g.Z)(e,[{key:"_setWindowSize",value:function(e){this._WINDOW_SIZE=e,le.delete(this)}},{key:"toRawBytes",value:function(){var e=ve(this.y);return e[31]|=this.x&H?128:0,e}},{key:"toHex",value:function(){return me(this.toRawBytes())}},{key:"toX25519",value:function(){var e=this.y;return ve(Ae((H+e)*Ee(H-e)))}},{key:"isTorsionFree",value:function(){return ie.fromAffine(this).isTorsionFree()}},{key:"equals",value:function(e){return this.x===e.x&&this.y===e.y}},{key:"negate",value:function(){return new e(Ae(-this.x),this.y)}},{key:"add",value:function(e){return ie.fromAffine(this).add(ie.fromAffine(e)).toAffine()}},{key:"subtract",value:function(e){return this.add(e.negate())}},{key:"multiply",value:function(e){return ie.fromAffine(this).multiply(e,this).toAffine()}}],[{key:"fromHex",value:function(t){var r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=Q.d,i=Q.P,o=(t=Ce(t,32)).slice();o[31]=-129&t[31];var a=be(o);if(r&&a>=i)throw new Error("Expected 0 < hex < P");if(!r&&a>=$)throw new Error("Expected 0 < hex < 2**256");var s=Ae(a*a),u=Me(Ae(s-H),Ae(n*s+H)),c=u.isValid,l=u.value;if(!c)throw new Error("Point.fromHex: invalid y coordinate");var h=(l&H)===H;return 0!==(128&t[31])!==h&&(l=Ae(-l)),new e(l,a)}},{key:"fromPrivateKey",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t){return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ze(t);case 2:return e.abrupt("return",e.sent.point);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}();he.BASE=new he(Q.Gx,Q.Gy),he.ZERO=new he(G,H);var fe=function(){function e(t,r){(0,m.Z)(this,e),this.r=t,this.s=r,this.assertValidity()}return(0,g.Z)(e,[{key:"assertValidity",value:function(){var e=this.r,t=this.s;if(!(e instanceof he))throw new Error("Expected Point instance");return Be(t,Q.l,!1),this}},{key:"toRawBytes",value:function(){var e=new Uint8Array(64);return e.set(this.r.toRawBytes()),e.set(ve(this.s),32),e}},{key:"toHex",value:function(){return me(this.toRawBytes())}}],[{key:"fromHex",value:function(t){var r=Ce(t,64);return new e(he.fromHex(r.slice(0,32),!1),be(r.slice(32,64)))}}]),e}();function de(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];if(!t.every((function(e){return e instanceof Uint8Array})))throw new Error("Expected Uint8Array list");if(1===t.length)return t[0];for(var n=t.reduce((function(e,t){return e+t.length}),0),i=new Uint8Array(n),o=0,a=0;o<t.length;o++){var s=t[o];i.set(s,a),a+=s.length}return i}var pe=Array.from({length:256},(function(e,t){return t.toString(16).padStart(2,"0")}));function me(e){if(!(e instanceof Uint8Array))throw new Error("Uint8Array expected");for(var t="",r=0;r<e.length;r++)t+=pe[e[r]];return t}function ge(e){if("string"!==typeof e)throw new TypeError("hexToBytes: expected string, got "+typeof e);if(e.length%2)throw new Error("hexToBytes: received invalid unpadded hex");for(var t=new Uint8Array(e.length/2),r=0;r<t.length;r++){var n=2*r,i=e.slice(n,n+2),o=Number.parseInt(i,16);if(Number.isNaN(o)||o<0)throw new Error("Invalid byte sequence");t[r]=o}return t}function ye(e){return ge(e.toString(16).padStart(64,"0"))}function ve(e){return ye(e).reverse()}function _e(e){return(Ae(e)&H)===H}function be(e){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");return BigInt("0x"+me(Uint8Array.from(e).reverse()))}var xe,we=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");function ke(e){return Ae(be(e)&we)}function Ae(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Q.P,r=e%t;return r>=G?r:t+r}function Ee(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Q.P;if(e===G||t<=G)throw new Error("invert: expected positive integers, got n=".concat(e," mod=").concat(t));for(var r=Ae(e,t),n=t,i=G,o=H,a=H,s=G;r!==G;){var u=n/r,c=n%r,l=i-a*u,h=o-s*u;n=r,r=c,i=a,o=s,a=l,s=h}if(n!==H)throw new Error("invert: does not exist");return Ae(i,t)}function Se(e,t){for(var r=Q.P,n=e;t-- >G;)n*=n,n%=r;return n}function Te(e){var t=Q.P,r=BigInt(5),n=BigInt(10),i=BigInt(20),o=BigInt(40),a=BigInt(80),s=e*e%t*e%t,u=Se(s,q)*s%t,c=Se(u,H)*e%t,l=Se(c,r)*c%t,h=Se(l,n)*l%t,f=Se(h,i)*h%t,d=Se(f,o)*f%t,p=Se(d,a)*d%t,m=Se(p,a)*d%t,g=Se(m,n)*l%t;return{pow_p_5_8:Se(g,q)*e%t,b2:s}}function Me(e,t){var r=Ae(t*t*t),n=Ae(r*r*t),i=Ae(e*r*Te(e*n).pow_p_5_8),o=Ae(t*i*i),a=i,s=Ae(i*J),u=o===e,c=o===Ae(-e),l=o===Ae(-e*J);return u&&(i=a),(c||l)&&(i=s),_e(i)&&(i=Ae(-i)),{isValid:u||c,value:i}}function Ie(e){return Me(H,e)}function Pe(e){return Ae(be(e),Q.l)}function Ce(e,t){var r=e instanceof Uint8Array?Uint8Array.from(e):ge(e);if("number"===typeof t&&r.length!==t)throw new Error("Expected ".concat(t," bytes"));return r}function Be(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!t)throw new TypeError("Specify max value");if("number"===typeof e&&Number.isSafeInteger(e)&&(e=BigInt(e)),"bigint"===typeof e&&e<t)if(r){if(G<e)return e}else if(G<=e)return e;throw new TypeError("Expected valid scalar: 0 < scalar < max")}function De(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}function Re(e){if(32!==(e="bigint"===typeof e||"number"===typeof e?ye(Be(e,$)):Ce(e)).length)throw new Error("Expected 32 bytes");return e}function Le(e){var t=De(e.slice(0,32)),r=e.slice(32,64),n=Pe(t),i=he.BASE.multiply(n),o=i.toRawBytes();return{head:t,prefix:r,scalar:n,point:i,pointBytes:o}}function Oe(){if("function"!==typeof xe)throw new Error("utils.sha512Sync must be set to use sync methods");return xe.apply(void 0,arguments)}function ze(e){return Ne.apply(this,arguments)}function Ne(){return(Ne=(0,f.Z)((0,h.Z)().mark((function e(t){return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=Le,e.next=3,We.sha512(Re(t));case 3:return e.t1=e.sent,e.abrupt("return",(0,e.t0)(e.t1));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ue(e){return Le(Oe(Re(e)))}function Ze(e,t,r){t=Ce(t),r instanceof he||(r=he.fromHex(r,!1));var n=e instanceof fe?e.assertValidity():fe.fromHex(e),i=n.r,o=n.s;return{r:i,s:o,SB:ie.BASE.multiplyUnsafe(o),pub:r,msg:t}}function Fe(e,t,r,n){var i=Pe(n),o=ie.fromAffine(e).multiplyUnsafe(i);return ie.fromAffine(t).add(o).subtract(r).multiplyUnsafe(Q.h).equals(ie.ZERO)}var je={getExtendedPublicKey:Ue,getPublicKey:function(e){return Ue(e).pointBytes},sign:function(e,t){e=Ce(e);var r=Ue(t),n=r.prefix,i=r.scalar,o=r.pointBytes,a=Pe(Oe(n,e)),s=he.BASE.multiply(a),u=Ae(a+Pe(Oe(s.toRawBytes(),o,e))*i,Q.l);return new fe(s,u).toRawBytes()},verify:function(e,t,r){var n=Ze(e,t,r),i=n.r,o=n.SB,a=n.msg,s=n.pub,u=Oe(i.toRawBytes(),s.toRawBytes(),a);return Fe(s,i,o,u)}};he.BASE._setWindowSize(8);var Ve={node:K,web:"object"===typeof self&&"crypto"in self?self.crypto:void 0},We={bytesToHex:me,hexToBytes:ge,concatBytes:de,getExtendedPublicKey:ze,mod:Ae,invert:Ee,TORSION_SUBGROUP:["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"],hashToPrivateScalar:function(e){if((e=Ce(e)).length<40||e.length>1024)throw new Error("Expected 40-1024 bytes of private key as per FIPS 186");return Ae(be(e),Q.l-H)+H},randomBytes:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32;if(Ve.web)return Ve.web.getRandomValues(new Uint8Array(e));if(Ve.node){var t=Ve.node.randomBytes;return new Uint8Array(t(e).buffer)}throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:function(){return We.randomBytes(32)},sha512:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(){var t,r,n=arguments;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=de.apply(void 0,n),!Ve.web){e.next=8;break}return e.next=4,Ve.web.subtle.digest("SHA-512",t.buffer);case 4:return r=e.sent,e.abrupt("return",new Uint8Array(r));case 8:if(!Ve.node){e.next=12;break}return e.abrupt("return",Uint8Array.from(Ve.node.createHash("sha512").update(t).digest()));case 12:throw new Error("The environment doesn't have sha512 function");case 13:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),precompute:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:he.BASE,r=t.equals(he.BASE)?t:new he(t.x,t.y);return r._setWindowSize(e),r.multiply(q),r},sha512Sync:void 0};Object.defineProperties(We,{sha512Sync:{configurable:!1,get:function(){return xe},set:function(e){xe||(xe=e)}}});var Ke=r(518),Ge=r.n(Ke),He=r(7189),qe=r.n(He),Ye=function(e,t,r){return e&t^e&r^t&r},Xe=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Qe=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),$e=new Uint32Array(64),Je=function(e){(0,d.Z)(r,e);var t=(0,p.Z)(r);function r(){var e;return(0,m.Z)(this,r),(e=t.call(this,64,32,8,!1)).A=0|Qe[0],e.B=0|Qe[1],e.C=0|Qe[2],e.D=0|Qe[3],e.E=0|Qe[4],e.F=0|Qe[5],e.G=0|Qe[6],e.H=0|Qe[7],e}return(0,g.Z)(r,[{key:"get",value:function(){return[this.A,this.B,this.C,this.D,this.E,this.F,this.G,this.H]}},{key:"set",value:function(e,t,r,n,i,o,a,s){this.A=0|e,this.B=0|t,this.C=0|r,this.D=0|n,this.E=0|i,this.F=0|o,this.G=0|a,this.H=0|s}},{key:"process",value:function(e,t){for(var r=0;r<16;r++,t+=4)$e[r]=e.getUint32(t,!1);for(var n=16;n<64;n++){var i=$e[n-15],o=$e[n-2],a=k(i,7)^k(i,18)^i>>>3,s=k(o,17)^k(o,19)^o>>>10;$e[n]=s+$e[n-7]+a+$e[n-16]|0}for(var u,c=this.A,l=this.B,h=this.C,f=this.D,d=this.E,p=this.F,m=this.G,g=this.H,y=0;y<64;y++){var v=g+(k(d,6)^k(d,11)^k(d,25))+((u=d)&p^~u&m)+Xe[y]+$e[y]|0,_=(k(c,2)^k(c,13)^k(c,22))+Ye(c,l,h)|0;g=m,m=p,p=d,d=f+v|0,f=h,h=l,l=c,c=v+_|0}c=c+this.A|0,l=l+this.B|0,h=h+this.C|0,f=f+this.D|0,d=d+this.E|0,p=p+this.F|0,m=m+this.G|0,g=g+this.H|0,this.set(c,l,h,f,d,p,m,g)}},{key:"roundClean",value:function(){$e.fill(0)}},{key:"destroy",value:function(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}]),r}(T),et=function(e){(0,d.Z)(r,e);var t=(0,p.Z)(r);function r(){var e;return(0,m.Z)(this,r),(e=t.call(this)).A=-1056596264,e.B=914150663,e.C=812702999,e.D=-150054599,e.E=-4191439,e.F=1750603025,e.G=1694076839,e.H=-1090891868,e.outputLen=28,e}return(0,g.Z)(r)}(Je),tt=S((function(){return new Je})),rt=(S((function(){return new et})),r(9876)),nt=r(2576),it=r(6070),ot=r(3878),at=r(9199),st=r(181),ut=r(5267);var ct=r(7326),lt=["message"],ht=(0,h.Z)().mark(yt),ft=function(e){(0,d.Z)(r,e);var t=(0,p.Z)(r);function r(e,i){var o,a;(0,m.Z)(this,r);var s=e.message,c=(0,n.Z)(e,lt),l=e.path,h=0===l.length?s:"At path: "+l.join(".")+" -- "+s;return o=t.call(this,h),Object.assign((0,ct.Z)(o),c),o.name=o.constructor.name,o.failures=function(){var t;return null!=(t=a)?t:a=[e].concat((0,u.Z)(i()))},o}return(0,g.Z)(r)}((0,l.Z)(TypeError));function dt(e){return pt(e)&&"function"===typeof e[Symbol.iterator]}function pt(e){return"object"===typeof e&&null!=e}function mt(e){return"string"===typeof e?JSON.stringify(e):""+e}function gt(e,t,r,n){if(!0!==e){!1===e?e={}:"string"===typeof e&&(e={message:e});var i=t.path,o=t.branch,s=r.type,u=e,c=u.refinement,l=u.message,h=void 0===l?"Expected a value of type `"+s+"`"+(c?" with refinement `"+c+"`":"")+", but received: `"+mt(n)+"`":l;return(0,a.Z)((0,a.Z)({value:n,type:s,refinement:c,key:i[i.length-1],path:i,branch:o},e),{},{message:h})}}function yt(e,t,r,n){var i,o,a,s;return(0,h.Z)().wrap((function(u){for(;;)switch(u.prev=u.next){case 0:dt(e)||(e=[e]),i=(0,c.Z)(e),u.prev=2,i.s();case 4:if((o=i.n()).done){u.next=12;break}if(a=o.value,!(s=gt(a,t,r,n))){u.next=10;break}return u.next=10,s;case 10:u.next=4;break;case 12:u.next=17;break;case 14:u.prev=14,u.t0=u.catch(2),i.e(u.t0);case 17:return u.prev=17,i.f(),u.finish(17);case 20:case"end":return u.stop()}}),ht,null,[[2,14,17,20]])}function vt(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return(0,h.Z)().mark((function n(){var i,o,a,l,f,d,p,m,g,y,v,_,b,x,w,k,A,E,S,T,M,I,P,C,B,D,R;return(0,h.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(i=r.path,o=void 0===i?[]:i,a=r.branch,l=void 0===a?[e]:a,f=r.coerce,d=void 0!==f&&f,p=r.mask,m=void 0!==p&&p,g={path:o,branch:l},d&&(e=t.coercer(e,g),m&&"type"!==t.type&&pt(t.schema)&&pt(e)&&!Array.isArray(e)))for(y in e)void 0===t.schema[y]&&delete e[y];v=!0,_=(0,c.Z)(t.validator(e,g)),n.prev=5,_.s();case 7:if((b=_.n()).done){n.next=14;break}return x=b.value,v=!1,n.next=12,[x,void 0];case 12:n.next=7;break;case 14:n.next=19;break;case 16:n.prev=16,n.t0=n.catch(5),_.e(n.t0);case 19:return n.prev=19,_.f(),n.finish(19);case 22:w=(0,c.Z)(t.entries(e,g)),n.prev=23,w.s();case 25:if((k=w.n()).done){n.next=52;break}A=(0,s.Z)(k.value,3),E=A[0],S=A[1],T=A[2],M=vt(S,T,{path:void 0===E?o:[].concat((0,u.Z)(o),[E]),branch:void 0===E?l:[].concat((0,u.Z)(l),[S]),coerce:d,mask:m}),I=(0,c.Z)(M),n.prev=29,I.s();case 31:if((P=I.n()).done){n.next=42;break}if(!(C=P.value)[0]){n.next=39;break}return v=!1,n.next=37,[C[0],void 0];case 37:n.next=40;break;case 39:d&&(S=C[1],void 0===E?e=S:e instanceof Map?e.set(E,S):e instanceof Set?e.add(S):pt(e)&&(e[E]=S));case 40:n.next=31;break;case 42:n.next=47;break;case 44:n.prev=44,n.t1=n.catch(29),I.e(n.t1);case 47:return n.prev=47,I.f(),n.finish(47);case 50:n.next=25;break;case 52:n.next=57;break;case 54:n.prev=54,n.t2=n.catch(23),w.e(n.t2);case 57:return n.prev=57,w.f(),n.finish(57);case 60:if(!v){n.next=79;break}B=(0,c.Z)(t.refiner(e,g)),n.prev=62,B.s();case 64:if((D=B.n()).done){n.next=71;break}return R=D.value,v=!1,n.next=69,[R,void 0];case 69:n.next=64;break;case 71:n.next=76;break;case 73:n.prev=73,n.t3=n.catch(62),B.e(n.t3);case 76:return n.prev=76,B.f(),n.finish(76);case 79:if(!v){n.next=82;break}return n.next=82,[void 0,e];case 82:case"end":return n.stop()}}),n,null,[[5,16,19,22],[23,54,57,60],[29,44,47,50],[62,73,76,79]])}))()}var _t=function(){function e(t){var r=this;(0,m.Z)(this,e);var n=t.type,i=t.schema,o=t.validator,a=t.refiner,s=t.coercer,u=void 0===s?function(e){return e}:s,c=t.entries,l=void 0===c?(0,h.Z)().mark((function e(){return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})):c;this.type=n,this.schema=i,this.entries=l,this.coercer=u,this.validator=o?function(e,t){return yt(o(e,t),t,r,e)}:function(){return[]},this.refiner=a?function(e,t){return yt(a(e,t),t,r,e)}:function(){return[]}}return(0,g.Z)(e,[{key:"assert",value:function(e){return bt(e,this)}},{key:"create",value:function(e){return xt(e,this)}},{key:"is",value:function(e){return wt(e,this)}},{key:"mask",value:function(e){return function(e,t){var r=kt(e,t,{coerce:!0,mask:!0});if(r[0])throw r[0];return r[1]}(e,this)}},{key:"validate",value:function(e){return kt(e,this,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}}]),e}();function bt(e,t){var r=kt(e,t);if(r[0])throw r[0]}function xt(e,t){var r=kt(e,t,{coerce:!0});if(r[0])throw r[0];return r[1]}function wt(e,t){return!kt(e,t)[0]}function kt(e,t){var r=vt(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}),n=function(e){var t=e.next(),r=t.done,n=t.value;return r?void 0:n}(r);if(n[0]){var i=new ft(n[0],(0,h.Z)().mark((function e(){var t,n,i;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=(0,c.Z)(r),e.prev=1,t.s();case 3:if((n=t.n()).done){e.next=10;break}if(!(i=n.value)[0]){e.next=8;break}return e.next=8,i[0];case 8:e.next=3;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),t.e(e.t0);case 15:return e.prev=15,t.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,null,[[1,12,15,18]])})));return[i,void 0]}return[void 0,n[1]]}function At(e,t){return new _t({type:e,schema:null,validator:t})}function Et(e){return new _t({type:"array",schema:e,entries:(0,h.Z)().mark((function t(r){var n,i,o,a,u;return(0,h.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e||!Array.isArray(r)){t.next=18;break}n=(0,c.Z)(r.entries()),t.prev=2,n.s();case 4:if((i=n.n()).done){t.next=10;break}return o=(0,s.Z)(i.value,2),a=o[0],u=o[1],t.next=8,[a,u,e];case 8:t.next=4;break;case 10:t.next=15;break;case 12:t.prev=12,t.t0=t.catch(2),n.e(t.t0);case 15:return t.prev=15,n.f(),t.finish(15);case 18:case"end":return t.stop()}}),t,null,[[2,12,15,18]])})),coercer:function(e){return Array.isArray(e)?e.slice():e},validator:function(e){return Array.isArray(e)||"Expected an array value, but received: "+mt(e)}})}function St(){return At("boolean",(function(e){return"boolean"===typeof e}))}function Tt(e){return At("instance",(function(t){return t instanceof e||"Expected a `"+e.name+"` instance, but received: "+mt(t)}))}function Mt(e){var t=mt(e),r=typeof e;return new _t({type:"literal",schema:"string"===r||"number"===r||"boolean"===r?e:null,validator:function(r){return r===e||"Expected the literal `"+t+"`, but received: "+mt(r)}})}function It(){return At("never",(function(){return!1}))}function Pt(e){return new _t((0,a.Z)((0,a.Z)({},e),{},{validator:function(t,r){return null===t||e.validator(t,r)},refiner:function(t,r){return null===t||e.refiner(t,r)}}))}function Ct(){return At("number",(function(e){return"number"===typeof e&&!isNaN(e)||"Expected a number, but received: "+mt(e)}))}function Bt(e){return new _t((0,a.Z)((0,a.Z)({},e),{},{validator:function(t,r){return void 0===t||e.validator(t,r)},refiner:function(t,r){return void 0===t||e.refiner(t,r)}}))}function Dt(e,t){return new _t({type:"record",schema:null,entries:(0,h.Z)().mark((function r(n){var i,o;return(0,h.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!pt(n)){r.next=11;break}r.t0=(0,h.Z)().keys(n);case 2:if((r.t1=r.t0()).done){r.next=11;break}return i=r.t1.value,o=n[i],r.next=7,[i,i,e];case 7:return r.next=9,[i,o,t];case 9:r.next=2;break;case 11:case"end":return r.stop()}}),r)})),validator:function(e){return pt(e)||"Expected an object, but received: "+mt(e)}})}function Rt(){return At("string",(function(e){return"string"===typeof e||"Expected a string, but received: "+mt(e)}))}function Lt(e){var t=It();return new _t({type:"tuple",schema:null,entries:(0,h.Z)().mark((function r(n){var i,o;return(0,h.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!Array.isArray(n)){r.next=9;break}i=Math.max(e.length,n.length),o=0;case 3:if(!(o<i)){r.next=9;break}return r.next=6,[o,n[o],e[o]||t];case 6:o++,r.next=3;break;case 9:case"end":return r.stop()}}),r)})),validator:function(e){return Array.isArray(e)||"Expected an array, but received: "+mt(e)}})}function Ot(e){var t=Object.keys(e);return new _t({type:"type",schema:e,entries:(0,h.Z)().mark((function r(n){var i,o,a;return(0,h.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!pt(n)){r.next=9;break}i=0,o=t;case 2:if(!(i<o.length)){r.next=9;break}return a=o[i],r.next=6,[a,n[a],e[a]];case 6:i++,r.next=2;break;case 9:case"end":return r.stop()}}),r)})),validator:function(e){return pt(e)||"Expected an object, but received: "+mt(e)}})}function zt(e){var t=e.map((function(e){return e.type})).join(" | ");return new _t({type:"union",schema:null,validator:function(r,n){var i,o,a=[],u=(0,c.Z)(e);try{for(u.s();!(i=u.n()).done;){var l=vt(r,i.value,n),h=(o=l,(0,ot.Z)(o)||(0,at.Z)(o)||(0,st.Z)(o)||(0,ut.Z)()).slice(0);if(!(0,s.Z)(h,1)[0][0])return[];var f,d=(0,c.Z)(h);try{for(d.s();!(f=d.n()).done;){var p=(0,s.Z)(f.value,1)[0];p&&a.push(p)}}catch(m){d.e(m)}finally{d.f()}}}catch(m){u.e(m)}finally{u.f()}return["Expected the value to satisfy a union of `"+t+"`, but received: "+mt(r)].concat(a)}})}function Nt(){return At("unknown",(function(){return!0}))}function Ut(e,t,r){return new _t((0,a.Z)((0,a.Z)({},e),{},{coercer:function(n,i){return wt(n,t)?e.coercer(r(n,i),i):e.coercer(n,i)}}))}for(var Zt=r(9976),Ft=r.n(Zt),jt=r(4641),Vt=r(5421),Wt=[],Kt=[],Gt=[],Ht=BigInt(0),qt=BigInt(1),Yt=BigInt(2),Xt=BigInt(7),Qt=BigInt(256),$t=BigInt(113),Jt=0,er=qt,tr=1,rr=0;Jt<24;Jt++){var nr=[rr,(2*tr+3*rr)%5];tr=nr[0],rr=nr[1],Wt.push(2*(5*rr+tr)),Kt.push((Jt+1)*(Jt+2)/2%64);for(var ir=Ht,or=0;or<7;or++)(er=(er<<qt^(er>>Xt)*$t)%Qt)&Yt&&(ir^=qt<<(qt<<BigInt(or))-qt);Gt.push(ir)}var ar=B.split(Gt,!0),sr=(0,s.Z)(ar,2),ur=sr[0],cr=sr[1],lr=function(e,t,r){return r>32?B.rotlBH(e,t,r):B.rotlSH(e,t,r)},hr=function(e,t,r){return r>32?B.rotlBL(e,t,r):B.rotlSL(e,t,r)};var fr=function(e){(0,d.Z)(r,e);var t=(0,p.Z)(r);function r(e,n,i){var o,a,s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:24;if((0,m.Z)(this,r),(o=t.call(this)).blockLen=e,o.suffix=n,o.outputLen=i,o.enableXOF=s,o.rounds=u,o.pos=0,o.posOut=0,o.finished=!1,o.destroyed=!1,x.number(i),0>=o.blockLen||o.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");return o.state=new Uint8Array(200),o.state32=(a=o.state,new Uint32Array(a.buffer,a.byteOffset,Math.floor(a.byteLength/4))),o}return(0,g.Z)(r,[{key:"keccak",value:function(){!function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:24,r=new Uint32Array(10),n=24-t;n<24;n++){for(var i=0;i<10;i++)r[i]=e[i]^e[i+10]^e[i+20]^e[i+30]^e[i+40];for(var o=0;o<10;o+=2)for(var a=(o+8)%10,s=(o+2)%10,u=r[s],c=r[s+1],l=lr(u,c,1)^r[a],h=hr(u,c,1)^r[a+1],f=0;f<50;f+=10)e[o+f]^=l,e[o+f+1]^=h;for(var d=e[2],p=e[3],m=0;m<24;m++){var g=Kt[m],y=lr(d,p,g),v=hr(d,p,g),_=Wt[m];d=e[_],p=e[_+1],e[_]=y,e[_+1]=v}for(var b=0;b<50;b+=10){for(var x=0;x<10;x++)r[x]=e[b+x];for(var w=0;w<10;w++)e[b+w]^=~r[(w+2)%10]&r[(w+4)%10]}e[0]^=ur[n],e[1]^=cr[n]}r.fill(0)}(this.state32,this.rounds),this.posOut=0,this.pos=0}},{key:"update",value:function(e){x.exists(this);for(var t=this.blockLen,r=this.state,n=(e=A(e)).length,i=0;i<n;){for(var o=Math.min(t-this.pos,n-i),a=0;a<o;a++)r[this.pos++]^=e[i++];this.pos===t&&this.keccak()}return this}},{key:"finish",value:function(){if(!this.finished){this.finished=!0;var e=this.state,t=this.suffix,r=this.pos,n=this.blockLen;e[r]^=t,0!==(128&t)&&r===n-1&&this.keccak(),e[n-1]^=128,this.keccak()}}},{key:"writeInto",value:function(e){x.exists(this,!1),x.bytes(e),this.finish();for(var t=this.state,r=this.blockLen,n=0,i=e.length;n<i;){this.posOut>=r&&this.keccak();var o=Math.min(r-this.posOut,i-n);e.set(t.subarray(this.posOut,this.posOut+o),n),this.posOut+=o,n+=o}return e}},{key:"xofInto",value:function(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}},{key:"xof",value:function(e){return x.number(e),this.xofInto(new Uint8Array(e))}},{key:"digestInto",value:function(e){if(x.output(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}},{key:"digest",value:function(){return this.digestInto(new Uint8Array(this.outputLen))}},{key:"destroy",value:function(){this.destroyed=!0,this.state.fill(0)}},{key:"_cloneInto",value:function(e){var t=this.blockLen,n=this.suffix,i=this.outputLen,o=this.rounds,a=this.enableXOF;return e||(e=new r(t,n,i,a,o)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=o,e.suffix=n,e.outputLen=i,e.enableXOF=a,e.destroyed=this.destroyed,e}}]),r}(E),dr=function(e,t,r){return S((function(){return new fr(t,e,r)}))},pr=(dr(6,144,28),dr(6,136,32),dr(6,104,48),dr(6,72,64),dr(1,144,28),dr(1,136,32)),mr=(dr(1,104,48),dr(1,72,64),function(e,t,r){return function(e){var t=function(t,r){return e(r).update(A(t)).digest()},r=e({});return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=function(t){return e(t)},t}((function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new fr(t,e,void 0===n.dkLen?r:n.dkLen,!0)}))}),gr=(mr(31,168,16),mr(31,136,32),function(e){(0,d.Z)(r,e);var t=(0,p.Z)(r);function r(e,n){var i;(0,m.Z)(this,r),(i=t.call(this)).finished=!1,i.destroyed=!1,x.hash(e);var o=A(n);if(i.iHash=e.create(),"function"!==typeof i.iHash.update)throw new TypeError("Expected instance of class which extends utils.Hash");i.blockLen=i.iHash.blockLen,i.outputLen=i.iHash.outputLen;var a=i.blockLen,s=new Uint8Array(a);s.set(o.length>a?e.create().update(o).digest():o);for(var u=0;u<s.length;u++)s[u]^=54;i.iHash.update(s),i.oHash=e.create();for(var c=0;c<s.length;c++)s[c]^=106;return i.oHash.update(s),s.fill(0),i}return(0,g.Z)(r,[{key:"update",value:function(e){return x.exists(this),this.iHash.update(e),this}},{key:"digestInto",value:function(e){x.exists(this),x.bytes(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}},{key:"digest",value:function(){var e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}},{key:"_cloneInto",value:function(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));var t=this.oHash,r=this.iHash,n=this.finished,i=this.destroyed,o=this.blockLen,a=this.outputLen;return e.finished=n,e.destroyed=i,e.blockLen=o,e.outputLen=a,e.oHash=t._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}},{key:"destroy",value:function(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}]),r}(E)),yr=function(e,t,r){return new gr(e,t).update(r).digest()};yr.create=function(e,t){return new gr(e,t)};var vr=r(5856),_r=r.t(vr,2),br=BigInt(0),xr=BigInt(1),wr=BigInt(2),kr=BigInt(3),Ar=BigInt(8),Er=Object.freeze({a:br,b:BigInt(7),P:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:xr,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee")}),Sr=function(e,t){return(e+t/wr)/t},Tr=BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),Mr=function(e){var t=Er.n,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-xr*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),o=r,a=BigInt("0x100000000000000000000000000000000"),s=Sr(o*e,t),u=Sr(-n*e,t),c=an(e-s*r-u*i,t),l=an(-s*n-u*o,t),h=c>a,f=l>a;if(h&&(c=t-c),f&&(l=t-l),c>a||l>a)throw new Error("splitScalarEndo: Endomorphism failed, k="+e);return{k1neg:h,k1:c,k2neg:f,k2:l}},Ir=32,Pr=32,Cr=32,Br=Ir+1,Dr=2*Ir+1;function Rr(e){var t=Er.a,r=Er.b,n=an(e*e),i=an(n*e);return an(i+t*e+r)}var Lr=Er.a===br,Or=function(e){(0,d.Z)(r,e);var t=(0,p.Z)(r);function r(e){return(0,m.Z)(this,r),t.call(this,e)}return(0,g.Z)(r)}((0,l.Z)(Error));function zr(e){if(!(e instanceof Nr))throw new TypeError("JacobianPoint expected")}var Nr=function(){function e(t,r,n){(0,m.Z)(this,e),this.x=t,this.y=r,this.z=n}return(0,g.Z)(e,[{key:"equals",value:function(e){zr(e);var t=this.x,r=this.y,n=this.z,i=e.x,o=e.y,a=e.z,s=an(n*n),u=an(a*a),c=an(t*u),l=an(i*s),h=an(an(r*a)*u),f=an(an(o*n)*s);return c===l&&h===f}},{key:"negate",value:function(){return new e(this.x,an(-this.y),this.z)}},{key:"double",value:function(){var t=this.x,r=this.y,n=this.z,i=an(t*t),o=an(r*r),a=an(o*o),s=t+o,u=an(wr*(an(s*s)-i-a)),c=an(kr*i),l=an(c*c),h=an(l-wr*u);return new e(h,an(c*(u-h)-Ar*a),an(wr*r*n))}},{key:"add",value:function(t){zr(t);var r=this.x,n=this.y,i=this.z,o=t.x,a=t.y,s=t.z;if(o===br||a===br)return this;if(r===br||n===br)return t;var u=an(i*i),c=an(s*s),l=an(r*c),h=an(o*u),f=an(an(n*s)*c),d=an(an(a*i)*u),p=an(h-l),m=an(d-f);if(p===br)return m===br?this.double():e.ZERO;var g=an(p*p),y=an(p*g),v=an(l*g),_=an(m*m-y-wr*v);return new e(_,an(m*(v-_)-f*y),an(i*s*p))}},{key:"subtract",value:function(e){return this.add(e.negate())}},{key:"multiplyUnsafe",value:function(t){var r=e.ZERO;if("bigint"===typeof t&&t===br)return r;var n=on(t);if(n===xr)return this;if(!Lr){for(var i=r,o=this;n>br;)n&xr&&(i=i.add(o)),o=o.double(),n>>=xr;return i}for(var a=Mr(n),s=a.k1neg,u=a.k1,c=a.k2neg,l=a.k2,h=r,f=r,d=this;u>br||l>br;)u&xr&&(h=h.add(d)),l&xr&&(f=f.add(d)),d=d.double(),u>>=xr,l>>=xr;return s&&(h=h.negate()),c&&(f=f.negate()),f=new e(an(f.x*Tr),f.y,f.z),h.add(f)}},{key:"precomputeWindow",value:function(e){for(var t=Lr?128/e+1:256/e+1,r=[],n=this,i=n,o=0;o<t;o++){i=n,r.push(i);for(var a=1;a<Math.pow(2,e-1);a++)i=i.add(n),r.push(i);n=i.double()}return r}},{key:"wNAF",value:function(t,r){!r&&this.equals(e.BASE)&&(r=Fr.BASE);var n=r&&r._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");var i=r&&Zr.get(r);i||(i=this.precomputeWindow(n),r&&1!==n&&(i=e.normalizeZ(i),Zr.set(r,i)));for(var o=e.ZERO,a=e.BASE,s=1+(Lr?128/n:256/n),u=Math.pow(2,n-1),c=BigInt(Math.pow(2,n)-1),l=Math.pow(2,n),h=BigInt(n),f=0;f<s;f++){var d=f*u,p=Number(t&c);t>>=h,p>u&&(p-=l,t+=xr);var m=d,g=d+Math.abs(p)-1,y=f%2!==0,v=p<0;0===p?a=a.add(Ur(y,i[m])):o=o.add(Ur(v,i[g]))}return{p:o,f:a}}},{key:"multiply",value:function(t,r){var n,i,o=on(t);if(Lr){var a=Mr(o),s=a.k1neg,u=a.k1,c=a.k2neg,l=a.k2,h=this.wNAF(u,r),f=h.p,d=h.f,p=this.wNAF(l,r),m=p.p,g=p.f;f=Ur(s,f),m=new e(an((m=Ur(c,m)).x*Tr),m.y,m.z),n=f.add(m),i=d.add(g)}else{var y=this.wNAF(o,r);n=y.p,i=y.f}return e.normalizeZ([n,i])[0]}},{key:"toAffine",value:function(t){var r=this.x,n=this.y,i=this.z,o=this.equals(e.ZERO);null==t&&(t=o?Ar:un(i));var a=t,s=an(a*a),u=an(s*a),c=an(r*s),l=an(n*u),h=an(i*a);if(o)return Fr.ZERO;if(h!==xr)throw new Error("invZ was invalid");return new Fr(c,l)}}],[{key:"fromAffine",value:function(t){if(!(t instanceof Fr))throw new TypeError("JacobianPoint#fromAffine: expected Point");return t.equals(Fr.ZERO)?e.ZERO:new e(t.x,t.y,xr)}},{key:"toAffineBatch",value:function(e){var t=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Er.P,r=new Array(e.length),n=un(e.reduce((function(e,n,i){return n===br?e:(r[i]=e,an(e*n,t))}),xr),t);return e.reduceRight((function(e,n,i){return n===br?e:(r[i]=an(e*r[i],t),an(e*n,t))}),n),r}(e.map((function(e){return e.z})));return e.map((function(e,r){return e.toAffine(t[r])}))}},{key:"normalizeZ",value:function(t){return e.toAffineBatch(t).map(e.fromAffine)}}]),e}();function Ur(e,t){var r=t.negate();return e?r:t}Nr.BASE=new Nr(Er.Gx,Er.Gy,xr),Nr.ZERO=new Nr(br,xr,br);var Zr=new WeakMap,Fr=function(){function e(t,r){(0,m.Z)(this,e),this.x=t,this.y=r}return(0,g.Z)(e,[{key:"_setWindowSize",value:function(e){this._WINDOW_SIZE=e,Zr.delete(this)}},{key:"hasEvenY",value:function(){return this.y%wr===br}},{key:"toRawBytes",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return tn(this.toHex(e))}},{key:"toHex",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=Qr(this.x);if(e){var r=this.hasEvenY()?"02":"03";return"".concat(r).concat(t)}return"04".concat(t).concat(Qr(this.y))}},{key:"toHexX",value:function(){return this.toHex(!0).slice(2)}},{key:"toRawX",value:function(){return this.toRawBytes(!0).slice(1)}},{key:"assertValidity",value:function(){var e="Point is not on elliptic curve",t=this.x,r=this.y;if(!fn(t)||!fn(r))throw new Error(e);var n=an(r*r);if(an(n-Rr(t))!==br)throw new Error(e)}},{key:"equals",value:function(e){return this.x===e.x&&this.y===e.y}},{key:"negate",value:function(){return new e(this.x,an(-this.y))}},{key:"double",value:function(){return Nr.fromAffine(this).double().toAffine()}},{key:"add",value:function(e){return Nr.fromAffine(this).add(Nr.fromAffine(e)).toAffine()}},{key:"subtract",value:function(e){return this.add(e.negate())}},{key:"multiply",value:function(e){return Nr.fromAffine(this).multiply(e,this).toAffine()}},{key:"multiplyAndAddUnsafe",value:function(t,r,n){var i=Nr.fromAffine(this),o=r===br||r===xr||this!==e.BASE?i.multiplyUnsafe(r):i.multiply(r),a=Nr.fromAffine(t).multiplyUnsafe(n),s=o.add(a);return s.equals(Nr.ZERO)?void 0:s.toAffine()}}],[{key:"fromCompressedHex",value:function(t){var r=32===t.length,n=rn(r?t:t.subarray(1));if(!fn(n))throw new Error("Point is not on curve");var i=function(e){var t=Er.P,r=BigInt(6),n=BigInt(11),i=BigInt(22),o=BigInt(23),a=BigInt(44),s=BigInt(88),u=e*e*e%t,c=u*u*e%t,l=sn(c,kr)*c%t,h=sn(l,kr)*c%t,f=sn(h,wr)*u%t,d=sn(f,n)*f%t,p=sn(d,i)*d%t,m=sn(p,a)*p%t,g=sn(m,s)*m%t,y=sn(g,a)*p%t,v=sn(y,kr)*c%t,_=sn(v,o)*d%t,b=sn(_,r)*u%t,x=sn(b,wr);if(x*x%t!==e)throw new Error("Cannot find square root");return x}(Rr(n)),o=(i&xr)===xr;r?o&&(i=an(-i)):1===(1&t[0])!==o&&(i=an(-i));var a=new e(n,i);return a.assertValidity(),a}},{key:"fromUncompressedHex",value:function(t){var r=new e(rn(t.subarray(1,Ir+1)),rn(t.subarray(Ir+1,2*Ir+1)));return r.assertValidity(),r}},{key:"fromHex",value:function(e){var t=nn(e),r=t.length,n=t[0];if(r===Ir)return this.fromCompressedHex(t);if(r===Br&&(2===n||3===n))return this.fromCompressedHex(t);if(r===Dr&&4===n)return this.fromUncompressedHex(t);throw new Error("Point.fromHex: received invalid point. Expected 32-".concat(Br," compressed bytes or ").concat(Dr," uncompressed bytes, not ").concat(r))}},{key:"fromPrivateKey",value:function(t){return e.BASE.multiply(pn(t))}},{key:"fromSignature",value:function(t,r,n){var i=mn(r),o=i.r,a=i.s;if(![0,1,2,3].includes(n))throw new Error("Cannot recover: invalid recovery bit");var s=cn(nn(t)),u=Er.n,c=2===n||3===n?o+u:o,l=un(c,u),h=an(-s*l,u),f=an(a*l,u),d=1&n?"03":"02",p=e.fromHex(d+Qr(c)),m=e.BASE.multiplyAndAddUnsafe(p,h,f);if(!m)throw new Error("Cannot recover signature: point at infinify");return m.assertValidity(),m}}]),e}();function jr(e){return Number.parseInt(e[0],16)>=8?"00"+e:e}function Vr(e){if(e.length<2||2!==e[0])throw new Error("Invalid signature integer tag: ".concat(Hr(e)));var t=e[1],r=e.subarray(2,t+2);if(!t||r.length!==t)throw new Error("Invalid signature integer: wrong length");if(0===r[0]&&r[1]<=127)throw new Error("Invalid signature integer: trailing length");return{data:rn(r),left:e.subarray(t+2)}}Fr.BASE=new Fr(Er.Gx,Er.Gy),Fr.ZERO=new Fr(br,br);var Wr=function(){function e(t,r){(0,m.Z)(this,e),this.r=t,this.s=r,this.assertValidity()}return(0,g.Z)(e,[{key:"assertValidity",value:function(){var e=this.r,t=this.s;if(!hn(e))throw new Error("Invalid Signature: r must be 0 < r < n");if(!hn(t))throw new Error("Invalid Signature: s must be 0 < s < n")}},{key:"hasHighS",value:function(){var e=Er.n>>xr;return this.s>e}},{key:"normalizeS",value:function(){return this.hasHighS()?new e(this.r,an(-this.s,Er.n)):this}},{key:"toDERRawBytes",value:function(){return tn(this.toDERHex())}},{key:"toDERHex",value:function(){var e=jr(Jr(this.s)),t=jr(Jr(this.r)),r=e.length/2,n=t.length/2,i=Jr(r),o=Jr(n),a=Jr(n+r+4);return"30".concat(a,"02").concat(o).concat(t,"02").concat(i).concat(e)}},{key:"toRawBytes",value:function(){return this.toDERRawBytes()}},{key:"toHex",value:function(){return this.toDERHex()}},{key:"toCompactRawBytes",value:function(){return tn(this.toCompactHex())}},{key:"toCompactHex",value:function(){return Qr(this.r)+Qr(this.s)}}],[{key:"fromCompact",value:function(t){var r=t instanceof Uint8Array,n="Signature.fromCompact";if("string"!==typeof t&&!r)throw new TypeError("".concat(n,": Expected string or Uint8Array"));var i=r?Hr(t):t;if(128!==i.length)throw new Error("".concat(n,": Expected 64-byte hex"));return new e(en(i.slice(0,64)),en(i.slice(64,128)))}},{key:"fromDER",value:function(t){var r=t instanceof Uint8Array;if("string"!==typeof t&&!r)throw new TypeError("Signature.fromDER: Expected string or Uint8Array");var n=function(e){if(e.length<2||48!=e[0])throw new Error("Invalid signature tag: ".concat(Hr(e)));if(e[1]!==e.length-2)throw new Error("Invalid signature: incorrect length");var t=Vr(e.subarray(2)),r=t.data,n=Vr(t.left),i=n.data,o=n.left;if(o.length)throw new Error("Invalid signature: left bytes after parsing: ".concat(Hr(o)));return{r:r,s:i}}(r?t:tn(t));return new e(n.r,n.s)}},{key:"fromHex",value:function(e){return this.fromDER(e)}}]),e}();function Kr(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];if(!t.every((function(e){return e instanceof Uint8Array})))throw new Error("Uint8Array list expected");if(1===t.length)return t[0];for(var n=t.reduce((function(e,t){return e+t.length}),0),i=new Uint8Array(n),o=0,a=0;o<t.length;o++){var s=t[o];i.set(s,a),a+=s.length}return i}var Gr=Array.from({length:256},(function(e,t){return t.toString(16).padStart(2,"0")}));function Hr(e){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");for(var t="",r=0;r<e.length;r++)t+=Gr[e[r]];return t}var qr,Yr,Xr=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000");function Qr(e){if("bigint"!==typeof e)throw new Error("Expected bigint");if(!(br<=e&&e<Xr))throw new Error("Expected number 0 <= n < 2^256");return e.toString(16).padStart(64,"0")}function $r(e){var t=tn(Qr(e));if(32!==t.length)throw new Error("Error: expected 32 bytes");return t}function Jr(e){var t=e.toString(16);return 1&t.length?"0".concat(t):t}function en(e){if("string"!==typeof e)throw new TypeError("hexToNumber: expected string, got "+typeof e);return BigInt("0x".concat(e))}function tn(e){if("string"!==typeof e)throw new TypeError("hexToBytes: expected string, got "+typeof e);if(e.length%2)throw new Error("hexToBytes: received invalid unpadded hex"+e.length);for(var t=new Uint8Array(e.length/2),r=0;r<t.length;r++){var n=2*r,i=e.slice(n,n+2),o=Number.parseInt(i,16);if(Number.isNaN(o)||o<0)throw new Error("Invalid byte sequence");t[r]=o}return t}function rn(e){return en(Hr(e))}function nn(e){return e instanceof Uint8Array?Uint8Array.from(e):tn(e)}function on(e){if("number"===typeof e&&Number.isSafeInteger(e)&&e>0)return BigInt(e);if("bigint"===typeof e&&hn(e))return e;throw new TypeError("Expected valid private scalar: 0 < scalar < curve.n")}function an(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Er.P,r=e%t;return r>=br?r:t+r}function sn(e,t){for(var r=Er.P,n=e;t-- >br;)n*=n,n%=r;return n}function un(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Er.P;if(e===br||t<=br)throw new Error("invert: expected positive integers, got n=".concat(e," mod=").concat(t));for(var r=an(e,t),n=t,i=br,o=xr,a=xr,s=br;r!==br;){var u=n/r,c=n%r,l=i-a*u,h=o-s*u;n=r,r=c,i=a,o=s,a=l,s=h}if(n!==xr)throw new Error("invert: does not exist");return an(i,t)}function cn(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=function(e){var t=8*e.length-8*Pr,r=rn(e);return t>0?r>>BigInt(t):r}(e);if(t)return r;var n=Er.n;return r>=n?r-n:r}var ln=function(){function e(t,r){if((0,m.Z)(this,e),this.hashLen=t,this.qByteLen=r,"number"!==typeof t||t<2)throw new Error("hashLen must be a number");if("number"!==typeof r||r<2)throw new Error("qByteLen must be a number");this.v=new Uint8Array(t).fill(1),this.k=new Uint8Array(t).fill(0),this.counter=0}return(0,g.Z)(e,[{key:"hmac",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return kn.hmacSha256.apply(kn,[this.k].concat(t))}},{key:"hmacSync",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return Yr.apply(void 0,[this.k].concat(t))}},{key:"checkSync",value:function(){if("function"!==typeof Yr)throw new Or("hmacSha256Sync needs to be set")}},{key:"incr",value:function(){if(this.counter>=1e3)throw new Error("Tried 1,000 k values for sign(), all were invalid");this.counter+=1}},{key:"reseed",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(){var t,r=arguments;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r.length>0&&void 0!==r[0]?r[0]:new Uint8Array,e.next=3,this.hmac(this.v,Uint8Array.from([0]),t);case 3:return this.k=e.sent,e.next=6,this.hmac(this.v);case 6:if(this.v=e.sent,0!==t.length){e.next=9;break}return e.abrupt("return");case 9:return e.next=11,this.hmac(this.v,Uint8Array.from([1]),t);case 11:return this.k=e.sent,e.next=14,this.hmac(this.v);case 14:this.v=e.sent;case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"reseedSync",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Uint8Array;this.checkSync(),this.k=this.hmacSync(this.v,Uint8Array.from([0]),e),this.v=this.hmacSync(this.v),0!==e.length&&(this.k=this.hmacSync(this.v,Uint8Array.from([1]),e),this.v=this.hmacSync(this.v))}},{key:"generate",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(){var t,r,n;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.incr(),t=0,r=[];case 3:if(!(t<this.qByteLen)){e.next=12;break}return e.next=6,this.hmac(this.v);case 6:this.v=e.sent,n=this.v.slice(),r.push(n),t+=this.v.length,e.next=3;break;case 12:return e.abrupt("return",Kr.apply(void 0,r));case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"generateSync",value:function(){this.checkSync(),this.incr();for(var e=0,t=[];e<this.qByteLen;){this.v=this.hmacSync(this.v);var r=this.v.slice();t.push(r),e+=this.v.length}return Kr.apply(void 0,t)}}]),e}();function hn(e){return br<e&&e<Er.n}function fn(e){return br<e&&e<Er.P}function dn(e,t,r){var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=Er.n,o=cn(e,!0);if(hn(o)){var a=un(o,i),s=Fr.BASE.multiply(o),u=an(s.x,i);if(u!==br){var c=an(a*an(t+r*u,i),i);if(c!==br){var l=new Wr(u,c),h=(s.x===l.r?0:2)|Number(s.y&xr);return n&&l.hasHighS()&&(l=l.normalizeS(),h^=1),{sig:l,recovery:h}}}}}function pn(e){var t;if("bigint"===typeof e)t=e;else if("number"===typeof e&&Number.isSafeInteger(e)&&e>0)t=BigInt(e);else if("string"===typeof e){if(e.length!==2*Pr)throw new Error("Expected 32 bytes of private key");t=en(e)}else{if(!(e instanceof Uint8Array))throw new TypeError("Expected valid private key");if(e.length!==Pr)throw new Error("Expected 32 bytes of private key");t=rn(e)}if(!hn(t))throw new Error("Expected private key: 0 < key < n");return t}function mn(e){if(e instanceof Wr)return e.assertValidity(),e;try{return Wr.fromDER(e)}catch(t){return Wr.fromCompact(e)}}function gn(e){return rn(e.length>Ir?e.slice(0,Ir):e)}function yn(e){var t=gn(e),r=an(t,Er.n);return vn(r<br?t:r)}function vn(e){return $r(e)}function _n(e,t,r){if(null==e)throw new Error('sign: expected valid message hash, not "'.concat(e,'"'));var n=nn(e),i=pn(t),o=[vn(i),yn(n)];if(null!=r){!0===r&&(r=kn.randomBytes(Ir));var a=nn(r);if(a.length!==Ir)throw new Error("sign: Expected ".concat(Ir," bytes of extra data"));o.push(a)}return{seed:Kr.apply(void 0,o),m:gn(n),d:i}}function bn(e,t){var r=e.sig,n=e.recovery,i=Object.assign({canonical:!0,der:!0},t),o=i.der,a=i.recovered,s=o?r.toDERRawBytes():r.toCompactRawBytes();return a?[s,n]:s}Fr.BASE._setWindowSize(8);var xn={node:_r,web:"object"===typeof self&&"crypto"in self?self.crypto:void 0},wn={},kn={bytesToHex:Hr,hexToBytes:tn,concatBytes:Kr,mod:an,invert:un,isValidPrivateKey:function(e){try{return pn(e),!0}catch(t){return!1}},_bigintTo32Bytes:$r,_normalizePrivateKey:pn,hashToPrivateKey:function(e){e=nn(e);var t=Pr+8;if(e.length<t||e.length>1024)throw new Error("Expected valid bytes of private key as per FIPS 186");return $r(an(rn(e),Er.n-xr)+xr)},randomBytes:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32;if(xn.web)return xn.web.getRandomValues(new Uint8Array(e));if(xn.node){var t=xn.node.randomBytes;return Uint8Array.from(t(e))}throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:function(){return kn.hashToPrivateKey(kn.randomBytes(Pr+8))},precompute:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:8,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Fr.BASE,r=t===Fr.BASE?t:new Fr(t.x,t.y);return r._setWindowSize(e),r.multiply(kr),r},sha256:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(){var t,r,n,i,o,a,s=arguments;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=s.length,r=new Array(t),n=0;n<t;n++)r[n]=s[n];if(!xn.web){e.next=8;break}return e.next=4,xn.web.subtle.digest("SHA-256",Kr.apply(void 0,r));case 4:return i=e.sent,e.abrupt("return",new Uint8Array(i));case 8:if(!xn.node){e.next=15;break}return o=xn.node.createHash,a=o("sha256"),r.forEach((function(e){return a.update(e)})),e.abrupt("return",Uint8Array.from(a.digest()));case 15:throw new Error("The environment doesn't have sha256 function");case 16:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),hmacSha256:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t){var r,n,i,o,a,s,u,c,l=arguments;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r=l.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=l[i];if(!xn.web){e.next=12;break}return e.next=4,xn.web.subtle.importKey("raw",t,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]);case 4:return o=e.sent,a=Kr.apply(void 0,n),e.next=8,xn.web.subtle.sign("HMAC",o,a);case 8:return s=e.sent,e.abrupt("return",new Uint8Array(s));case 12:if(!xn.node){e.next=19;break}return u=xn.node.createHmac,c=u("sha256",t),n.forEach((function(e){return c.update(e)})),e.abrupt("return",Uint8Array.from(c.digest()));case 19:throw new Error("The environment doesn't have hmac-sha256 function");case 20:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),sha256Sync:void 0,hmacSha256Sync:void 0,taggedHash:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t){var r,n,i,o,a,s=arguments;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==(r=wn[t])){e.next=7;break}return e.next=4,kn.sha256(Uint8Array.from(t,(function(e){return e.charCodeAt(0)})));case 4:n=e.sent,r=Kr(n,n),wn[t]=r;case 7:for(i=s.length,o=new Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=s[a];return e.abrupt("return",kn.sha256.apply(kn,[r].concat(o)));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),taggedHashSync:function(e){if("function"!==typeof qr)throw new Or("sha256Sync is undefined, you need to set it");var t=wn[e];if(void 0===t){var r=qr(Uint8Array.from(e,(function(e){return e.charCodeAt(0)})));t=Kr(r,r),wn[e]=t}for(var n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];return qr.apply(void 0,[t].concat(i))},_JacobianPoint:Nr};Object.defineProperties(kn,{sha256Sync:{configurable:!1,get:function(){return qr},set:function(e){qr||(qr=e)}},hmacSha256Sync:{configurable:!1,get:function(){return Yr},set:function(e){Yr||(Yr=e)}}});var An=["commitment"],En=["encoding"],Sn=["commitment"],Tn=["commitment"];We.sha512Sync=function(){var e;return V((e=We).concatBytes.apply(e,arguments))};var Mn=We.randomPrivateKey,In=function(){var e=We.randomPrivateKey(),t=Pn(e),r=new Uint8Array(64);return r.set(e),r.set(t,32),{publicKey:t,secretKey:r}},Pn=je.getPublicKey;function Cn(e){try{return he.fromHex(e,!0),!0}catch(t){return!1}}var Bn,Dn=function(e,t){return je.sign(e,t.slice(0,32))},Rn=je.verify,Ln=function(e){return y.lW.isBuffer(e)?e:e instanceof Uint8Array?y.lW.from(e.buffer,e.byteOffset,e.byteLength):y.lW.from(e)},On=function(){function e(t){(0,m.Z)(this,e),Object.assign(this,t)}return(0,g.Z)(e,[{key:"encode",value:function(){return y.lW.from((0,rt.serialize)(Nn,this))}}],[{key:"decode",value:function(e){return(0,rt.deserialize)(Nn,this,e)}},{key:"decodeUnchecked",value:function(e){return(0,rt.deserializeUnchecked)(Nn,this,e)}}]),e}(),zn=function(e){(0,d.Z)(r,e);var t=(0,p.Z)(r);function r(e){var n;if((0,m.Z)(this,r),(n=t.call(this,e)).enum="",1!==Object.keys(e).length)throw new Error("Enum can only take single value");return Object.keys(e).map((function(e){n.enum=e})),n}return(0,g.Z)(r)}(On),Nn=new Map,Un=32,Zn=32;var Fn=1;Bn=Symbol.toStringTag;var jn=function(e,t){(0,d.Z)(n,e);var r=(0,p.Z)(n);function n(e){var t;if((0,m.Z)(this,n),(t=r.call(this,{}))._bn=void 0,function(e){return void 0!==e._bn}(e))t._bn=e._bn;else{if("string"===typeof e){var i=qe().decode(e);if(i.length!=Zn)throw new Error("Invalid public key input");t._bn=new(Ge())(i)}else t._bn=new(Ge())(e);if(t._bn.byteLength()>Zn)throw new Error("Invalid public key input")}return t}return(0,g.Z)(n,[{key:"equals",value:function(e){return this._bn.eq(e._bn)}},{key:"toBase58",value:function(){return qe().encode(this.toBytes())}},{key:"toJSON",value:function(){return this.toBase58()}},{key:"toBytes",value:function(){var e=this.toBuffer();return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}},{key:"toBuffer",value:function(){var e=this._bn.toArrayLike(y.lW);if(e.length===Zn)return e;var t=y.lW.alloc(32);return e.copy(t,32-e.length),t}},{key:t,get:function(){return"PublicKey(".concat(this.toString(),")")}},{key:"toString",value:function(){return this.toBase58()}}],[{key:"unique",value:function(){var e=new n(Fn);return Fn+=1,new n(e.toBuffer())}},{key:"createWithSeed",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t,r,i){var o,a;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=y.lW.concat([t.toBuffer(),y.lW.from(r),i.toBuffer()]),a=tt(o),e.abrupt("return",new n(a));case 3:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"createProgramAddressSync",value:function(e,t){var r=y.lW.alloc(0);e.forEach((function(e){if(e.length>Un)throw new TypeError("Max seed length exceeded");r=y.lW.concat([r,Ln(e)])})),r=y.lW.concat([r,t.toBuffer(),y.lW.from("ProgramDerivedAddress")]);var i=tt(r);if(Cn(i))throw new Error("Invalid seeds, address must fall off the curve");return new n(i)}},{key:"createProgramAddress",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t,r){return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.createProgramAddressSync(t,r));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"findProgramAddressSync",value:function(e,t){for(var r,n=255;0!=n;){try{var i=e.concat(y.lW.from([n]));r=this.createProgramAddressSync(i,t)}catch(o){if(o instanceof TypeError)throw o;n--;continue}return[r,n]}throw new Error("Unable to find a viable program address nonce")}},{key:"findProgramAddress",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t,r){return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.findProgramAddressSync(t,r));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"isOnCurve",value:function(e){return Cn(new n(e).toBytes())}}]),n}(On,Bn);jn.default=new jn("11111111111111111111111111111111"),Nn.set(jn,{kind:"struct",fields:[["_bn","u256"]]});var Vn=function(){function e(t){if((0,m.Z)(this,e),this._publicKey=void 0,this._secretKey=void 0,t){var r=Ln(t);if(64!==t.length)throw new Error("bad secret key size");this._publicKey=r.slice(32,64),this._secretKey=r.slice(0,32)}else this._secretKey=Ln(Mn()),this._publicKey=Ln(Pn(this._secretKey))}return(0,g.Z)(e,[{key:"publicKey",get:function(){return new jn(this._publicKey)}},{key:"secretKey",get:function(){return y.lW.concat([this._secretKey,this._publicKey],64)}}]),e}(),Wn=new jn("BPFLoader1111111111111111111111111111111111"),Kn=1232,Gn=127,Hn=64,qn=function(e){(0,d.Z)(r,e);var t=(0,p.Z)(r);function r(e){var n;return(0,m.Z)(this,r),(n=t.call(this,"Signature ".concat(e," has expired: block height exceeded."))).signature=void 0,n.signature=e,n}return(0,g.Z)(r)}((0,l.Z)(Error));Object.defineProperty(qn.prototype,"name",{value:"TransactionExpiredBlockheightExceededError"});var Yn=function(e){(0,d.Z)(r,e);var t=(0,p.Z)(r);function r(e,n){var i;return(0,m.Z)(this,r),(i=t.call(this,"Transaction was not confirmed in ".concat(n.toFixed(2)," seconds. It is ")+"unknown if it succeeded or failed. Check signature "+"".concat(e," using the Solana Explorer or CLI tools."))).signature=void 0,i.signature=e,i}return(0,g.Z)(r)}((0,l.Z)(Error));Object.defineProperty(Yn.prototype,"name",{value:"TransactionExpiredTimeoutError"});var Xn=function(e){(0,d.Z)(r,e);var t=(0,p.Z)(r);function r(e){var n;return(0,m.Z)(this,r),(n=t.call(this,"Signature ".concat(e," has expired: the nonce is no longer valid."))).signature=void 0,n.signature=e,n}return(0,g.Z)(r)}((0,l.Z)(Error));Object.defineProperty(Xn.prototype,"name",{value:"TransactionExpiredNonceInvalidError"});var Qn=function(){function e(t,r){(0,m.Z)(this,e),this.staticAccountKeys=void 0,this.accountKeysFromLookups=void 0,this.staticAccountKeys=t,this.accountKeysFromLookups=r}return(0,g.Z)(e,[{key:"keySegments",value:function(){var e=[this.staticAccountKeys];return this.accountKeysFromLookups&&(e.push(this.accountKeysFromLookups.writable),e.push(this.accountKeysFromLookups.readonly)),e}},{key:"get",value:function(e){var t,r=(0,c.Z)(this.keySegments());try{for(r.s();!(t=r.n()).done;){var n=t.value;if(e<n.length)return n[e];e-=n.length}}catch(i){r.e(i)}finally{r.f()}}},{key:"length",get:function(){return this.keySegments().flat().length}},{key:"compileInstructions",value:function(e){if(this.length>256)throw new Error("Account index overflow encountered during compilation");var t=new Map;this.keySegments().flat().forEach((function(e,r){t.set(e.toBase58(),r)}));var r=function(e){var r=t.get(e.toBase58());if(void 0===r)throw new Error("Encountered an unknown instruction account key during compilation");return r};return e.map((function(e){return{programIdIndex:r(e.programId),accountKeyIndexes:e.keys.map((function(e){return r(e.pubkey)})),data:e.data}}))}}]),e}(),$n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"publicKey";return nt.blob(32,e)},Jn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"signature";return nt.blob(64,e)},ei=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"string",t=nt.struct([nt.u32("length"),nt.u32("lengthPadding"),nt.blob(nt.offset(nt.u32(),-8),"chars")],e),r=t.decode.bind(t),n=t.encode.bind(t),i=t;return i.decode=function(e,t){return r(e,t).chars.toString()},i.encode=function(e,t,r){var i={chars:y.lW.from(e,"utf8")};return n(i,t,r)},i.alloc=function(e){return nt.u32().span+nt.u32().span+y.lW.from(e,"utf8").length},i};function ti(e,t){var r=function e(r){if(r.span>=0)return r.span;if("function"===typeof r.alloc)return r.alloc(t[r.property]);if("count"in r&&"elementLayout"in r){var n=t[r.property];if(Array.isArray(n))return n.length*e(r.elementLayout)}else if("fields"in r)return ti({layout:r},t[r.property]);return 0},n=0;return e.layout.fields.forEach((function(e){n+=r(e)})),n}function ri(e){for(var t=0,r=0;;){var n=e.shift();if(t|=(127&n)<<7*r,r+=1,0===(128&n))break}return t}function ni(e,t){for(var r=t;;){var n=127&r;if(0==(r>>=7)){e.push(n);break}n|=128,e.push(n)}}function ii(e,t){if(!e)throw new Error(t||"Assertion failed")}var oi,ai=function(){function e(t,r){(0,m.Z)(this,e),this.payer=void 0,this.keyMetaMap=void 0,this.payer=t,this.keyMetaMap=r}return(0,g.Z)(e,[{key:"getMessageComponents",value:function(){var e=(0,u.Z)(this.keyMetaMap.entries());ii(e.length<=256,"Max static account keys length exceeded");var t=e.filter((function(e){var t=(0,s.Z)(e,2)[1];return t.isSigner&&t.isWritable})),r=e.filter((function(e){var t=(0,s.Z)(e,2)[1];return t.isSigner&&!t.isWritable})),n=e.filter((function(e){var t=(0,s.Z)(e,2)[1];return!t.isSigner&&t.isWritable})),i=e.filter((function(e){var t=(0,s.Z)(e,2)[1];return!t.isSigner&&!t.isWritable})),o={numRequiredSignatures:t.length+r.length,numReadonlySignedAccounts:r.length,numReadonlyUnsignedAccounts:i.length};return ii(t.length>0,"Expected at least one writable signer key"),ii((0,s.Z)(t[0],1)[0]===this.payer.toBase58(),"Expected first writable signer key to be the fee payer"),[o,[].concat((0,u.Z)(t.map((function(e){var t=(0,s.Z)(e,1)[0];return new jn(t)}))),(0,u.Z)(r.map((function(e){var t=(0,s.Z)(e,1)[0];return new jn(t)}))),(0,u.Z)(n.map((function(e){var t=(0,s.Z)(e,1)[0];return new jn(t)}))),(0,u.Z)(i.map((function(e){var t=(0,s.Z)(e,1)[0];return new jn(t)}))))]}},{key:"extractTableLookup",value:function(e){var t=this.drainKeysFoundInLookupTable(e.state.addresses,(function(e){return!e.isSigner&&!e.isInvoked&&e.isWritable})),r=(0,s.Z)(t,2),n=r[0],i=r[1],o=this.drainKeysFoundInLookupTable(e.state.addresses,(function(e){return!e.isSigner&&!e.isInvoked&&!e.isWritable})),a=(0,s.Z)(o,2),u=a[0],c=a[1];if(0!==n.length||0!==u.length)return[{accountKey:e.key,writableIndexes:n,readonlyIndexes:u},{writable:i,readonly:c}]}},{key:"drainKeysFoundInLookupTable",value:function(e,t){var r,n=this,i=new Array,o=new Array,a=(0,c.Z)(this.keyMetaMap.entries());try{var u=function(){var a=(0,s.Z)(r.value,2),u=a[0],c=a[1];if(t(c)){var l=new jn(u),h=e.findIndex((function(e){return e.equals(l)}));h>=0&&(ii(h<256,"Max lookup table index exceeded"),i.push(h),o.push(l),n.keyMetaMap.delete(u))}};for(a.s();!(r=a.n()).done;)u()}catch(l){a.e(l)}finally{a.f()}return[i,o]}}],[{key:"compile",value:function(t,r){var n=new Map,i=function(e){var t=e.toBase58(),r=n.get(t);return void 0===r&&(r={isSigner:!1,isWritable:!1,isInvoked:!1},n.set(t,r)),r},o=i(r);o.isSigner=!0,o.isWritable=!0;var a,s=(0,c.Z)(t);try{for(s.s();!(a=s.n()).done;){var u=a.value;i(u.programId).isInvoked=!0;var l,h=(0,c.Z)(u.keys);try{for(h.s();!(l=h.n()).done;){var f=l.value,d=i(f.pubkey);d.isSigner||(d.isSigner=f.isSigner),d.isWritable||(d.isWritable=f.isWritable)}}catch(p){h.e(p)}finally{h.f()}}}catch(p){s.e(p)}finally{s.f()}return new e(r,n)}}]),e}(),si=function(){function e(t){var r=this;(0,m.Z)(this,e),this.header=void 0,this.accountKeys=void 0,this.recentBlockhash=void 0,this.instructions=void 0,this.indexToProgramIds=new Map,this.header=t.header,this.accountKeys=t.accountKeys.map((function(e){return new jn(e)})),this.recentBlockhash=t.recentBlockhash,this.instructions=t.instructions,this.instructions.forEach((function(e){return r.indexToProgramIds.set(e.programIdIndex,r.accountKeys[e.programIdIndex])}))}return(0,g.Z)(e,[{key:"version",get:function(){return"legacy"}},{key:"staticAccountKeys",get:function(){return this.accountKeys}},{key:"compiledInstructions",get:function(){return this.instructions.map((function(e){return{programIdIndex:e.programIdIndex,accountKeyIndexes:e.accounts,data:qe().decode(e.data)}}))}},{key:"addressTableLookups",get:function(){return[]}},{key:"getAccountKeys",value:function(){return new Qn(this.staticAccountKeys)}},{key:"isAccountSigner",value:function(e){return e<this.header.numRequiredSignatures}},{key:"isAccountWritable",value:function(e){var t=this.header.numRequiredSignatures;return e>=this.header.numRequiredSignatures?e-t<this.accountKeys.length-t-this.header.numReadonlyUnsignedAccounts:e<t-this.header.numReadonlySignedAccounts}},{key:"isProgramId",value:function(e){return this.indexToProgramIds.has(e)}},{key:"programIds",value:function(){return(0,u.Z)(this.indexToProgramIds.values())}},{key:"nonProgramIds",value:function(){var e=this;return this.accountKeys.filter((function(t,r){return!e.isProgramId(r)}))}},{key:"serialize",value:function(){var e=this.accountKeys.length,t=[];ni(t,e);var r=this.instructions.map((function(e){var t=e.accounts,r=e.programIdIndex,n=Array.from(qe().decode(e.data)),i=[];ni(i,t.length);var o=[];return ni(o,n.length),{programIdIndex:r,keyIndicesCount:y.lW.from(i),keyIndices:t,dataLength:y.lW.from(o),data:n}})),n=[];ni(n,r.length);var i=y.lW.alloc(Kn);y.lW.from(n).copy(i);var o=n.length;r.forEach((function(e){var t=nt.struct([nt.u8("programIdIndex"),nt.blob(e.keyIndicesCount.length,"keyIndicesCount"),nt.seq(nt.u8("keyIndex"),e.keyIndices.length,"keyIndices"),nt.blob(e.dataLength.length,"dataLength"),nt.seq(nt.u8("userdatum"),e.data.length,"data")]).encode(e,i,o);o+=t})),i=i.slice(0,o);var a=nt.struct([nt.blob(1,"numRequiredSignatures"),nt.blob(1,"numReadonlySignedAccounts"),nt.blob(1,"numReadonlyUnsignedAccounts"),nt.blob(t.length,"keyCount"),nt.seq($n("key"),e,"keys"),$n("recentBlockhash")]),s={numRequiredSignatures:y.lW.from([this.header.numRequiredSignatures]),numReadonlySignedAccounts:y.lW.from([this.header.numReadonlySignedAccounts]),numReadonlyUnsignedAccounts:y.lW.from([this.header.numReadonlyUnsignedAccounts]),keyCount:y.lW.from(t),keys:this.accountKeys.map((function(e){return Ln(e.toBytes())})),recentBlockhash:qe().decode(this.recentBlockhash)},u=y.lW.alloc(2048),c=a.encode(s,u);return i.copy(u,c),u.slice(0,c+i.length)}}],[{key:"compile",value:function(t){var r=ai.compile(t.instructions,t.payerKey).getMessageComponents(),n=(0,s.Z)(r,2),i=n[0],o=n[1],a=new Qn(o).compileInstructions(t.instructions).map((function(e){return{programIdIndex:e.programIdIndex,accounts:e.accountKeyIndexes,data:qe().encode(e.data)}}));return new e({header:i,accountKeys:o,recentBlockhash:t.recentBlockhash,instructions:a})}},{key:"from",value:function(t){var r=(0,u.Z)(t),n=r.shift();if(n!==(n&Gn))throw new Error("Versioned messages must be deserialized with VersionedMessage.deserialize()");for(var i=r.shift(),o=r.shift(),a=ri(r),s=[],c=0;c<a;c++){var l=r.slice(0,Zn);r=r.slice(Zn),s.push(new jn(y.lW.from(l)))}for(var h=r.slice(0,Zn),f=ri(r=r.slice(Zn)),d=[],p=0;p<f;p++){var m=r.shift(),g=ri(r),v=r.slice(0,g),_=ri(r=r.slice(g)),b=r.slice(0,_),x=qe().encode(y.lW.from(b));r=r.slice(_),d.push({programIdIndex:m,accounts:v,data:x})}return new e({header:{numRequiredSignatures:n,numReadonlySignedAccounts:i,numReadonlyUnsignedAccounts:o},recentBlockhash:qe().encode(y.lW.from(h)),accountKeys:s,instructions:d})}}]),e}(),ui=function(){function e(t){(0,m.Z)(this,e),this.header=void 0,this.staticAccountKeys=void 0,this.recentBlockhash=void 0,this.compiledInstructions=void 0,this.addressTableLookups=void 0,this.header=t.header,this.staticAccountKeys=t.staticAccountKeys,this.recentBlockhash=t.recentBlockhash,this.compiledInstructions=t.compiledInstructions,this.addressTableLookups=t.addressTableLookups}return(0,g.Z)(e,[{key:"version",get:function(){return 0}},{key:"numAccountKeysFromLookups",get:function(){var e,t=0,r=(0,c.Z)(this.addressTableLookups);try{for(r.s();!(e=r.n()).done;){var n=e.value;t+=n.readonlyIndexes.length+n.writableIndexes.length}}catch(i){r.e(i)}finally{r.f()}return t}},{key:"getAccountKeys",value:function(e){var t;if(e&&"accountKeysFromLookups"in e&&e.accountKeysFromLookups){if(this.numAccountKeysFromLookups!=e.accountKeysFromLookups.writable.length+e.accountKeysFromLookups.readonly.length)throw new Error("Failed to get account keys because of a mismatch in the number of account keys from lookups");t=e.accountKeysFromLookups}else if(e&&"addressLookupTableAccounts"in e&&e.addressLookupTableAccounts)t=this.resolveAddressTableLookups(e.addressLookupTableAccounts);else if(this.addressTableLookups.length>0)throw new Error("Failed to get account keys because address table lookups were not resolved");return new Qn(this.staticAccountKeys,t)}},{key:"isAccountSigner",value:function(e){return e<this.header.numRequiredSignatures}},{key:"isAccountWritable",value:function(e){var t=this.header.numRequiredSignatures,r=this.staticAccountKeys.length;return e>=r?e-r<this.addressTableLookups.reduce((function(e,t){return e+t.writableIndexes.length}),0):e>=this.header.numRequiredSignatures?e-t<r-t-this.header.numReadonlyUnsignedAccounts:e<t-this.header.numReadonlySignedAccounts}},{key:"resolveAddressTableLookups",value:function(e){var t,r={writable:[],readonly:[]},n=(0,c.Z)(this.addressTableLookups);try{var i=function(){var n=t.value,i=e.find((function(e){return e.key.equals(n.accountKey)}));if(!i)throw new Error("Failed to find address lookup table account for table key ".concat(n.accountKey.toBase58()));var o,a=(0,c.Z)(n.writableIndexes);try{for(a.s();!(o=a.n()).done;){var s=o.value;if(!(s<i.state.addresses.length))throw new Error("Failed to find address for index ".concat(s," in address lookup table ").concat(n.accountKey.toBase58()));r.writable.push(i.state.addresses[s])}}catch(f){a.e(f)}finally{a.f()}var u,l=(0,c.Z)(n.readonlyIndexes);try{for(l.s();!(u=l.n()).done;){var h=u.value;if(!(h<i.state.addresses.length))throw new Error("Failed to find address for index ".concat(h," in address lookup table ").concat(n.accountKey.toBase58()));r.readonly.push(i.state.addresses[h])}}catch(f){l.e(f)}finally{l.f()}};for(n.s();!(t=n.n()).done;)i()}catch(o){n.e(o)}finally{n.f()}return r}},{key:"serialize",value:function(){var e=Array();ni(e,this.staticAccountKeys.length);var t=this.serializeInstructions(),r=Array();ni(r,this.compiledInstructions.length);var n=this.serializeAddressTableLookups(),i=Array();ni(i,this.addressTableLookups.length);var o=nt.struct([nt.u8("prefix"),nt.struct([nt.u8("numRequiredSignatures"),nt.u8("numReadonlySignedAccounts"),nt.u8("numReadonlyUnsignedAccounts")],"header"),nt.blob(e.length,"staticAccountKeysLength"),nt.seq($n(),this.staticAccountKeys.length,"staticAccountKeys"),$n("recentBlockhash"),nt.blob(r.length,"instructionsLength"),nt.blob(t.length,"serializedInstructions"),nt.blob(i.length,"addressTableLookupsLength"),nt.blob(n.length,"serializedAddressTableLookups")]),a=new Uint8Array(Kn),s=o.encode({prefix:128,header:this.header,staticAccountKeysLength:new Uint8Array(e),staticAccountKeys:this.staticAccountKeys.map((function(e){return e.toBytes()})),recentBlockhash:qe().decode(this.recentBlockhash),instructionsLength:new Uint8Array(r),serializedInstructions:t,addressTableLookupsLength:new Uint8Array(i),serializedAddressTableLookups:n},a);return a.slice(0,s)}},{key:"serializeInstructions",value:function(){var e,t=0,r=new Uint8Array(Kn),n=(0,c.Z)(this.compiledInstructions);try{for(n.s();!(e=n.n()).done;){var i=e.value,o=Array();ni(o,i.accountKeyIndexes.length);var a=Array();ni(a,i.data.length),t+=nt.struct([nt.u8("programIdIndex"),nt.blob(o.length,"encodedAccountKeyIndexesLength"),nt.seq(nt.u8(),i.accountKeyIndexes.length,"accountKeyIndexes"),nt.blob(a.length,"encodedDataLength"),nt.blob(i.data.length,"data")]).encode({programIdIndex:i.programIdIndex,encodedAccountKeyIndexesLength:new Uint8Array(o),accountKeyIndexes:i.accountKeyIndexes,encodedDataLength:new Uint8Array(a),data:i.data},r,t)}}catch(s){n.e(s)}finally{n.f()}return r.slice(0,t)}},{key:"serializeAddressTableLookups",value:function(){var e,t=0,r=new Uint8Array(Kn),n=(0,c.Z)(this.addressTableLookups);try{for(n.s();!(e=n.n()).done;){var i=e.value,o=Array();ni(o,i.writableIndexes.length);var a=Array();ni(a,i.readonlyIndexes.length),t+=nt.struct([$n("accountKey"),nt.blob(o.length,"encodedWritableIndexesLength"),nt.seq(nt.u8(),i.writableIndexes.length,"writableIndexes"),nt.blob(a.length,"encodedReadonlyIndexesLength"),nt.seq(nt.u8(),i.readonlyIndexes.length,"readonlyIndexes")]).encode({accountKey:i.accountKey.toBytes(),encodedWritableIndexesLength:new Uint8Array(o),writableIndexes:i.writableIndexes,encodedReadonlyIndexesLength:new Uint8Array(a),readonlyIndexes:i.readonlyIndexes},r,t)}}catch(s){n.e(s)}finally{n.f()}return r.slice(0,t)}}],[{key:"compile",value:function(t){var r,n=ai.compile(t.instructions,t.payerKey),i=new Array,o={writable:new Array,readonly:new Array},a=t.addressLookupTableAccounts||[],l=(0,c.Z)(a);try{for(l.s();!(r=l.n()).done;){var h=r.value,f=n.extractTableLookup(h);if(void 0!==f){var d,p,m=(0,s.Z)(f,2),g=m[0],y=m[1],v=y.writable,_=y.readonly;i.push(g),(d=o.writable).push.apply(d,(0,u.Z)(v)),(p=o.readonly).push.apply(p,(0,u.Z)(_))}}}catch(E){l.e(E)}finally{l.f()}var b=n.getMessageComponents(),x=(0,s.Z)(b,2),w=x[0],k=x[1],A=new Qn(k,o).compileInstructions(t.instructions);return new e({header:w,staticAccountKeys:k,recentBlockhash:t.recentBlockhash,compiledInstructions:A,addressTableLookups:i})}},{key:"deserialize",value:function(t){var r=(0,u.Z)(t),n=r.shift(),i=n&Gn;ii(n!==i,"Expected versioned message but received legacy message");ii(0===i,"Expected versioned message with version 0 but found version ".concat(i));for(var o={numRequiredSignatures:r.shift(),numReadonlySignedAccounts:r.shift(),numReadonlyUnsignedAccounts:r.shift()},a=[],s=ri(r),c=0;c<s;c++)a.push(new jn(r.splice(0,Zn)));for(var l=qe().encode(r.splice(0,Zn)),h=ri(r),f=[],d=0;d<h;d++){var p=r.shift(),m=ri(r),g=r.splice(0,m),y=ri(r),v=new Uint8Array(r.splice(0,y));f.push({programIdIndex:p,accountKeyIndexes:g,data:v})}for(var _=ri(r),b=[],x=0;x<_;x++){var w=new jn(r.splice(0,Zn)),k=ri(r),A=r.splice(0,k),E=ri(r),S=r.splice(0,E);b.push({accountKey:w,writableIndexes:A,readonlyIndexes:S})}return new e({header:o,staticAccountKeys:a,recentBlockhash:l,compiledInstructions:f,addressTableLookups:b})}}]),e}(),ci={deserializeMessageVersion:function(e){var t=e[0],r=t&Gn;return r===t?"legacy":r},deserialize:function(e){var t=ci.deserializeMessageVersion(e);if("legacy"===t)return si.from(e);if(0===t)return ui.deserialize(e);throw new Error("Transaction message version ".concat(t," deserialization is not supported"))}};!function(e){e[e.BLOCKHEIGHT_EXCEEDED=0]="BLOCKHEIGHT_EXCEEDED",e[e.PROCESSED=1]="PROCESSED",e[e.TIMED_OUT=2]="TIMED_OUT",e[e.NONCE_INVALID=3]="NONCE_INVALID"}(oi||(oi={}));var li=y.lW.alloc(Hn).fill(0),hi=function(){function e(t){(0,m.Z)(this,e),this.keys=void 0,this.programId=void 0,this.data=y.lW.alloc(0),this.programId=t.programId,this.keys=t.keys,t.data&&(this.data=t.data)}return(0,g.Z)(e,[{key:"toJSON",value:function(){return{keys:this.keys.map((function(e){var t=e.pubkey,r=e.isSigner,n=e.isWritable;return{pubkey:t.toJSON(),isSigner:r,isWritable:n}})),programId:this.programId.toJSON(),data:(0,u.Z)(this.data)}}}]),e}(),fi=function(){function e(t){if((0,m.Z)(this,e),this.signatures=[],this.feePayer=void 0,this.instructions=[],this.recentBlockhash=void 0,this.lastValidBlockHeight=void 0,this.nonceInfo=void 0,this.minNonceContextSlot=void 0,this._message=void 0,this._json=void 0,t)if(t.feePayer&&(this.feePayer=t.feePayer),t.signatures&&(this.signatures=t.signatures),Object.prototype.hasOwnProperty.call(t,"nonceInfo")){var r=t.minContextSlot,n=t.nonceInfo;this.minNonceContextSlot=r,this.nonceInfo=n}else if(Object.prototype.hasOwnProperty.call(t,"lastValidBlockHeight")){var i=t.blockhash,o=t.lastValidBlockHeight;this.recentBlockhash=i,this.lastValidBlockHeight=o}else{var a=t.recentBlockhash,s=t.nonceInfo;s&&(this.nonceInfo=s),this.recentBlockhash=a}}return(0,g.Z)(e,[{key:"signature",get:function(){return this.signatures.length>0?this.signatures[0].signature:null}},{key:"toJSON",value:function(){return{recentBlockhash:this.recentBlockhash||null,feePayer:this.feePayer?this.feePayer.toJSON():null,nonceInfo:this.nonceInfo?{nonce:this.nonceInfo.nonce,nonceInstruction:this.nonceInfo.nonceInstruction.toJSON()}:null,instructions:this.instructions.map((function(e){return e.toJSON()})),signers:this.signatures.map((function(e){return e.publicKey.toJSON()}))}}},{key:"add",value:function(){for(var e=this,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(0===r.length)throw new Error("No instructions");return r.forEach((function(t){"instructions"in t?e.instructions=e.instructions.concat(t.instructions):"data"in t&&"programId"in t&&"keys"in t?e.instructions.push(t):e.instructions.push(new hi(t))})),this}},{key:"compileMessage",value:function(){if(this._message&&JSON.stringify(this.toJSON())===JSON.stringify(this._json))return this._message;var e,t,r;if(this.nonceInfo?(e=this.nonceInfo.nonce,t=this.instructions[0]!=this.nonceInfo.nonceInstruction?[this.nonceInfo.nonceInstruction].concat((0,u.Z)(this.instructions)):this.instructions):(e=this.recentBlockhash,t=this.instructions),!e)throw new Error("Transaction recentBlockhash required");if(t.length<1&&console.warn("No instructions provided"),this.feePayer)r=this.feePayer;else{if(!(this.signatures.length>0&&this.signatures[0].publicKey))throw new Error("Transaction fee payer required");r=this.signatures[0].publicKey}for(var n=0;n<t.length;n++)if(void 0===t[n].programId)throw new Error("Transaction instruction index ".concat(n," has undefined program id"));var i=[],o=[];t.forEach((function(e){e.keys.forEach((function(e){o.push((0,a.Z)({},e))}));var t=e.programId.toString();i.includes(t)||i.push(t)})),i.forEach((function(e){o.push({pubkey:new jn(e),isSigner:!1,isWritable:!1})}));var l=[];o.forEach((function(e){var t=e.pubkey.toString(),r=l.findIndex((function(e){return e.pubkey.toString()===t}));r>-1?(l[r].isWritable=l[r].isWritable||e.isWritable,l[r].isSigner=l[r].isSigner||e.isSigner):l.push(e)})),l.sort((function(e,t){return e.isSigner!==t.isSigner?e.isSigner?-1:1:e.isWritable!==t.isWritable?e.isWritable?-1:1:e.pubkey.toBase58().localeCompare(t.pubkey.toBase58())}));var h=l.findIndex((function(e){return e.pubkey.equals(r)}));if(h>-1){var f=l.splice(h,1),d=(0,s.Z)(f,1)[0];d.isSigner=!0,d.isWritable=!0,l.unshift(d)}else l.unshift({pubkey:r,isSigner:!0,isWritable:!0});var p,m=(0,c.Z)(this.signatures);try{var g=function(){var e=p.value,t=l.findIndex((function(t){return t.pubkey.equals(e.publicKey)}));if(!(t>-1))throw new Error("unknown signer: ".concat(e.publicKey.toString()));l[t].isSigner||(l[t].isSigner=!0,console.warn("Transaction references a signature that is unnecessary, only the fee payer and instruction signer accounts should sign a transaction. This behavior is deprecated and will throw an error in the next major version release."))};for(m.s();!(p=m.n()).done;)g()}catch(A){m.e(A)}finally{m.f()}var y=0,v=0,_=0,b=[],x=[];l.forEach((function(e){var t=e.pubkey,r=e.isSigner,n=e.isWritable;r?(b.push(t.toString()),y+=1,n||(v+=1)):(x.push(t.toString()),n||(_+=1))}));var w=b.concat(x),k=t.map((function(e){var t=e.data,r=e.programId;return{programIdIndex:w.indexOf(r.toString()),accounts:e.keys.map((function(e){return w.indexOf(e.pubkey.toString())})),data:qe().encode(t)}}));return k.forEach((function(e){ii(e.programIdIndex>=0),e.accounts.forEach((function(e){return ii(e>=0)}))})),new si({header:{numRequiredSignatures:y,numReadonlySignedAccounts:v,numReadonlyUnsignedAccounts:_},accountKeys:w,recentBlockhash:e,instructions:k})}},{key:"_compile",value:function(){var e=this.compileMessage(),t=e.accountKeys.slice(0,e.header.numRequiredSignatures);if(this.signatures.length===t.length&&this.signatures.every((function(e,r){return t[r].equals(e.publicKey)})))return e;return this.signatures=t.map((function(e){return{signature:null,publicKey:e}})),e}},{key:"serializeMessage",value:function(){return this._compile().serialize()}},{key:"getEstimatedFee",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t){return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getFeeForMessage(this.compileMessage());case 2:return e.abrupt("return",e.sent.value);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setSigners",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];if(0===t.length)throw new Error("No signers");var n=new Set;this.signatures=t.filter((function(e){var t=e.toString();return!n.has(t)&&(n.add(t),!0)})).map((function(e){return{signature:null,publicKey:e}}))}},{key:"sign",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];if(0===t.length)throw new Error("No signers");for(var n=new Set,i=[],o=0,a=t;o<a.length;o++){var s=a[o],u=s.publicKey.toString();n.has(u)||(n.add(u),i.push(s))}this.signatures=i.map((function(e){return{signature:null,publicKey:e.publicKey}}));var c=this._compile();this._partialSign.apply(this,[c].concat(i))}},{key:"partialSign",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];if(0===t.length)throw new Error("No signers");for(var n=new Set,i=[],o=0,a=t;o<a.length;o++){var s=a[o],u=s.publicKey.toString();n.has(u)||(n.add(u),i.push(s))}var c=this._compile();this._partialSign.apply(this,[c].concat(i))}},{key:"_partialSign",value:function(e){for(var t=this,r=e.serialize(),n=arguments.length,i=new Array(n>1?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];i.forEach((function(e){var n=Dn(r,e.secretKey);t._addSignature(e.publicKey,Ln(n))}))}},{key:"addSignature",value:function(e,t){this._compile(),this._addSignature(e,t)}},{key:"_addSignature",value:function(e,t){ii(64===t.length);var r=this.signatures.findIndex((function(t){return e.equals(t.publicKey)}));if(r<0)throw new Error("unknown signer: ".concat(e.toString()));this.signatures[r].signature=y.lW.from(t)}},{key:"verifySignatures",value:function(e){return this._verifySignatures(this.serializeMessage(),void 0===e||e)}},{key:"_verifySignatures",value:function(e,t){var r,n=(0,c.Z)(this.signatures);try{for(n.s();!(r=n.n()).done;){var i=r.value,o=i.signature,a=i.publicKey;if(null===o){if(t)return!1}else if(!Rn(o,e,a.toBytes()))return!1}}catch(s){n.e(s)}finally{n.f()}return!0}},{key:"serialize",value:function(e){var t=Object.assign({requireAllSignatures:!0,verifySignatures:!0},e),r=t.requireAllSignatures,n=t.verifySignatures,i=this.serializeMessage();if(n&&!this._verifySignatures(i,r))throw new Error("Signature verification failed");return this._serialize(i)}},{key:"_serialize",value:function(e){var t=this.signatures,r=[];ni(r,t.length);var n=r.length+64*t.length+e.length,i=y.lW.alloc(n);return ii(t.length<256),y.lW.from(r).copy(i,0),t.forEach((function(e,t){var n=e.signature;null!==n&&(ii(64===n.length,"signature has invalid length"),y.lW.from(n).copy(i,r.length+64*t))})),e.copy(i,r.length+64*t.length),ii(i.length<=Kn,"Transaction too large: ".concat(i.length," > ").concat(Kn)),i}},{key:"keys",get:function(){return ii(1===this.instructions.length),this.instructions[0].keys.map((function(e){return e.pubkey}))}},{key:"programId",get:function(){return ii(1===this.instructions.length),this.instructions[0].programId}},{key:"data",get:function(){return ii(1===this.instructions.length),this.instructions[0].data}}],[{key:"from",value:function(t){for(var r=(0,u.Z)(t),n=ri(r),i=[],o=0;o<n;o++){var a=r.slice(0,Hn);r=r.slice(Hn),i.push(qe().encode(y.lW.from(a)))}return e.populate(si.from(r),i)}},{key:"populate",value:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=new e;return n.recentBlockhash=t.recentBlockhash,t.header.numRequiredSignatures>0&&(n.feePayer=t.accountKeys[0]),r.forEach((function(e,r){var i={signature:e==qe().encode(li)?null:qe().decode(e),publicKey:t.accountKeys[r]};n.signatures.push(i)})),t.instructions.forEach((function(e){var r=e.accounts.map((function(e){var r=t.accountKeys[e];return{pubkey:r,isSigner:n.signatures.some((function(e){return e.publicKey.toString()===r.toString()}))||t.isAccountSigner(e),isWritable:t.isAccountWritable(e)}}));n.instructions.push(new hi({keys:r,programId:t.accountKeys[e.programIdIndex],data:qe().decode(e.data)}))})),n._message=t,n._json=n.toJSON(),n}}]),e}(),di=function(){function e(t){(0,m.Z)(this,e),this.payerKey=void 0,this.instructions=void 0,this.recentBlockhash=void 0,this.payerKey=t.payerKey,this.instructions=t.instructions,this.recentBlockhash=t.recentBlockhash}return(0,g.Z)(e,[{key:"compileToLegacyMessage",value:function(){return si.compile({payerKey:this.payerKey,recentBlockhash:this.recentBlockhash,instructions:this.instructions})}},{key:"compileToV0Message",value:function(e){return ui.compile({payerKey:this.payerKey,recentBlockhash:this.recentBlockhash,instructions:this.instructions,addressLookupTableAccounts:e})}}],[{key:"decompile",value:function(t,r){var n=t.header,i=t.compiledInstructions,o=t.recentBlockhash,a=n.numRequiredSignatures,s=n.numReadonlySignedAccounts,u=n.numReadonlyUnsignedAccounts,l=a-s;ii(l>0,"Message header is invalid");var h=t.staticAccountKeys.length-a-u;ii(h>=0,"Message header is invalid");var f=t.getAccountKeys(r),d=f.get(0);if(void 0===d)throw new Error("Failed to decompile message because no account keys were found");var p,m=[],g=(0,c.Z)(i);try{for(g.s();!(p=g.n()).done;){var y,v=p.value,_=[],b=(0,c.Z)(v.accountKeyIndexes);try{for(b.s();!(y=b.n()).done;){var x=y.value,w=f.get(x);if(void 0===w)throw new Error("Failed to find key for account key index ".concat(x));var k=void 0;k=x<a?x<l:x<f.staticAccountKeys.length?x-a<h:x-f.staticAccountKeys.length<f.accountKeysFromLookups.writable.length,_.push({pubkey:w,isSigner:x<n.numRequiredSignatures,isWritable:k})}}catch(E){b.e(E)}finally{b.f()}var A=f.get(v.programIdIndex);if(void 0===A)throw new Error("Failed to find program id for program id index ".concat(v.programIdIndex));m.push(new hi({programId:A,data:Ln(v.data),keys:_}))}}catch(E){g.e(E)}finally{g.f()}return new e({payerKey:d,instructions:m,recentBlockhash:o})}}]),e}(),pi=function(){function e(t,r){if((0,m.Z)(this,e),this.signatures=void 0,this.message=void 0,void 0!==r)ii(r.length===t.header.numRequiredSignatures,"Expected signatures length to be equal to the number of required signatures"),this.signatures=r;else{for(var n=[],i=0;i<t.header.numRequiredSignatures;i++)n.push(new Uint8Array(Hn));this.signatures=n}this.message=t}return(0,g.Z)(e,[{key:"version",get:function(){return this.message.version}},{key:"serialize",value:function(){var e=this.message.serialize(),t=Array();ni(t,this.signatures.length);var r=nt.struct([nt.blob(t.length,"encodedSignaturesLength"),nt.seq(Jn(),this.signatures.length,"signatures"),nt.blob(e.length,"serializedMessage")]),n=new Uint8Array(2048),i=r.encode({encodedSignaturesLength:new Uint8Array(t),signatures:this.signatures,serializedMessage:e},n);return n.slice(0,i)}},{key:"sign",value:function(e){var t,r=this,n=this.message.serialize(),i=this.message.staticAccountKeys.slice(0,this.message.header.numRequiredSignatures),o=(0,c.Z)(e);try{var a=function(){var e=t.value,o=i.findIndex((function(t){return t.equals(e.publicKey)}));ii(o>=0,"Cannot sign with non signer key ".concat(e.publicKey.toBase58())),r.signatures[o]=Dn(n,e.secretKey)};for(o.s();!(t=o.n()).done;)a()}catch(s){o.e(s)}finally{o.f()}}},{key:"addSignature",value:function(e,t){ii(64===t.byteLength,"Signature must be 64 bytes long");var r=this.message.staticAccountKeys.slice(0,this.message.header.numRequiredSignatures).findIndex((function(t){return t.equals(e)}));ii(r>=0,"Can not add signature; `".concat(e.toBase58(),"` is not required to sign this transaction")),this.signatures[r]=t}}],[{key:"deserialize",value:function(t){for(var r=(0,u.Z)(t),n=[],i=ri(r),o=0;o<i;o++)n.push(new Uint8Array(r.splice(0,Hn)));return new e(ci.deserialize(new Uint8Array(r)),n)}}]),e}(),mi=new jn("SysvarC1ock11111111111111111111111111111111"),gi=new jn("SysvarEpochSchedu1e111111111111111111111111"),yi=new jn("Sysvar1nstructions1111111111111111111111111"),vi=new jn("SysvarRecentB1ockHashes11111111111111111111"),_i=new jn("SysvarRent111111111111111111111111111111111"),bi=new jn("SysvarRewards111111111111111111111111111111"),xi=new jn("SysvarS1otHashes111111111111111111111111111"),wi=new jn("SysvarS1otHistory11111111111111111111111111"),ki=new jn("SysvarStakeHistory1111111111111111111111111");function Ai(e,t,r,n){return Ei.apply(this,arguments)}function Ei(){return Ei=(0,f.Z)((0,h.Z)().mark((function e(t,r,n,i){var o,a,s,u,c;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=i&&{skipPreflight:i.skipPreflight,preflightCommitment:i.preflightCommitment||i.commitment,maxRetries:i.maxRetries,minContextSlot:i.minContextSlot},e.next=3,t.sendTransaction(r,n,o);case 3:if(a=e.sent,null==r.recentBlockhash||null==r.lastValidBlockHeight){e.next=10;break}return e.next=7,t.confirmTransaction({abortSignal:null===i||void 0===i?void 0:i.abortSignal,signature:a,blockhash:r.recentBlockhash,lastValidBlockHeight:r.lastValidBlockHeight},i&&i.commitment);case 7:s=e.sent.value,e.next=22;break;case 10:if(null==r.minNonceContextSlot||null==r.nonceInfo){e.next=18;break}return u=r.nonceInfo.nonceInstruction,c=u.keys[0].pubkey,e.next=15,t.confirmTransaction({abortSignal:null===i||void 0===i?void 0:i.abortSignal,minContextSlot:r.minNonceContextSlot,nonceAccountPubkey:c,nonceValue:r.nonceInfo.nonce,signature:a},i&&i.commitment);case 15:s=e.sent.value,e.next=22;break;case 18:return null!=(null===i||void 0===i?void 0:i.abortSignal)&&console.warn("sendAndConfirmTransaction(): A transaction with a deprecated confirmation strategy was supplied along with an `abortSignal`. Only transactions having `lastValidBlockHeight` or a combination of `nonceInfo` and `minNonceContextSlot` are abortable."),e.next=21,t.confirmTransaction(a,i&&i.commitment);case 21:s=e.sent.value;case 22:if(!s.err){e.next=24;break}throw new Error("Transaction ".concat(a," failed (").concat(JSON.stringify(s),")"));case 24:return e.abrupt("return",a);case 25:case"end":return e.stop()}}),e)}))),Ei.apply(this,arguments)}function Si(e){return new Promise((function(t){return setTimeout(t,e)}))}function Ti(e,t){var r=e.layout.span>=0?e.layout.span:ti(e,t),n=y.lW.alloc(r),i=Object.assign({instruction:e.index},t);return e.layout.encode(i,n),n}function Mi(e,t){var r;try{r=e.layout.decode(t)}catch(n){throw new Error("invalid instruction; "+n)}if(r.instruction!==e.index)throw new Error("invalid instruction; instruction index mismatch ".concat(r.instruction," != ").concat(e.index));return r}var Ii,Pi=nt.nu64("lamportsPerSignature"),Ci=nt.struct([nt.u32("version"),nt.u32("state"),$n("authorizedPubkey"),$n("nonce"),nt.struct([Pi],"feeCalculator")]),Bi=Ci.span,Di=function(){function e(t){(0,m.Z)(this,e),this.authorizedPubkey=void 0,this.nonce=void 0,this.feeCalculator=void 0,this.authorizedPubkey=t.authorizedPubkey,this.nonce=t.nonce,this.feeCalculator=t.feeCalculator}return(0,g.Z)(e,null,[{key:"fromAccountData",value:function(t){var r=Ci.decode(Ln(t),0);return new e({authorizedPubkey:new jn(r.authorizedPubkey),nonce:new jn(r.nonce).toString(),feeCalculator:r.feeCalculator})}}]),e}(),Ri=(Ii=8,function(e){var t=(0,nt.blob)(Ii,e),r=function(e){return{decode:e.decode.bind(e),encode:e.encode.bind(e)}}(t),n=r.encode,i=r.decode,o=t;return o.decode=function(e,t){var r=i(e,t);return(0,it.oU)(y.lW.from(r))},o.encode=function(e,t,r){var i=(0,it.k$)(e,Ii);return n(i,t,r)},o}),Li=function(){function e(){(0,m.Z)(this,e)}return(0,g.Z)(e,null,[{key:"decodeInstructionType",value:function(e){this.checkProgramId(e.programId);for(var t,r=nt.u32("instruction").decode(e.data),n=0,i=Object.entries(Oi);n<i.length;n++){var o=(0,s.Z)(i[n],2),a=o[0];if(o[1].index==r){t=a;break}}if(!t)throw new Error("Instruction type incorrect; not a SystemInstruction");return t}},{key:"decodeCreateAccount",value:function(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);var t=Mi(Oi.Create,e.data),r=t.lamports,n=t.space,i=t.programId;return{fromPubkey:e.keys[0].pubkey,newAccountPubkey:e.keys[1].pubkey,lamports:r,space:n,programId:new jn(i)}}},{key:"decodeTransfer",value:function(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);var t=Mi(Oi.Transfer,e.data).lamports;return{fromPubkey:e.keys[0].pubkey,toPubkey:e.keys[1].pubkey,lamports:t}}},{key:"decodeTransferWithSeed",value:function(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);var t=Mi(Oi.TransferWithSeed,e.data),r=t.lamports,n=t.seed,i=t.programId;return{fromPubkey:e.keys[0].pubkey,basePubkey:e.keys[1].pubkey,toPubkey:e.keys[2].pubkey,lamports:r,seed:n,programId:new jn(i)}}},{key:"decodeAllocate",value:function(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,1);var t=Mi(Oi.Allocate,e.data).space;return{accountPubkey:e.keys[0].pubkey,space:t}}},{key:"decodeAllocateWithSeed",value:function(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,1);var t=Mi(Oi.AllocateWithSeed,e.data),r=t.base,n=t.seed,i=t.space,o=t.programId;return{accountPubkey:e.keys[0].pubkey,basePubkey:new jn(r),seed:n,space:i,programId:new jn(o)}}},{key:"decodeAssign",value:function(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,1);var t=Mi(Oi.Assign,e.data).programId;return{accountPubkey:e.keys[0].pubkey,programId:new jn(t)}}},{key:"decodeAssignWithSeed",value:function(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,1);var t=Mi(Oi.AssignWithSeed,e.data),r=t.base,n=t.seed,i=t.programId;return{accountPubkey:e.keys[0].pubkey,basePubkey:new jn(r),seed:n,programId:new jn(i)}}},{key:"decodeCreateWithSeed",value:function(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);var t=Mi(Oi.CreateWithSeed,e.data),r=t.base,n=t.seed,i=t.lamports,o=t.space,a=t.programId;return{fromPubkey:e.keys[0].pubkey,newAccountPubkey:e.keys[1].pubkey,basePubkey:new jn(r),seed:n,lamports:i,space:o,programId:new jn(a)}}},{key:"decodeNonceInitialize",value:function(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);var t=Mi(Oi.InitializeNonceAccount,e.data).authorized;return{noncePubkey:e.keys[0].pubkey,authorizedPubkey:new jn(t)}}},{key:"decodeNonceAdvance",value:function(e){return this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3),Mi(Oi.AdvanceNonceAccount,e.data),{noncePubkey:e.keys[0].pubkey,authorizedPubkey:e.keys[2].pubkey}}},{key:"decodeNonceWithdraw",value:function(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,5);var t=Mi(Oi.WithdrawNonceAccount,e.data).lamports;return{noncePubkey:e.keys[0].pubkey,toPubkey:e.keys[1].pubkey,authorizedPubkey:e.keys[4].pubkey,lamports:t}}},{key:"decodeNonceAuthorize",value:function(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);var t=Mi(Oi.AuthorizeNonceAccount,e.data).authorized;return{noncePubkey:e.keys[0].pubkey,authorizedPubkey:e.keys[1].pubkey,newAuthorizedPubkey:new jn(t)}}},{key:"checkProgramId",value:function(e){if(!e.equals(zi.programId))throw new Error("invalid instruction; programId is not SystemProgram")}},{key:"checkKeyLength",value:function(e,t){if(e.length<t)throw new Error("invalid instruction; found ".concat(e.length," keys, expected at least ").concat(t))}}]),e}(),Oi=Object.freeze({Create:{index:0,layout:nt.struct([nt.u32("instruction"),nt.ns64("lamports"),nt.ns64("space"),$n("programId")])},Assign:{index:1,layout:nt.struct([nt.u32("instruction"),$n("programId")])},Transfer:{index:2,layout:nt.struct([nt.u32("instruction"),Ri("lamports")])},CreateWithSeed:{index:3,layout:nt.struct([nt.u32("instruction"),$n("base"),ei("seed"),nt.ns64("lamports"),nt.ns64("space"),$n("programId")])},AdvanceNonceAccount:{index:4,layout:nt.struct([nt.u32("instruction")])},WithdrawNonceAccount:{index:5,layout:nt.struct([nt.u32("instruction"),nt.ns64("lamports")])},InitializeNonceAccount:{index:6,layout:nt.struct([nt.u32("instruction"),$n("authorized")])},AuthorizeNonceAccount:{index:7,layout:nt.struct([nt.u32("instruction"),$n("authorized")])},Allocate:{index:8,layout:nt.struct([nt.u32("instruction"),nt.ns64("space")])},AllocateWithSeed:{index:9,layout:nt.struct([nt.u32("instruction"),$n("base"),ei("seed"),nt.ns64("space"),$n("programId")])},AssignWithSeed:{index:10,layout:nt.struct([nt.u32("instruction"),$n("base"),ei("seed"),$n("programId")])},TransferWithSeed:{index:11,layout:nt.struct([nt.u32("instruction"),Ri("lamports"),ei("seed"),$n("programId")])},UpgradeNonceAccount:{index:12,layout:nt.struct([nt.u32("instruction")])}}),zi=function(){function e(){(0,m.Z)(this,e)}return(0,g.Z)(e,null,[{key:"createAccount",value:function(e){var t=Ti(Oi.Create,{lamports:e.lamports,space:e.space,programId:Ln(e.programId.toBuffer())});return new hi({keys:[{pubkey:e.fromPubkey,isSigner:!0,isWritable:!0},{pubkey:e.newAccountPubkey,isSigner:!0,isWritable:!0}],programId:this.programId,data:t})}},{key:"transfer",value:function(e){var t,r;"basePubkey"in e?(t=Ti(Oi.TransferWithSeed,{lamports:BigInt(e.lamports),seed:e.seed,programId:Ln(e.programId.toBuffer())}),r=[{pubkey:e.fromPubkey,isSigner:!1,isWritable:!0},{pubkey:e.basePubkey,isSigner:!0,isWritable:!1},{pubkey:e.toPubkey,isSigner:!1,isWritable:!0}]):(t=Ti(Oi.Transfer,{lamports:BigInt(e.lamports)}),r=[{pubkey:e.fromPubkey,isSigner:!0,isWritable:!0},{pubkey:e.toPubkey,isSigner:!1,isWritable:!0}]);return new hi({keys:r,programId:this.programId,data:t})}},{key:"assign",value:function(e){var t,r;"basePubkey"in e?(t=Ti(Oi.AssignWithSeed,{base:Ln(e.basePubkey.toBuffer()),seed:e.seed,programId:Ln(e.programId.toBuffer())}),r=[{pubkey:e.accountPubkey,isSigner:!1,isWritable:!0},{pubkey:e.basePubkey,isSigner:!0,isWritable:!1}]):(t=Ti(Oi.Assign,{programId:Ln(e.programId.toBuffer())}),r=[{pubkey:e.accountPubkey,isSigner:!0,isWritable:!0}]);return new hi({keys:r,programId:this.programId,data:t})}},{key:"createAccountWithSeed",value:function(e){var t=Ti(Oi.CreateWithSeed,{base:Ln(e.basePubkey.toBuffer()),seed:e.seed,lamports:e.lamports,space:e.space,programId:Ln(e.programId.toBuffer())}),r=[{pubkey:e.fromPubkey,isSigner:!0,isWritable:!0},{pubkey:e.newAccountPubkey,isSigner:!1,isWritable:!0}];return e.basePubkey!=e.fromPubkey&&r.push({pubkey:e.basePubkey,isSigner:!0,isWritable:!1}),new hi({keys:r,programId:this.programId,data:t})}},{key:"createNonceAccount",value:function(t){var r=new fi;"basePubkey"in t&&"seed"in t?r.add(e.createAccountWithSeed({fromPubkey:t.fromPubkey,newAccountPubkey:t.noncePubkey,basePubkey:t.basePubkey,seed:t.seed,lamports:t.lamports,space:Bi,programId:this.programId})):r.add(e.createAccount({fromPubkey:t.fromPubkey,newAccountPubkey:t.noncePubkey,lamports:t.lamports,space:Bi,programId:this.programId}));var n={noncePubkey:t.noncePubkey,authorizedPubkey:t.authorizedPubkey};return r.add(this.nonceInitialize(n)),r}},{key:"nonceInitialize",value:function(e){var t=Ti(Oi.InitializeNonceAccount,{authorized:Ln(e.authorizedPubkey.toBuffer())}),r={keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:vi,isSigner:!1,isWritable:!1},{pubkey:_i,isSigner:!1,isWritable:!1}],programId:this.programId,data:t};return new hi(r)}},{key:"nonceAdvance",value:function(e){var t=Ti(Oi.AdvanceNonceAccount),r={keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:vi,isSigner:!1,isWritable:!1},{pubkey:e.authorizedPubkey,isSigner:!0,isWritable:!1}],programId:this.programId,data:t};return new hi(r)}},{key:"nonceWithdraw",value:function(e){var t=Ti(Oi.WithdrawNonceAccount,{lamports:e.lamports});return new hi({keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:e.toPubkey,isSigner:!1,isWritable:!0},{pubkey:vi,isSigner:!1,isWritable:!1},{pubkey:_i,isSigner:!1,isWritable:!1},{pubkey:e.authorizedPubkey,isSigner:!0,isWritable:!1}],programId:this.programId,data:t})}},{key:"nonceAuthorize",value:function(e){var t=Ti(Oi.AuthorizeNonceAccount,{authorized:Ln(e.newAuthorizedPubkey.toBuffer())});return new hi({keys:[{pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{pubkey:e.authorizedPubkey,isSigner:!0,isWritable:!1}],programId:this.programId,data:t})}},{key:"allocate",value:function(e){var t,r;"basePubkey"in e?(t=Ti(Oi.AllocateWithSeed,{base:Ln(e.basePubkey.toBuffer()),seed:e.seed,space:e.space,programId:Ln(e.programId.toBuffer())}),r=[{pubkey:e.accountPubkey,isSigner:!1,isWritable:!0},{pubkey:e.basePubkey,isSigner:!0,isWritable:!1}]):(t=Ti(Oi.Allocate,{space:e.space}),r=[{pubkey:e.accountPubkey,isSigner:!0,isWritable:!0}]);return new hi({keys:r,programId:this.programId,data:t})}}]),e}();zi.programId=new jn("11111111111111111111111111111111");var Ni=Kn-300,Ui=function(){function e(){(0,m.Z)(this,e)}return(0,g.Z)(e,null,[{key:"getMinNumSignatures",value:function(t){return 2*(Math.ceil(t/e.chunkSize)+1+1)}},{key:"load",value:function(){var t=(0,f.Z)((0,h.Z)().mark((function t(r,n,i,o,a){var s,u,c,l,f,d,p,m,g,v,_,b,x,w;return(0,h.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,r.getMinimumBalanceForRentExemption(a.length);case 2:return s=t.sent,t.next=5,r.getAccountInfo(i.publicKey,"confirmed");case 5:if(u=t.sent,c=null,null===u){t.next=16;break}if(!u.executable){t.next=11;break}return console.error("Program load failed, account is already executable"),t.abrupt("return",!1);case 11:u.data.length!==a.length&&(c=c||new fi).add(zi.allocate({accountPubkey:i.publicKey,space:a.length})),u.owner.equals(o)||(c=c||new fi).add(zi.assign({accountPubkey:i.publicKey,programId:o})),u.lamports<s&&(c=c||new fi).add(zi.transfer({fromPubkey:n.publicKey,toPubkey:i.publicKey,lamports:s-u.lamports})),t.next=17;break;case 16:c=(new fi).add(zi.createAccount({fromPubkey:n.publicKey,newAccountPubkey:i.publicKey,lamports:s>0?s:1,space:a.length,programId:o}));case 17:if(null===c){t.next=20;break}return t.next=20,Ai(r,c,[n,i],{commitment:"confirmed"});case 20:l=nt.struct([nt.u32("instruction"),nt.u32("offset"),nt.u32("bytesLength"),nt.u32("bytesLengthPadding"),nt.seq(nt.u8("byte"),nt.offset(nt.u32(),-8),"bytes")]),f=e.chunkSize,d=0,p=a,m=[];case 25:if(!(p.length>0)){t.next=39;break}if(g=p.slice(0,f),v=y.lW.alloc(f+16),l.encode({instruction:0,offset:d,bytes:g,bytesLength:0,bytesLengthPadding:0},v),_=(new fi).add({keys:[{pubkey:i.publicKey,isSigner:!0,isWritable:!0}],programId:o,data:v}),m.push(Ai(r,_,[n,i],{commitment:"confirmed"})),!r._rpcEndpoint.includes("solana.com")){t.next=35;break}return 4,t.next=35,Si(250);case 35:d+=f,p=p.slice(f),t.next=25;break;case 39:return t.next=41,Promise.all(m);case 41:return b=nt.struct([nt.u32("instruction")]),x=y.lW.alloc(b.span),b.encode({instruction:1},x),w=(new fi).add({keys:[{pubkey:i.publicKey,isSigner:!0,isWritable:!0},{pubkey:_i,isSigner:!1,isWritable:!1}],programId:o,data:x}),t.next=47,Ai(r,w,[n,i],{commitment:"confirmed"});case 47:return t.abrupt("return",!0);case 48:case"end":return t.stop()}}),t)})));return function(e,r,n,i,o){return t.apply(this,arguments)}}()}]),e}();Ui.chunkSize=Ni;var Zi=new jn("BPFLoader2111111111111111111111111111111111"),Fi=function(){function e(){(0,m.Z)(this,e)}return(0,g.Z)(e,null,[{key:"getMinNumSignatures",value:function(e){return Ui.getMinNumSignatures(e)}},{key:"load",value:function(e,t,r,n,i){return Ui.load(e,t,r,i,n)}}]),e}(),ji=Object.prototype.toString,Vi=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};function Wi(e,t){var r,n,i,o,a,s,u;if(!0===e)return"true";if(!1===e)return"false";switch(typeof e){case"object":if(null===e)return null;if(e.toJSON&&"function"===typeof e.toJSON)return Wi(e.toJSON(),t);if("[object Array]"===(u=ji.call(e))){for(i="[",n=e.length-1,r=0;r<n;r++)i+=Wi(e[r],!0)+",";return n>-1&&(i+=Wi(e[r],!0)),i+"]"}if("[object Object]"===u){for(n=(o=Vi(e).sort()).length,i="",r=0;r<n;)void 0!==(s=Wi(e[a=o[r]],!1))&&(i&&(i+=","),i+=JSON.stringify(a)+":"+s),r++;return"{"+i+"}"}return JSON.stringify(e);case"function":case"undefined":return t?null:void 0;case"string":return JSON.stringify(e);default:return isFinite(e)?e:null}}var Ki=function(e){var t=Wi(e,!1);if(void 0!==t)return""+t};function Gi(e){for(var t=0;e>1;)e/=2,t++;return t}var Hi=function(){function e(t,r,n,i,o){(0,m.Z)(this,e),this.slotsPerEpoch=void 0,this.leaderScheduleSlotOffset=void 0,this.warmup=void 0,this.firstNormalEpoch=void 0,this.firstNormalSlot=void 0,this.slotsPerEpoch=t,this.leaderScheduleSlotOffset=r,this.warmup=n,this.firstNormalEpoch=i,this.firstNormalSlot=o}return(0,g.Z)(e,[{key:"getEpoch",value:function(e){return this.getEpochAndSlotIndex(e)[0]}},{key:"getEpochAndSlotIndex",value:function(e){if(e<this.firstNormalSlot){var t=Gi(0===(r=e+32+1)?1:(r--,r|=r>>1,r|=r>>2,r|=r>>4,r|=r>>8,r|=r>>16,1+(r|=r>>32)))-Gi(32)-1;return[t,e-(this.getSlotsInEpoch(t)-32)]}var r,n=e-this.firstNormalSlot,i=Math.floor(n/this.slotsPerEpoch);return[this.firstNormalEpoch+i,n%this.slotsPerEpoch]}},{key:"getFirstSlotInEpoch",value:function(e){return e<=this.firstNormalEpoch?32*(Math.pow(2,e)-1):(e-this.firstNormalEpoch)*this.slotsPerEpoch+this.firstNormalSlot}},{key:"getLastSlotInEpoch",value:function(e){return this.getFirstSlotInEpoch(e)+this.getSlotsInEpoch(e)-1}},{key:"getSlotsInEpoch",value:function(e){return e<this.firstNormalEpoch?Math.pow(2,e+Gi(32)):this.slotsPerEpoch}}]),e}(),qi=function(e){(0,d.Z)(r,e);var t=(0,p.Z)(r);function r(e,n){var i;return(0,m.Z)(this,r),(i=t.call(this,e)).logs=void 0,i.logs=n,i}return(0,g.Z)(r)}((0,l.Z)(Error)),Yi={JSON_RPC_SERVER_ERROR_BLOCK_CLEANED_UP:-32001,JSON_RPC_SERVER_ERROR_SEND_TRANSACTION_PREFLIGHT_FAILURE:-32002,JSON_RPC_SERVER_ERROR_TRANSACTION_SIGNATURE_VERIFICATION_FAILURE:-32003,JSON_RPC_SERVER_ERROR_BLOCK_NOT_AVAILABLE:-32004,JSON_RPC_SERVER_ERROR_NODE_UNHEALTHY:-32005,JSON_RPC_SERVER_ERROR_TRANSACTION_PRECOMPILE_VERIFICATION_FAILURE:-32006,JSON_RPC_SERVER_ERROR_SLOT_SKIPPED:-32007,JSON_RPC_SERVER_ERROR_NO_SNAPSHOT:-32008,JSON_RPC_SERVER_ERROR_LONG_TERM_STORAGE_SLOT_SKIPPED:-32009,JSON_RPC_SERVER_ERROR_KEY_EXCLUDED_FROM_SECONDARY_INDEX:-32010,JSON_RPC_SERVER_ERROR_TRANSACTION_HISTORY_NOT_AVAILABLE:-32011,JSON_RPC_SCAN_ERROR:-32012,JSON_RPC_SERVER_ERROR_TRANSACTION_SIGNATURE_LEN_MISMATCH:-32013,JSON_RPC_SERVER_ERROR_BLOCK_STATUS_NOT_AVAILABLE_YET:-32014,JSON_RPC_SERVER_ERROR_UNSUPPORTED_TRANSACTION_VERSION:-32015,JSON_RPC_SERVER_ERROR_MIN_CONTEXT_SLOT_NOT_REACHED:-32016},Xi=function(e){(0,d.Z)(r,e);var t=(0,p.Z)(r);function r(e,n){var i,o=e.code,a=e.message,s=e.data;return(0,m.Z)(this,r),(i=t.call(this,null!=n?"".concat(n,": ").concat(a):a)).code=void 0,i.data=void 0,i.code=o,i.data=s,i.name="SolanaJSONRPCError",i}return(0,g.Z)(r)}((0,l.Z)(Error)),Qi=globalThis.fetch,$i=function(e){(0,d.Z)(r,e);var t=(0,p.Z)(r);function r(e,n,i){var o;(0,m.Z)(this,r);return(o=t.call(this,(function(e){var t=(0,Vt.Z)(e,(0,a.Z)({autoconnect:!0,max_reconnects:5,reconnect:!0,reconnect_interval:1e3},n));return o.underlyingSocket="socket"in t?t.socket:t,t}),e,n,i)).underlyingSocket=void 0,o}return(0,g.Z)(r,[{key:"call",value:function(){for(var e,t,n=null===(e=this.underlyingSocket)||void 0===e?void 0:e.readyState,a=arguments.length,s=new Array(a),u=0;u<a;u++)s[u]=arguments[u];return 1===n?(t=(0,i.Z)((0,o.Z)(r.prototype),"call",this)).call.apply(t,[this].concat(s)):Promise.reject(new Error("Tried to call a JSON-RPC method `"+s[0]+"` but the socket was not `CONNECTING` or `OPEN` (`readyState` was "+n+")"))}},{key:"notify",value:function(){for(var e,t,n=null===(e=this.underlyingSocket)||void 0===e?void 0:e.readyState,a=arguments.length,s=new Array(a),u=0;u<a;u++)s[u]=arguments[u];return 1===n?(t=(0,i.Z)((0,o.Z)(r.prototype),"notify",this)).call.apply(t,[this].concat(s)):Promise.reject(new Error("Tried to send a JSON-RPC notification `"+s[0]+"` but the socket was not `CONNECTING` or `OPEN` (`readyState` was "+n+")"))}}]),r}(jt.Z);var Ji=function(){function e(t){(0,m.Z)(this,e),this.key=void 0,this.state=void 0,this.key=t.key,this.state=t.state}return(0,g.Z)(e,[{key:"isActive",value:function(){var e=BigInt("0xffffffffffffffff");return this.state.deactivationSlot===e}}],[{key:"deserialize",value:function(e){var t=function(e,t){var r;try{r=e.layout.decode(t)}catch(n){throw new Error("invalid instruction; "+n)}if(r.typeIndex!==e.index)throw new Error("invalid account data; account type mismatch ".concat(r.typeIndex," != ").concat(e.index));return r}(eo,e),r=e.length-56;ii(r>=0,"lookup table is invalid"),ii(r%32===0,"lookup table is invalid");var n=r/32,i=nt.struct([nt.seq($n(),n,"addresses")]).decode(e.slice(56)).addresses;return{deactivationSlot:t.deactivationSlot,lastExtendedSlot:t.lastExtendedSlot,lastExtendedSlotStartIndex:t.lastExtendedStartIndex,authority:0!==t.authority.length?new jn(t.authority[0]):void 0,addresses:i.map((function(e){return new jn(e)}))}}}]),e}(),eo={index:1,layout:nt.struct([nt.u32("typeIndex"),Ri("deactivationSlot"),nt.nu64("lastExtendedSlot"),nt.u8("lastExtendedStartIndex"),nt.u8(),nt.seq($n(),nt.offset(nt.u8(),-1),"authority")])},to=/^[^:]+:\/\/([^:[]+|\[[^\]]+\])(:\d+)?(.*)/i;var ro=Ut(Tt(jn),Rt(),(function(e){return new jn(e)})),no=Lt([Rt(),Mt("base64")]),io=Ut(Tt(y.lW),no,(function(e){return y.lW.from(e[0],"base64")})),oo=3e4;function ao(e){var t,r;if("string"===typeof e)t=e;else if(e){t=e.commitment,r=(0,n.Z)(e,An)}return{commitment:t,config:r}}function so(e){return zt([Ot({jsonrpc:Mt("2.0"),id:Rt(),result:e}),Ot({jsonrpc:Mt("2.0"),id:Rt(),error:Ot({code:Nt(),message:Rt(),data:Bt(At("any",(function(){return!0})))})})])}var uo=so(Nt());function co(e){return Ut(so(e),uo,(function(t){return"error"in t?t:(0,a.Z)((0,a.Z)({},t),{},{result:xt(t.result,e)})}))}function lo(e){return co(Ot({context:Ot({slot:Ct()}),value:e}))}function ho(e){return Ot({context:Ot({slot:Ct()}),value:e})}function fo(e,t){return 0===e?new ui({header:t.header,staticAccountKeys:t.accountKeys.map((function(e){return new jn(e)})),recentBlockhash:t.recentBlockhash,compiledInstructions:t.instructions.map((function(e){return{programIdIndex:e.programIdIndex,accountKeyIndexes:e.accounts,data:qe().decode(e.data)}})),addressTableLookups:t.addressTableLookups}):new si(t)}var po=Ot({foundation:Ct(),foundationTerm:Ct(),initial:Ct(),taper:Ct(),terminal:Ct()}),mo=co(Et(Pt(Ot({epoch:Ct(),effectiveSlot:Ct(),amount:Ct(),postBalance:Ct(),commission:Bt(Pt(Ct()))})))),go=Ot({total:Ct(),validator:Ct(),foundation:Ct(),epoch:Ct()}),yo=Ot({epoch:Ct(),slotIndex:Ct(),slotsInEpoch:Ct(),absoluteSlot:Ct(),blockHeight:Bt(Ct()),transactionCount:Bt(Ct())}),vo=Ot({slotsPerEpoch:Ct(),leaderScheduleSlotOffset:Ct(),warmup:St(),firstNormalEpoch:Ct(),firstNormalSlot:Ct()}),_o=Dt(Rt(),Et(Ct())),bo=Pt(zt([Ot({}),Rt()])),xo=Ot({err:bo}),wo=Mt("receivedSignature"),ko=Ot({"solana-core":Rt(),"feature-set":Bt(Ct())}),Ao=lo(Ot({err:Pt(zt([Ot({}),Rt()])),logs:Pt(Et(Rt())),accounts:Bt(Pt(Et(Pt(Ot({executable:St(),owner:Rt(),lamports:Ct(),data:Et(Rt()),rentEpoch:Bt(Ct())}))))),unitsConsumed:Bt(Ct()),returnData:Bt(Pt(Ot({programId:Rt(),data:Lt([Rt(),Mt("base64")])})))})),Eo=lo(Ot({byIdentity:Dt(Rt(),Et(Ct())),range:Ot({firstSlot:Ct(),lastSlot:Ct()})}));var So=co(po),To=co(go),Mo=co(yo),Io=co(vo),Po=co(_o),Co=co(Ct()),Bo=lo(Ot({total:Ct(),circulating:Ct(),nonCirculating:Ct(),nonCirculatingAccounts:Et(ro)})),Do=Ot({amount:Rt(),uiAmount:Pt(Ct()),decimals:Ct(),uiAmountString:Bt(Rt())}),Ro=lo(Et(Ot({address:ro,amount:Rt(),uiAmount:Pt(Ct()),decimals:Ct(),uiAmountString:Bt(Rt())}))),Lo=lo(Et(Ot({pubkey:ro,account:Ot({executable:St(),owner:ro,lamports:Ct(),data:io,rentEpoch:Ct()})}))),Oo=Ot({program:Rt(),parsed:Nt(),space:Ct()}),zo=lo(Et(Ot({pubkey:ro,account:Ot({executable:St(),owner:ro,lamports:Ct(),data:Oo,rentEpoch:Ct()})}))),No=lo(Et(Ot({lamports:Ct(),address:ro}))),Uo=Ot({executable:St(),owner:ro,lamports:Ct(),data:io,rentEpoch:Ct()}),Zo=Ot({pubkey:ro,account:Uo}),Fo=Ut(zt([Tt(y.lW),Oo]),zt([no,Oo]),(function(e){return Array.isArray(e)?xt(e,io):e})),jo=Ot({executable:St(),owner:ro,lamports:Ct(),data:Fo,rentEpoch:Ct()}),Vo=Ot({pubkey:ro,account:jo}),Wo=Ot({state:zt([Mt("active"),Mt("inactive"),Mt("activating"),Mt("deactivating")]),active:Ct(),inactive:Ct()}),Ko=co(Et(Ot({signature:Rt(),slot:Ct(),err:bo,memo:Pt(Rt()),blockTime:Bt(Pt(Ct()))}))),Go=co(Et(Ot({signature:Rt(),slot:Ct(),err:bo,memo:Pt(Rt()),blockTime:Bt(Pt(Ct()))}))),Ho=Ot({subscription:Ct(),result:ho(Uo)}),qo=Ot({pubkey:ro,account:Uo}),Yo=Ot({subscription:Ct(),result:ho(qo)}),Xo=Ot({parent:Ct(),slot:Ct(),root:Ct()}),Qo=Ot({subscription:Ct(),result:Xo}),$o=zt([Ot({type:zt([Mt("firstShredReceived"),Mt("completed"),Mt("optimisticConfirmation"),Mt("root")]),slot:Ct(),timestamp:Ct()}),Ot({type:Mt("createdBank"),parent:Ct(),slot:Ct(),timestamp:Ct()}),Ot({type:Mt("frozen"),slot:Ct(),timestamp:Ct(),stats:Ot({numTransactionEntries:Ct(),numSuccessfulTransactions:Ct(),numFailedTransactions:Ct(),maxTransactionsPerEntry:Ct()})}),Ot({type:Mt("dead"),slot:Ct(),timestamp:Ct(),err:Rt()})]),Jo=Ot({subscription:Ct(),result:$o}),ea=Ot({subscription:Ct(),result:ho(zt([xo,wo]))}),ta=Ot({subscription:Ct(),result:Ct()}),ra=Ot({pubkey:Rt(),gossip:Pt(Rt()),tpu:Pt(Rt()),rpc:Pt(Rt()),version:Pt(Rt())}),na=Ot({votePubkey:Rt(),nodePubkey:Rt(),activatedStake:Ct(),epochVoteAccount:St(),epochCredits:Et(Lt([Ct(),Ct(),Ct()])),commission:Ct(),lastVote:Ct(),rootSlot:Pt(Ct())}),ia=co(Ot({current:Et(na),delinquent:Et(na)})),oa=zt([Mt("processed"),Mt("confirmed"),Mt("finalized")]),aa=Ot({slot:Ct(),confirmations:Pt(Ct()),err:bo,confirmationStatus:Bt(oa)}),sa=lo(Et(Pt(aa))),ua=co(Ct()),ca=Ot({accountKey:ro,writableIndexes:Et(Ct()),readonlyIndexes:Et(Ct())}),la=Ot({signatures:Et(Rt()),message:Ot({accountKeys:Et(Rt()),header:Ot({numRequiredSignatures:Ct(),numReadonlySignedAccounts:Ct(),numReadonlyUnsignedAccounts:Ct()}),instructions:Et(Ot({accounts:Et(Ct()),data:Rt(),programIdIndex:Ct()})),recentBlockhash:Rt(),addressTableLookups:Bt(Et(ca))})}),ha=Ot({pubkey:ro,signer:St(),writable:St(),source:Bt(zt([Mt("transaction"),Mt("lookupTable")]))}),fa=Ot({accountKeys:Et(ha),signatures:Et(Rt())}),da=Ot({parsed:Nt(),program:Rt(),programId:ro}),pa=Ot({accounts:Et(ro),data:Rt(),programId:ro}),ma=Ut(zt([pa,da]),zt([Ot({parsed:Nt(),program:Rt(),programId:Rt()}),Ot({accounts:Et(Rt()),data:Rt(),programId:Rt()})]),(function(e){return xt(e,"accounts"in e?pa:da)})),ga=Ot({signatures:Et(Rt()),message:Ot({accountKeys:Et(ha),instructions:Et(ma),recentBlockhash:Rt(),addressTableLookups:Bt(Pt(Et(ca)))})}),ya=Ot({accountIndex:Ct(),mint:Rt(),owner:Bt(Rt()),uiTokenAmount:Do}),va=Ot({writable:Et(ro),readonly:Et(ro)}),_a=Ot({err:bo,fee:Ct(),innerInstructions:Bt(Pt(Et(Ot({index:Ct(),instructions:Et(Ot({accounts:Et(Ct()),data:Rt(),programIdIndex:Ct()}))})))),preBalances:Et(Ct()),postBalances:Et(Ct()),logMessages:Bt(Pt(Et(Rt()))),preTokenBalances:Bt(Pt(Et(ya))),postTokenBalances:Bt(Pt(Et(ya))),loadedAddresses:Bt(va),computeUnitsConsumed:Bt(Ct())}),ba=Ot({err:bo,fee:Ct(),innerInstructions:Bt(Pt(Et(Ot({index:Ct(),instructions:Et(ma)})))),preBalances:Et(Ct()),postBalances:Et(Ct()),logMessages:Bt(Pt(Et(Rt()))),preTokenBalances:Bt(Pt(Et(ya))),postTokenBalances:Bt(Pt(Et(ya))),loadedAddresses:Bt(va),computeUnitsConsumed:Bt(Ct())}),xa=zt([Mt(0),Mt("legacy")]),wa=Ot({pubkey:Rt(),lamports:Ct(),postBalance:Pt(Ct()),rewardType:Pt(Rt()),commission:Bt(Pt(Ct()))}),ka=co(Pt(Ot({blockhash:Rt(),previousBlockhash:Rt(),parentSlot:Ct(),transactions:Et(Ot({transaction:la,meta:Pt(_a),version:Bt(xa)})),rewards:Bt(Et(wa)),blockTime:Pt(Ct()),blockHeight:Pt(Ct())}))),Aa=co(Pt(Ot({blockhash:Rt(),previousBlockhash:Rt(),parentSlot:Ct(),rewards:Bt(Et(wa)),blockTime:Pt(Ct()),blockHeight:Pt(Ct())}))),Ea=co(Pt(Ot({blockhash:Rt(),previousBlockhash:Rt(),parentSlot:Ct(),transactions:Et(Ot({transaction:fa,meta:Pt(_a),version:Bt(xa)})),rewards:Bt(Et(wa)),blockTime:Pt(Ct()),blockHeight:Pt(Ct())}))),Sa=co(Pt(Ot({blockhash:Rt(),previousBlockhash:Rt(),parentSlot:Ct(),transactions:Et(Ot({transaction:ga,meta:Pt(ba),version:Bt(xa)})),rewards:Bt(Et(wa)),blockTime:Pt(Ct()),blockHeight:Pt(Ct())}))),Ta=co(Pt(Ot({blockhash:Rt(),previousBlockhash:Rt(),parentSlot:Ct(),transactions:Et(Ot({transaction:fa,meta:Pt(ba),version:Bt(xa)})),rewards:Bt(Et(wa)),blockTime:Pt(Ct()),blockHeight:Pt(Ct())}))),Ma=co(Pt(Ot({blockhash:Rt(),previousBlockhash:Rt(),parentSlot:Ct(),rewards:Bt(Et(wa)),blockTime:Pt(Ct()),blockHeight:Pt(Ct())}))),Ia=co(Pt(Ot({blockhash:Rt(),previousBlockhash:Rt(),parentSlot:Ct(),transactions:Et(Ot({transaction:la,meta:Pt(_a)})),rewards:Bt(Et(wa)),blockTime:Pt(Ct())}))),Pa=co(Pt(Ot({blockhash:Rt(),previousBlockhash:Rt(),parentSlot:Ct(),signatures:Et(Rt()),blockTime:Pt(Ct())}))),Ca=co(Pt(Ot({slot:Ct(),meta:_a,blockTime:Bt(Pt(Ct())),transaction:la,version:Bt(xa)}))),Ba=co(Pt(Ot({slot:Ct(),transaction:ga,meta:Pt(ba),blockTime:Bt(Pt(Ct())),version:Bt(xa)}))),Da=lo(Ot({blockhash:Rt(),feeCalculator:Ot({lamportsPerSignature:Ct()})})),Ra=lo(Ot({blockhash:Rt(),lastValidBlockHeight:Ct()})),La=co(Et(Ot({slot:Ct(),numTransactions:Ct(),numSlots:Ct(),samplePeriodSecs:Ct()}))),Oa=lo(Pt(Ot({feeCalculator:Ot({lamportsPerSignature:Ct()})}))),za=co(Rt()),Na=co(Rt()),Ua=Ot({err:bo,logs:Et(Rt()),signature:Rt()}),Za=Ot({result:ho(Ua),subscription:Ct()}),Fa={"solana-client":"js/".concat("0.0.0-development")},ja=function(){function e(t,r){var n,i,o,a,c,l;(0,m.Z)(this,e),this._commitment=void 0,this._confirmTransactionInitialTimeout=void 0,this._rpcEndpoint=void 0,this._rpcWsEndpoint=void 0,this._rpcClient=void 0,this._rpcRequest=void 0,this._rpcBatchRequest=void 0,this._rpcWebSocket=void 0,this._rpcWebSocketConnected=!1,this._rpcWebSocketHeartbeat=null,this._rpcWebSocketIdleTimeout=null,this._rpcWebSocketGeneration=0,this._disableBlockhashCaching=!1,this._pollingBlockhash=!1,this._blockhashInfo={latestBlockhash:null,lastFetch:0,transactionSignatures:[],simulatedSignatures:[]},this._nextClientSubscriptionId=0,this._subscriptionDisposeFunctionsByClientSubscriptionId={},this._subscriptionHashByClientSubscriptionId={},this._subscriptionStateChangeCallbacksByHash={},this._subscriptionCallbacksByServerSubscriptionId={},this._subscriptionsByHash={},this._subscriptionsAutoDisposedByRpc=new Set,r&&"string"===typeof r?this._commitment=r:r&&(this._commitment=r.commitment,this._confirmTransactionInitialTimeout=r.confirmTransactionInitialTimeout,n=r.wsEndpoint,i=r.httpHeaders,o=r.fetch,a=r.fetchMiddleware,c=r.disableRetryOnRateLimit,l=r.httpAgent),this._rpcEndpoint=function(e){if(!1===/^https?:/.test(e))throw new TypeError("Endpoint URL must start with `http:` or `https:`.");return e}(t),this._rpcWsEndpoint=n||function(e){var t=e.match(to);if(null==t)throw TypeError("Failed to validate endpoint URL `".concat(e,"`"));var r=(0,s.Z)(t,4),n=(r[0],r[1]),i=r[2],o=r[3],a=e.startsWith("https:")?"wss:":"ws:",u=null==i?null:parseInt(i.slice(1),10),c=null==u?"":":".concat(u+1);return"".concat(a,"//").concat(n).concat(c).concat(o)}(t),this._rpcClient=function(e,t,r,n,i,o){var a,s=r||Qi;null!=o&&console.warn("You have supplied an `httpAgent` when creating a `Connection` in a browser environment.It has been ignored; `httpAgent` is only used in Node environments."),n&&(a=function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t,r){var i;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e,i){try{n(t,r,(function(t,r){return e([t,r])}))}catch(o){i(o)}}));case 2:return i=e.sent,e.next=5,s.apply(void 0,(0,u.Z)(i));case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}());var c=new(Ft())(function(){var r=(0,f.Z)((0,h.Z)().mark((function r(n,o){var u,c,l,f,d;return(0,h.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:u={method:"POST",body:n,agent:void 0,headers:Object.assign({"Content-Type":"application/json"},t||{},Fa)},r.prev=1,c=5,f=500;case 4:if(!a){r.next=10;break}return r.next=7,a(e,u);case 7:l=r.sent,r.next=13;break;case 10:return r.next=12,s(e,u);case 12:l=r.sent;case 13:if(429===l.status){r.next=15;break}return r.abrupt("break",26);case 15:if(!0!==i){r.next=17;break}return r.abrupt("break",26);case 17:if(0!==(c-=1)){r.next=20;break}return r.abrupt("break",26);case 20:return console.log("Server responded with ".concat(l.status," ").concat(l.statusText,".  Retrying after ").concat(f,"ms delay...")),r.next=23,Si(f);case 23:f*=2;case 24:r.next=4;break;case 26:return r.next=28,l.text();case 28:d=r.sent,l.ok?o(null,d):o(new Error("".concat(l.status," ").concat(l.statusText,": ").concat(d))),r.next=35;break;case 32:r.prev=32,r.t0=r.catch(1),r.t0 instanceof Error&&o(r.t0);case 35:case"end":return r.stop()}}),r,null,[[1,32]])})));return function(e,t){return r.apply(this,arguments)}}(),{});return c}(t,i,o,a,c,l),this._rpcRequest=function(e){return function(t,r){return new Promise((function(n,i){e.request(t,r,(function(e,t){e?i(e):n(t)}))}))}}(this._rpcClient),this._rpcBatchRequest=function(e){return function(t){return new Promise((function(r,n){0===t.length&&r([]);var i=t.map((function(t){return e.request(t.methodName,t.args)}));e.request(i,(function(e,t){e?n(e):r(t)}))}))}}(this._rpcClient),this._rpcWebSocket=new $i(this._rpcWsEndpoint,{autoconnect:!1,max_reconnects:1/0}),this._rpcWebSocket.on("open",this._wsOnOpen.bind(this)),this._rpcWebSocket.on("error",this._wsOnError.bind(this)),this._rpcWebSocket.on("close",this._wsOnClose.bind(this)),this._rpcWebSocket.on("accountNotification",this._wsOnAccountNotification.bind(this)),this._rpcWebSocket.on("programNotification",this._wsOnProgramAccountNotification.bind(this)),this._rpcWebSocket.on("slotNotification",this._wsOnSlotNotification.bind(this)),this._rpcWebSocket.on("slotsUpdatesNotification",this._wsOnSlotUpdatesNotification.bind(this)),this._rpcWebSocket.on("signatureNotification",this._wsOnSignatureNotification.bind(this)),this._rpcWebSocket.on("rootNotification",this._wsOnRootNotification.bind(this)),this._rpcWebSocket.on("logsNotification",this._wsOnLogsNotification.bind(this))}return(0,g.Z)(e,[{key:"commitment",get:function(){return this._commitment}},{key:"rpcEndpoint",get:function(){return this._rpcEndpoint}},{key:"getBalanceAndContext",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t,r){var n,i,o,a,s,u;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=ao(r),i=n.commitment,o=n.config,a=this._buildArgs([t.toBase58()],i,void 0,o),e.next=4,this._rpcRequest("getBalance",a);case 4:if(s=e.sent,!("error"in(u=xt(s,lo(Ct()))))){e.next=8;break}throw new Xi(u.error,"failed to get balance for ".concat(t.toBase58()));case 8:return e.abrupt("return",u.result);case 9:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getBalance",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t,r){return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getBalanceAndContext(t,r).then((function(e){return e.value})).catch((function(e){throw new Error("failed to get balance of account "+t.toBase58()+": "+e)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getBlockTime",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t){var r,n;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._rpcRequest("getBlockTime",[t]);case 2:if(r=e.sent,!("error"in(n=xt(r,co(Pt(Ct())))))){e.next=6;break}throw new Xi(n.error,"failed to get block time for slot ".concat(t));case 6:return e.abrupt("return",n.result);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getMinimumLedgerSlot",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(){var t,r;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._rpcRequest("minimumLedgerSlot",[]);case 2:if(t=e.sent,!("error"in(r=xt(t,co(Ct()))))){e.next=6;break}throw new Xi(r.error,"failed to get minimum ledger slot");case 6:return e.abrupt("return",r.result);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getFirstAvailableBlock",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(){var t,r;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._rpcRequest("getFirstAvailableBlock",[]);case 2:if(t=e.sent,!("error"in(r=xt(t,Co)))){e.next=6;break}throw new Xi(r.error,"failed to get first available block");case 6:return e.abrupt("return",r.result);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getSupply",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t){var r,n,i;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={},r="string"===typeof t?{commitment:t}:t?(0,a.Z)((0,a.Z)({},t),{},{commitment:t&&t.commitment||this.commitment}):{commitment:this.commitment},e.next=4,this._rpcRequest("getSupply",[r]);case 4:if(n=e.sent,!("error"in(i=xt(n,Bo)))){e.next=8;break}throw new Xi(i.error,"failed to get supply");case 8:return e.abrupt("return",i.result);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getTokenSupply",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t,r){var n,i,o;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this._buildArgs([t.toBase58()],r),e.next=3,this._rpcRequest("getTokenSupply",n);case 3:if(i=e.sent,!("error"in(o=xt(i,lo(Do))))){e.next=7;break}throw new Xi(o.error,"failed to get token supply");case 7:return e.abrupt("return",o.result);case 8:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getTokenAccountBalance",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t,r){var n,i,o;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this._buildArgs([t.toBase58()],r),e.next=3,this._rpcRequest("getTokenAccountBalance",n);case 3:if(i=e.sent,!("error"in(o=xt(i,lo(Do))))){e.next=7;break}throw new Xi(o.error,"failed to get token account balance");case 7:return e.abrupt("return",o.result);case 8:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getTokenAccountsByOwner",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t,r,n){var i,o,a,s,u,c,l;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=ao(n),o=i.commitment,a=i.config,s=[t.toBase58()],"mint"in r?s.push({mint:r.mint.toBase58()}):s.push({programId:r.programId.toBase58()}),u=this._buildArgs(s,o,"base64",a),e.next=6,this._rpcRequest("getTokenAccountsByOwner",u);case 6:if(c=e.sent,!("error"in(l=xt(c,Lo)))){e.next=10;break}throw new Xi(l.error,"failed to get token accounts owned by account ".concat(t.toBase58()));case 10:return e.abrupt("return",l.result);case 11:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"getParsedTokenAccountsByOwner",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t,r,n){var i,o,a,s;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=[t.toBase58()],"mint"in r?i.push({mint:r.mint.toBase58()}):i.push({programId:r.programId.toBase58()}),o=this._buildArgs(i,n,"jsonParsed"),e.next=5,this._rpcRequest("getTokenAccountsByOwner",o);case 5:if(a=e.sent,!("error"in(s=xt(a,zo)))){e.next=9;break}throw new Xi(s.error,"failed to get token accounts owned by account ".concat(t.toBase58()));case 9:return e.abrupt("return",s.result);case 10:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"getLargestAccounts",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t){var r,n,i,o;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(0,a.Z)((0,a.Z)({},t),{},{commitment:t&&t.commitment||this.commitment}),n=r.filter||r.commitment?[r]:[],e.next=4,this._rpcRequest("getLargestAccounts",n);case 4:if(i=e.sent,!("error"in(o=xt(i,No)))){e.next=8;break}throw new Xi(o.error,"failed to get largest accounts");case 8:return e.abrupt("return",o.result);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getTokenLargestAccounts",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t,r){var n,i,o;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this._buildArgs([t.toBase58()],r),e.next=3,this._rpcRequest("getTokenLargestAccounts",n);case 3:if(i=e.sent,!("error"in(o=xt(i,Ro)))){e.next=7;break}throw new Xi(o.error,"failed to get token largest accounts");case 7:return e.abrupt("return",o.result);case 8:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getAccountInfoAndContext",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t,r){var n,i,o,a,s,u;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=ao(r),i=n.commitment,o=n.config,a=this._buildArgs([t.toBase58()],i,"base64",o),e.next=4,this._rpcRequest("getAccountInfo",a);case 4:if(s=e.sent,!("error"in(u=xt(s,lo(Pt(Uo)))))){e.next=8;break}throw new Xi(u.error,"failed to get info about account ".concat(t.toBase58()));case 8:return e.abrupt("return",u.result);case 9:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getParsedAccountInfo",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t,r){var n,i,o,a,s,u;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=ao(r),i=n.commitment,o=n.config,a=this._buildArgs([t.toBase58()],i,"jsonParsed",o),e.next=4,this._rpcRequest("getAccountInfo",a);case 4:if(s=e.sent,!("error"in(u=xt(s,lo(Pt(jo)))))){e.next=8;break}throw new Xi(u.error,"failed to get info about account ".concat(t.toBase58()));case 8:return e.abrupt("return",u.result);case 9:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getAccountInfo",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t,r){var n;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.getAccountInfoAndContext(t,r);case 3:return n=e.sent,e.abrupt("return",n.value);case 7:throw e.prev=7,e.t0=e.catch(0),new Error("failed to get info about account "+t.toBase58()+": "+e.t0);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getMultipleParsedAccounts",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t,r){var n,i,o,a,s,u,c;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=ao(r),i=n.commitment,o=n.config,a=t.map((function(e){return e.toBase58()})),s=this._buildArgs([a],i,"jsonParsed",o),e.next=5,this._rpcRequest("getMultipleAccounts",s);case 5:if(u=e.sent,!("error"in(c=xt(u,lo(Et(Pt(jo))))))){e.next=9;break}throw new Xi(c.error,"failed to get info for accounts ".concat(a));case 9:return e.abrupt("return",c.result);case 10:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getMultipleAccountsInfoAndContext",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t,r){var n,i,o,a,s,u,c;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=ao(r),i=n.commitment,o=n.config,a=t.map((function(e){return e.toBase58()})),s=this._buildArgs([a],i,"base64",o),e.next=5,this._rpcRequest("getMultipleAccounts",s);case 5:if(u=e.sent,!("error"in(c=xt(u,lo(Et(Pt(Uo))))))){e.next=9;break}throw new Xi(c.error,"failed to get info for accounts ".concat(a));case 9:return e.abrupt("return",c.result);case 10:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getMultipleAccountsInfo",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t,r){var n;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMultipleAccountsInfoAndContext(t,r);case 2:return n=e.sent,e.abrupt("return",n.value);case 4:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getStakeActivation",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t,r,n){var i,o,s,u,c,l;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=ao(r),o=i.commitment,s=i.config,u=this._buildArgs([t.toBase58()],o,void 0,(0,a.Z)((0,a.Z)({},s),{},{epoch:null!=n?n:null===s||void 0===s?void 0:s.epoch})),e.next=4,this._rpcRequest("getStakeActivation",u);case 4:if(c=e.sent,!("error"in(l=xt(c,co(Wo))))){e.next=8;break}throw new Xi(l.error,"failed to get Stake Activation ".concat(t.toBase58()));case 8:return e.abrupt("return",l.result);case 9:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"getProgramAccounts",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t,r){var i,o,a,s,u,c,l,f,d;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=ao(r),o=i.commitment,a=i.config,u=(s=a||{}).encoding,c=(0,n.Z)(s,En),l=this._buildArgs([t.toBase58()],o,u||"base64",c),e.next=5,this._rpcRequest("getProgramAccounts",l);case 5:if(f=e.sent,!("error"in(d=xt(f,co(Et(Zo)))))){e.next=9;break}throw new Xi(d.error,"failed to get accounts owned by program ".concat(t.toBase58()));case 9:return e.abrupt("return",d.result);case 10:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getParsedProgramAccounts",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t,r){var n,i,o,a,s,u;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=ao(r),i=n.commitment,o=n.config,a=this._buildArgs([t.toBase58()],i,"jsonParsed",o),e.next=4,this._rpcRequest("getProgramAccounts",a);case 4:if(s=e.sent,!("error"in(u=xt(s,co(Et(Vo)))))){e.next=8;break}throw new Xi(u.error,"failed to get accounts owned by program ".concat(t.toBase58()));case 8:return e.abrupt("return",u.result);case 9:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"confirmTransaction",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t,r){var n,i,o,a;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof t){e.next=4;break}n=t,e.next=8;break;case 4:if(null===(i=(o=t).abortSignal)||void 0===i||!i.aborted){e.next=7;break}return e.abrupt("return",Promise.reject(o.abortSignal.reason));case 7:n=o.signature;case 8:e.prev=8,a=qe().decode(n),e.next=15;break;case 12:throw e.prev=12,e.t0=e.catch(8),new Error("signature must be base58 encoded: "+n);case 15:if(ii(64===a.length,"signature has invalid length"),"string"!==typeof t){e.next=22;break}return e.next=19,this.confirmTransactionUsingLegacyTimeoutStrategy({commitment:r||this.commitment,signature:n});case 19:return e.abrupt("return",e.sent);case 22:if(!("lastValidBlockHeight"in t)){e.next=28;break}return e.next=25,this.confirmTransactionUsingBlockHeightExceedanceStrategy({commitment:r||this.commitment,strategy:t});case 25:return e.abrupt("return",e.sent);case 28:return e.next=30,this.confirmTransactionUsingDurableNonceStrategy({commitment:r||this.commitment,strategy:t});case 30:return e.abrupt("return",e.sent);case 31:case"end":return e.stop()}}),e,this,[[8,12]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getCancellationPromise",value:function(e){return new Promise((function(t,r){null!=e&&(e.aborted?r(e.reason):e.addEventListener("abort",(function(){r(e.reason)})))}))}},{key:"getTransactionConfirmationPromise",value:function(e){var t,r,n=this,i=e.commitment,o=e.signature,a=!1;return{abortConfirmation:function(){r&&(r(),r=void 0),null!=t&&(n.removeSignatureListener(t),t=void 0)},confirmationPromise:new Promise((function(e,s){try{t=n.onSignature(o,(function(r,n){t=void 0;var i={context:n,value:r};e({__type:oi.PROCESSED,response:i})}),i);var u=new Promise((function(e){null==t?e():r=n._onSubscriptionStateChange(t,(function(t){"subscribed"===t&&e()}))}));(0,f.Z)((0,h.Z)().mark((function t(){var r,c,l;return(0,h.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,u;case 2:if(!a){t.next=4;break}return t.abrupt("return");case 4:return t.next=6,n.getSignatureStatus(o);case 6:if(r=t.sent,!a){t.next=9;break}return t.abrupt("return");case 9:if(null!=r){t.next=11;break}return t.abrupt("return");case 11:if(c=r.context,null!=(l=r.value)){t.next=14;break}return t.abrupt("return");case 14:if(null===l||void 0===l||!l.err){t.next=18;break}s(l.err),t.next=29;break;case 18:t.t0=i,t.next="confirmed"===t.t0||"single"===t.t0||"singleGossip"===t.t0?21:"finalized"===t.t0||"max"===t.t0||"root"===t.t0?24:("processed"===t.t0||t.t0,27);break;case 21:if("processed"!==l.confirmationStatus){t.next=23;break}return t.abrupt("return");case 23:return t.abrupt("break",27);case 24:if("processed"!==l.confirmationStatus&&"confirmed"!==l.confirmationStatus){t.next=26;break}return t.abrupt("return");case 26:return t.abrupt("break",27);case 27:a=!0,e({__type:oi.PROCESSED,response:{context:c,value:l}});case 29:case"end":return t.stop()}}),t)})))()}catch(c){s(c)}}))}}},{key:"confirmTransactionUsingBlockHeightExceedanceStrategy",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t){var r,n,i,o,a,s,u,c,l,d,p,m,g,y=this;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.commitment,n=t.strategy,i=n.abortSignal,o=n.lastValidBlockHeight,a=n.signature,s=!1,u=new Promise((function(e){var t=function(){var e=(0,f.Z)((0,h.Z)().mark((function e(){var t;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y.getBlockHeight(r);case 3:return t=e.sent,e.abrupt("return",t);case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",-1);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();(0,f.Z)((0,h.Z)().mark((function r(){var n;return(0,h.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,t();case 2:if(n=r.sent,!s){r.next=5;break}return r.abrupt("return");case 5:if(!(n<=o)){r.next=17;break}return r.next=8,Si(1e3);case 8:if(!s){r.next=10;break}return r.abrupt("return");case 10:return r.next=12,t();case 12:if(n=r.sent,!s){r.next=15;break}return r.abrupt("return");case 15:r.next=5;break;case 17:e({__type:oi.BLOCKHEIGHT_EXCEEDED});case 18:case"end":return r.stop()}}),r)})))()})),c=this.getTransactionConfirmationPromise({commitment:r,signature:a}),l=c.abortConfirmation,d=c.confirmationPromise,p=this.getCancellationPromise(i),e.prev=5,e.next=8,Promise.race([p,d,u]);case 8:if((g=e.sent).__type!==oi.PROCESSED){e.next=13;break}m=g.response,e.next=14;break;case 13:throw new qn(a);case 14:return e.prev=14,s=!0,l(),e.finish(14);case 18:return e.abrupt("return",m);case 19:case"end":return e.stop()}}),e,this,[[5,,14,18]])})));return function(t){return e.apply(this,arguments)}}()},{key:"confirmTransactionUsingDurableNonceStrategy",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t){var r,n,i,o,a,s,u,c,l,d,p,m,g,y,v,_,b,x,w,k,A,E=this;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.commitment,n=t.strategy,i=n.abortSignal,o=n.minContextSlot,a=n.nonceAccountPubkey,s=n.nonceValue,u=n.signature,c=!1,l=new Promise((function(e){var t=s,n=null,i=function(){var e=(0,f.Z)((0,h.Z)().mark((function e(){var i,s,u;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,E.getNonceAndContext(a,{commitment:r,minContextSlot:o});case 3:return i=e.sent,s=i.context,u=i.value,n=s.slot,e.abrupt("return",null===u||void 0===u?void 0:u.nonce);case 10:return e.prev=10,e.t0=e.catch(0),e.abrupt("return",t);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(){return e.apply(this,arguments)}}();(0,f.Z)((0,h.Z)().mark((function r(){return(0,h.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,i();case 2:if(t=r.sent,!c){r.next=5;break}return r.abrupt("return");case 5:if(s===t){r.next=9;break}return e({__type:oi.NONCE_INVALID,slotInWhichNonceDidAdvance:n}),r.abrupt("return");case 9:return r.next=11,Si(2e3);case 11:if(!c){r.next=13;break}return r.abrupt("return");case 13:return r.next=15,i();case 15:if(t=r.sent,!c){r.next=18;break}return r.abrupt("return");case 18:r.next=5;break;case 20:case"end":return r.stop()}}),r)})))()})),d=this.getTransactionConfirmationPromise({commitment:r,signature:u}),p=d.abortConfirmation,m=d.confirmationPromise,g=this.getCancellationPromise(i),e.prev=5,e.next=8,Promise.race([g,m,l]);case 8:if((v=e.sent).__type!==oi.PROCESSED){e.next=13;break}y=v.response,e.next=47;break;case 13:return e.next=16,this.getSignatureStatus(u);case 16:if(null!=(w=e.sent)){e.next=19;break}return e.abrupt("break",27);case 19:if(!(w.context.slot<(null!==(x=v.slotInWhichNonceDidAdvance)&&void 0!==x?x:o))){e.next=23;break}return e.next=22,Si(400);case 22:return e.abrupt("continue",13);case 23:return b=w,e.abrupt("break",27);case 27:if(null===(_=b)||void 0===_||!_.value){e.next=46;break}k=r||"finalized",A=b.value.confirmationStatus,e.t0=k,e.next="processed"===e.t0||"recent"===e.t0?33:"confirmed"===e.t0||"single"===e.t0||"singleGossip"===e.t0?36:"finalized"===e.t0||"max"===e.t0||"root"===e.t0?39:42;break;case 33:if("processed"===A||"confirmed"===A||"finalized"===A){e.next=35;break}throw new Xn(u);case 35:case 38:case 41:return e.abrupt("break",43);case 36:if("confirmed"===A||"finalized"===A){e.next=38;break}throw new Xn(u);case 39:if("finalized"===A){e.next=41;break}throw new Xn(u);case 42:case 43:y={context:b.context,value:{err:b.value.err}},e.next=47;break;case 46:throw new Xn(u);case 47:return e.prev=47,c=!0,p(),e.finish(47);case 51:return e.abrupt("return",y);case 52:case"end":return e.stop()}}),e,this,[[5,,47,51]])})));return function(t){return e.apply(this,arguments)}}()},{key:"confirmTransactionUsingLegacyTimeoutStrategy",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t){var r,n,i,o,a,s,u,c,l,f=this;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.commitment,n=t.signature,o=new Promise((function(e){var t=f._confirmTransactionInitialTimeout||6e4;switch(r){case"processed":case"recent":case"single":case"confirmed":case"singleGossip":t=f._confirmTransactionInitialTimeout||3e4}i=setTimeout((function(){return e({__type:oi.TIMED_OUT,timeoutMs:t})}),t)})),a=this.getTransactionConfirmationPromise({commitment:r,signature:n}),s=a.abortConfirmation,u=a.confirmationPromise,e.prev=3,e.next=6,Promise.race([u,o]);case 6:if((l=e.sent).__type!==oi.PROCESSED){e.next=11;break}c=l.response,e.next=12;break;case 11:throw new Yn(n,l.timeoutMs/1e3);case 12:return e.prev=12,clearTimeout(i),s(),e.finish(12);case 16:return e.abrupt("return",c);case 17:case"end":return e.stop()}}),e,this,[[3,,12,16]])})));return function(t){return e.apply(this,arguments)}}()},{key:"getClusterNodes",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(){var t,r;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._rpcRequest("getClusterNodes",[]);case 2:if(t=e.sent,!("error"in(r=xt(t,co(Et(ra)))))){e.next=6;break}throw new Xi(r.error,"failed to get cluster nodes");case 6:return e.abrupt("return",r.result);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getVoteAccounts",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t){var r,n,i;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this._buildArgs([],t),e.next=3,this._rpcRequest("getVoteAccounts",r);case 3:if(n=e.sent,!("error"in(i=xt(n,ia)))){e.next=7;break}throw new Xi(i.error,"failed to get vote accounts");case 7:return e.abrupt("return",i.result);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getSlot",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t){var r,n,i,o,a,s;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=ao(t),n=r.commitment,i=r.config,o=this._buildArgs([],n,void 0,i),e.next=4,this._rpcRequest("getSlot",o);case 4:if(a=e.sent,!("error"in(s=xt(a,co(Ct()))))){e.next=8;break}throw new Xi(s.error,"failed to get slot");case 8:return e.abrupt("return",s.result);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getSlotLeader",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t){var r,n,i,o,a,s;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=ao(t),n=r.commitment,i=r.config,o=this._buildArgs([],n,void 0,i),e.next=4,this._rpcRequest("getSlotLeader",o);case 4:if(a=e.sent,!("error"in(s=xt(a,co(Rt()))))){e.next=8;break}throw new Xi(s.error,"failed to get slot leader");case 8:return e.abrupt("return",s.result);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getSlotLeaders",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t,r){var n,i,o;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[t,r],e.next=3,this._rpcRequest("getSlotLeaders",n);case 3:if(i=e.sent,!("error"in(o=xt(i,co(Et(ro)))))){e.next=7;break}throw new Xi(o.error,"failed to get slot leaders");case 7:return e.abrupt("return",o.result);case 8:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getSignatureStatus",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t,r){var n,i,o,a;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getSignatureStatuses([t],r);case 2:return n=e.sent,i=n.context,ii(1===(o=n.value).length),a=o[0],e.abrupt("return",{context:i,value:a});case 8:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getSignatureStatuses",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t,r){var n,i,o;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[t],r&&n.push(r),e.next=4,this._rpcRequest("getSignatureStatuses",n);case 4:if(i=e.sent,!("error"in(o=xt(i,sa)))){e.next=8;break}throw new Xi(o.error,"failed to get signature status");case 8:return e.abrupt("return",o.result);case 9:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getTransactionCount",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t){var r,n,i,o,a,s;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=ao(t),n=r.commitment,i=r.config,o=this._buildArgs([],n,void 0,i),e.next=4,this._rpcRequest("getTransactionCount",o);case 4:if(a=e.sent,!("error"in(s=xt(a,co(Ct()))))){e.next=8;break}throw new Xi(s.error,"failed to get transaction count");case 8:return e.abrupt("return",s.result);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getTotalSupply",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t){var r;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getSupply({commitment:t,excludeNonCirculatingAccountsList:!0});case 2:return r=e.sent,e.abrupt("return",r.value.total);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getInflationGovernor",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t){var r,n,i;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this._buildArgs([],t),e.next=3,this._rpcRequest("getInflationGovernor",r);case 3:if(n=e.sent,!("error"in(i=xt(n,So)))){e.next=7;break}throw new Xi(i.error,"failed to get inflation");case 7:return e.abrupt("return",i.result);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getInflationReward",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t,r,n){var i,o,s,u,c,l;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=ao(n),o=i.commitment,s=i.config,u=this._buildArgs([t.map((function(e){return e.toBase58()}))],o,void 0,(0,a.Z)((0,a.Z)({},s),{},{epoch:null!=r?r:null===s||void 0===s?void 0:s.epoch})),e.next=4,this._rpcRequest("getInflationReward",u);case 4:if(c=e.sent,!("error"in(l=xt(c,mo)))){e.next=8;break}throw new Xi(l.error,"failed to get inflation reward");case 8:return e.abrupt("return",l.result);case 9:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"getInflationRate",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(){var t,r;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._rpcRequest("getInflationRate",[]);case 2:if(t=e.sent,!("error"in(r=xt(t,To)))){e.next=6;break}throw new Xi(r.error,"failed to get inflation rate");case 6:return e.abrupt("return",r.result);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getEpochInfo",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t){var r,n,i,o,a,s;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=ao(t),n=r.commitment,i=r.config,o=this._buildArgs([],n,void 0,i),e.next=4,this._rpcRequest("getEpochInfo",o);case 4:if(a=e.sent,!("error"in(s=xt(a,Mo)))){e.next=8;break}throw new Xi(s.error,"failed to get epoch info");case 8:return e.abrupt("return",s.result);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getEpochSchedule",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(){var t,r,n;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._rpcRequest("getEpochSchedule",[]);case 2:if(t=e.sent,!("error"in(r=xt(t,Io)))){e.next=6;break}throw new Xi(r.error,"failed to get epoch schedule");case 6:return n=r.result,e.abrupt("return",new Hi(n.slotsPerEpoch,n.leaderScheduleSlotOffset,n.warmup,n.firstNormalEpoch,n.firstNormalSlot));case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getLeaderSchedule",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(){var t,r;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._rpcRequest("getLeaderSchedule",[]);case 2:if(t=e.sent,!("error"in(r=xt(t,Po)))){e.next=6;break}throw new Xi(r.error,"failed to get leader schedule");case 6:return e.abrupt("return",r.result);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getMinimumBalanceForRentExemption",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t,r){var n,i,o;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this._buildArgs([t],r),e.next=3,this._rpcRequest("getMinimumBalanceForRentExemption",n);case 3:if(i=e.sent,!("error"in(o=xt(i,ua)))){e.next=8;break}return console.warn("Unable to fetch minimum balance for rent exemption"),e.abrupt("return",0);case 8:return e.abrupt("return",o.result);case 9:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getRecentBlockhashAndContext",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t){var r,n,i;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this._buildArgs([],t),e.next=3,this._rpcRequest("getRecentBlockhash",r);case 3:if(n=e.sent,!("error"in(i=xt(n,Da)))){e.next=7;break}throw new Xi(i.error,"failed to get recent blockhash");case 7:return e.abrupt("return",i.result);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getRecentPerformanceSamples",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t){var r,n;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._rpcRequest("getRecentPerformanceSamples",t?[t]:[]);case 2:if(r=e.sent,!("error"in(n=xt(r,La)))){e.next=6;break}throw new Xi(n.error,"failed to get recent performance samples");case 6:return e.abrupt("return",n.result);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getFeeCalculatorForBlockhash",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t,r){var n,i,o,a,s,u;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this._buildArgs([t],r),e.next=3,this._rpcRequest("getFeeCalculatorForBlockhash",n);case 3:if(i=e.sent,!("error"in(o=xt(i,Oa)))){e.next=7;break}throw new Xi(o.error,"failed to get fee calculator");case 7:return a=o.result,s=a.context,u=a.value,e.abrupt("return",{context:s,value:null!==u?u.feeCalculator:null});case 9:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getFeeForMessage",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t,r){var n,i,o,a;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Ln(t.serialize()).toString("base64"),i=this._buildArgs([n],r),e.next=4,this._rpcRequest("getFeeForMessage",i);case 4:if(o=e.sent,!("error"in(a=xt(o,lo(Pt(Ct())))))){e.next=8;break}throw new Xi(a.error,"failed to get fee for message");case 8:if(null!==a.result){e.next=10;break}throw new Error("invalid blockhash");case 10:return e.abrupt("return",a.result);case 11:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getRecentBlockhash",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t){var r;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.getRecentBlockhashAndContext(t);case 3:return r=e.sent,e.abrupt("return",r.value);case 7:throw e.prev=7,e.t0=e.catch(0),new Error("failed to get recent blockhash: "+e.t0);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()},{key:"getLatestBlockhash",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t){var r;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.getLatestBlockhashAndContext(t);case 3:return r=e.sent,e.abrupt("return",r.value);case 7:throw e.prev=7,e.t0=e.catch(0),new Error("failed to get recent blockhash: "+e.t0);case 10:case"end":return e.stop()}}),e,this,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()},{key:"getLatestBlockhashAndContext",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t){var r,n,i,o,a,s;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=ao(t),n=r.commitment,i=r.config,o=this._buildArgs([],n,void 0,i),e.next=4,this._rpcRequest("getLatestBlockhash",o);case 4:if(a=e.sent,!("error"in(s=xt(a,Ra)))){e.next=8;break}throw new Xi(s.error,"failed to get latest blockhash");case 8:return e.abrupt("return",s.result);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getVersion",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(){var t,r;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._rpcRequest("getVersion",[]);case 2:if(t=e.sent,!("error"in(r=xt(t,co(ko))))){e.next=6;break}throw new Xi(r.error,"failed to get version");case 6:return e.abrupt("return",r.result);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getGenesisHash",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(){var t,r;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._rpcRequest("getGenesisHash",[]);case 2:if(t=e.sent,!("error"in(r=xt(t,co(Rt()))))){e.next=6;break}throw new Xi(r.error,"failed to get genesis hash");case 6:return e.abrupt("return",r.result);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getBlock",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t,r){var n,i,o,s,u,c,l,f,d;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=ao(r),i=n.commitment,o=n.config,s=this._buildArgsAtLeastConfirmed([t],i,void 0,o),e.next=4,this._rpcRequest("getBlock",s);case 4:u=e.sent,e.prev=5,e.t0=null===o||void 0===o?void 0:o.transactionDetails,e.next="accounts"===e.t0?9:"none"===e.t0?13:17;break;case 9:if(!("error"in(c=xt(u,Ea)))){e.next=12;break}throw c.error;case 12:return e.abrupt("return",c.result);case 13:if(!("error"in(l=xt(u,Aa)))){e.next=16;break}throw l.error;case 16:return e.abrupt("return",l.result);case 17:if(!("error"in(f=xt(u,ka)))){e.next=20;break}throw f.error;case 20:return d=f.result,e.abrupt("return",d?(0,a.Z)((0,a.Z)({},d),{},{transactions:d.transactions.map((function(e){var t=e.transaction,r=e.meta,n=e.version;return{meta:r,transaction:(0,a.Z)((0,a.Z)({},t),{},{message:fo(n,t.message)}),version:n}}))}):null);case 22:e.next=27;break;case 24:throw e.prev=24,e.t1=e.catch(5),new Xi(e.t1,"failed to get confirmed block");case 27:case"end":return e.stop()}}),e,this,[[5,24]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getParsedBlock",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t,r){var n,i,o,a,s,u,c,l;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=ao(r),i=n.commitment,o=n.config,a=this._buildArgsAtLeastConfirmed([t],i,"jsonParsed",o),e.next=4,this._rpcRequest("getBlock",a);case 4:s=e.sent,e.prev=5,e.t0=null===o||void 0===o?void 0:o.transactionDetails,e.next="accounts"===e.t0?9:"none"===e.t0?13:17;break;case 9:if(!("error"in(u=xt(s,Ta)))){e.next=12;break}throw u.error;case 12:return e.abrupt("return",u.result);case 13:if(!("error"in(c=xt(s,Ma)))){e.next=16;break}throw c.error;case 16:return e.abrupt("return",c.result);case 17:if(!("error"in(l=xt(s,Sa)))){e.next=20;break}throw l.error;case 20:return e.abrupt("return",l.result);case 21:e.next=26;break;case 23:throw e.prev=23,e.t1=e.catch(5),new Xi(e.t1,"failed to get block");case 26:case"end":return e.stop()}}),e,this,[[5,23]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getBlockHeight",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t){var r,n,i,o,a,s;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=ao(t),n=r.commitment,i=r.config,o=this._buildArgs([],n,void 0,i),e.next=4,this._rpcRequest("getBlockHeight",o);case 4:if(a=e.sent,!("error"in(s=xt(a,co(Ct()))))){e.next=8;break}throw new Xi(s.error,"failed to get block height information");case 8:return e.abrupt("return",s.result);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getBlockProduction",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t){var r,i,o,a,s,u,c;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"string"===typeof t?i=t:t&&(o=t.commitment,a=(0,n.Z)(t,Sn),i=o,r=a),s=this._buildArgs([],i,"base64",r),e.next=4,this._rpcRequest("getBlockProduction",s);case 4:if(u=e.sent,!("error"in(c=xt(u,Eo)))){e.next=8;break}throw new Xi(c.error,"failed to get block production information");case 8:return e.abrupt("return",c.result);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getTransaction",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t,r){var n,i,o,s,u,c,l;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=ao(r),i=n.commitment,o=n.config,s=this._buildArgsAtLeastConfirmed([t],i,void 0,o),e.next=4,this._rpcRequest("getTransaction",s);case 4:if(u=e.sent,!("error"in(c=xt(u,Ca)))){e.next=8;break}throw new Xi(c.error,"failed to get transaction");case 8:if(l=c.result){e.next=11;break}return e.abrupt("return",l);case 11:return e.abrupt("return",(0,a.Z)((0,a.Z)({},l),{},{transaction:(0,a.Z)((0,a.Z)({},l.transaction),{},{message:fo(l.version,l.transaction.message)})}));case 12:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getParsedTransaction",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t,r){var n,i,o,a,s,u;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=ao(r),i=n.commitment,o=n.config,a=this._buildArgsAtLeastConfirmed([t],i,"jsonParsed",o),e.next=4,this._rpcRequest("getTransaction",a);case 4:if(s=e.sent,!("error"in(u=xt(s,Ba)))){e.next=8;break}throw new Xi(u.error,"failed to get transaction");case 8:return e.abrupt("return",u.result);case 9:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getParsedTransactions",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t,r){var n,i,o,a,s,u,c=this;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=ao(r),i=n.commitment,o=n.config,a=t.map((function(e){return{methodName:"getTransaction",args:c._buildArgsAtLeastConfirmed([e],i,"jsonParsed",o)}})),e.next=4,this._rpcBatchRequest(a);case 4:return s=e.sent,u=s.map((function(e){var t=xt(e,Ba);if("error"in t)throw new Xi(t.error,"failed to get transactions");return t.result})),e.abrupt("return",u);case 7:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getTransactions",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t,r){var n,i,o,s,u,c,l=this;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=ao(r),i=n.commitment,o=n.config,s=t.map((function(e){return{methodName:"getTransaction",args:l._buildArgsAtLeastConfirmed([e],i,void 0,o)}})),e.next=4,this._rpcBatchRequest(s);case 4:return u=e.sent,c=u.map((function(e){var t=xt(e,Ca);if("error"in t)throw new Xi(t.error,"failed to get transactions");var r=t.result;return r?(0,a.Z)((0,a.Z)({},r),{},{transaction:(0,a.Z)((0,a.Z)({},r.transaction),{},{message:fo(r.version,r.transaction.message)})}):r})),e.abrupt("return",c);case 7:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getConfirmedBlock",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t,r){var n,i,o,s,u;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this._buildArgsAtLeastConfirmed([t],r),e.next=3,this._rpcRequest("getConfirmedBlock",n);case 3:if(i=e.sent,!("error"in(o=xt(i,Ia)))){e.next=7;break}throw new Xi(o.error,"failed to get confirmed block");case 7:if(s=o.result){e.next=10;break}throw new Error("Confirmed block "+t+" not found");case 10:return u=(0,a.Z)((0,a.Z)({},s),{},{transactions:s.transactions.map((function(e){var t=e.transaction,r=e.meta,n=new si(t.message);return{meta:r,transaction:(0,a.Z)((0,a.Z)({},t),{},{message:n})}}))}),e.abrupt("return",(0,a.Z)((0,a.Z)({},u),{},{transactions:u.transactions.map((function(e){var t=e.transaction;return{meta:e.meta,transaction:fi.populate(t.message,t.signatures)}}))}));case 12:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getBlocks",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t,r,n){var i,o,a;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this._buildArgsAtLeastConfirmed(void 0!==r?[t,r]:[t],n),e.next=3,this._rpcRequest("getBlocks",i);case 3:if(o=e.sent,!("error"in(a=xt(o,co(Et(Ct())))))){e.next=7;break}throw new Xi(a.error,"failed to get blocks");case 7:return e.abrupt("return",a.result);case 8:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"getBlockSignatures",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t,r){var n,i,o,a;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this._buildArgsAtLeastConfirmed([t],r,void 0,{transactionDetails:"signatures",rewards:!1}),e.next=3,this._rpcRequest("getBlock",n);case 3:if(i=e.sent,!("error"in(o=xt(i,Pa)))){e.next=7;break}throw new Xi(o.error,"failed to get block");case 7:if(a=o.result){e.next=10;break}throw new Error("Block "+t+" not found");case 10:return e.abrupt("return",a);case 11:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getConfirmedBlockSignatures",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t,r){var n,i,o,a;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this._buildArgsAtLeastConfirmed([t],r,void 0,{transactionDetails:"signatures",rewards:!1}),e.next=3,this._rpcRequest("getConfirmedBlock",n);case 3:if(i=e.sent,!("error"in(o=xt(i,Pa)))){e.next=7;break}throw new Xi(o.error,"failed to get confirmed block");case 7:if(a=o.result){e.next=10;break}throw new Error("Confirmed block "+t+" not found");case 10:return e.abrupt("return",a);case 11:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getConfirmedTransaction",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t,r){var n,i,o,s,u,c;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this._buildArgsAtLeastConfirmed([t],r),e.next=3,this._rpcRequest("getConfirmedTransaction",n);case 3:if(i=e.sent,!("error"in(o=xt(i,Ca)))){e.next=7;break}throw new Xi(o.error,"failed to get transaction");case 7:if(s=o.result){e.next=10;break}return e.abrupt("return",s);case 10:return u=new si(s.transaction.message),c=s.transaction.signatures,e.abrupt("return",(0,a.Z)((0,a.Z)({},s),{},{transaction:fi.populate(u,c)}));case 13:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getParsedConfirmedTransaction",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t,r){var n,i,o;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this._buildArgsAtLeastConfirmed([t],r,"jsonParsed"),e.next=3,this._rpcRequest("getConfirmedTransaction",n);case 3:if(i=e.sent,!("error"in(o=xt(i,Ba)))){e.next=7;break}throw new Xi(o.error,"failed to get confirmed transaction");case 7:return e.abrupt("return",o.result);case 8:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getParsedConfirmedTransactions",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t,r){var n,i,o,a=this;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.map((function(e){return{methodName:"getConfirmedTransaction",args:a._buildArgsAtLeastConfirmed([e],r,"jsonParsed")}})),e.next=3,this._rpcBatchRequest(n);case 3:return i=e.sent,o=i.map((function(e){var t=xt(e,Ba);if("error"in t)throw new Xi(t.error,"failed to get confirmed transactions");return t.result})),e.abrupt("return",o);case 6:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getConfirmedSignaturesForAddress",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t,r,n){var i,o,a,s,u,c;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i={},e.next=3,this.getFirstAvailableBlock();case 3:o=e.sent;case 4:if("until"in i){e.next=24;break}if(!(--r<=0||r<o)){e.next=8;break}return e.abrupt("break",24);case 8:return e.prev=8,e.next=11,this.getConfirmedBlockSignatures(r,"finalized");case 11:(a=e.sent).signatures.length>0&&(i.until=a.signatures[a.signatures.length-1].toString()),e.next=22;break;case 15:if(e.prev=15,e.t0=e.catch(8),!(e.t0 instanceof Error&&e.t0.message.includes("skipped"))){e.next=21;break}return e.abrupt("continue",4);case 21:throw e.t0;case 22:e.next=4;break;case 24:return e.next=26,this.getSlot("finalized");case 26:s=e.sent;case 27:if("before"in i){e.next=47;break}if(!(++n>s)){e.next=31;break}return e.abrupt("break",47);case 31:return e.prev=31,e.next=34,this.getConfirmedBlockSignatures(n);case 34:(u=e.sent).signatures.length>0&&(i.before=u.signatures[u.signatures.length-1].toString()),e.next=45;break;case 38:if(e.prev=38,e.t1=e.catch(31),!(e.t1 instanceof Error&&e.t1.message.includes("skipped"))){e.next=44;break}return e.abrupt("continue",27);case 44:throw e.t1;case 45:e.next=27;break;case 47:return e.next=49,this.getConfirmedSignaturesForAddress2(t,i);case 49:return c=e.sent,e.abrupt("return",c.map((function(e){return e.signature})));case 51:case"end":return e.stop()}}),e,this,[[8,15],[31,38]])})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"getConfirmedSignaturesForAddress2",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t,r,n){var i,o,a;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this._buildArgsAtLeastConfirmed([t.toBase58()],n,void 0,r),e.next=3,this._rpcRequest("getConfirmedSignaturesForAddress2",i);case 3:if(o=e.sent,!("error"in(a=xt(o,Ko)))){e.next=7;break}throw new Xi(a.error,"failed to get confirmed signatures for address");case 7:return e.abrupt("return",a.result);case 8:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"getSignaturesForAddress",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t,r,n){var i,o,a;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this._buildArgsAtLeastConfirmed([t.toBase58()],n,void 0,r),e.next=3,this._rpcRequest("getSignaturesForAddress",i);case 3:if(o=e.sent,!("error"in(a=xt(o,Go)))){e.next=7;break}throw new Xi(a.error,"failed to get signatures for address");case 7:return e.abrupt("return",a.result);case 8:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"getAddressLookupTable",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t,r){var n,i,o,a;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getAccountInfoAndContext(t,r);case 2:return n=e.sent,i=n.context,o=n.value,a=null,null!==o&&(a=new Ji({key:t,state:Ji.deserialize(o.data)})),e.abrupt("return",{context:i,value:a});case 8:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getNonceAndContext",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t,r){var n,i,o,a;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getAccountInfoAndContext(t,r);case 2:return n=e.sent,i=n.context,o=n.value,a=null,null!==o&&(a=Di.fromAccountData(o.data)),e.abrupt("return",{context:i,value:a});case 8:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getNonce",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t,r){return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getNonceAndContext(t,r).then((function(e){return e.value})).catch((function(e){throw new Error("failed to get nonce for account "+t.toBase58()+": "+e)}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"requestAirdrop",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t,r){var n,i;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._rpcRequest("requestAirdrop",[t.toBase58(),r]);case 2:if(n=e.sent,!("error"in(i=xt(n,za)))){e.next=6;break}throw new Xi(i.error,"airdrop to ".concat(t.toBase58()," failed"));case 6:return e.abrupt("return",i.result);case 7:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_blockhashWithExpiryBlockHeight",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t){var r,n;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=10;break}case 1:if(!this._pollingBlockhash){e.next=6;break}return e.next=4,Si(100);case 4:e.next=1;break;case 6:if(r=Date.now()-this._blockhashInfo.lastFetch,n=r>=oo,null===this._blockhashInfo.latestBlockhash||n){e.next=10;break}return e.abrupt("return",this._blockhashInfo.latestBlockhash);case 10:return e.next=12,this._pollNewBlockhash();case 12:return e.abrupt("return",e.sent);case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_pollNewBlockhash",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(){var t,r,n,i,o;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._pollingBlockhash=!0,e.prev=1,t=Date.now(),r=this._blockhashInfo.latestBlockhash,n=r?r.blockhash:null,i=0;case 6:if(!(i<50)){e.next=18;break}return e.next=9,this.getLatestBlockhash("finalized");case 9:if(o=e.sent,n===o.blockhash){e.next=13;break}return this._blockhashInfo={latestBlockhash:o,lastFetch:Date.now(),transactionSignatures:[],simulatedSignatures:[]},e.abrupt("return",o);case 13:return e.next=15,Si(200);case 15:i++,e.next=6;break;case 18:throw new Error("Unable to obtain a new blockhash after ".concat(Date.now()-t,"ms"));case 19:return e.prev=19,this._pollingBlockhash=!1,e.finish(19);case 22:case"end":return e.stop()}}),e,this,[[1,,19,22]])})));return function(){return e.apply(this,arguments)}}()},{key:"getStakeMinimumDelegation",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t){var r,n,i,o,a,s;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=ao(t),n=r.commitment,i=r.config,o=this._buildArgs([],n,"base64",i),e.next=4,this._rpcRequest("getStakeMinimumDelegation",o);case 4:if(a=e.sent,!("error"in(s=xt(a,lo(Ct()))))){e.next=8;break}throw new Xi(s.error,"failed to get stake minimum delegation");case 8:return e.abrupt("return",s.result);case 9:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"simulateTransaction",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t,r,n){var i,o,a,s,c,l,f,d,p,m,g,v,_,b,x,w,k,A,E,S,T,M,I,P,C,B;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!("message"in t)){e.next=17;break}if(i=t.serialize(),o=y.lW.from(i).toString("base64"),!Array.isArray(r)&&void 0===n){e.next=6;break}throw new Error("Invalid arguments");case 6:return(a=r||{}).encoding="base64","commitment"in a||(a.commitment=this.commitment),s=[o,a],e.next=12,this._rpcRequest("simulateTransaction",s);case 12:if(c=e.sent,!("error"in(l=xt(c,Ao)))){e.next=16;break}throw new Error("failed to simulate transaction: "+l.error.message);case 16:return e.abrupt("return",l.result);case 17:if(t instanceof fi?(d=t,(f=new fi).feePayer=d.feePayer,f.instructions=t.instructions,f.nonceInfo=d.nonceInfo,f.signatures=d.signatures):(f=fi.populate(t))._message=f._json=void 0,void 0===r||Array.isArray(r)){e.next=20;break}throw new Error("Invalid arguments");case 20:if(p=r,!f.nonceInfo||!p){e.next=25;break}(m=f).sign.apply(m,(0,u.Z)(p)),e.next=45;break;case 25:g=this._disableBlockhashCaching;case 26:return e.next=28,this._blockhashWithExpiryBlockHeight(g);case 28:if(_=e.sent,f.lastValidBlockHeight=_.lastValidBlockHeight,f.recentBlockhash=_.blockhash,p){e.next=33;break}return e.abrupt("break",45);case 33:if((v=f).sign.apply(v,(0,u.Z)(p)),f.signature){e.next=36;break}throw new Error("!signature");case 36:if(b=f.signature.toString("base64"),this._blockhashInfo.simulatedSignatures.includes(b)||this._blockhashInfo.transactionSignatures.includes(b)){e.next=42;break}return this._blockhashInfo.simulatedSignatures.push(b),e.abrupt("break",45);case 42:g=!0;case 43:e.next=26;break;case 45:return x=f._compile(),w=x.serialize(),k=f._serialize(w),A=k.toString("base64"),E={encoding:"base64",commitment:this.commitment},n&&(S=(Array.isArray(n)?n:x.nonProgramIds()).map((function(e){return e.toBase58()})),E.accounts={encoding:"base64",addresses:S}),p&&(E.sigVerify=!0),T=[A,E],e.next=55,this._rpcRequest("simulateTransaction",T);case 55:if(M=e.sent,!("error"in(I=xt(M,Ao)))){e.next=60;break}throw"data"in I.error&&(P=I.error.data.logs)&&Array.isArray(P)&&(B=(C="\n    ")+P.join(C),console.error(I.error.message,B)),new qi("failed to simulate transaction: "+I.error.message,P);case 60:return e.abrupt("return",I.result);case 61:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"sendTransaction",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t,r,n){var i,o,a,s,c,l;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!("version"in t)){e.next=7;break}if(!r||!Array.isArray(r)){e.next=3;break}throw new Error("Invalid arguments");case 3:return i=t.serialize(),e.next=6,this.sendRawTransaction(i,n);case 6:return e.abrupt("return",e.sent);case 7:if(void 0!==r&&Array.isArray(r)){e.next=9;break}throw new Error("Invalid arguments");case 9:if(o=r,!t.nonceInfo){e.next=14;break}t.sign.apply(t,(0,u.Z)(o)),e.next=32;break;case 14:a=this._disableBlockhashCaching;case 15:return e.next=17,this._blockhashWithExpiryBlockHeight(a);case 17:if(s=e.sent,t.lastValidBlockHeight=s.lastValidBlockHeight,t.recentBlockhash=s.blockhash,t.sign.apply(t,(0,u.Z)(o)),t.signature){e.next=23;break}throw new Error("!signature");case 23:if(c=t.signature.toString("base64"),this._blockhashInfo.transactionSignatures.includes(c)){e.next=29;break}return this._blockhashInfo.transactionSignatures.push(c),e.abrupt("break",32);case 29:a=!0;case 30:e.next=15;break;case 32:return l=t.serialize(),e.next=35,this.sendRawTransaction(l,n);case 35:return e.abrupt("return",e.sent);case 36:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"sendRawTransaction",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t,r){var n,i;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Ln(t).toString("base64"),e.next=3,this.sendEncodedTransaction(n,r);case 3:return i=e.sent,e.abrupt("return",i);case 5:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"sendEncodedTransaction",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t,r){var n,i,o,a,s,u,c;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={encoding:"base64"},i=r&&r.skipPreflight,o=r&&r.preflightCommitment||this.commitment,r&&null!=r.maxRetries&&(n.maxRetries=r.maxRetries),r&&null!=r.minContextSlot&&(n.minContextSlot=r.minContextSlot),i&&(n.skipPreflight=i),o&&(n.preflightCommitment=o),a=[t,n],e.next=10,this._rpcRequest("sendTransaction",a);case 10:if(s=e.sent,!("error"in(u=xt(s,Na)))){e.next=15;break}throw"data"in u.error&&(c=u.error.data.logs),new qi("failed to send transaction: "+u.error.message,c);case 15:return e.abrupt("return",u.result);case 16:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_wsOnOpen",value:function(){var e=this;this._rpcWebSocketConnected=!0,this._rpcWebSocketHeartbeat=setInterval((function(){(0,f.Z)((0,h.Z)().mark((function t(){return(0,h.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e._rpcWebSocket.notify("ping");case 3:t.next=7;break;case 5:t.prev=5,t.t0=t.catch(0);case 7:case"end":return t.stop()}}),t,null,[[0,5]])})))()}),5e3),this._updateSubscriptions()}},{key:"_wsOnError",value:function(e){this._rpcWebSocketConnected=!1,console.error("ws error:",e.message)}},{key:"_wsOnClose",value:function(e){var t=this;this._rpcWebSocketConnected=!1,this._rpcWebSocketGeneration=(this._rpcWebSocketGeneration+1)%Number.MAX_SAFE_INTEGER,this._rpcWebSocketIdleTimeout&&(clearTimeout(this._rpcWebSocketIdleTimeout),this._rpcWebSocketIdleTimeout=null),this._rpcWebSocketHeartbeat&&(clearInterval(this._rpcWebSocketHeartbeat),this._rpcWebSocketHeartbeat=null),1e3!==e?(this._subscriptionCallbacksByServerSubscriptionId={},Object.entries(this._subscriptionsByHash).forEach((function(e){var r=(0,s.Z)(e,2),n=r[0],i=r[1];t._setSubscription(n,(0,a.Z)((0,a.Z)({},i),{},{state:"pending"}))}))):this._updateSubscriptions()}},{key:"_setSubscription",value:function(e,t){var r,n=null===(r=this._subscriptionsByHash[e])||void 0===r?void 0:r.state;if(this._subscriptionsByHash[e]=t,n!==t.state){var i=this._subscriptionStateChangeCallbacksByHash[e];i&&i.forEach((function(e){try{e(t.state)}catch(r){}}))}}},{key:"_onSubscriptionStateChange",value:function(e,t){var r,n=this,i=this._subscriptionHashByClientSubscriptionId[e];if(null==i)return function(){};var o=(r=this._subscriptionStateChangeCallbacksByHash)[i]||(r[i]=new Set);return o.add(t),function(){o.delete(t),0===o.size&&delete n._subscriptionStateChangeCallbacksByHash[i]}}},{key:"_updateSubscriptions",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(){var t,r,n=this;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==Object.keys(this._subscriptionsByHash).length){e.next=3;break}return this._rpcWebSocketConnected&&(this._rpcWebSocketConnected=!1,this._rpcWebSocketIdleTimeout=setTimeout((function(){n._rpcWebSocketIdleTimeout=null;try{n._rpcWebSocket.close()}catch(e){e instanceof Error&&console.log("Error when closing socket connection: ".concat(e.message))}}),500)),e.abrupt("return");case 3:if(null!==this._rpcWebSocketIdleTimeout&&(clearTimeout(this._rpcWebSocketIdleTimeout),this._rpcWebSocketIdleTimeout=null,this._rpcWebSocketConnected=!0),this._rpcWebSocketConnected){e.next=7;break}return this._rpcWebSocket.connect(),e.abrupt("return");case 7:return t=this._rpcWebSocketGeneration,r=function(){return t===n._rpcWebSocketGeneration},e.next=11,Promise.all(Object.keys(this._subscriptionsByHash).map(function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t){var i;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==(i=n._subscriptionsByHash[t])){e.next=3;break}return e.abrupt("return");case 3:e.t0=i.state,e.next="pending"===e.t0||"unsubscribed"===e.t0?6:"subscribed"===e.t0?15:19;break;case 6:if(0!==i.callbacks.size){e.next=12;break}return delete n._subscriptionsByHash[t],"unsubscribed"===i.state&&delete n._subscriptionCallbacksByServerSubscriptionId[i.serverSubscriptionId],e.next=11,n._updateSubscriptions();case 11:return e.abrupt("return");case 12:return e.next=14,(0,f.Z)((0,h.Z)().mark((function e(){var o,s,u;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=i.args,s=i.method,e.prev=1,n._setSubscription(t,(0,a.Z)((0,a.Z)({},i),{},{state:"subscribing"})),e.next=5,n._rpcWebSocket.call(s,o);case 5:return u=e.sent,n._setSubscription(t,(0,a.Z)((0,a.Z)({},i),{},{serverSubscriptionId:u,state:"subscribed"})),n._subscriptionCallbacksByServerSubscriptionId[u]=i.callbacks,e.next=10,n._updateSubscriptions();case 10:e.next=20;break;case 12:if(e.prev=12,e.t0=e.catch(1),e.t0 instanceof Error&&console.error("".concat(s," error for argument"),o,e.t0.message),r()){e.next=17;break}return e.abrupt("return");case 17:return n._setSubscription(t,(0,a.Z)((0,a.Z)({},i),{},{state:"pending"})),e.next=20,n._updateSubscriptions();case 20:case"end":return e.stop()}}),e,null,[[1,12]])})))();case 14:case 18:return e.abrupt("break",19);case 15:if(0!==i.callbacks.size){e.next=18;break}return e.next=18,(0,f.Z)((0,h.Z)().mark((function e(){var o,s;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=i.serverSubscriptionId,s=i.unsubscribeMethod,!n._subscriptionsAutoDisposedByRpc.has(o)){e.next=5;break}n._subscriptionsAutoDisposedByRpc.delete(o),e.next=21;break;case 5:return n._setSubscription(t,(0,a.Z)((0,a.Z)({},i),{},{state:"unsubscribing"})),n._setSubscription(t,(0,a.Z)((0,a.Z)({},i),{},{state:"unsubscribing"})),e.prev=7,e.next=10,n._rpcWebSocket.call(s,[o]);case 10:e.next=21;break;case 12:if(e.prev=12,e.t0=e.catch(7),e.t0 instanceof Error&&console.error("".concat(s," error:"),e.t0.message),r()){e.next=17;break}return e.abrupt("return");case 17:return n._setSubscription(t,(0,a.Z)((0,a.Z)({},i),{},{state:"subscribed"})),e.next=20,n._updateSubscriptions();case 20:return e.abrupt("return");case 21:return n._setSubscription(t,(0,a.Z)((0,a.Z)({},i),{},{state:"unsubscribed"})),e.next=24,n._updateSubscriptions();case 24:case"end":return e.stop()}}),e,null,[[7,12]])})))();case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"_handleServerNotification",value:function(e,t){var r=this._subscriptionCallbacksByServerSubscriptionId[e];void 0!==r&&r.forEach((function(e){try{e.apply(void 0,(0,u.Z)(t))}catch(r){console.error(r)}}))}},{key:"_wsOnAccountNotification",value:function(e){var t=xt(e,Ho),r=t.result,n=t.subscription;this._handleServerNotification(n,[r.value,r.context])}},{key:"_makeSubscription",value:function(e,t){var r=this,n=this._nextClientSubscriptionId++,i=Ki([e.method,t]),o=this._subscriptionsByHash[i];return void 0===o?this._subscriptionsByHash[i]=(0,a.Z)((0,a.Z)({},e),{},{args:t,callbacks:new Set([e.callback]),state:"pending"}):o.callbacks.add(e.callback),this._subscriptionHashByClientSubscriptionId[n]=i,this._subscriptionDisposeFunctionsByClientSubscriptionId[n]=(0,f.Z)((0,h.Z)().mark((function t(){var o;return(0,h.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return delete r._subscriptionDisposeFunctionsByClientSubscriptionId[n],delete r._subscriptionHashByClientSubscriptionId[n],ii(void 0!==(o=r._subscriptionsByHash[i]),"Could not find a `Subscription` when tearing down client subscription #".concat(n)),o.callbacks.delete(e.callback),t.next=7,r._updateSubscriptions();case 7:case"end":return t.stop()}}),t)}))),this._updateSubscriptions(),n}},{key:"onAccountChange",value:function(e,t,r){var n=this._buildArgs([e.toBase58()],r||this._commitment||"finalized","base64");return this._makeSubscription({callback:t,method:"accountSubscribe",unsubscribeMethod:"accountUnsubscribe"},n)}},{key:"removeAccountChangeListener",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t){return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._unsubscribeClientSubscription(t,"account change");case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_wsOnProgramAccountNotification",value:function(e){var t=xt(e,Yo),r=t.result,n=t.subscription;this._handleServerNotification(n,[{accountId:r.value.pubkey,accountInfo:r.value.account},r.context])}},{key:"onProgramAccountChange",value:function(e,t,r,n){var i=this._buildArgs([e.toBase58()],r||this._commitment||"finalized","base64",n?{filters:n}:void 0);return this._makeSubscription({callback:t,method:"programSubscribe",unsubscribeMethod:"programUnsubscribe"},i)}},{key:"removeProgramAccountChangeListener",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t){return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._unsubscribeClientSubscription(t,"program account change");case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"onLogs",value:function(e,t,r){var n=this._buildArgs(["object"===typeof e?{mentions:[e.toString()]}:e],r||this._commitment||"finalized");return this._makeSubscription({callback:t,method:"logsSubscribe",unsubscribeMethod:"logsUnsubscribe"},n)}},{key:"removeOnLogsListener",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t){return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._unsubscribeClientSubscription(t,"logs");case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_wsOnLogsNotification",value:function(e){var t=xt(e,Za),r=t.result,n=t.subscription;this._handleServerNotification(n,[r.value,r.context])}},{key:"_wsOnSlotNotification",value:function(e){var t=xt(e,Qo),r=t.result,n=t.subscription;this._handleServerNotification(n,[r])}},{key:"onSlotChange",value:function(e){return this._makeSubscription({callback:e,method:"slotSubscribe",unsubscribeMethod:"slotUnsubscribe"},[])}},{key:"removeSlotChangeListener",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t){return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._unsubscribeClientSubscription(t,"slot change");case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_wsOnSlotUpdatesNotification",value:function(e){var t=xt(e,Jo),r=t.result,n=t.subscription;this._handleServerNotification(n,[r])}},{key:"onSlotUpdate",value:function(e){return this._makeSubscription({callback:e,method:"slotsUpdatesSubscribe",unsubscribeMethod:"slotsUpdatesUnsubscribe"},[])}},{key:"removeSlotUpdateListener",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t){return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._unsubscribeClientSubscription(t,"slot update");case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_unsubscribeClientSubscription",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t,r){var n;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=this._subscriptionDisposeFunctionsByClientSubscriptionId[t])){e.next=6;break}return e.next=4,n();case 4:e.next=7;break;case 6:console.warn("Ignored unsubscribe request because an active subscription with id "+"`".concat(t,"` for '").concat(r,"' events ")+"could not be found.");case 7:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_buildArgs",value:function(e,t,r,n){var i=t||this._commitment;if(i||r||n){var o={};r&&(o.encoding=r),i&&(o.commitment=i),n&&(o=Object.assign(o,n)),e.push(o)}return e}},{key:"_buildArgsAtLeastConfirmed",value:function(e,t,r,n){var i=t||this._commitment;if(i&&!["confirmed","finalized"].includes(i))throw new Error("Using Connection with default commitment: `"+this._commitment+"`, but method requires at least `confirmed`");return this._buildArgs(e,t,r,n)}},{key:"_wsOnSignatureNotification",value:function(e){var t=xt(e,ea),r=t.result,n=t.subscription;"receivedSignature"!==r.value&&this._subscriptionsAutoDisposedByRpc.add(n),this._handleServerNotification(n,"receivedSignature"===r.value?[{type:"received"},r.context]:[{type:"status",result:r.value},r.context])}},{key:"onSignature",value:function(e,t,r){var n=this,i=this._buildArgs([e],r||this._commitment||"finalized"),o=this._makeSubscription({callback:function(e,r){if("status"===e.type){t(e.result,r);try{n.removeSignatureListener(o)}catch(i){}}},method:"signatureSubscribe",unsubscribeMethod:"signatureUnsubscribe"},i);return o}},{key:"onSignatureWithOptions",value:function(e,t,r){var i=this,o=(0,a.Z)((0,a.Z)({},r),{},{commitment:r&&r.commitment||this._commitment||"finalized"}),s=o.commitment,u=(0,n.Z)(o,Tn),c=this._buildArgs([e],s,void 0,u),l=this._makeSubscription({callback:function(e,r){t(e,r);try{i.removeSignatureListener(l)}catch(n){}},method:"signatureSubscribe",unsubscribeMethod:"signatureUnsubscribe"},c);return l}},{key:"removeSignatureListener",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t){return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._unsubscribeClientSubscription(t,"signature result");case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"_wsOnRootNotification",value:function(e){var t=xt(e,ta),r=t.result,n=t.subscription;this._handleServerNotification(n,[r])}},{key:"onRootChange",value:function(e){return this._makeSubscription({callback:e,method:"rootSubscribe",unsubscribeMethod:"rootUnsubscribe"},[])}},{key:"removeRootChangeListener",value:function(){var e=(0,f.Z)((0,h.Z)().mark((function e(t){return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._unsubscribeClientSubscription(t,"root change");case 2:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),Va=function(){function e(t){(0,m.Z)(this,e),this._keypair=void 0,this._keypair=null!==t&&void 0!==t?t:In()}return(0,g.Z)(e,[{key:"publicKey",get:function(){return new jn(this._keypair.publicKey)}},{key:"secretKey",get:function(){return new Uint8Array(this._keypair.secretKey)}}],[{key:"generate",value:function(){return new e(In())}},{key:"fromSecretKey",value:function(t,r){if(64!==t.byteLength)throw new Error("bad secret key size");var n=t.slice(32,64);if(!r||!r.skipValidation)for(var i=t.slice(0,32),o=Pn(i),a=0;a<32;a++)if(n[a]!==o[a])throw new Error("provided secretKey is invalid");return new e({publicKey:n,secretKey:t})}},{key:"fromSeed",value:function(t){var r=Pn(t),n=new Uint8Array(64);return n.set(t),n.set(r,32),new e({publicKey:r,secretKey:n})}}]),e}(),Wa=Object.freeze({CreateLookupTable:{index:0,layout:nt.struct([nt.u32("instruction"),Ri("recentSlot"),nt.u8("bumpSeed")])},FreezeLookupTable:{index:1,layout:nt.struct([nt.u32("instruction")])},ExtendLookupTable:{index:2,layout:nt.struct([nt.u32("instruction"),Ri(),nt.seq($n(),nt.offset(nt.u32(),-8),"addresses")])},DeactivateLookupTable:{index:3,layout:nt.struct([nt.u32("instruction")])},CloseLookupTable:{index:4,layout:nt.struct([nt.u32("instruction")])}}),Ka=function(){function e(){(0,m.Z)(this,e)}return(0,g.Z)(e,null,[{key:"decodeInstructionType",value:function(e){this.checkProgramId(e.programId);for(var t,r=nt.u32("instruction").decode(e.data),n=0,i=Object.entries(Wa);n<i.length;n++){var o=(0,s.Z)(i[n],2),a=o[0];if(o[1].index==r){t=a;break}}if(!t)throw new Error("Invalid Instruction. Should be a LookupTable Instruction");return t}},{key:"decodeCreateLookupTable",value:function(e){this.checkProgramId(e.programId),this.checkKeysLength(e.keys,4);var t=Mi(Wa.CreateLookupTable,e.data).recentSlot;return{authority:e.keys[1].pubkey,payer:e.keys[2].pubkey,recentSlot:Number(t)}}},{key:"decodeExtendLookupTable",value:function(e){if(this.checkProgramId(e.programId),e.keys.length<2)throw new Error("invalid instruction; found ".concat(e.keys.length," keys, expected at least 2"));var t=Mi(Wa.ExtendLookupTable,e.data).addresses;return{lookupTable:e.keys[0].pubkey,authority:e.keys[1].pubkey,payer:e.keys.length>2?e.keys[2].pubkey:void 0,addresses:t.map((function(e){return new jn(e)}))}}},{key:"decodeCloseLookupTable",value:function(e){return this.checkProgramId(e.programId),this.checkKeysLength(e.keys,3),{lookupTable:e.keys[0].pubkey,authority:e.keys[1].pubkey,recipient:e.keys[2].pubkey}}},{key:"decodeFreezeLookupTable",value:function(e){return this.checkProgramId(e.programId),this.checkKeysLength(e.keys,2),{lookupTable:e.keys[0].pubkey,authority:e.keys[1].pubkey}}},{key:"decodeDeactivateLookupTable",value:function(e){return this.checkProgramId(e.programId),this.checkKeysLength(e.keys,2),{lookupTable:e.keys[0].pubkey,authority:e.keys[1].pubkey}}},{key:"checkProgramId",value:function(e){if(!e.equals(Ga.programId))throw new Error("invalid instruction; programId is not AddressLookupTable Program")}},{key:"checkKeysLength",value:function(e,t){if(e.length<t)throw new Error("invalid instruction; found ".concat(e.length," keys, expected at least ").concat(t))}}]),e}(),Ga=function(){function e(){(0,m.Z)(this,e)}return(0,g.Z)(e,null,[{key:"createLookupTable",value:function(e){var t=jn.findProgramAddressSync([e.authority.toBuffer(),(0,it.k$)(BigInt(e.recentSlot),8)],this.programId),r=(0,s.Z)(t,2),n=r[0],i=r[1],o=Ti(Wa.CreateLookupTable,{recentSlot:BigInt(e.recentSlot),bumpSeed:i}),a=[{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:e.authority,isSigner:!0,isWritable:!1},{pubkey:e.payer,isSigner:!0,isWritable:!0},{pubkey:zi.programId,isSigner:!1,isWritable:!1}];return[new hi({programId:this.programId,keys:a,data:o}),n]}},{key:"freezeLookupTable",value:function(e){var t=Ti(Wa.FreezeLookupTable),r=[{pubkey:e.lookupTable,isSigner:!1,isWritable:!0},{pubkey:e.authority,isSigner:!0,isWritable:!1}];return new hi({programId:this.programId,keys:r,data:t})}},{key:"extendLookupTable",value:function(e){var t=Ti(Wa.ExtendLookupTable,{addresses:e.addresses.map((function(e){return e.toBytes()}))}),r=[{pubkey:e.lookupTable,isSigner:!1,isWritable:!0},{pubkey:e.authority,isSigner:!0,isWritable:!1}];return e.payer&&r.push({pubkey:e.payer,isSigner:!0,isWritable:!0},{pubkey:zi.programId,isSigner:!1,isWritable:!1}),new hi({programId:this.programId,keys:r,data:t})}},{key:"deactivateLookupTable",value:function(e){var t=Ti(Wa.DeactivateLookupTable),r=[{pubkey:e.lookupTable,isSigner:!1,isWritable:!0},{pubkey:e.authority,isSigner:!0,isWritable:!1}];return new hi({programId:this.programId,keys:r,data:t})}},{key:"closeLookupTable",value:function(e){var t=Ti(Wa.CloseLookupTable),r=[{pubkey:e.lookupTable,isSigner:!1,isWritable:!0},{pubkey:e.authority,isSigner:!0,isWritable:!1},{pubkey:e.recipient,isSigner:!1,isWritable:!0}];return new hi({programId:this.programId,keys:r,data:t})}}]),e}();Ga.programId=new jn("AddressLookupTab1e1111111111111111111111111");var Ha=function(){function e(){(0,m.Z)(this,e)}return(0,g.Z)(e,null,[{key:"decodeInstructionType",value:function(e){this.checkProgramId(e.programId);for(var t,r=nt.u8("instruction").decode(e.data),n=0,i=Object.entries(qa);n<i.length;n++){var o=(0,s.Z)(i[n],2),a=o[0];if(o[1].index==r){t=a;break}}if(!t)throw new Error("Instruction type incorrect; not a ComputeBudgetInstruction");return t}},{key:"decodeRequestUnits",value:function(e){this.checkProgramId(e.programId);var t=Mi(qa.RequestUnits,e.data);return{units:t.units,additionalFee:t.additionalFee}}},{key:"decodeRequestHeapFrame",value:function(e){return this.checkProgramId(e.programId),{bytes:Mi(qa.RequestHeapFrame,e.data).bytes}}},{key:"decodeSetComputeUnitLimit",value:function(e){return this.checkProgramId(e.programId),{units:Mi(qa.SetComputeUnitLimit,e.data).units}}},{key:"decodeSetComputeUnitPrice",value:function(e){return this.checkProgramId(e.programId),{microLamports:Mi(qa.SetComputeUnitPrice,e.data).microLamports}}},{key:"checkProgramId",value:function(e){if(!e.equals(Ya.programId))throw new Error("invalid instruction; programId is not ComputeBudgetProgram")}}]),e}(),qa=Object.freeze({RequestUnits:{index:0,layout:nt.struct([nt.u8("instruction"),nt.u32("units"),nt.u32("additionalFee")])},RequestHeapFrame:{index:1,layout:nt.struct([nt.u8("instruction"),nt.u32("bytes")])},SetComputeUnitLimit:{index:2,layout:nt.struct([nt.u8("instruction"),nt.u32("units")])},SetComputeUnitPrice:{index:3,layout:nt.struct([nt.u8("instruction"),Ri("microLamports")])}}),Ya=function(){function e(){(0,m.Z)(this,e)}return(0,g.Z)(e,null,[{key:"requestUnits",value:function(e){var t=Ti(qa.RequestUnits,e);return new hi({keys:[],programId:this.programId,data:t})}},{key:"requestHeapFrame",value:function(e){var t=Ti(qa.RequestHeapFrame,e);return new hi({keys:[],programId:this.programId,data:t})}},{key:"setComputeUnitLimit",value:function(e){var t=Ti(qa.SetComputeUnitLimit,e);return new hi({keys:[],programId:this.programId,data:t})}},{key:"setComputeUnitPrice",value:function(e){var t=Ti(qa.SetComputeUnitPrice,{microLamports:BigInt(e.microLamports)});return new hi({keys:[],programId:this.programId,data:t})}}]),e}();Ya.programId=new jn("ComputeBudget111111111111111111111111111111");var Xa=nt.struct([nt.u8("numSignatures"),nt.u8("padding"),nt.u16("signatureOffset"),nt.u16("signatureInstructionIndex"),nt.u16("publicKeyOffset"),nt.u16("publicKeyInstructionIndex"),nt.u16("messageDataOffset"),nt.u16("messageDataSize"),nt.u16("messageInstructionIndex")]),Qa=function(){function e(){(0,m.Z)(this,e)}return(0,g.Z)(e,null,[{key:"createInstructionWithPublicKey",value:function(t){var r=t.publicKey,n=t.message,i=t.signature,o=t.instructionIndex;ii(32===r.length,"Public Key must be ".concat(32," bytes but received ").concat(r.length," bytes")),ii(64===i.length,"Signature must be ".concat(64," bytes but received ").concat(i.length," bytes"));var a=Xa.span,s=a+r.length,u=s+i.length,c=y.lW.alloc(u+n.length),l=null==o?65535:o;return Xa.encode({numSignatures:1,padding:0,signatureOffset:s,signatureInstructionIndex:l,publicKeyOffset:a,publicKeyInstructionIndex:l,messageDataOffset:u,messageDataSize:n.length,messageInstructionIndex:l},c),c.fill(r,a),c.fill(i,s),c.fill(n,u),new hi({keys:[],programId:e.programId,data:c})}},{key:"createInstructionWithPrivateKey",value:function(e){var t=e.privateKey,r=e.message,n=e.instructionIndex;ii(64===t.length,"Private key must be ".concat(64," bytes but received ").concat(t.length," bytes"));try{var i=Va.fromSecretKey(t),o=i.publicKey.toBytes(),a=Dn(r,i.secretKey);return this.createInstructionWithPublicKey({publicKey:o,message:r,signature:a,instructionIndex:n})}catch(s){throw new Error("Error creating instruction; ".concat(s))}}}]),e}();Qa.programId=new jn("Ed25519SigVerify111111111111111111111111111"),kn.hmacSha256Sync=function(e){for(var t=yr.create(tt,e),r=arguments.length,n=new Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return n.forEach((function(e){return t.update(e)})),t.digest()};var $a=function(e,t){return function(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=_n(e,t,n.extraEntropy),o=i.seed,a=i.m,s=i.d,u=new ln(Cr,Pr);for(u.reseedSync(o);!(r=dn(u.generateSync(),a,s,n.canonical));)u.reseedSync();return bn(r,n)}(e,t,{der:!1,recovered:!0})};kn.isValidPrivateKey;var Ja=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Fr.fromPrivateKey(e).toRawBytes(t)},es=nt.struct([nt.u8("numSignatures"),nt.u16("signatureOffset"),nt.u8("signatureInstructionIndex"),nt.u16("ethAddressOffset"),nt.u8("ethAddressInstructionIndex"),nt.u16("messageDataOffset"),nt.u16("messageDataSize"),nt.u8("messageInstructionIndex"),nt.blob(20,"ethAddress"),nt.blob(64,"signature"),nt.u8("recoveryId")]),ts=function(){function e(){(0,m.Z)(this,e)}return(0,g.Z)(e,null,[{key:"publicKeyToEthAddress",value:function(e){ii(64===e.length,"Public key must be ".concat(64," bytes but received ").concat(e.length," bytes"));try{return y.lW.from(pr(Ln(e))).slice(-20)}catch(t){throw new Error("Error constructing Ethereum address: ".concat(t))}}},{key:"createInstructionWithPublicKey",value:function(t){var r=t.publicKey,n=t.message,i=t.signature,o=t.recoveryId,a=t.instructionIndex;return e.createInstructionWithEthAddress({ethAddress:e.publicKeyToEthAddress(r),message:n,signature:i,recoveryId:o,instructionIndex:a})}},{key:"createInstructionWithEthAddress",value:function(t){var r,n=t.ethAddress,i=t.message,o=t.signature,a=t.recoveryId,s=t.instructionIndex,u=void 0===s?0:s;ii(20===(r="string"===typeof n?n.startsWith("0x")?y.lW.from(n.substr(2),"hex"):y.lW.from(n,"hex"):n).length,"Address must be ".concat(20," bytes but received ").concat(r.length," bytes"));var c=12+r.length,l=c+o.length+1,h=y.lW.alloc(es.span+i.length);return es.encode({numSignatures:1,signatureOffset:c,signatureInstructionIndex:u,ethAddressOffset:12,ethAddressInstructionIndex:u,messageDataOffset:l,messageDataSize:i.length,messageInstructionIndex:u,signature:Ln(o),ethAddress:Ln(r),recoveryId:a},h),h.fill(Ln(i),es.span),new hi({keys:[],programId:e.programId,data:h})}},{key:"createInstructionWithPrivateKey",value:function(e){var t=e.privateKey,r=e.message,n=e.instructionIndex;ii(32===t.length,"Private key must be ".concat(32," bytes but received ").concat(t.length," bytes"));try{var i=Ln(t),o=Ja(i,!1).slice(1),a=y.lW.from(pr(Ln(r))),u=$a(a,i),c=(0,s.Z)(u,2),l=c[0],h=c[1];return this.createInstructionWithPublicKey({publicKey:o,message:r,signature:l,recoveryId:h,instructionIndex:n})}catch(f){throw new Error("Error creating instruction; ".concat(f))}}}]),e}();ts.programId=new jn("KeccakSecp256k11111111111111111111111111111");var rs=new jn("StakeConfig11111111111111111111111111111111"),ns=(0,g.Z)((function e(t,r){(0,m.Z)(this,e),this.staker=void 0,this.withdrawer=void 0,this.staker=t,this.withdrawer=r})),is=(0,g.Z)((function e(t,r,n){(0,m.Z)(this,e),this.unixTimestamp=void 0,this.epoch=void 0,this.custodian=void 0,this.unixTimestamp=t,this.epoch=r,this.custodian=n}));is.default=new is(0,0,jn.default);var os=function(){function e(){(0,m.Z)(this,e)}return(0,g.Z)(e,null,[{key:"decodeInstructionType",value:function(e){this.checkProgramId(e.programId);for(var t,r=nt.u32("instruction").decode(e.data),n=0,i=Object.entries(as);n<i.length;n++){var o=(0,s.Z)(i[n],2),a=o[0];if(o[1].index==r){t=a;break}}if(!t)throw new Error("Instruction type incorrect; not a StakeInstruction");return t}},{key:"decodeInitialize",value:function(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);var t=Mi(as.Initialize,e.data),r=t.authorized,n=t.lockup;return{stakePubkey:e.keys[0].pubkey,authorized:new ns(new jn(r.staker),new jn(r.withdrawer)),lockup:new is(n.unixTimestamp,n.epoch,new jn(n.custodian))}}},{key:"decodeDelegate",value:function(e){return this.checkProgramId(e.programId),this.checkKeyLength(e.keys,6),Mi(as.Delegate,e.data),{stakePubkey:e.keys[0].pubkey,votePubkey:e.keys[1].pubkey,authorizedPubkey:e.keys[5].pubkey}}},{key:"decodeAuthorize",value:function(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);var t=Mi(as.Authorize,e.data),r=t.newAuthorized,n=t.stakeAuthorizationType,i={stakePubkey:e.keys[0].pubkey,authorizedPubkey:e.keys[2].pubkey,newAuthorizedPubkey:new jn(r),stakeAuthorizationType:{index:n}};return e.keys.length>3&&(i.custodianPubkey=e.keys[3].pubkey),i}},{key:"decodeAuthorizeWithSeed",value:function(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,2);var t=Mi(as.AuthorizeWithSeed,e.data),r=t.newAuthorized,n=t.stakeAuthorizationType,i=t.authoritySeed,o=t.authorityOwner,a={stakePubkey:e.keys[0].pubkey,authorityBase:e.keys[1].pubkey,authoritySeed:i,authorityOwner:new jn(o),newAuthorizedPubkey:new jn(r),stakeAuthorizationType:{index:n}};return e.keys.length>3&&(a.custodianPubkey=e.keys[3].pubkey),a}},{key:"decodeSplit",value:function(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);var t=Mi(as.Split,e.data).lamports;return{stakePubkey:e.keys[0].pubkey,splitStakePubkey:e.keys[1].pubkey,authorizedPubkey:e.keys[2].pubkey,lamports:t}}},{key:"decodeMerge",value:function(e){return this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3),Mi(as.Merge,e.data),{stakePubkey:e.keys[0].pubkey,sourceStakePubKey:e.keys[1].pubkey,authorizedPubkey:e.keys[4].pubkey}}},{key:"decodeWithdraw",value:function(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,5);var t=Mi(as.Withdraw,e.data).lamports,r={stakePubkey:e.keys[0].pubkey,toPubkey:e.keys[1].pubkey,authorizedPubkey:e.keys[4].pubkey,lamports:t};return e.keys.length>5&&(r.custodianPubkey=e.keys[5].pubkey),r}},{key:"decodeDeactivate",value:function(e){return this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3),Mi(as.Deactivate,e.data),{stakePubkey:e.keys[0].pubkey,authorizedPubkey:e.keys[2].pubkey}}},{key:"checkProgramId",value:function(e){if(!e.equals(us.programId))throw new Error("invalid instruction; programId is not StakeProgram")}},{key:"checkKeyLength",value:function(e,t){if(e.length<t)throw new Error("invalid instruction; found ".concat(e.length," keys, expected at least ").concat(t))}}]),e}(),as=Object.freeze({Initialize:{index:0,layout:nt.struct([nt.u32("instruction"),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"authorized";return nt.struct([$n("staker"),$n("withdrawer")],e)}(),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"lockup";return nt.struct([nt.ns64("unixTimestamp"),nt.ns64("epoch"),$n("custodian")],e)}()])},Authorize:{index:1,layout:nt.struct([nt.u32("instruction"),$n("newAuthorized"),nt.u32("stakeAuthorizationType")])},Delegate:{index:2,layout:nt.struct([nt.u32("instruction")])},Split:{index:3,layout:nt.struct([nt.u32("instruction"),nt.ns64("lamports")])},Withdraw:{index:4,layout:nt.struct([nt.u32("instruction"),nt.ns64("lamports")])},Deactivate:{index:5,layout:nt.struct([nt.u32("instruction")])},Merge:{index:7,layout:nt.struct([nt.u32("instruction")])},AuthorizeWithSeed:{index:8,layout:nt.struct([nt.u32("instruction"),$n("newAuthorized"),nt.u32("stakeAuthorizationType"),ei("authoritySeed"),$n("authorityOwner")])}}),ss=Object.freeze({Staker:{index:0},Withdrawer:{index:1}}),us=function(){function e(){(0,m.Z)(this,e)}return(0,g.Z)(e,null,[{key:"initialize",value:function(e){var t=e.stakePubkey,r=e.authorized,n=e.lockup||is.default,i=Ti(as.Initialize,{authorized:{staker:Ln(r.staker.toBuffer()),withdrawer:Ln(r.withdrawer.toBuffer())},lockup:{unixTimestamp:n.unixTimestamp,epoch:n.epoch,custodian:Ln(n.custodian.toBuffer())}}),o={keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:_i,isSigner:!1,isWritable:!1}],programId:this.programId,data:i};return new hi(o)}},{key:"createAccountWithSeed",value:function(e){var t=new fi;t.add(zi.createAccountWithSeed({fromPubkey:e.fromPubkey,newAccountPubkey:e.stakePubkey,basePubkey:e.basePubkey,seed:e.seed,lamports:e.lamports,space:this.space,programId:this.programId}));var r=e.stakePubkey,n=e.authorized,i=e.lockup;return t.add(this.initialize({stakePubkey:r,authorized:n,lockup:i}))}},{key:"createAccount",value:function(e){var t=new fi;t.add(zi.createAccount({fromPubkey:e.fromPubkey,newAccountPubkey:e.stakePubkey,lamports:e.lamports,space:this.space,programId:this.programId}));var r=e.stakePubkey,n=e.authorized,i=e.lockup;return t.add(this.initialize({stakePubkey:r,authorized:n,lockup:i}))}},{key:"delegate",value:function(e){var t=e.stakePubkey,r=e.authorizedPubkey,n=e.votePubkey,i=Ti(as.Delegate);return(new fi).add({keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!1},{pubkey:mi,isSigner:!1,isWritable:!1},{pubkey:ki,isSigner:!1,isWritable:!1},{pubkey:rs,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!0,isWritable:!1}],programId:this.programId,data:i})}},{key:"authorize",value:function(e){var t=e.stakePubkey,r=e.authorizedPubkey,n=e.newAuthorizedPubkey,i=e.stakeAuthorizationType,o=e.custodianPubkey,a=Ti(as.Authorize,{newAuthorized:Ln(n.toBuffer()),stakeAuthorizationType:i.index}),s=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:mi,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!0,isWritable:!1}];return o&&s.push({pubkey:o,isSigner:!1,isWritable:!1}),(new fi).add({keys:s,programId:this.programId,data:a})}},{key:"authorizeWithSeed",value:function(e){var t=e.stakePubkey,r=e.authorityBase,n=e.authoritySeed,i=e.authorityOwner,o=e.newAuthorizedPubkey,a=e.stakeAuthorizationType,s=e.custodianPubkey,u=Ti(as.AuthorizeWithSeed,{newAuthorized:Ln(o.toBuffer()),stakeAuthorizationType:a.index,authoritySeed:n,authorityOwner:Ln(i.toBuffer())}),c=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!0,isWritable:!1},{pubkey:mi,isSigner:!1,isWritable:!1}];return s&&c.push({pubkey:s,isSigner:!1,isWritable:!1}),(new fi).add({keys:c,programId:this.programId,data:u})}},{key:"splitInstruction",value:function(e){var t=e.stakePubkey,r=e.authorizedPubkey,n=e.splitStakePubkey,i=e.lamports,o=Ti(as.Split,{lamports:i});return new hi({keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!0,isWritable:!1}],programId:this.programId,data:o})}},{key:"split",value:function(e){var t=new fi;return t.add(zi.createAccount({fromPubkey:e.authorizedPubkey,newAccountPubkey:e.splitStakePubkey,lamports:0,space:this.space,programId:this.programId})),t.add(this.splitInstruction(e))}},{key:"splitWithSeed",value:function(e){var t=e.stakePubkey,r=e.authorizedPubkey,n=e.splitStakePubkey,i=e.basePubkey,o=e.seed,a=e.lamports,s=new fi;return s.add(zi.allocate({accountPubkey:n,basePubkey:i,seed:o,space:this.space,programId:this.programId})),s.add(this.splitInstruction({stakePubkey:t,authorizedPubkey:r,splitStakePubkey:n,lamports:a}))}},{key:"merge",value:function(e){var t=e.stakePubkey,r=e.sourceStakePubKey,n=e.authorizedPubkey,i=Ti(as.Merge);return(new fi).add({keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!1,isWritable:!0},{pubkey:mi,isSigner:!1,isWritable:!1},{pubkey:ki,isSigner:!1,isWritable:!1},{pubkey:n,isSigner:!0,isWritable:!1}],programId:this.programId,data:i})}},{key:"withdraw",value:function(e){var t=e.stakePubkey,r=e.authorizedPubkey,n=e.toPubkey,i=e.lamports,o=e.custodianPubkey,a=Ti(as.Withdraw,{lamports:i}),s=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:n,isSigner:!1,isWritable:!0},{pubkey:mi,isSigner:!1,isWritable:!1},{pubkey:ki,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!0,isWritable:!1}];return o&&s.push({pubkey:o,isSigner:!1,isWritable:!1}),(new fi).add({keys:s,programId:this.programId,data:a})}},{key:"deactivate",value:function(e){var t=e.stakePubkey,r=e.authorizedPubkey,n=Ti(as.Deactivate);return(new fi).add({keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:mi,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!0,isWritable:!1}],programId:this.programId,data:n})}}]),e}();us.programId=new jn("Stake11111111111111111111111111111111111111"),us.space=200;var cs=(0,g.Z)((function e(t,r,n,i){(0,m.Z)(this,e),this.nodePubkey=void 0,this.authorizedVoter=void 0,this.authorizedWithdrawer=void 0,this.commission=void 0,this.nodePubkey=t,this.authorizedVoter=r,this.authorizedWithdrawer=n,this.commission=i})),ls=function(){function e(){(0,m.Z)(this,e)}return(0,g.Z)(e,null,[{key:"decodeInstructionType",value:function(e){this.checkProgramId(e.programId);for(var t,r=nt.u32("instruction").decode(e.data),n=0,i=Object.entries(hs);n<i.length;n++){var o=(0,s.Z)(i[n],2),a=o[0];if(o[1].index==r){t=a;break}}if(!t)throw new Error("Instruction type incorrect; not a VoteInstruction");return t}},{key:"decodeInitializeAccount",value:function(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,4);var t=Mi(hs.InitializeAccount,e.data).voteInit;return{votePubkey:e.keys[0].pubkey,nodePubkey:e.keys[3].pubkey,voteInit:new cs(new jn(t.nodePubkey),new jn(t.authorizedVoter),new jn(t.authorizedWithdrawer),t.commission)}}},{key:"decodeAuthorize",value:function(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);var t=Mi(hs.Authorize,e.data),r=t.newAuthorized,n=t.voteAuthorizationType;return{votePubkey:e.keys[0].pubkey,authorizedPubkey:e.keys[2].pubkey,newAuthorizedPubkey:new jn(r),voteAuthorizationType:{index:n}}}},{key:"decodeAuthorizeWithSeed",value:function(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);var t=Mi(hs.AuthorizeWithSeed,e.data).voteAuthorizeWithSeedArgs,r=t.currentAuthorityDerivedKeyOwnerPubkey,n=t.currentAuthorityDerivedKeySeed,i=t.newAuthorized,o=t.voteAuthorizationType;return{currentAuthorityDerivedKeyBasePubkey:e.keys[2].pubkey,currentAuthorityDerivedKeyOwnerPubkey:new jn(r),currentAuthorityDerivedKeySeed:n,newAuthorizedPubkey:new jn(i),voteAuthorizationType:{index:o},votePubkey:e.keys[0].pubkey}}},{key:"decodeWithdraw",value:function(e){this.checkProgramId(e.programId),this.checkKeyLength(e.keys,3);var t=Mi(hs.Withdraw,e.data).lamports;return{votePubkey:e.keys[0].pubkey,authorizedWithdrawerPubkey:e.keys[2].pubkey,lamports:t,toPubkey:e.keys[1].pubkey}}},{key:"checkProgramId",value:function(e){if(!e.equals(ds.programId))throw new Error("invalid instruction; programId is not VoteProgram")}},{key:"checkKeyLength",value:function(e,t){if(e.length<t)throw new Error("invalid instruction; found ".concat(e.length," keys, expected at least ").concat(t))}}]),e}(),hs=Object.freeze({InitializeAccount:{index:0,layout:nt.struct([nt.u32("instruction"),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"voteInit";return nt.struct([$n("nodePubkey"),$n("authorizedVoter"),$n("authorizedWithdrawer"),nt.u8("commission")],e)}()])},Authorize:{index:1,layout:nt.struct([nt.u32("instruction"),$n("newAuthorized"),nt.u32("voteAuthorizationType")])},Withdraw:{index:3,layout:nt.struct([nt.u32("instruction"),nt.ns64("lamports")])},AuthorizeWithSeed:{index:10,layout:nt.struct([nt.u32("instruction"),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"voteAuthorizeWithSeedArgs";return nt.struct([nt.u32("voteAuthorizationType"),$n("currentAuthorityDerivedKeyOwnerPubkey"),ei("currentAuthorityDerivedKeySeed"),$n("newAuthorized")],e)}()])}}),fs=Object.freeze({Voter:{index:0},Withdrawer:{index:1}}),ds=function(){function e(){(0,m.Z)(this,e)}return(0,g.Z)(e,null,[{key:"initializeAccount",value:function(e){var t=e.votePubkey,r=e.nodePubkey,n=e.voteInit,i=Ti(hs.InitializeAccount,{voteInit:{nodePubkey:Ln(n.nodePubkey.toBuffer()),authorizedVoter:Ln(n.authorizedVoter.toBuffer()),authorizedWithdrawer:Ln(n.authorizedWithdrawer.toBuffer()),commission:n.commission}}),o={keys:[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:_i,isSigner:!1,isWritable:!1},{pubkey:mi,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!0,isWritable:!1}],programId:this.programId,data:i};return new hi(o)}},{key:"createAccount",value:function(e){var t=new fi;return t.add(zi.createAccount({fromPubkey:e.fromPubkey,newAccountPubkey:e.votePubkey,lamports:e.lamports,space:this.space,programId:this.programId})),t.add(this.initializeAccount({votePubkey:e.votePubkey,nodePubkey:e.voteInit.nodePubkey,voteInit:e.voteInit}))}},{key:"authorize",value:function(e){var t=e.votePubkey,r=e.authorizedPubkey,n=e.newAuthorizedPubkey,i=e.voteAuthorizationType,o=Ti(hs.Authorize,{newAuthorized:Ln(n.toBuffer()),voteAuthorizationType:i.index}),a=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:mi,isSigner:!1,isWritable:!1},{pubkey:r,isSigner:!0,isWritable:!1}];return(new fi).add({keys:a,programId:this.programId,data:o})}},{key:"authorizeWithSeed",value:function(e){var t=e.currentAuthorityDerivedKeyBasePubkey,r=e.currentAuthorityDerivedKeyOwnerPubkey,n=e.currentAuthorityDerivedKeySeed,i=e.newAuthorizedPubkey,o=e.voteAuthorizationType,a=e.votePubkey,s=Ti(hs.AuthorizeWithSeed,{voteAuthorizeWithSeedArgs:{currentAuthorityDerivedKeyOwnerPubkey:Ln(r.toBuffer()),currentAuthorityDerivedKeySeed:n,newAuthorized:Ln(i.toBuffer()),voteAuthorizationType:o.index}}),u=[{pubkey:a,isSigner:!1,isWritable:!0},{pubkey:mi,isSigner:!1,isWritable:!1},{pubkey:t,isSigner:!0,isWritable:!1}];return(new fi).add({keys:u,programId:this.programId,data:s})}},{key:"withdraw",value:function(e){var t=e.votePubkey,r=e.authorizedWithdrawerPubkey,n=e.lamports,i=e.toPubkey,o=Ti(hs.Withdraw,{lamports:n}),a=[{pubkey:t,isSigner:!1,isWritable:!0},{pubkey:i,isSigner:!1,isWritable:!0},{pubkey:r,isSigner:!0,isWritable:!1}];return(new fi).add({keys:a,programId:this.programId,data:o})}},{key:"safeWithdraw",value:function(t,r,n){if(t.lamports>r-n)throw new Error("Withdraw will leave vote account with insuffcient funds.");return e.withdraw(t)}}]),e}();ds.programId=new jn("Vote111111111111111111111111111111111111111"),ds.space=3731;var ps=new jn("Va1idator1nfo111111111111111111111111111111"),ms=Ot({name:Rt(),website:Bt(Rt()),details:Bt(Rt()),keybaseUsername:Bt(Rt())}),gs=function(){function e(t,r){(0,m.Z)(this,e),this.key=void 0,this.info=void 0,this.key=t,this.info=r}return(0,g.Z)(e,null,[{key:"fromConfigData",value:function(t){var r=(0,u.Z)(t);if(2!==ri(r))return null;for(var n=[],i=0;i<2;i++){var o=new jn(r.slice(0,Zn)),a=1===(r=r.slice(Zn)).slice(0,1)[0];r=r.slice(1),n.push({publicKey:o,isSigner:a})}if(n[0].publicKey.equals(ps)&&n[1].isSigner){var s=ei().decode(y.lW.from(r)),c=JSON.parse(s);return bt(c,ms),new e(n[1].publicKey,c)}return null}}]),e}(),ys=new jn("Vote111111111111111111111111111111111111111"),vs=nt.struct([$n("nodePubkey"),$n("authorizedWithdrawer"),nt.u8("commission"),nt.nu64(),nt.seq(nt.struct([nt.nu64("slot"),nt.u32("confirmationCount")]),nt.offset(nt.u32(),-8),"votes"),nt.u8("rootSlotValid"),nt.nu64("rootSlot"),nt.nu64(),nt.seq(nt.struct([nt.nu64("epoch"),$n("authorizedVoter")]),nt.offset(nt.u32(),-8),"authorizedVoters"),nt.struct([nt.seq(nt.struct([$n("authorizedPubkey"),nt.nu64("epochOfLastAuthorizedSwitch"),nt.nu64("targetEpoch")]),32,"buf"),nt.nu64("idx"),nt.u8("isEmpty")],"priorVoters"),nt.nu64(),nt.seq(nt.struct([nt.nu64("epoch"),nt.nu64("credits"),nt.nu64("prevCredits")]),nt.offset(nt.u32(),-8),"epochCredits"),nt.struct([nt.nu64("slot"),nt.nu64("timestamp")],"lastTimestamp")]),_s=function(){function e(t){(0,m.Z)(this,e),this.nodePubkey=void 0,this.authorizedWithdrawer=void 0,this.commission=void 0,this.rootSlot=void 0,this.votes=void 0,this.authorizedVoters=void 0,this.priorVoters=void 0,this.epochCredits=void 0,this.lastTimestamp=void 0,this.nodePubkey=t.nodePubkey,this.authorizedWithdrawer=t.authorizedWithdrawer,this.commission=t.commission,this.rootSlot=t.rootSlot,this.votes=t.votes,this.authorizedVoters=t.authorizedVoters,this.priorVoters=t.priorVoters,this.epochCredits=t.epochCredits,this.lastTimestamp=t.lastTimestamp}return(0,g.Z)(e,null,[{key:"fromAccountData",value:function(t){var r=vs.decode(Ln(t),4),n=r.rootSlot;return r.rootSlotValid||(n=null),new e({nodePubkey:new jn(r.nodePubkey),authorizedWithdrawer:new jn(r.authorizedWithdrawer),commission:r.commission,votes:r.votes,rootSlot:n,authorizedVoters:r.authorizedVoters.map(bs),priorVoters:ws(r.priorVoters),epochCredits:r.epochCredits,lastTimestamp:r.lastTimestamp})}}]),e}();function bs(e){var t=e.authorizedVoter;return{epoch:e.epoch,authorizedVoter:new jn(t)}}function xs(e){var t=e.authorizedPubkey,r=e.epochOfLastAuthorizedSwitch,n=e.targetEpoch;return{authorizedPubkey:new jn(t),epochOfLastAuthorizedSwitch:r,targetEpoch:n}}function ws(e){var t=e.buf,r=e.idx;return e.isEmpty?[]:[].concat((0,u.Z)(t.slice(r+1).map(xs)),(0,u.Z)(t.slice(0,r).map(xs)))}var ks={http:{devnet:"http://api.devnet.solana.com",testnet:"http://api.testnet.solana.com","mainnet-beta":"http://api.mainnet-beta.solana.com/"},https:{devnet:"https://api.devnet.solana.com",testnet:"https://api.testnet.solana.com","mainnet-beta":"https://api.mainnet-beta.solana.com/"}};function As(e,t){var r=!1===t?"http":"https";if(!e)return ks[r].devnet;var n=ks[r][e];if(!n)throw new Error("Unknown ".concat(r," cluster: ").concat(e));return n}function Es(e,t,r,n){return Ss.apply(this,arguments)}function Ss(){return Ss=(0,f.Z)((0,h.Z)().mark((function e(t,r,n,i){var o,a,s,u,c,l,f;return(0,h.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n&&Object.prototype.hasOwnProperty.call(n,"lastValidBlockHeight")||n&&Object.prototype.hasOwnProperty.call(n,"nonceValue")?(o=n,a=i):a=n,s=a&&{skipPreflight:a.skipPreflight,preflightCommitment:a.preflightCommitment||a.commitment,minContextSlot:a.minContextSlot},e.next=4,t.sendRawTransaction(r,s);case 4:return u=e.sent,c=a&&a.commitment,l=o?t.confirmTransaction(o,c):t.confirmTransaction(u,c),e.next=9,l;case 9:if(!(f=e.sent.value).err){e.next=12;break}throw new Error("Raw transaction ".concat(u," failed (").concat(JSON.stringify(f),")"));case 12:return e.abrupt("return",u);case 13:case"end":return e.stop()}}),e)}))),Ss.apply(this,arguments)}var Ts=1e9},9876:function(e,t,r){"use strict";var n=r(8443).lW,i=r(8416).default,o=r(7424).default,a=r(4704).default,s=r(6690).default,u=r(9728).default,c=r(1655).default,l=r(6389).default,h=r(3496).default,f=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),d=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),p=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},m=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.hasOwnProperty.call(e,r)&&f(t,e,r);return d(t,e),t},g=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.deserializeUnchecked=t.deserialize=t.serialize=t.BinaryReader=t.BinaryWriter=t.BorshError=t.baseDecode=t.baseEncode=void 0;var y=g(r(518)),v=g(r(7189)),_=m(r(9344)),b=new("function"!==typeof TextDecoder?_.TextDecoder:TextDecoder)("utf-8",{fatal:!0});t.baseEncode=function(e){return"string"===typeof e&&(e=n.from(e,"utf8")),v.default.encode(n.from(e))},t.baseDecode=function(e){return n.from(v.default.decode(e))};var x=1024,w=function(e){c(r,e);var t=l(r);function r(e){var n;return s(this,r),(n=t.call(this,e)).fieldPath=[],n.originalMessage=e,n}return u(r,[{key:"addToFieldPath",value:function(e){this.fieldPath.splice(0,0,e),this.message=this.originalMessage+": "+this.fieldPath.join(".")}}]),r}(h(Error));t.BorshError=w;var k=function(){function e(){s(this,e),this.buf=n.alloc(x),this.length=0}return u(e,[{key:"maybeResize",value:function(){this.buf.length<16+this.length&&(this.buf=n.concat([this.buf,n.alloc(x)]))}},{key:"writeU8",value:function(e){this.maybeResize(),this.buf.writeUInt8(e,this.length),this.length+=1}},{key:"writeU16",value:function(e){this.maybeResize(),this.buf.writeUInt16LE(e,this.length),this.length+=2}},{key:"writeU32",value:function(e){this.maybeResize(),this.buf.writeUInt32LE(e,this.length),this.length+=4}},{key:"writeU64",value:function(e){this.maybeResize(),this.writeBuffer(n.from(new y.default(e).toArray("le",8)))}},{key:"writeU128",value:function(e){this.maybeResize(),this.writeBuffer(n.from(new y.default(e).toArray("le",16)))}},{key:"writeU256",value:function(e){this.maybeResize(),this.writeBuffer(n.from(new y.default(e).toArray("le",32)))}},{key:"writeU512",value:function(e){this.maybeResize(),this.writeBuffer(n.from(new y.default(e).toArray("le",64)))}},{key:"writeBuffer",value:function(e){this.buf=n.concat([n.from(this.buf.subarray(0,this.length)),e,n.alloc(x)]),this.length+=e.length}},{key:"writeString",value:function(e){this.maybeResize();var t=n.from(e,"utf8");this.writeU32(t.length),this.writeBuffer(t)}},{key:"writeFixedArray",value:function(e){this.writeBuffer(n.from(e))}},{key:"writeArray",value:function(e,t){this.maybeResize(),this.writeU32(e.length);var r,n=a(e);try{for(n.s();!(r=n.n()).done;){var i=r.value;this.maybeResize(),t(i)}}catch(o){n.e(o)}finally{n.f()}}},{key:"toArray",value:function(){return this.buf.subarray(0,this.length)}}]),e}();function A(e,t,r){var n=r.value;r.value=function(){try{for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.apply(this,t)}catch(o){if(o instanceof RangeError){var i=o.code;if(["ERR_BUFFER_OUT_OF_BOUNDS","ERR_OUT_OF_RANGE"].indexOf(i)>=0)throw new w("Reached the end of buffer when deserializing")}throw o}}}t.BinaryWriter=k;var E=function(){function e(t){s(this,e),this.buf=t,this.offset=0}return u(e,[{key:"readU8",value:function(){var e=this.buf.readUInt8(this.offset);return this.offset+=1,e}},{key:"readU16",value:function(){var e=this.buf.readUInt16LE(this.offset);return this.offset+=2,e}},{key:"readU32",value:function(){var e=this.buf.readUInt32LE(this.offset);return this.offset+=4,e}},{key:"readU64",value:function(){var e=this.readBuffer(8);return new y.default(e,"le")}},{key:"readU128",value:function(){var e=this.readBuffer(16);return new y.default(e,"le")}},{key:"readU256",value:function(){var e=this.readBuffer(32);return new y.default(e,"le")}},{key:"readU512",value:function(){var e=this.readBuffer(64);return new y.default(e,"le")}},{key:"readBuffer",value:function(e){if(this.offset+e>this.buf.length)throw new w("Expected buffer length ".concat(e," isn't within bounds"));var t=this.buf.slice(this.offset,this.offset+e);return this.offset+=e,t}},{key:"readString",value:function(){var e=this.readU32(),t=this.readBuffer(e);try{return b.decode(t)}catch(r){throw new w("Error decoding UTF-8 string: ".concat(r))}}},{key:"readFixedArray",value:function(e){return new Uint8Array(this.readBuffer(e))}},{key:"readArray",value:function(e){for(var t=this.readU32(),r=Array(),n=0;n<t;++n)r.push(e());return r}}]),e}();function S(e){return e.charAt(0).toUpperCase()+e.slice(1)}function T(e,t,r,n,i){try{if("string"===typeof n)i["write".concat(S(n))](r);else if(n instanceof Array)if("number"===typeof n[0]){if(r.length!==n[0])throw new w("Expecting byte array of length ".concat(n[0],", but got ").concat(r.length," bytes"));i.writeFixedArray(r)}else if(2===n.length&&"number"===typeof n[1]){if(r.length!==n[1])throw new w("Expecting byte array of length ".concat(n[1],", but got ").concat(r.length," bytes"));for(var o=0;o<n[1];o++)T(e,null,r[o],n[0],i)}else i.writeArray(r,(function(r){T(e,t,r,n[0],i)}));else if(void 0!==n.kind)switch(n.kind){case"option":null===r||void 0===r?i.writeU8(0):(i.writeU8(1),T(e,t,r,n.type,i));break;case"map":i.writeU32(r.size),r.forEach((function(r,o){T(e,t,o,n.key,i),T(e,t,r,n.value,i)}));break;default:throw new w("FieldType ".concat(n," unrecognized"))}else M(e,r,i)}catch(a){throw a instanceof w&&a.addToFieldPath(t),a}}function M(e,t,r){if("function"!==typeof t.borshSerialize){var n=e.get(t.constructor);if(!n)throw new w("Class ".concat(t.constructor.name," is missing in schema"));if("struct"===n.kind)n.fields.map((function(n){var i=o(n,2),a=i[0],s=i[1];T(e,a,t[a],s,r)}));else{if("enum"!==n.kind)throw new w("Unexpected schema kind: ".concat(n.kind," for ").concat(t.constructor.name));for(var i=t[n.field],a=0;a<n.values.length;++a){var s=o(n.values[a],2),u=s[0],c=s[1];if(u===i){r.writeU8(a),T(e,u,t[u],c,r);break}}}}else t.borshSerialize(r)}function I(e,t,r,n){try{if("string"===typeof r)return n["read".concat(S(r))]();if(r instanceof Array){if("number"===typeof r[0])return n.readFixedArray(r[0]);if("number"===typeof r[1]){for(var i=[],o=0;o<r[1];o++)i.push(I(e,null,r[0],n));return i}return n.readArray((function(){return I(e,t,r[0],n)}))}if("option"===r.kind)return n.readU8()?I(e,t,r.type,n):void 0;if("map"===r.kind){for(var a=new Map,s=n.readU32(),u=0;u<s;u++){var c=I(e,t,r.key,n),l=I(e,t,r.value,n);a.set(c,l)}return a}return P(e,r,n)}catch(h){throw h instanceof w&&h.addToFieldPath(t),h}}function P(e,t,r){if("function"===typeof t.borshDeserialize)return t.borshDeserialize(r);var n=e.get(t);if(!n)throw new w("Class ".concat(t.name," is missing in schema"));if("struct"===n.kind){var s,u={},c=a(e.get(t).fields);try{for(c.s();!(s=c.n()).done;){var l=o(s.value,2),h=l[0],f=l[1];u[h]=I(e,h,f,r)}}catch(y){c.e(y)}finally{c.f()}return new t(u)}if("enum"===n.kind){var d=r.readU8();if(d>=n.values.length)throw new w("Enum index: ".concat(d," is out of range"));var p=o(n.values[d],2),m=p[0],g=I(e,m,p[1],r);return new t(i({},m,g))}throw new w("Unexpected schema kind: ".concat(n.kind," for ").concat(t.constructor.name))}p([A],E.prototype,"readU8",null),p([A],E.prototype,"readU16",null),p([A],E.prototype,"readU32",null),p([A],E.prototype,"readU64",null),p([A],E.prototype,"readU128",null),p([A],E.prototype,"readU256",null),p([A],E.prototype,"readU512",null),p([A],E.prototype,"readString",null),p([A],E.prototype,"readFixedArray",null),p([A],E.prototype,"readArray",null),t.BinaryReader=E,t.serialize=function(e,t){var r=new(arguments.length>2&&void 0!==arguments[2]?arguments[2]:k);return M(e,t,r),r.toArray()},t.deserialize=function(e,t,r){var n=new(arguments.length>3&&void 0!==arguments[3]?arguments[3]:E)(r),i=P(e,t,n);if(n.offset<r.length)throw new w("Unexpected ".concat(r.length-n.offset," bytes after deserialized data"));return i},t.deserializeUnchecked=function(e,t,r){return P(e,t,new(arguments.length>3&&void 0!==arguments[3]?arguments[3]:E)(r))}},7189:function(e,t,r){var n=r(2307);e.exports=n("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz")},8443:function(e,t,r){"use strict";var n=r(6690).default,i=r(9728).default,o=r(6115).default,a=r(1655).default,s=r(6389).default,u=r(2009),c=r(4038),l="function"===typeof Symbol&&"function"===typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.lW=d,t.h2=50;var h=2147483647;function f(e){if(e>h)throw new RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return Object.setPrototypeOf(t,d.prototype),t}function d(e,t,r){if("number"===typeof e){if("string"===typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return g(e)}return p(e,t,r)}function p(e,t,r){if("string"===typeof e)return function(e,t){"string"===typeof t&&""!==t||(t="utf8");if(!d.isEncoding(t))throw new TypeError("Unknown encoding: "+t);var r=0|b(e,t),n=f(r),i=n.write(e,t);i!==r&&(n=n.slice(0,i));return n}(e,t);if(ArrayBuffer.isView(e))return function(e){if(ee(e,Uint8Array)){var t=new Uint8Array(e);return v(t.buffer,t.byteOffset,t.byteLength)}return y(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(ee(e,ArrayBuffer)||e&&ee(e.buffer,ArrayBuffer))return v(e,t,r);if("undefined"!==typeof SharedArrayBuffer&&(ee(e,SharedArrayBuffer)||e&&ee(e.buffer,SharedArrayBuffer)))return v(e,t,r);if("number"===typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return d.from(n,t,r);var i=function(e){if(d.isBuffer(e)){var t=0|_(e.length),r=f(t);return 0===r.length||e.copy(r,0,0,t),r}if(void 0!==e.length)return"number"!==typeof e.length||te(e.length)?f(0):y(e);if("Buffer"===e.type&&Array.isArray(e.data))return y(e.data)}(e);if(i)return i;if("undefined"!==typeof Symbol&&null!=Symbol.toPrimitive&&"function"===typeof e[Symbol.toPrimitive])return d.from(e[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function m(e){if("number"!==typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function g(e){return m(e),f(e<0?0:0|_(e))}function y(e){for(var t=e.length<0?0:0|_(e.length),r=f(t),n=0;n<t;n+=1)r[n]=255&e[n];return r}function v(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');var n;return n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),Object.setPrototypeOf(n,d.prototype),n}function _(e){if(e>=h)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+h.toString(16)+" bytes");return 0|e}function b(e,t){if(d.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||ee(e,ArrayBuffer))return e.byteLength;if("string"!==typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var r=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return Q(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return $(e).length;default:if(i)return n?-1:Q(e).length;t=(""+t).toLowerCase(),i=!0}}function x(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return L(this,t,r);case"utf8":case"utf-8":return C(this,t,r);case"ascii":return D(this,t,r);case"latin1":case"binary":return R(this,t,r);case"base64":return P(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function w(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function k(e,t,r,n,i){if(0===e.length)return-1;if("string"===typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),te(r=+r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"===typeof t&&(t=d.from(t,n)),d.isBuffer(t))return 0===t.length?-1:A(e,t,r,n,i);if("number"===typeof t)return t&=255,"function"===typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):A(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function A(e,t,r,n,i){var o,a=1,s=e.length,u=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;a=2,s/=2,u/=2,r/=2}function c(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(i){var l=-1;for(o=r;o<s;o++)if(c(e,o)===c(t,-1===l?0:o-l)){if(-1===l&&(l=o),o-l+1===u)return l*a}else-1!==l&&(o-=o-l),l=-1}else for(r+u>s&&(r=s-u),o=r;o>=0;o--){for(var h=!0,f=0;f<u;f++)if(c(e,o+f)!==c(t,f)){h=!1;break}if(h)return o}return-1}function E(e,t,r,n){r=Number(r)||0;var i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;var o,a=t.length;for(n>a/2&&(n=a/2),o=0;o<n;++o){var s=parseInt(t.substr(2*o,2),16);if(te(s))return o;e[r+o]=s}return o}function S(e,t,r,n){return J(Q(t,e.length-r),e,r,n)}function T(e,t,r,n){return J(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function M(e,t,r,n){return J($(t),e,r,n)}function I(e,t,r,n){return J(function(e,t){for(var r,n,i,o=[],a=0;a<e.length&&!((t-=2)<0);++a)n=(r=e.charCodeAt(a))>>8,i=r%256,o.push(i),o.push(n);return o}(t,e.length-r),e,r,n)}function P(e,t,r){return 0===t&&r===e.length?u.fromByteArray(e):u.fromByteArray(e.slice(t,r))}function C(e,t,r){r=Math.min(e.length,r);for(var n=[],i=t;i<r;){var o=e[i],a=null,s=o>239?4:o>223?3:o>191?2:1;if(i+s<=r){var u=void 0,c=void 0,l=void 0,h=void 0;switch(s){case 1:o<128&&(a=o);break;case 2:128===(192&(u=e[i+1]))&&(h=(31&o)<<6|63&u)>127&&(a=h);break;case 3:u=e[i+1],c=e[i+2],128===(192&u)&&128===(192&c)&&(h=(15&o)<<12|(63&u)<<6|63&c)>2047&&(h<55296||h>57343)&&(a=h);break;case 4:u=e[i+1],c=e[i+2],l=e[i+3],128===(192&u)&&128===(192&c)&&128===(192&l)&&(h=(15&o)<<18|(63&u)<<12|(63&c)<<6|63&l)>65535&&h<1114112&&(a=h)}}null===a?(a=65533,s=1):a>65535&&(a-=65536,n.push(a>>>10&1023|55296),a=56320|1023&a),n.push(a),i+=s}return function(e){var t=e.length;if(t<=B)return String.fromCharCode.apply(String,e);var r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=B));return r}(n)}d.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(r){return!1}}(),d.TYPED_ARRAY_SUPPORT||"undefined"===typeof console||"function"!==typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(d.prototype,"parent",{enumerable:!0,get:function(){if(d.isBuffer(this))return this.buffer}}),Object.defineProperty(d.prototype,"offset",{enumerable:!0,get:function(){if(d.isBuffer(this))return this.byteOffset}}),d.poolSize=8192,d.from=function(e,t,r){return p(e,t,r)},Object.setPrototypeOf(d.prototype,Uint8Array.prototype),Object.setPrototypeOf(d,Uint8Array),d.alloc=function(e,t,r){return function(e,t,r){return m(e),e<=0?f(e):void 0!==t?"string"===typeof r?f(e).fill(t,r):f(e).fill(t):f(e)}(e,t,r)},d.allocUnsafe=function(e){return g(e)},d.allocUnsafeSlow=function(e){return g(e)},d.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==d.prototype},d.compare=function(e,t){if(ee(e,Uint8Array)&&(e=d.from(e,e.offset,e.byteLength)),ee(t,Uint8Array)&&(t=d.from(t,t.offset,t.byteLength)),!d.isBuffer(e)||!d.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var r=e.length,n=t.length,i=0,o=Math.min(r,n);i<o;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},d.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},d.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return d.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=d.allocUnsafe(t),i=0;for(r=0;r<e.length;++r){var o=e[r];if(ee(o,Uint8Array))i+o.length>n.length?(d.isBuffer(o)||(o=d.from(o)),o.copy(n,i)):Uint8Array.prototype.set.call(n,o,i);else{if(!d.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(n,i)}i+=o.length}return n},d.byteLength=b,d.prototype._isBuffer=!0,d.prototype.swap16=function(){var e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)w(this,t,t+1);return this},d.prototype.swap32=function(){var e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)w(this,t,t+3),w(this,t+1,t+2);return this},d.prototype.swap64=function(){var e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)w(this,t,t+7),w(this,t+1,t+6),w(this,t+2,t+5),w(this,t+3,t+4);return this},d.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?C(this,0,e):x.apply(this,arguments)},d.prototype.toLocaleString=d.prototype.toString,d.prototype.equals=function(e){if(!d.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===d.compare(this,e)},d.prototype.inspect=function(){var e="",r=t.h2;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"},l&&(d.prototype[l]=d.prototype.inspect),d.prototype.compare=function(e,t,r,n,i){if(ee(e,Uint8Array)&&(e=d.from(e,e.offset,e.byteLength)),!d.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(this===e)return 0;for(var o=(i>>>=0)-(n>>>=0),a=(r>>>=0)-(t>>>=0),s=Math.min(o,a),u=this.slice(n,i),c=e.slice(t,r),l=0;l<s;++l)if(u[l]!==c[l]){o=u[l],a=c[l];break}return o<a?-1:a<o?1:0},d.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},d.prototype.indexOf=function(e,t,r){return k(this,e,t,r,!0)},d.prototype.lastIndexOf=function(e,t,r){return k(this,e,t,r,!1)},d.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"===typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return E(this,e,t,r);case"utf8":case"utf-8":return S(this,e,t,r);case"ascii":case"latin1":case"binary":return T(this,e,t,r);case"base64":return M(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,e,t,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},d.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var B=4096;function D(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function R(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function L(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var i="",o=t;o<r;++o)i+=re[e[o]];return i}function O(e,t,r){for(var n=e.slice(t,r),i="",o=0;o<n.length-1;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function z(e,t,r){if(e%1!==0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function N(e,t,r,n,i,o){if(!d.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function U(e,t,r,n,i){H(t,n,i,e,r,7);var o=Number(t&BigInt(4294967295));e[r++]=o,o>>=8,e[r++]=o,o>>=8,e[r++]=o,o>>=8,e[r++]=o;var a=Number(t>>BigInt(32)&BigInt(4294967295));return e[r++]=a,a>>=8,e[r++]=a,a>>=8,e[r++]=a,a>>=8,e[r++]=a,r}function Z(e,t,r,n,i){H(t,n,i,e,r,7);var o=Number(t&BigInt(4294967295));e[r+7]=o,o>>=8,e[r+6]=o,o>>=8,e[r+5]=o,o>>=8,e[r+4]=o;var a=Number(t>>BigInt(32)&BigInt(4294967295));return e[r+3]=a,a>>=8,e[r+2]=a,a>>=8,e[r+1]=a,a>>=8,e[r]=a,r+8}function F(e,t,r,n,i,o){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function j(e,t,r,n,i){return t=+t,r>>>=0,i||F(e,0,r,4),c.write(e,t,r,n,23,4),r+4}function V(e,t,r,n,i){return t=+t,r>>>=0,i||F(e,0,r,8),c.write(e,t,r,n,52,8),r+8}d.prototype.slice=function(e,t){var r=this.length;(e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);var n=this.subarray(e,t);return Object.setPrototypeOf(n,d.prototype),n},d.prototype.readUintLE=d.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||z(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n},d.prototype.readUintBE=d.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||z(e,t,this.length);for(var n=this[e+--t],i=1;t>0&&(i*=256);)n+=this[e+--t]*i;return n},d.prototype.readUint8=d.prototype.readUInt8=function(e,t){return e>>>=0,t||z(e,1,this.length),this[e]},d.prototype.readUint16LE=d.prototype.readUInt16LE=function(e,t){return e>>>=0,t||z(e,2,this.length),this[e]|this[e+1]<<8},d.prototype.readUint16BE=d.prototype.readUInt16BE=function(e,t){return e>>>=0,t||z(e,2,this.length),this[e]<<8|this[e+1]},d.prototype.readUint32LE=d.prototype.readUInt32LE=function(e,t){return e>>>=0,t||z(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},d.prototype.readUint32BE=d.prototype.readUInt32BE=function(e,t){return e>>>=0,t||z(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},d.prototype.readBigUInt64LE=ne((function(e){q(e>>>=0,"offset");var t=this[e],r=this[e+7];void 0!==t&&void 0!==r||Y(e,this.length-8);var n=t+this[++e]*Math.pow(2,8)+this[++e]*Math.pow(2,16)+this[++e]*Math.pow(2,24),i=this[++e]+this[++e]*Math.pow(2,8)+this[++e]*Math.pow(2,16)+r*Math.pow(2,24);return BigInt(n)+(BigInt(i)<<BigInt(32))})),d.prototype.readBigUInt64BE=ne((function(e){q(e>>>=0,"offset");var t=this[e],r=this[e+7];void 0!==t&&void 0!==r||Y(e,this.length-8);var n=t*Math.pow(2,24)+this[++e]*Math.pow(2,16)+this[++e]*Math.pow(2,8)+this[++e],i=this[++e]*Math.pow(2,24)+this[++e]*Math.pow(2,16)+this[++e]*Math.pow(2,8)+r;return(BigInt(n)<<BigInt(32))+BigInt(i)})),d.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||z(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*t)),n},d.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||z(e,t,this.length);for(var n=t,i=1,o=this[e+--n];n>0&&(i*=256);)o+=this[e+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},d.prototype.readInt8=function(e,t){return e>>>=0,t||z(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},d.prototype.readInt16LE=function(e,t){e>>>=0,t||z(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},d.prototype.readInt16BE=function(e,t){e>>>=0,t||z(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},d.prototype.readInt32LE=function(e,t){return e>>>=0,t||z(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},d.prototype.readInt32BE=function(e,t){return e>>>=0,t||z(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},d.prototype.readBigInt64LE=ne((function(e){q(e>>>=0,"offset");var t=this[e],r=this[e+7];void 0!==t&&void 0!==r||Y(e,this.length-8);var n=this[e+4]+this[e+5]*Math.pow(2,8)+this[e+6]*Math.pow(2,16)+(r<<24);return(BigInt(n)<<BigInt(32))+BigInt(t+this[++e]*Math.pow(2,8)+this[++e]*Math.pow(2,16)+this[++e]*Math.pow(2,24))})),d.prototype.readBigInt64BE=ne((function(e){q(e>>>=0,"offset");var t=this[e],r=this[e+7];void 0!==t&&void 0!==r||Y(e,this.length-8);var n=(t<<24)+this[++e]*Math.pow(2,16)+this[++e]*Math.pow(2,8)+this[++e];return(BigInt(n)<<BigInt(32))+BigInt(this[++e]*Math.pow(2,24)+this[++e]*Math.pow(2,16)+this[++e]*Math.pow(2,8)+r)})),d.prototype.readFloatLE=function(e,t){return e>>>=0,t||z(e,4,this.length),c.read(this,e,!0,23,4)},d.prototype.readFloatBE=function(e,t){return e>>>=0,t||z(e,4,this.length),c.read(this,e,!1,23,4)},d.prototype.readDoubleLE=function(e,t){return e>>>=0,t||z(e,8,this.length),c.read(this,e,!0,52,8)},d.prototype.readDoubleBE=function(e,t){return e>>>=0,t||z(e,8,this.length),c.read(this,e,!1,52,8)},d.prototype.writeUintLE=d.prototype.writeUIntLE=function(e,t,r,n){(e=+e,t>>>=0,r>>>=0,n)||N(this,e,t,r,Math.pow(2,8*r)-1,0);var i=1,o=0;for(this[t]=255&e;++o<r&&(i*=256);)this[t+o]=e/i&255;return t+r},d.prototype.writeUintBE=d.prototype.writeUIntBE=function(e,t,r,n){(e=+e,t>>>=0,r>>>=0,n)||N(this,e,t,r,Math.pow(2,8*r)-1,0);var i=r-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+r},d.prototype.writeUint8=d.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,1,255,0),this[t]=255&e,t+1},d.prototype.writeUint16LE=d.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},d.prototype.writeUint16BE=d.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},d.prototype.writeUint32LE=d.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},d.prototype.writeUint32BE=d.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},d.prototype.writeBigUInt64LE=ne((function(e){return U(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,BigInt(0),BigInt("0xffffffffffffffff"))})),d.prototype.writeBigUInt64BE=ne((function(e){return Z(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,BigInt(0),BigInt("0xffffffffffffffff"))})),d.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var i=Math.pow(2,8*r-1);N(this,e,t,r,i-1,-i)}var o=0,a=1,s=0;for(this[t]=255&e;++o<r&&(a*=256);)e<0&&0===s&&0!==this[t+o-1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+r},d.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var i=Math.pow(2,8*r-1);N(this,e,t,r,i-1,-i)}var o=r-1,a=1,s=0;for(this[t+o]=255&e;--o>=0&&(a*=256);)e<0&&0===s&&0!==this[t+o+1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+r},d.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},d.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},d.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},d.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},d.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},d.prototype.writeBigInt64LE=ne((function(e){return U(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),d.prototype.writeBigInt64BE=ne((function(e){return Z(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),d.prototype.writeFloatLE=function(e,t,r){return j(this,e,t,!0,r)},d.prototype.writeFloatBE=function(e,t,r){return j(this,e,t,!1,r)},d.prototype.writeDoubleLE=function(e,t,r){return V(this,e,t,!0,r)},d.prototype.writeDoubleBE=function(e,t,r){return V(this,e,t,!1,r)},d.prototype.copy=function(e,t,r,n){if(!d.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var i=n-r;return this===e&&"function"===typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,r,n):Uint8Array.prototype.set.call(e,this.subarray(r,n),t),i},d.prototype.fill=function(e,t,r,n){if("string"===typeof e){if("string"===typeof t?(n=t,t=0,r=this.length):"string"===typeof r&&(n=r,r=this.length),void 0!==n&&"string"!==typeof n)throw new TypeError("encoding must be a string");if("string"===typeof n&&!d.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===e.length){var i=e.charCodeAt(0);("utf8"===n&&i<128||"latin1"===n)&&(e=i)}}else"number"===typeof e?e&=255:"boolean"===typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var o;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"===typeof e)for(o=t;o<r;++o)this[o]=e;else{var a=d.isBuffer(e)?e:d.from(e,n),s=a.length;if(0===s)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(o=0;o<r-t;++o)this[o+t]=a[o%s]}return this};var W={};function K(e,t,r){W[e]=function(r){a(c,r);var u=s(c);function c(){var r;return n(this,c),r=u.call(this),Object.defineProperty(o(r),"message",{value:t.apply(o(r),arguments),writable:!0,configurable:!0}),r.name="".concat(r.name," [").concat(e,"]"),r.stack,delete r.name,r}return i(c,[{key:"code",get:function(){return e},set:function(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}},{key:"toString",value:function(){return"".concat(this.name," [").concat(e,"]: ").concat(this.message)}}]),c}(r)}function G(e){for(var t="",r=e.length,n="-"===e[0]?1:0;r>=n+4;r-=3)t="_".concat(e.slice(r-3,r)).concat(t);return"".concat(e.slice(0,r)).concat(t)}function H(e,t,r,n,i,o){if(e>r||e<t){var a,s="bigint"===typeof t?"n":"";throw a=o>3?0===t||t===BigInt(0)?">= 0".concat(s," and < 2").concat(s," ** ").concat(8*(o+1)).concat(s):">= -(2".concat(s," ** ").concat(8*(o+1)-1).concat(s,") and < 2 ** ")+"".concat(8*(o+1)-1).concat(s):">= ".concat(t).concat(s," and <= ").concat(r).concat(s),new W.ERR_OUT_OF_RANGE("value",a,e)}!function(e,t,r){q(t,"offset"),void 0!==e[t]&&void 0!==e[t+r]||Y(t,e.length-(r+1))}(n,i,o)}function q(e,t){if("number"!==typeof e)throw new W.ERR_INVALID_ARG_TYPE(t,"number",e)}function Y(e,t,r){if(Math.floor(e)!==e)throw q(e,r),new W.ERR_OUT_OF_RANGE(r||"offset","an integer",e);if(t<0)throw new W.ERR_BUFFER_OUT_OF_BOUNDS;throw new W.ERR_OUT_OF_RANGE(r||"offset",">= ".concat(r?1:0," and <= ").concat(t),e)}K("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?"".concat(e," is outside of buffer bounds"):"Attempt to access memory outside buffer bounds"}),RangeError),K("ERR_INVALID_ARG_TYPE",(function(e,t){return'The "'.concat(e,'" argument must be of type number. Received type ').concat(typeof t)}),TypeError),K("ERR_OUT_OF_RANGE",(function(e,t,r){var n='The value of "'.concat(e,'" is out of range.'),i=r;return Number.isInteger(r)&&Math.abs(r)>Math.pow(2,32)?i=G(String(r)):"bigint"===typeof r&&(i=String(r),(r>Math.pow(BigInt(2),BigInt(32))||r<-Math.pow(BigInt(2),BigInt(32)))&&(i=G(i)),i+="n"),n+=" It must be ".concat(t,". Received ").concat(i)}),RangeError);var X=/[^+/0-9A-Za-z-_]/g;function Q(e,t){var r;t=t||1/0;for(var n=e.length,i=null,o=[],a=0;a<n;++a){if((r=e.charCodeAt(a))>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===n){(t-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function $(e){return u.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(X,"")).length<2)return"";for(;e.length%4!==0;)e+="=";return e}(e))}function J(e,t,r,n){var i;for(i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function ee(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function te(e){return e!==e}var re=function(){for(var e="0123456789abcdef",t=new Array(256),r=0;r<16;++r)for(var n=16*r,i=0;i<16;++i)t[n+i]=e[r]+e[i];return t}();function ne(e){return"undefined"===typeof BigInt?ie:e}function ie(){throw new Error("BigInt not supported")}},6807:function(e,t,r){"use strict";r.r(t),t.default={}},169:function(e,t){"use strict"},7794:function(e,t,r){"use strict";var n=r(6690).default,i=r(9728).default,o=r(8416).default;Object.defineProperty(t,"__esModule",{value:!0});var a=r(7144),s=function(){function e(){n(this,e),o(this,"BigNum",void 0),this.BigNum=function(e,t){return new(a.BigNumber.clone({DECIMAL_PLACES:t}))(e)}}return i(e,[{key:"winstonToAr",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.formatted,n=void 0!==r&&r,i=t.decimals,o=void 0===i?12:i,a=(t.trim,this.stringToBigNum(e,o).shiftedBy(-12));return n?a.toFormat(o):a.toFixed(o)}},{key:"arToWinston",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).formatted,r=void 0!==t&&t,n=this.stringToBigNum(e).shiftedBy(12);return r?n.toFormat():n.toFixed(0)}},{key:"compare",value:function(e,t){var r=this.stringToBigNum(e),n=this.stringToBigNum(t);return r.comparedTo(n)}},{key:"isEqual",value:function(e,t){return 0===this.compare(e,t)}},{key:"isLessThan",value:function(e,t){var r=this.stringToBigNum(e),n=this.stringToBigNum(t);return r.isLessThan(n)}},{key:"isGreaterThan",value:function(e,t){var r=this.stringToBigNum(e),n=this.stringToBigNum(t);return r.isGreaterThan(n)}},{key:"add",value:function(e,t){var r=this.stringToBigNum(e);this.stringToBigNum(t);return r.plus(t).toFixed(0)}},{key:"sub",value:function(e,t){var r=this.stringToBigNum(e);this.stringToBigNum(t);return r.minus(t).toFixed(0)}},{key:"stringToBigNum",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12;return this.BigNum(e,t)}}]),e}();t.default=s},2613:function(e,t,r){"use strict";var n=r(7061).default,i=r(7156).default,o=r(6690).default,a=r(9728).default,s=r(8416).default;Object.defineProperty(t,"__esModule",{value:!0});var u=r(8470);r(6807);var c=function(){function e(t,r){o(this,e),s(this,"api",void 0),s(this,"network",void 0),this.api=t,this.network=r}return a(e,[{key:"get",value:function(){var t=i(n().mark((function t(r){var i;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.api.get("".concat(e.ENDPOINT).concat(r));case 2:if(200!==(i=t.sent).status){t.next=7;break}return t.abrupt("return",i.data);case 7:if(404!==i.status){t.next=11;break}throw new u.default("BLOCK_NOT_FOUND");case 11:throw new Error("Error while loading block data: ".concat(i));case 12:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"getCurrent",value:function(){var e=i(n().mark((function e(){var t,r;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.network.getInfo();case 2:return t=e.sent,r=t.current,e.next=6,this.get(r);case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();s(c,"ENDPOINT","block/hash/"),t.default=c},1979:function(e,t,r){"use strict";var n=r(7061).default,i=r(7156).default,o=r(6690).default,a=r(9728).default,s=r(8416).default;Object.defineProperty(t,"__esModule",{value:!0});var u=r(8470),c=r(3568),l=function(){function e(t){o(this,e),s(this,"api",void 0),this.api=t}return a(e,[{key:"getTransactionOffset",value:function(){var e=i(n().mark((function e(t){var r;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.api.get("tx/".concat(t,"/offset"));case 2:if(200!==(r=e.sent).status){e.next=5;break}return e.abrupt("return",r.data);case 5:throw new Error("Unable to get transaction offset: ".concat((0,u.getError)(r)));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getChunk",value:function(){var e=i(n().mark((function e(t){var r;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.api.get("chunk/".concat(t));case 2:if(200!==(r=e.sent).status){e.next=5;break}return e.abrupt("return",r.data);case 5:throw new Error("Unable to get chunk: ".concat((0,u.getError)(r)));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getChunkData",value:function(){var e=i(n().mark((function e(t){var r,i;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getChunk(t);case 2:return r=e.sent,i=c.b64UrlToBuffer(r.chunk),e.abrupt("return",i);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"firstChunkOffset",value:function(e){return parseInt(e.offset)-parseInt(e.size)+1}},{key:"downloadChunkedData",value:function(){var e=i(n().mark((function e(t){var r,i,o,a,s,u,c;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getTransactionOffset(t);case 2:r=e.sent,i=parseInt(r.size),o=parseInt(r.offset),a=o-i+1,s=new Uint8Array(i),u=0;case 8:if(!(u<i)){e.next=29;break}return this.api.config.logging&&console.log("[chunk] ".concat(u,"/").concat(i)),c=void 0,e.prev=11,e.next=14,this.getChunkData(a+u);case 14:c=e.sent,e.next=21;break;case 17:e.prev=17,e.t0=e.catch(11),console.error("[chunk] Failed to fetch chunk at offset ".concat(a+u)),console.error("[chunk] This could indicate that the chunk wasn't uploaded or hasn't yet seeded properly to a particular gateway/node");case 21:if(!c){e.next=26;break}s.set(c,u),u+=c.length,e.next=27;break;case 26:throw new Error("Couldn't complete data download at ".concat(u,"/").concat(i));case 27:e.next=8;break;case 29:return e.abrupt("return",s);case 30:case"end":return e.stop()}}),e,this,[[11,17]])})));return function(t){return e.apply(this,arguments)}}()}]),e}();t.default=l},9839:function(e,t,r){"use strict";var n=r(7061).default,i=r(7156).default,o=r(6690).default,a=r(9728).default,s=r(8416).default;Object.defineProperty(t,"__esModule",{value:!0});var u=r(7794),c=r(1955),l=r(9151),h=r(5739),f=r(8164),d=r(7073),p=r(3872),m=r(3568),g=r(8165),y=r(1979),v=r(2613),_=function(){function e(t){o(this,e),s(this,"api",void 0),s(this,"wallets",void 0),s(this,"transactions",void 0),s(this,"network",void 0),s(this,"blocks",void 0),s(this,"ar",void 0),s(this,"silo",void 0),s(this,"chunks",void 0),this.api=new c.default(t),this.wallets=new d.default(this.api,e.crypto),this.chunks=new y.default(this.api),this.transactions=new f.default(this.api,e.crypto,this.chunks),this.silo=new g.default(this.api,this.crypto,this.transactions),this.network=new h.default(this.api),this.blocks=new v.default(this.api,this.network),this.ar=new u.default}return a(e,[{key:"crypto",get:function(){return e.crypto}},{key:"utils",get:function(){return e.utils}},{key:"getConfig",value:function(){return{api:this.api.getConfig(),crypto:null}}},{key:"createTransaction",value:function(){var e=i(n().mark((function e(t,r){var i,o,a;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i={},Object.assign(i,t),t.data||t.target&&t.quantity){e.next=4;break}throw new Error("A new Arweave transaction must have a 'data' value, or 'target' and 'quantity' values.");case 4:if(void 0==t.owner&&r&&"use_wallet"!==r&&(i.owner=r.n),void 0!=t.last_tx){e.next=9;break}return e.next=8,this.transactions.getTransactionAnchor();case 8:i.last_tx=e.sent;case 9:if("string"===typeof t.data&&(t.data=m.stringToBuffer(t.data)),t.data instanceof ArrayBuffer&&(t.data=new Uint8Array(t.data)),!t.data||t.data instanceof Uint8Array){e.next=13;break}throw new Error("Expected data to be a string, Uint8Array or ArrayBuffer");case 13:if(void 0!=t.reward){e.next=18;break}return o=t.data?t.data.byteLength:0,e.next=17,this.transactions.getPrice(o,i.target);case 17:i.reward=e.sent;case 18:return i.data_root="",i.data_size=t.data?t.data.byteLength.toString():"0",i.data=t.data||new Uint8Array(0),a=new p.default(i),e.next=24,a.getSignatureData();case 24:return e.abrupt("return",a);case 25:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"createSiloTransaction",value:function(){var e=i(n().mark((function e(t,r,i){var o,a,s,u,c;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o={},Object.assign(o,t),t.data){e.next=4;break}throw new Error("Silo transactions must have a 'data' value");case 4:if(i){e.next=6;break}throw new Error("No Silo URI specified.");case 6:if(!t.target&&!t.quantity){e.next=8;break}throw new Error("Silo transactions can only be used for storing data, sending AR to other wallets isn't supported.");case 8:if(void 0!=t.owner){e.next=12;break}if(r&&r.n){e.next=11;break}throw new Error("A new Arweave transaction must either have an 'owner' attribute, or you must provide the jwk parameter.");case 11:o.owner=r.n;case 12:if(void 0!=t.last_tx){e.next=16;break}return e.next=15,this.transactions.getTransactionAnchor();case 15:o.last_tx=e.sent;case 16:return e.next=18,this.silo.parseUri(i);case 18:if(a=e.sent,"string"!=typeof t.data){e.next=27;break}return e.next=22,this.crypto.encrypt(m.stringToBuffer(t.data),a.getEncryptionKey());case 22:return s=e.sent,e.next=25,this.transactions.getPrice(s.byteLength);case 25:o.reward=e.sent,o.data=m.bufferTob64Url(s);case 27:if(!(t.data instanceof Uint8Array)){e.next=35;break}return e.next=30,this.crypto.encrypt(t.data,a.getEncryptionKey());case 30:return u=e.sent,e.next=33,this.transactions.getPrice(u.byteLength);case 33:o.reward=e.sent,o.data=m.bufferTob64Url(u);case 35:return(c=new p.default(o)).addTag("Silo-Name",a.getAccessKey()),c.addTag("Silo-Version","0.1.0"),e.abrupt("return",c);case 39:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"arql",value:function(e){return this.api.post("/arql",e).then((function(e){return e.data||[]}))}}]),e}();s(_,"init",void 0),s(_,"crypto",new l.default),s(_,"utils",m),t.default=_},7567:function(e,t,r){"use strict";var n=r(2122).default,i=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||i(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0});var a=r(9839),s=r(8963);a.default.init=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("object"!==typeof location||!location.protocol||!location.hostname)return new a.default(n(n({},e),{host:"arweave.net",port:443,protocol:"https"}));var t=location.protocol.replace(":",""),r=location.hostname,i=location.port?parseInt(location.port):"https"==t?443:80,o=(0,s.getDefaultConfig)(t,r),u=e.protocol||o.protocol,c=e.host||o.host,l=e.port||o.port||i;return new a.default(n(n({},e),{},{host:c,protocol:u,port:l}))},"object"===typeof globalThis?globalThis.Arweave=a.default:"object"===typeof self&&(self.Arweave=a.default),o(r(9839),t),t.default=a.default},1955:function(e,t,r){"use strict";var n=r(7061).default,i=r(2122).default,o=r(7156).default,a=r(6690).default,s=r(9728).default,u=r(8416).default,c=r(6737).default,l=r(8186).default;Object.defineProperty(t,"__esModule",{value:!0});var h=function(){function e(t){a(this,e),u(this,"METHOD_GET","GET"),u(this,"METHOD_POST","POST"),u(this,"config",void 0),this.applyConfig(t)}return s(e,[{key:"applyConfig",value:function(e){this.config=this.mergeDefaults(e)}},{key:"getConfig",value:function(){return this.config}},{key:"mergeDefaults",value:function(e){var t=e.protocol||"http",r=e.port||("https"===t?443:80);return{host:e.host||"127.0.0.1",protocol:t,port:r,timeout:e.timeout||2e4,logging:e.logging||!1,logger:e.logger||console.log,network:e.network}}},{key:"get",value:function(){var e=o(n().mark((function e(t,r){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.request(t,i(i({},r),{},{method:this.METHOD_GET}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"post",value:function(){var e=o(n().mark((function e(t,r,o){var a,s;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=new Headers((null===o||void 0===o?void 0:o.headers)||{}),null!==(a=s.get("content-type"))&&void 0!==a&&a.includes("application/json")||s.append("content-type","application/json"),s.append("accept","application/json, text/plain, */*"),e.next=5,this.request(t,i(i({},o),{},{method:this.METHOD_POST,body:"string"!==typeof r?JSON.stringify(r):r,headers:s}));case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"request",value:function(){var e=o(n().mark((function e(t,r){var o,a,s,u,c,l;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=new Headers((null===r||void 0===r?void 0:r.headers)||{}),a="".concat(this.config.protocol,"://").concat(this.config.host,":").concat(this.config.port),s=null===r||void 0===r?void 0:r.responseType,null===r||void 0===r||delete r.responseType,t.startsWith("/")&&(t=t.slice(1)),this.config.network&&o.append("x-network",this.config.network),this.config.logging&&this.config.logger("Requesting: ".concat(a,"/").concat(t)),e.next=9,fetch("".concat(a,"/").concat(t),i(i({},r||{}),{},{headers:o}));case 9:if(u=e.sent,this.config.logging&&this.config.logger("Response:   ".concat(u.url," - ").concat(u.status)),c=u.headers.get("content-type"),l=u,"arraybuffer"!==s){e.next=19;break}return e.next=16,u.arrayBuffer();case 16:l.data=e.sent,e.next=48;break;case 19:if("text"!==s){e.next=25;break}return e.next=22,u.text();case 22:l.data=e.sent,e.next=48;break;case 25:if("webstream"!==s){e.next=29;break}l.data=f(u.body),e.next=48;break;case 29:if(null===c||void 0===c||!c.startsWith("application/json")){e.next=45;break}return e.prev=30,e.next=33,u.clone().json();case 33:return e.next=35,u.json();case 35:l.data=e.sent,e.next=43;break;case 38:return e.prev=38,e.t0=e.catch(30),e.next=42,u.text();case 42:l.data=e.sent;case 43:e.next=48;break;case 45:return e.next=47,u.text();case 47:l.data=e.sent;case 48:return e.abrupt("return",l);case 49:case"end":return e.stop()}}),e,this,[[30,38]])})));return function(t,r){return e.apply(this,arguments)}}()}]),e}();t.default=h;var f=function(e){var t=e;return"undefined"===typeof t[Symbol.asyncIterator]?(t[Symbol.asyncIterator]=d(e),t):e},d=function(e){return function(){var t=l(n().mark((function t(){var r,i,o,a;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.getReader(),t.prev=1,t.next=4,c(r.read());case 4:if(i=t.sent,o=i.done,a=i.value,!o){t.next=9;break}return t.abrupt("return");case 9:return t.next=11,a;case 11:return t.prev=11,r.releaseLock(),t.finish(11);case 14:case"end":return t.stop()}}),t,null,[[1,,11,14]])})));return function(){return t.apply(this,arguments)}}()}},9151:function(e,t,r){"use strict";var n=r(7061).default,i=r(7156).default,o=r(6690).default,a=r(9728).default,s=r(8416).default;Object.defineProperty(t,"__esModule",{value:!0});var u=r(3568),c=function(){function e(){if(o(this,e),s(this,"keyLength",4096),s(this,"publicExponent",65537),s(this,"hashAlgorithm","sha256"),s(this,"driver",void 0),!this.detectWebCrypto())throw new Error("SubtleCrypto not available!");this.driver=crypto.subtle}return a(e,[{key:"generateJWK",value:function(){var e=i(n().mark((function e(){var t,r;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.driver.generateKey({name:"RSA-PSS",modulusLength:4096,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign"]);case 2:return t=e.sent,e.next=5,this.driver.exportKey("jwk",t.privateKey);case 5:return r=e.sent,e.abrupt("return",{kty:r.kty,e:r.e,n:r.n,d:r.d,p:r.p,q:r.q,dp:r.dp,dq:r.dq,qi:r.qi});case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"sign",value:function(){var e=i(n().mark((function e(t,r){var i,o=arguments;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(o.length>2&&void 0!==o[2]?o[2]:{}).saltLength,e.t0=this.driver,e.t1={name:"RSA-PSS",saltLength:32},e.next=5,this.jwkToCryptoKey(t);case 5:return e.t2=e.sent,e.t3=r,e.next=9,e.t0.sign.call(e.t0,e.t1,e.t2,e.t3);case 9:return i=e.sent,e.abrupt("return",new Uint8Array(i));case 11:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"hash",value:function(){var e=i(n().mark((function e(t){var r,i,o=arguments;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=o.length>1&&void 0!==o[1]?o[1]:"SHA-256",e.next=3,this.driver.digest(r,t);case 3:return i=e.sent,e.abrupt("return",new Uint8Array(i));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"verify",value:function(){var e=i(n().mark((function e(t,r,i){var o,a,s,u,c,l;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o={kty:"RSA",e:"AQAB",n:t},e.next=3,this.jwkToPublicCryptoKey(o);case 3:return a=e.sent,e.next=6,this.driver.digest("SHA-256",r);case 6:return s=e.sent,e.next=9,this.driver.verify({name:"RSA-PSS",saltLength:0},a,i,r);case 9:return u=e.sent,e.next=12,this.driver.verify({name:"RSA-PSS",saltLength:32},a,i,r);case 12:return c=e.sent,e.next=15,this.driver.verify({name:"RSA-PSS",saltLength:Math.ceil((a.algorithm.modulusLength-1)/8)-s.byteLength-2},a,i,r);case 15:return l=e.sent,e.abrupt("return",u||c||l);case 17:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"jwkToCryptoKey",value:function(){var e=i(n().mark((function e(t){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.driver.importKey("jwk",t,{name:"RSA-PSS",hash:{name:"SHA-256"}},!1,["sign"]));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"jwkToPublicCryptoKey",value:function(){var e=i(n().mark((function e(t){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.driver.importKey("jwk",t,{name:"RSA-PSS",hash:{name:"SHA-256"}},!1,["verify"]));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"detectWebCrypto",value:function(){var e;if("undefined"===typeof crypto)return!1;var t=null===(e=crypto)||void 0===e?void 0:e.subtle;if(void 0===t)return!1;return["generateKey","importKey","exportKey","digest","sign"].every((function(e){return"function"===typeof t[e]}))}},{key:"encrypt",value:function(){var e=i(n().mark((function e(t,r,i){var o,a,s,c;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.driver.importKey("raw","string"==typeof r?u.stringToBuffer(r):r,{name:"PBKDF2",length:32},!1,["deriveKey"]);case 2:return o=e.sent,e.next=5,this.driver.deriveKey({name:"PBKDF2",salt:i?u.stringToBuffer(i):u.stringToBuffer("salt"),iterations:1e5,hash:"SHA-256"},o,{name:"AES-CBC",length:256},!1,["encrypt","decrypt"]);case 5:return a=e.sent,s=new Uint8Array(16),crypto.getRandomValues(s),e.next=10,this.driver.encrypt({name:"AES-CBC",iv:s},a,t);case 10:return c=e.sent,e.abrupt("return",u.concatBuffers([s,c]));case 12:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"decrypt",value:function(){var e=i(n().mark((function e(t,r,i){var o,a,s,c;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.driver.importKey("raw","string"==typeof r?u.stringToBuffer(r):r,{name:"PBKDF2",length:32},!1,["deriveKey"]);case 2:return o=e.sent,e.next=5,this.driver.deriveKey({name:"PBKDF2",salt:i?u.stringToBuffer(i):u.stringToBuffer("salt"),iterations:1e5,hash:"SHA-256"},o,{name:"AES-CBC",length:256},!1,["encrypt","decrypt"]);case 5:return a=e.sent,s=t.slice(0,16),e.next=9,this.driver.decrypt({name:"AES-CBC",iv:s},a,t.slice(16));case 9:return c=e.sent,e.abrupt("return",u.concatBuffers([c]));case 11:case"end":return e.stop()}}),e,this)})));return function(t,r,n){return e.apply(this,arguments)}}()}]),e}();t.default=c},6520:function(e,t,r){"use strict";var n=r(7061).default,i=r(7156).default;Object.defineProperty(t,"__esModule",{value:!0});var o=r(9839);function a(e){return s.apply(this,arguments)}function s(){return(s=i(n().mark((function e(t){var r,i,a;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Array.isArray(t)){e.next=10;break}return r=o.default.utils.concatBuffers([o.default.utils.stringToBuffer("list"),o.default.utils.stringToBuffer(t.length.toString())]),e.t0=u,e.t1=t,e.next=6,o.default.crypto.hash(r,"SHA-384");case 6:return e.t2=e.sent,e.next=9,(0,e.t0)(e.t1,e.t2);case 9:case 22:return e.abrupt("return",e.sent);case 10:return i=o.default.utils.concatBuffers([o.default.utils.stringToBuffer("blob"),o.default.utils.stringToBuffer(t.byteLength.toString())]),e.t3=o.default.utils,e.next=14,o.default.crypto.hash(i,"SHA-384");case 14:return e.t4=e.sent,e.next=17,o.default.crypto.hash(t,"SHA-384");case 17:return e.t5=e.sent,e.t6=[e.t4,e.t5],a=e.t3.concatBuffers.call(e.t3,e.t6),e.next=22,o.default.crypto.hash(a,"SHA-384");case 23:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function u(e,t){return c.apply(this,arguments)}function c(){return(c=i(n().mark((function e(t,r){var i,s;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.length<1)){e.next=2;break}return e.abrupt("return",r);case 2:return e.t0=o.default.utils,e.t1=r,e.next=6,a(t[0]);case 6:return e.t2=e.sent,e.t3=[e.t1,e.t2],i=e.t0.concatBuffers.call(e.t0,e.t3),e.next=11,o.default.crypto.hash(i,"SHA-384");case 11:return s=e.sent,e.next=14,u(t.slice(1),s);case 14:return e.abrupt("return",e.sent);case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}t.default=a},8470:function(e,t,r){"use strict";var n=r(6690).default,i=r(9728).default,o=r(4993).default,a=r(6115).default,s=r(1655).default,u=r(6389).default,c=r(3496).default,l=r(8416).default;Object.defineProperty(t,"__esModule",{value:!0}),t.getError=void 0;var h=function(e){s(r,e);var t=u(r);function r(e){var i,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n(this,r),s.message?(i=t.call(this,s.message),l(a(i),"type",void 0),l(a(i),"response",void 0)):(i=t.call(this),l(a(i),"type",void 0),l(a(i),"response",void 0)),i.type=e,i.response=s.response,o(i)}return i(r,[{key:"getType",value:function(){return this.type}}]),r}(c(Error));t.default=h,t.getError=function(e){var t=e.data;if("string"===typeof e.data)try{t=JSON.parse(e.data)}catch(r){}if(e.data instanceof ArrayBuffer||e.data instanceof Uint8Array)try{t=JSON.parse(t.toString())}catch(r){}return t?t.error||t:e.statusText||"unknown"}},5778:function(e,t,r){"use strict";var n=r(9778).Buffer,i=r(7061).default,o=r(861).default,a=r(7156).default;Object.defineProperty(t,"__esModule",{value:!0}),t.debug=t.validatePath=t.arrayCompare=t.bufferToInt=t.intToBuffer=t.arrayFlatten=t.generateProofs=t.buildLayers=t.generateTransactionChunks=t.generateTree=t.computeRootHash=t.generateLeaves=t.chunkData=t.MIN_CHUNK_SIZE=t.MAX_CHUNK_SIZE=void 0;var s=r(9839),u=r(3568);t.MAX_CHUNK_SIZE=262144,t.MIN_CHUNK_SIZE=32768;var c=32,l=32;function h(e){return f.apply(this,arguments)}function f(){return(f=a(i().mark((function e(r){var n,o,a,u,c,l,h;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=[],o=r,a=0;case 3:if(!(o.byteLength>=t.MAX_CHUNK_SIZE)){e.next=16;break}return u=t.MAX_CHUNK_SIZE,(c=o.byteLength-t.MAX_CHUNK_SIZE)>0&&c<t.MIN_CHUNK_SIZE&&(u=Math.ceil(o.byteLength/2)),l=o.slice(0,u),e.next=10,s.default.crypto.hash(l);case 10:h=e.sent,a+=l.byteLength,n.push({dataHash:h,minByteRange:a-l.byteLength,maxByteRange:a}),o=o.slice(u),e.next=3;break;case 16:return e.t0=n,e.next=19,s.default.crypto.hash(o);case 19:return e.t1=e.sent,e.t2=a,e.t3=a+o.byteLength,e.t4={dataHash:e.t1,minByteRange:e.t2,maxByteRange:e.t3},e.t0.push.call(e.t0,e.t4),e.abrupt("return",n);case 25:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function d(e){return p.apply(this,arguments)}function p(){return p=a(i().mark((function e(t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all(t.map(function(){var e=a(i().mark((function e(t){var r,n,o;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.dataHash,n=t.minByteRange,o=t.maxByteRange,e.t0=S,e.next=4,Promise.all([S(r),S(M(o))]);case 4:return e.t1=e.sent,e.next=7,(0,e.t0)(e.t1);case 7:return e.t2=e.sent,e.t3=r,e.t4=n,e.t5=o,e.abrupt("return",{type:"leaf",id:e.t2,dataHash:e.t3,minByteRange:e.t4,maxByteRange:e.t5});case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())));case 1:case"end":return e.stop()}}),e)}))),p.apply(this,arguments)}function m(){return(m=a(i().mark((function e(t){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g(t);case 2:return r=e.sent,e.abrupt("return",r.id);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function g(e){return y.apply(this,arguments)}function y(){return(y=a(i().mark((function e(t){var r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=_,e.t1=d,e.next=4,h(t);case 4:return e.t2=e.sent,e.next=7,(0,e.t1)(e.t2);case 7:return e.t3=e.sent,e.next=10,(0,e.t0)(e.t3);case 10:return r=e.sent,e.abrupt("return",r);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function v(){return(v=a(i().mark((function e(t){var r,n,o,a,s;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h(t);case 2:return r=e.sent,e.next=5,d(r);case 5:return n=e.sent,e.next=8,_(n);case 8:return o=e.sent,e.next=11,x(o);case 11:return a=e.sent,(s=r.slice(-1)[0]).maxByteRange-s.minByteRange===0&&(r.splice(r.length-1,1),a.splice(a.length-1,1)),e.abrupt("return",{data_root:o.id,chunks:r,proofs:a});case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _(e){return b.apply(this,arguments)}function b(){return b=a(i().mark((function e(t){var r,n,o,a,s=arguments;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=s.length>1&&void 0!==s[1]?s[1]:0,!(t.length<2)){e.next=4;break}return n=t[0],e.abrupt("return",n);case 4:o=[],a=0;case 6:if(!(a<t.length)){e.next=15;break}return e.t0=o,e.next=10,A(t[a],t[a+1]);case 10:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 12:a+=2,e.next=6;break;case 15:return e.abrupt("return",_(o,r+1));case 16:case"end":return e.stop()}}),e)}))),b.apply(this,arguments)}function x(e){var t=w(e);return Array.isArray(t)?k(t):[t]}function w(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Uint8Array,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if("leaf"==e.type)return{offset:e.maxByteRange-1,proof:(0,u.concatBuffers)([t,e.dataHash,M(e.maxByteRange)])};if("branch"==e.type){var n=(0,u.concatBuffers)([t,e.leftChild.id,e.rightChild.id,M(e.byteRange)]);return[w(e.leftChild,n,r+1),w(e.rightChild,n,r+1)]}throw new Error("Unexpected node type")}function k(e){var t=[];return e.forEach((function(e){Array.isArray(e)?t.push.apply(t,o(k(e))):t.push(e)})),t}function A(e,t){return E.apply(this,arguments)}function E(){return(E=a(i().mark((function e(t,r){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}return e.abrupt("return",t);case 2:return e.t0=S,e.next=5,S(t.id);case 5:return e.t1=e.sent,e.next=8,S(r.id);case 8:return e.t2=e.sent,e.next=11,S(M(t.maxByteRange));case 11:return e.t3=e.sent,e.t4=[e.t1,e.t2,e.t3],e.next=15,(0,e.t0)(e.t4);case 15:return e.t5=e.sent,e.t6=t.maxByteRange,e.t7=r.maxByteRange,e.t8=t,e.t9=r,n={type:"branch",id:e.t5,byteRange:e.t6,maxByteRange:e.t7,leftChild:e.t8,rightChild:e.t9},e.abrupt("return",n);case 22:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function S(e){return T.apply(this,arguments)}function T(){return(T=a(i().mark((function e(t){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Array.isArray(t)&&(t=s.default.utils.concatBuffers(t)),e.t0=Uint8Array,e.next=4,s.default.crypto.hash(t);case 4:return e.t1=e.sent,e.abrupt("return",new e.t0(e.t1));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function M(e){for(var t=new Uint8Array(c),r=t.length-1;r>=0;r--){var n=e%256;t[r]=n,e=(e-n)/256}return t}function I(e){for(var t=0,r=0;r<e.length;r++)t*=256,t+=e[r];return t}t.chunkData=h,t.generateLeaves=d,t.computeRootHash=function(e){return m.apply(this,arguments)},t.generateTree=g,t.generateTransactionChunks=function(e){return v.apply(this,arguments)},t.buildLayers=_,t.generateProofs=x,t.arrayFlatten=k,t.intToBuffer=M,t.bufferToInt=I;function P(e,t,r,n,i){return C.apply(this,arguments)}function C(){return(C=a(i().mark((function e(r,n,o,a,s){var u,h,f,d,p,m,g,y,v;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(a<=0)){e.next=2;break}return e.abrupt("return",!1);case 2:if(!(n>=a)){e.next=4;break}return e.abrupt("return",P(r,0,a-1,a,s));case 4:if(!(n<0)){e.next=6;break}return e.abrupt("return",P(r,0,0,a,s));case 6:if(s.length!=l+c){e.next=24;break}return u=s.slice(0,l),h=s.slice(u.length,u.length+c),e.t0=S,e.next=12,S(u);case 12:return e.t1=e.sent,e.next=15,S(h);case 15:return e.t2=e.sent,e.t3=[e.t1,e.t2],e.next=19,(0,e.t0)(e.t3);case 19:if(f=e.sent,!(0,t.arrayCompare)(r,f)){e.next=23;break}return e.abrupt("return",{offset:a-1,leftBound:o,rightBound:a,chunkSize:a-o});case 23:case 51:return e.abrupt("return",!1);case 24:return d=s.slice(0,l),p=s.slice(d.length,d.length+l),m=s.slice(d.length+p.length,d.length+p.length+c),g=I(m),y=s.slice(d.length+p.length+m.length),e.t4=S,e.next=32,S(d);case 32:return e.t5=e.sent,e.next=35,S(p);case 35:return e.t6=e.sent,e.next=38,S(m);case 38:return e.t7=e.sent,e.t8=[e.t5,e.t6,e.t7],e.next=42,(0,e.t4)(e.t8);case 42:if(v=e.sent,!(0,t.arrayCompare)(r,v)){e.next=51;break}if(!(n<g)){e.next=48;break}return e.next=47,P(d,n,o,Math.min(a,g),y);case 47:case 50:return e.abrupt("return",e.sent);case 48:return e.next=50,P(p,n,Math.max(o,g),a,y);case 52:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function B(e){return D.apply(this,arguments)}function D(){return D=a(i().mark((function e(t){var r,o,a,s,u,h,f,d,p=arguments;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=p.length>1&&void 0!==p[1]?p[1]:"",!(t.byteLength<1)){e.next=3;break}return e.abrupt("return",r);case 3:return o=t.slice(0,l),a=t.slice(o.length,o.length+l),s=t.slice(o.length+a.length,o.length+a.length+c),u=I(s),h=t.slice(o.length+a.length+s.length),e.t0=S,e.next=11,S(o);case 11:return e.t1=e.sent,e.next=14,S(a);case 14:return e.t2=e.sent,e.next=17,S(s);case 17:return e.t3=e.sent,e.t4=[e.t1,e.t2,e.t3],e.next=21,(0,e.t0)(e.t4);case 21:return f=e.sent,d="".concat(r,"\n").concat(JSON.stringify(n.from(o)),",").concat(JSON.stringify(n.from(a)),",").concat(u," => ").concat(JSON.stringify(f)),e.abrupt("return",B(h,d));case 24:case"end":return e.stop()}}),e)}))),D.apply(this,arguments)}t.arrayCompare=function(e,t){return e.every((function(e,r){return t[r]===e}))},t.validatePath=P,t.debug=B},6380:function(e,t,r){"use strict";var n=r(7061).default,i=r(7156).default,o=r(6690).default,a=r(9728).default,s=r(8416).default;Object.defineProperty(t,"__esModule",{value:!0}),t.TransactionUploader=void 0;var u=r(3872),c=r(3568),l=r(8470),h=r(5778),f=["invalid_json","chunk_too_big","data_path_too_big","offset_too_big","data_size_too_big","chunk_proof_ratio_not_attractive","invalid_proof"],d=function(){function e(t,r){if(o(this,e),s(this,"api",void 0),s(this,"chunkIndex",0),s(this,"txPosted",!1),s(this,"transaction",void 0),s(this,"lastRequestTimeEnd",0),s(this,"totalErrors",0),s(this,"data",void 0),s(this,"lastResponseStatus",0),s(this,"lastResponseError",""),this.api=t,!r.id)throw new Error("Transaction is not signed");if(!r.chunks)throw new Error("Transaction chunks not prepared");this.data=r.data,this.transaction=new u.default(Object.assign({},r,{data:new Uint8Array(0)}))}return a(e,[{key:"isComplete",get:function(){return this.txPosted&&this.chunkIndex===this.transaction.chunks.chunks.length}},{key:"totalChunks",get:function(){return this.transaction.chunks.chunks.length}},{key:"uploadedChunks",get:function(){return this.chunkIndex}},{key:"pctComplete",get:function(){return Math.trunc(this.uploadedChunks/this.totalChunks*100)}},{key:"uploadChunk",value:function(){var e=i(n().mark((function e(t){var r,i,o;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isComplete){e.next=2;break}throw new Error("Upload is already complete");case 2:if(""!==this.lastResponseError?this.totalErrors++:this.totalErrors=0,100!==this.totalErrors){e.next=5;break}throw new Error("Unable to complete upload: ".concat(this.lastResponseStatus,": ").concat(this.lastResponseError));case 5:if(!((r=""===this.lastResponseError?0:Math.max(this.lastRequestTimeEnd+4e4-Date.now(),4e4))>0)){e.next=10;break}return r-=r*Math.random()*.3,e.next=10,new Promise((function(e){return setTimeout(e,r)}));case 10:if(this.lastResponseError="",this.txPosted){e.next=15;break}return e.next=14,this.postTransaction();case 14:return e.abrupt("return");case 15:return t&&(this.chunkIndex=t),i=this.transaction.getChunk(t||this.chunkIndex,this.data),e.next=19,(0,h.validatePath)(this.transaction.chunks.data_root,parseInt(i.offset),0,parseInt(i.data_size),c.b64UrlToBuffer(i.data_path));case 19:if(e.sent){e.next=22;break}throw new Error("Unable to validate chunk ".concat(this.chunkIndex));case 22:return e.next=24,this.api.post("chunk",this.transaction.getChunk(this.chunkIndex,this.data)).catch((function(e){return console.error(e.message),{status:-1,data:{error:e.message}}}));case 24:if(o=e.sent,this.lastRequestTimeEnd=Date.now(),this.lastResponseStatus=o.status,200!=this.lastResponseStatus){e.next=31;break}this.chunkIndex++,e.next=34;break;case 31:if(this.lastResponseError=(0,l.getError)(o),!f.includes(this.lastResponseError)){e.next=34;break}throw new Error("Fatal error uploading chunk ".concat(this.chunkIndex,": ").concat(this.lastResponseError));case 34:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"toJSON",value:function(){return{chunkIndex:this.chunkIndex,transaction:this.transaction,lastRequestTimeEnd:this.lastRequestTimeEnd,lastResponseStatus:this.lastResponseStatus,lastResponseError:this.lastResponseError,txPosted:this.txPosted}}},{key:"postTransaction",value:function(){var e=i(n().mark((function e(){var t,r;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.totalChunks<=1)){e.next=15;break}return this.transaction.data=this.data,e.next=5,this.api.post("tx",this.transaction).catch((function(e){return console.error(e),{status:-1,data:{error:e.message}}}));case 5:if(t=e.sent,this.lastRequestTimeEnd=Date.now(),this.lastResponseStatus=t.status,this.transaction.data=new Uint8Array(0),!(t.status>=200&&t.status<300)){e.next=13;break}return this.txPosted=!0,this.chunkIndex=1,e.abrupt("return");case 13:throw this.lastResponseError=(0,l.getError)(t),new Error("Unable to upload transaction: ".concat(t.status,", ").concat(this.lastResponseError));case 15:return e.next=17,this.api.post("tx",this.transaction);case 17:if(r=e.sent,this.lastRequestTimeEnd=Date.now(),this.lastResponseStatus=r.status,r.status>=200&&r.status<300){e.next=23;break}throw this.lastResponseError=(0,l.getError)(r),new Error("Unable to upload transaction: ".concat(r.status,", ").concat(this.lastResponseError));case 23:this.txPosted=!0;case 24:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}],[{key:"fromSerialized",value:function(){var t=i(n().mark((function t(r,i,o){var a,s;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i&&"number"===typeof i.chunkIndex&&"object"===typeof i.transaction){t.next=2;break}throw new Error("Serialized object does not match expected format.");case 2:if((a=new u.default(i.transaction)).chunks){t.next=6;break}return t.next=6,a.prepareChunks(o);case 6:if((s=new e(r,a)).chunkIndex=i.chunkIndex,s.lastRequestTimeEnd=i.lastRequestTimeEnd,s.lastResponseError=i.lastResponseError,s.lastResponseStatus=i.lastResponseStatus,s.txPosted=i.txPosted,s.data=o,s.transaction.data_root===i.transaction.data_root){t.next=15;break}throw new Error("Data mismatch: Uploader doesn't match provided data.");case 15:return t.abrupt("return",s);case 16:case"end":return t.stop()}}),t)})));return function(e,r,n){return t.apply(this,arguments)}}()},{key:"fromTransactionId",value:function(){var e=i(n().mark((function e(t,r){var i,o,a;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.get("tx/".concat(r));case 2:if(200===(i=e.sent).status){e.next=5;break}throw new Error("Tx ".concat(r," not found: ").concat(i.status));case 5:return(o=i.data).data=new Uint8Array(0),a={txPosted:!0,chunkIndex:0,lastResponseError:"",lastRequestTimeEnd:0,lastResponseStatus:0,transaction:o},e.abrupt("return",a);case 9:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()}]),e}();t.TransactionUploader=d},3872:function(e,t,r){"use strict";var n=r(7061).default,i=r(7156).default,o=r(6115).default,a=r(1655).default,s=r(6389).default,u=r(8416).default,c=r(6690).default,l=r(9728).default;Object.defineProperty(t,"__esModule",{value:!0}),t.Tag=void 0;var h=r(3568),f=r(6520),d=r(5778),p=function(){function e(){c(this,e)}return l(e,[{key:"get",value:function(e,t){if(!Object.getOwnPropertyNames(this).includes(e))throw new Error('Field "'.concat(e,'" is not a property of the Arweave Transaction class.'));return this[e]instanceof Uint8Array?t&&t.decode&&t.string?h.bufferToString(this[e]):t&&t.decode&&!t.string?this[e]:h.bufferTob64Url(this[e]):t&&1==t.decode?t&&t.string?h.b64UrlToString(this[e]):h.b64UrlToBuffer(this[e]):this[e]}}]),e}(),m=function(e){a(r,e);var t=s(r);function r(e,n){var i;return c(this,r),i=t.call(this),u(o(i),"name",void 0),u(o(i),"value",void 0),i.name=e,i.value=n,i}return l(r)}(p);t.Tag=m;var g=function(e){a(r,e);var t=s(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return c(this,r),e=t.call(this),u(o(e),"format",2),u(o(e),"id",""),u(o(e),"last_tx",""),u(o(e),"owner",""),u(o(e),"tags",[]),u(o(e),"target",""),u(o(e),"quantity","0"),u(o(e),"data_size","0"),u(o(e),"data",new Uint8Array),u(o(e),"data_root",""),u(o(e),"reward","0"),u(o(e),"signature",""),u(o(e),"chunks",void 0),Object.assign(o(e),n),"string"===typeof e.data&&(e.data=h.b64UrlToBuffer(e.data)),n.tags&&(e.tags=n.tags.map((function(e){return new m(e.name,e.value)}))),e}return l(r,[{key:"addTag",value:function(e,t){this.tags.push(new m(h.stringToB64Url(e),h.stringToB64Url(t)))}},{key:"toJSON",value:function(){return{format:this.format,id:this.id,last_tx:this.last_tx,owner:this.owner,tags:this.tags,target:this.target,quantity:this.quantity,data:h.bufferTob64Url(this.data),data_size:this.data_size,data_root:this.data_root,data_tree:this.data_tree,reward:this.reward,signature:this.signature}}},{key:"setOwner",value:function(e){this.owner=e}},{key:"setSignature",value:function(e){var t=e.id,r=e.owner,n=e.reward,i=e.tags,o=e.signature;this.id=t,this.owner=r,n&&(this.reward=n),i&&(this.tags=i),this.signature=o}},{key:"prepareChunks",value:function(){var e=i(n().mark((function e(t){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.chunks||!(t.byteLength>0)){e.next=5;break}return e.next=3,(0,d.generateTransactionChunks)(t);case 3:this.chunks=e.sent,this.data_root=h.bufferTob64Url(this.chunks.data_root);case 5:this.chunks||0!==t.byteLength||(this.chunks={chunks:[],data_root:new Uint8Array,proofs:[]},this.data_root="");case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getChunk",value:function(e,t){if(!this.chunks)throw new Error("Chunks have not been prepared");var r=this.chunks.proofs[e],n=this.chunks.chunks[e];return{data_root:this.data_root,data_size:this.data_size,data_path:h.bufferTob64Url(r.proof),offset:r.offset.toString(),chunk:h.bufferTob64Url(t.slice(n.minByteRange,n.maxByteRange))}}},{key:"getSignatureData",value:function(){var e=i(n().mark((function e(){var t,r;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=this.format,e.next=1===e.t0?3:2===e.t0?5:12;break;case 3:return t=this.tags.reduce((function(e,t){return h.concatBuffers([e,t.get("name",{decode:!0,string:!1}),t.get("value",{decode:!0,string:!1})])}),new Uint8Array),e.abrupt("return",h.concatBuffers([this.get("owner",{decode:!0,string:!1}),this.get("target",{decode:!0,string:!1}),this.get("data",{decode:!0,string:!1}),h.stringToBuffer(this.quantity),h.stringToBuffer(this.reward),this.get("last_tx",{decode:!0,string:!1}),t]));case 5:if(this.data_root){e.next=8;break}return e.next=8,this.prepareChunks(this.data);case 8:return r=this.tags.map((function(e){return[e.get("name",{decode:!0,string:!1}),e.get("value",{decode:!0,string:!1})]})),e.next=11,(0,f.default)([h.stringToBuffer(this.format.toString()),this.get("owner",{decode:!0,string:!1}),this.get("target",{decode:!0,string:!1}),h.stringToBuffer(this.quantity),h.stringToBuffer(this.reward),this.get("last_tx",{decode:!0,string:!1}),r,h.stringToBuffer(this.data_size),this.get("data_root",{decode:!0,string:!1})]);case 11:return e.abrupt("return",e.sent);case 12:throw new Error("Unexpected transaction format: ".concat(this.format));case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),r}(p);t.default=g},3568:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.b64UrlDecode=t.b64UrlEncode=t.bufferTob64Url=t.bufferTob64=t.b64UrlToBuffer=t.stringToB64Url=t.stringToBuffer=t.bufferToString=t.b64UrlToString=t.concatBuffers=void 0;var n=r(2009);function i(e){return new TextDecoder("utf-8",{fatal:!0}).decode(e)}function o(e){return(new TextEncoder).encode(e)}function a(e){return new Uint8Array(n.toByteArray(l(e)))}function s(e){return n.fromByteArray(new Uint8Array(e))}function u(e){return c(s(e))}function c(e){return e.replace(/\+/g,"-").replace(/\//g,"_").replace(/\=/g,"")}function l(e){var t;return t=(e=e.replace(/\-/g,"+").replace(/\_/g,"/")).length%4==0?0:4-e.length%4,e.concat("=".repeat(t))}t.concatBuffers=function(e){for(var t=0,r=0;r<e.length;r++)t+=e[r].byteLength;var n=new Uint8Array(t),i=0;n.set(new Uint8Array(e[0]),i),i+=e[0].byteLength;for(var o=1;o<e.length;o++)n.set(new Uint8Array(e[o]),i),i+=e[o].byteLength;return n},t.b64UrlToString=function(e){return i(a(e))},t.bufferToString=i,t.stringToBuffer=o,t.stringToB64Url=function(e){return u(o(e))},t.b64UrlToBuffer=a,t.bufferTob64=s,t.bufferTob64Url=u,t.b64UrlEncode=c,t.b64UrlDecode=l},8963:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getDefaultConfig=void 0;t.getDefaultConfig=function(e,t){if(function(e,t){var r=/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/,n=t.split("."),i=n[n.length-1],o=["localhost","[::1]"];return o.includes(t)||"file"==e||o.includes(i)||!!t.match(r)||!!i.match(r)}(e,t))return{protocol:"https",host:"arweave.net",port:443};if(!function(e){var t="["===e.charAt(0);return!!e.match(/^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$/)||t}(t)){var r=t.split(".");if(r.length>=3)return r.shift(),{protocol:e,host:r.join(".")}}return{protocol:e,host:t}}},5739:function(e,t,r){"use strict";var n=r(6690).default,i=r(9728).default,o=r(8416).default;Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(t){n(this,e),o(this,"api",void 0),this.api=t}return i(e,[{key:"getInfo",value:function(){return this.api.get("info").then((function(e){return e.data}))}},{key:"getPeers",value:function(){return this.api.get("peers").then((function(e){return e.data}))}}]),e}();t.default=a},8165:function(e,t,r){"use strict";var n=r(7061).default,i=r(7156).default,o=r(6690).default,a=r(9728).default,s=r(8416).default;Object.defineProperty(t,"__esModule",{value:!0}),t.SiloResource=void 0;var u=r(3568),c=function(){function e(t,r,n){o(this,e),s(this,"api",void 0),s(this,"crypto",void 0),s(this,"transactions",void 0),this.api=t,this.crypto=r,this.transactions=n}return a(e,[{key:"get",value:function(){var e=i(n().mark((function e(t){var r,i,o,a;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}throw new Error("No Silo URI specified");case 2:return e.next=4,this.parseUri(t);case 4:return r=e.sent,e.next=7,this.transactions.search("Silo-Name",r.getAccessKey());case 7:if(0!=(i=e.sent).length){e.next=10;break}throw new Error("No data could be found for the Silo URI: ".concat(t));case 10:return e.next=12,this.transactions.get(i[0]);case 12:if(o=e.sent){e.next=15;break}throw new Error("No data could be found for the Silo URI: ".concat(t));case 15:return a=o.get("data",{decode:!0,string:!1}),e.abrupt("return",this.crypto.decrypt(a,r.getEncryptionKey()));case 17:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"readTransactionData",value:function(){var e=i(n().mark((function e(t,r){var i,o;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=2;break}throw new Error("No Silo URI specified");case 2:return e.next=4,this.parseUri(r);case 4:return i=e.sent,o=t.get("data",{decode:!0,string:!1}),e.abrupt("return",this.crypto.decrypt(o,i.getEncryptionKey()));case 7:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"parseUri",value:function(){var e=i(n().mark((function e(t){var r,i,o,a,s,c;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.match(/^([a-z0-9-_]+)\.([0-9]+)/i)){e.next=3;break}throw new Error("Invalid Silo name, must be a name in the format of [a-z0-9]+.[0-9]+, e.g. 'bubble.7'");case 3:return i=r[1],o=Math.pow(2,parseInt(r[2])),e.next=7,this.hash(u.stringToBuffer(i),o);case 7:return a=e.sent,s=u.bufferTob64(a.slice(0,15)),e.next=11,this.hash(a.slice(16,31),1);case 11:return c=e.sent,e.abrupt("return",new l(t,s,c));case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"hash",value:function(){var e=i(n().mark((function e(t,r){var i,o;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.crypto.hash(t);case 2:i=e.sent,o=0;case 4:if(!(o<r-1)){e.next=11;break}return e.next=7,this.crypto.hash(i);case 7:i=e.sent;case 8:o++,e.next=4;break;case 11:return e.abrupt("return",i);case 12:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()}]),e}();t.default=c;var l=function(){function e(t,r,n){o(this,e),s(this,"uri",void 0),s(this,"accessKey",void 0),s(this,"encryptionKey",void 0),this.uri=t,this.accessKey=r,this.encryptionKey=n}return a(e,[{key:"getUri",value:function(){return this.uri}},{key:"getAccessKey",value:function(){return this.accessKey}},{key:"getEncryptionKey",value:function(){return this.encryptionKey}}]),e}();t.SiloResource=l},8164:function(e,t,r){"use strict";var n=r(7061).default,i=r(2122).default,o=r(7156).default,a=r(6690).default,s=r(9728).default,u=r(8416).default,c=r(6737).default,l=r(8186).default;Object.defineProperty(t,"__esModule",{value:!0});var h=r(8470),f=r(3872),d=r(3568),p=r(6380);r(6807);var m=function(){function e(t,r,n){a(this,e),u(this,"api",void 0),u(this,"crypto",void 0),u(this,"chunks",void 0),this.api=t,this.crypto=r,this.chunks=n}return s(e,[{key:"getTransactionAnchor",value:function(){return this.api.get("tx_anchor").then((function(e){return e.data}))}},{key:"getPrice",value:function(e,t){var r=t?"price/".concat(e,"/").concat(t):"price/".concat(e);return this.api.get(r).then((function(e){return e.data}))}},{key:"get",value:function(){var e=o(n().mark((function e(t){var r,o,a;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.api.get("tx/".concat(t));case 2:if(200!=(r=e.sent).status){e.next=11;break}if(o=parseInt(r.data.data_size),!(r.data.format>=2&&o>0&&o<=12582912)){e.next=10;break}return e.next=8,this.getData(t);case 8:return a=e.sent,e.abrupt("return",new f.default(i(i({},r.data),{},{data:a})));case 10:return e.abrupt("return",new f.default(i(i({},r.data),{},{format:r.data.format||1})));case 11:if(404!=r.status){e.next=13;break}throw new h.default("TX_NOT_FOUND");case 13:if(410!=r.status){e.next=15;break}throw new h.default("TX_FAILED");case 15:throw new h.default("TX_INVALID");case 16:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"fromRaw",value:function(e){return new f.default(e)}},{key:"search",value:function(){var e=o(n().mark((function e(t,r){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.api.post("arql",{op:"equals",expr1:t,expr2:r}).then((function(e){return e.data?e.data:[]})));case 1:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"getStatus",value:function(e){return this.api.get("tx/".concat(e,"/status")).then((function(e){return 200==e.status?{status:200,confirmed:e.data}:{status:e.status,confirmed:null}}))}},{key:"getData",value:function(){var e=o(n().mark((function e(t,r){var i;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=void 0,e.prev=1,e.next=4,this.chunks.downloadChunkedData(t);case 4:i=e.sent,e.next=11;break;case 7:e.prev=7,e.t0=e.catch(1),console.error("Error while trying to download chunked data for ".concat(t)),console.error(e.t0);case 11:if(i){e.next=23;break}return console.warn("Falling back to gateway cache for ".concat(t)),e.prev=13,e.next=16,this.api.get("/".concat(t),{responseType:"arraybuffer"});case 16:i=e.sent.data,e.next=23;break;case 19:e.prev=19,e.t1=e.catch(13),console.error("Error while trying to download contiguous data from gateway cache for ".concat(t)),console.error(e.t1);case 23:if(i){e.next=25;break}throw new Error("".concat(t," was not found!"));case 25:if(!r||!r.decode||r.string){e.next=27;break}return e.abrupt("return",i);case 27:if(!(r&&r.decode&&r.string)){e.next=29;break}return e.abrupt("return",d.bufferToString(i));case 29:return e.abrupt("return",d.bufferTob64Url(i));case 30:case"end":return e.stop()}}),e,this,[[1,7],[13,19]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"sign",value:function(){var e=o(n().mark((function e(t,r,i){var o,a,s,u;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r||"object"===typeof arweaveWallet){e.next=4;break}throw new Error("A new Arweave transaction must provide the jwk parameter.");case 4:if(r&&"use_wallet"!==r){e.next=22;break}return e.prev=5,e.next=8,arweaveWallet.getPermissions();case 8:if(e.sent.includes("SIGN_TRANSACTION")){e.next=12;break}return e.next=12,arweaveWallet.connect(["SIGN_TRANSACTION"]);case 12:e.next=16;break;case 14:e.prev=14,e.t0=e.catch(5);case 16:return e.next=18,arweaveWallet.sign(t,i);case 18:o=e.sent,t.setSignature({id:o.id,owner:o.owner,reward:o.reward,tags:o.tags,signature:o.signature}),e.next=33;break;case 22:return t.setOwner(r.n),e.next=25,t.getSignatureData();case 25:return a=e.sent,e.next=28,this.crypto.sign(r,a,i);case 28:return s=e.sent,e.next=31,this.crypto.hash(s);case 31:u=e.sent,t.setSignature({id:d.bufferTob64Url(u),owner:r.n,signature:d.bufferTob64Url(s)});case 33:case"end":return e.stop()}}),e,this,[[5,14]])})));return function(t,r,n){return e.apply(this,arguments)}}()},{key:"verify",value:function(){var e=o(n().mark((function e(t){var r,i,o;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getSignatureData();case 2:return r=e.sent,i=t.get("signature",{decode:!0,string:!1}),e.t0=d,e.next=7,this.crypto.hash(i);case 7:if(e.t1=e.sent,o=e.t0.bufferTob64Url.call(e.t0,e.t1),t.id===o){e.next=11;break}throw new Error("Invalid transaction signature or ID! The transaction ID doesn't match the expected SHA-256 hash of the signature.");case 11:return e.abrupt("return",this.crypto.verify(t.owner,r,i));case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"post",value:function(){var e=o(n().mark((function e(t){var r;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("string"===typeof t?t=new f.default(JSON.parse(t)):"function"===typeof t.readInt32BE?t=new f.default(JSON.parse(t.toString())):"object"!==typeof t||t instanceof f.default||(t=new f.default(t)),t instanceof f.default){e.next=3;break}throw new Error("Must be Transaction object");case 3:if(t.chunks){e.next=6;break}return e.next=6,t.prepareChunks(t.data);case 6:return e.next=8,this.getUploader(t,t.data);case 8:r=e.sent,e.prev=9;case 10:if(r.isComplete){e.next=15;break}return e.next=13,r.uploadChunk();case 13:e.next=10;break;case 15:e.next=22;break;case 17:if(e.prev=17,e.t0=e.catch(9),!(r.lastResponseStatus>0)){e.next=21;break}return e.abrupt("return",{status:r.lastResponseStatus,statusText:r.lastResponseError,data:{error:r.lastResponseError}});case 21:throw e.t0;case 22:return e.abrupt("return",{status:200,statusText:"OK",data:{}});case 23:case"end":return e.stop()}}),e,this,[[9,17]])})));return function(t){return e.apply(this,arguments)}}()},{key:"getUploader",value:function(){var e=o(n().mark((function e(t,r){var i;return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r instanceof ArrayBuffer&&(r=new Uint8Array(r)),!(t instanceof f.default)){e.next=12;break}if(r||(r=t.data),r instanceof Uint8Array){e.next=5;break}throw new Error("Data format is invalid");case 5:if(t.chunks){e.next=8;break}return e.next=8,t.prepareChunks(r);case 8:(i=new p.TransactionUploader(this.api,t)).data&&0!==i.data.length||(i.data=r),e.next=21;break;case 12:if("string"!==typeof t){e.next=16;break}return e.next=15,p.TransactionUploader.fromTransactionId(this.api,t);case 15:t=e.sent;case 16:if(r&&r instanceof Uint8Array){e.next=18;break}throw new Error("Must provide data when resuming upload");case 18:return e.next=20,p.TransactionUploader.fromSerialized(this.api,t,r);case 20:i=e.sent;case 21:return e.abrupt("return",i);case 22:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"upload",value:function(e,t){var r=this;return l(n().mark((function i(){var o;return n().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,c(r.getUploader(e,t));case 2:o=n.sent;case 3:if(o.isComplete){n.next=10;break}return n.next=6,c(o.uploadChunk());case 6:return n.next=8,o;case 8:n.next=3;break;case 10:return n.abrupt("return",o);case 11:case"end":return n.stop()}}),i)})))()}}]),e}();t.default=m},7073:function(e,t,r){"use strict";var n=r(7061).default,i=r(7156).default,o=r(6690).default,a=r(9728).default,s=r(8416).default;Object.defineProperty(t,"__esModule",{value:!0});var u=r(3568);r(6807);var c=function(){function e(t,r){o(this,e),s(this,"api",void 0),s(this,"crypto",void 0),this.api=t,this.crypto=r}return a(e,[{key:"getBalance",value:function(e){return this.api.get("wallet/".concat(e,"/balance")).then((function(e){return e.data}))}},{key:"getLastTransactionID",value:function(e){return this.api.get("wallet/".concat(e,"/last_tx")).then((function(e){return e.data}))}},{key:"generate",value:function(){return this.crypto.generateJWK()}},{key:"jwkToAddress",value:function(){var e=i(n().mark((function e(t){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&"use_wallet"!==t){e.next=4;break}return e.abrupt("return",this.getAddress());case 4:return e.abrupt("return",this.getAddress(t));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getAddress",value:function(){var e=i(n().mark((function e(t){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&"use_wallet"!==t){e.next=11;break}return e.prev=1,e.next=4,arweaveWallet.connect(["ACCESS_ADDRESS"]);case 4:e.next=8;break;case 6:e.prev=6,e.t0=e.catch(1);case 8:return e.abrupt("return",arweaveWallet.getActiveAddress());case 11:return e.abrupt("return",this.ownerToAddress(t.n));case 12:case"end":return e.stop()}}),e,this,[[1,6]])})));return function(t){return e.apply(this,arguments)}}()},{key:"ownerToAddress",value:function(){var e=i(n().mark((function e(t){return n().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=u,e.next=3,this.crypto.hash(u.b64UrlToBuffer(t));case 3:return e.t1=e.sent,e.abrupt("return",e.t0.bufferTob64Url.call(e.t0,e.t1));case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();t.default=c},4569:function(e,t,r){e.exports=r(8036)},3381:function(e,t,r){"use strict";var n=r(3589),i=r(7297),o=r(9301),a=r(9774),s=r(1804),u=r(9145),c=r(5411),l=r(6467),h=r(221),f=r(9346);e.exports=function(e){return new Promise((function(t,r){var d,p=e.data,m=e.headers,g=e.responseType;function y(){e.cancelToken&&e.cancelToken.unsubscribe(d),e.signal&&e.signal.removeEventListener("abort",d)}n.isFormData(p)&&delete m["Content-Type"];var v=new XMLHttpRequest;if(e.auth){var _=e.auth.username||"",b=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";m.Authorization="Basic "+btoa(_+":"+b)}var x=s(e.baseURL,e.url);function w(){if(v){var n="getAllResponseHeaders"in v?u(v.getAllResponseHeaders()):null,o={data:g&&"text"!==g&&"json"!==g?v.response:v.responseText,status:v.status,statusText:v.statusText,headers:n,config:e,request:v};i((function(e){t(e),y()}),(function(e){r(e),y()}),o),v=null}}if(v.open(e.method.toUpperCase(),a(x,e.params,e.paramsSerializer),!0),v.timeout=e.timeout,"onloadend"in v?v.onloadend=w:v.onreadystatechange=function(){v&&4===v.readyState&&(0!==v.status||v.responseURL&&0===v.responseURL.indexOf("file:"))&&setTimeout(w)},v.onabort=function(){v&&(r(l("Request aborted",e,"ECONNABORTED",v)),v=null)},v.onerror=function(){r(l("Network Error",e,null,v)),v=null},v.ontimeout=function(){var t=e.timeout?"timeout of "+e.timeout+"ms exceeded":"timeout exceeded",n=e.transitional||h.transitional;e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),r(l(t,e,n.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",v)),v=null},n.isStandardBrowserEnv()){var k=(e.withCredentials||c(x))&&e.xsrfCookieName?o.read(e.xsrfCookieName):void 0;k&&(m[e.xsrfHeaderName]=k)}"setRequestHeader"in v&&n.forEach(m,(function(e,t){"undefined"===typeof p&&"content-type"===t.toLowerCase()?delete m[t]:v.setRequestHeader(t,e)})),n.isUndefined(e.withCredentials)||(v.withCredentials=!!e.withCredentials),g&&"json"!==g&&(v.responseType=e.responseType),"function"===typeof e.onDownloadProgress&&v.addEventListener("progress",e.onDownloadProgress),"function"===typeof e.onUploadProgress&&v.upload&&v.upload.addEventListener("progress",e.onUploadProgress),(e.cancelToken||e.signal)&&(d=function(e){v&&(r(!e||e&&e.type?new f("canceled"):e),v.abort(),v=null)},e.cancelToken&&e.cancelToken.subscribe(d),e.signal&&(e.signal.aborted?d():e.signal.addEventListener("abort",d))),p||(p=null),v.send(p)}))}},8036:function(e,t,r){"use strict";var n=r(3589),i=r(4049),o=r(3773),a=r(777);var s=function e(t){var r=new o(t),s=i(o.prototype.request,r);return n.extend(s,o.prototype,r),n.extend(s,r),s.create=function(r){return e(a(t,r))},s}(r(221));s.Axios=o,s.Cancel=r(9346),s.CancelToken=r(6857),s.isCancel=r(5517),s.VERSION=r(7600).version,s.all=function(e){return Promise.all(e)},s.spread=r(8089),s.isAxiosError=r(9580),e.exports=s,e.exports.default=s},9346:function(e){"use strict";function t(e){this.message=e}t.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},t.prototype.__CANCEL__=!0,e.exports=t},6857:function(e,t,r){"use strict";var n=r(9346);function i(e){if("function"!==typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var r=this;this.promise.then((function(e){if(r._listeners){var t,n=r._listeners.length;for(t=0;t<n;t++)r._listeners[t](e);r._listeners=null}})),this.promise.then=function(e){var t,n=new Promise((function(e){r.subscribe(e),t=e})).then(e);return n.cancel=function(){r.unsubscribe(t)},n},e((function(e){r.reason||(r.reason=new n(e),t(r.reason))}))}i.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},i.prototype.subscribe=function(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]},i.prototype.unsubscribe=function(e){if(this._listeners){var t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}},i.source=function(){var e;return{token:new i((function(t){e=t})),cancel:e}},e.exports=i},5517:function(e){"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},3773:function(e,t,r){"use strict";var n=r(3589),i=r(9774),o=r(7470),a=r(2733),s=r(777),u=r(7835),c=u.validators;function l(e){this.defaults=e,this.interceptors={request:new o,response:new o}}l.prototype.request=function(e,t){if("string"===typeof e?(t=t||{}).url=e:t=e||{},!t.url)throw new Error("Provided config url is not valid");(t=s(this.defaults,t)).method?t.method=t.method.toLowerCase():this.defaults.method?t.method=this.defaults.method.toLowerCase():t.method="get";var r=t.transitional;void 0!==r&&u.assertOptions(r,{silentJSONParsing:c.transitional(c.boolean),forcedJSONParsing:c.transitional(c.boolean),clarifyTimeoutError:c.transitional(c.boolean)},!1);var n=[],i=!0;this.interceptors.request.forEach((function(e){"function"===typeof e.runWhen&&!1===e.runWhen(t)||(i=i&&e.synchronous,n.unshift(e.fulfilled,e.rejected))}));var o,l=[];if(this.interceptors.response.forEach((function(e){l.push(e.fulfilled,e.rejected)})),!i){var h=[a,void 0];for(Array.prototype.unshift.apply(h,n),h=h.concat(l),o=Promise.resolve(t);h.length;)o=o.then(h.shift(),h.shift());return o}for(var f=t;n.length;){var d=n.shift(),p=n.shift();try{f=d(f)}catch(m){p(m);break}}try{o=a(f)}catch(m){return Promise.reject(m)}for(;l.length;)o=o.then(l.shift(),l.shift());return o},l.prototype.getUri=function(e){if(!e.url)throw new Error("Provided config url is not valid");return e=s(this.defaults,e),i(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},n.forEach(["delete","get","head","options"],(function(e){l.prototype[e]=function(t,r){return this.request(s(r||{},{method:e,url:t,data:(r||{}).data}))}})),n.forEach(["post","put","patch"],(function(e){l.prototype[e]=function(t,r,n){return this.request(s(n||{},{method:e,url:t,data:r}))}})),e.exports=l},7470:function(e,t,r){"use strict";var n=r(3589);function i(){this.handlers=[]}i.prototype.use=function(e,t,r){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!r&&r.synchronous,runWhen:r?r.runWhen:null}),this.handlers.length-1},i.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},i.prototype.forEach=function(e){n.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=i},1804:function(e,t,r){"use strict";var n=r(4044),i=r(9549);e.exports=function(e,t){return e&&!n(t)?i(e,t):t}},6467:function(e,t,r){"use strict";var n=r(6460);e.exports=function(e,t,r,i,o){var a=new Error(e);return n(a,t,r,i,o)}},2733:function(e,t,r){"use strict";var n=r(3589),i=r(2693),o=r(5517),a=r(221),s=r(9346);function u(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new s("canceled")}e.exports=function(e){return u(e),e.headers=e.headers||{},e.data=i.call(e,e.data,e.headers,e.transformRequest),e.headers=n.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),n.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||a.adapter)(e).then((function(t){return u(e),t.data=i.call(e,t.data,t.headers,e.transformResponse),t}),(function(t){return o(t)||(u(e),t&&t.response&&(t.response.data=i.call(e,t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},6460:function(e){"use strict";e.exports=function(e,t,r,n,i){return e.config=t,r&&(e.code=r),e.request=n,e.response=i,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}},e}},777:function(e,t,r){"use strict";var n=r(3589);e.exports=function(e,t){t=t||{};var r={};function i(e,t){return n.isPlainObject(e)&&n.isPlainObject(t)?n.merge(e,t):n.isPlainObject(t)?n.merge({},t):n.isArray(t)?t.slice():t}function o(r){return n.isUndefined(t[r])?n.isUndefined(e[r])?void 0:i(void 0,e[r]):i(e[r],t[r])}function a(e){if(!n.isUndefined(t[e]))return i(void 0,t[e])}function s(r){return n.isUndefined(t[r])?n.isUndefined(e[r])?void 0:i(void 0,e[r]):i(void 0,t[r])}function u(r){return r in t?i(e[r],t[r]):r in e?i(void 0,e[r]):void 0}var c={url:a,method:a,data:a,baseURL:s,transformRequest:s,transformResponse:s,paramsSerializer:s,timeout:s,timeoutMessage:s,withCredentials:s,adapter:s,responseType:s,xsrfCookieName:s,xsrfHeaderName:s,onUploadProgress:s,onDownloadProgress:s,decompress:s,maxContentLength:s,maxBodyLength:s,transport:s,httpAgent:s,httpsAgent:s,cancelToken:s,socketPath:s,responseEncoding:s,validateStatus:u};return n.forEach(Object.keys(e).concat(Object.keys(t)),(function(e){var t=c[e]||o,i=t(e);n.isUndefined(i)&&t!==u||(r[e]=i)})),r}},7297:function(e,t,r){"use strict";var n=r(6467);e.exports=function(e,t,r){var i=r.config.validateStatus;r.status&&i&&!i(r.status)?t(n("Request failed with status code "+r.status,r.config,null,r.request,r)):e(r)}},2693:function(e,t,r){"use strict";var n=r(3589),i=r(221);e.exports=function(e,t,r){var o=this||i;return n.forEach(r,(function(r){e=r.call(o,e,t)})),e}},221:function(e,t,r){"use strict";var n=r(1426),i=r(3589),o=r(4341),a=r(6460),s={"Content-Type":"application/x-www-form-urlencoded"};function u(e,t){!i.isUndefined(e)&&i.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var c={transitional:{silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},adapter:function(){var e;return("undefined"!==typeof XMLHttpRequest||"undefined"!==typeof n&&"[object process]"===Object.prototype.toString.call(n))&&(e=r(3381)),e}(),transformRequest:[function(e,t){return o(t,"Accept"),o(t,"Content-Type"),i.isFormData(e)||i.isArrayBuffer(e)||i.isBuffer(e)||i.isStream(e)||i.isFile(e)||i.isBlob(e)?e:i.isArrayBufferView(e)?e.buffer:i.isURLSearchParams(e)?(u(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):i.isObject(e)||t&&"application/json"===t["Content-Type"]?(u(t,"application/json"),function(e,t,r){if(i.isString(e))try{return(t||JSON.parse)(e),i.trim(e)}catch(n){if("SyntaxError"!==n.name)throw n}return(r||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){var t=this.transitional||c.transitional,r=t&&t.silentJSONParsing,n=t&&t.forcedJSONParsing,o=!r&&"json"===this.responseType;if(o||n&&i.isString(e)&&e.length)try{return JSON.parse(e)}catch(s){if(o){if("SyntaxError"===s.name)throw a(s,this,"E_JSON_PARSE");throw s}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};i.forEach(["delete","get","head"],(function(e){c.headers[e]={}})),i.forEach(["post","put","patch"],(function(e){c.headers[e]=i.merge(s)})),e.exports=c},7600:function(e){e.exports={version:"0.25.0"}},4049:function(e){"use strict";e.exports=function(e,t){return function(){for(var r=new Array(arguments.length),n=0;n<r.length;n++)r[n]=arguments[n];return e.apply(t,r)}}},9774:function(e,t,r){"use strict";var n=r(3589);function i(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,r){if(!t)return e;var o;if(r)o=r(t);else if(n.isURLSearchParams(t))o=t.toString();else{var a=[];n.forEach(t,(function(e,t){null!==e&&"undefined"!==typeof e&&(n.isArray(e)?t+="[]":e=[e],n.forEach(e,(function(e){n.isDate(e)?e=e.toISOString():n.isObject(e)&&(e=JSON.stringify(e)),a.push(i(t)+"="+i(e))})))})),o=a.join("&")}if(o){var s=e.indexOf("#");-1!==s&&(e=e.slice(0,s)),e+=(-1===e.indexOf("?")?"?":"&")+o}return e}},9549:function(e){"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},9301:function(e,t,r){"use strict";var n=r(3589);e.exports=n.isStandardBrowserEnv()?{write:function(e,t,r,i,o,a){var s=[];s.push(e+"="+encodeURIComponent(t)),n.isNumber(r)&&s.push("expires="+new Date(r).toGMTString()),n.isString(i)&&s.push("path="+i),n.isString(o)&&s.push("domain="+o),!0===a&&s.push("secure"),document.cookie=s.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},4044:function(e){"use strict";e.exports=function(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}},9580:function(e,t,r){"use strict";var n=r(3589);e.exports=function(e){return n.isObject(e)&&!0===e.isAxiosError}},5411:function(e,t,r){"use strict";var n=r(3589);e.exports=n.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a");function i(e){var n=e;return t&&(r.setAttribute("href",n),n=r.href),r.setAttribute("href",n),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:"/"===r.pathname.charAt(0)?r.pathname:"/"+r.pathname}}return e=i(window.location.href),function(t){var r=n.isString(t)?i(t):t;return r.protocol===e.protocol&&r.host===e.host}}():function(){return!0}},4341:function(e,t,r){"use strict";var n=r(3589);e.exports=function(e,t){n.forEach(e,(function(r,n){n!==t&&n.toUpperCase()===t.toUpperCase()&&(e[t]=r,delete e[n])}))}},9145:function(e,t,r){"use strict";var n=r(3589),i=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,r,o,a={};return e?(n.forEach(e.split("\n"),(function(e){if(o=e.indexOf(":"),t=n.trim(e.substr(0,o)).toLowerCase(),r=n.trim(e.substr(o+1)),t){if(a[t]&&i.indexOf(t)>=0)return;a[t]="set-cookie"===t?(a[t]?a[t]:[]).concat([r]):a[t]?a[t]+", "+r:r}})),a):a}},8089:function(e){"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},7835:function(e,t,r){"use strict";var n=r(7600).version,i={};["object","boolean","number","function","string","symbol"].forEach((function(e,t){i[e]=function(r){return typeof r===e||"a"+(t<1?"n ":" ")+e}}));var o={};i.transitional=function(e,t,r){function i(e,t){return"[Axios v"+n+"] Transitional option '"+e+"'"+t+(r?". "+r:"")}return function(r,n,a){if(!1===e)throw new Error(i(n," has been removed"+(t?" in "+t:"")));return t&&!o[n]&&(o[n]=!0,console.warn(i(n," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(r,n,a)}},e.exports={assertOptions:function(e,t,r){if("object"!==typeof e)throw new TypeError("options must be an object");for(var n=Object.keys(e),i=n.length;i-- >0;){var o=n[i],a=t[o];if(a){var s=e[o],u=void 0===s||a(s,o,e);if(!0!==u)throw new TypeError("option "+o+" must be "+u)}else if(!0!==r)throw Error("Unknown option "+o)}},validators:i}},3589:function(e,t,r){"use strict";var n=r(4049),i=Object.prototype.toString;function o(e){return Array.isArray(e)}function a(e){return"undefined"===typeof e}function s(e){return"[object ArrayBuffer]"===i.call(e)}function u(e){return null!==e&&"object"===typeof e}function c(e){if("[object Object]"!==i.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function l(e){return"[object Function]"===i.call(e)}function h(e,t){if(null!==e&&"undefined"!==typeof e)if("object"!==typeof e&&(e=[e]),o(e))for(var r=0,n=e.length;r<n;r++)t.call(null,e[r],r,e);else for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.call(null,e[i],i,e)}e.exports={isArray:o,isArrayBuffer:s,isBuffer:function(e){return null!==e&&!a(e)&&null!==e.constructor&&!a(e.constructor)&&"function"===typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"[object FormData]"===i.call(e)},isArrayBufferView:function(e){return"undefined"!==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&s(e.buffer)},isString:function(e){return"string"===typeof e},isNumber:function(e){return"number"===typeof e},isObject:u,isPlainObject:c,isUndefined:a,isDate:function(e){return"[object Date]"===i.call(e)},isFile:function(e){return"[object File]"===i.call(e)},isBlob:function(e){return"[object Blob]"===i.call(e)},isFunction:l,isStream:function(e){return u(e)&&l(e.pipe)},isURLSearchParams:function(e){return"[object URLSearchParams]"===i.call(e)},isStandardBrowserEnv:function(){return("undefined"===typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!==typeof window&&"undefined"!==typeof document)},forEach:h,merge:function e(){var t={};function r(r,n){c(t[n])&&c(r)?t[n]=e(t[n],r):c(r)?t[n]=e({},r):o(r)?t[n]=r.slice():t[n]=r}for(var n=0,i=arguments.length;n<i;n++)h(arguments[n],r);return t},extend:function(e,t,r){return h(t,(function(t,i){e[i]=r&&"function"===typeof t?n(t,r):t})),e},trim:function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},stripBOM:function(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e}}},2307:function(e,t,r){"use strict";var n=r(2543).Buffer;e.exports=function(e){if(e.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),r=0;r<t.length;r++)t[r]=255;for(var i=0;i<e.length;i++){var o=e.charAt(i),a=o.charCodeAt(0);if(255!==t[a])throw new TypeError(o+" is ambiguous");t[a]=i}var s=e.length,u=e.charAt(0),c=Math.log(s)/Math.log(256),l=Math.log(256)/Math.log(s);function h(e){if("string"!==typeof e)throw new TypeError("Expected String");if(0===e.length)return n.alloc(0);for(var r=0,i=0,o=0;e[r]===u;)i++,r++;for(var a=(e.length-r)*c+1>>>0,l=new Uint8Array(a);e[r];){var h=t[e.charCodeAt(r)];if(255===h)return;for(var f=0,d=a-1;(0!==h||f<o)&&-1!==d;d--,f++)h+=s*l[d]>>>0,l[d]=h%256>>>0,h=h/256>>>0;if(0!==h)throw new Error("Non-zero carry");o=f,r++}for(var p=a-o;p!==a&&0===l[p];)p++;var m=n.allocUnsafe(i+(a-p));m.fill(0,0,i);for(var g=i;p!==a;)m[g++]=l[p++];return m}return{encode:function(t){if((Array.isArray(t)||t instanceof Uint8Array)&&(t=n.from(t)),!n.isBuffer(t))throw new TypeError("Expected Buffer");if(0===t.length)return"";for(var r=0,i=0,o=0,a=t.length;o!==a&&0===t[o];)o++,r++;for(var c=(a-o)*l+1>>>0,h=new Uint8Array(c);o!==a;){for(var f=t[o],d=0,p=c-1;(0!==f||d<i)&&-1!==p;p--,d++)f+=256*h[p]>>>0,h[p]=f%s>>>0,f=f/s>>>0;if(0!==f)throw new Error("Non-zero carry");i=d,o++}for(var m=c-i;m!==c&&0===h[m];)m++;for(var g=u.repeat(r);m<c;++m)g+=e.charAt(h[m]);return g},decodeUnsafe:h,decode:function(e){var t=h(e);if(t)return t;throw new Error("Non-base"+s+" character")}}}},2009:function(e,t){"use strict";t.byteLength=function(e){var t=u(e),r=t[0],n=t[1];return 3*(r+n)/4-n},t.toByteArray=function(e){var t,r,o=u(e),a=o[0],s=o[1],c=new i(function(e,t,r){return 3*(t+r)/4-r}(0,a,s)),l=0,h=s>0?a-4:a;for(r=0;r<h;r+=4)t=n[e.charCodeAt(r)]<<18|n[e.charCodeAt(r+1)]<<12|n[e.charCodeAt(r+2)]<<6|n[e.charCodeAt(r+3)],c[l++]=t>>16&255,c[l++]=t>>8&255,c[l++]=255&t;2===s&&(t=n[e.charCodeAt(r)]<<2|n[e.charCodeAt(r+1)]>>4,c[l++]=255&t);1===s&&(t=n[e.charCodeAt(r)]<<10|n[e.charCodeAt(r+1)]<<4|n[e.charCodeAt(r+2)]>>2,c[l++]=t>>8&255,c[l++]=255&t);return c},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,o=[],a=16383,s=0,u=n-i;s<u;s+=a)o.push(c(e,s,s+a>u?u:s+a));1===i?(t=e[n-1],o.push(r[t>>2]+r[t<<4&63]+"==")):2===i&&(t=(e[n-2]<<8)+e[n-1],o.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"="));return o.join("")};for(var r=[],n=[],i="undefined"!==typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,s=o.length;a<s;++a)r[a]=o[a],n[o.charCodeAt(a)]=a;function u(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function c(e,t,n){for(var i,o,a=[],s=t;s<n;s+=3)i=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),a.push(r[(o=i)>>18&63]+r[o>>12&63]+r[o>>6&63]+r[63&o]);return a.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},6070:function(e,t,r){"use strict";var n=r(9778).Buffer;t.oU=function(e){var t=n.from(e);t.reverse();var r=t.toString("hex");return 0===r.length?BigInt(0):BigInt("0x".concat(r))},t.k$=function(e,t){var r=e.toString(16),i=n.from(r.padStart(2*t,"0").slice(0,2*t),"hex");return i.reverse(),i}},7144:function(e,t,r){var n;!function(i){"use strict";var o,a=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,s=Math.ceil,u=Math.floor,c="[BigNumber Error] ",l=c+"Number primitive has more than 15 significant digits: ",h=1e14,f=14,d=9007199254740991,p=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],m=1e7,g=1e9;function y(e){var t=0|e;return e>0||e===t?t:t-1}function v(e){for(var t,r,n=1,i=e.length,o=e[0]+"";n<i;){for(t=e[n++]+"",r=f-t.length;r--;t="0"+t);o+=t}for(i=o.length;48===o.charCodeAt(--i););return o.slice(0,i+1||1)}function _(e,t){var r,n,i=e.c,o=t.c,a=e.s,s=t.s,u=e.e,c=t.e;if(!a||!s)return null;if(r=i&&!i[0],n=o&&!o[0],r||n)return r?n?0:-s:a;if(a!=s)return a;if(r=a<0,n=u==c,!i||!o)return n?0:!i^r?1:-1;if(!n)return u>c^r?1:-1;for(s=(u=i.length)<(c=o.length)?u:c,a=0;a<s;a++)if(i[a]!=o[a])return i[a]>o[a]^r?1:-1;return u==c?0:u>c^r?1:-1}function b(e,t,r,n){if(e<t||e>r||e!==u(e))throw Error(c+(n||"Argument")+("number"==typeof e?e<t||e>r?" out of range: ":" not an integer: ":" not a primitive number: ")+String(e))}function x(e){var t=e.c.length-1;return y(e.e/f)==t&&e.c[t]%2!=0}function w(e,t){return(e.length>1?e.charAt(0)+"."+e.slice(1):e)+(t<0?"e":"e+")+t}function k(e,t,r){var n,i;if(t<0){for(i=r+".";++t;i+=r);e=i+e}else if(++t>(n=e.length)){for(i=r,t-=n;--t;i+=r);e+=i}else t<n&&(e=e.slice(0,t)+"."+e.slice(t));return e}o=function e(t){var r,n,i,o=z.prototype={constructor:z,toString:null,valueOf:null},A=new z(1),E=20,S=4,T=-7,M=21,I=-1e7,P=1e7,C=!1,B=1,D=0,R={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"\xa0",suffix:""},L="0123456789abcdefghijklmnopqrstuvwxyz",O=!0;function z(e,t){var r,o,s,c,h,p,m,g,y=this;if(!(y instanceof z))return new z(e,t);if(null==t){if(e&&!0===e._isBigNumber)return y.s=e.s,void(!e.c||e.e>P?y.c=y.e=null:e.e<I?y.c=[y.e=0]:(y.e=e.e,y.c=e.c.slice()));if((p="number"==typeof e)&&0*e==0){if(y.s=1/e<0?(e=-e,-1):1,e===~~e){for(c=0,h=e;h>=10;h/=10,c++);return void(c>P?y.c=y.e=null:(y.e=c,y.c=[e]))}g=String(e)}else{if(!a.test(g=String(e)))return i(y,g,p);y.s=45==g.charCodeAt(0)?(g=g.slice(1),-1):1}(c=g.indexOf("."))>-1&&(g=g.replace(".","")),(h=g.search(/e/i))>0?(c<0&&(c=h),c+=+g.slice(h+1),g=g.substring(0,h)):c<0&&(c=g.length)}else{if(b(t,2,L.length,"Base"),10==t&&O)return F(y=new z(e),E+y.e+1,S);if(g=String(e),p="number"==typeof e){if(0*e!=0)return i(y,g,p,t);if(y.s=1/e<0?(g=g.slice(1),-1):1,z.DEBUG&&g.replace(/^0\.0*|\./,"").length>15)throw Error(l+e)}else y.s=45===g.charCodeAt(0)?(g=g.slice(1),-1):1;for(r=L.slice(0,t),c=h=0,m=g.length;h<m;h++)if(r.indexOf(o=g.charAt(h))<0){if("."==o){if(h>c){c=m;continue}}else if(!s&&(g==g.toUpperCase()&&(g=g.toLowerCase())||g==g.toLowerCase()&&(g=g.toUpperCase()))){s=!0,h=-1,c=0;continue}return i(y,String(e),p,t)}p=!1,(c=(g=n(g,t,10,y.s)).indexOf("."))>-1?g=g.replace(".",""):c=g.length}for(h=0;48===g.charCodeAt(h);h++);for(m=g.length;48===g.charCodeAt(--m););if(g=g.slice(h,++m)){if(m-=h,p&&z.DEBUG&&m>15&&(e>d||e!==u(e)))throw Error(l+y.s*e);if((c=c-h-1)>P)y.c=y.e=null;else if(c<I)y.c=[y.e=0];else{if(y.e=c,y.c=[],h=(c+1)%f,c<0&&(h+=f),h<m){for(h&&y.c.push(+g.slice(0,h)),m-=f;h<m;)y.c.push(+g.slice(h,h+=f));h=f-(g=g.slice(h)).length}else h-=m;for(;h--;g+="0");y.c.push(+g)}}else y.c=[y.e=0]}function N(e,t,r,n){var i,o,a,s,u;if(null==r?r=S:b(r,0,8),!e.c)return e.toString();if(i=e.c[0],a=e.e,null==t)u=v(e.c),u=1==n||2==n&&(a<=T||a>=M)?w(u,a):k(u,a,"0");else if(o=(e=F(new z(e),t,r)).e,s=(u=v(e.c)).length,1==n||2==n&&(t<=o||o<=T)){for(;s<t;u+="0",s++);u=w(u,o)}else if(t-=a,u=k(u,o,"0"),o+1>s){if(--t>0)for(u+=".";t--;u+="0");}else if((t+=o-s)>0)for(o+1==s&&(u+=".");t--;u+="0");return e.s<0&&i?"-"+u:u}function U(e,t){for(var r,n=1,i=new z(e[0]);n<e.length;n++){if(!(r=new z(e[n])).s){i=r;break}t.call(i,r)&&(i=r)}return i}function Z(e,t,r){for(var n=1,i=t.length;!t[--i];t.pop());for(i=t[0];i>=10;i/=10,n++);return(r=n+r*f-1)>P?e.c=e.e=null:r<I?e.c=[e.e=0]:(e.e=r,e.c=t),e}function F(e,t,r,n){var i,o,a,c,l,d,m,g=e.c,y=p;if(g){e:{for(i=1,c=g[0];c>=10;c/=10,i++);if((o=t-i)<0)o+=f,a=t,m=(l=g[d=0])/y[i-a-1]%10|0;else if((d=s((o+1)/f))>=g.length){if(!n)break e;for(;g.length<=d;g.push(0));l=m=0,i=1,a=(o%=f)-f+1}else{for(l=c=g[d],i=1;c>=10;c/=10,i++);m=(a=(o%=f)-f+i)<0?0:l/y[i-a-1]%10|0}if(n=n||t<0||null!=g[d+1]||(a<0?l:l%y[i-a-1]),n=r<4?(m||n)&&(0==r||r==(e.s<0?3:2)):m>5||5==m&&(4==r||n||6==r&&(o>0?a>0?l/y[i-a]:0:g[d-1])%10&1||r==(e.s<0?8:7)),t<1||!g[0])return g.length=0,n?(t-=e.e+1,g[0]=y[(f-t%f)%f],e.e=-t||0):g[0]=e.e=0,e;if(0==o?(g.length=d,c=1,d--):(g.length=d+1,c=y[f-o],g[d]=a>0?u(l/y[i-a]%y[a])*c:0),n)for(;;){if(0==d){for(o=1,a=g[0];a>=10;a/=10,o++);for(a=g[0]+=c,c=1;a>=10;a/=10,c++);o!=c&&(e.e++,g[0]==h&&(g[0]=1));break}if(g[d]+=c,g[d]!=h)break;g[d--]=0,c=1}for(o=g.length;0===g[--o];g.pop());}e.e>P?e.c=e.e=null:e.e<I&&(e.c=[e.e=0])}return e}function j(e){var t,r=e.e;return null===r?e.toString():(t=v(e.c),t=r<=T||r>=M?w(t,r):k(t,r,"0"),e.s<0?"-"+t:t)}return z.clone=e,z.ROUND_UP=0,z.ROUND_DOWN=1,z.ROUND_CEIL=2,z.ROUND_FLOOR=3,z.ROUND_HALF_UP=4,z.ROUND_HALF_DOWN=5,z.ROUND_HALF_EVEN=6,z.ROUND_HALF_CEIL=7,z.ROUND_HALF_FLOOR=8,z.EUCLID=9,z.config=z.set=function(e){var t,r;if(null!=e){if("object"!=typeof e)throw Error(c+"Object expected: "+e);if(e.hasOwnProperty(t="DECIMAL_PLACES")&&(b(r=e[t],0,g,t),E=r),e.hasOwnProperty(t="ROUNDING_MODE")&&(b(r=e[t],0,8,t),S=r),e.hasOwnProperty(t="EXPONENTIAL_AT")&&((r=e[t])&&r.pop?(b(r[0],-g,0,t),b(r[1],0,g,t),T=r[0],M=r[1]):(b(r,-g,g,t),T=-(M=r<0?-r:r))),e.hasOwnProperty(t="RANGE"))if((r=e[t])&&r.pop)b(r[0],-g,-1,t),b(r[1],1,g,t),I=r[0],P=r[1];else{if(b(r,-g,g,t),!r)throw Error(c+t+" cannot be zero: "+r);I=-(P=r<0?-r:r)}if(e.hasOwnProperty(t="CRYPTO")){if((r=e[t])!==!!r)throw Error(c+t+" not true or false: "+r);if(r){if("undefined"==typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw C=!r,Error(c+"crypto unavailable");C=r}else C=r}if(e.hasOwnProperty(t="MODULO_MODE")&&(b(r=e[t],0,9,t),B=r),e.hasOwnProperty(t="POW_PRECISION")&&(b(r=e[t],0,g,t),D=r),e.hasOwnProperty(t="FORMAT")){if("object"!=typeof(r=e[t]))throw Error(c+t+" not an object: "+r);R=r}if(e.hasOwnProperty(t="ALPHABET")){if("string"!=typeof(r=e[t])||/^.?$|[+\-.\s]|(.).*\1/.test(r))throw Error(c+t+" invalid: "+r);O="0123456789"==r.slice(0,10),L=r}}return{DECIMAL_PLACES:E,ROUNDING_MODE:S,EXPONENTIAL_AT:[T,M],RANGE:[I,P],CRYPTO:C,MODULO_MODE:B,POW_PRECISION:D,FORMAT:R,ALPHABET:L}},z.isBigNumber=function(e){if(!e||!0!==e._isBigNumber)return!1;if(!z.DEBUG)return!0;var t,r,n=e.c,i=e.e,o=e.s;e:if("[object Array]"=={}.toString.call(n)){if((1===o||-1===o)&&i>=-g&&i<=g&&i===u(i)){if(0===n[0]){if(0===i&&1===n.length)return!0;break e}if((t=(i+1)%f)<1&&(t+=f),String(n[0]).length==t){for(t=0;t<n.length;t++)if((r=n[t])<0||r>=h||r!==u(r))break e;if(0!==r)return!0}}}else if(null===n&&null===i&&(null===o||1===o||-1===o))return!0;throw Error(c+"Invalid BigNumber: "+e)},z.maximum=z.max=function(){return U(arguments,o.lt)},z.minimum=z.min=function(){return U(arguments,o.gt)},z.random=function(){var e=9007199254740992,t=Math.random()*e&2097151?function(){return u(Math.random()*e)}:function(){return 8388608*(1073741824*Math.random()|0)+(8388608*Math.random()|0)};return function(e){var r,n,i,o,a,l=0,h=[],d=new z(A);if(null==e?e=E:b(e,0,g),o=s(e/f),C)if(crypto.getRandomValues){for(r=crypto.getRandomValues(new Uint32Array(o*=2));l<o;)(a=131072*r[l]+(r[l+1]>>>11))>=9e15?(n=crypto.getRandomValues(new Uint32Array(2)),r[l]=n[0],r[l+1]=n[1]):(h.push(a%1e14),l+=2);l=o/2}else{if(!crypto.randomBytes)throw C=!1,Error(c+"crypto unavailable");for(r=crypto.randomBytes(o*=7);l<o;)(a=281474976710656*(31&r[l])+1099511627776*r[l+1]+4294967296*r[l+2]+16777216*r[l+3]+(r[l+4]<<16)+(r[l+5]<<8)+r[l+6])>=9e15?crypto.randomBytes(7).copy(r,l):(h.push(a%1e14),l+=7);l=o/7}if(!C)for(;l<o;)(a=t())<9e15&&(h[l++]=a%1e14);for(o=h[--l],e%=f,o&&e&&(a=p[f-e],h[l]=u(o/a)*a);0===h[l];h.pop(),l--);if(l<0)h=[i=0];else{for(i=-1;0===h[0];h.splice(0,1),i-=f);for(l=1,a=h[0];a>=10;a/=10,l++);l<f&&(i-=f-l)}return d.e=i,d.c=h,d}}(),z.sum=function(){for(var e=1,t=arguments,r=new z(t[0]);e<t.length;)r=r.plus(t[e++]);return r},n=function(){var e="0123456789";function t(e,t,r,n){for(var i,o,a=[0],s=0,u=e.length;s<u;){for(o=a.length;o--;a[o]*=t);for(a[0]+=n.indexOf(e.charAt(s++)),i=0;i<a.length;i++)a[i]>r-1&&(null==a[i+1]&&(a[i+1]=0),a[i+1]+=a[i]/r|0,a[i]%=r)}return a.reverse()}return function(n,i,o,a,s){var u,c,l,h,f,d,p,m,g=n.indexOf("."),y=E,_=S;for(g>=0&&(h=D,D=0,n=n.replace(".",""),d=(m=new z(i)).pow(n.length-g),D=h,m.c=t(k(v(d.c),d.e,"0"),10,o,e),m.e=m.c.length),l=h=(p=t(n,i,o,s?(u=L,e):(u=e,L))).length;0==p[--h];p.pop());if(!p[0])return u.charAt(0);if(g<0?--l:(d.c=p,d.e=l,d.s=a,p=(d=r(d,m,y,_,o)).c,f=d.r,l=d.e),g=p[c=l+y+1],h=o/2,f=f||c<0||null!=p[c+1],f=_<4?(null!=g||f)&&(0==_||_==(d.s<0?3:2)):g>h||g==h&&(4==_||f||6==_&&1&p[c-1]||_==(d.s<0?8:7)),c<1||!p[0])n=f?k(u.charAt(1),-y,u.charAt(0)):u.charAt(0);else{if(p.length=c,f)for(--o;++p[--c]>o;)p[c]=0,c||(++l,p=[1].concat(p));for(h=p.length;!p[--h];);for(g=0,n="";g<=h;n+=u.charAt(p[g++]));n=k(n,l,u.charAt(0))}return n}}(),r=function(){function e(e,t,r){var n,i,o,a,s=0,u=e.length,c=t%m,l=t/m|0;for(e=e.slice();u--;)s=((i=c*(o=e[u]%m)+(n=l*o+(a=e[u]/m|0)*c)%m*m+s)/r|0)+(n/m|0)+l*a,e[u]=i%r;return s&&(e=[s].concat(e)),e}function t(e,t,r,n){var i,o;if(r!=n)o=r>n?1:-1;else for(i=o=0;i<r;i++)if(e[i]!=t[i]){o=e[i]>t[i]?1:-1;break}return o}function r(e,t,r,n){for(var i=0;r--;)e[r]-=i,i=e[r]<t[r]?1:0,e[r]=i*n+e[r]-t[r];for(;!e[0]&&e.length>1;e.splice(0,1));}return function(n,i,o,a,s){var c,l,d,p,m,g,v,_,b,x,w,k,A,E,S,T,M,I=n.s==i.s?1:-1,P=n.c,C=i.c;if(!P||!P[0]||!C||!C[0])return new z(n.s&&i.s&&(P?!C||P[0]!=C[0]:C)?P&&0==P[0]||!C?0*I:I/0:NaN);for(b=(_=new z(I)).c=[],I=o+(l=n.e-i.e)+1,s||(s=h,l=y(n.e/f)-y(i.e/f),I=I/f|0),d=0;C[d]==(P[d]||0);d++);if(C[d]>(P[d]||0)&&l--,I<0)b.push(1),p=!0;else{for(E=P.length,T=C.length,d=0,I+=2,(m=u(s/(C[0]+1)))>1&&(C=e(C,m,s),P=e(P,m,s),T=C.length,E=P.length),A=T,w=(x=P.slice(0,T)).length;w<T;x[w++]=0);M=C.slice(),M=[0].concat(M),S=C[0],C[1]>=s/2&&S++;do{if(m=0,(c=t(C,x,T,w))<0){if(k=x[0],T!=w&&(k=k*s+(x[1]||0)),(m=u(k/S))>1)for(m>=s&&(m=s-1),v=(g=e(C,m,s)).length,w=x.length;1==t(g,x,v,w);)m--,r(g,T<v?M:C,v,s),v=g.length,c=1;else 0==m&&(c=m=1),v=(g=C.slice()).length;if(v<w&&(g=[0].concat(g)),r(x,g,w,s),w=x.length,-1==c)for(;t(C,x,T,w)<1;)m++,r(x,T<w?M:C,w,s),w=x.length}else 0===c&&(m++,x=[0]);b[d++]=m,x[0]?x[w++]=P[A]||0:(x=[P[A]],w=1)}while((A++<E||null!=x[0])&&I--);p=null!=x[0],b[0]||b.splice(0,1)}if(s==h){for(d=1,I=b[0];I>=10;I/=10,d++);F(_,o+(_.e=d+l*f-1)+1,a,p)}else _.e=l,_.r=+p;return _}}(),i=function(){var e=/^(-?)0([xbo])(?=\w[\w.]*$)/i,t=/^([^.]+)\.$/,r=/^\.([^.]+)$/,n=/^-?(Infinity|NaN)$/,i=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(o,a,s,u){var l,h=s?a:a.replace(i,"");if(n.test(h))o.s=isNaN(h)?null:h<0?-1:1;else{if(!s&&(h=h.replace(e,(function(e,t,r){return l="x"==(r=r.toLowerCase())?16:"b"==r?2:8,u&&u!=l?e:t})),u&&(l=u,h=h.replace(t,"$1").replace(r,"0.$1")),a!=h))return new z(h,l);if(z.DEBUG)throw Error(c+"Not a"+(u?" base "+u:"")+" number: "+a);o.s=null}o.c=o.e=null}}(),o.absoluteValue=o.abs=function(){var e=new z(this);return e.s<0&&(e.s=1),e},o.comparedTo=function(e,t){return _(this,new z(e,t))},o.decimalPlaces=o.dp=function(e,t){var r,n,i,o=this;if(null!=e)return b(e,0,g),null==t?t=S:b(t,0,8),F(new z(o),e+o.e+1,t);if(!(r=o.c))return null;if(n=((i=r.length-1)-y(this.e/f))*f,i=r[i])for(;i%10==0;i/=10,n--);return n<0&&(n=0),n},o.dividedBy=o.div=function(e,t){return r(this,new z(e,t),E,S)},o.dividedToIntegerBy=o.idiv=function(e,t){return r(this,new z(e,t),0,1)},o.exponentiatedBy=o.pow=function(e,t){var r,n,i,o,a,l,h,d,p=this;if((e=new z(e)).c&&!e.isInteger())throw Error(c+"Exponent not an integer: "+j(e));if(null!=t&&(t=new z(t)),a=e.e>14,!p.c||!p.c[0]||1==p.c[0]&&!p.e&&1==p.c.length||!e.c||!e.c[0])return d=new z(Math.pow(+j(p),a?e.s*(2-x(e)):+j(e))),t?d.mod(t):d;if(l=e.s<0,t){if(t.c?!t.c[0]:!t.s)return new z(NaN);(n=!l&&p.isInteger()&&t.isInteger())&&(p=p.mod(t))}else{if(e.e>9&&(p.e>0||p.e<-1||(0==p.e?p.c[0]>1||a&&p.c[1]>=24e7:p.c[0]<8e13||a&&p.c[0]<=9999975e7)))return o=p.s<0&&x(e)?-0:0,p.e>-1&&(o=1/o),new z(l?1/o:o);D&&(o=s(D/f+2))}for(a?(r=new z(.5),l&&(e.s=1),h=x(e)):h=(i=Math.abs(+j(e)))%2,d=new z(A);;){if(h){if(!(d=d.times(p)).c)break;o?d.c.length>o&&(d.c.length=o):n&&(d=d.mod(t))}if(i){if(0===(i=u(i/2)))break;h=i%2}else if(F(e=e.times(r),e.e+1,1),e.e>14)h=x(e);else{if(0===(i=+j(e)))break;h=i%2}p=p.times(p),o?p.c&&p.c.length>o&&(p.c.length=o):n&&(p=p.mod(t))}return n?d:(l&&(d=A.div(d)),t?d.mod(t):o?F(d,D,S,undefined):d)},o.integerValue=function(e){var t=new z(this);return null==e?e=S:b(e,0,8),F(t,t.e+1,e)},o.isEqualTo=o.eq=function(e,t){return 0===_(this,new z(e,t))},o.isFinite=function(){return!!this.c},o.isGreaterThan=o.gt=function(e,t){return _(this,new z(e,t))>0},o.isGreaterThanOrEqualTo=o.gte=function(e,t){return 1===(t=_(this,new z(e,t)))||0===t},o.isInteger=function(){return!!this.c&&y(this.e/f)>this.c.length-2},o.isLessThan=o.lt=function(e,t){return _(this,new z(e,t))<0},o.isLessThanOrEqualTo=o.lte=function(e,t){return-1===(t=_(this,new z(e,t)))||0===t},o.isNaN=function(){return!this.s},o.isNegative=function(){return this.s<0},o.isPositive=function(){return this.s>0},o.isZero=function(){return!!this.c&&0==this.c[0]},o.minus=function(e,t){var r,n,i,o,a=this,s=a.s;if(t=(e=new z(e,t)).s,!s||!t)return new z(NaN);if(s!=t)return e.s=-t,a.plus(e);var u=a.e/f,c=e.e/f,l=a.c,d=e.c;if(!u||!c){if(!l||!d)return l?(e.s=-t,e):new z(d?a:NaN);if(!l[0]||!d[0])return d[0]?(e.s=-t,e):new z(l[0]?a:3==S?-0:0)}if(u=y(u),c=y(c),l=l.slice(),s=u-c){for((o=s<0)?(s=-s,i=l):(c=u,i=d),i.reverse(),t=s;t--;i.push(0));i.reverse()}else for(n=(o=(s=l.length)<(t=d.length))?s:t,s=t=0;t<n;t++)if(l[t]!=d[t]){o=l[t]<d[t];break}if(o&&(i=l,l=d,d=i,e.s=-e.s),(t=(n=d.length)-(r=l.length))>0)for(;t--;l[r++]=0);for(t=h-1;n>s;){if(l[--n]<d[n]){for(r=n;r&&!l[--r];l[r]=t);--l[r],l[n]+=h}l[n]-=d[n]}for(;0==l[0];l.splice(0,1),--c);return l[0]?Z(e,l,c):(e.s=3==S?-1:1,e.c=[e.e=0],e)},o.modulo=o.mod=function(e,t){var n,i,o=this;return e=new z(e,t),!o.c||!e.s||e.c&&!e.c[0]?new z(NaN):!e.c||o.c&&!o.c[0]?new z(o):(9==B?(i=e.s,e.s=1,n=r(o,e,0,3),e.s=i,n.s*=i):n=r(o,e,0,B),(e=o.minus(n.times(e))).c[0]||1!=B||(e.s=o.s),e)},o.multipliedBy=o.times=function(e,t){var r,n,i,o,a,s,u,c,l,d,p,g,v,_,b,x=this,w=x.c,k=(e=new z(e,t)).c;if(!w||!k||!w[0]||!k[0])return!x.s||!e.s||w&&!w[0]&&!k||k&&!k[0]&&!w?e.c=e.e=e.s=null:(e.s*=x.s,w&&k?(e.c=[0],e.e=0):e.c=e.e=null),e;for(n=y(x.e/f)+y(e.e/f),e.s*=x.s,(u=w.length)<(d=k.length)&&(v=w,w=k,k=v,i=u,u=d,d=i),i=u+d,v=[];i--;v.push(0));for(_=h,b=m,i=d;--i>=0;){for(r=0,p=k[i]%b,g=k[i]/b|0,o=i+(a=u);o>i;)r=((c=p*(c=w[--a]%b)+(s=g*c+(l=w[a]/b|0)*p)%b*b+v[o]+r)/_|0)+(s/b|0)+g*l,v[o--]=c%_;v[o]=r}return r?++n:v.splice(0,1),Z(e,v,n)},o.negated=function(){var e=new z(this);return e.s=-e.s||null,e},o.plus=function(e,t){var r,n=this,i=n.s;if(t=(e=new z(e,t)).s,!i||!t)return new z(NaN);if(i!=t)return e.s=-t,n.minus(e);var o=n.e/f,a=e.e/f,s=n.c,u=e.c;if(!o||!a){if(!s||!u)return new z(i/0);if(!s[0]||!u[0])return u[0]?e:new z(s[0]?n:0*i)}if(o=y(o),a=y(a),s=s.slice(),i=o-a){for(i>0?(a=o,r=u):(i=-i,r=s),r.reverse();i--;r.push(0));r.reverse()}for((i=s.length)-(t=u.length)<0&&(r=u,u=s,s=r,t=i),i=0;t;)i=(s[--t]=s[t]+u[t]+i)/h|0,s[t]=h===s[t]?0:s[t]%h;return i&&(s=[i].concat(s),++a),Z(e,s,a)},o.precision=o.sd=function(e,t){var r,n,i,o=this;if(null!=e&&e!==!!e)return b(e,1,g),null==t?t=S:b(t,0,8),F(new z(o),e,t);if(!(r=o.c))return null;if(n=(i=r.length-1)*f+1,i=r[i]){for(;i%10==0;i/=10,n--);for(i=r[0];i>=10;i/=10,n++);}return e&&o.e+1>n&&(n=o.e+1),n},o.shiftedBy=function(e){return b(e,-d,d),this.times("1e"+e)},o.squareRoot=o.sqrt=function(){var e,t,n,i,o,a=this,s=a.c,u=a.s,c=a.e,l=E+4,h=new z("0.5");if(1!==u||!s||!s[0])return new z(!u||u<0&&(!s||s[0])?NaN:s?a:1/0);if(0==(u=Math.sqrt(+j(a)))||u==1/0?(((t=v(s)).length+c)%2==0&&(t+="0"),u=Math.sqrt(+t),c=y((c+1)/2)-(c<0||c%2),n=new z(t=u==1/0?"5e"+c:(t=u.toExponential()).slice(0,t.indexOf("e")+1)+c)):n=new z(u+""),n.c[0])for((u=(c=n.e)+l)<3&&(u=0);;)if(o=n,n=h.times(o.plus(r(a,o,l,1))),v(o.c).slice(0,u)===(t=v(n.c)).slice(0,u)){if(n.e<c&&--u,"9999"!=(t=t.slice(u-3,u+1))&&(i||"4999"!=t)){+t&&(+t.slice(1)||"5"!=t.charAt(0))||(F(n,n.e+E+2,1),e=!n.times(n).eq(a));break}if(!i&&(F(o,o.e+E+2,0),o.times(o).eq(a))){n=o;break}l+=4,u+=4,i=1}return F(n,n.e+E+1,S,e)},o.toExponential=function(e,t){return null!=e&&(b(e,0,g),e++),N(this,e,t,1)},o.toFixed=function(e,t){return null!=e&&(b(e,0,g),e=e+this.e+1),N(this,e,t)},o.toFormat=function(e,t,r){var n,i=this;if(null==r)null!=e&&t&&"object"==typeof t?(r=t,t=null):e&&"object"==typeof e?(r=e,e=t=null):r=R;else if("object"!=typeof r)throw Error(c+"Argument not an object: "+r);if(n=i.toFixed(e,t),i.c){var o,a=n.split("."),s=+r.groupSize,u=+r.secondaryGroupSize,l=r.groupSeparator||"",h=a[0],f=a[1],d=i.s<0,p=d?h.slice(1):h,m=p.length;if(u&&(o=s,s=u,u=o,m-=o),s>0&&m>0){for(o=m%s||s,h=p.substr(0,o);o<m;o+=s)h+=l+p.substr(o,s);u>0&&(h+=l+p.slice(o)),d&&(h="-"+h)}n=f?h+(r.decimalSeparator||"")+((u=+r.fractionGroupSize)?f.replace(new RegExp("\\d{"+u+"}\\B","g"),"$&"+(r.fractionGroupSeparator||"")):f):h}return(r.prefix||"")+n+(r.suffix||"")},o.toFraction=function(e){var t,n,i,o,a,s,u,l,h,d,m,g,y=this,_=y.c;if(null!=e&&(!(u=new z(e)).isInteger()&&(u.c||1!==u.s)||u.lt(A)))throw Error(c+"Argument "+(u.isInteger()?"out of range: ":"not an integer: ")+j(u));if(!_)return new z(y);for(t=new z(A),h=n=new z(A),i=l=new z(A),g=v(_),a=t.e=g.length-y.e-1,t.c[0]=p[(s=a%f)<0?f+s:s],e=!e||u.comparedTo(t)>0?a>0?t:h:u,s=P,P=1/0,u=new z(g),l.c[0]=0;d=r(u,t,0,1),1!=(o=n.plus(d.times(i))).comparedTo(e);)n=i,i=o,h=l.plus(d.times(o=h)),l=o,t=u.minus(d.times(o=t)),u=o;return o=r(e.minus(n),i,0,1),l=l.plus(o.times(h)),n=n.plus(o.times(i)),l.s=h.s=y.s,m=r(h,i,a*=2,S).minus(y).abs().comparedTo(r(l,n,a,S).minus(y).abs())<1?[h,i]:[l,n],P=s,m},o.toNumber=function(){return+j(this)},o.toPrecision=function(e,t){return null!=e&&b(e,1,g),N(this,e,t,2)},o.toString=function(e){var t,r=this,i=r.s,o=r.e;return null===o?i?(t="Infinity",i<0&&(t="-"+t)):t="NaN":(null==e?t=o<=T||o>=M?w(v(r.c),o):k(v(r.c),o,"0"):10===e&&O?t=k(v((r=F(new z(r),E+o+1,S)).c),r.e,"0"):(b(e,2,L.length,"Base"),t=n(k(v(r.c),o,"0"),10,e,i,!0)),i<0&&r.c[0]&&(t="-"+t)),t},o.valueOf=o.toJSON=function(){return j(this)},o._isBigNumber=!0,null!=t&&z.set(t),z}(),o.default=o.BigNumber=o,void 0===(n=function(){return o}.call(t,r,t,e))||(e.exports=n)}()},518:function(e,t,r){!function(e,t){"use strict";function n(e,t){if(!e)throw new Error(t||"Assertion failed")}function i(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}function o(e,t,r){if(o.isBN(e))return e;this.negative=0,this.words=null,this.length=0,this.red=null,null!==e&&("le"!==t&&"be"!==t||(r=t,t=10),this._init(e||0,t||10,r||"be"))}var a;"object"===typeof e?e.exports=o:t.BN=o,o.BN=o,o.wordSize=26;try{a="undefined"!==typeof window&&"undefined"!==typeof window.Buffer?window.Buffer:r(6601).Buffer}catch(M){}function s(e,t){var r=e.charCodeAt(t);return r>=48&&r<=57?r-48:r>=65&&r<=70?r-55:r>=97&&r<=102?r-87:void n(!1,"Invalid character in "+e)}function u(e,t,r){var n=s(e,r);return r-1>=t&&(n|=s(e,r-1)<<4),n}function c(e,t,r,i){for(var o=0,a=0,s=Math.min(e.length,r),u=t;u<s;u++){var c=e.charCodeAt(u)-48;o*=i,a=c>=49?c-49+10:c>=17?c-17+10:c,n(c>=0&&a<i,"Invalid character"),o+=a}return o}function l(e,t){e.words=t.words,e.length=t.length,e.negative=t.negative,e.red=t.red}if(o.isBN=function(e){return e instanceof o||null!==e&&"object"===typeof e&&e.constructor.wordSize===o.wordSize&&Array.isArray(e.words)},o.max=function(e,t){return e.cmp(t)>0?e:t},o.min=function(e,t){return e.cmp(t)<0?e:t},o.prototype._init=function(e,t,r){if("number"===typeof e)return this._initNumber(e,t,r);if("object"===typeof e)return this._initArray(e,t,r);"hex"===t&&(t=16),n(t===(0|t)&&t>=2&&t<=36);var i=0;"-"===(e=e.toString().replace(/\s+/g,""))[0]&&(i++,this.negative=1),i<e.length&&(16===t?this._parseHex(e,i,r):(this._parseBase(e,t,i),"le"===r&&this._initArray(this.toArray(),t,r)))},o.prototype._initNumber=function(e,t,r){e<0&&(this.negative=1,e=-e),e<67108864?(this.words=[67108863&e],this.length=1):e<4503599627370496?(this.words=[67108863&e,e/67108864&67108863],this.length=2):(n(e<9007199254740992),this.words=[67108863&e,e/67108864&67108863,1],this.length=3),"le"===r&&this._initArray(this.toArray(),t,r)},o.prototype._initArray=function(e,t,r){if(n("number"===typeof e.length),e.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(e.length/3),this.words=new Array(this.length);for(var i=0;i<this.length;i++)this.words[i]=0;var o,a,s=0;if("be"===r)for(i=e.length-1,o=0;i>=0;i-=3)a=e[i]|e[i-1]<<8|e[i-2]<<16,this.words[o]|=a<<s&67108863,this.words[o+1]=a>>>26-s&67108863,(s+=24)>=26&&(s-=26,o++);else if("le"===r)for(i=0,o=0;i<e.length;i+=3)a=e[i]|e[i+1]<<8|e[i+2]<<16,this.words[o]|=a<<s&67108863,this.words[o+1]=a>>>26-s&67108863,(s+=24)>=26&&(s-=26,o++);return this._strip()},o.prototype._parseHex=function(e,t,r){this.length=Math.ceil((e.length-t)/6),this.words=new Array(this.length);for(var n=0;n<this.length;n++)this.words[n]=0;var i,o=0,a=0;if("be"===r)for(n=e.length-1;n>=t;n-=2)i=u(e,t,n)<<o,this.words[a]|=67108863&i,o>=18?(o-=18,a+=1,this.words[a]|=i>>>26):o+=8;else for(n=(e.length-t)%2===0?t+1:t;n<e.length;n+=2)i=u(e,t,n)<<o,this.words[a]|=67108863&i,o>=18?(o-=18,a+=1,this.words[a]|=i>>>26):o+=8;this._strip()},o.prototype._parseBase=function(e,t,r){this.words=[0],this.length=1;for(var n=0,i=1;i<=67108863;i*=t)n++;n--,i=i/t|0;for(var o=e.length-r,a=o%n,s=Math.min(o,o-a)+r,u=0,l=r;l<s;l+=n)u=c(e,l,l+n,t),this.imuln(i),this.words[0]+u<67108864?this.words[0]+=u:this._iaddn(u);if(0!==a){var h=1;for(u=c(e,l,e.length,t),l=0;l<a;l++)h*=t;this.imuln(h),this.words[0]+u<67108864?this.words[0]+=u:this._iaddn(u)}this._strip()},o.prototype.copy=function(e){e.words=new Array(this.length);for(var t=0;t<this.length;t++)e.words[t]=this.words[t];e.length=this.length,e.negative=this.negative,e.red=this.red},o.prototype._move=function(e){l(e,this)},o.prototype.clone=function(){var e=new o(null);return this.copy(e),e},o.prototype._expand=function(e){for(;this.length<e;)this.words[this.length++]=0;return this},o.prototype._strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},o.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},"undefined"!==typeof Symbol&&"function"===typeof Symbol.for)try{o.prototype[Symbol.for("nodejs.util.inspect.custom")]=h}catch(M){o.prototype.inspect=h}else o.prototype.inspect=h;function h(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var f=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],d=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],p=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];o.prototype.toString=function(e,t){var r;if(t=0|t||1,16===(e=e||10)||"hex"===e){r="";for(var i=0,o=0,a=0;a<this.length;a++){var s=this.words[a],u=(16777215&(s<<i|o)).toString(16);o=s>>>24-i&16777215,(i+=2)>=26&&(i-=26,a--),r=0!==o||a!==this.length-1?f[6-u.length]+u+r:u+r}for(0!==o&&(r=o.toString(16)+r);r.length%t!==0;)r="0"+r;return 0!==this.negative&&(r="-"+r),r}if(e===(0|e)&&e>=2&&e<=36){var c=d[e],l=p[e];r="";var h=this.clone();for(h.negative=0;!h.isZero();){var m=h.modrn(l).toString(e);r=(h=h.idivn(l)).isZero()?m+r:f[c-m.length]+m+r}for(this.isZero()&&(r="0"+r);r.length%t!==0;)r="0"+r;return 0!==this.negative&&(r="-"+r),r}n(!1,"Base should be between 2 and 36")},o.prototype.toNumber=function(){var e=this.words[0];return 2===this.length?e+=67108864*this.words[1]:3===this.length&&1===this.words[2]?e+=4503599627370496+67108864*this.words[1]:this.length>2&&n(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-e:e},o.prototype.toJSON=function(){return this.toString(16,2)},a&&(o.prototype.toBuffer=function(e,t){return this.toArrayLike(a,e,t)}),o.prototype.toArray=function(e,t){return this.toArrayLike(Array,e,t)};function m(e,t,r){r.negative=t.negative^e.negative;var n=e.length+t.length|0;r.length=n,n=n-1|0;var i=0|e.words[0],o=0|t.words[0],a=i*o,s=67108863&a,u=a/67108864|0;r.words[0]=s;for(var c=1;c<n;c++){for(var l=u>>>26,h=67108863&u,f=Math.min(c,t.length-1),d=Math.max(0,c-e.length+1);d<=f;d++){var p=c-d|0;l+=(a=(i=0|e.words[p])*(o=0|t.words[d])+h)/67108864|0,h=67108863&a}r.words[c]=0|h,u=0|l}return 0!==u?r.words[c]=0|u:r.length--,r._strip()}o.prototype.toArrayLike=function(e,t,r){this._strip();var i=this.byteLength(),o=r||Math.max(1,i);n(i<=o,"byte array longer than desired length"),n(o>0,"Requested array length <= 0");var a=function(e,t){return e.allocUnsafe?e.allocUnsafe(t):new e(t)}(e,o);return this["_toArrayLike"+("le"===t?"LE":"BE")](a,i),a},o.prototype._toArrayLikeLE=function(e,t){for(var r=0,n=0,i=0,o=0;i<this.length;i++){var a=this.words[i]<<o|n;e[r++]=255&a,r<e.length&&(e[r++]=a>>8&255),r<e.length&&(e[r++]=a>>16&255),6===o?(r<e.length&&(e[r++]=a>>24&255),n=0,o=0):(n=a>>>24,o+=2)}if(r<e.length)for(e[r++]=n;r<e.length;)e[r++]=0},o.prototype._toArrayLikeBE=function(e,t){for(var r=e.length-1,n=0,i=0,o=0;i<this.length;i++){var a=this.words[i]<<o|n;e[r--]=255&a,r>=0&&(e[r--]=a>>8&255),r>=0&&(e[r--]=a>>16&255),6===o?(r>=0&&(e[r--]=a>>24&255),n=0,o=0):(n=a>>>24,o+=2)}if(r>=0)for(e[r--]=n;r>=0;)e[r--]=0},Math.clz32?o.prototype._countBits=function(e){return 32-Math.clz32(e)}:o.prototype._countBits=function(e){var t=e,r=0;return t>=4096&&(r+=13,t>>>=13),t>=64&&(r+=7,t>>>=7),t>=8&&(r+=4,t>>>=4),t>=2&&(r+=2,t>>>=2),r+t},o.prototype._zeroBits=function(e){if(0===e)return 26;var t=e,r=0;return 0===(8191&t)&&(r+=13,t>>>=13),0===(127&t)&&(r+=7,t>>>=7),0===(15&t)&&(r+=4,t>>>=4),0===(3&t)&&(r+=2,t>>>=2),0===(1&t)&&r++,r},o.prototype.bitLength=function(){var e=this.words[this.length-1],t=this._countBits(e);return 26*(this.length-1)+t},o.prototype.zeroBits=function(){if(this.isZero())return 0;for(var e=0,t=0;t<this.length;t++){var r=this._zeroBits(this.words[t]);if(e+=r,26!==r)break}return e},o.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},o.prototype.toTwos=function(e){return 0!==this.negative?this.abs().inotn(e).iaddn(1):this.clone()},o.prototype.fromTwos=function(e){return this.testn(e-1)?this.notn(e).iaddn(1).ineg():this.clone()},o.prototype.isNeg=function(){return 0!==this.negative},o.prototype.neg=function(){return this.clone().ineg()},o.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},o.prototype.iuor=function(e){for(;this.length<e.length;)this.words[this.length++]=0;for(var t=0;t<e.length;t++)this.words[t]=this.words[t]|e.words[t];return this._strip()},o.prototype.ior=function(e){return n(0===(this.negative|e.negative)),this.iuor(e)},o.prototype.or=function(e){return this.length>e.length?this.clone().ior(e):e.clone().ior(this)},o.prototype.uor=function(e){return this.length>e.length?this.clone().iuor(e):e.clone().iuor(this)},o.prototype.iuand=function(e){var t;t=this.length>e.length?e:this;for(var r=0;r<t.length;r++)this.words[r]=this.words[r]&e.words[r];return this.length=t.length,this._strip()},o.prototype.iand=function(e){return n(0===(this.negative|e.negative)),this.iuand(e)},o.prototype.and=function(e){return this.length>e.length?this.clone().iand(e):e.clone().iand(this)},o.prototype.uand=function(e){return this.length>e.length?this.clone().iuand(e):e.clone().iuand(this)},o.prototype.iuxor=function(e){var t,r;this.length>e.length?(t=this,r=e):(t=e,r=this);for(var n=0;n<r.length;n++)this.words[n]=t.words[n]^r.words[n];if(this!==t)for(;n<t.length;n++)this.words[n]=t.words[n];return this.length=t.length,this._strip()},o.prototype.ixor=function(e){return n(0===(this.negative|e.negative)),this.iuxor(e)},o.prototype.xor=function(e){return this.length>e.length?this.clone().ixor(e):e.clone().ixor(this)},o.prototype.uxor=function(e){return this.length>e.length?this.clone().iuxor(e):e.clone().iuxor(this)},o.prototype.inotn=function(e){n("number"===typeof e&&e>=0);var t=0|Math.ceil(e/26),r=e%26;this._expand(t),r>0&&t--;for(var i=0;i<t;i++)this.words[i]=67108863&~this.words[i];return r>0&&(this.words[i]=~this.words[i]&67108863>>26-r),this._strip()},o.prototype.notn=function(e){return this.clone().inotn(e)},o.prototype.setn=function(e,t){n("number"===typeof e&&e>=0);var r=e/26|0,i=e%26;return this._expand(r+1),this.words[r]=t?this.words[r]|1<<i:this.words[r]&~(1<<i),this._strip()},o.prototype.iadd=function(e){var t,r,n;if(0!==this.negative&&0===e.negative)return this.negative=0,t=this.isub(e),this.negative^=1,this._normSign();if(0===this.negative&&0!==e.negative)return e.negative=0,t=this.isub(e),e.negative=1,t._normSign();this.length>e.length?(r=this,n=e):(r=e,n=this);for(var i=0,o=0;o<n.length;o++)t=(0|r.words[o])+(0|n.words[o])+i,this.words[o]=67108863&t,i=t>>>26;for(;0!==i&&o<r.length;o++)t=(0|r.words[o])+i,this.words[o]=67108863&t,i=t>>>26;if(this.length=r.length,0!==i)this.words[this.length]=i,this.length++;else if(r!==this)for(;o<r.length;o++)this.words[o]=r.words[o];return this},o.prototype.add=function(e){var t;return 0!==e.negative&&0===this.negative?(e.negative=0,t=this.sub(e),e.negative^=1,t):0===e.negative&&0!==this.negative?(this.negative=0,t=e.sub(this),this.negative=1,t):this.length>e.length?this.clone().iadd(e):e.clone().iadd(this)},o.prototype.isub=function(e){if(0!==e.negative){e.negative=0;var t=this.iadd(e);return e.negative=1,t._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(e),this.negative=1,this._normSign();var r,n,i=this.cmp(e);if(0===i)return this.negative=0,this.length=1,this.words[0]=0,this;i>0?(r=this,n=e):(r=e,n=this);for(var o=0,a=0;a<n.length;a++)o=(t=(0|r.words[a])-(0|n.words[a])+o)>>26,this.words[a]=67108863&t;for(;0!==o&&a<r.length;a++)o=(t=(0|r.words[a])+o)>>26,this.words[a]=67108863&t;if(0===o&&a<r.length&&r!==this)for(;a<r.length;a++)this.words[a]=r.words[a];return this.length=Math.max(this.length,a),r!==this&&(this.negative=1),this._strip()},o.prototype.sub=function(e){return this.clone().isub(e)};var g=function(e,t,r){var n,i,o,a=e.words,s=t.words,u=r.words,c=0,l=0|a[0],h=8191&l,f=l>>>13,d=0|a[1],p=8191&d,m=d>>>13,g=0|a[2],y=8191&g,v=g>>>13,_=0|a[3],b=8191&_,x=_>>>13,w=0|a[4],k=8191&w,A=w>>>13,E=0|a[5],S=8191&E,T=E>>>13,M=0|a[6],I=8191&M,P=M>>>13,C=0|a[7],B=8191&C,D=C>>>13,R=0|a[8],L=8191&R,O=R>>>13,z=0|a[9],N=8191&z,U=z>>>13,Z=0|s[0],F=8191&Z,j=Z>>>13,V=0|s[1],W=8191&V,K=V>>>13,G=0|s[2],H=8191&G,q=G>>>13,Y=0|s[3],X=8191&Y,Q=Y>>>13,$=0|s[4],J=8191&$,ee=$>>>13,te=0|s[5],re=8191&te,ne=te>>>13,ie=0|s[6],oe=8191&ie,ae=ie>>>13,se=0|s[7],ue=8191&se,ce=se>>>13,le=0|s[8],he=8191&le,fe=le>>>13,de=0|s[9],pe=8191&de,me=de>>>13;r.negative=e.negative^t.negative,r.length=19;var ge=(c+(n=Math.imul(h,F))|0)+((8191&(i=(i=Math.imul(h,j))+Math.imul(f,F)|0))<<13)|0;c=((o=Math.imul(f,j))+(i>>>13)|0)+(ge>>>26)|0,ge&=67108863,n=Math.imul(p,F),i=(i=Math.imul(p,j))+Math.imul(m,F)|0,o=Math.imul(m,j);var ye=(c+(n=n+Math.imul(h,W)|0)|0)+((8191&(i=(i=i+Math.imul(h,K)|0)+Math.imul(f,W)|0))<<13)|0;c=((o=o+Math.imul(f,K)|0)+(i>>>13)|0)+(ye>>>26)|0,ye&=67108863,n=Math.imul(y,F),i=(i=Math.imul(y,j))+Math.imul(v,F)|0,o=Math.imul(v,j),n=n+Math.imul(p,W)|0,i=(i=i+Math.imul(p,K)|0)+Math.imul(m,W)|0,o=o+Math.imul(m,K)|0;var ve=(c+(n=n+Math.imul(h,H)|0)|0)+((8191&(i=(i=i+Math.imul(h,q)|0)+Math.imul(f,H)|0))<<13)|0;c=((o=o+Math.imul(f,q)|0)+(i>>>13)|0)+(ve>>>26)|0,ve&=67108863,n=Math.imul(b,F),i=(i=Math.imul(b,j))+Math.imul(x,F)|0,o=Math.imul(x,j),n=n+Math.imul(y,W)|0,i=(i=i+Math.imul(y,K)|0)+Math.imul(v,W)|0,o=o+Math.imul(v,K)|0,n=n+Math.imul(p,H)|0,i=(i=i+Math.imul(p,q)|0)+Math.imul(m,H)|0,o=o+Math.imul(m,q)|0;var _e=(c+(n=n+Math.imul(h,X)|0)|0)+((8191&(i=(i=i+Math.imul(h,Q)|0)+Math.imul(f,X)|0))<<13)|0;c=((o=o+Math.imul(f,Q)|0)+(i>>>13)|0)+(_e>>>26)|0,_e&=67108863,n=Math.imul(k,F),i=(i=Math.imul(k,j))+Math.imul(A,F)|0,o=Math.imul(A,j),n=n+Math.imul(b,W)|0,i=(i=i+Math.imul(b,K)|0)+Math.imul(x,W)|0,o=o+Math.imul(x,K)|0,n=n+Math.imul(y,H)|0,i=(i=i+Math.imul(y,q)|0)+Math.imul(v,H)|0,o=o+Math.imul(v,q)|0,n=n+Math.imul(p,X)|0,i=(i=i+Math.imul(p,Q)|0)+Math.imul(m,X)|0,o=o+Math.imul(m,Q)|0;var be=(c+(n=n+Math.imul(h,J)|0)|0)+((8191&(i=(i=i+Math.imul(h,ee)|0)+Math.imul(f,J)|0))<<13)|0;c=((o=o+Math.imul(f,ee)|0)+(i>>>13)|0)+(be>>>26)|0,be&=67108863,n=Math.imul(S,F),i=(i=Math.imul(S,j))+Math.imul(T,F)|0,o=Math.imul(T,j),n=n+Math.imul(k,W)|0,i=(i=i+Math.imul(k,K)|0)+Math.imul(A,W)|0,o=o+Math.imul(A,K)|0,n=n+Math.imul(b,H)|0,i=(i=i+Math.imul(b,q)|0)+Math.imul(x,H)|0,o=o+Math.imul(x,q)|0,n=n+Math.imul(y,X)|0,i=(i=i+Math.imul(y,Q)|0)+Math.imul(v,X)|0,o=o+Math.imul(v,Q)|0,n=n+Math.imul(p,J)|0,i=(i=i+Math.imul(p,ee)|0)+Math.imul(m,J)|0,o=o+Math.imul(m,ee)|0;var xe=(c+(n=n+Math.imul(h,re)|0)|0)+((8191&(i=(i=i+Math.imul(h,ne)|0)+Math.imul(f,re)|0))<<13)|0;c=((o=o+Math.imul(f,ne)|0)+(i>>>13)|0)+(xe>>>26)|0,xe&=67108863,n=Math.imul(I,F),i=(i=Math.imul(I,j))+Math.imul(P,F)|0,o=Math.imul(P,j),n=n+Math.imul(S,W)|0,i=(i=i+Math.imul(S,K)|0)+Math.imul(T,W)|0,o=o+Math.imul(T,K)|0,n=n+Math.imul(k,H)|0,i=(i=i+Math.imul(k,q)|0)+Math.imul(A,H)|0,o=o+Math.imul(A,q)|0,n=n+Math.imul(b,X)|0,i=(i=i+Math.imul(b,Q)|0)+Math.imul(x,X)|0,o=o+Math.imul(x,Q)|0,n=n+Math.imul(y,J)|0,i=(i=i+Math.imul(y,ee)|0)+Math.imul(v,J)|0,o=o+Math.imul(v,ee)|0,n=n+Math.imul(p,re)|0,i=(i=i+Math.imul(p,ne)|0)+Math.imul(m,re)|0,o=o+Math.imul(m,ne)|0;var we=(c+(n=n+Math.imul(h,oe)|0)|0)+((8191&(i=(i=i+Math.imul(h,ae)|0)+Math.imul(f,oe)|0))<<13)|0;c=((o=o+Math.imul(f,ae)|0)+(i>>>13)|0)+(we>>>26)|0,we&=67108863,n=Math.imul(B,F),i=(i=Math.imul(B,j))+Math.imul(D,F)|0,o=Math.imul(D,j),n=n+Math.imul(I,W)|0,i=(i=i+Math.imul(I,K)|0)+Math.imul(P,W)|0,o=o+Math.imul(P,K)|0,n=n+Math.imul(S,H)|0,i=(i=i+Math.imul(S,q)|0)+Math.imul(T,H)|0,o=o+Math.imul(T,q)|0,n=n+Math.imul(k,X)|0,i=(i=i+Math.imul(k,Q)|0)+Math.imul(A,X)|0,o=o+Math.imul(A,Q)|0,n=n+Math.imul(b,J)|0,i=(i=i+Math.imul(b,ee)|0)+Math.imul(x,J)|0,o=o+Math.imul(x,ee)|0,n=n+Math.imul(y,re)|0,i=(i=i+Math.imul(y,ne)|0)+Math.imul(v,re)|0,o=o+Math.imul(v,ne)|0,n=n+Math.imul(p,oe)|0,i=(i=i+Math.imul(p,ae)|0)+Math.imul(m,oe)|0,o=o+Math.imul(m,ae)|0;var ke=(c+(n=n+Math.imul(h,ue)|0)|0)+((8191&(i=(i=i+Math.imul(h,ce)|0)+Math.imul(f,ue)|0))<<13)|0;c=((o=o+Math.imul(f,ce)|0)+(i>>>13)|0)+(ke>>>26)|0,ke&=67108863,n=Math.imul(L,F),i=(i=Math.imul(L,j))+Math.imul(O,F)|0,o=Math.imul(O,j),n=n+Math.imul(B,W)|0,i=(i=i+Math.imul(B,K)|0)+Math.imul(D,W)|0,o=o+Math.imul(D,K)|0,n=n+Math.imul(I,H)|0,i=(i=i+Math.imul(I,q)|0)+Math.imul(P,H)|0,o=o+Math.imul(P,q)|0,n=n+Math.imul(S,X)|0,i=(i=i+Math.imul(S,Q)|0)+Math.imul(T,X)|0,o=o+Math.imul(T,Q)|0,n=n+Math.imul(k,J)|0,i=(i=i+Math.imul(k,ee)|0)+Math.imul(A,J)|0,o=o+Math.imul(A,ee)|0,n=n+Math.imul(b,re)|0,i=(i=i+Math.imul(b,ne)|0)+Math.imul(x,re)|0,o=o+Math.imul(x,ne)|0,n=n+Math.imul(y,oe)|0,i=(i=i+Math.imul(y,ae)|0)+Math.imul(v,oe)|0,o=o+Math.imul(v,ae)|0,n=n+Math.imul(p,ue)|0,i=(i=i+Math.imul(p,ce)|0)+Math.imul(m,ue)|0,o=o+Math.imul(m,ce)|0;var Ae=(c+(n=n+Math.imul(h,he)|0)|0)+((8191&(i=(i=i+Math.imul(h,fe)|0)+Math.imul(f,he)|0))<<13)|0;c=((o=o+Math.imul(f,fe)|0)+(i>>>13)|0)+(Ae>>>26)|0,Ae&=67108863,n=Math.imul(N,F),i=(i=Math.imul(N,j))+Math.imul(U,F)|0,o=Math.imul(U,j),n=n+Math.imul(L,W)|0,i=(i=i+Math.imul(L,K)|0)+Math.imul(O,W)|0,o=o+Math.imul(O,K)|0,n=n+Math.imul(B,H)|0,i=(i=i+Math.imul(B,q)|0)+Math.imul(D,H)|0,o=o+Math.imul(D,q)|0,n=n+Math.imul(I,X)|0,i=(i=i+Math.imul(I,Q)|0)+Math.imul(P,X)|0,o=o+Math.imul(P,Q)|0,n=n+Math.imul(S,J)|0,i=(i=i+Math.imul(S,ee)|0)+Math.imul(T,J)|0,o=o+Math.imul(T,ee)|0,n=n+Math.imul(k,re)|0,i=(i=i+Math.imul(k,ne)|0)+Math.imul(A,re)|0,o=o+Math.imul(A,ne)|0,n=n+Math.imul(b,oe)|0,i=(i=i+Math.imul(b,ae)|0)+Math.imul(x,oe)|0,o=o+Math.imul(x,ae)|0,n=n+Math.imul(y,ue)|0,i=(i=i+Math.imul(y,ce)|0)+Math.imul(v,ue)|0,o=o+Math.imul(v,ce)|0,n=n+Math.imul(p,he)|0,i=(i=i+Math.imul(p,fe)|0)+Math.imul(m,he)|0,o=o+Math.imul(m,fe)|0;var Ee=(c+(n=n+Math.imul(h,pe)|0)|0)+((8191&(i=(i=i+Math.imul(h,me)|0)+Math.imul(f,pe)|0))<<13)|0;c=((o=o+Math.imul(f,me)|0)+(i>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,n=Math.imul(N,W),i=(i=Math.imul(N,K))+Math.imul(U,W)|0,o=Math.imul(U,K),n=n+Math.imul(L,H)|0,i=(i=i+Math.imul(L,q)|0)+Math.imul(O,H)|0,o=o+Math.imul(O,q)|0,n=n+Math.imul(B,X)|0,i=(i=i+Math.imul(B,Q)|0)+Math.imul(D,X)|0,o=o+Math.imul(D,Q)|0,n=n+Math.imul(I,J)|0,i=(i=i+Math.imul(I,ee)|0)+Math.imul(P,J)|0,o=o+Math.imul(P,ee)|0,n=n+Math.imul(S,re)|0,i=(i=i+Math.imul(S,ne)|0)+Math.imul(T,re)|0,o=o+Math.imul(T,ne)|0,n=n+Math.imul(k,oe)|0,i=(i=i+Math.imul(k,ae)|0)+Math.imul(A,oe)|0,o=o+Math.imul(A,ae)|0,n=n+Math.imul(b,ue)|0,i=(i=i+Math.imul(b,ce)|0)+Math.imul(x,ue)|0,o=o+Math.imul(x,ce)|0,n=n+Math.imul(y,he)|0,i=(i=i+Math.imul(y,fe)|0)+Math.imul(v,he)|0,o=o+Math.imul(v,fe)|0;var Se=(c+(n=n+Math.imul(p,pe)|0)|0)+((8191&(i=(i=i+Math.imul(p,me)|0)+Math.imul(m,pe)|0))<<13)|0;c=((o=o+Math.imul(m,me)|0)+(i>>>13)|0)+(Se>>>26)|0,Se&=67108863,n=Math.imul(N,H),i=(i=Math.imul(N,q))+Math.imul(U,H)|0,o=Math.imul(U,q),n=n+Math.imul(L,X)|0,i=(i=i+Math.imul(L,Q)|0)+Math.imul(O,X)|0,o=o+Math.imul(O,Q)|0,n=n+Math.imul(B,J)|0,i=(i=i+Math.imul(B,ee)|0)+Math.imul(D,J)|0,o=o+Math.imul(D,ee)|0,n=n+Math.imul(I,re)|0,i=(i=i+Math.imul(I,ne)|0)+Math.imul(P,re)|0,o=o+Math.imul(P,ne)|0,n=n+Math.imul(S,oe)|0,i=(i=i+Math.imul(S,ae)|0)+Math.imul(T,oe)|0,o=o+Math.imul(T,ae)|0,n=n+Math.imul(k,ue)|0,i=(i=i+Math.imul(k,ce)|0)+Math.imul(A,ue)|0,o=o+Math.imul(A,ce)|0,n=n+Math.imul(b,he)|0,i=(i=i+Math.imul(b,fe)|0)+Math.imul(x,he)|0,o=o+Math.imul(x,fe)|0;var Te=(c+(n=n+Math.imul(y,pe)|0)|0)+((8191&(i=(i=i+Math.imul(y,me)|0)+Math.imul(v,pe)|0))<<13)|0;c=((o=o+Math.imul(v,me)|0)+(i>>>13)|0)+(Te>>>26)|0,Te&=67108863,n=Math.imul(N,X),i=(i=Math.imul(N,Q))+Math.imul(U,X)|0,o=Math.imul(U,Q),n=n+Math.imul(L,J)|0,i=(i=i+Math.imul(L,ee)|0)+Math.imul(O,J)|0,o=o+Math.imul(O,ee)|0,n=n+Math.imul(B,re)|0,i=(i=i+Math.imul(B,ne)|0)+Math.imul(D,re)|0,o=o+Math.imul(D,ne)|0,n=n+Math.imul(I,oe)|0,i=(i=i+Math.imul(I,ae)|0)+Math.imul(P,oe)|0,o=o+Math.imul(P,ae)|0,n=n+Math.imul(S,ue)|0,i=(i=i+Math.imul(S,ce)|0)+Math.imul(T,ue)|0,o=o+Math.imul(T,ce)|0,n=n+Math.imul(k,he)|0,i=(i=i+Math.imul(k,fe)|0)+Math.imul(A,he)|0,o=o+Math.imul(A,fe)|0;var Me=(c+(n=n+Math.imul(b,pe)|0)|0)+((8191&(i=(i=i+Math.imul(b,me)|0)+Math.imul(x,pe)|0))<<13)|0;c=((o=o+Math.imul(x,me)|0)+(i>>>13)|0)+(Me>>>26)|0,Me&=67108863,n=Math.imul(N,J),i=(i=Math.imul(N,ee))+Math.imul(U,J)|0,o=Math.imul(U,ee),n=n+Math.imul(L,re)|0,i=(i=i+Math.imul(L,ne)|0)+Math.imul(O,re)|0,o=o+Math.imul(O,ne)|0,n=n+Math.imul(B,oe)|0,i=(i=i+Math.imul(B,ae)|0)+Math.imul(D,oe)|0,o=o+Math.imul(D,ae)|0,n=n+Math.imul(I,ue)|0,i=(i=i+Math.imul(I,ce)|0)+Math.imul(P,ue)|0,o=o+Math.imul(P,ce)|0,n=n+Math.imul(S,he)|0,i=(i=i+Math.imul(S,fe)|0)+Math.imul(T,he)|0,o=o+Math.imul(T,fe)|0;var Ie=(c+(n=n+Math.imul(k,pe)|0)|0)+((8191&(i=(i=i+Math.imul(k,me)|0)+Math.imul(A,pe)|0))<<13)|0;c=((o=o+Math.imul(A,me)|0)+(i>>>13)|0)+(Ie>>>26)|0,Ie&=67108863,n=Math.imul(N,re),i=(i=Math.imul(N,ne))+Math.imul(U,re)|0,o=Math.imul(U,ne),n=n+Math.imul(L,oe)|0,i=(i=i+Math.imul(L,ae)|0)+Math.imul(O,oe)|0,o=o+Math.imul(O,ae)|0,n=n+Math.imul(B,ue)|0,i=(i=i+Math.imul(B,ce)|0)+Math.imul(D,ue)|0,o=o+Math.imul(D,ce)|0,n=n+Math.imul(I,he)|0,i=(i=i+Math.imul(I,fe)|0)+Math.imul(P,he)|0,o=o+Math.imul(P,fe)|0;var Pe=(c+(n=n+Math.imul(S,pe)|0)|0)+((8191&(i=(i=i+Math.imul(S,me)|0)+Math.imul(T,pe)|0))<<13)|0;c=((o=o+Math.imul(T,me)|0)+(i>>>13)|0)+(Pe>>>26)|0,Pe&=67108863,n=Math.imul(N,oe),i=(i=Math.imul(N,ae))+Math.imul(U,oe)|0,o=Math.imul(U,ae),n=n+Math.imul(L,ue)|0,i=(i=i+Math.imul(L,ce)|0)+Math.imul(O,ue)|0,o=o+Math.imul(O,ce)|0,n=n+Math.imul(B,he)|0,i=(i=i+Math.imul(B,fe)|0)+Math.imul(D,he)|0,o=o+Math.imul(D,fe)|0;var Ce=(c+(n=n+Math.imul(I,pe)|0)|0)+((8191&(i=(i=i+Math.imul(I,me)|0)+Math.imul(P,pe)|0))<<13)|0;c=((o=o+Math.imul(P,me)|0)+(i>>>13)|0)+(Ce>>>26)|0,Ce&=67108863,n=Math.imul(N,ue),i=(i=Math.imul(N,ce))+Math.imul(U,ue)|0,o=Math.imul(U,ce),n=n+Math.imul(L,he)|0,i=(i=i+Math.imul(L,fe)|0)+Math.imul(O,he)|0,o=o+Math.imul(O,fe)|0;var Be=(c+(n=n+Math.imul(B,pe)|0)|0)+((8191&(i=(i=i+Math.imul(B,me)|0)+Math.imul(D,pe)|0))<<13)|0;c=((o=o+Math.imul(D,me)|0)+(i>>>13)|0)+(Be>>>26)|0,Be&=67108863,n=Math.imul(N,he),i=(i=Math.imul(N,fe))+Math.imul(U,he)|0,o=Math.imul(U,fe);var De=(c+(n=n+Math.imul(L,pe)|0)|0)+((8191&(i=(i=i+Math.imul(L,me)|0)+Math.imul(O,pe)|0))<<13)|0;c=((o=o+Math.imul(O,me)|0)+(i>>>13)|0)+(De>>>26)|0,De&=67108863;var Re=(c+(n=Math.imul(N,pe))|0)+((8191&(i=(i=Math.imul(N,me))+Math.imul(U,pe)|0))<<13)|0;return c=((o=Math.imul(U,me))+(i>>>13)|0)+(Re>>>26)|0,Re&=67108863,u[0]=ge,u[1]=ye,u[2]=ve,u[3]=_e,u[4]=be,u[5]=xe,u[6]=we,u[7]=ke,u[8]=Ae,u[9]=Ee,u[10]=Se,u[11]=Te,u[12]=Me,u[13]=Ie,u[14]=Pe,u[15]=Ce,u[16]=Be,u[17]=De,u[18]=Re,0!==c&&(u[19]=c,r.length++),r};function y(e,t,r){r.negative=t.negative^e.negative,r.length=e.length+t.length;for(var n=0,i=0,o=0;o<r.length-1;o++){var a=i;i=0;for(var s=67108863&n,u=Math.min(o,t.length-1),c=Math.max(0,o-e.length+1);c<=u;c++){var l=o-c,h=(0|e.words[l])*(0|t.words[c]),f=67108863&h;s=67108863&(f=f+s|0),i+=(a=(a=a+(h/67108864|0)|0)+(f>>>26)|0)>>>26,a&=67108863}r.words[o]=s,n=a,a=i}return 0!==n?r.words[o]=n:r.length--,r._strip()}function v(e,t,r){return y(e,t,r)}function _(e,t){this.x=e,this.y=t}Math.imul||(g=m),o.prototype.mulTo=function(e,t){var r=this.length+e.length;return 10===this.length&&10===e.length?g(this,e,t):r<63?m(this,e,t):r<1024?y(this,e,t):v(this,e,t)},_.prototype.makeRBT=function(e){for(var t=new Array(e),r=o.prototype._countBits(e)-1,n=0;n<e;n++)t[n]=this.revBin(n,r,e);return t},_.prototype.revBin=function(e,t,r){if(0===e||e===r-1)return e;for(var n=0,i=0;i<t;i++)n|=(1&e)<<t-i-1,e>>=1;return n},_.prototype.permute=function(e,t,r,n,i,o){for(var a=0;a<o;a++)n[a]=t[e[a]],i[a]=r[e[a]]},_.prototype.transform=function(e,t,r,n,i,o){this.permute(o,e,t,r,n,i);for(var a=1;a<i;a<<=1)for(var s=a<<1,u=Math.cos(2*Math.PI/s),c=Math.sin(2*Math.PI/s),l=0;l<i;l+=s)for(var h=u,f=c,d=0;d<a;d++){var p=r[l+d],m=n[l+d],g=r[l+d+a],y=n[l+d+a],v=h*g-f*y;y=h*y+f*g,g=v,r[l+d]=p+g,n[l+d]=m+y,r[l+d+a]=p-g,n[l+d+a]=m-y,d!==s&&(v=u*h-c*f,f=u*f+c*h,h=v)}},_.prototype.guessLen13b=function(e,t){var r=1|Math.max(t,e),n=1&r,i=0;for(r=r/2|0;r;r>>>=1)i++;return 1<<i+1+n},_.prototype.conjugate=function(e,t,r){if(!(r<=1))for(var n=0;n<r/2;n++){var i=e[n];e[n]=e[r-n-1],e[r-n-1]=i,i=t[n],t[n]=-t[r-n-1],t[r-n-1]=-i}},_.prototype.normalize13b=function(e,t){for(var r=0,n=0;n<t/2;n++){var i=8192*Math.round(e[2*n+1]/t)+Math.round(e[2*n]/t)+r;e[n]=67108863&i,r=i<67108864?0:i/67108864|0}return e},_.prototype.convert13b=function(e,t,r,i){for(var o=0,a=0;a<t;a++)o+=0|e[a],r[2*a]=8191&o,o>>>=13,r[2*a+1]=8191&o,o>>>=13;for(a=2*t;a<i;++a)r[a]=0;n(0===o),n(0===(-8192&o))},_.prototype.stub=function(e){for(var t=new Array(e),r=0;r<e;r++)t[r]=0;return t},_.prototype.mulp=function(e,t,r){var n=2*this.guessLen13b(e.length,t.length),i=this.makeRBT(n),o=this.stub(n),a=new Array(n),s=new Array(n),u=new Array(n),c=new Array(n),l=new Array(n),h=new Array(n),f=r.words;f.length=n,this.convert13b(e.words,e.length,a,n),this.convert13b(t.words,t.length,c,n),this.transform(a,o,s,u,n,i),this.transform(c,o,l,h,n,i);for(var d=0;d<n;d++){var p=s[d]*l[d]-u[d]*h[d];u[d]=s[d]*h[d]+u[d]*l[d],s[d]=p}return this.conjugate(s,u,n),this.transform(s,u,f,o,n,i),this.conjugate(f,o,n),this.normalize13b(f,n),r.negative=e.negative^t.negative,r.length=e.length+t.length,r._strip()},o.prototype.mul=function(e){var t=new o(null);return t.words=new Array(this.length+e.length),this.mulTo(e,t)},o.prototype.mulf=function(e){var t=new o(null);return t.words=new Array(this.length+e.length),v(this,e,t)},o.prototype.imul=function(e){return this.clone().mulTo(e,this)},o.prototype.imuln=function(e){var t=e<0;t&&(e=-e),n("number"===typeof e),n(e<67108864);for(var r=0,i=0;i<this.length;i++){var o=(0|this.words[i])*e,a=(67108863&o)+(67108863&r);r>>=26,r+=o/67108864|0,r+=a>>>26,this.words[i]=67108863&a}return 0!==r&&(this.words[i]=r,this.length++),t?this.ineg():this},o.prototype.muln=function(e){return this.clone().imuln(e)},o.prototype.sqr=function(){return this.mul(this)},o.prototype.isqr=function(){return this.imul(this.clone())},o.prototype.pow=function(e){var t=function(e){for(var t=new Array(e.bitLength()),r=0;r<t.length;r++){var n=r/26|0,i=r%26;t[r]=e.words[n]>>>i&1}return t}(e);if(0===t.length)return new o(1);for(var r=this,n=0;n<t.length&&0===t[n];n++,r=r.sqr());if(++n<t.length)for(var i=r.sqr();n<t.length;n++,i=i.sqr())0!==t[n]&&(r=r.mul(i));return r},o.prototype.iushln=function(e){n("number"===typeof e&&e>=0);var t,r=e%26,i=(e-r)/26,o=67108863>>>26-r<<26-r;if(0!==r){var a=0;for(t=0;t<this.length;t++){var s=this.words[t]&o,u=(0|this.words[t])-s<<r;this.words[t]=u|a,a=s>>>26-r}a&&(this.words[t]=a,this.length++)}if(0!==i){for(t=this.length-1;t>=0;t--)this.words[t+i]=this.words[t];for(t=0;t<i;t++)this.words[t]=0;this.length+=i}return this._strip()},o.prototype.ishln=function(e){return n(0===this.negative),this.iushln(e)},o.prototype.iushrn=function(e,t,r){var i;n("number"===typeof e&&e>=0),i=t?(t-t%26)/26:0;var o=e%26,a=Math.min((e-o)/26,this.length),s=67108863^67108863>>>o<<o,u=r;if(i-=a,i=Math.max(0,i),u){for(var c=0;c<a;c++)u.words[c]=this.words[c];u.length=a}if(0===a);else if(this.length>a)for(this.length-=a,c=0;c<this.length;c++)this.words[c]=this.words[c+a];else this.words[0]=0,this.length=1;var l=0;for(c=this.length-1;c>=0&&(0!==l||c>=i);c--){var h=0|this.words[c];this.words[c]=l<<26-o|h>>>o,l=h&s}return u&&0!==l&&(u.words[u.length++]=l),0===this.length&&(this.words[0]=0,this.length=1),this._strip()},o.prototype.ishrn=function(e,t,r){return n(0===this.negative),this.iushrn(e,t,r)},o.prototype.shln=function(e){return this.clone().ishln(e)},o.prototype.ushln=function(e){return this.clone().iushln(e)},o.prototype.shrn=function(e){return this.clone().ishrn(e)},o.prototype.ushrn=function(e){return this.clone().iushrn(e)},o.prototype.testn=function(e){n("number"===typeof e&&e>=0);var t=e%26,r=(e-t)/26,i=1<<t;return!(this.length<=r)&&!!(this.words[r]&i)},o.prototype.imaskn=function(e){n("number"===typeof e&&e>=0);var t=e%26,r=(e-t)/26;if(n(0===this.negative,"imaskn works only with positive numbers"),this.length<=r)return this;if(0!==t&&r++,this.length=Math.min(r,this.length),0!==t){var i=67108863^67108863>>>t<<t;this.words[this.length-1]&=i}return this._strip()},o.prototype.maskn=function(e){return this.clone().imaskn(e)},o.prototype.iaddn=function(e){return n("number"===typeof e),n(e<67108864),e<0?this.isubn(-e):0!==this.negative?1===this.length&&(0|this.words[0])<=e?(this.words[0]=e-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(e),this.negative=1,this):this._iaddn(e)},o.prototype._iaddn=function(e){this.words[0]+=e;for(var t=0;t<this.length&&this.words[t]>=67108864;t++)this.words[t]-=67108864,t===this.length-1?this.words[t+1]=1:this.words[t+1]++;return this.length=Math.max(this.length,t+1),this},o.prototype.isubn=function(e){if(n("number"===typeof e),n(e<67108864),e<0)return this.iaddn(-e);if(0!==this.negative)return this.negative=0,this.iaddn(e),this.negative=1,this;if(this.words[0]-=e,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var t=0;t<this.length&&this.words[t]<0;t++)this.words[t]+=67108864,this.words[t+1]-=1;return this._strip()},o.prototype.addn=function(e){return this.clone().iaddn(e)},o.prototype.subn=function(e){return this.clone().isubn(e)},o.prototype.iabs=function(){return this.negative=0,this},o.prototype.abs=function(){return this.clone().iabs()},o.prototype._ishlnsubmul=function(e,t,r){var i,o,a=e.length+r;this._expand(a);var s=0;for(i=0;i<e.length;i++){o=(0|this.words[i+r])+s;var u=(0|e.words[i])*t;s=((o-=67108863&u)>>26)-(u/67108864|0),this.words[i+r]=67108863&o}for(;i<this.length-r;i++)s=(o=(0|this.words[i+r])+s)>>26,this.words[i+r]=67108863&o;if(0===s)return this._strip();for(n(-1===s),s=0,i=0;i<this.length;i++)s=(o=-(0|this.words[i])+s)>>26,this.words[i]=67108863&o;return this.negative=1,this._strip()},o.prototype._wordDiv=function(e,t){var r=(this.length,e.length),n=this.clone(),i=e,a=0|i.words[i.length-1];0!==(r=26-this._countBits(a))&&(i=i.ushln(r),n.iushln(r),a=0|i.words[i.length-1]);var s,u=n.length-i.length;if("mod"!==t){(s=new o(null)).length=u+1,s.words=new Array(s.length);for(var c=0;c<s.length;c++)s.words[c]=0}var l=n.clone()._ishlnsubmul(i,1,u);0===l.negative&&(n=l,s&&(s.words[u]=1));for(var h=u-1;h>=0;h--){var f=67108864*(0|n.words[i.length+h])+(0|n.words[i.length+h-1]);for(f=Math.min(f/a|0,67108863),n._ishlnsubmul(i,f,h);0!==n.negative;)f--,n.negative=0,n._ishlnsubmul(i,1,h),n.isZero()||(n.negative^=1);s&&(s.words[h]=f)}return s&&s._strip(),n._strip(),"div"!==t&&0!==r&&n.iushrn(r),{div:s||null,mod:n}},o.prototype.divmod=function(e,t,r){return n(!e.isZero()),this.isZero()?{div:new o(0),mod:new o(0)}:0!==this.negative&&0===e.negative?(s=this.neg().divmod(e,t),"mod"!==t&&(i=s.div.neg()),"div"!==t&&(a=s.mod.neg(),r&&0!==a.negative&&a.iadd(e)),{div:i,mod:a}):0===this.negative&&0!==e.negative?(s=this.divmod(e.neg(),t),"mod"!==t&&(i=s.div.neg()),{div:i,mod:s.mod}):0!==(this.negative&e.negative)?(s=this.neg().divmod(e.neg(),t),"div"!==t&&(a=s.mod.neg(),r&&0!==a.negative&&a.isub(e)),{div:s.div,mod:a}):e.length>this.length||this.cmp(e)<0?{div:new o(0),mod:this}:1===e.length?"div"===t?{div:this.divn(e.words[0]),mod:null}:"mod"===t?{div:null,mod:new o(this.modrn(e.words[0]))}:{div:this.divn(e.words[0]),mod:new o(this.modrn(e.words[0]))}:this._wordDiv(e,t);var i,a,s},o.prototype.div=function(e){return this.divmod(e,"div",!1).div},o.prototype.mod=function(e){return this.divmod(e,"mod",!1).mod},o.prototype.umod=function(e){return this.divmod(e,"mod",!0).mod},o.prototype.divRound=function(e){var t=this.divmod(e);if(t.mod.isZero())return t.div;var r=0!==t.div.negative?t.mod.isub(e):t.mod,n=e.ushrn(1),i=e.andln(1),o=r.cmp(n);return o<0||1===i&&0===o?t.div:0!==t.div.negative?t.div.isubn(1):t.div.iaddn(1)},o.prototype.modrn=function(e){var t=e<0;t&&(e=-e),n(e<=67108863);for(var r=(1<<26)%e,i=0,o=this.length-1;o>=0;o--)i=(r*i+(0|this.words[o]))%e;return t?-i:i},o.prototype.modn=function(e){return this.modrn(e)},o.prototype.idivn=function(e){var t=e<0;t&&(e=-e),n(e<=67108863);for(var r=0,i=this.length-1;i>=0;i--){var o=(0|this.words[i])+67108864*r;this.words[i]=o/e|0,r=o%e}return this._strip(),t?this.ineg():this},o.prototype.divn=function(e){return this.clone().idivn(e)},o.prototype.egcd=function(e){n(0===e.negative),n(!e.isZero());var t=this,r=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var i=new o(1),a=new o(0),s=new o(0),u=new o(1),c=0;t.isEven()&&r.isEven();)t.iushrn(1),r.iushrn(1),++c;for(var l=r.clone(),h=t.clone();!t.isZero();){for(var f=0,d=1;0===(t.words[0]&d)&&f<26;++f,d<<=1);if(f>0)for(t.iushrn(f);f-- >0;)(i.isOdd()||a.isOdd())&&(i.iadd(l),a.isub(h)),i.iushrn(1),a.iushrn(1);for(var p=0,m=1;0===(r.words[0]&m)&&p<26;++p,m<<=1);if(p>0)for(r.iushrn(p);p-- >0;)(s.isOdd()||u.isOdd())&&(s.iadd(l),u.isub(h)),s.iushrn(1),u.iushrn(1);t.cmp(r)>=0?(t.isub(r),i.isub(s),a.isub(u)):(r.isub(t),s.isub(i),u.isub(a))}return{a:s,b:u,gcd:r.iushln(c)}},o.prototype._invmp=function(e){n(0===e.negative),n(!e.isZero());var t=this,r=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var i,a=new o(1),s=new o(0),u=r.clone();t.cmpn(1)>0&&r.cmpn(1)>0;){for(var c=0,l=1;0===(t.words[0]&l)&&c<26;++c,l<<=1);if(c>0)for(t.iushrn(c);c-- >0;)a.isOdd()&&a.iadd(u),a.iushrn(1);for(var h=0,f=1;0===(r.words[0]&f)&&h<26;++h,f<<=1);if(h>0)for(r.iushrn(h);h-- >0;)s.isOdd()&&s.iadd(u),s.iushrn(1);t.cmp(r)>=0?(t.isub(r),a.isub(s)):(r.isub(t),s.isub(a))}return(i=0===t.cmpn(1)?a:s).cmpn(0)<0&&i.iadd(e),i},o.prototype.gcd=function(e){if(this.isZero())return e.abs();if(e.isZero())return this.abs();var t=this.clone(),r=e.clone();t.negative=0,r.negative=0;for(var n=0;t.isEven()&&r.isEven();n++)t.iushrn(1),r.iushrn(1);for(;;){for(;t.isEven();)t.iushrn(1);for(;r.isEven();)r.iushrn(1);var i=t.cmp(r);if(i<0){var o=t;t=r,r=o}else if(0===i||0===r.cmpn(1))break;t.isub(r)}return r.iushln(n)},o.prototype.invm=function(e){return this.egcd(e).a.umod(e)},o.prototype.isEven=function(){return 0===(1&this.words[0])},o.prototype.isOdd=function(){return 1===(1&this.words[0])},o.prototype.andln=function(e){return this.words[0]&e},o.prototype.bincn=function(e){n("number"===typeof e);var t=e%26,r=(e-t)/26,i=1<<t;if(this.length<=r)return this._expand(r+1),this.words[r]|=i,this;for(var o=i,a=r;0!==o&&a<this.length;a++){var s=0|this.words[a];o=(s+=o)>>>26,s&=67108863,this.words[a]=s}return 0!==o&&(this.words[a]=o,this.length++),this},o.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},o.prototype.cmpn=function(e){var t,r=e<0;if(0!==this.negative&&!r)return-1;if(0===this.negative&&r)return 1;if(this._strip(),this.length>1)t=1;else{r&&(e=-e),n(e<=67108863,"Number is too big");var i=0|this.words[0];t=i===e?0:i<e?-1:1}return 0!==this.negative?0|-t:t},o.prototype.cmp=function(e){if(0!==this.negative&&0===e.negative)return-1;if(0===this.negative&&0!==e.negative)return 1;var t=this.ucmp(e);return 0!==this.negative?0|-t:t},o.prototype.ucmp=function(e){if(this.length>e.length)return 1;if(this.length<e.length)return-1;for(var t=0,r=this.length-1;r>=0;r--){var n=0|this.words[r],i=0|e.words[r];if(n!==i){n<i?t=-1:n>i&&(t=1);break}}return t},o.prototype.gtn=function(e){return 1===this.cmpn(e)},o.prototype.gt=function(e){return 1===this.cmp(e)},o.prototype.gten=function(e){return this.cmpn(e)>=0},o.prototype.gte=function(e){return this.cmp(e)>=0},o.prototype.ltn=function(e){return-1===this.cmpn(e)},o.prototype.lt=function(e){return-1===this.cmp(e)},o.prototype.lten=function(e){return this.cmpn(e)<=0},o.prototype.lte=function(e){return this.cmp(e)<=0},o.prototype.eqn=function(e){return 0===this.cmpn(e)},o.prototype.eq=function(e){return 0===this.cmp(e)},o.red=function(e){return new S(e)},o.prototype.toRed=function(e){return n(!this.red,"Already a number in reduction context"),n(0===this.negative,"red works only with positives"),e.convertTo(this)._forceRed(e)},o.prototype.fromRed=function(){return n(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},o.prototype._forceRed=function(e){return this.red=e,this},o.prototype.forceRed=function(e){return n(!this.red,"Already a number in reduction context"),this._forceRed(e)},o.prototype.redAdd=function(e){return n(this.red,"redAdd works only with red numbers"),this.red.add(this,e)},o.prototype.redIAdd=function(e){return n(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,e)},o.prototype.redSub=function(e){return n(this.red,"redSub works only with red numbers"),this.red.sub(this,e)},o.prototype.redISub=function(e){return n(this.red,"redISub works only with red numbers"),this.red.isub(this,e)},o.prototype.redShl=function(e){return n(this.red,"redShl works only with red numbers"),this.red.shl(this,e)},o.prototype.redMul=function(e){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.mul(this,e)},o.prototype.redIMul=function(e){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.imul(this,e)},o.prototype.redSqr=function(){return n(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},o.prototype.redISqr=function(){return n(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},o.prototype.redSqrt=function(){return n(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},o.prototype.redInvm=function(){return n(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},o.prototype.redNeg=function(){return n(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},o.prototype.redPow=function(e){return n(this.red&&!e.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,e)};var b={k256:null,p224:null,p192:null,p25519:null};function x(e,t){this.name=e,this.p=new o(t,16),this.n=this.p.bitLength(),this.k=new o(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function w(){x.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function k(){x.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function A(){x.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function E(){x.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function S(e){if("string"===typeof e){var t=o._prime(e);this.m=t.p,this.prime=t}else n(e.gtn(1),"modulus must be greater than 1"),this.m=e,this.prime=null}function T(e){S.call(this,e),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new o(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}x.prototype._tmp=function(){var e=new o(null);return e.words=new Array(Math.ceil(this.n/13)),e},x.prototype.ireduce=function(e){var t,r=e;do{this.split(r,this.tmp),t=(r=(r=this.imulK(r)).iadd(this.tmp)).bitLength()}while(t>this.n);var n=t<this.n?-1:r.ucmp(this.p);return 0===n?(r.words[0]=0,r.length=1):n>0?r.isub(this.p):void 0!==r.strip?r.strip():r._strip(),r},x.prototype.split=function(e,t){e.iushrn(this.n,0,t)},x.prototype.imulK=function(e){return e.imul(this.k)},i(w,x),w.prototype.split=function(e,t){for(var r=4194303,n=Math.min(e.length,9),i=0;i<n;i++)t.words[i]=e.words[i];if(t.length=n,e.length<=9)return e.words[0]=0,void(e.length=1);var o=e.words[9];for(t.words[t.length++]=o&r,i=10;i<e.length;i++){var a=0|e.words[i];e.words[i-10]=(a&r)<<4|o>>>22,o=a}o>>>=22,e.words[i-10]=o,0===o&&e.length>10?e.length-=10:e.length-=9},w.prototype.imulK=function(e){e.words[e.length]=0,e.words[e.length+1]=0,e.length+=2;for(var t=0,r=0;r<e.length;r++){var n=0|e.words[r];t+=977*n,e.words[r]=67108863&t,t=64*n+(t/67108864|0)}return 0===e.words[e.length-1]&&(e.length--,0===e.words[e.length-1]&&e.length--),e},i(k,x),i(A,x),i(E,x),E.prototype.imulK=function(e){for(var t=0,r=0;r<e.length;r++){var n=19*(0|e.words[r])+t,i=67108863&n;n>>>=26,e.words[r]=i,t=n}return 0!==t&&(e.words[e.length++]=t),e},o._prime=function(e){if(b[e])return b[e];var t;if("k256"===e)t=new w;else if("p224"===e)t=new k;else if("p192"===e)t=new A;else{if("p25519"!==e)throw new Error("Unknown prime "+e);t=new E}return b[e]=t,t},S.prototype._verify1=function(e){n(0===e.negative,"red works only with positives"),n(e.red,"red works only with red numbers")},S.prototype._verify2=function(e,t){n(0===(e.negative|t.negative),"red works only with positives"),n(e.red&&e.red===t.red,"red works only with red numbers")},S.prototype.imod=function(e){return this.prime?this.prime.ireduce(e)._forceRed(this):(l(e,e.umod(this.m)._forceRed(this)),e)},S.prototype.neg=function(e){return e.isZero()?e.clone():this.m.sub(e)._forceRed(this)},S.prototype.add=function(e,t){this._verify2(e,t);var r=e.add(t);return r.cmp(this.m)>=0&&r.isub(this.m),r._forceRed(this)},S.prototype.iadd=function(e,t){this._verify2(e,t);var r=e.iadd(t);return r.cmp(this.m)>=0&&r.isub(this.m),r},S.prototype.sub=function(e,t){this._verify2(e,t);var r=e.sub(t);return r.cmpn(0)<0&&r.iadd(this.m),r._forceRed(this)},S.prototype.isub=function(e,t){this._verify2(e,t);var r=e.isub(t);return r.cmpn(0)<0&&r.iadd(this.m),r},S.prototype.shl=function(e,t){return this._verify1(e),this.imod(e.ushln(t))},S.prototype.imul=function(e,t){return this._verify2(e,t),this.imod(e.imul(t))},S.prototype.mul=function(e,t){return this._verify2(e,t),this.imod(e.mul(t))},S.prototype.isqr=function(e){return this.imul(e,e.clone())},S.prototype.sqr=function(e){return this.mul(e,e)},S.prototype.sqrt=function(e){if(e.isZero())return e.clone();var t=this.m.andln(3);if(n(t%2===1),3===t){var r=this.m.add(new o(1)).iushrn(2);return this.pow(e,r)}for(var i=this.m.subn(1),a=0;!i.isZero()&&0===i.andln(1);)a++,i.iushrn(1);n(!i.isZero());var s=new o(1).toRed(this),u=s.redNeg(),c=this.m.subn(1).iushrn(1),l=this.m.bitLength();for(l=new o(2*l*l).toRed(this);0!==this.pow(l,c).cmp(u);)l.redIAdd(u);for(var h=this.pow(l,i),f=this.pow(e,i.addn(1).iushrn(1)),d=this.pow(e,i),p=a;0!==d.cmp(s);){for(var m=d,g=0;0!==m.cmp(s);g++)m=m.redSqr();n(g<p);var y=this.pow(h,new o(1).iushln(p-g-1));f=f.redMul(y),h=y.redSqr(),d=d.redMul(h),p=g}return f},S.prototype.invm=function(e){var t=e._invmp(this.m);return 0!==t.negative?(t.negative=0,this.imod(t).redNeg()):this.imod(t)},S.prototype.pow=function(e,t){if(t.isZero())return new o(1).toRed(this);if(0===t.cmpn(1))return e.clone();var r=new Array(16);r[0]=new o(1).toRed(this),r[1]=e;for(var n=2;n<r.length;n++)r[n]=this.mul(r[n-1],e);var i=r[0],a=0,s=0,u=t.bitLength()%26;for(0===u&&(u=26),n=t.length-1;n>=0;n--){for(var c=t.words[n],l=u-1;l>=0;l--){var h=c>>l&1;i!==r[0]&&(i=this.sqr(i)),0!==h||0!==a?(a<<=1,a|=h,(4===++s||0===n&&0===l)&&(i=this.mul(i,r[a]),s=0,a=0)):s=0}u=26}return i},S.prototype.convertTo=function(e){var t=e.umod(this.m);return t===e?t.clone():t},S.prototype.convertFrom=function(e){var t=e.clone();return t.red=null,t},o.mont=function(e){return new T(e)},i(T,S),T.prototype.convertTo=function(e){return this.imod(e.ushln(this.shift))},T.prototype.convertFrom=function(e){var t=this.imod(e.mul(this.rinv));return t.red=null,t},T.prototype.imul=function(e,t){if(e.isZero()||t.isZero())return e.words[0]=0,e.length=1,e;var r=e.imul(t),n=r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),i=r.isub(n).iushrn(this.shift),o=i;return i.cmp(this.m)>=0?o=i.isub(this.m):i.cmpn(0)<0&&(o=i.iadd(this.m)),o._forceRed(this)},T.prototype.mul=function(e,t){if(e.isZero()||t.isZero())return new o(0)._forceRed(this);var r=e.mul(t),n=r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),i=r.isub(n).iushrn(this.shift),a=i;return i.cmp(this.m)>=0?a=i.isub(this.m):i.cmpn(0)<0&&(a=i.iadd(this.m)),a._forceRed(this)},T.prototype.invm=function(e){return this.imod(e._invmp(this.m).mul(this.r2))._forceRed(this)}}(e=r.nmd(e),this)},5127:function(e,t,r){"use strict";var n=r(9778).Buffer,i=r(8416).default,o=r(7424).default,a=r(4704).default,s=r(6690).default,u=r(9728).default,c=r(1655).default,l=r(6389).default,h=r(3496).default,f=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),d=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),p=this&&this.__decorate||function(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},m=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.hasOwnProperty.call(e,r)&&f(t,e,r);return d(t,e),t},g=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.deserializeUnchecked=t.deserialize=t.serialize=t.BinaryReader=t.BinaryWriter=t.BorshError=t.baseDecode=t.baseEncode=void 0;var y=g(r(518)),v=g(r(9969)),_=m(r(9344)),b=new("function"!==typeof r.g.TextDecoder?_.TextDecoder:r.g.TextDecoder)("utf-8",{fatal:!0});t.baseEncode=function(e){return"string"===typeof e&&(e=n.from(e,"utf8")),v.default.encode(n.from(e))},t.baseDecode=function(e){return n.from(v.default.decode(e))};var x=1024,w=function(e){c(r,e);var t=l(r);function r(e){var n;return s(this,r),(n=t.call(this,e)).fieldPath=[],n.originalMessage=e,n}return u(r,[{key:"addToFieldPath",value:function(e){this.fieldPath.splice(0,0,e),this.message=this.originalMessage+": "+this.fieldPath.join(".")}}]),r}(h(Error));t.BorshError=w;var k=function(){function e(){s(this,e),this.buf=n.alloc(x),this.length=0}return u(e,[{key:"maybeResize",value:function(){this.buf.length<16+this.length&&(this.buf=n.concat([this.buf,n.alloc(x)]))}},{key:"writeU8",value:function(e){this.maybeResize(),this.buf.writeUInt8(e,this.length),this.length+=1}},{key:"writeU16",value:function(e){this.maybeResize(),this.buf.writeUInt16LE(e,this.length),this.length+=2}},{key:"writeU32",value:function(e){this.maybeResize(),this.buf.writeUInt32LE(e,this.length),this.length+=4}},{key:"writeU64",value:function(e){this.maybeResize(),this.writeBuffer(n.from(new y.default(e).toArray("le",8)))}},{key:"writeU128",value:function(e){this.maybeResize(),this.writeBuffer(n.from(new y.default(e).toArray("le",16)))}},{key:"writeU256",value:function(e){this.maybeResize(),this.writeBuffer(n.from(new y.default(e).toArray("le",32)))}},{key:"writeU512",value:function(e){this.maybeResize(),this.writeBuffer(n.from(new y.default(e).toArray("le",64)))}},{key:"writeBuffer",value:function(e){this.buf=n.concat([n.from(this.buf.subarray(0,this.length)),e,n.alloc(x)]),this.length+=e.length}},{key:"writeString",value:function(e){this.maybeResize();var t=n.from(e,"utf8");this.writeU32(t.length),this.writeBuffer(t)}},{key:"writeFixedArray",value:function(e){this.writeBuffer(n.from(e))}},{key:"writeArray",value:function(e,t){this.maybeResize(),this.writeU32(e.length);var r,n=a(e);try{for(n.s();!(r=n.n()).done;){var i=r.value;this.maybeResize(),t(i)}}catch(o){n.e(o)}finally{n.f()}}},{key:"toArray",value:function(){return this.buf.subarray(0,this.length)}}]),e}();function A(e,t,r){var n=r.value;r.value=function(){try{for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.apply(this,t)}catch(o){if(o instanceof RangeError){var i=o.code;if(["ERR_BUFFER_OUT_OF_BOUNDS","ERR_OUT_OF_RANGE"].indexOf(i)>=0)throw new w("Reached the end of buffer when deserializing")}throw o}}}t.BinaryWriter=k;var E=function(){function e(t){s(this,e),this.buf=t,this.offset=0}return u(e,[{key:"readU8",value:function(){var e=this.buf.readUInt8(this.offset);return this.offset+=1,e}},{key:"readU16",value:function(){var e=this.buf.readUInt16LE(this.offset);return this.offset+=2,e}},{key:"readU32",value:function(){var e=this.buf.readUInt32LE(this.offset);return this.offset+=4,e}},{key:"readU64",value:function(){var e=this.readBuffer(8);return new y.default(e,"le")}},{key:"readU128",value:function(){var e=this.readBuffer(16);return new y.default(e,"le")}},{key:"readU256",value:function(){var e=this.readBuffer(32);return new y.default(e,"le")}},{key:"readU512",value:function(){var e=this.readBuffer(64);return new y.default(e,"le")}},{key:"readBuffer",value:function(e){if(this.offset+e>this.buf.length)throw new w("Expected buffer length ".concat(e," isn't within bounds"));var t=this.buf.slice(this.offset,this.offset+e);return this.offset+=e,t}},{key:"readString",value:function(){var e=this.readU32(),t=this.readBuffer(e);try{return b.decode(t)}catch(r){throw new w("Error decoding UTF-8 string: ".concat(r))}}},{key:"readFixedArray",value:function(e){return new Uint8Array(this.readBuffer(e))}},{key:"readArray",value:function(e){for(var t=this.readU32(),r=Array(),n=0;n<t;++n)r.push(e());return r}}]),e}();function S(e){return e.charAt(0).toUpperCase()+e.slice(1)}function T(e,t,r,n,i){try{if("string"===typeof n)i["write".concat(S(n))](r);else if(n instanceof Array)if("number"===typeof n[0]){if(r.length!==n[0])throw new w("Expecting byte array of length ".concat(n[0],", but got ").concat(r.length," bytes"));i.writeFixedArray(r)}else i.writeArray(r,(function(r){T(e,t,r,n[0],i)}));else if(void 0!==n.kind){if("option"!==n.kind)throw new w("FieldType ".concat(n," unrecognized"));null===r||void 0===r?i.writeU8(0):(i.writeU8(1),T(e,t,r,n.type,i))}else M(e,r,i)}catch(o){throw o instanceof w&&o.addToFieldPath(t),o}}function M(e,t,r){var n=e.get(t.constructor);if(!n)throw new w("Class ".concat(t.constructor.name," is missing in schema"));if("struct"===n.kind)n.fields.map((function(n){var i=o(n,2),a=i[0],s=i[1];T(e,a,t[a],s,r)}));else{if("enum"!==n.kind)throw new w("Unexpected schema kind: ".concat(n.kind," for ").concat(t.constructor.name));for(var i=t[n.field],a=0;a<n.values.length;++a){var s=o(n.values[a],2),u=s[0],c=s[1];if(u===i){r.writeU8(a),T(e,u,t[u],c,r);break}}}}function I(e,t,r,n){try{return"string"===typeof r?n["read".concat(S(r))]():r instanceof Array?"number"===typeof r[0]?n.readFixedArray(r[0]):n.readArray((function(){return I(e,t,r[0],n)})):"option"===r.kind?n.readU8()?I(e,t,r.type,n):void 0:P(e,r,n)}catch(i){throw i instanceof w&&i.addToFieldPath(t),i}}function P(e,t,r){var n=e.get(t);if(!n)throw new w("Class ".concat(t.name," is missing in schema"));if("struct"===n.kind){var s,u={},c=a(e.get(t).fields);try{for(c.s();!(s=c.n()).done;){var l=o(s.value,2),h=l[0],f=l[1];u[h]=I(e,h,f,r)}}catch(y){c.e(y)}finally{c.f()}return new t(u)}if("enum"===n.kind){var d=r.readU8();if(d>=n.values.length)throw new w("Enum index: ".concat(d," is out of range"));var p=o(n.values[d],2),m=p[0],g=I(e,m,p[1],r);return new t(i({},m,g))}throw new w("Unexpected schema kind: ".concat(n.kind," for ").concat(t.constructor.name))}p([A],E.prototype,"readU8",null),p([A],E.prototype,"readU16",null),p([A],E.prototype,"readU32",null),p([A],E.prototype,"readU64",null),p([A],E.prototype,"readU128",null),p([A],E.prototype,"readU256",null),p([A],E.prototype,"readU512",null),p([A],E.prototype,"readString",null),p([A],E.prototype,"readFixedArray",null),p([A],E.prototype,"readArray",null),t.BinaryReader=E,t.serialize=function(e,t){var r=new k;return M(e,t,r),r.toArray()},t.deserialize=function(e,t,r){var n=new E(r),i=P(e,t,n);if(n.offset<r.length)throw new w("Unexpected ".concat(r.length-n.offset," bytes after deserialized data"));return i},t.deserializeUnchecked=function(e,t,r){return P(e,t,new E(r))}},9969:function(e,t,r){var n=r(2307);e.exports=n("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz")},6315:function(e,t,r){var n=r(114);e.exports=n("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz")},114:function(e){"use strict";e.exports=function(e){if(e.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),r=0;r<t.length;r++)t[r]=255;for(var n=0;n<e.length;n++){var i=e.charAt(n),o=i.charCodeAt(0);if(255!==t[o])throw new TypeError(i+" is ambiguous");t[o]=n}var a=e.length,s=e.charAt(0),u=Math.log(a)/Math.log(256),c=Math.log(256)/Math.log(a);function l(e){if("string"!==typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;for(var r=0,n=0,i=0;e[r]===s;)n++,r++;for(var o=(e.length-r)*u+1>>>0,c=new Uint8Array(o);e[r];){var l=t[e.charCodeAt(r)];if(255===l)return;for(var h=0,f=o-1;(0!==l||h<i)&&-1!==f;f--,h++)l+=a*c[f]>>>0,c[f]=l%256>>>0,l=l/256>>>0;if(0!==l)throw new Error("Non-zero carry");i=h,r++}for(var d=o-i;d!==o&&0===c[d];)d++;for(var p=new Uint8Array(n+(o-d)),m=n;d!==o;)p[m++]=c[d++];return p}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,n=0,i=0,o=t.length;i!==o&&0===t[i];)i++,r++;for(var u=(o-i)*c+1>>>0,l=new Uint8Array(u);i!==o;){for(var h=t[i],f=0,d=u-1;(0!==h||f<n)&&-1!==d;d--,f++)h+=256*l[d]>>>0,l[d]=h%a>>>0,h=h/a>>>0;if(0!==h)throw new Error("Non-zero carry");n=f,i++}for(var p=u-n;p!==u&&0===l[p];)p++;for(var m=s.repeat(r);p<u;++p)m+=e.charAt(l[p]);return m},decodeUnsafe:l,decode:function(e){var t=l(e);if(t)return t;throw new Error("Non-base"+a+" character")}}}},9778:function(e,t,r){"use strict";var n=r(6690).default,i=r(9728).default,o=r(6115).default,a=r(1655).default,s=r(6389).default,u=r(2009),c=r(4038),l="function"===typeof Symbol&&"function"===typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=d,t.SlowBuffer=function(e){+e!=e&&(e=0);return d.alloc(+e)},t.INSPECT_MAX_BYTES=50;var h=2147483647;function f(e){if(e>h)throw new RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return Object.setPrototypeOf(t,d.prototype),t}function d(e,t,r){if("number"===typeof e){if("string"===typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return g(e)}return p(e,t,r)}function p(e,t,r){if("string"===typeof e)return function(e,t){"string"===typeof t&&""!==t||(t="utf8");if(!d.isEncoding(t))throw new TypeError("Unknown encoding: "+t);var r=0|b(e,t),n=f(r),i=n.write(e,t);i!==r&&(n=n.slice(0,i));return n}(e,t);if(ArrayBuffer.isView(e))return function(e){if(ee(e,Uint8Array)){var t=new Uint8Array(e);return v(t.buffer,t.byteOffset,t.byteLength)}return y(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(ee(e,ArrayBuffer)||e&&ee(e.buffer,ArrayBuffer))return v(e,t,r);if("undefined"!==typeof SharedArrayBuffer&&(ee(e,SharedArrayBuffer)||e&&ee(e.buffer,SharedArrayBuffer)))return v(e,t,r);if("number"===typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return d.from(n,t,r);var i=function(e){if(d.isBuffer(e)){var t=0|_(e.length),r=f(t);return 0===r.length||e.copy(r,0,0,t),r}if(void 0!==e.length)return"number"!==typeof e.length||te(e.length)?f(0):y(e);if("Buffer"===e.type&&Array.isArray(e.data))return y(e.data)}(e);if(i)return i;if("undefined"!==typeof Symbol&&null!=Symbol.toPrimitive&&"function"===typeof e[Symbol.toPrimitive])return d.from(e[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function m(e){if("number"!==typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function g(e){return m(e),f(e<0?0:0|_(e))}function y(e){for(var t=e.length<0?0:0|_(e.length),r=f(t),n=0;n<t;n+=1)r[n]=255&e[n];return r}function v(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');var n;return n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),Object.setPrototypeOf(n,d.prototype),n}function _(e){if(e>=h)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+h.toString(16)+" bytes");return 0|e}function b(e,t){if(d.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||ee(e,ArrayBuffer))return e.byteLength;if("string"!==typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var r=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return Q(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return $(e).length;default:if(i)return n?-1:Q(e).length;t=(""+t).toLowerCase(),i=!0}}function x(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return L(this,t,r);case"utf8":case"utf-8":return C(this,t,r);case"ascii":return D(this,t,r);case"latin1":case"binary":return R(this,t,r);case"base64":return P(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function w(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function k(e,t,r,n,i){if(0===e.length)return-1;if("string"===typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),te(r=+r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"===typeof t&&(t=d.from(t,n)),d.isBuffer(t))return 0===t.length?-1:A(e,t,r,n,i);if("number"===typeof t)return t&=255,"function"===typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):A(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function A(e,t,r,n,i){var o,a=1,s=e.length,u=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;a=2,s/=2,u/=2,r/=2}function c(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(i){var l=-1;for(o=r;o<s;o++)if(c(e,o)===c(t,-1===l?0:o-l)){if(-1===l&&(l=o),o-l+1===u)return l*a}else-1!==l&&(o-=o-l),l=-1}else for(r+u>s&&(r=s-u),o=r;o>=0;o--){for(var h=!0,f=0;f<u;f++)if(c(e,o+f)!==c(t,f)){h=!1;break}if(h)return o}return-1}function E(e,t,r,n){r=Number(r)||0;var i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;var o,a=t.length;for(n>a/2&&(n=a/2),o=0;o<n;++o){var s=parseInt(t.substr(2*o,2),16);if(te(s))return o;e[r+o]=s}return o}function S(e,t,r,n){return J(Q(t,e.length-r),e,r,n)}function T(e,t,r,n){return J(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,n)}function M(e,t,r,n){return J($(t),e,r,n)}function I(e,t,r,n){return J(function(e,t){for(var r,n,i,o=[],a=0;a<e.length&&!((t-=2)<0);++a)n=(r=e.charCodeAt(a))>>8,i=r%256,o.push(i),o.push(n);return o}(t,e.length-r),e,r,n)}function P(e,t,r){return 0===t&&r===e.length?u.fromByteArray(e):u.fromByteArray(e.slice(t,r))}function C(e,t,r){r=Math.min(e.length,r);for(var n=[],i=t;i<r;){var o=e[i],a=null,s=o>239?4:o>223?3:o>191?2:1;if(i+s<=r){var u=void 0,c=void 0,l=void 0,h=void 0;switch(s){case 1:o<128&&(a=o);break;case 2:128===(192&(u=e[i+1]))&&(h=(31&o)<<6|63&u)>127&&(a=h);break;case 3:u=e[i+1],c=e[i+2],128===(192&u)&&128===(192&c)&&(h=(15&o)<<12|(63&u)<<6|63&c)>2047&&(h<55296||h>57343)&&(a=h);break;case 4:u=e[i+1],c=e[i+2],l=e[i+3],128===(192&u)&&128===(192&c)&&128===(192&l)&&(h=(15&o)<<18|(63&u)<<12|(63&c)<<6|63&l)>65535&&h<1114112&&(a=h)}}null===a?(a=65533,s=1):a>65535&&(a-=65536,n.push(a>>>10&1023|55296),a=56320|1023&a),n.push(a),i+=s}return function(e){var t=e.length;if(t<=B)return String.fromCharCode.apply(String,e);var r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=B));return r}(n)}t.kMaxLength=h,d.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(r){return!1}}(),d.TYPED_ARRAY_SUPPORT||"undefined"===typeof console||"function"!==typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(d.prototype,"parent",{enumerable:!0,get:function(){if(d.isBuffer(this))return this.buffer}}),Object.defineProperty(d.prototype,"offset",{enumerable:!0,get:function(){if(d.isBuffer(this))return this.byteOffset}}),d.poolSize=8192,d.from=function(e,t,r){return p(e,t,r)},Object.setPrototypeOf(d.prototype,Uint8Array.prototype),Object.setPrototypeOf(d,Uint8Array),d.alloc=function(e,t,r){return function(e,t,r){return m(e),e<=0?f(e):void 0!==t?"string"===typeof r?f(e).fill(t,r):f(e).fill(t):f(e)}(e,t,r)},d.allocUnsafe=function(e){return g(e)},d.allocUnsafeSlow=function(e){return g(e)},d.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==d.prototype},d.compare=function(e,t){if(ee(e,Uint8Array)&&(e=d.from(e,e.offset,e.byteLength)),ee(t,Uint8Array)&&(t=d.from(t,t.offset,t.byteLength)),!d.isBuffer(e)||!d.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var r=e.length,n=t.length,i=0,o=Math.min(r,n);i<o;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},d.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},d.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return d.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=d.allocUnsafe(t),i=0;for(r=0;r<e.length;++r){var o=e[r];if(ee(o,Uint8Array))i+o.length>n.length?(d.isBuffer(o)||(o=d.from(o)),o.copy(n,i)):Uint8Array.prototype.set.call(n,o,i);else{if(!d.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(n,i)}i+=o.length}return n},d.byteLength=b,d.prototype._isBuffer=!0,d.prototype.swap16=function(){var e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)w(this,t,t+1);return this},d.prototype.swap32=function(){var e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)w(this,t,t+3),w(this,t+1,t+2);return this},d.prototype.swap64=function(){var e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)w(this,t,t+7),w(this,t+1,t+6),w(this,t+2,t+5),w(this,t+3,t+4);return this},d.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?C(this,0,e):x.apply(this,arguments)},d.prototype.toLocaleString=d.prototype.toString,d.prototype.equals=function(e){if(!d.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===d.compare(this,e)},d.prototype.inspect=function(){var e="",r=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"},l&&(d.prototype[l]=d.prototype.inspect),d.prototype.compare=function(e,t,r,n,i){if(ee(e,Uint8Array)&&(e=d.from(e,e.offset,e.byteLength)),!d.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(this===e)return 0;for(var o=(i>>>=0)-(n>>>=0),a=(r>>>=0)-(t>>>=0),s=Math.min(o,a),u=this.slice(n,i),c=e.slice(t,r),l=0;l<s;++l)if(u[l]!==c[l]){o=u[l],a=c[l];break}return o<a?-1:a<o?1:0},d.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},d.prototype.indexOf=function(e,t,r){return k(this,e,t,r,!0)},d.prototype.lastIndexOf=function(e,t,r){return k(this,e,t,r,!1)},d.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"===typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return E(this,e,t,r);case"utf8":case"utf-8":return S(this,e,t,r);case"ascii":case"latin1":case"binary":return T(this,e,t,r);case"base64":return M(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,e,t,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},d.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var B=4096;function D(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function R(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function L(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var i="",o=t;o<r;++o)i+=re[e[o]];return i}function O(e,t,r){for(var n=e.slice(t,r),i="",o=0;o<n.length-1;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function z(e,t,r){if(e%1!==0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function N(e,t,r,n,i,o){if(!d.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function U(e,t,r,n,i){H(t,n,i,e,r,7);var o=Number(t&BigInt(4294967295));e[r++]=o,o>>=8,e[r++]=o,o>>=8,e[r++]=o,o>>=8,e[r++]=o;var a=Number(t>>BigInt(32)&BigInt(4294967295));return e[r++]=a,a>>=8,e[r++]=a,a>>=8,e[r++]=a,a>>=8,e[r++]=a,r}function Z(e,t,r,n,i){H(t,n,i,e,r,7);var o=Number(t&BigInt(4294967295));e[r+7]=o,o>>=8,e[r+6]=o,o>>=8,e[r+5]=o,o>>=8,e[r+4]=o;var a=Number(t>>BigInt(32)&BigInt(4294967295));return e[r+3]=a,a>>=8,e[r+2]=a,a>>=8,e[r+1]=a,a>>=8,e[r]=a,r+8}function F(e,t,r,n,i,o){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function j(e,t,r,n,i){return t=+t,r>>>=0,i||F(e,0,r,4),c.write(e,t,r,n,23,4),r+4}function V(e,t,r,n,i){return t=+t,r>>>=0,i||F(e,0,r,8),c.write(e,t,r,n,52,8),r+8}d.prototype.slice=function(e,t){var r=this.length;(e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);var n=this.subarray(e,t);return Object.setPrototypeOf(n,d.prototype),n},d.prototype.readUintLE=d.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||z(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n},d.prototype.readUintBE=d.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||z(e,t,this.length);for(var n=this[e+--t],i=1;t>0&&(i*=256);)n+=this[e+--t]*i;return n},d.prototype.readUint8=d.prototype.readUInt8=function(e,t){return e>>>=0,t||z(e,1,this.length),this[e]},d.prototype.readUint16LE=d.prototype.readUInt16LE=function(e,t){return e>>>=0,t||z(e,2,this.length),this[e]|this[e+1]<<8},d.prototype.readUint16BE=d.prototype.readUInt16BE=function(e,t){return e>>>=0,t||z(e,2,this.length),this[e]<<8|this[e+1]},d.prototype.readUint32LE=d.prototype.readUInt32LE=function(e,t){return e>>>=0,t||z(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},d.prototype.readUint32BE=d.prototype.readUInt32BE=function(e,t){return e>>>=0,t||z(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},d.prototype.readBigUInt64LE=ne((function(e){q(e>>>=0,"offset");var t=this[e],r=this[e+7];void 0!==t&&void 0!==r||Y(e,this.length-8);var n=t+this[++e]*Math.pow(2,8)+this[++e]*Math.pow(2,16)+this[++e]*Math.pow(2,24),i=this[++e]+this[++e]*Math.pow(2,8)+this[++e]*Math.pow(2,16)+r*Math.pow(2,24);return BigInt(n)+(BigInt(i)<<BigInt(32))})),d.prototype.readBigUInt64BE=ne((function(e){q(e>>>=0,"offset");var t=this[e],r=this[e+7];void 0!==t&&void 0!==r||Y(e,this.length-8);var n=t*Math.pow(2,24)+this[++e]*Math.pow(2,16)+this[++e]*Math.pow(2,8)+this[++e],i=this[++e]*Math.pow(2,24)+this[++e]*Math.pow(2,16)+this[++e]*Math.pow(2,8)+r;return(BigInt(n)<<BigInt(32))+BigInt(i)})),d.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||z(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*t)),n},d.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||z(e,t,this.length);for(var n=t,i=1,o=this[e+--n];n>0&&(i*=256);)o+=this[e+--n]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},d.prototype.readInt8=function(e,t){return e>>>=0,t||z(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},d.prototype.readInt16LE=function(e,t){e>>>=0,t||z(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},d.prototype.readInt16BE=function(e,t){e>>>=0,t||z(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},d.prototype.readInt32LE=function(e,t){return e>>>=0,t||z(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},d.prototype.readInt32BE=function(e,t){return e>>>=0,t||z(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},d.prototype.readBigInt64LE=ne((function(e){q(e>>>=0,"offset");var t=this[e],r=this[e+7];void 0!==t&&void 0!==r||Y(e,this.length-8);var n=this[e+4]+this[e+5]*Math.pow(2,8)+this[e+6]*Math.pow(2,16)+(r<<24);return(BigInt(n)<<BigInt(32))+BigInt(t+this[++e]*Math.pow(2,8)+this[++e]*Math.pow(2,16)+this[++e]*Math.pow(2,24))})),d.prototype.readBigInt64BE=ne((function(e){q(e>>>=0,"offset");var t=this[e],r=this[e+7];void 0!==t&&void 0!==r||Y(e,this.length-8);var n=(t<<24)+this[++e]*Math.pow(2,16)+this[++e]*Math.pow(2,8)+this[++e];return(BigInt(n)<<BigInt(32))+BigInt(this[++e]*Math.pow(2,24)+this[++e]*Math.pow(2,16)+this[++e]*Math.pow(2,8)+r)})),d.prototype.readFloatLE=function(e,t){return e>>>=0,t||z(e,4,this.length),c.read(this,e,!0,23,4)},d.prototype.readFloatBE=function(e,t){return e>>>=0,t||z(e,4,this.length),c.read(this,e,!1,23,4)},d.prototype.readDoubleLE=function(e,t){return e>>>=0,t||z(e,8,this.length),c.read(this,e,!0,52,8)},d.prototype.readDoubleBE=function(e,t){return e>>>=0,t||z(e,8,this.length),c.read(this,e,!1,52,8)},d.prototype.writeUintLE=d.prototype.writeUIntLE=function(e,t,r,n){(e=+e,t>>>=0,r>>>=0,n)||N(this,e,t,r,Math.pow(2,8*r)-1,0);var i=1,o=0;for(this[t]=255&e;++o<r&&(i*=256);)this[t+o]=e/i&255;return t+r},d.prototype.writeUintBE=d.prototype.writeUIntBE=function(e,t,r,n){(e=+e,t>>>=0,r>>>=0,n)||N(this,e,t,r,Math.pow(2,8*r)-1,0);var i=r-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+r},d.prototype.writeUint8=d.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,1,255,0),this[t]=255&e,t+1},d.prototype.writeUint16LE=d.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},d.prototype.writeUint16BE=d.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},d.prototype.writeUint32LE=d.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},d.prototype.writeUint32BE=d.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},d.prototype.writeBigUInt64LE=ne((function(e){return U(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,BigInt(0),BigInt("0xffffffffffffffff"))})),d.prototype.writeBigUInt64BE=ne((function(e){return Z(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,BigInt(0),BigInt("0xffffffffffffffff"))})),d.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var i=Math.pow(2,8*r-1);N(this,e,t,r,i-1,-i)}var o=0,a=1,s=0;for(this[t]=255&e;++o<r&&(a*=256);)e<0&&0===s&&0!==this[t+o-1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+r},d.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var i=Math.pow(2,8*r-1);N(this,e,t,r,i-1,-i)}var o=r-1,a=1,s=0;for(this[t+o]=255&e;--o>=0&&(a*=256);)e<0&&0===s&&0!==this[t+o+1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+r},d.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},d.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},d.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},d.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},d.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||N(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},d.prototype.writeBigInt64LE=ne((function(e){return U(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),d.prototype.writeBigInt64BE=ne((function(e){return Z(this,e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),d.prototype.writeFloatLE=function(e,t,r){return j(this,e,t,!0,r)},d.prototype.writeFloatBE=function(e,t,r){return j(this,e,t,!1,r)},d.prototype.writeDoubleLE=function(e,t,r){return V(this,e,t,!0,r)},d.prototype.writeDoubleBE=function(e,t,r){return V(this,e,t,!1,r)},d.prototype.copy=function(e,t,r,n){if(!d.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var i=n-r;return this===e&&"function"===typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,r,n):Uint8Array.prototype.set.call(e,this.subarray(r,n),t),i},d.prototype.fill=function(e,t,r,n){if("string"===typeof e){if("string"===typeof t?(n=t,t=0,r=this.length):"string"===typeof r&&(n=r,r=this.length),void 0!==n&&"string"!==typeof n)throw new TypeError("encoding must be a string");if("string"===typeof n&&!d.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===e.length){var i=e.charCodeAt(0);("utf8"===n&&i<128||"latin1"===n)&&(e=i)}}else"number"===typeof e?e&=255:"boolean"===typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var o;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"===typeof e)for(o=t;o<r;++o)this[o]=e;else{var a=d.isBuffer(e)?e:d.from(e,n),s=a.length;if(0===s)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(o=0;o<r-t;++o)this[o+t]=a[o%s]}return this};var W={};function K(e,t,r){W[e]=function(r){a(c,r);var u=s(c);function c(){var r;return n(this,c),r=u.call(this),Object.defineProperty(o(r),"message",{value:t.apply(o(r),arguments),writable:!0,configurable:!0}),r.name="".concat(r.name," [").concat(e,"]"),r.stack,delete r.name,r}return i(c,[{key:"code",get:function(){return e},set:function(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}},{key:"toString",value:function(){return"".concat(this.name," [").concat(e,"]: ").concat(this.message)}}]),c}(r)}function G(e){for(var t="",r=e.length,n="-"===e[0]?1:0;r>=n+4;r-=3)t="_".concat(e.slice(r-3,r)).concat(t);return"".concat(e.slice(0,r)).concat(t)}function H(e,t,r,n,i,o){if(e>r||e<t){var a,s="bigint"===typeof t?"n":"";throw a=o>3?0===t||t===BigInt(0)?">= 0".concat(s," and < 2").concat(s," ** ").concat(8*(o+1)).concat(s):">= -(2".concat(s," ** ").concat(8*(o+1)-1).concat(s,") and < 2 ** ")+"".concat(8*(o+1)-1).concat(s):">= ".concat(t).concat(s," and <= ").concat(r).concat(s),new W.ERR_OUT_OF_RANGE("value",a,e)}!function(e,t,r){q(t,"offset"),void 0!==e[t]&&void 0!==e[t+r]||Y(t,e.length-(r+1))}(n,i,o)}function q(e,t){if("number"!==typeof e)throw new W.ERR_INVALID_ARG_TYPE(t,"number",e)}function Y(e,t,r){if(Math.floor(e)!==e)throw q(e,r),new W.ERR_OUT_OF_RANGE(r||"offset","an integer",e);if(t<0)throw new W.ERR_BUFFER_OUT_OF_BOUNDS;throw new W.ERR_OUT_OF_RANGE(r||"offset",">= ".concat(r?1:0," and <= ").concat(t),e)}K("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?"".concat(e," is outside of buffer bounds"):"Attempt to access memory outside buffer bounds"}),RangeError),K("ERR_INVALID_ARG_TYPE",(function(e,t){return'The "'.concat(e,'" argument must be of type number. Received type ').concat(typeof t)}),TypeError),K("ERR_OUT_OF_RANGE",(function(e,t,r){var n='The value of "'.concat(e,'" is out of range.'),i=r;return Number.isInteger(r)&&Math.abs(r)>Math.pow(2,32)?i=G(String(r)):"bigint"===typeof r&&(i=String(r),(r>Math.pow(BigInt(2),BigInt(32))||r<-Math.pow(BigInt(2),BigInt(32)))&&(i=G(i)),i+="n"),n+=" It must be ".concat(t,". Received ").concat(i)}),RangeError);var X=/[^+/0-9A-Za-z-_]/g;function Q(e,t){var r;t=t||1/0;for(var n=e.length,i=null,o=[],a=0;a<n;++a){if((r=e.charCodeAt(a))>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===n){(t-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function $(e){return u.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(X,"")).length<2)return"";for(;e.length%4!==0;)e+="=";return e}(e))}function J(e,t,r,n){var i;for(i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function ee(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function te(e){return e!==e}var re=function(){for(var e="0123456789abcdef",t=new Array(256),r=0;r<16;++r)for(var n=16*r,i=0;i<16;++i)t[n+i]=e[r]+e[i];return t}();function ne(e){return"undefined"===typeof BigInt?ie:e}function ie(){throw new Error("BigInt not supported")}},5090:function(e,t,r){"use strict";var n=r(7061).default,i=r(2122).default,o=r(7156).default,a="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:"undefined"!==typeof window?window:"undefined"!==typeof r.g?r.g:void 0,s=function(e){for(var t=new DataView(e),r="",n=0;n<t.byteLength;n+=4)r+=t.getUint32(n).toString(16).padStart(8,"0");return r},u=function(e){return function(){var t=o(n().mark((function t(r,o){var u;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return"string"===typeof r&&(r=(new a.TextEncoder).encode(r)),o=i({outputFormat:"hex"},o),t.next=4,a.crypto.subtle.digest(e,r);case 4:return u=t.sent,t.abrupt("return","hex"===o.outputFormat?s(u):u);case 6:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}()};u("SHA-1"),t.JQ=u("SHA-256"),u("SHA-384"),u("SHA-512")},7143:function(e){"use strict";var t=Object.prototype.hasOwnProperty,r="~";function n(){}function i(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function o(e,t,n,o,a){if("function"!==typeof n)throw new TypeError("The listener must be a function");var s=new i(n,o||e,a),u=r?r+t:t;return e._events[u]?e._events[u].fn?e._events[u]=[e._events[u],s]:e._events[u].push(s):(e._events[u]=s,e._eventsCount++),e}function a(e,t){0===--e._eventsCount?e._events=new n:delete e._events[t]}function s(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(r=!1)),s.prototype.eventNames=function(){var e,n,i=[];if(0===this._eventsCount)return i;for(n in e=this._events)t.call(e,n)&&i.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(e)):i},s.prototype.listeners=function(e){var t=r?r+e:e,n=this._events[t];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,o=n.length,a=new Array(o);i<o;i++)a[i]=n[i].fn;return a},s.prototype.listenerCount=function(e){var t=r?r+e:e,n=this._events[t];return n?n.fn?1:n.length:0},s.prototype.emit=function(e,t,n,i,o,a){var s=r?r+e:e;if(!this._events[s])return!1;var u,c,l=this._events[s],h=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),h){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,t),!0;case 3:return l.fn.call(l.context,t,n),!0;case 4:return l.fn.call(l.context,t,n,i),!0;case 5:return l.fn.call(l.context,t,n,i,o),!0;case 6:return l.fn.call(l.context,t,n,i,o,a),!0}for(c=1,u=new Array(h-1);c<h;c++)u[c-1]=arguments[c];l.fn.apply(l.context,u)}else{var f,d=l.length;for(c=0;c<d;c++)switch(l[c].once&&this.removeListener(e,l[c].fn,void 0,!0),h){case 1:l[c].fn.call(l[c].context);break;case 2:l[c].fn.call(l[c].context,t);break;case 3:l[c].fn.call(l[c].context,t,n);break;case 4:l[c].fn.call(l[c].context,t,n,i);break;default:if(!u)for(f=1,u=new Array(h-1);f<h;f++)u[f-1]=arguments[f];l[c].fn.apply(l[c].context,u)}}return!0},s.prototype.on=function(e,t,r){return o(this,e,t,r,!1)},s.prototype.once=function(e,t,r){return o(this,e,t,r,!0)},s.prototype.removeListener=function(e,t,n,i){var o=r?r+e:e;if(!this._events[o])return this;if(!t)return a(this,o),this;var s=this._events[o];if(s.fn)s.fn!==t||i&&!s.once||n&&s.context!==n||a(this,o);else{for(var u=0,c=[],l=s.length;u<l;u++)(s[u].fn!==t||i&&!s[u].once||n&&s[u].context!==n)&&c.push(s[u]);c.length?this._events[o]=1===c.length?c[0]:c:a(this,o)}return this},s.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&a(this,t)):(this._events=new n,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=r,s.EventEmitter=s,e.exports=s},7465:function(e){"use strict";var t,r="object"===typeof Reflect?Reflect:null,n=r&&"function"===typeof r.apply?r.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};t=r&&"function"===typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var i=Number.isNaN||function(e){return e!==e};function o(){o.init.call(this)}e.exports=o,e.exports.once=function(e,t){return new Promise((function(r,n){function i(r){e.removeListener(t,o),n(r)}function o(){"function"===typeof e.removeListener&&e.removeListener("error",i),r([].slice.call(arguments))}m(e,t,o,{once:!0}),"error"!==t&&function(e,t,r){"function"===typeof e.on&&m(e,"error",t,r)}(e,i,{once:!0})}))},o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var a=10;function s(e){if("function"!==typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function u(e){return void 0===e._maxListeners?o.defaultMaxListeners:e._maxListeners}function c(e,t,r,n){var i,o,a,c;if(s(r),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),o=e._events),a=o[t]),void 0===a)a=o[t]=r,++e._eventsCount;else if("function"===typeof a?a=o[t]=n?[r,a]:[a,r]:n?a.unshift(r):a.push(r),(i=u(e))>0&&a.length>i&&!a.warned){a.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=a.length,c=l,console&&console.warn&&console.warn(c)}return e}function l(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function h(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},i=l.bind(n);return i.listener=r,n.wrapFn=i,i}function f(e,t,r){var n=e._events;if(void 0===n)return[];var i=n[t];return void 0===i?[]:"function"===typeof i?r?[i.listener||i]:[i]:r?function(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(i):p(i,i.length)}function d(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"===typeof r)return 1;if(void 0!==r)return r.length}return 0}function p(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function m(e,t,r,n){if("function"===typeof e.on)n.once?e.once(t,r):e.on(t,r);else{if("function"!==typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function i(o){n.once&&e.removeEventListener(t,i),r(o)}))}}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(e){if("number"!==typeof e||e<0||i(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");a=e}}),o.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(e){if("number"!==typeof e||e<0||i(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},o.prototype.getMaxListeners=function(){return u(this)},o.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var i="error"===e,o=this._events;if(void 0!==o)i=i&&void 0===o.error;else if(!i)return!1;if(i){var a;if(t.length>0&&(a=t[0]),a instanceof Error)throw a;var s=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw s.context=a,s}var u=o[e];if(void 0===u)return!1;if("function"===typeof u)n(u,this,t);else{var c=u.length,l=p(u,c);for(r=0;r<c;++r)n(l[r],this,t)}return!0},o.prototype.addListener=function(e,t){return c(this,e,t,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(e,t){return c(this,e,t,!0)},o.prototype.once=function(e,t){return s(t),this.on(e,h(this,e,t)),this},o.prototype.prependOnceListener=function(e,t){return s(t),this.prependListener(e,h(this,e,t)),this},o.prototype.removeListener=function(e,t){var r,n,i,o,a;if(s(t),void 0===(n=this._events))return this;if(void 0===(r=n[e]))return this;if(r===t||r.listener===t)0===--this._eventsCount?this._events=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!==typeof r){for(i=-1,o=r.length-1;o>=0;o--)if(r[o]===t||r[o].listener===t){a=r[o].listener,i=o;break}if(i<0)return this;0===i?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,i),1===r.length&&(n[e]=r[0]),void 0!==n.removeListener&&this.emit("removeListener",e,a||t)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(e){var t,r,n;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0===--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0===arguments.length){var i,o=Object.keys(r);for(n=0;n<o.length;++n)"removeListener"!==(i=o[n])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"===typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(n=t.length-1;n>=0;n--)this.removeListener(e,t[n]);return this},o.prototype.listeners=function(e){return f(this,e,!0)},o.prototype.rawListeners=function(e){return f(this,e,!1)},o.listenerCount=function(e,t){return"function"===typeof e.listenerCount?e.listenerCount(t):d.call(e,t)},o.prototype.listenerCount=d,o.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},4038:function(e,t){t.read=function(e,t,r,n,i){var o,a,s=8*i-n-1,u=(1<<s)-1,c=u>>1,l=-7,h=r?i-1:0,f=r?-1:1,d=e[t+h];for(h+=f,o=d&(1<<-l)-1,d>>=-l,l+=s;l>0;o=256*o+e[t+h],h+=f,l-=8);for(a=o&(1<<-l)-1,o>>=-l,l+=n;l>0;a=256*a+e[t+h],h+=f,l-=8);if(0===o)o=1-c;else{if(o===u)return a?NaN:1/0*(d?-1:1);a+=Math.pow(2,n),o-=c}return(d?-1:1)*a*Math.pow(2,o-n)},t.write=function(e,t,r,n,i,o){var a,s,u,c=8*o-i-1,l=(1<<c)-1,h=l>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=n?0:o-1,p=n?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=l):(a=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-a))<1&&(a--,u*=2),(t+=a+h>=1?f/u:f*Math.pow(2,1-h))*u>=2&&(a++,u/=2),a+h>=l?(s=0,a=l):a+h>=1?(s=(t*u-1)*Math.pow(2,i),a+=h):(s=t*Math.pow(2,h-1)*Math.pow(2,i),a=0));i>=8;e[r+d]=255&s,d+=p,s/=256,i-=8);for(a=a<<i|s,c+=i;c>0;e[r+d]=255&a,d+=p,a/=256,c-=8);e[r+d-p]|=128*m}},9976:function(e,t,r){"use strict";var n=r(3741).v4,i=r(9353),o=function e(t,r){if(!(this instanceof e))return new e(t,r);r||(r={}),this.options={reviver:"undefined"!==typeof r.reviver?r.reviver:null,replacer:"undefined"!==typeof r.replacer?r.replacer:null,generator:"undefined"!==typeof r.generator?r.generator:function(){return n()},version:"undefined"!==typeof r.version?r.version:2,notificationIdNull:"boolean"===typeof r.notificationIdNull&&r.notificationIdNull},this.callServer=t};e.exports=o,o.prototype.request=function(e,t,r,n){var o,a=this,s=null,u=Array.isArray(e)&&"function"===typeof t;if(1===this.options.version&&u)throw new TypeError("JSON-RPC 1.0 does not support batching");if(u||!u&&e&&"object"===typeof e&&"function"===typeof t)n=t,s=e;else{"function"===typeof r&&(n=r,r=void 0);var c="function"===typeof n;try{s=i(e,t,r,{generator:this.options.generator,version:this.options.version,notificationIdNull:this.options.notificationIdNull})}catch(l){if(c)return n(l);throw l}if(!c)return s}try{o=JSON.stringify(s,this.options.replacer)}catch(l){return n(l)}return this.callServer(o,(function(e,t){a._parseResponse(e,t,n)})),s},o.prototype._parseResponse=function(e,t,r){if(e)r(e);else{if(!t)return r();var n;try{n=JSON.parse(t,this.options.reviver)}catch(e){return r(e)}if(3===r.length){if(Array.isArray(n)){var i=function(e){return"undefined"!==typeof e.error};return r(null,n.filter(i),n.filter((function(e){return!i(e)})))}return r(null,n.error,n.result)}r(null,n)}}},9353:function(e,t,r){"use strict";var n=r(3741).v4;e.exports=function(e,t,r,i){if("string"!==typeof e)throw new TypeError(e+" must be a string");var o="number"===typeof(i=i||{}).version?i.version:2;if(1!==o&&2!==o)throw new TypeError(o+" must be 1 or 2");var a={method:e};if(2===o&&(a.jsonrpc="2.0"),t){if("object"!==typeof t&&!Array.isArray(t))throw new TypeError(t+" must be an object, array or omitted");a.params=t}if("undefined"===typeof r){var s="function"===typeof i.generator?i.generator:function(){return n()};a.id=s(a,i)}else 2===o&&null===r?i.notificationIdNull&&(a.id=null):a.id=r;return a}},1426:function(e){var t,r,n=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function a(e){if(t===setTimeout)return setTimeout(e,0);if((t===i||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(r){try{return t.call(null,e,0)}catch(r){return t.call(this,e,0)}}}!function(){try{t="function"===typeof setTimeout?setTimeout:i}catch(e){t=i}try{r="function"===typeof clearTimeout?clearTimeout:o}catch(e){r=o}}();var s,u=[],c=!1,l=-1;function h(){c&&s&&(c=!1,s.length?u=s.concat(u):l=-1,u.length&&f())}function f(){if(!c){var e=a(h);c=!0;for(var t=u.length;t;){for(s=u,u=[];++l<t;)s&&s[l].run();l=-1,t=u.length}s=null,c=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===o||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{return r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function d(e,t){this.fun=e,this.array=t}function p(){}n.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];u.push(new d(e,t)),1!==u.length||c||a(f)},d.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=p,n.addListener=p,n.once=p,n.off=p,n.removeListener=p,n.removeAllListeners=p,n.emit=p,n.prependListener=p,n.prependOnceListener=p,n.listeners=function(e){return[]},n.binding=function(e){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},4463:function(e,t,r){"use strict";var n=r(2791),i=r(5296);function o(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var a=new Set,s={};function u(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(s[e]=t,e=0;e<t.length;e++)a.add(t[e])}var l=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),h=Object.prototype.hasOwnProperty,f=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,d={},p={};function m(e,t,r,n,i,o,a){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=n,this.attributeNamespace=i,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=a}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){g[e]=new m(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];g[t]=new m(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){g[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){g[e]=new m(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){g[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){g[e]=new m(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){g[e]=new m(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){g[e]=new m(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){g[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)}));var y=/[\-:]([a-z])/g;function v(e){return e[1].toUpperCase()}function _(e,t,r,n){var i=g.hasOwnProperty(t)?g[t]:null;(null!==i?0!==i.type:n||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,r,n){if(null===t||"undefined"===typeof t||function(e,t,r,n){if(null!==r&&0===r.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!n&&(null!==r?!r.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,r,n))return!0;if(n)return!1;if(null!==r)switch(r.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,r,i,n)&&(r=null),n||null===i?function(e){return!!h.call(p,e)||!h.call(d,e)&&(f.test(e)?p[e]=!0:(d[e]=!0,!1))}(t)&&(null===r?e.removeAttribute(t):e.setAttribute(t,""+r)):i.mustUseProperty?e[i.propertyName]=null===r?3!==i.type&&"":r:(t=i.attributeName,n=i.attributeNamespace,null===r?e.removeAttribute(t):(r=3===(i=i.type)||4===i&&!0===r?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(y,v);g[t]=new m(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(y,v);g[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(y,v);g[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)})),g.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)}));var b=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,x=Symbol.for("react.element"),w=Symbol.for("react.portal"),k=Symbol.for("react.fragment"),A=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),S=Symbol.for("react.provider"),T=Symbol.for("react.context"),M=Symbol.for("react.forward_ref"),I=Symbol.for("react.suspense"),P=Symbol.for("react.suspense_list"),C=Symbol.for("react.memo"),B=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var D=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var R=Symbol.iterator;function L(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=R&&e[R]||e["@@iterator"])?e:null}var O,z=Object.assign;function N(e){if(void 0===O)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);O=t&&t[1]||""}return"\n"+O+e}var U=!1;function Z(e,t){if(!e||U)return"";U=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&"string"===typeof c.stack){for(var i=c.stack.split("\n"),o=n.stack.split("\n"),a=i.length-1,s=o.length-1;1<=a&&0<=s&&i[a]!==o[s];)s--;for(;1<=a&&0<=s;a--,s--)if(i[a]!==o[s]){if(1!==a||1!==s)do{if(a--,0>--s||i[a]!==o[s]){var u="\n"+i[a].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}}while(1<=a&&0<=s);break}}}finally{U=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?N(e):""}function F(e){switch(e.tag){case 5:return N(e.type);case 16:return N("Lazy");case 13:return N("Suspense");case 19:return N("SuspenseList");case 0:case 2:case 15:return e=Z(e.type,!1);case 11:return e=Z(e.type.render,!1);case 1:return e=Z(e.type,!0);default:return""}}function j(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case k:return"Fragment";case w:return"Portal";case E:return"Profiler";case A:return"StrictMode";case I:return"Suspense";case P:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case T:return(e.displayName||"Context")+".Consumer";case S:return(e._context.displayName||"Context")+".Provider";case M:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case C:return null!==(t=e.displayName||null)?t:j(e.type)||"Memo";case B:t=e._payload,e=e._init;try{return j(e(t))}catch(r){}}return null}function V(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return j(t);case 8:return t===A?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function W(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function K(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function G(e){e._valueTracker||(e._valueTracker=function(e){var t=K(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof r&&"function"===typeof r.get&&"function"===typeof r.set){var i=r.get,o=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){n=""+e,o.call(this,e)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(e){n=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function H(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=K(e)?e.checked?"true":"false":e.value),(e=n)!==r&&(t.setValue(e),!0)}function q(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Y(e,t){var r=t.checked;return z({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=r?r:e._wrapperState.initialChecked})}function X(e,t){var r=null==t.defaultValue?"":t.defaultValue,n=null!=t.checked?t.checked:t.defaultChecked;r=W(null!=t.value?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Q(e,t){null!=(t=t.checked)&&_(e,"checked",t,!1)}function $(e,t){Q(e,t);var r=W(t.value),n=t.type;if(null!=r)"number"===n?(0===r&&""===e.value||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if("submit"===n||"reset"===n)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,r):t.hasOwnProperty("defaultValue")&&ee(e,t.type,W(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function J(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!("submit"!==n&&"reset"!==n||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}""!==(r=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==r&&(e.name=r)}function ee(e,t,r){"number"===t&&q(e.ownerDocument)===e||(null==r?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var te=Array.isArray;function re(e,t,r,n){if(e=e.options,t){t={};for(var i=0;i<r.length;i++)t["$"+r[i]]=!0;for(r=0;r<e.length;r++)i=t.hasOwnProperty("$"+e[r].value),e[r].selected!==i&&(e[r].selected=i),i&&n&&(e[r].defaultSelected=!0)}else{for(r=""+W(r),t=null,i=0;i<e.length;i++){if(e[i].value===r)return e[i].selected=!0,void(n&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function ne(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(o(91));return z({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ie(e,t){var r=t.value;if(null==r){if(r=t.children,t=t.defaultValue,null!=r){if(null!=t)throw Error(o(92));if(te(r)){if(1<r.length)throw Error(o(93));r=r[0]}t=r}null==t&&(t=""),r=t}e._wrapperState={initialValue:W(r)}}function oe(e,t){var r=W(t.value),n=W(t.defaultValue);null!=r&&((r=""+r)!==e.value&&(e.value=r),null==t.defaultValue&&e.defaultValue!==r&&(e.defaultValue=r)),null!=n&&(e.defaultValue=""+n)}function ae(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function se(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ue(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?se(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,le,he=(le=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,r,n){MSApp.execUnsafeLocalFunction((function(){return le(e,t)}))}:le);function fe(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&3===r.nodeType)return void(r.nodeValue=t)}e.textContent=t}var de={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pe=["Webkit","ms","Moz","O"];function me(e,t,r){return null==t||"boolean"===typeof t||""===t?"":r||"number"!==typeof t||0===t||de.hasOwnProperty(e)&&de[e]?(""+t).trim():t+"px"}function ge(e,t){for(var r in e=e.style,t)if(t.hasOwnProperty(r)){var n=0===r.indexOf("--"),i=me(r,t[r],n);"float"===r&&(r="cssFloat"),n?e.setProperty(r,i):e[r]=i}}Object.keys(de).forEach((function(e){pe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),de[t]=de[e]}))}));var ye=z({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ve(e,t){if(t){if(ye[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(o(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(o(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(o(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(o(62))}}function _e(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var be=null;function xe(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var we=null,ke=null,Ae=null;function Ee(e){if(e=_i(e)){if("function"!==typeof we)throw Error(o(280));var t=e.stateNode;t&&(t=xi(t),we(e.stateNode,e.type,t))}}function Se(e){ke?Ae?Ae.push(e):Ae=[e]:ke=e}function Te(){if(ke){var e=ke,t=Ae;if(Ae=ke=null,Ee(e),t)for(e=0;e<t.length;e++)Ee(t[e])}}function Me(e,t){return e(t)}function Ie(){}var Pe=!1;function Ce(e,t,r){if(Pe)return e(t,r);Pe=!0;try{return Me(e,t,r)}finally{Pe=!1,(null!==ke||null!==Ae)&&(Ie(),Te())}}function Be(e,t){var r=e.stateNode;if(null===r)return null;var n=xi(r);if(null===n)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(n=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!n;break e;default:e=!1}if(e)return null;if(r&&"function"!==typeof r)throw Error(o(231,t,typeof r));return r}var De=!1;if(l)try{var Re={};Object.defineProperty(Re,"passive",{get:function(){De=!0}}),window.addEventListener("test",Re,Re),window.removeEventListener("test",Re,Re)}catch(le){De=!1}function Le(e,t,r,n,i,o,a,s,u){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(l){this.onError(l)}}var Oe=!1,ze=null,Ne=!1,Ue=null,Ze={onError:function(e){Oe=!0,ze=e}};function Fe(e,t,r,n,i,o,a,s,u){Oe=!1,ze=null,Le.apply(Ze,arguments)}function je(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(r=t.return),e=t.return}while(e)}return 3===t.tag?r:null}function Ve(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function We(e){if(je(e)!==e)throw Error(o(188))}function Ke(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=je(e)))throw Error(o(188));return t!==e?null:e}for(var r=e,n=t;;){var i=r.return;if(null===i)break;var a=i.alternate;if(null===a){if(null!==(n=i.return)){r=n;continue}break}if(i.child===a.child){for(a=i.child;a;){if(a===r)return We(i),e;if(a===n)return We(i),t;a=a.sibling}throw Error(o(188))}if(r.return!==n.return)r=i,n=a;else{for(var s=!1,u=i.child;u;){if(u===r){s=!0,r=i,n=a;break}if(u===n){s=!0,n=i,r=a;break}u=u.sibling}if(!s){for(u=a.child;u;){if(u===r){s=!0,r=a,n=i;break}if(u===n){s=!0,n=a,r=i;break}u=u.sibling}if(!s)throw Error(o(189))}}if(r.alternate!==n)throw Error(o(190))}if(3!==r.tag)throw Error(o(188));return r.stateNode.current===r?e:t}(e))?Ge(e):null}function Ge(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ge(e);if(null!==t)return t;e=e.sibling}return null}var He=i.unstable_scheduleCallback,qe=i.unstable_cancelCallback,Ye=i.unstable_shouldYield,Xe=i.unstable_requestPaint,Qe=i.unstable_now,$e=i.unstable_getCurrentPriorityLevel,Je=i.unstable_ImmediatePriority,et=i.unstable_UserBlockingPriority,tt=i.unstable_NormalPriority,rt=i.unstable_LowPriority,nt=i.unstable_IdlePriority,it=null,ot=null;var at=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(st(e)/ut|0)|0},st=Math.log,ut=Math.LN2;var ct=64,lt=4194304;function ht(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ft(e,t){var r=e.pendingLanes;if(0===r)return 0;var n=0,i=e.suspendedLanes,o=e.pingedLanes,a=268435455&r;if(0!==a){var s=a&~i;0!==s?n=ht(s):0!==(o&=a)&&(n=ht(o))}else 0!==(a=r&~i)?n=ht(a):0!==o&&(n=ht(o));if(0===n)return 0;if(0!==t&&t!==n&&0===(t&i)&&((i=n&-n)>=(o=t&-t)||16===i&&0!==(4194240&o)))return t;if(0!==(4&n)&&(n|=16&r),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=n;0<t;)i=1<<(r=31-at(t)),n|=e[r],t&=~i;return n}function dt(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function pt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function mt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function gt(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function yt(e,t,r){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-at(t)]=r}function vt(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-at(r),i=1<<n;i&t|e[n]&t&&(e[n]|=t),r&=~i}}var _t=0;function bt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var xt,wt,kt,At,Et,St=!1,Tt=[],Mt=null,It=null,Pt=null,Ct=new Map,Bt=new Map,Dt=[],Rt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Lt(e,t){switch(e){case"focusin":case"focusout":Mt=null;break;case"dragenter":case"dragleave":It=null;break;case"mouseover":case"mouseout":Pt=null;break;case"pointerover":case"pointerout":Ct.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Bt.delete(t.pointerId)}}function Ot(e,t,r,n,i,o){return null===e||e.nativeEvent!==o?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:o,targetContainers:[i]},null!==t&&(null!==(t=_i(t))&&wt(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function zt(e){var t=vi(e.target);if(null!==t){var r=je(t);if(null!==r)if(13===(t=r.tag)){if(null!==(t=Ve(r)))return e.blockedOn=t,void Et(e.priority,(function(){kt(r)}))}else if(3===t&&r.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===r.tag?r.stateNode.containerInfo:null)}e.blockedOn=null}function Nt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var r=Yt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==r)return null!==(t=_i(r))&&wt(t),e.blockedOn=r,!1;var n=new(r=e.nativeEvent).constructor(r.type,r);be=n,r.target.dispatchEvent(n),be=null,t.shift()}return!0}function Ut(e,t,r){Nt(e)&&r.delete(t)}function Zt(){St=!1,null!==Mt&&Nt(Mt)&&(Mt=null),null!==It&&Nt(It)&&(It=null),null!==Pt&&Nt(Pt)&&(Pt=null),Ct.forEach(Ut),Bt.forEach(Ut)}function Ft(e,t){e.blockedOn===t&&(e.blockedOn=null,St||(St=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,Zt)))}function jt(e){function t(t){return Ft(t,e)}if(0<Tt.length){Ft(Tt[0],e);for(var r=1;r<Tt.length;r++){var n=Tt[r];n.blockedOn===e&&(n.blockedOn=null)}}for(null!==Mt&&Ft(Mt,e),null!==It&&Ft(It,e),null!==Pt&&Ft(Pt,e),Ct.forEach(t),Bt.forEach(t),r=0;r<Dt.length;r++)(n=Dt[r]).blockedOn===e&&(n.blockedOn=null);for(;0<Dt.length&&null===(r=Dt[0]).blockedOn;)zt(r),null===r.blockedOn&&Dt.shift()}var Vt=b.ReactCurrentBatchConfig,Wt=!0;function Kt(e,t,r,n){var i=_t,o=Vt.transition;Vt.transition=null;try{_t=1,Ht(e,t,r,n)}finally{_t=i,Vt.transition=o}}function Gt(e,t,r,n){var i=_t,o=Vt.transition;Vt.transition=null;try{_t=4,Ht(e,t,r,n)}finally{_t=i,Vt.transition=o}}function Ht(e,t,r,n){if(Wt){var i=Yt(e,t,r,n);if(null===i)Wn(e,t,n,qt,r),Lt(e,n);else if(function(e,t,r,n,i){switch(t){case"focusin":return Mt=Ot(Mt,e,t,r,n,i),!0;case"dragenter":return It=Ot(It,e,t,r,n,i),!0;case"mouseover":return Pt=Ot(Pt,e,t,r,n,i),!0;case"pointerover":var o=i.pointerId;return Ct.set(o,Ot(Ct.get(o)||null,e,t,r,n,i)),!0;case"gotpointercapture":return o=i.pointerId,Bt.set(o,Ot(Bt.get(o)||null,e,t,r,n,i)),!0}return!1}(i,e,t,r,n))n.stopPropagation();else if(Lt(e,n),4&t&&-1<Rt.indexOf(e)){for(;null!==i;){var o=_i(i);if(null!==o&&xt(o),null===(o=Yt(e,t,r,n))&&Wn(e,t,n,qt,r),o===i)break;i=o}null!==i&&n.stopPropagation()}else Wn(e,t,n,null,r)}}var qt=null;function Yt(e,t,r,n){if(qt=null,null!==(e=vi(e=xe(n))))if(null===(t=je(e)))e=null;else if(13===(r=t.tag)){if(null!==(e=Ve(t)))return e;e=null}else if(3===r){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return qt=e,null}function Xt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch($e()){case Je:return 1;case et:return 4;case tt:case rt:return 16;case nt:return 536870912;default:return 16}default:return 16}}var Qt=null,$t=null,Jt=null;function er(){if(Jt)return Jt;var e,t,r=$t,n=r.length,i="value"in Qt?Qt.value:Qt.textContent,o=i.length;for(e=0;e<n&&r[e]===i[e];e++);var a=n-e;for(t=1;t<=a&&r[n-t]===i[o-t];t++);return Jt=i.slice(e,1<t?1-t:void 0)}function tr(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function rr(){return!0}function nr(){return!1}function ir(e){function t(t,r,n,i,o){for(var a in this._reactName=t,this._targetInst=n,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null,e)e.hasOwnProperty(a)&&(t=e[a],this[a]=t?t(i):i[a]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?rr:nr,this.isPropagationStopped=nr,this}return z(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=rr)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=rr)},persist:function(){},isPersistent:rr}),t}var or,ar,sr,ur={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cr=ir(ur),lr=z({},ur,{view:0,detail:0}),hr=ir(lr),fr=z({},lr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ar,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==sr&&(sr&&"mousemove"===e.type?(or=e.screenX-sr.screenX,ar=e.screenY-sr.screenY):ar=or=0,sr=e),or)},movementY:function(e){return"movementY"in e?e.movementY:ar}}),dr=ir(fr),pr=ir(z({},fr,{dataTransfer:0})),mr=ir(z({},lr,{relatedTarget:0})),gr=ir(z({},ur,{animationName:0,elapsedTime:0,pseudoElement:0})),yr=z({},ur,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),vr=ir(yr),_r=ir(z({},ur,{data:0})),br={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},xr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},wr={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function kr(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=wr[e])&&!!t[e]}function Ar(){return kr}var Er=z({},lr,{key:function(e){if(e.key){var t=br[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=tr(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?xr[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ar,charCode:function(e){return"keypress"===e.type?tr(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?tr(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Sr=ir(Er),Tr=ir(z({},fr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Mr=ir(z({},lr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ar})),Ir=ir(z({},ur,{propertyName:0,elapsedTime:0,pseudoElement:0})),Pr=z({},fr,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Cr=ir(Pr),Br=[9,13,27,32],Dr=l&&"CompositionEvent"in window,Rr=null;l&&"documentMode"in document&&(Rr=document.documentMode);var Lr=l&&"TextEvent"in window&&!Rr,Or=l&&(!Dr||Rr&&8<Rr&&11>=Rr),zr=String.fromCharCode(32),Nr=!1;function Ur(e,t){switch(e){case"keyup":return-1!==Br.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Zr(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Fr=!1;var jr={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Vr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!jr[e.type]:"textarea"===t}function Wr(e,t,r,n){Se(n),0<(t=Gn(t,"onChange")).length&&(r=new cr("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Kr=null,Gr=null;function Hr(e){Nn(e,0)}function qr(e){if(H(bi(e)))return e}function Yr(e,t){if("change"===e)return t}var Xr=!1;if(l){var Qr;if(l){var $r="oninput"in document;if(!$r){var Jr=document.createElement("div");Jr.setAttribute("oninput","return;"),$r="function"===typeof Jr.oninput}Qr=$r}else Qr=!1;Xr=Qr&&(!document.documentMode||9<document.documentMode)}function en(){Kr&&(Kr.detachEvent("onpropertychange",tn),Gr=Kr=null)}function tn(e){if("value"===e.propertyName&&qr(Gr)){var t=[];Wr(t,Gr,e,xe(e)),Ce(Hr,t)}}function rn(e,t,r){"focusin"===e?(en(),Gr=r,(Kr=t).attachEvent("onpropertychange",tn)):"focusout"===e&&en()}function nn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return qr(Gr)}function on(e,t){if("click"===e)return qr(t)}function an(e,t){if("input"===e||"change"===e)return qr(t)}var sn="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function un(e,t){if(sn(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var i=r[n];if(!h.call(t,i)||!sn(e[i],t[i]))return!1}return!0}function cn(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ln(e,t){var r,n=cn(e);for(e=0;n;){if(3===n.nodeType){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=cn(n)}}function hn(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?hn(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function fn(){for(var e=window,t=q();t instanceof e.HTMLIFrameElement;){try{var r="string"===typeof t.contentWindow.location.href}catch(n){r=!1}if(!r)break;t=q((e=t.contentWindow).document)}return t}function dn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function pn(e){var t=fn(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&hn(r.ownerDocument.documentElement,r)){if(null!==n&&dn(r))if(t=n.start,void 0===(e=n.end)&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if((e=(t=r.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var i=r.textContent.length,o=Math.min(n.start,i);n=void 0===n.end?o:Math.min(n.end,i),!e.extend&&o>n&&(i=n,n=o,o=i),i=ln(r,o);var a=ln(r,n);i&&a&&(1!==e.rangeCount||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&((t=t.createRange()).setStart(i.node,i.offset),e.removeAllRanges(),o>n?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}for(t=[],e=r;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof r.focus&&r.focus(),r=0;r<t.length;r++)(e=t[r]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var mn=l&&"documentMode"in document&&11>=document.documentMode,gn=null,yn=null,vn=null,_n=!1;function bn(e,t,r){var n=r.window===r?r.document:9===r.nodeType?r:r.ownerDocument;_n||null==gn||gn!==q(n)||("selectionStart"in(n=gn)&&dn(n)?n={start:n.selectionStart,end:n.selectionEnd}:n={anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},vn&&un(vn,n)||(vn=n,0<(n=Gn(yn,"onSelect")).length&&(t=new cr("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=gn)))}function xn(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var wn={animationend:xn("Animation","AnimationEnd"),animationiteration:xn("Animation","AnimationIteration"),animationstart:xn("Animation","AnimationStart"),transitionend:xn("Transition","TransitionEnd")},kn={},An={};function En(e){if(kn[e])return kn[e];if(!wn[e])return e;var t,r=wn[e];for(t in r)if(r.hasOwnProperty(t)&&t in An)return kn[e]=r[t];return e}l&&(An=document.createElement("div").style,"AnimationEvent"in window||(delete wn.animationend.animation,delete wn.animationiteration.animation,delete wn.animationstart.animation),"TransitionEvent"in window||delete wn.transitionend.transition);var Sn=En("animationend"),Tn=En("animationiteration"),Mn=En("animationstart"),In=En("transitionend"),Pn=new Map,Cn="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Bn(e,t){Pn.set(e,t),u(t,[e])}for(var Dn=0;Dn<Cn.length;Dn++){var Rn=Cn[Dn];Bn(Rn.toLowerCase(),"on"+(Rn[0].toUpperCase()+Rn.slice(1)))}Bn(Sn,"onAnimationEnd"),Bn(Tn,"onAnimationIteration"),Bn(Mn,"onAnimationStart"),Bn("dblclick","onDoubleClick"),Bn("focusin","onFocus"),Bn("focusout","onBlur"),Bn(In,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),u("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),u("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),u("onBeforeInput",["compositionend","keypress","textInput","paste"]),u("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ln="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),On=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ln));function zn(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,function(e,t,r,n,i,a,s,u,c){if(Fe.apply(this,arguments),Oe){if(!Oe)throw Error(o(198));var l=ze;Oe=!1,ze=null,Ne||(Ne=!0,Ue=l)}}(n,t,void 0,e),e.currentTarget=null}function Nn(e,t){t=0!==(4&t);for(var r=0;r<e.length;r++){var n=e[r],i=n.event;n=n.listeners;e:{var o=void 0;if(t)for(var a=n.length-1;0<=a;a--){var s=n[a],u=s.instance,c=s.currentTarget;if(s=s.listener,u!==o&&i.isPropagationStopped())break e;zn(i,s,c),o=u}else for(a=0;a<n.length;a++){if(u=(s=n[a]).instance,c=s.currentTarget,s=s.listener,u!==o&&i.isPropagationStopped())break e;zn(i,s,c),o=u}}}if(Ne)throw e=Ue,Ne=!1,Ue=null,e}function Un(e,t){var r=t[mi];void 0===r&&(r=t[mi]=new Set);var n=e+"__bubble";r.has(n)||(Vn(t,e,2,!1),r.add(n))}function Zn(e,t,r){var n=0;t&&(n|=4),Vn(r,e,n,t)}var Fn="_reactListening"+Math.random().toString(36).slice(2);function jn(e){if(!e[Fn]){e[Fn]=!0,a.forEach((function(t){"selectionchange"!==t&&(On.has(t)||Zn(t,!1,e),Zn(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Fn]||(t[Fn]=!0,Zn("selectionchange",!1,t))}}function Vn(e,t,r,n){switch(Xt(t)){case 1:var i=Kt;break;case 4:i=Gt;break;default:i=Ht}r=i.bind(null,t,r,e),i=void 0,!De||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),n?void 0!==i?e.addEventListener(t,r,{capture:!0,passive:i}):e.addEventListener(t,r,!0):void 0!==i?e.addEventListener(t,r,{passive:i}):e.addEventListener(t,r,!1)}function Wn(e,t,r,n,i){var o=n;if(0===(1&t)&&0===(2&t)&&null!==n)e:for(;;){if(null===n)return;var a=n.tag;if(3===a||4===a){var s=n.stateNode.containerInfo;if(s===i||8===s.nodeType&&s.parentNode===i)break;if(4===a)for(a=n.return;null!==a;){var u=a.tag;if((3===u||4===u)&&((u=a.stateNode.containerInfo)===i||8===u.nodeType&&u.parentNode===i))return;a=a.return}for(;null!==s;){if(null===(a=vi(s)))return;if(5===(u=a.tag)||6===u){n=o=a;continue e}s=s.parentNode}}n=n.return}Ce((function(){var n=o,i=xe(r),a=[];e:{var s=Pn.get(e);if(void 0!==s){var u=cr,c=e;switch(e){case"keypress":if(0===tr(r))break e;case"keydown":case"keyup":u=Sr;break;case"focusin":c="focus",u=mr;break;case"focusout":c="blur",u=mr;break;case"beforeblur":case"afterblur":u=mr;break;case"click":if(2===r.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":u=dr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":u=pr;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":u=Mr;break;case Sn:case Tn:case Mn:u=gr;break;case In:u=Ir;break;case"scroll":u=hr;break;case"wheel":u=Cr;break;case"copy":case"cut":case"paste":u=vr;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":u=Tr}var l=0!==(4&t),h=!l&&"scroll"===e,f=l?null!==s?s+"Capture":null:s;l=[];for(var d,p=n;null!==p;){var m=(d=p).stateNode;if(5===d.tag&&null!==m&&(d=m,null!==f&&(null!=(m=Be(p,f))&&l.push(Kn(p,m,d)))),h)break;p=p.return}0<l.length&&(s=new u(s,c,null,r,i),a.push({event:s,listeners:l}))}}if(0===(7&t)){if(u="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||r===be||!(c=r.relatedTarget||r.fromElement)||!vi(c)&&!c[pi])&&(u||s)&&(s=i.window===i?i:(s=i.ownerDocument)?s.defaultView||s.parentWindow:window,u?(u=n,null!==(c=(c=r.relatedTarget||r.toElement)?vi(c):null)&&(c!==(h=je(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(u=null,c=n),u!==c)){if(l=dr,m="onMouseLeave",f="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(l=Tr,m="onPointerLeave",f="onPointerEnter",p="pointer"),h=null==u?s:bi(u),d=null==c?s:bi(c),(s=new l(m,p+"leave",u,r,i)).target=h,s.relatedTarget=d,m=null,vi(i)===n&&((l=new l(f,p+"enter",c,r,i)).target=d,l.relatedTarget=h,m=l),h=m,u&&c)e:{for(f=c,p=0,d=l=u;d;d=Hn(d))p++;for(d=0,m=f;m;m=Hn(m))d++;for(;0<p-d;)l=Hn(l),p--;for(;0<d-p;)f=Hn(f),d--;for(;p--;){if(l===f||null!==f&&l===f.alternate)break e;l=Hn(l),f=Hn(f)}l=null}else l=null;null!==u&&qn(a,s,u,l,!1),null!==c&&null!==h&&qn(a,h,c,l,!0)}if("select"===(u=(s=n?bi(n):window).nodeName&&s.nodeName.toLowerCase())||"input"===u&&"file"===s.type)var g=Yr;else if(Vr(s))if(Xr)g=an;else{g=nn;var y=rn}else(u=s.nodeName)&&"input"===u.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(g=on);switch(g&&(g=g(e,n))?Wr(a,g,r,i):(y&&y(e,s,n),"focusout"===e&&(y=s._wrapperState)&&y.controlled&&"number"===s.type&&ee(s,"number",s.value)),y=n?bi(n):window,e){case"focusin":(Vr(y)||"true"===y.contentEditable)&&(gn=y,yn=n,vn=null);break;case"focusout":vn=yn=gn=null;break;case"mousedown":_n=!0;break;case"contextmenu":case"mouseup":case"dragend":_n=!1,bn(a,r,i);break;case"selectionchange":if(mn)break;case"keydown":case"keyup":bn(a,r,i)}var v;if(Dr)e:{switch(e){case"compositionstart":var _="onCompositionStart";break e;case"compositionend":_="onCompositionEnd";break e;case"compositionupdate":_="onCompositionUpdate";break e}_=void 0}else Fr?Ur(e,r)&&(_="onCompositionEnd"):"keydown"===e&&229===r.keyCode&&(_="onCompositionStart");_&&(Or&&"ko"!==r.locale&&(Fr||"onCompositionStart"!==_?"onCompositionEnd"===_&&Fr&&(v=er()):($t="value"in(Qt=i)?Qt.value:Qt.textContent,Fr=!0)),0<(y=Gn(n,_)).length&&(_=new _r(_,e,null,r,i),a.push({event:_,listeners:y}),v?_.data=v:null!==(v=Zr(r))&&(_.data=v))),(v=Lr?function(e,t){switch(e){case"compositionend":return Zr(t);case"keypress":return 32!==t.which?null:(Nr=!0,zr);case"textInput":return(e=t.data)===zr&&Nr?null:e;default:return null}}(e,r):function(e,t){if(Fr)return"compositionend"===e||!Dr&&Ur(e,t)?(e=er(),Jt=$t=Qt=null,Fr=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Or&&"ko"!==t.locale?null:t.data}}(e,r))&&(0<(n=Gn(n,"onBeforeInput")).length&&(i=new _r("onBeforeInput","beforeinput",null,r,i),a.push({event:i,listeners:n}),i.data=v))}Nn(a,t)}))}function Kn(e,t,r){return{instance:e,listener:t,currentTarget:r}}function Gn(e,t){for(var r=t+"Capture",n=[];null!==e;){var i=e,o=i.stateNode;5===i.tag&&null!==o&&(i=o,null!=(o=Be(e,r))&&n.unshift(Kn(e,o,i)),null!=(o=Be(e,t))&&n.push(Kn(e,o,i))),e=e.return}return n}function Hn(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function qn(e,t,r,n,i){for(var o=t._reactName,a=[];null!==r&&r!==n;){var s=r,u=s.alternate,c=s.stateNode;if(null!==u&&u===n)break;5===s.tag&&null!==c&&(s=c,i?null!=(u=Be(r,o))&&a.unshift(Kn(r,u,s)):i||null!=(u=Be(r,o))&&a.push(Kn(r,u,s))),r=r.return}0!==a.length&&e.push({event:t,listeners:a})}var Yn=/\r\n?/g,Xn=/\u0000|\uFFFD/g;function Qn(e){return("string"===typeof e?e:""+e).replace(Yn,"\n").replace(Xn,"")}function $n(e,t,r){if(t=Qn(t),Qn(e)!==t&&r)throw Error(o(425))}function Jn(){}var ei=null,ti=null;function ri(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var ni="function"===typeof setTimeout?setTimeout:void 0,ii="function"===typeof clearTimeout?clearTimeout:void 0,oi="function"===typeof Promise?Promise:void 0,ai="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof oi?function(e){return oi.resolve(null).then(e).catch(si)}:ni;function si(e){setTimeout((function(){throw e}))}function ui(e,t){var r=t,n=0;do{var i=r.nextSibling;if(e.removeChild(r),i&&8===i.nodeType)if("/$"===(r=i.data)){if(0===n)return e.removeChild(i),void jt(t);n--}else"$"!==r&&"$?"!==r&&"$!"!==r||n++;r=i}while(r);jt(t)}function ci(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function li(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var r=e.data;if("$"===r||"$!"===r||"$?"===r){if(0===t)return e;t--}else"/$"===r&&t++}e=e.previousSibling}return null}var hi=Math.random().toString(36).slice(2),fi="__reactFiber$"+hi,di="__reactProps$"+hi,pi="__reactContainer$"+hi,mi="__reactEvents$"+hi,gi="__reactListeners$"+hi,yi="__reactHandles$"+hi;function vi(e){var t=e[fi];if(t)return t;for(var r=e.parentNode;r;){if(t=r[pi]||r[fi]){if(r=t.alternate,null!==t.child||null!==r&&null!==r.child)for(e=li(e);null!==e;){if(r=e[fi])return r;e=li(e)}return t}r=(e=r).parentNode}return null}function _i(e){return!(e=e[fi]||e[pi])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function bi(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(o(33))}function xi(e){return e[di]||null}var wi=[],ki=-1;function Ai(e){return{current:e}}function Ei(e){0>ki||(e.current=wi[ki],wi[ki]=null,ki--)}function Si(e,t){ki++,wi[ki]=e.current,e.current=t}var Ti={},Mi=Ai(Ti),Ii=Ai(!1),Pi=Ti;function Ci(e,t){var r=e.type.contextTypes;if(!r)return Ti;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var i,o={};for(i in r)o[i]=t[i];return n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function Bi(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Di(){Ei(Ii),Ei(Mi)}function Ri(e,t,r){if(Mi.current!==Ti)throw Error(o(168));Si(Mi,t),Si(Ii,r)}function Li(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,"function"!==typeof n.getChildContext)return r;for(var i in n=n.getChildContext())if(!(i in t))throw Error(o(108,V(e)||"Unknown",i));return z({},r,n)}function Oi(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ti,Pi=Mi.current,Si(Mi,e),Si(Ii,Ii.current),!0}function zi(e,t,r){var n=e.stateNode;if(!n)throw Error(o(169));r?(e=Li(e,t,Pi),n.__reactInternalMemoizedMergedChildContext=e,Ei(Ii),Ei(Mi),Si(Mi,e)):Ei(Ii),Si(Ii,r)}var Ni=null,Ui=!1,Zi=!1;function Fi(e){null===Ni?Ni=[e]:Ni.push(e)}function ji(){if(!Zi&&null!==Ni){Zi=!0;var e=0,t=_t;try{var r=Ni;for(_t=1;e<r.length;e++){var n=r[e];do{n=n(!0)}while(null!==n)}Ni=null,Ui=!1}catch(i){throw null!==Ni&&(Ni=Ni.slice(e+1)),He(Je,ji),i}finally{_t=t,Zi=!1}}return null}var Vi=[],Wi=0,Ki=null,Gi=0,Hi=[],qi=0,Yi=null,Xi=1,Qi="";function $i(e,t){Vi[Wi++]=Gi,Vi[Wi++]=Ki,Ki=e,Gi=t}function Ji(e,t,r){Hi[qi++]=Xi,Hi[qi++]=Qi,Hi[qi++]=Yi,Yi=e;var n=Xi;e=Qi;var i=32-at(n)-1;n&=~(1<<i),r+=1;var o=32-at(t)+i;if(30<o){var a=i-i%5;o=(n&(1<<a)-1).toString(32),n>>=a,i-=a,Xi=1<<32-at(t)+i|r<<i|n,Qi=o+e}else Xi=1<<o|r<<i|n,Qi=e}function eo(e){null!==e.return&&($i(e,1),Ji(e,1,0))}function to(e){for(;e===Ki;)Ki=Vi[--Wi],Vi[Wi]=null,Gi=Vi[--Wi],Vi[Wi]=null;for(;e===Yi;)Yi=Hi[--qi],Hi[qi]=null,Qi=Hi[--qi],Hi[qi]=null,Xi=Hi[--qi],Hi[qi]=null}var ro=null,no=null,io=!1,oo=null;function ao(e,t){var r=Bc(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,null===(t=e.deletions)?(e.deletions=[r],e.flags|=16):t.push(r)}function so(e,t){switch(e.tag){case 5:var r=e.type;return null!==(t=1!==t.nodeType||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ro=e,no=ci(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ro=e,no=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(r=null!==Yi?{id:Xi,overflow:Qi}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},(r=Bc(18,null,null,0)).stateNode=t,r.return=e,e.child=r,ro=e,no=null,!0);default:return!1}}function uo(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function co(e){if(io){var t=no;if(t){var r=t;if(!so(e,t)){if(uo(e))throw Error(o(418));t=ci(r.nextSibling);var n=ro;t&&so(e,t)?ao(n,r):(e.flags=-4097&e.flags|2,io=!1,ro=e)}}else{if(uo(e))throw Error(o(418));e.flags=-4097&e.flags|2,io=!1,ro=e}}}function lo(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ro=e}function ho(e){if(e!==ro)return!1;if(!io)return lo(e),io=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!ri(e.type,e.memoizedProps)),t&&(t=no)){if(uo(e))throw fo(),Error(o(418));for(;t;)ao(e,t),t=ci(t.nextSibling)}if(lo(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(o(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var r=e.data;if("/$"===r){if(0===t){no=ci(e.nextSibling);break e}t--}else"$"!==r&&"$!"!==r&&"$?"!==r||t++}e=e.nextSibling}no=null}}else no=ro?ci(e.stateNode.nextSibling):null;return!0}function fo(){for(var e=no;e;)e=ci(e.nextSibling)}function po(){no=ro=null,io=!1}function mo(e){null===oo?oo=[e]:oo.push(e)}var go=b.ReactCurrentBatchConfig;function yo(e,t){if(e&&e.defaultProps){for(var r in t=z({},t),e=e.defaultProps)void 0===t[r]&&(t[r]=e[r]);return t}return t}var vo=Ai(null),_o=null,bo=null,xo=null;function wo(){xo=bo=_o=null}function ko(e){var t=vo.current;Ei(vo),e._currentValue=t}function Ao(e,t,r){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==n&&(n.childLanes|=t)):null!==n&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function Eo(e,t){_o=e,xo=bo=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(bs=!0),e.firstContext=null)}function So(e){var t=e._currentValue;if(xo!==e)if(e={context:e,memoizedValue:t,next:null},null===bo){if(null===_o)throw Error(o(308));bo=e,_o.dependencies={lanes:0,firstContext:e}}else bo=bo.next=e;return t}var To=null;function Mo(e){null===To?To=[e]:To.push(e)}function Io(e,t,r,n){var i=t.interleaved;return null===i?(r.next=r,Mo(t)):(r.next=i.next,i.next=r),t.interleaved=r,Po(e,n)}function Po(e,t){e.lanes|=t;var r=e.alternate;for(null!==r&&(r.lanes|=t),r=e,e=e.return;null!==e;)e.childLanes|=t,null!==(r=e.alternate)&&(r.childLanes|=t),r=e,e=e.return;return 3===r.tag?r.stateNode:null}var Co=!1;function Bo(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Do(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ro(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Lo(e,t,r){var n=e.updateQueue;if(null===n)return null;if(n=n.shared,0!==(2&Iu)){var i=n.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),n.pending=t,Po(e,r)}return null===(i=n.interleaved)?(t.next=t,Mo(n)):(t.next=i.next,i.next=t),n.interleaved=t,Po(e,r)}function Oo(e,t,r){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&r))){var n=t.lanes;r|=n&=e.pendingLanes,t.lanes=r,vt(e,r)}}function zo(e,t){var r=e.updateQueue,n=e.alternate;if(null!==n&&r===(n=n.updateQueue)){var i=null,o=null;if(null!==(r=r.firstBaseUpdate)){do{var a={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};null===o?i=o=a:o=o.next=a,r=r.next}while(null!==r);null===o?i=o=t:o=o.next=t}else i=o=t;return r={baseState:n.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:n.shared,effects:n.effects},void(e.updateQueue=r)}null===(e=r.lastBaseUpdate)?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function No(e,t,r,n){var i=e.updateQueue;Co=!1;var o=i.firstBaseUpdate,a=i.lastBaseUpdate,s=i.shared.pending;if(null!==s){i.shared.pending=null;var u=s,c=u.next;u.next=null,null===a?o=c:a.next=c,a=u;var l=e.alternate;null!==l&&((s=(l=l.updateQueue).lastBaseUpdate)!==a&&(null===s?l.firstBaseUpdate=c:s.next=c,l.lastBaseUpdate=u))}if(null!==o){var h=i.baseState;for(a=0,l=c=u=null,s=o;;){var f=s.lane,d=s.eventTime;if((n&f)===f){null!==l&&(l=l.next={eventTime:d,lane:0,tag:s.tag,payload:s.payload,callback:s.callback,next:null});e:{var p=e,m=s;switch(f=t,d=r,m.tag){case 1:if("function"===typeof(p=m.payload)){h=p.call(d,h,f);break e}h=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(f="function"===typeof(p=m.payload)?p.call(d,h,f):p)||void 0===f)break e;h=z({},h,f);break e;case 2:Co=!0}}null!==s.callback&&0!==s.lane&&(e.flags|=64,null===(f=i.effects)?i.effects=[s]:f.push(s))}else d={eventTime:d,lane:f,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===l?(c=l=d,u=h):l=l.next=d,a|=f;if(null===(s=s.next)){if(null===(s=i.shared.pending))break;s=(f=s).next,f.next=null,i.lastBaseUpdate=f,i.shared.pending=null}}if(null===l&&(u=h),i.baseState=u,i.firstBaseUpdate=c,i.lastBaseUpdate=l,null!==(t=i.shared.interleaved)){i=t;do{a|=i.lane,i=i.next}while(i!==t)}else null===o&&(i.shared.lanes=0);zu|=a,e.lanes=a,e.memoizedState=h}}function Uo(e,t,r){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var n=e[t],i=n.callback;if(null!==i){if(n.callback=null,n=r,"function"!==typeof i)throw Error(o(191,i));i.call(n)}}}var Zo=(new n.Component).refs;function Fo(e,t,r,n){r=null===(r=r(n,t=e.memoizedState))||void 0===r?t:z({},t,r),e.memoizedState=r,0===e.lanes&&(e.updateQueue.baseState=r)}var jo={isMounted:function(e){return!!(e=e._reactInternals)&&je(e)===e},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=tc(),i=rc(e),o=Ro(n,i);o.payload=t,void 0!==r&&null!==r&&(o.callback=r),null!==(t=Lo(e,o,i))&&(nc(t,e,i,n),Oo(t,e,i))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=tc(),i=rc(e),o=Ro(n,i);o.tag=1,o.payload=t,void 0!==r&&null!==r&&(o.callback=r),null!==(t=Lo(e,o,i))&&(nc(t,e,i,n),Oo(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=tc(),n=rc(e),i=Ro(r,n);i.tag=2,void 0!==t&&null!==t&&(i.callback=t),null!==(t=Lo(e,i,n))&&(nc(t,e,n,r),Oo(t,e,n))}};function Vo(e,t,r,n,i,o,a){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(n,o,a):!t.prototype||!t.prototype.isPureReactComponent||(!un(r,n)||!un(i,o))}function Wo(e,t,r){var n=!1,i=Ti,o=t.contextType;return"object"===typeof o&&null!==o?o=So(o):(i=Bi(t)?Pi:Mi.current,o=(n=null!==(n=t.contextTypes)&&void 0!==n)?Ci(e,i):Ti),t=new t(r,o),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=jo,e.stateNode=t,t._reactInternals=e,n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=o),t}function Ko(e,t,r,n){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(r,n),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&jo.enqueueReplaceState(t,t.state,null)}function Go(e,t,r,n){var i=e.stateNode;i.props=r,i.state=e.memoizedState,i.refs=Zo,Bo(e);var o=t.contextType;"object"===typeof o&&null!==o?i.context=So(o):(o=Bi(t)?Pi:Mi.current,i.context=Ci(e,o)),i.state=e.memoizedState,"function"===typeof(o=t.getDerivedStateFromProps)&&(Fo(e,t,o,r),i.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(t=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&jo.enqueueReplaceState(i,i.state,null),No(e,r,i,n),i.state=e.memoizedState),"function"===typeof i.componentDidMount&&(e.flags|=4194308)}function Ho(e,t,r){if(null!==(e=r.ref)&&"function"!==typeof e&&"object"!==typeof e){if(r._owner){if(r=r._owner){if(1!==r.tag)throw Error(o(309));var n=r.stateNode}if(!n)throw Error(o(147,e));var i=n,a=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===a?t.ref:(t=function(e){var t=i.refs;t===Zo&&(t=i.refs={}),null===e?delete t[a]:t[a]=e},t._stringRef=a,t)}if("string"!==typeof e)throw Error(o(284));if(!r._owner)throw Error(o(290,e))}return e}function qo(e,t){throw e=Object.prototype.toString.call(t),Error(o(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Yo(e){return(0,e._init)(e._payload)}function Xo(e){function t(t,r){if(e){var n=t.deletions;null===n?(t.deletions=[r],t.flags|=16):n.push(r)}}function r(r,n){if(!e)return null;for(;null!==n;)t(r,n),n=n.sibling;return null}function n(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=Rc(e,t)).index=0,e.sibling=null,e}function a(t,r,n){return t.index=n,e?null!==(n=t.alternate)?(n=n.index)<r?(t.flags|=2,r):n:(t.flags|=2,r):(t.flags|=1048576,r)}function s(t){return e&&null===t.alternate&&(t.flags|=2),t}function u(e,t,r,n){return null===t||6!==t.tag?((t=Nc(r,e.mode,n)).return=e,t):((t=i(t,r)).return=e,t)}function c(e,t,r,n){var o=r.type;return o===k?h(e,t,r.props.children,n,r.key):null!==t&&(t.elementType===o||"object"===typeof o&&null!==o&&o.$$typeof===B&&Yo(o)===t.type)?((n=i(t,r.props)).ref=Ho(e,t,r),n.return=e,n):((n=Lc(r.type,r.key,r.props,null,e.mode,n)).ref=Ho(e,t,r),n.return=e,n)}function l(e,t,r,n){return null===t||4!==t.tag||t.stateNode.containerInfo!==r.containerInfo||t.stateNode.implementation!==r.implementation?((t=Uc(r,e.mode,n)).return=e,t):((t=i(t,r.children||[])).return=e,t)}function h(e,t,r,n,o){return null===t||7!==t.tag?((t=Oc(r,e.mode,n,o)).return=e,t):((t=i(t,r)).return=e,t)}function f(e,t,r){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Nc(""+t,e.mode,r)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case x:return(r=Lc(t.type,t.key,t.props,null,e.mode,r)).ref=Ho(e,null,t),r.return=e,r;case w:return(t=Uc(t,e.mode,r)).return=e,t;case B:return f(e,(0,t._init)(t._payload),r)}if(te(t)||L(t))return(t=Oc(t,e.mode,r,null)).return=e,t;qo(e,t)}return null}function d(e,t,r,n){var i=null!==t?t.key:null;if("string"===typeof r&&""!==r||"number"===typeof r)return null!==i?null:u(e,t,""+r,n);if("object"===typeof r&&null!==r){switch(r.$$typeof){case x:return r.key===i?c(e,t,r,n):null;case w:return r.key===i?l(e,t,r,n):null;case B:return d(e,t,(i=r._init)(r._payload),n)}if(te(r)||L(r))return null!==i?null:h(e,t,r,n,null);qo(e,r)}return null}function p(e,t,r,n,i){if("string"===typeof n&&""!==n||"number"===typeof n)return u(t,e=e.get(r)||null,""+n,i);if("object"===typeof n&&null!==n){switch(n.$$typeof){case x:return c(t,e=e.get(null===n.key?r:n.key)||null,n,i);case w:return l(t,e=e.get(null===n.key?r:n.key)||null,n,i);case B:return p(e,t,r,(0,n._init)(n._payload),i)}if(te(n)||L(n))return h(t,e=e.get(r)||null,n,i,null);qo(t,n)}return null}function m(i,o,s,u){for(var c=null,l=null,h=o,m=o=0,g=null;null!==h&&m<s.length;m++){h.index>m?(g=h,h=null):g=h.sibling;var y=d(i,h,s[m],u);if(null===y){null===h&&(h=g);break}e&&h&&null===y.alternate&&t(i,h),o=a(y,o,m),null===l?c=y:l.sibling=y,l=y,h=g}if(m===s.length)return r(i,h),io&&$i(i,m),c;if(null===h){for(;m<s.length;m++)null!==(h=f(i,s[m],u))&&(o=a(h,o,m),null===l?c=h:l.sibling=h,l=h);return io&&$i(i,m),c}for(h=n(i,h);m<s.length;m++)null!==(g=p(h,i,m,s[m],u))&&(e&&null!==g.alternate&&h.delete(null===g.key?m:g.key),o=a(g,o,m),null===l?c=g:l.sibling=g,l=g);return e&&h.forEach((function(e){return t(i,e)})),io&&$i(i,m),c}function g(i,s,u,c){var l=L(u);if("function"!==typeof l)throw Error(o(150));if(null==(u=l.call(u)))throw Error(o(151));for(var h=l=null,m=s,g=s=0,y=null,v=u.next();null!==m&&!v.done;g++,v=u.next()){m.index>g?(y=m,m=null):y=m.sibling;var _=d(i,m,v.value,c);if(null===_){null===m&&(m=y);break}e&&m&&null===_.alternate&&t(i,m),s=a(_,s,g),null===h?l=_:h.sibling=_,h=_,m=y}if(v.done)return r(i,m),io&&$i(i,g),l;if(null===m){for(;!v.done;g++,v=u.next())null!==(v=f(i,v.value,c))&&(s=a(v,s,g),null===h?l=v:h.sibling=v,h=v);return io&&$i(i,g),l}for(m=n(i,m);!v.done;g++,v=u.next())null!==(v=p(m,i,g,v.value,c))&&(e&&null!==v.alternate&&m.delete(null===v.key?g:v.key),s=a(v,s,g),null===h?l=v:h.sibling=v,h=v);return e&&m.forEach((function(e){return t(i,e)})),io&&$i(i,g),l}return function e(n,o,a,u){if("object"===typeof a&&null!==a&&a.type===k&&null===a.key&&(a=a.props.children),"object"===typeof a&&null!==a){switch(a.$$typeof){case x:e:{for(var c=a.key,l=o;null!==l;){if(l.key===c){if((c=a.type)===k){if(7===l.tag){r(n,l.sibling),(o=i(l,a.props.children)).return=n,n=o;break e}}else if(l.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===B&&Yo(c)===l.type){r(n,l.sibling),(o=i(l,a.props)).ref=Ho(n,l,a),o.return=n,n=o;break e}r(n,l);break}t(n,l),l=l.sibling}a.type===k?((o=Oc(a.props.children,n.mode,u,a.key)).return=n,n=o):((u=Lc(a.type,a.key,a.props,null,n.mode,u)).ref=Ho(n,o,a),u.return=n,n=u)}return s(n);case w:e:{for(l=a.key;null!==o;){if(o.key===l){if(4===o.tag&&o.stateNode.containerInfo===a.containerInfo&&o.stateNode.implementation===a.implementation){r(n,o.sibling),(o=i(o,a.children||[])).return=n,n=o;break e}r(n,o);break}t(n,o),o=o.sibling}(o=Uc(a,n.mode,u)).return=n,n=o}return s(n);case B:return e(n,o,(l=a._init)(a._payload),u)}if(te(a))return m(n,o,a,u);if(L(a))return g(n,o,a,u);qo(n,a)}return"string"===typeof a&&""!==a||"number"===typeof a?(a=""+a,null!==o&&6===o.tag?(r(n,o.sibling),(o=i(o,a)).return=n,n=o):(r(n,o),(o=Nc(a,n.mode,u)).return=n,n=o),s(n)):r(n,o)}}var Qo=Xo(!0),$o=Xo(!1),Jo={},ea=Ai(Jo),ta=Ai(Jo),ra=Ai(Jo);function na(e){if(e===Jo)throw Error(o(174));return e}function ia(e,t){switch(Si(ra,t),Si(ta,e),Si(ea,Jo),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:ue(null,"");break;default:t=ue(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Ei(ea),Si(ea,t)}function oa(){Ei(ea),Ei(ta),Ei(ra)}function aa(e){na(ra.current);var t=na(ea.current),r=ue(t,e.type);t!==r&&(Si(ta,e),Si(ea,r))}function sa(e){ta.current===e&&(Ei(ea),Ei(ta))}var ua=Ai(0);function ca(e){for(var t=e;null!==t;){if(13===t.tag){var r=t.memoizedState;if(null!==r&&(null===(r=r.dehydrated)||"$?"===r.data||"$!"===r.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var la=[];function ha(){for(var e=0;e<la.length;e++)la[e]._workInProgressVersionPrimary=null;la.length=0}var fa=b.ReactCurrentDispatcher,da=b.ReactCurrentBatchConfig,pa=0,ma=null,ga=null,ya=null,va=!1,_a=!1,ba=0,xa=0;function wa(){throw Error(o(321))}function ka(e,t){if(null===t)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!sn(e[r],t[r]))return!1;return!0}function Aa(e,t,r,n,i,a){if(pa=a,ma=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,fa.current=null===e||null===e.memoizedState?ss:us,e=r(n,i),_a){a=0;do{if(_a=!1,ba=0,25<=a)throw Error(o(301));a+=1,ya=ga=null,t.updateQueue=null,fa.current=cs,e=r(n,i)}while(_a)}if(fa.current=as,t=null!==ga&&null!==ga.next,pa=0,ya=ga=ma=null,va=!1,t)throw Error(o(300));return e}function Ea(){var e=0!==ba;return ba=0,e}function Sa(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ya?ma.memoizedState=ya=e:ya=ya.next=e,ya}function Ta(){if(null===ga){var e=ma.alternate;e=null!==e?e.memoizedState:null}else e=ga.next;var t=null===ya?ma.memoizedState:ya.next;if(null!==t)ya=t,ga=e;else{if(null===e)throw Error(o(310));e={memoizedState:(ga=e).memoizedState,baseState:ga.baseState,baseQueue:ga.baseQueue,queue:ga.queue,next:null},null===ya?ma.memoizedState=ya=e:ya=ya.next=e}return ya}function Ma(e,t){return"function"===typeof t?t(e):t}function Ia(e){var t=Ta(),r=t.queue;if(null===r)throw Error(o(311));r.lastRenderedReducer=e;var n=ga,i=n.baseQueue,a=r.pending;if(null!==a){if(null!==i){var s=i.next;i.next=a.next,a.next=s}n.baseQueue=i=a,r.pending=null}if(null!==i){a=i.next,n=n.baseState;var u=s=null,c=null,l=a;do{var h=l.lane;if((pa&h)===h)null!==c&&(c=c.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),n=l.hasEagerState?l.eagerState:e(n,l.action);else{var f={lane:h,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};null===c?(u=c=f,s=n):c=c.next=f,ma.lanes|=h,zu|=h}l=l.next}while(null!==l&&l!==a);null===c?s=n:c.next=u,sn(n,t.memoizedState)||(bs=!0),t.memoizedState=n,t.baseState=s,t.baseQueue=c,r.lastRenderedState=n}if(null!==(e=r.interleaved)){i=e;do{a=i.lane,ma.lanes|=a,zu|=a,i=i.next}while(i!==e)}else null===i&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function Pa(e){var t=Ta(),r=t.queue;if(null===r)throw Error(o(311));r.lastRenderedReducer=e;var n=r.dispatch,i=r.pending,a=t.memoizedState;if(null!==i){r.pending=null;var s=i=i.next;do{a=e(a,s.action),s=s.next}while(s!==i);sn(a,t.memoizedState)||(bs=!0),t.memoizedState=a,null===t.baseQueue&&(t.baseState=a),r.lastRenderedState=a}return[a,n]}function Ca(){}function Ba(e,t){var r=ma,n=Ta(),i=t(),a=!sn(n.memoizedState,i);if(a&&(n.memoizedState=i,bs=!0),n=n.queue,Wa(La.bind(null,r,n,e),[e]),n.getSnapshot!==t||a||null!==ya&&1&ya.memoizedState.tag){if(r.flags|=2048,Ua(9,Ra.bind(null,r,n,i,t),void 0,null),null===Pu)throw Error(o(349));0!==(30&pa)||Da(r,t,i)}return i}function Da(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},null===(t=ma.updateQueue)?(t={lastEffect:null,stores:null},ma.updateQueue=t,t.stores=[e]):null===(r=t.stores)?t.stores=[e]:r.push(e)}function Ra(e,t,r,n){t.value=r,t.getSnapshot=n,Oa(t)&&za(e)}function La(e,t,r){return r((function(){Oa(t)&&za(e)}))}function Oa(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!sn(e,r)}catch(n){return!0}}function za(e){var t=Po(e,1);null!==t&&nc(t,e,1,-1)}function Na(e){var t=Sa();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ma,lastRenderedState:e},t.queue=e,e=e.dispatch=rs.bind(null,ma,e),[t.memoizedState,e]}function Ua(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},null===(t=ma.updateQueue)?(t={lastEffect:null,stores:null},ma.updateQueue=t,t.lastEffect=e.next=e):null===(r=t.lastEffect)?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e),e}function Za(){return Ta().memoizedState}function Fa(e,t,r,n){var i=Sa();ma.flags|=e,i.memoizedState=Ua(1|t,r,void 0,void 0===n?null:n)}function ja(e,t,r,n){var i=Ta();n=void 0===n?null:n;var o=void 0;if(null!==ga){var a=ga.memoizedState;if(o=a.destroy,null!==n&&ka(n,a.deps))return void(i.memoizedState=Ua(t,r,o,n))}ma.flags|=e,i.memoizedState=Ua(1|t,r,o,n)}function Va(e,t){return Fa(8390656,8,e,t)}function Wa(e,t){return ja(2048,8,e,t)}function Ka(e,t){return ja(4,2,e,t)}function Ga(e,t){return ja(4,4,e,t)}function Ha(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function qa(e,t,r){return r=null!==r&&void 0!==r?r.concat([e]):null,ja(4,4,Ha.bind(null,t,e),r)}function Ya(){}function Xa(e,t){var r=Ta();t=void 0===t?null:t;var n=r.memoizedState;return null!==n&&null!==t&&ka(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function Qa(e,t){var r=Ta();t=void 0===t?null:t;var n=r.memoizedState;return null!==n&&null!==t&&ka(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function $a(e,t,r){return 0===(21&pa)?(e.baseState&&(e.baseState=!1,bs=!0),e.memoizedState=r):(sn(r,t)||(r=mt(),ma.lanes|=r,zu|=r,e.baseState=!0),t)}function Ja(e,t){var r=_t;_t=0!==r&&4>r?r:4,e(!0);var n=da.transition;da.transition={};try{e(!1),t()}finally{_t=r,da.transition=n}}function es(){return Ta().memoizedState}function ts(e,t,r){var n=rc(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},ns(e))is(t,r);else if(null!==(r=Io(e,t,r,n))){nc(r,e,n,tc()),os(r,t,n)}}function rs(e,t,r){var n=rc(e),i={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(ns(e))is(t,i);else{var o=e.alternate;if(0===e.lanes&&(null===o||0===o.lanes)&&null!==(o=t.lastRenderedReducer))try{var a=t.lastRenderedState,s=o(a,r);if(i.hasEagerState=!0,i.eagerState=s,sn(s,a)){var u=t.interleaved;return null===u?(i.next=i,Mo(t)):(i.next=u.next,u.next=i),void(t.interleaved=i)}}catch(c){}null!==(r=Io(e,t,i,n))&&(nc(r,e,n,i=tc()),os(r,t,n))}}function ns(e){var t=e.alternate;return e===ma||null!==t&&t===ma}function is(e,t){_a=va=!0;var r=e.pending;null===r?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function os(e,t,r){if(0!==(4194240&r)){var n=t.lanes;r|=n&=e.pendingLanes,t.lanes=r,vt(e,r)}}var as={readContext:So,useCallback:wa,useContext:wa,useEffect:wa,useImperativeHandle:wa,useInsertionEffect:wa,useLayoutEffect:wa,useMemo:wa,useReducer:wa,useRef:wa,useState:wa,useDebugValue:wa,useDeferredValue:wa,useTransition:wa,useMutableSource:wa,useSyncExternalStore:wa,useId:wa,unstable_isNewReconciler:!1},ss={readContext:So,useCallback:function(e,t){return Sa().memoizedState=[e,void 0===t?null:t],e},useContext:So,useEffect:Va,useImperativeHandle:function(e,t,r){return r=null!==r&&void 0!==r?r.concat([e]):null,Fa(4194308,4,Ha.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Fa(4194308,4,e,t)},useInsertionEffect:function(e,t){return Fa(4,2,e,t)},useMemo:function(e,t){var r=Sa();return t=void 0===t?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=Sa();return t=void 0!==r?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=ts.bind(null,ma,e),[n.memoizedState,e]},useRef:function(e){return e={current:e},Sa().memoizedState=e},useState:Na,useDebugValue:Ya,useDeferredValue:function(e){return Sa().memoizedState=e},useTransition:function(){var e=Na(!1),t=e[0];return e=Ja.bind(null,e[1]),Sa().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=ma,i=Sa();if(io){if(void 0===r)throw Error(o(407));r=r()}else{if(r=t(),null===Pu)throw Error(o(349));0!==(30&pa)||Da(n,t,r)}i.memoizedState=r;var a={value:r,getSnapshot:t};return i.queue=a,Va(La.bind(null,n,a,e),[e]),n.flags|=2048,Ua(9,Ra.bind(null,n,a,r,t),void 0,null),r},useId:function(){var e=Sa(),t=Pu.identifierPrefix;if(io){var r=Qi;t=":"+t+"R"+(r=(Xi&~(1<<32-at(Xi)-1)).toString(32)+r),0<(r=ba++)&&(t+="H"+r.toString(32)),t+=":"}else t=":"+t+"r"+(r=xa++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},us={readContext:So,useCallback:Xa,useContext:So,useEffect:Wa,useImperativeHandle:qa,useInsertionEffect:Ka,useLayoutEffect:Ga,useMemo:Qa,useReducer:Ia,useRef:Za,useState:function(){return Ia(Ma)},useDebugValue:Ya,useDeferredValue:function(e){return $a(Ta(),ga.memoizedState,e)},useTransition:function(){return[Ia(Ma)[0],Ta().memoizedState]},useMutableSource:Ca,useSyncExternalStore:Ba,useId:es,unstable_isNewReconciler:!1},cs={readContext:So,useCallback:Xa,useContext:So,useEffect:Wa,useImperativeHandle:qa,useInsertionEffect:Ka,useLayoutEffect:Ga,useMemo:Qa,useReducer:Pa,useRef:Za,useState:function(){return Pa(Ma)},useDebugValue:Ya,useDeferredValue:function(e){var t=Ta();return null===ga?t.memoizedState=e:$a(t,ga.memoizedState,e)},useTransition:function(){return[Pa(Ma)[0],Ta().memoizedState]},useMutableSource:Ca,useSyncExternalStore:Ba,useId:es,unstable_isNewReconciler:!1};function ls(e,t){try{var r="",n=t;do{r+=F(n),n=n.return}while(n);var i=r}catch(o){i="\nError generating stack: "+o.message+"\n"+o.stack}return{value:e,source:t,stack:i,digest:null}}function hs(e,t,r){return{value:e,source:null,stack:null!=r?r:null,digest:null!=t?t:null}}function fs(e,t){try{console.error(t.value)}catch(r){setTimeout((function(){throw r}))}}var ds="function"===typeof WeakMap?WeakMap:Map;function ps(e,t,r){(r=Ro(-1,r)).tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){Ku||(Ku=!0,Gu=n),fs(0,t)},r}function ms(e,t,r){(r=Ro(-1,r)).tag=3;var n=e.type.getDerivedStateFromError;if("function"===typeof n){var i=t.value;r.payload=function(){return n(i)},r.callback=function(){fs(0,t)}}var o=e.stateNode;return null!==o&&"function"===typeof o.componentDidCatch&&(r.callback=function(){fs(0,t),"function"!==typeof n&&(null===Hu?Hu=new Set([this]):Hu.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),r}function gs(e,t,r){var n=e.pingCache;if(null===n){n=e.pingCache=new ds;var i=new Set;n.set(t,i)}else void 0===(i=n.get(t))&&(i=new Set,n.set(t,i));i.has(r)||(i.add(r),e=Sc.bind(null,e,t,r),t.then(e,e))}function ys(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function vs(e,t,r,n,i){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,1===r.tag&&(null===r.alternate?r.tag=17:((t=Ro(-1,1)).tag=2,Lo(r,t,1))),r.lanes|=1),e):(e.flags|=65536,e.lanes=i,e)}var _s=b.ReactCurrentOwner,bs=!1;function xs(e,t,r,n){t.child=null===e?$o(t,null,r,n):Qo(t,e.child,r,n)}function ws(e,t,r,n,i){r=r.render;var o=t.ref;return Eo(t,i),n=Aa(e,t,r,n,o,i),r=Ea(),null===e||bs?(io&&r&&eo(t),t.flags|=1,xs(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Ks(e,t,i))}function ks(e,t,r,n,i){if(null===e){var o=r.type;return"function"!==typeof o||Dc(o)||void 0!==o.defaultProps||null!==r.compare||void 0!==r.defaultProps?((e=Lc(r.type,null,n,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=o,As(e,t,o,n,i))}if(o=e.child,0===(e.lanes&i)){var a=o.memoizedProps;if((r=null!==(r=r.compare)?r:un)(a,n)&&e.ref===t.ref)return Ks(e,t,i)}return t.flags|=1,(e=Rc(o,n)).ref=t.ref,e.return=t,t.child=e}function As(e,t,r,n,i){if(null!==e){var o=e.memoizedProps;if(un(o,n)&&e.ref===t.ref){if(bs=!1,t.pendingProps=n=o,0===(e.lanes&i))return t.lanes=e.lanes,Ks(e,t,i);0!==(131072&e.flags)&&(bs=!0)}}return Ts(e,t,r,n,i)}function Es(e,t,r){var n=t.pendingProps,i=n.children,o=null!==e?e.memoizedState:null;if("hidden"===n.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Si(Ru,Du),Du|=r;else{if(0===(1073741824&r))return e=null!==o?o.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Si(Ru,Du),Du|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=null!==o?o.baseLanes:r,Si(Ru,Du),Du|=n}else null!==o?(n=o.baseLanes|r,t.memoizedState=null):n=r,Si(Ru,Du),Du|=n;return xs(e,t,i,r),t.child}function Ss(e,t){var r=t.ref;(null===e&&null!==r||null!==e&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function Ts(e,t,r,n,i){var o=Bi(r)?Pi:Mi.current;return o=Ci(t,o),Eo(t,i),r=Aa(e,t,r,n,o,i),n=Ea(),null===e||bs?(io&&n&&eo(t),t.flags|=1,xs(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Ks(e,t,i))}function Ms(e,t,r,n,i){if(Bi(r)){var o=!0;Oi(t)}else o=!1;if(Eo(t,i),null===t.stateNode)Ws(e,t),Wo(t,r,n),Go(t,r,n,i),n=!0;else if(null===e){var a=t.stateNode,s=t.memoizedProps;a.props=s;var u=a.context,c=r.contextType;"object"===typeof c&&null!==c?c=So(c):c=Ci(t,c=Bi(r)?Pi:Mi.current);var l=r.getDerivedStateFromProps,h="function"===typeof l||"function"===typeof a.getSnapshotBeforeUpdate;h||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(s!==n||u!==c)&&Ko(t,a,n,c),Co=!1;var f=t.memoizedState;a.state=f,No(t,n,a,i),u=t.memoizedState,s!==n||f!==u||Ii.current||Co?("function"===typeof l&&(Fo(t,r,l,n),u=t.memoizedState),(s=Co||Vo(t,r,s,n,f,u,c))?(h||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||("function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"===typeof a.componentDidMount&&(t.flags|=4194308)):("function"===typeof a.componentDidMount&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=u),a.props=n,a.state=u,a.context=c,n=s):("function"===typeof a.componentDidMount&&(t.flags|=4194308),n=!1)}else{a=t.stateNode,Do(e,t),s=t.memoizedProps,c=t.type===t.elementType?s:yo(t.type,s),a.props=c,h=t.pendingProps,f=a.context,"object"===typeof(u=r.contextType)&&null!==u?u=So(u):u=Ci(t,u=Bi(r)?Pi:Mi.current);var d=r.getDerivedStateFromProps;(l="function"===typeof d||"function"===typeof a.getSnapshotBeforeUpdate)||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(s!==h||f!==u)&&Ko(t,a,n,u),Co=!1,f=t.memoizedState,a.state=f,No(t,n,a,i);var p=t.memoizedState;s!==h||f!==p||Ii.current||Co?("function"===typeof d&&(Fo(t,r,d,n),p=t.memoizedState),(c=Co||Vo(t,r,c,n,f,p,u)||!1)?(l||"function"!==typeof a.UNSAFE_componentWillUpdate&&"function"!==typeof a.componentWillUpdate||("function"===typeof a.componentWillUpdate&&a.componentWillUpdate(n,p,u),"function"===typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(n,p,u)),"function"===typeof a.componentDidUpdate&&(t.flags|=4),"function"===typeof a.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof a.componentDidUpdate||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=p),a.props=n,a.state=p,a.context=u,n=c):("function"!==typeof a.componentDidUpdate||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),n=!1)}return Is(e,t,r,n,o,i)}function Is(e,t,r,n,i,o){Ss(e,t);var a=0!==(128&t.flags);if(!n&&!a)return i&&zi(t,r,!1),Ks(e,t,o);n=t.stateNode,_s.current=t;var s=a&&"function"!==typeof r.getDerivedStateFromError?null:n.render();return t.flags|=1,null!==e&&a?(t.child=Qo(t,e.child,null,o),t.child=Qo(t,null,s,o)):xs(e,t,s,o),t.memoizedState=n.state,i&&zi(t,r,!0),t.child}function Ps(e){var t=e.stateNode;t.pendingContext?Ri(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Ri(0,t.context,!1),ia(e,t.containerInfo)}function Cs(e,t,r,n,i){return po(),mo(i),t.flags|=256,xs(e,t,r,n),t.child}var Bs,Ds,Rs,Ls,Os={dehydrated:null,treeContext:null,retryLane:0};function zs(e){return{baseLanes:e,cachePool:null,transitions:null}}function Ns(e,t,r){var n,i=t.pendingProps,a=ua.current,s=!1,u=0!==(128&t.flags);if((n=u)||(n=(null===e||null!==e.memoizedState)&&0!==(2&a)),n?(s=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(a|=1),Si(ua,1&a),null===e)return co(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(u=i.children,e=i.fallback,s?(i=t.mode,s=t.child,u={mode:"hidden",children:u},0===(1&i)&&null!==s?(s.childLanes=0,s.pendingProps=u):s=zc(u,i,0,null),e=Oc(e,i,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=zs(r),t.memoizedState=Os,e):Us(t,u));if(null!==(a=e.memoizedState)&&null!==(n=a.dehydrated))return function(e,t,r,n,i,a,s){if(r)return 256&t.flags?(t.flags&=-257,Zs(e,t,s,n=hs(Error(o(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(a=n.fallback,i=t.mode,n=zc({mode:"visible",children:n.children},i,0,null),(a=Oc(a,i,s,null)).flags|=2,n.return=t,a.return=t,n.sibling=a,t.child=n,0!==(1&t.mode)&&Qo(t,e.child,null,s),t.child.memoizedState=zs(s),t.memoizedState=Os,a);if(0===(1&t.mode))return Zs(e,t,s,null);if("$!"===i.data){if(n=i.nextSibling&&i.nextSibling.dataset)var u=n.dgst;return n=u,Zs(e,t,s,n=hs(a=Error(o(419)),n,void 0))}if(u=0!==(s&e.childLanes),bs||u){if(null!==(n=Pu)){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}0!==(i=0!==(i&(n.suspendedLanes|s))?0:i)&&i!==a.retryLane&&(a.retryLane=i,Po(e,i),nc(n,e,i,-1))}return gc(),Zs(e,t,s,n=hs(Error(o(421))))}return"$?"===i.data?(t.flags|=128,t.child=e.child,t=Mc.bind(null,e),i._reactRetry=t,null):(e=a.treeContext,no=ci(i.nextSibling),ro=t,io=!0,oo=null,null!==e&&(Hi[qi++]=Xi,Hi[qi++]=Qi,Hi[qi++]=Yi,Xi=e.id,Qi=e.overflow,Yi=t),t=Us(t,n.children),t.flags|=4096,t)}(e,t,u,i,n,a,r);if(s){s=i.fallback,u=t.mode,n=(a=e.child).sibling;var c={mode:"hidden",children:i.children};return 0===(1&u)&&t.child!==a?((i=t.child).childLanes=0,i.pendingProps=c,t.deletions=null):(i=Rc(a,c)).subtreeFlags=14680064&a.subtreeFlags,null!==n?s=Rc(n,s):(s=Oc(s,u,r,null)).flags|=2,s.return=t,i.return=t,i.sibling=s,t.child=i,i=s,s=t.child,u=null===(u=e.child.memoizedState)?zs(r):{baseLanes:u.baseLanes|r,cachePool:null,transitions:u.transitions},s.memoizedState=u,s.childLanes=e.childLanes&~r,t.memoizedState=Os,i}return e=(s=e.child).sibling,i=Rc(s,{mode:"visible",children:i.children}),0===(1&t.mode)&&(i.lanes=r),i.return=t,i.sibling=null,null!==e&&(null===(r=t.deletions)?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=i,t.memoizedState=null,i}function Us(e,t){return(t=zc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Zs(e,t,r,n){return null!==n&&mo(n),Qo(t,e.child,null,r),(e=Us(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function Fs(e,t,r){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),Ao(e.return,t,r)}function js(e,t,r,n,i){var o=e.memoizedState;null===o?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:i}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=n,o.tail=r,o.tailMode=i)}function Vs(e,t,r){var n=t.pendingProps,i=n.revealOrder,o=n.tail;if(xs(e,t,n.children,r),0!==(2&(n=ua.current)))n=1&n|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Fs(e,r,t);else if(19===e.tag)Fs(e,r,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(Si(ua,n),0===(1&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(r=t.child,i=null;null!==r;)null!==(e=r.alternate)&&null===ca(e)&&(i=r),r=r.sibling;null===(r=i)?(i=t.child,t.child=null):(i=r.sibling,r.sibling=null),js(t,!1,i,r,o);break;case"backwards":for(r=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===ca(e)){t.child=i;break}e=i.sibling,i.sibling=r,r=i,i=e}js(t,!0,r,null,o);break;case"together":js(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ws(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ks(e,t,r){if(null!==e&&(t.dependencies=e.dependencies),zu|=t.lanes,0===(r&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(o(153));if(null!==t.child){for(r=Rc(e=t.child,e.pendingProps),t.child=r,r.return=t;null!==e.sibling;)e=e.sibling,(r=r.sibling=Rc(e,e.pendingProps)).return=t;r.sibling=null}return t.child}function Gs(e,t){if(!io)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;null!==t;)null!==t.alternate&&(r=t),t=t.sibling;null===r?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;null!==r;)null!==r.alternate&&(n=r),r=r.sibling;null===n?t||null===e.tail?e.tail=null:e.tail.sibling=null:n.sibling=null}}function Hs(e){var t=null!==e.alternate&&e.alternate.child===e.child,r=0,n=0;if(t)for(var i=e.child;null!==i;)r|=i.lanes|i.childLanes,n|=14680064&i.subtreeFlags,n|=14680064&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)r|=i.lanes|i.childLanes,n|=i.subtreeFlags,n|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function qs(e,t,r){var n=t.pendingProps;switch(to(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Hs(t),null;case 1:case 17:return Bi(t.type)&&Di(),Hs(t),null;case 3:return n=t.stateNode,oa(),Ei(Ii),Ei(Mi),ha(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(ho(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==oo&&(sc(oo),oo=null))),Ds(e,t),Hs(t),null;case 5:sa(t);var i=na(ra.current);if(r=t.type,null!==e&&null!=t.stateNode)Rs(e,t,r,n,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(null===t.stateNode)throw Error(o(166));return Hs(t),null}if(e=na(ea.current),ho(t)){n=t.stateNode,r=t.type;var a=t.memoizedProps;switch(n[fi]=t,n[di]=a,e=0!==(1&t.mode),r){case"dialog":Un("cancel",n),Un("close",n);break;case"iframe":case"object":case"embed":Un("load",n);break;case"video":case"audio":for(i=0;i<Ln.length;i++)Un(Ln[i],n);break;case"source":Un("error",n);break;case"img":case"image":case"link":Un("error",n),Un("load",n);break;case"details":Un("toggle",n);break;case"input":X(n,a),Un("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!a.multiple},Un("invalid",n);break;case"textarea":ie(n,a),Un("invalid",n)}for(var u in ve(r,a),i=null,a)if(a.hasOwnProperty(u)){var c=a[u];"children"===u?"string"===typeof c?n.textContent!==c&&(!0!==a.suppressHydrationWarning&&$n(n.textContent,c,e),i=["children",c]):"number"===typeof c&&n.textContent!==""+c&&(!0!==a.suppressHydrationWarning&&$n(n.textContent,c,e),i=["children",""+c]):s.hasOwnProperty(u)&&null!=c&&"onScroll"===u&&Un("scroll",n)}switch(r){case"input":G(n),J(n,a,!0);break;case"textarea":G(n),ae(n);break;case"select":case"option":break;default:"function"===typeof a.onClick&&(n.onclick=Jn)}n=i,t.updateQueue=n,null!==n&&(t.flags|=4)}else{u=9===i.nodeType?i:i.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=se(r)),"http://www.w3.org/1999/xhtml"===e?"script"===r?((e=u.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof n.is?e=u.createElement(r,{is:n.is}):(e=u.createElement(r),"select"===r&&(u=e,n.multiple?u.multiple=!0:n.size&&(u.size=n.size))):e=u.createElementNS(e,r),e[fi]=t,e[di]=n,Bs(e,t,!1,!1),t.stateNode=e;e:{switch(u=_e(r,n),r){case"dialog":Un("cancel",e),Un("close",e),i=n;break;case"iframe":case"object":case"embed":Un("load",e),i=n;break;case"video":case"audio":for(i=0;i<Ln.length;i++)Un(Ln[i],e);i=n;break;case"source":Un("error",e),i=n;break;case"img":case"image":case"link":Un("error",e),Un("load",e),i=n;break;case"details":Un("toggle",e),i=n;break;case"input":X(e,n),i=Y(e,n),Un("invalid",e);break;case"option":default:i=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},i=z({},n,{value:void 0}),Un("invalid",e);break;case"textarea":ie(e,n),i=ne(e,n),Un("invalid",e)}for(a in ve(r,i),c=i)if(c.hasOwnProperty(a)){var l=c[a];"style"===a?ge(e,l):"dangerouslySetInnerHTML"===a?null!=(l=l?l.__html:void 0)&&he(e,l):"children"===a?"string"===typeof l?("textarea"!==r||""!==l)&&fe(e,l):"number"===typeof l&&fe(e,""+l):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(s.hasOwnProperty(a)?null!=l&&"onScroll"===a&&Un("scroll",e):null!=l&&_(e,a,l,u))}switch(r){case"input":G(e),J(e,n,!1);break;case"textarea":G(e),ae(e);break;case"option":null!=n.value&&e.setAttribute("value",""+W(n.value));break;case"select":e.multiple=!!n.multiple,null!=(a=n.value)?re(e,!!n.multiple,a,!1):null!=n.defaultValue&&re(e,!!n.multiple,n.defaultValue,!0);break;default:"function"===typeof i.onClick&&(e.onclick=Jn)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Hs(t),null;case 6:if(e&&null!=t.stateNode)Ls(e,t,e.memoizedProps,n);else{if("string"!==typeof n&&null===t.stateNode)throw Error(o(166));if(r=na(ra.current),na(ea.current),ho(t)){if(n=t.stateNode,r=t.memoizedProps,n[fi]=t,(a=n.nodeValue!==r)&&null!==(e=ro))switch(e.tag){case 3:$n(n.nodeValue,r,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&$n(n.nodeValue,r,0!==(1&e.mode))}a&&(t.flags|=4)}else(n=(9===r.nodeType?r:r.ownerDocument).createTextNode(n))[fi]=t,t.stateNode=n}return Hs(t),null;case 13:if(Ei(ua),n=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(io&&null!==no&&0!==(1&t.mode)&&0===(128&t.flags))fo(),po(),t.flags|=98560,a=!1;else if(a=ho(t),null!==n&&null!==n.dehydrated){if(null===e){if(!a)throw Error(o(318));if(!(a=null!==(a=t.memoizedState)?a.dehydrated:null))throw Error(o(317));a[fi]=t}else po(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Hs(t),a=!1}else null!==oo&&(sc(oo),oo=null),a=!0;if(!a)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=r,t):((n=null!==n)!==(null!==e&&null!==e.memoizedState)&&n&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&ua.current)?0===Lu&&(Lu=3):gc())),null!==t.updateQueue&&(t.flags|=4),Hs(t),null);case 4:return oa(),Ds(e,t),null===e&&jn(t.stateNode.containerInfo),Hs(t),null;case 10:return ko(t.type._context),Hs(t),null;case 19:if(Ei(ua),null===(a=t.memoizedState))return Hs(t),null;if(n=0!==(128&t.flags),null===(u=a.rendering))if(n)Gs(a,!1);else{if(0!==Lu||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(u=ca(e))){for(t.flags|=128,Gs(a,!1),null!==(n=u.updateQueue)&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;null!==r;)e=n,(a=r).flags&=14680066,null===(u=a.alternate)?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=u.childLanes,a.lanes=u.lanes,a.child=u.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=u.memoizedProps,a.memoizedState=u.memoizedState,a.updateQueue=u.updateQueue,a.type=u.type,e=u.dependencies,a.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return Si(ua,1&ua.current|2),t.child}e=e.sibling}null!==a.tail&&Qe()>Vu&&(t.flags|=128,n=!0,Gs(a,!1),t.lanes=4194304)}else{if(!n)if(null!==(e=ca(u))){if(t.flags|=128,n=!0,null!==(r=e.updateQueue)&&(t.updateQueue=r,t.flags|=4),Gs(a,!0),null===a.tail&&"hidden"===a.tailMode&&!u.alternate&&!io)return Hs(t),null}else 2*Qe()-a.renderingStartTime>Vu&&1073741824!==r&&(t.flags|=128,n=!0,Gs(a,!1),t.lanes=4194304);a.isBackwards?(u.sibling=t.child,t.child=u):(null!==(r=a.last)?r.sibling=u:t.child=u,a.last=u)}return null!==a.tail?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=Qe(),t.sibling=null,r=ua.current,Si(ua,n?1&r|2:1&r),t):(Hs(t),null);case 22:case 23:return fc(),n=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==n&&(t.flags|=8192),n&&0!==(1&t.mode)?0!==(1073741824&Du)&&(Hs(t),6&t.subtreeFlags&&(t.flags|=8192)):Hs(t),null;case 24:case 25:return null}throw Error(o(156,t.tag))}function Ys(e,t){switch(to(t),t.tag){case 1:return Bi(t.type)&&Di(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return oa(),Ei(Ii),Ei(Mi),ha(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return sa(t),null;case 13:if(Ei(ua),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(o(340));po()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Ei(ua),null;case 4:return oa(),null;case 10:return ko(t.type._context),null;case 22:case 23:return fc(),null;default:return null}}Bs=function(e,t){for(var r=t.child;null!==r;){if(5===r.tag||6===r.tag)e.appendChild(r.stateNode);else if(4!==r.tag&&null!==r.child){r.child.return=r,r=r.child;continue}if(r===t)break;for(;null===r.sibling;){if(null===r.return||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}},Ds=function(){},Rs=function(e,t,r,n){var i=e.memoizedProps;if(i!==n){e=t.stateNode,na(ea.current);var o,a=null;switch(r){case"input":i=Y(e,i),n=Y(e,n),a=[];break;case"select":i=z({},i,{value:void 0}),n=z({},n,{value:void 0}),a=[];break;case"textarea":i=ne(e,i),n=ne(e,n),a=[];break;default:"function"!==typeof i.onClick&&"function"===typeof n.onClick&&(e.onclick=Jn)}for(l in ve(r,n),r=null,i)if(!n.hasOwnProperty(l)&&i.hasOwnProperty(l)&&null!=i[l])if("style"===l){var u=i[l];for(o in u)u.hasOwnProperty(o)&&(r||(r={}),r[o]="")}else"dangerouslySetInnerHTML"!==l&&"children"!==l&&"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&"autoFocus"!==l&&(s.hasOwnProperty(l)?a||(a=[]):(a=a||[]).push(l,null));for(l in n){var c=n[l];if(u=null!=i?i[l]:void 0,n.hasOwnProperty(l)&&c!==u&&(null!=c||null!=u))if("style"===l)if(u){for(o in u)!u.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(r||(r={}),r[o]="");for(o in c)c.hasOwnProperty(o)&&u[o]!==c[o]&&(r||(r={}),r[o]=c[o])}else r||(a||(a=[]),a.push(l,r)),r=c;else"dangerouslySetInnerHTML"===l?(c=c?c.__html:void 0,u=u?u.__html:void 0,null!=c&&u!==c&&(a=a||[]).push(l,c)):"children"===l?"string"!==typeof c&&"number"!==typeof c||(a=a||[]).push(l,""+c):"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&(s.hasOwnProperty(l)?(null!=c&&"onScroll"===l&&Un("scroll",e),a||u===c||(a=[])):(a=a||[]).push(l,c))}r&&(a=a||[]).push("style",r);var l=a;(t.updateQueue=l)&&(t.flags|=4)}},Ls=function(e,t,r,n){r!==n&&(t.flags|=4)};var Xs=!1,Qs=!1,$s="function"===typeof WeakSet?WeakSet:Set,Js=null;function eu(e,t){var r=e.ref;if(null!==r)if("function"===typeof r)try{r(null)}catch(n){Ec(e,t,n)}else r.current=null}function tu(e,t,r){try{r()}catch(n){Ec(e,t,n)}}var ru=!1;function nu(e,t,r){var n=t.updateQueue;if(null!==(n=null!==n?n.lastEffect:null)){var i=n=n.next;do{if((i.tag&e)===e){var o=i.destroy;i.destroy=void 0,void 0!==o&&tu(t,r,o)}i=i.next}while(i!==n)}}function iu(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function ou(e){var t=e.ref;if(null!==t){var r=e.stateNode;e.tag,e=r,"function"===typeof t?t(e):t.current=e}}function au(e){var t=e.alternate;null!==t&&(e.alternate=null,au(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[fi],delete t[di],delete t[mi],delete t[gi],delete t[yi])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function su(e){return 5===e.tag||3===e.tag||4===e.tag}function uu(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||su(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function cu(e,t,r){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?8===r.nodeType?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(8===r.nodeType?(t=r.parentNode).insertBefore(e,r):(t=r).appendChild(e),null!==(r=r._reactRootContainer)&&void 0!==r||null!==t.onclick||(t.onclick=Jn));else if(4!==n&&null!==(e=e.child))for(cu(e,t,r),e=e.sibling;null!==e;)cu(e,t,r),e=e.sibling}function lu(e,t,r){var n=e.tag;if(5===n||6===n)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(4!==n&&null!==(e=e.child))for(lu(e,t,r),e=e.sibling;null!==e;)lu(e,t,r),e=e.sibling}var hu=null,fu=!1;function du(e,t,r){for(r=r.child;null!==r;)pu(e,t,r),r=r.sibling}function pu(e,t,r){if(ot&&"function"===typeof ot.onCommitFiberUnmount)try{ot.onCommitFiberUnmount(it,r)}catch(s){}switch(r.tag){case 5:Qs||eu(r,t);case 6:var n=hu,i=fu;hu=null,du(e,t,r),fu=i,null!==(hu=n)&&(fu?(e=hu,r=r.stateNode,8===e.nodeType?e.parentNode.removeChild(r):e.removeChild(r)):hu.removeChild(r.stateNode));break;case 18:null!==hu&&(fu?(e=hu,r=r.stateNode,8===e.nodeType?ui(e.parentNode,r):1===e.nodeType&&ui(e,r),jt(e)):ui(hu,r.stateNode));break;case 4:n=hu,i=fu,hu=r.stateNode.containerInfo,fu=!0,du(e,t,r),hu=n,fu=i;break;case 0:case 11:case 14:case 15:if(!Qs&&(null!==(n=r.updateQueue)&&null!==(n=n.lastEffect))){i=n=n.next;do{var o=i,a=o.destroy;o=o.tag,void 0!==a&&(0!==(2&o)||0!==(4&o))&&tu(r,t,a),i=i.next}while(i!==n)}du(e,t,r);break;case 1:if(!Qs&&(eu(r,t),"function"===typeof(n=r.stateNode).componentWillUnmount))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(s){Ec(r,t,s)}du(e,t,r);break;case 21:du(e,t,r);break;case 22:1&r.mode?(Qs=(n=Qs)||null!==r.memoizedState,du(e,t,r),Qs=n):du(e,t,r);break;default:du(e,t,r)}}function mu(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var r=e.stateNode;null===r&&(r=e.stateNode=new $s),t.forEach((function(t){var n=Ic.bind(null,e,t);r.has(t)||(r.add(t),t.then(n,n))}))}}function gu(e,t){var r=t.deletions;if(null!==r)for(var n=0;n<r.length;n++){var i=r[n];try{var a=e,s=t,u=s;e:for(;null!==u;){switch(u.tag){case 5:hu=u.stateNode,fu=!1;break e;case 3:case 4:hu=u.stateNode.containerInfo,fu=!0;break e}u=u.return}if(null===hu)throw Error(o(160));pu(a,s,i),hu=null,fu=!1;var c=i.alternate;null!==c&&(c.return=null),i.return=null}catch(l){Ec(i,t,l)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)yu(t,e),t=t.sibling}function yu(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(gu(t,e),vu(e),4&n){try{nu(3,e,e.return),iu(3,e)}catch(g){Ec(e,e.return,g)}try{nu(5,e,e.return)}catch(g){Ec(e,e.return,g)}}break;case 1:gu(t,e),vu(e),512&n&&null!==r&&eu(r,r.return);break;case 5:if(gu(t,e),vu(e),512&n&&null!==r&&eu(r,r.return),32&e.flags){var i=e.stateNode;try{fe(i,"")}catch(g){Ec(e,e.return,g)}}if(4&n&&null!=(i=e.stateNode)){var a=e.memoizedProps,s=null!==r?r.memoizedProps:a,u=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===u&&"radio"===a.type&&null!=a.name&&Q(i,a),_e(u,s);var l=_e(u,a);for(s=0;s<c.length;s+=2){var h=c[s],f=c[s+1];"style"===h?ge(i,f):"dangerouslySetInnerHTML"===h?he(i,f):"children"===h?fe(i,f):_(i,h,f,l)}switch(u){case"input":$(i,a);break;case"textarea":oe(i,a);break;case"select":var d=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!a.multiple;var p=a.value;null!=p?re(i,!!a.multiple,p,!1):d!==!!a.multiple&&(null!=a.defaultValue?re(i,!!a.multiple,a.defaultValue,!0):re(i,!!a.multiple,a.multiple?[]:"",!1))}i[di]=a}catch(g){Ec(e,e.return,g)}}break;case 6:if(gu(t,e),vu(e),4&n){if(null===e.stateNode)throw Error(o(162));i=e.stateNode,a=e.memoizedProps;try{i.nodeValue=a}catch(g){Ec(e,e.return,g)}}break;case 3:if(gu(t,e),vu(e),4&n&&null!==r&&r.memoizedState.isDehydrated)try{jt(t.containerInfo)}catch(g){Ec(e,e.return,g)}break;case 4:default:gu(t,e),vu(e);break;case 13:gu(t,e),vu(e),8192&(i=e.child).flags&&(a=null!==i.memoizedState,i.stateNode.isHidden=a,!a||null!==i.alternate&&null!==i.alternate.memoizedState||(ju=Qe())),4&n&&mu(e);break;case 22:if(h=null!==r&&null!==r.memoizedState,1&e.mode?(Qs=(l=Qs)||h,gu(t,e),Qs=l):gu(t,e),vu(e),8192&n){if(l=null!==e.memoizedState,(e.stateNode.isHidden=l)&&!h&&0!==(1&e.mode))for(Js=e,h=e.child;null!==h;){for(f=Js=h;null!==Js;){switch(p=(d=Js).child,d.tag){case 0:case 11:case 14:case 15:nu(4,d,d.return);break;case 1:eu(d,d.return);var m=d.stateNode;if("function"===typeof m.componentWillUnmount){n=d,r=d.return;try{t=n,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){Ec(n,r,g)}}break;case 5:eu(d,d.return);break;case 22:if(null!==d.memoizedState){wu(f);continue}}null!==p?(p.return=d,Js=p):wu(f)}h=h.sibling}e:for(h=null,f=e;;){if(5===f.tag){if(null===h){h=f;try{i=f.stateNode,l?"function"===typeof(a=i.style).setProperty?a.setProperty("display","none","important"):a.display="none":(u=f.stateNode,s=void 0!==(c=f.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,u.style.display=me("display",s))}catch(g){Ec(e,e.return,g)}}}else if(6===f.tag){if(null===h)try{f.stateNode.nodeValue=l?"":f.memoizedProps}catch(g){Ec(e,e.return,g)}}else if((22!==f.tag&&23!==f.tag||null===f.memoizedState||f===e)&&null!==f.child){f.child.return=f,f=f.child;continue}if(f===e)break e;for(;null===f.sibling;){if(null===f.return||f.return===e)break e;h===f&&(h=null),f=f.return}h===f&&(h=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:gu(t,e),vu(e),4&n&&mu(e);case 21:}}function vu(e){var t=e.flags;if(2&t){try{e:{for(var r=e.return;null!==r;){if(su(r)){var n=r;break e}r=r.return}throw Error(o(160))}switch(n.tag){case 5:var i=n.stateNode;32&n.flags&&(fe(i,""),n.flags&=-33),lu(e,uu(e),i);break;case 3:case 4:var a=n.stateNode.containerInfo;cu(e,uu(e),a);break;default:throw Error(o(161))}}catch(s){Ec(e,e.return,s)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function _u(e,t,r){Js=e,bu(e,t,r)}function bu(e,t,r){for(var n=0!==(1&e.mode);null!==Js;){var i=Js,o=i.child;if(22===i.tag&&n){var a=null!==i.memoizedState||Xs;if(!a){var s=i.alternate,u=null!==s&&null!==s.memoizedState||Qs;s=Xs;var c=Qs;if(Xs=a,(Qs=u)&&!c)for(Js=i;null!==Js;)u=(a=Js).child,22===a.tag&&null!==a.memoizedState?ku(i):null!==u?(u.return=a,Js=u):ku(i);for(;null!==o;)Js=o,bu(o,t,r),o=o.sibling;Js=i,Xs=s,Qs=c}xu(e)}else 0!==(8772&i.subtreeFlags)&&null!==o?(o.return=i,Js=o):xu(e)}}function xu(e){for(;null!==Js;){var t=Js;if(0!==(8772&t.flags)){var r=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Qs||iu(5,t);break;case 1:var n=t.stateNode;if(4&t.flags&&!Qs)if(null===r)n.componentDidMount();else{var i=t.elementType===t.type?r.memoizedProps:yo(t.type,r.memoizedProps);n.componentDidUpdate(i,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;null!==a&&Uo(t,a,n);break;case 3:var s=t.updateQueue;if(null!==s){if(r=null,null!==t.child)switch(t.child.tag){case 5:case 1:r=t.child.stateNode}Uo(t,s,r)}break;case 5:var u=t.stateNode;if(null===r&&4&t.flags){r=u;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&r.focus();break;case"img":c.src&&(r.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var l=t.alternate;if(null!==l){var h=l.memoizedState;if(null!==h){var f=h.dehydrated;null!==f&&jt(f)}}}break;default:throw Error(o(163))}Qs||512&t.flags&&ou(t)}catch(d){Ec(t,t.return,d)}}if(t===e){Js=null;break}if(null!==(r=t.sibling)){r.return=t.return,Js=r;break}Js=t.return}}function wu(e){for(;null!==Js;){var t=Js;if(t===e){Js=null;break}var r=t.sibling;if(null!==r){r.return=t.return,Js=r;break}Js=t.return}}function ku(e){for(;null!==Js;){var t=Js;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{iu(4,t)}catch(u){Ec(t,r,u)}break;case 1:var n=t.stateNode;if("function"===typeof n.componentDidMount){var i=t.return;try{n.componentDidMount()}catch(u){Ec(t,i,u)}}var o=t.return;try{ou(t)}catch(u){Ec(t,o,u)}break;case 5:var a=t.return;try{ou(t)}catch(u){Ec(t,a,u)}}}catch(u){Ec(t,t.return,u)}if(t===e){Js=null;break}var s=t.sibling;if(null!==s){s.return=t.return,Js=s;break}Js=t.return}}var Au,Eu=Math.ceil,Su=b.ReactCurrentDispatcher,Tu=b.ReactCurrentOwner,Mu=b.ReactCurrentBatchConfig,Iu=0,Pu=null,Cu=null,Bu=0,Du=0,Ru=Ai(0),Lu=0,Ou=null,zu=0,Nu=0,Uu=0,Zu=null,Fu=null,ju=0,Vu=1/0,Wu=null,Ku=!1,Gu=null,Hu=null,qu=!1,Yu=null,Xu=0,Qu=0,$u=null,Ju=-1,ec=0;function tc(){return 0!==(6&Iu)?Qe():-1!==Ju?Ju:Ju=Qe()}function rc(e){return 0===(1&e.mode)?1:0!==(2&Iu)&&0!==Bu?Bu&-Bu:null!==go.transition?(0===ec&&(ec=mt()),ec):0!==(e=_t)?e:e=void 0===(e=window.event)?16:Xt(e.type)}function nc(e,t,r,n){if(50<Qu)throw Qu=0,$u=null,Error(o(185));yt(e,r,n),0!==(2&Iu)&&e===Pu||(e===Pu&&(0===(2&Iu)&&(Nu|=r),4===Lu&&uc(e,Bu)),ic(e,n),1===r&&0===Iu&&0===(1&t.mode)&&(Vu=Qe()+500,Ui&&ji()))}function ic(e,t){var r=e.callbackNode;!function(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,i=e.expirationTimes,o=e.pendingLanes;0<o;){var a=31-at(o),s=1<<a,u=i[a];-1===u?0!==(s&r)&&0===(s&n)||(i[a]=dt(s,t)):u<=t&&(e.expiredLanes|=s),o&=~s}}(e,t);var n=ft(e,e===Pu?Bu:0);if(0===n)null!==r&&qe(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(null!=r&&qe(r),1===t)0===e.tag?function(e){Ui=!0,Fi(e)}(cc.bind(null,e)):Fi(cc.bind(null,e)),ai((function(){0===(6&Iu)&&ji()})),r=null;else{switch(bt(n)){case 1:r=Je;break;case 4:r=et;break;case 16:default:r=tt;break;case 536870912:r=nt}r=Pc(r,oc.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function oc(e,t){if(Ju=-1,ec=0,0!==(6&Iu))throw Error(o(327));var r=e.callbackNode;if(kc()&&e.callbackNode!==r)return null;var n=ft(e,e===Pu?Bu:0);if(0===n)return null;if(0!==(30&n)||0!==(n&e.expiredLanes)||t)t=yc(e,n);else{t=n;var i=Iu;Iu|=2;var a=mc();for(Pu===e&&Bu===t||(Wu=null,Vu=Qe()+500,dc(e,t));;)try{_c();break}catch(u){pc(e,u)}wo(),Su.current=a,Iu=i,null!==Cu?t=0:(Pu=null,Bu=0,t=Lu)}if(0!==t){if(2===t&&(0!==(i=pt(e))&&(n=i,t=ac(e,i))),1===t)throw r=Ou,dc(e,0),uc(e,n),ic(e,Qe()),r;if(6===t)uc(e,n);else{if(i=e.current.alternate,0===(30&n)&&!function(e){for(var t=e;;){if(16384&t.flags){var r=t.updateQueue;if(null!==r&&null!==(r=r.stores))for(var n=0;n<r.length;n++){var i=r[n],o=i.getSnapshot;i=i.value;try{if(!sn(o(),i))return!1}catch(s){return!1}}}if(r=t.child,16384&t.subtreeFlags&&null!==r)r.return=t,t=r;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(i)&&(2===(t=yc(e,n))&&(0!==(a=pt(e))&&(n=a,t=ac(e,a))),1===t))throw r=Ou,dc(e,0),uc(e,n),ic(e,Qe()),r;switch(e.finishedWork=i,e.finishedLanes=n,t){case 0:case 1:throw Error(o(345));case 2:case 5:wc(e,Fu,Wu);break;case 3:if(uc(e,n),(130023424&n)===n&&10<(t=ju+500-Qe())){if(0!==ft(e,0))break;if(((i=e.suspendedLanes)&n)!==n){tc(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=ni(wc.bind(null,e,Fu,Wu),t);break}wc(e,Fu,Wu);break;case 4:if(uc(e,n),(4194240&n)===n)break;for(t=e.eventTimes,i=-1;0<n;){var s=31-at(n);a=1<<s,(s=t[s])>i&&(i=s),n&=~a}if(n=i,10<(n=(120>(n=Qe()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Eu(n/1960))-n)){e.timeoutHandle=ni(wc.bind(null,e,Fu,Wu),n);break}wc(e,Fu,Wu);break;default:throw Error(o(329))}}}return ic(e,Qe()),e.callbackNode===r?oc.bind(null,e):null}function ac(e,t){var r=Zu;return e.current.memoizedState.isDehydrated&&(dc(e,t).flags|=256),2!==(e=yc(e,t))&&(t=Fu,Fu=r,null!==t&&sc(t)),e}function sc(e){null===Fu?Fu=e:Fu.push.apply(Fu,e)}function uc(e,t){for(t&=~Uu,t&=~Nu,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-at(t),n=1<<r;e[r]=-1,t&=~n}}function cc(e){if(0!==(6&Iu))throw Error(o(327));kc();var t=ft(e,0);if(0===(1&t))return ic(e,Qe()),null;var r=yc(e,t);if(0!==e.tag&&2===r){var n=pt(e);0!==n&&(t=n,r=ac(e,n))}if(1===r)throw r=Ou,dc(e,0),uc(e,t),ic(e,Qe()),r;if(6===r)throw Error(o(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,wc(e,Fu,Wu),ic(e,Qe()),null}function lc(e,t){var r=Iu;Iu|=1;try{return e(t)}finally{0===(Iu=r)&&(Vu=Qe()+500,Ui&&ji())}}function hc(e){null!==Yu&&0===Yu.tag&&0===(6&Iu)&&kc();var t=Iu;Iu|=1;var r=Mu.transition,n=_t;try{if(Mu.transition=null,_t=1,e)return e()}finally{_t=n,Mu.transition=r,0===(6&(Iu=t))&&ji()}}function fc(){Du=Ru.current,Ei(Ru)}function dc(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(-1!==r&&(e.timeoutHandle=-1,ii(r)),null!==Cu)for(r=Cu.return;null!==r;){var n=r;switch(to(n),n.tag){case 1:null!==(n=n.type.childContextTypes)&&void 0!==n&&Di();break;case 3:oa(),Ei(Ii),Ei(Mi),ha();break;case 5:sa(n);break;case 4:oa();break;case 13:case 19:Ei(ua);break;case 10:ko(n.type._context);break;case 22:case 23:fc()}r=r.return}if(Pu=e,Cu=e=Rc(e.current,null),Bu=Du=t,Lu=0,Ou=null,Uu=Nu=zu=0,Fu=Zu=null,null!==To){for(t=0;t<To.length;t++)if(null!==(n=(r=To[t]).interleaved)){r.interleaved=null;var i=n.next,o=r.pending;if(null!==o){var a=o.next;o.next=i,n.next=a}r.pending=n}To=null}return e}function pc(e,t){for(;;){var r=Cu;try{if(wo(),fa.current=as,va){for(var n=ma.memoizedState;null!==n;){var i=n.queue;null!==i&&(i.pending=null),n=n.next}va=!1}if(pa=0,ya=ga=ma=null,_a=!1,ba=0,Tu.current=null,null===r||null===r.return){Lu=1,Ou=t,Cu=null;break}e:{var a=e,s=r.return,u=r,c=t;if(t=Bu,u.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var l=c,h=u,f=h.tag;if(0===(1&h.mode)&&(0===f||11===f||15===f)){var d=h.alternate;d?(h.updateQueue=d.updateQueue,h.memoizedState=d.memoizedState,h.lanes=d.lanes):(h.updateQueue=null,h.memoizedState=null)}var p=ys(s);if(null!==p){p.flags&=-257,vs(p,s,u,0,t),1&p.mode&&gs(a,l,t),c=l;var m=(t=p).updateQueue;if(null===m){var g=new Set;g.add(c),t.updateQueue=g}else m.add(c);break e}if(0===(1&t)){gs(a,l,t),gc();break e}c=Error(o(426))}else if(io&&1&u.mode){var y=ys(s);if(null!==y){0===(65536&y.flags)&&(y.flags|=256),vs(y,s,u,0,t),mo(ls(c,u));break e}}a=c=ls(c,u),4!==Lu&&(Lu=2),null===Zu?Zu=[a]:Zu.push(a),a=s;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t,zo(a,ps(0,c,t));break e;case 1:u=c;var v=a.type,_=a.stateNode;if(0===(128&a.flags)&&("function"===typeof v.getDerivedStateFromError||null!==_&&"function"===typeof _.componentDidCatch&&(null===Hu||!Hu.has(_)))){a.flags|=65536,t&=-t,a.lanes|=t,zo(a,ms(a,u,t));break e}}a=a.return}while(null!==a)}xc(r)}catch(b){t=b,Cu===r&&null!==r&&(Cu=r=r.return);continue}break}}function mc(){var e=Su.current;return Su.current=as,null===e?as:e}function gc(){0!==Lu&&3!==Lu&&2!==Lu||(Lu=4),null===Pu||0===(268435455&zu)&&0===(268435455&Nu)||uc(Pu,Bu)}function yc(e,t){var r=Iu;Iu|=2;var n=mc();for(Pu===e&&Bu===t||(Wu=null,dc(e,t));;)try{vc();break}catch(i){pc(e,i)}if(wo(),Iu=r,Su.current=n,null!==Cu)throw Error(o(261));return Pu=null,Bu=0,Lu}function vc(){for(;null!==Cu;)bc(Cu)}function _c(){for(;null!==Cu&&!Ye();)bc(Cu)}function bc(e){var t=Au(e.alternate,e,Du);e.memoizedProps=e.pendingProps,null===t?xc(e):Cu=t,Tu.current=null}function xc(e){var t=e;do{var r=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(r=qs(r,t,Du)))return void(Cu=r)}else{if(null!==(r=Ys(r,t)))return r.flags&=32767,void(Cu=r);if(null===e)return Lu=6,void(Cu=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Cu=t);Cu=t=e}while(null!==t);0===Lu&&(Lu=5)}function wc(e,t,r){var n=_t,i=Mu.transition;try{Mu.transition=null,_t=1,function(e,t,r,n){do{kc()}while(null!==Yu);if(0!==(6&Iu))throw Error(o(327));r=e.finishedWork;var i=e.finishedLanes;if(null===r)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(o(177));e.callbackNode=null,e.callbackPriority=0;var a=r.lanes|r.childLanes;if(function(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var i=31-at(r),o=1<<i;t[i]=0,n[i]=-1,e[i]=-1,r&=~o}}(e,a),e===Pu&&(Cu=Pu=null,Bu=0),0===(2064&r.subtreeFlags)&&0===(2064&r.flags)||qu||(qu=!0,Pc(tt,(function(){return kc(),null}))),a=0!==(15990&r.flags),0!==(15990&r.subtreeFlags)||a){a=Mu.transition,Mu.transition=null;var s=_t;_t=1;var u=Iu;Iu|=4,Tu.current=null,function(e,t){if(ei=Wt,dn(e=fn())){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{var n=(r=(r=e.ownerDocument)&&r.defaultView||window).getSelection&&r.getSelection();if(n&&0!==n.rangeCount){r=n.anchorNode;var i=n.anchorOffset,a=n.focusNode;n=n.focusOffset;try{r.nodeType,a.nodeType}catch(x){r=null;break e}var s=0,u=-1,c=-1,l=0,h=0,f=e,d=null;t:for(;;){for(var p;f!==r||0!==i&&3!==f.nodeType||(u=s+i),f!==a||0!==n&&3!==f.nodeType||(c=s+n),3===f.nodeType&&(s+=f.nodeValue.length),null!==(p=f.firstChild);)d=f,f=p;for(;;){if(f===e)break t;if(d===r&&++l===i&&(u=s),d===a&&++h===n&&(c=s),null!==(p=f.nextSibling))break;d=(f=d).parentNode}f=p}r=-1===u||-1===c?null:{start:u,end:c}}else r=null}r=r||{start:0,end:0}}else r=null;for(ti={focusedElem:e,selectionRange:r},Wt=!1,Js=t;null!==Js;)if(e=(t=Js).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Js=e;else for(;null!==Js;){t=Js;try{var m=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,y=m.memoizedState,v=t.stateNode,_=v.getSnapshotBeforeUpdate(t.elementType===t.type?g:yo(t.type,g),y);v.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var b=t.stateNode.containerInfo;1===b.nodeType?b.textContent="":9===b.nodeType&&b.documentElement&&b.removeChild(b.documentElement);break;default:throw Error(o(163))}}catch(x){Ec(t,t.return,x)}if(null!==(e=t.sibling)){e.return=t.return,Js=e;break}Js=t.return}m=ru,ru=!1}(e,r),yu(r,e),pn(ti),Wt=!!ei,ti=ei=null,e.current=r,_u(r,e,i),Xe(),Iu=u,_t=s,Mu.transition=a}else e.current=r;if(qu&&(qu=!1,Yu=e,Xu=i),a=e.pendingLanes,0===a&&(Hu=null),function(e){if(ot&&"function"===typeof ot.onCommitFiberRoot)try{ot.onCommitFiberRoot(it,e,void 0,128===(128&e.current.flags))}catch(t){}}(r.stateNode),ic(e,Qe()),null!==t)for(n=e.onRecoverableError,r=0;r<t.length;r++)i=t[r],n(i.value,{componentStack:i.stack,digest:i.digest});if(Ku)throw Ku=!1,e=Gu,Gu=null,e;0!==(1&Xu)&&0!==e.tag&&kc(),a=e.pendingLanes,0!==(1&a)?e===$u?Qu++:(Qu=0,$u=e):Qu=0,ji()}(e,t,r,n)}finally{Mu.transition=i,_t=n}return null}function kc(){if(null!==Yu){var e=bt(Xu),t=Mu.transition,r=_t;try{if(Mu.transition=null,_t=16>e?16:e,null===Yu)var n=!1;else{if(e=Yu,Yu=null,Xu=0,0!==(6&Iu))throw Error(o(331));var i=Iu;for(Iu|=4,Js=e.current;null!==Js;){var a=Js,s=a.child;if(0!==(16&Js.flags)){var u=a.deletions;if(null!==u){for(var c=0;c<u.length;c++){var l=u[c];for(Js=l;null!==Js;){var h=Js;switch(h.tag){case 0:case 11:case 15:nu(8,h,a)}var f=h.child;if(null!==f)f.return=h,Js=f;else for(;null!==Js;){var d=(h=Js).sibling,p=h.return;if(au(h),h===l){Js=null;break}if(null!==d){d.return=p,Js=d;break}Js=p}}}var m=a.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var y=g.sibling;g.sibling=null,g=y}while(null!==g)}}Js=a}}if(0!==(2064&a.subtreeFlags)&&null!==s)s.return=a,Js=s;else e:for(;null!==Js;){if(0!==(2048&(a=Js).flags))switch(a.tag){case 0:case 11:case 15:nu(9,a,a.return)}var v=a.sibling;if(null!==v){v.return=a.return,Js=v;break e}Js=a.return}}var _=e.current;for(Js=_;null!==Js;){var b=(s=Js).child;if(0!==(2064&s.subtreeFlags)&&null!==b)b.return=s,Js=b;else e:for(s=_;null!==Js;){if(0!==(2048&(u=Js).flags))try{switch(u.tag){case 0:case 11:case 15:iu(9,u)}}catch(w){Ec(u,u.return,w)}if(u===s){Js=null;break e}var x=u.sibling;if(null!==x){x.return=u.return,Js=x;break e}Js=u.return}}if(Iu=i,ji(),ot&&"function"===typeof ot.onPostCommitFiberRoot)try{ot.onPostCommitFiberRoot(it,e)}catch(w){}n=!0}return n}finally{_t=r,Mu.transition=t}}return!1}function Ac(e,t,r){e=Lo(e,t=ps(0,t=ls(r,t),1),1),t=tc(),null!==e&&(yt(e,1,t),ic(e,t))}function Ec(e,t,r){if(3===e.tag)Ac(e,e,r);else for(;null!==t;){if(3===t.tag){Ac(t,e,r);break}if(1===t.tag){var n=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof n.componentDidCatch&&(null===Hu||!Hu.has(n))){t=Lo(t,e=ms(t,e=ls(r,e),1),1),e=tc(),null!==t&&(yt(t,1,e),ic(t,e));break}}t=t.return}}function Sc(e,t,r){var n=e.pingCache;null!==n&&n.delete(t),t=tc(),e.pingedLanes|=e.suspendedLanes&r,Pu===e&&(Bu&r)===r&&(4===Lu||3===Lu&&(130023424&Bu)===Bu&&500>Qe()-ju?dc(e,0):Uu|=r),ic(e,t)}function Tc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=lt,0===(130023424&(lt<<=1))&&(lt=4194304)));var r=tc();null!==(e=Po(e,t))&&(yt(e,t,r),ic(e,r))}function Mc(e){var t=e.memoizedState,r=0;null!==t&&(r=t.retryLane),Tc(e,r)}function Ic(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,i=e.memoizedState;null!==i&&(r=i.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(o(314))}null!==n&&n.delete(t),Tc(e,r)}function Pc(e,t){return He(e,t)}function Cc(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bc(e,t,r,n){return new Cc(e,t,r,n)}function Dc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Rc(e,t){var r=e.alternate;return null===r?((r=Bc(e.tag,t,e.key,e.mode)).elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=14680064&e.flags,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Lc(e,t,r,n,i,a){var s=2;if(n=e,"function"===typeof e)Dc(e)&&(s=1);else if("string"===typeof e)s=5;else e:switch(e){case k:return Oc(r.children,i,a,t);case A:s=8,i|=8;break;case E:return(e=Bc(12,r,t,2|i)).elementType=E,e.lanes=a,e;case I:return(e=Bc(13,r,t,i)).elementType=I,e.lanes=a,e;case P:return(e=Bc(19,r,t,i)).elementType=P,e.lanes=a,e;case D:return zc(r,i,a,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case S:s=10;break e;case T:s=9;break e;case M:s=11;break e;case C:s=14;break e;case B:s=16,n=null;break e}throw Error(o(130,null==e?e:typeof e,""))}return(t=Bc(s,r,t,i)).elementType=e,t.type=n,t.lanes=a,t}function Oc(e,t,r,n){return(e=Bc(7,e,n,t)).lanes=r,e}function zc(e,t,r,n){return(e=Bc(22,e,n,t)).elementType=D,e.lanes=r,e.stateNode={isHidden:!1},e}function Nc(e,t,r){return(e=Bc(6,e,null,t)).lanes=r,e}function Uc(e,t,r){return(t=Bc(4,null!==e.children?e.children:[],e.key,t)).lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Zc(e,t,r,n,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=n,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Fc(e,t,r,n,i,o,a,s,u){return e=new Zc(e,t,r,s,u),1===t?(t=1,!0===o&&(t|=8)):t=0,o=Bc(3,null,null,t),e.current=o,o.stateNode=e,o.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},Bo(o),e}function jc(e){if(!e)return Ti;e:{if(je(e=e._reactInternals)!==e||1!==e.tag)throw Error(o(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Bi(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(o(171))}if(1===e.tag){var r=e.type;if(Bi(r))return Li(e,r,t)}return t}function Vc(e,t,r,n,i,o,a,s,u){return(e=Fc(r,n,!0,e,0,o,0,s,u)).context=jc(null),r=e.current,(o=Ro(n=tc(),i=rc(r))).callback=void 0!==t&&null!==t?t:null,Lo(r,o,i),e.current.lanes=i,yt(e,i,n),ic(e,n),e}function Wc(e,t,r,n){var i=t.current,o=tc(),a=rc(i);return r=jc(r),null===t.context?t.context=r:t.pendingContext=r,(t=Ro(o,a)).payload={element:e},null!==(n=void 0===n?null:n)&&(t.callback=n),null!==(e=Lo(i,t,a))&&(nc(e,i,a,o),Oo(e,i,a)),a}function Kc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Gc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var r=e.retryLane;e.retryLane=0!==r&&r<t?r:t}}function Hc(e,t){Gc(e,t),(e=e.alternate)&&Gc(e,t)}Au=function(e,t,r){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ii.current)bs=!0;else{if(0===(e.lanes&r)&&0===(128&t.flags))return bs=!1,function(e,t,r){switch(t.tag){case 3:Ps(t),po();break;case 5:aa(t);break;case 1:Bi(t.type)&&Oi(t);break;case 4:ia(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,i=t.memoizedProps.value;Si(vo,n._currentValue),n._currentValue=i;break;case 13:if(null!==(n=t.memoizedState))return null!==n.dehydrated?(Si(ua,1&ua.current),t.flags|=128,null):0!==(r&t.child.childLanes)?Ns(e,t,r):(Si(ua,1&ua.current),null!==(e=Ks(e,t,r))?e.sibling:null);Si(ua,1&ua.current);break;case 19:if(n=0!==(r&t.childLanes),0!==(128&e.flags)){if(n)return Vs(e,t,r);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),Si(ua,ua.current),n)break;return null;case 22:case 23:return t.lanes=0,Es(e,t,r)}return Ks(e,t,r)}(e,t,r);bs=0!==(131072&e.flags)}else bs=!1,io&&0!==(1048576&t.flags)&&Ji(t,Gi,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Ws(e,t),e=t.pendingProps;var i=Ci(t,Mi.current);Eo(t,r),i=Aa(null,t,n,e,i,r);var a=Ea();return t.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Bi(n)?(a=!0,Oi(t)):a=!1,t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,Bo(t),i.updater=jo,t.stateNode=i,i._reactInternals=t,Go(t,n,e,r),t=Is(null,t,n,!0,a,r)):(t.tag=0,io&&a&&eo(t),xs(null,t,i,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Ws(e,t),e=t.pendingProps,n=(i=n._init)(n._payload),t.type=n,i=t.tag=function(e){if("function"===typeof e)return Dc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===M)return 11;if(e===C)return 14}return 2}(n),e=yo(n,e),i){case 0:t=Ts(null,t,n,e,r);break e;case 1:t=Ms(null,t,n,e,r);break e;case 11:t=ws(null,t,n,e,r);break e;case 14:t=ks(null,t,n,yo(n.type,e),r);break e}throw Error(o(306,n,""))}return t;case 0:return n=t.type,i=t.pendingProps,Ts(e,t,n,i=t.elementType===n?i:yo(n,i),r);case 1:return n=t.type,i=t.pendingProps,Ms(e,t,n,i=t.elementType===n?i:yo(n,i),r);case 3:e:{if(Ps(t),null===e)throw Error(o(387));n=t.pendingProps,i=(a=t.memoizedState).element,Do(e,t),No(t,n,null,r);var s=t.memoizedState;if(n=s.element,a.isDehydrated){if(a={element:n,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},t.updateQueue.baseState=a,t.memoizedState=a,256&t.flags){t=Cs(e,t,n,r,i=ls(Error(o(423)),t));break e}if(n!==i){t=Cs(e,t,n,r,i=ls(Error(o(424)),t));break e}for(no=ci(t.stateNode.containerInfo.firstChild),ro=t,io=!0,oo=null,r=$o(t,null,n,r),t.child=r;r;)r.flags=-3&r.flags|4096,r=r.sibling}else{if(po(),n===i){t=Ks(e,t,r);break e}xs(e,t,n,r)}t=t.child}return t;case 5:return aa(t),null===e&&co(t),n=t.type,i=t.pendingProps,a=null!==e?e.memoizedProps:null,s=i.children,ri(n,i)?s=null:null!==a&&ri(n,a)&&(t.flags|=32),Ss(e,t),xs(e,t,s,r),t.child;case 6:return null===e&&co(t),null;case 13:return Ns(e,t,r);case 4:return ia(t,t.stateNode.containerInfo),n=t.pendingProps,null===e?t.child=Qo(t,null,n,r):xs(e,t,n,r),t.child;case 11:return n=t.type,i=t.pendingProps,ws(e,t,n,i=t.elementType===n?i:yo(n,i),r);case 7:return xs(e,t,t.pendingProps,r),t.child;case 8:case 12:return xs(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,i=t.pendingProps,a=t.memoizedProps,s=i.value,Si(vo,n._currentValue),n._currentValue=s,null!==a)if(sn(a.value,s)){if(a.children===i.children&&!Ii.current){t=Ks(e,t,r);break e}}else for(null!==(a=t.child)&&(a.return=t);null!==a;){var u=a.dependencies;if(null!==u){s=a.child;for(var c=u.firstContext;null!==c;){if(c.context===n){if(1===a.tag){(c=Ro(-1,r&-r)).tag=2;var l=a.updateQueue;if(null!==l){var h=(l=l.shared).pending;null===h?c.next=c:(c.next=h.next,h.next=c),l.pending=c}}a.lanes|=r,null!==(c=a.alternate)&&(c.lanes|=r),Ao(a.return,r,t),u.lanes|=r;break}c=c.next}}else if(10===a.tag)s=a.type===t.type?null:a.child;else if(18===a.tag){if(null===(s=a.return))throw Error(o(341));s.lanes|=r,null!==(u=s.alternate)&&(u.lanes|=r),Ao(s,r,t),s=a.sibling}else s=a.child;if(null!==s)s.return=a;else for(s=a;null!==s;){if(s===t){s=null;break}if(null!==(a=s.sibling)){a.return=s.return,s=a;break}s=s.return}a=s}xs(e,t,i.children,r),t=t.child}return t;case 9:return i=t.type,n=t.pendingProps.children,Eo(t,r),n=n(i=So(i)),t.flags|=1,xs(e,t,n,r),t.child;case 14:return i=yo(n=t.type,t.pendingProps),ks(e,t,n,i=yo(n.type,i),r);case 15:return As(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,i=t.pendingProps,i=t.elementType===n?i:yo(n,i),Ws(e,t),t.tag=1,Bi(n)?(e=!0,Oi(t)):e=!1,Eo(t,r),Wo(t,n,i),Go(t,n,i,r),Is(null,t,n,!0,e,r);case 19:return Vs(e,t,r);case 22:return Es(e,t,r)}throw Error(o(156,t.tag))};var qc="function"===typeof reportError?reportError:function(e){console.error(e)};function Yc(e){this._internalRoot=e}function Xc(e){this._internalRoot=e}function Qc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function $c(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Jc(){}function el(e,t,r,n,i){var o=r._reactRootContainer;if(o){var a=o;if("function"===typeof i){var s=i;i=function(){var e=Kc(a);s.call(e)}}Wc(t,a,e,i)}else a=function(e,t,r,n,i){if(i){if("function"===typeof n){var o=n;n=function(){var e=Kc(a);o.call(e)}}var a=Vc(t,n,e,0,null,!1,0,"",Jc);return e._reactRootContainer=a,e[pi]=a.current,jn(8===e.nodeType?e.parentNode:e),hc(),a}for(;i=e.lastChild;)e.removeChild(i);if("function"===typeof n){var s=n;n=function(){var e=Kc(u);s.call(e)}}var u=Fc(e,0,!1,null,0,!1,0,"",Jc);return e._reactRootContainer=u,e[pi]=u.current,jn(8===e.nodeType?e.parentNode:e),hc((function(){Wc(t,u,r,n)})),u}(r,t,e,i,n);return Kc(a)}Xc.prototype.render=Yc.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(o(409));Wc(e,t,null,null)},Xc.prototype.unmount=Yc.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;hc((function(){Wc(null,e,null,null)})),t[pi]=null}},Xc.prototype.unstable_scheduleHydration=function(e){if(e){var t=At();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Dt.length&&0!==t&&t<Dt[r].priority;r++);Dt.splice(r,0,e),0===r&&zt(e)}},xt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=ht(t.pendingLanes);0!==r&&(vt(t,1|r),ic(t,Qe()),0===(6&Iu)&&(Vu=Qe()+500,ji()))}break;case 13:hc((function(){var t=Po(e,1);if(null!==t){var r=tc();nc(t,e,1,r)}})),Hc(e,1)}},wt=function(e){if(13===e.tag){var t=Po(e,134217728);if(null!==t)nc(t,e,134217728,tc());Hc(e,134217728)}},kt=function(e){if(13===e.tag){var t=rc(e),r=Po(e,t);if(null!==r)nc(r,e,t,tc());Hc(e,t)}},At=function(){return _t},Et=function(e,t){var r=_t;try{return _t=e,t()}finally{_t=r}},we=function(e,t,r){switch(t){case"input":if($(e,r),t=r.name,"radio"===r.type&&null!=t){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var i=xi(n);if(!i)throw Error(o(90));H(n),$(n,i)}}}break;case"textarea":oe(e,r);break;case"select":null!=(t=r.value)&&re(e,!!r.multiple,t,!1)}},Me=lc,Ie=hc;var tl={usingClientEntryPoint:!1,Events:[_i,bi,xi,Se,Te,lc]},rl={findFiberByHostInstance:vi,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},nl={bundleType:rl.bundleType,version:rl.version,rendererPackageName:rl.rendererPackageName,rendererConfig:rl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:b.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ke(e))?null:e.stateNode},findFiberByHostInstance:rl.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var il=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!il.isDisabled&&il.supportsFiber)try{it=il.inject(nl),ot=il}catch(le){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=tl,t.createPortal=function(e,t){var r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Qc(t))throw Error(o(200));return function(e,t,r){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:w,key:null==n?null:""+n,children:e,containerInfo:t,implementation:r}}(e,t,null,r)},t.createRoot=function(e,t){if(!Qc(e))throw Error(o(299));var r=!1,n="",i=qc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(r=!0),void 0!==t.identifierPrefix&&(n=t.identifierPrefix),void 0!==t.onRecoverableError&&(i=t.onRecoverableError)),t=Fc(e,1,!1,null,0,r,0,n,i),e[pi]=t.current,jn(8===e.nodeType?e.parentNode:e),new Yc(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(o(188));throw e=Object.keys(e).join(","),Error(o(268,e))}return e=null===(e=Ke(t))?null:e.stateNode},t.flushSync=function(e){return hc(e)},t.hydrate=function(e,t,r){if(!$c(t))throw Error(o(200));return el(null,e,t,!0,r)},t.hydrateRoot=function(e,t,r){if(!Qc(e))throw Error(o(405));var n=null!=r&&r.hydratedSources||null,i=!1,a="",s=qc;if(null!==r&&void 0!==r&&(!0===r.unstable_strictMode&&(i=!0),void 0!==r.identifierPrefix&&(a=r.identifierPrefix),void 0!==r.onRecoverableError&&(s=r.onRecoverableError)),t=Vc(t,null,e,1,null!=r?r:null,i,0,a,s),e[pi]=t.current,jn(e),n)for(e=0;e<n.length;e++)i=(i=(r=n[e])._getVersion)(r._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[r,i]:t.mutableSourceEagerHydrationData.push(r,i);return new Xc(t)},t.render=function(e,t,r){if(!$c(t))throw Error(o(200));return el(null,e,t,!1,r)},t.unmountComponentAtNode=function(e){if(!$c(e))throw Error(o(40));return!!e._reactRootContainer&&(hc((function(){el(null,null,e,!1,(function(){e._reactRootContainer=null,e[pi]=null}))})),!0)},t.unstable_batchedUpdates=lc,t.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!$c(r))throw Error(o(200));if(null==e||void 0===e._reactInternals)throw Error(o(38));return el(e,t,r,!1,n)},t.version="18.2.0-next-9e3b772b8-20220608"},1250:function(e,t,r){"use strict";var n=r(4164);t.createRoot=n.createRoot,t.hydrateRoot=n.hydrateRoot},4164:function(e,t,r){"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=r(4463)},6374:function(e,t,r){"use strict";var n=r(2791),i=Symbol.for("react.element"),o=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,s=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,u={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,r){var n,o={},c=null,l=null;for(n in void 0!==r&&(c=""+r),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(l=t.ref),t)a.call(t,n)&&!u.hasOwnProperty(n)&&(o[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===o[n]&&(o[n]=t[n]);return{$$typeof:i,type:e,key:c,ref:l,props:o,_owner:s.current}}t.Fragment=o,t.jsx=c,t.jsxs=c},9117:function(e,t){"use strict";var r=Symbol.for("react.element"),n=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),u=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),d=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function y(e,t,r){this.props=e,this.context=t,this.refs=g,this.updater=r||p}function v(){}function _(e,t,r){this.props=e,this.context=t,this.refs=g,this.updater=r||p}y.prototype.isReactComponent={},y.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},y.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},v.prototype=y.prototype;var b=_.prototype=new v;b.constructor=_,m(b,y.prototype),b.isPureReactComponent=!0;var x=Array.isArray,w=Object.prototype.hasOwnProperty,k={current:null},A={key:!0,ref:!0,__self:!0,__source:!0};function E(e,t,n){var i,o={},a=null,s=null;if(null!=t)for(i in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(a=""+t.key),t)w.call(t,i)&&!A.hasOwnProperty(i)&&(o[i]=t[i]);var u=arguments.length-2;if(1===u)o.children=n;else if(1<u){for(var c=Array(u),l=0;l<u;l++)c[l]=arguments[l+2];o.children=c}if(e&&e.defaultProps)for(i in u=e.defaultProps)void 0===o[i]&&(o[i]=u[i]);return{$$typeof:r,type:e,key:a,ref:s,props:o,_owner:k.current}}function S(e){return"object"===typeof e&&null!==e&&e.$$typeof===r}var T=/\/+/g;function M(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function I(e,t,i,o,a){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var u=!1;if(null===e)u=!0;else switch(s){case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case r:case n:u=!0}}if(u)return a=a(u=e),e=""===o?"."+M(u,0):o,x(a)?(i="",null!=e&&(i=e.replace(T,"$&/")+"/"),I(a,t,i,"",(function(e){return e}))):null!=a&&(S(a)&&(a=function(e,t){return{$$typeof:r,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(a,i+(!a.key||u&&u.key===a.key?"":(""+a.key).replace(T,"$&/")+"/")+e)),t.push(a)),1;if(u=0,o=""===o?".":o+":",x(e))for(var c=0;c<e.length;c++){var l=o+M(s=e[c],c);u+=I(s,t,i,l,a)}else if(l=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=d&&e[d]||e["@@iterator"])?e:null}(e),"function"===typeof l)for(e=l.call(e),c=0;!(s=e.next()).done;)u+=I(s=s.value,t,i,l=o+M(s,c++),a);else if("object"===s)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return u}function P(e,t,r){if(null==e)return e;var n=[],i=0;return I(e,n,"","",(function(e){return t.call(r,e,i++)})),n}function C(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var B={current:null},D={transition:null},R={ReactCurrentDispatcher:B,ReactCurrentBatchConfig:D,ReactCurrentOwner:k};t.Children={map:P,forEach:function(e,t,r){P(e,(function(){t.apply(this,arguments)}),r)},count:function(e){var t=0;return P(e,(function(){t++})),t},toArray:function(e){return P(e,(function(e){return e}))||[]},only:function(e){if(!S(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=y,t.Fragment=i,t.Profiler=a,t.PureComponent=_,t.StrictMode=o,t.Suspense=l,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=R,t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=m({},e.props),o=e.key,a=e.ref,s=e._owner;if(null!=t){if(void 0!==t.ref&&(a=t.ref,s=k.current),void 0!==t.key&&(o=""+t.key),e.type&&e.type.defaultProps)var u=e.type.defaultProps;for(c in t)w.call(t,c)&&!A.hasOwnProperty(c)&&(i[c]=void 0===t[c]&&void 0!==u?u[c]:t[c])}var c=arguments.length-2;if(1===c)i.children=n;else if(1<c){u=Array(c);for(var l=0;l<c;l++)u[l]=arguments[l+2];i.children=u}return{$$typeof:r,type:e.type,key:o,ref:a,props:i,_owner:s}},t.createContext=function(e){return(e={$$typeof:u,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:s,_context:e},e.Consumer=e},t.createElement=E,t.createFactory=function(e){var t=E.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=S,t.lazy=function(e){return{$$typeof:f,_payload:{_status:-1,_result:e},_init:C}},t.memo=function(e,t){return{$$typeof:h,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=D.transition;D.transition={};try{e()}finally{D.transition=t}},t.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")},t.useCallback=function(e,t){return B.current.useCallback(e,t)},t.useContext=function(e){return B.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return B.current.useDeferredValue(e)},t.useEffect=function(e,t){return B.current.useEffect(e,t)},t.useId=function(){return B.current.useId()},t.useImperativeHandle=function(e,t,r){return B.current.useImperativeHandle(e,t,r)},t.useInsertionEffect=function(e,t){return B.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return B.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return B.current.useMemo(e,t)},t.useReducer=function(e,t,r){return B.current.useReducer(e,t,r)},t.useRef=function(e){return B.current.useRef(e)},t.useState=function(e){return B.current.useState(e)},t.useSyncExternalStore=function(e,t,r){return B.current.useSyncExternalStore(e,t,r)},t.useTransition=function(){return B.current.useTransition()},t.version="18.2.0"},2791:function(e,t,r){"use strict";e.exports=r(9117)},184:function(e,t,r){"use strict";e.exports=r(6374)},4641:function(e,t,r){"use strict";var n=r(9778).Buffer,i=r(4836);t.Z=void 0;var o=i(r(4687)),a=i(r(7156)),s=i(r(8698)),u=i(r(6690)),c=i(r(9728)),l=i(r(1655)),h=i(r(4993)),f=i(r(3808)),d=r(7143);function p(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,f.default)(e);if(t){var i=(0,f.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,h.default)(this,r)}}var m=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r},g=function(e){(0,l.default)(r,e);var t=p(r);function r(e){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ws://localhost:8080",o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3?arguments[3]:void 0;(0,u.default)(this,r);var s=o.autoconnect,c=void 0===s||s,l=o.reconnect,h=void 0===l||l,f=o.reconnect_interval,d=void 0===f?1e3:f,p=o.max_reconnects,g=void 0===p?5:p,y=m(o,["autoconnect","reconnect","reconnect_interval","max_reconnects"]);return(n=t.call(this)).webSocketFactory=e,n.queue={},n.rpc_id=0,n.address=i,n.autoconnect=c,n.ready=!1,n.reconnect=h,n.reconnect_timer_id=void 0,n.reconnect_interval=d,n.max_reconnects=g,n.rest_options=y,n.current_reconnects=0,n.generate_request_id=a||function(){return++n.rpc_id},n.autoconnect&&n._connect(n.address,Object.assign({autoconnect:n.autoconnect,reconnect:n.reconnect,reconnect_interval:n.reconnect_interval,max_reconnects:n.max_reconnects},n.rest_options)),n}return(0,c.default)(r,[{key:"connect",value:function(){this.socket||this._connect(this.address,Object.assign({autoconnect:this.autoconnect,reconnect:this.reconnect,reconnect_interval:this.reconnect_interval,max_reconnects:this.max_reconnects},this.rest_options))}},{key:"call",value:function(e,t,r,n){var i=this;return n||"object"!==(0,s.default)(r)||(n=r,r=null),new Promise((function(o,a){if(!i.ready)return a(new Error("socket not ready"));var s=i.generate_request_id(e,t),u={jsonrpc:"2.0",method:e,params:t||null,id:s};i.socket.send(JSON.stringify(u),n,(function(e){if(e)return a(e);i.queue[s]={promise:[o,a]},r&&(i.queue[s].timeout=setTimeout((function(){delete i.queue[s],a(new Error("reply timeout"))}),r))}))}))}},{key:"login",value:function(){var e=(0,a.default)(o.default.mark((function e(t){var r;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.call("rpc.login",t);case 2:if(r=e.sent){e.next=5;break}throw new Error("authentication failed");case 5:return e.abrupt("return",r);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"listMethods",value:function(){var e=(0,a.default)(o.default.mark((function e(){return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.call("__listMethods");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"notify",value:function(e,t){var r=this;return new Promise((function(n,i){if(!r.ready)return i(new Error("socket not ready"));var o={jsonrpc:"2.0",method:e,params:t||null};r.socket.send(JSON.stringify(o),(function(e){if(e)return i(e);n()}))}))}},{key:"subscribe",value:function(){var e=(0,a.default)(o.default.mark((function e(t){var r;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"string"===typeof t&&(t=[t]),e.next=3,this.call("rpc.on",t);case 3:if(r=e.sent,"string"!==typeof t||"ok"===r[t]){e.next=6;break}throw new Error("Failed subscribing to an event '"+t+"' with: "+r[t]);case 6:return e.abrupt("return",r);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"unsubscribe",value:function(){var e=(0,a.default)(o.default.mark((function e(t){var r;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"string"===typeof t&&(t=[t]),e.next=3,this.call("rpc.off",t);case 3:if(r=e.sent,"string"!==typeof t||"ok"===r[t]){e.next=6;break}throw new Error("Failed unsubscribing from an event with: "+r);case 6:return e.abrupt("return",r);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"close",value:function(e,t){this.socket.close(e||1e3,t)}},{key:"_connect",value:function(e,t){var r=this;clearTimeout(this.reconnect_timer_id),this.socket=this.webSocketFactory(e,t),this.socket.addEventListener("open",(function(){r.ready=!0,r.emit("open"),r.current_reconnects=0})),this.socket.addEventListener("message",(function(e){var t=e.data;t instanceof ArrayBuffer&&(t=n.from(t).toString());try{t=JSON.parse(t)}catch(a){return}if(t.notification&&r.listeners(t.notification).length){if(!Object.keys(t.params).length)return r.emit(t.notification);var i=[t.notification];if(t.params.constructor===Object)i.push(t.params);else for(var o=0;o<t.params.length;o++)i.push(t.params[o]);return Promise.resolve().then((function(){r.emit.apply(r,i)}))}if(!r.queue[t.id])return t.method&&t.params?Promise.resolve().then((function(){r.emit(t.method,t.params)})):void 0;"error"in t==="result"in t&&r.queue[t.id].promise[1](new Error('Server response malformed. Response must include either "result" or "error", but not both.')),r.queue[t.id].timeout&&clearTimeout(r.queue[t.id].timeout),t.error?r.queue[t.id].promise[1](t.error):r.queue[t.id].promise[0](t.result),delete r.queue[t.id]})),this.socket.addEventListener("error",(function(e){return r.emit("error",e)})),this.socket.addEventListener("close",(function(n){var i=n.code,o=n.reason;r.ready&&setTimeout((function(){return r.emit("close",i,o)}),0),r.ready=!1,r.socket=void 0,1e3!==i&&(r.current_reconnects++,r.reconnect&&(r.max_reconnects>r.current_reconnects||0===r.max_reconnects)&&(r.reconnect_timer_id=setTimeout((function(){return r._connect(e,t)}),r.reconnect_interval)))}))}}]),r}(d.EventEmitter);t.Z=g},5421:function(e,t,r){"use strict";var n=r(4836);t.Z=function(e,t){return new l(e,t)};var i=n(r(6690)),o=n(r(9728)),a=n(r(1655)),s=n(r(4993)),u=n(r(3808));function c(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=(0,u.default)(e);if(t){var i=(0,u.default)(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return(0,s.default)(this,r)}}var l=function(e){(0,a.default)(r,e);var t=c(r);function r(e,n,o){var a;return(0,i.default)(this,r),(a=t.call(this)).socket=new window.WebSocket(e,o),a.socket.onopen=function(){return a.emit("open")},a.socket.onmessage=function(e){return a.emit("message",e.data)},a.socket.onerror=function(e){return a.emit("error",e)},a.socket.onclose=function(e){a.emit("close",e.code,e.reason)},a}return(0,o.default)(r,[{key:"send",value:function(e,t,r){var n=r||t;try{this.socket.send(e),n()}catch(i){n(i)}}},{key:"close",value:function(e,t){this.socket.close(e,t)}},{key:"addEventListener",value:function(e,t,r){this.socket.addEventListener(e,t,r)}}]),r}(r(7143).EventEmitter)},2543:function(e,t,r){var n=r(9778),i=n.Buffer;function o(e,t){for(var r in e)t[r]=e[r]}function a(e,t,r){return i(e,t,r)}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?e.exports=n:(o(n,t),t.Buffer=a),a.prototype=Object.create(i.prototype),o(i,a),a.from=function(e,t,r){if("number"===typeof e)throw new TypeError("Argument must not be a number");return i(e,t,r)},a.alloc=function(e,t,r){if("number"!==typeof e)throw new TypeError("Argument must be a number");var n=i(e);return void 0!==t?"string"===typeof r?n.fill(t,r):n.fill(t):n.fill(0),n},a.allocUnsafe=function(e){if("number"!==typeof e)throw new TypeError("Argument must be a number");return i(e)},a.allocUnsafeSlow=function(e){if("number"!==typeof e)throw new TypeError("Argument must be a number");return n.SlowBuffer(e)}},6813:function(e,t){"use strict";function r(e,t){var r=e.length;e.push(t);e:for(;0<r;){var n=r-1>>>1,i=e[n];if(!(0<o(i,t)))break e;e[n]=t,e[r]=i,r=n}}function n(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],r=e.pop();if(r!==t){e[0]=r;e:for(var n=0,i=e.length,a=i>>>1;n<a;){var s=2*(n+1)-1,u=e[s],c=s+1,l=e[c];if(0>o(u,r))c<i&&0>o(l,u)?(e[n]=l,e[c]=r,n=c):(e[n]=u,e[s]=r,n=s);else{if(!(c<i&&0>o(l,r)))break e;e[n]=l,e[c]=r,n=c}}}return t}function o(e,t){var r=e.sortIndex-t.sortIndex;return 0!==r?r:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var a=performance;t.unstable_now=function(){return a.now()}}else{var s=Date,u=s.now();t.unstable_now=function(){return s.now()-u}}var c=[],l=[],h=1,f=null,d=3,p=!1,m=!1,g=!1,y="function"===typeof setTimeout?setTimeout:null,v="function"===typeof clearTimeout?clearTimeout:null,_="undefined"!==typeof setImmediate?setImmediate:null;function b(e){for(var t=n(l);null!==t;){if(null===t.callback)i(l);else{if(!(t.startTime<=e))break;i(l),t.sortIndex=t.expirationTime,r(c,t)}t=n(l)}}function x(e){if(g=!1,b(e),!m)if(null!==n(c))m=!0,D(w);else{var t=n(l);null!==t&&R(x,t.startTime-e)}}function w(e,r){m=!1,g&&(g=!1,v(S),S=-1),p=!0;var o=d;try{for(b(r),f=n(c);null!==f&&(!(f.expirationTime>r)||e&&!I());){var a=f.callback;if("function"===typeof a){f.callback=null,d=f.priorityLevel;var s=a(f.expirationTime<=r);r=t.unstable_now(),"function"===typeof s?f.callback=s:f===n(c)&&i(c),b(r)}else i(c);f=n(c)}if(null!==f)var u=!0;else{var h=n(l);null!==h&&R(x,h.startTime-r),u=!1}return u}finally{f=null,d=o,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var k,A=!1,E=null,S=-1,T=5,M=-1;function I(){return!(t.unstable_now()-M<T)}function P(){if(null!==E){var e=t.unstable_now();M=e;var r=!0;try{r=E(!0,e)}finally{r?k():(A=!1,E=null)}}else A=!1}if("function"===typeof _)k=function(){_(P)};else if("undefined"!==typeof MessageChannel){var C=new MessageChannel,B=C.port2;C.port1.onmessage=P,k=function(){B.postMessage(null)}}else k=function(){y(P,0)};function D(e){E=e,A||(A=!0,k())}function R(e,r){S=y((function(){e(t.unstable_now())}),r)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||p||(m=!0,D(w))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):T=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return d},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(e){switch(d){case 1:case 2:case 3:var t=3;break;default:t=d}var r=d;d=t;try{return e()}finally{d=r}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var r=d;d=e;try{return t()}finally{d=r}},t.unstable_scheduleCallback=function(e,i,o){var a=t.unstable_now();switch("object"===typeof o&&null!==o?o="number"===typeof(o=o.delay)&&0<o?a+o:a:o=a,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:h++,callback:i,priorityLevel:e,startTime:o,expirationTime:s=o+s,sortIndex:-1},o>a?(e.sortIndex=o,r(l,e),null===n(c)&&e===n(l)&&(g?(v(S),S=-1):g=!0,R(x,o-a))):(e.sortIndex=s,r(c,e),m||p||(m=!0,D(w))),e},t.unstable_shouldYield=I,t.unstable_wrapCallback=function(e){var t=d;return function(){var r=d;d=t;try{return e.apply(this,arguments)}finally{d=r}}}},5296:function(e,t,r){"use strict";e.exports=r(6813)},3741:function(e,t,r){"use strict";r.d(t,{v4:function(){return n.Z}});var n=r(2810)},2810:function(e,t,r){"use strict";var n;r.d(t,{Z:function(){return h}});var i=new Uint8Array(16);function o(){if(!n&&!(n="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!==typeof msCrypto&&"function"===typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(i)}var a=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var s=function(e){return"string"===typeof e&&a.test(e)},u=[],c=0;c<256;++c)u.push((c+256).toString(16).substr(1));var l=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=(u[e[t+0]]+u[e[t+1]]+u[e[t+2]]+u[e[t+3]]+"-"+u[e[t+4]]+u[e[t+5]]+"-"+u[e[t+6]]+u[e[t+7]]+"-"+u[e[t+8]]+u[e[t+9]]+"-"+u[e[t+10]]+u[e[t+11]]+u[e[t+12]]+u[e[t+13]]+u[e[t+14]]+u[e[t+15]]).toLowerCase();if(!s(r))throw TypeError("Stringified UUID is invalid");return r};var h=function(e,t,r){var n=(e=e||{}).random||(e.rng||o)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,t){r=r||0;for(var i=0;i<16;++i)t[r+i]=n[i];return t}return l(n)}},9752:function(e,t,r){"use strict";r.r(t),t.default={}},3373:function(e){e.exports=function(){"use strict";var e,t,r;function n(n,i){if(e)if(t){var o="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+e+")(sharedChunk); ("+t+")(sharedChunk); self.onerror = null;",a={};e(a),r=i(a),"undefined"!==typeof window&&window&&window.URL&&window.URL.createObjectURL&&(r.workerUrl=window.URL.createObjectURL(new Blob([o],{type:"text/javascript"})))}else t=i;else e=i}return n(["exports"],(function(e){var t="undefined"!=typeof self?self:{},r="2.13.0";let n;const i={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(null==n){const e=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{n=null!={NODE_ENV:"production",PUBLIC_URL:"/ohr",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.API_URL_REGEX?new RegExp({NODE_ENV:"production",PUBLIC_URL:"/ohr",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.API_URL_REGEX):e}catch(t){n=e}}return n},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){return this.API_URL?0===this.API_URL.indexOf("https://api.mapbox.cn")?"https://events.mapbox.cn/events/v2":0===this.API_URL.indexOf("https://api.mapbox.com")?"https://events.mapbox.com/events/v2":null:null},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},o={supported:!1,testSupport:function(e){!u&&s&&(c?l(e):a=e)}};let a,s,u=!1,c=!1;function l(e){const t=e.createTexture();e.bindTexture(e.TEXTURE_2D,t);try{if(e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,s),e.isContextLost())return;o.supported=!0}catch(e){}e.deleteTexture(t),u=!0}t.document&&(s=t.document.createElement("img"),s.onload=function(){a&&l(a),a=null,c=!0},s.onerror=function(){u=!0,a=null},s.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const h="01";var f=d;function d(e,t,r,n){this.cx=3*e,this.bx=3*(r-e)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*t,this.by=3*(n-t)-this.cy,this.ay=1-this.cy-this.by,this.p1x=e,this.p1y=t,this.p2x=r,this.p2y=n}d.prototype={sampleCurveX:function(e){return((this.ax*e+this.bx)*e+this.cx)*e},sampleCurveY:function(e){return((this.ay*e+this.by)*e+this.cy)*e},sampleCurveDerivativeX:function(e){return(3*this.ax*e+2*this.bx)*e+this.cx},solveCurveX:function(e,t){if(void 0===t&&(t=1e-6),e<0)return 0;if(e>1)return 1;for(var r=e,n=0;n<8;n++){var i=this.sampleCurveX(r)-e;if(Math.abs(i)<t)return r;var o=this.sampleCurveDerivativeX(r);if(Math.abs(o)<1e-6)break;r-=i/o}var a=0,s=1;for(r=e,n=0;n<20&&(i=this.sampleCurveX(r),!(Math.abs(i-e)<t));n++)e>i?a=r:s=r,r=.5*(s-a)+a;return r},solve:function(e,t){return this.sampleCurveY(this.solveCurveX(e,t))}};var p=m;function m(e,t){this.x=e,this.y=t}m.prototype={clone:function(){return new m(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,r=e.y-this.y;return t*t+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[2]*this.x+e[3]*this.y;return this.x=e[0]*this.x+e[1]*this.y,this.y=t,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),r=Math.sin(e),n=r*this.x+t*this.y;return this.x=t*this.x-r*this.y,this.y=n,this},_rotateAround:function(e,t){var r=Math.cos(e),n=Math.sin(e),i=t.y+n*(this.x-t.x)+r*(this.y-t.y);return this.x=t.x+r*(this.x-t.x)-n*(this.y-t.y),this.y=i,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},m.convert=function(e){return e instanceof m?e:Array.isArray(e)?new m(e[0],e[1]):e};const g=Math.PI/180,y=180/Math.PI;function v(e){return e*g}function _(e){return e*y}const b=[[0,0],[1,0],[1,1],[0,1]];function x(e){if(e<=0)return 0;if(e>=1)return 1;const t=e*e,r=t*e;return 4*(e<.5?r:3*(e-t)+r-.75)}function w(e,t,r,n){const i=new f(e,t,r,n);return function(e){return i.solve(e)}}const k=w(.25,.1,.25,1);function A(e,t,r){return Math.min(r,Math.max(t,e))}function E(e,t,r){return(r=A((r-e)/(t-e),0,1))*r*(3-2*r)}function S(e,t,r){const n=r-t,i=((e-t)%n+n)%n+t;return i===t?r:i}function T(e,t,r){if(!e.length)return r(null,[]);let n=e.length;const i=new Array(e.length);let o=null;e.forEach(((e,a)=>{t(e,((e,t)=>{e&&(o=e),i[a]=t,0==--n&&r(o,i)}))}))}function M(e){const t=[];for(const r in e)t.push(e[r]);return t}function I(e,...t){for(const r of t)for(const t in r)e[t]=r[t];return e}let P=1;function C(){return P++}function B(){return function e(t){return t?(t^Math.random()*(16>>t/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,e)}()}function D(e){return e<=1?1:Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))}function R(e){return!!e&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)}function L(e,t){e.forEach((e=>{t[e]&&(t[e]=t[e].bind(t))}))}function O(e,t){return-1!==e.indexOf(t,e.length-t.length)}function z(e,t,r){const n={};for(const i in e)n[i]=t.call(r||this,e[i],i,e);return n}function N(e,t,r){const n={};for(const i in e)t.call(r||this,e[i],i,e)&&(n[i]=e[i]);return n}function U(e){return Array.isArray(e)?e.map(U):"object"==typeof e&&e?z(e,U):e}const Z={};function F(e){Z[e]||("undefined"!=typeof console&&console.warn(e),Z[e]=!0)}function j(e,t,r){return(r.y-e.y)*(t.x-e.x)>(t.y-e.y)*(r.x-e.x)}function V(e){let t=0;for(let r,n,i=0,o=e.length,a=o-1;i<o;a=i++)r=e[i],n=e[a],t+=(n.x-r.x)*(r.y+n.y);return t}function W(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}function K(e){const t={};if(e.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((e,r,n,i)=>{const o=n||i;return t[r]=!o||o.toLowerCase(),""})),t["max-age"]){const e=parseInt(t["max-age"],10);isNaN(e)?delete t["max-age"]:t["max-age"]=e}return t}let G=null;function H(e){if(null==G){const t=e.navigator?e.navigator.userAgent:null;G=!!e.safari||!(!t||!(/\b(iPad|iPhone|iPod)\b/.test(t)||t.match("Safari")&&!t.match("Chrome")))}return G}function q(e){try{const r=t[e];return r.setItem("_mapbox_test_",1),r.removeItem("_mapbox_test_"),!0}catch(e){return!1}}function Y(e,t){return[e[4*t],e[4*t+1],e[4*t+2],e[4*t+3]]}const X="mapbox-tiles";let Q,$,J=500,ee=50;function te(){try{return t.caches}catch(e){}}function re(){te()&&!Q&&(Q=t.caches.open(X))}function ne(e){const t=e.indexOf("?");if(t<0)return e;const r=function(e){const t=e.indexOf("?");return t>0?e.slice(t+1).split("&"):[]}(e),n=r.filter((e=>{const t=e.split("=");return"language"===t[0]||"worldview"===t[0]}));return n.length?`${e.slice(0,t)}?${n.join("&")}`:e.slice(0,t)}let ie=1/0;const oe={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(oe);class ae extends Error{constructor(e,t,r){401===t&&ye(r)&&(e+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(e),this.status=t,this.url=r}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const se=W()?()=>self.worker&&self.worker.referrer:()=>("blob:"===t.location.protocol?t.parent:t).location.href,ue=function(e,r){if(!(/^file:/.test(n=e.url)||/^file:/.test(se())&&!/^\w+:/.test(n))){if(t.fetch&&t.Request&&t.AbortController&&t.Request.prototype.hasOwnProperty("signal"))return function(e,r){const n=new t.AbortController,i=new t.Request(e.url,{method:e.method||"GET",body:e.body,credentials:e.credentials,headers:e.headers,referrer:se(),signal:n.signal});let o=!1,a=!1;const s=(u=i.url).indexOf("sku=")>0&&ye(u);var u;"json"===e.type&&i.headers.set("Accept","application/json");const c=(n,o,u)=>{if(a)return;if(n&&"SecurityError"!==n.message&&F(n),o&&u)return l(o);const c=Date.now();t.fetch(i).then((t=>{if(t.ok){const e=s?t.clone():null;return l(t,e,c)}return r(new ae(t.statusText,t.status,e.url))})).catch((t=>{"AbortError"!==t.name&&r(new Error(`${t.message} ${e.url}`))}))},l=(n,s,u)=>{("arrayBuffer"===e.type?n.arrayBuffer():"json"===e.type?n.json():n.text()).then((e=>{a||(s&&u&&function(e,r,n){if(re(),!Q)return;const i={status:r.status,statusText:r.statusText,headers:new t.Headers};r.headers.forEach(((e,t)=>i.headers.set(t,e)));const o=K(r.headers.get("Cache-Control")||"");if(o["no-store"])return;o["max-age"]&&i.headers.set("Expires",new Date(n+1e3*o["max-age"]).toUTCString());const a=i.headers.get("Expires");a&&(new Date(a).getTime()-n<42e4||function(e,t){if(void 0===$)try{new Response(new ReadableStream),$=!0}catch(e){$=!1}$?t(e.body):e.blob().then(t)}(r,(r=>{const n=new t.Response(r,i);re(),Q&&Q.then((t=>t.put(ne(e.url),n))).catch((e=>F(e.message)))})))}(i,s,u),o=!0,r(null,e,n.headers.get("Cache-Control"),n.headers.get("Expires")))})).catch((e=>{a||r(new Error(e.message))}))};return s?function(e,t){if(re(),!Q)return t(null);const r=ne(e.url);Q.then((e=>{e.match(r).then((n=>{const i=function(e){if(!e)return!1;const t=new Date(e.headers.get("Expires")||0),r=K(e.headers.get("Cache-Control")||"");return t>Date.now()&&!r["no-cache"]}(n);e.delete(r),i&&e.put(r,n.clone()),t(null,n,i)})).catch(t)})).catch(t)}(i,c):c(null,null),{cancel:()=>{a=!0,o||n.abort()}}}(e,r);if(W()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",e,r,void 0,!0)}var n;return function(e,r){const n=new t.XMLHttpRequest;n.open(e.method||"GET",e.url,!0),"arrayBuffer"===e.type&&(n.responseType="arraybuffer");for(const t in e.headers)n.setRequestHeader(t,e.headers[t]);return"json"===e.type&&(n.responseType="text",n.setRequestHeader("Accept","application/json")),n.withCredentials="include"===e.credentials,n.onerror=()=>{r(new Error(n.statusText))},n.onload=()=>{if((n.status>=200&&n.status<300||0===n.status)&&null!==n.response){let t=n.response;if("json"===e.type)try{t=JSON.parse(n.response)}catch(e){return r(e)}r(null,t,n.getResponseHeader("Cache-Control"),n.getResponseHeader("Expires"))}else r(new ae(n.statusText,n.status,e.url))},n.send(e.body),{cancel:()=>n.abort()}}(e,r)},ce=function(e,t){return ue(I(e,{type:"arrayBuffer"}),t)};function le(e){const r=t.document.createElement("a");return r.href=e,r.protocol===t.document.location.protocol&&r.host===t.document.location.host}const he="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let fe,de;fe=[],de=0;const pe=function(e,r){if(o.supported&&(e.headers||(e.headers={}),e.headers.accept="image/webp,*/*"),de>=i.MAX_PARALLEL_IMAGE_REQUESTS){const t={requestParameters:e,callback:r,cancelled:!1,cancel(){this.cancelled=!0}};return fe.push(t),t}de++;let n=!1;const a=()=>{if(!n)for(n=!0,de--;fe.length&&de<i.MAX_PARALLEL_IMAGE_REQUESTS;){const e=fe.shift(),{requestParameters:t,callback:r,cancelled:n}=e;n||(e.cancel=pe(t,r).cancel)}},s=ce(e,((e,n,i,o)=>{a(),e?r(e):n&&(t.createImageBitmap?function(e,r){const n=new t.Blob([new Uint8Array(e)],{type:"image/png"});t.createImageBitmap(n).then((e=>{r(null,e)})).catch((e=>{r(new Error(`Could not load image because of ${e.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))}))}(n,((e,t)=>r(e,t,i,o))):function(e,r){const n=new t.Image,i=t.URL;n.onload=()=>{r(null,n),i.revokeObjectURL(n.src),n.onload=null,t.requestAnimationFrame((()=>{n.src=he}))},n.onerror=()=>r(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const o=new t.Blob([new Uint8Array(e)],{type:"image/png"});n.src=e.byteLength?i.createObjectURL(o):he}(n,((e,t)=>r(e,t,i,o))))}));return{cancel:()=>{s.cancel(),a()}}},me="NO_ACCESS_TOKEN";function ge(e){return 0===e.indexOf("mapbox:")}function ye(e){return i.API_URL_REGEX.test(e)}function ve(e){return i.API_CDN_URL_REGEX.test(e)}function _e(e){return i.API_STYLE_REGEX.test(e)&&!be(e)}function be(e){return i.API_SPRITE_REGEX.test(e)}const xe=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function we(e){const t=e.match(xe);if(!t)throw new Error("Unable to parse URL object");return{protocol:t[1],authority:t[2],path:t[3]||"/",params:t[4]?t[4].split("&"):[]}}function ke(e){const t=e.params.length?`?${e.params.join("&")}`:"";return`${e.protocol}://${e.authority}${e.path}${t}`}function Ae(e){if(!e)return null;const r=e.split(".");if(!r||3!==r.length)return null;try{return JSON.parse(decodeURIComponent(t.atob(r[1]).split("").map((e=>"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2))).join("")))}catch(e){return null}}class Ee{constructor(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(e){const r=Ae(i.ACCESS_TOKEN);let n="";return n=r&&r.u?t.btoa(encodeURIComponent(r.u).replace(/%([0-9A-F]{2})/g,((e,t)=>String.fromCharCode(Number("0x"+t))))):i.ACCESS_TOKEN||"",e?`mapbox.eventData.${e}:${n}`:`mapbox.eventData:${n}`}fetchEventData(){const e=q("localStorage"),r=this.getStorageKey(),n=this.getStorageKey("uuid");if(e)try{const e=t.localStorage.getItem(r);e&&(this.eventData=JSON.parse(e));const i=t.localStorage.getItem(n);i&&(this.anonId=i)}catch(e){F("Unable to read from LocalStorage")}}saveEventData(){const e=q("localStorage"),r=this.getStorageKey(),n=this.getStorageKey("uuid");if(e)try{t.localStorage.setItem(n,this.anonId),Object.keys(this.eventData).length>=1&&t.localStorage.setItem(r,JSON.stringify(this.eventData))}catch(e){F("Unable to write to LocalStorage")}}processRequests(e){}postEvent(e,t,r,n){if(!i.EVENTS_URL)return;const o=we(i.EVENTS_URL);o.params.push(`access_token=${n||i.ACCESS_TOKEN||""}`);const a={event:this.type,created:new Date(e).toISOString()},s=t?I(a,t):a,u={url:ke(o),headers:{"Content-Type":"text/plain"},body:JSON.stringify([s])};this.pendingRequest=function(e,t){return ue(I(e,{method:"POST"}),t)}(u,(e=>{this.pendingRequest=null,r(e),this.saveEventData(),this.processRequests(n)}))}queueRequest(e,t){this.queue.push(e),this.processRequests(t)}}const Se=new class extends Ee{constructor(e){super("appUserTurnstile"),this._customAccessToken=e}postTurnstileEvent(e,t){i.EVENTS_URL&&i.ACCESS_TOKEN&&Array.isArray(e)&&e.some((e=>ge(e)||ye(e)))&&this.queueRequest(Date.now(),t)}processRequests(e){if(this.pendingRequest||0===this.queue.length)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const t=Ae(i.ACCESS_TOKEN),n=t?t.u:i.ACCESS_TOKEN;let o=n!==this.eventData.tokenU;R(this.anonId)||(this.anonId=B(),o=!0);const a=this.queue.shift();if(this.eventData.lastSuccess){const e=new Date(this.eventData.lastSuccess),t=new Date(a),r=(a-this.eventData.lastSuccess)/864e5;o=o||r>=1||r<-1||e.getDate()!==t.getDate()}else o=!0;o?this.postEvent(a,{sdkIdentifier:"mapbox-gl-js",sdkVersion:r,skuId:h,"enabled.telemetry":!1,userId:this.anonId},(e=>{e||(this.eventData.lastSuccess=a,this.eventData.tokenU=n)}),e):this.processRequests()}},Te=Se.postTurnstileEvent.bind(Se),Me=new class extends Ee{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(e,t,r,n){this.skuToken=t,this.errorCb=n,i.EVENTS_URL&&(r||i.ACCESS_TOKEN?this.queueRequest({id:e,timestamp:Date.now()},r):this.errorCb(new Error(me)))}processRequests(e){if(this.pendingRequest||0===this.queue.length)return;const{id:t,timestamp:n}=this.queue.shift();t&&this.success[t]||(this.anonId||this.fetchEventData(),R(this.anonId)||(this.anonId=B()),this.postEvent(n,{sdkIdentifier:"mapbox-gl-js",sdkVersion:r,skuId:h,skuToken:this.skuToken,userId:this.anonId},(e=>{e?this.errorCb(e):t&&(this.success[t]=!0)}),e))}},Ie=Me.postMapLoadEvent.bind(Me),Pe=new class extends Ee{constructor(){super("gljs.performance")}postPerformanceEvent(e,t){i.EVENTS_URL&&(e||i.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:t},e)}processRequests(e){if(this.pendingRequest||0===this.queue.length)return;const{timestamp:n,performanceData:i}=this.queue.shift(),o=function(e){const n=t.performance.getEntriesByType("resource"),i=t.performance.getEntriesByType("mark"),o=function(e){const t={};if(e)for(const r in e)if("other"!==r)for(const n of e[r]){const e=`${r}ResolveRangeMin`,i=`${r}ResolveRangeMax`,o=`${r}RequestCount`,a=`${r}RequestCachedCount`;t[e]=Math.min(t[e]||1/0,n.startTime),t[i]=Math.max(t[i]||-1/0,n.responseEnd);const s=e=>{void 0===t[e]&&(t[e]=0),++t[e]};void 0!==n.transferSize&&0===n.transferSize&&s(a),s(o)}return t}(function(e,t){const r={};if(e)for(const n of e){const e=t(n);void 0===r[e]&&(r[e]=[]),r[e].push(n)}return r}(n,ze)),a=t.devicePixelRatio,s=t.navigator.connection||t.navigator.mozConnection||t.navigator.webkitConnection,u={counters:[],metadata:[],attributes:[]},c=(e,t,r)=>{null!=r&&e.push({name:t,value:r.toString()})};for(const t in o)c(u.counters,t,o[t]);if(e.interactionRange[0]!==1/0&&e.interactionRange[1]!==-1/0&&(c(u.counters,"interactionRangeMin",e.interactionRange[0]),c(u.counters,"interactionRangeMax",e.interactionRange[1])),i)for(const t of Object.keys(Le)){const e=Le[t],r=i.find((t=>t.name===e));r&&c(u.counters,e,r.startTime)}return c(u.counters,"visibilityHidden",e.visibilityHidden),c(u.attributes,"style",function(e){if(e)for(const t of e){const e=t.name.split("?")[0];if(_e(e)){const t=e.split("/").slice(-2);if(2===t.length)return`mapbox://styles/${t[0]}/${t[1]}`}}}(n)),c(u.attributes,"terrainEnabled",e.terrainEnabled?"true":"false"),c(u.attributes,"fogEnabled",e.fogEnabled?"true":"false"),c(u.attributes,"projection",e.projection),c(u.attributes,"zoom",e.zoom),c(u.metadata,"devicePixelRatio",a),c(u.metadata,"connectionEffectiveType",s?s.effectiveType:void 0),c(u.metadata,"navigatorUserAgent",t.navigator.userAgent),c(u.metadata,"screenWidth",t.screen.width),c(u.metadata,"screenHeight",t.screen.height),c(u.metadata,"windowWidth",t.innerWidth),c(u.metadata,"windowHeight",t.innerHeight),c(u.metadata,"mapWidth",e.width/a),c(u.metadata,"mapHeight",e.height/a),c(u.metadata,"webglRenderer",e.renderer),c(u.metadata,"webglVendor",e.vendor),c(u.metadata,"sdkVersion",r),c(u.metadata,"sdkIdentifier","mapbox-gl-js"),u}(i);for(const t of o.metadata);for(const t of o.counters);for(const t of o.attributes);this.postEvent(n,o,(()=>{}),e)}},Ce=Pe.postPerformanceEvent.bind(Pe),Be=new class extends Ee{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(e,t,r,n){if(!i.API_URL||!i.SESSION_PATH)return;const o=we(i.API_URL+i.SESSION_PATH);o.params.push(`sku=${t||""}`),o.params.push(`access_token=${n||i.ACCESS_TOKEN||""}`);const a={url:ke(o),headers:{"Content-Type":"text/plain"}};this.pendingRequest=function(e,t){return ue(I(e,{method:"GET"}),t)}(a,(e=>{this.pendingRequest=null,r(e),this.saveEventData(),this.processRequests(n)}))}getSessionAPI(e,t,r,n){this.skuToken=t,this.errorCb=n,i.SESSION_PATH&&i.API_URL&&(r||i.ACCESS_TOKEN?this.queueRequest({id:e,timestamp:Date.now()},r):this.errorCb(new Error(me)))}processRequests(e){if(this.pendingRequest||0===this.queue.length)return;const{id:t,timestamp:r}=this.queue.shift();t&&this.success[t]||this.getSession(r,this.skuToken,(e=>{e?this.errorCb(e):t&&(this.success[t]=!0)}),e)}},De=Be.getSessionAPI.bind(Be),Re=new Set,Le={create:"create",load:"load",fullLoad:"fullLoad"},Oe={mark(e){t.performance.mark(e)},measure(e,r,n){t.performance.measure(e,r,n)}};function ze(e){const t=e.name.split("?")[0];return ve(t)&&t.includes("mapbox-gl.js")?"javascript":ve(t)&&t.includes("mapbox-gl.css")?"css":function(e){return i.API_FONTS_REGEX.test(e)}(t)?"fontRange":be(t)?"sprite":_e(t)?"style":function(e){return i.API_TILEJSON_REGEX.test(e)}(t)?"tilejson":"other"}const Ne=t.performance;function Ue(e){const t=e?e.url.toString():void 0;return Ne.getEntriesByName(t)}let Ze,Fe,je,Ve;const We={now:()=>void 0!==je?je:t.performance.now(),setNow(e){je=e},restoreNow(){je=void 0},frame(e){const r=t.requestAnimationFrame(e);return{cancel:()=>t.cancelAnimationFrame(r)}},getImageData(e,r=0){const{width:n,height:i}=e;Ve||(Ve=t.document.createElement("canvas"));const o=Ve.getContext("2d",{willReadFrequently:!0});if(!o)throw new Error("failed to create canvas 2d context");return(n>Ve.width||i>Ve.height)&&(Ve.width=n,Ve.height=i),o.clearRect(-r,-r,n+2*r,i+2*r),o.drawImage(e,0,0,n,i),o.getImageData(-r,-r,n+2*r,i+2*r)},resolveURL:e=>(Ze||(Ze=t.document.createElement("a")),Ze.href=e,Ze.href),get devicePixelRatio(){return t.devicePixelRatio},get prefersReducedMotion(){return!!t.matchMedia&&(null==Fe&&(Fe=t.matchMedia("(prefers-reduced-motion: reduce)")),Fe.matches)}};function Ke(e,t,r){r[e]&&-1!==r[e].indexOf(t)||(r[e]=r[e]||[],r[e].push(t))}function Ge(e,t,r){if(r&&r[e]){const n=r[e].indexOf(t);-1!==n&&r[e].splice(n,1)}}class He{constructor(e,t={}){I(this,t),this.type=e}}class qe extends He{constructor(e,t={}){super("error",I({error:e},t))}}class Ye{on(e,t){return this._listeners=this._listeners||{},Ke(e,t,this._listeners),this}off(e,t){return Ge(e,t,this._listeners),Ge(e,t,this._oneTimeListeners),this}once(e,t){return t?(this._oneTimeListeners=this._oneTimeListeners||{},Ke(e,t,this._oneTimeListeners),this):new Promise((t=>this.once(e,t)))}fire(e,t){"string"==typeof e&&(e=new He(e,t||{}));const r=e.type;if(this.listens(r)){e.target=this;const t=this._listeners&&this._listeners[r]?this._listeners[r].slice():[];for(const r of t)r.call(this,e);const n=this._oneTimeListeners&&this._oneTimeListeners[r]?this._oneTimeListeners[r].slice():[];for(const o of n)Ge(r,o,this._oneTimeListeners),o.call(this,e);const i=this._eventedParent;i&&(I(e,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),i.fire(e))}else e instanceof qe&&console.error(e.error);return this}listens(e){return!!(this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e))}setEventedParent(e,t){return this._eventedParent=e,this._eventedParentData=t,this}}var Xe=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function Qe(e,...t){for(const r of t)for(const t in r)e[t]=r[t];return e}function $e(e){return e instanceof Number||e instanceof String||e instanceof Boolean?e.valueOf():e}function Je(e){if(Array.isArray(e))return e.map(Je);if(e instanceof Object&&!(e instanceof Number||e instanceof String||e instanceof Boolean)){const t={};for(const r in e)t[r]=Je(e[r]);return t}return $e(e)}class et extends Error{constructor(e,t){super(t),this.message=t,this.key=e}}var tt=et;class rt{constructor(e,t=[]){this.parent=e,this.bindings={};for(const[r,n]of t)this.bindings[r]=n}concat(e){return new rt(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}var nt=rt;const it={kind:"null"},ot={kind:"number"},at={kind:"string"},st={kind:"boolean"},ut={kind:"color"},ct={kind:"object"},lt={kind:"value"},ht={kind:"collator"},ft={kind:"formatted"},dt={kind:"resolvedImage"};function pt(e,t){return{kind:"array",itemType:e,N:t}}function mt(e){if("array"===e.kind){const t=mt(e.itemType);return"number"==typeof e.N?`array<${t}, ${e.N}>`:"value"===e.itemType.kind?"array":`array<${t}>`}return e.kind}const gt=[it,ot,at,st,ut,ft,ct,pt(lt),dt];function yt(e,t){if("error"===t.kind)return null;if("array"===e.kind){if("array"===t.kind&&(0===t.N&&"value"===t.itemType.kind||!yt(e.itemType,t.itemType))&&("number"!=typeof e.N||e.N===t.N))return null}else{if(e.kind===t.kind)return null;if("value"===e.kind)for(const e of gt)if(!yt(e,t))return null}return`Expected ${mt(e)} but found ${mt(t)} instead.`}function vt(e,t){return t.some((t=>t.kind===e.kind))}function _t(e,t){return t.some((t=>"null"===t?null===e:"array"===t?Array.isArray(e):"object"===t?e&&!Array.isArray(e)&&"object"==typeof e:t===typeof e))}var bt,xt={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function wt(e){return(e=Math.round(e))<0?0:e>255?255:e}function kt(e){return wt("%"===e[e.length-1]?parseFloat(e)/100*255:parseInt(e))}function At(e){return(t="%"===e[e.length-1]?parseFloat(e)/100:parseFloat(e))<0?0:t>1?1:t;var t}function Et(e,t,r){return r<0?r+=1:r>1&&(r-=1),6*r<1?e+(t-e)*r*6:2*r<1?t:3*r<2?e+(t-e)*(2/3-r)*6:e}try{bt={}.parseCSSColor=function(e){var t,r=e.replace(/ /g,"").toLowerCase();if(r in xt)return xt[r].slice();if("#"===r[0])return 4===r.length?(t=parseInt(r.substr(1),16))>=0&&t<=4095?[(3840&t)>>4|(3840&t)>>8,240&t|(240&t)>>4,15&t|(15&t)<<4,1]:null:7===r.length&&(t=parseInt(r.substr(1),16))>=0&&t<=16777215?[(16711680&t)>>16,(65280&t)>>8,255&t,1]:null;var n=r.indexOf("("),i=r.indexOf(")");if(-1!==n&&i+1===r.length){var o=r.substr(0,n),a=r.substr(n+1,i-(n+1)).split(","),s=1;switch(o){case"rgba":if(4!==a.length)return null;s=At(a.pop());case"rgb":return 3!==a.length?null:[kt(a[0]),kt(a[1]),kt(a[2]),s];case"hsla":if(4!==a.length)return null;s=At(a.pop());case"hsl":if(3!==a.length)return null;var u=(parseFloat(a[0])%360+360)%360/360,c=At(a[1]),l=At(a[2]),h=l<=.5?l*(c+1):l+c-l*c,f=2*l-h;return[wt(255*Et(f,h,u+1/3)),wt(255*Et(f,h,u)),wt(255*Et(f,h,u-1/3)),s];default:return null}}return null}}catch(e){}class St{constructor(e,t,r,n=1){this.r=e,this.g=t,this.b=r,this.a=n}static parse(e){if(!e)return;if(e instanceof St)return e;if("string"!=typeof e)return;const t=bt(e);return t?new St(t[0]/255*t[3],t[1]/255*t[3],t[2]/255*t[3],t[3]):void 0}toString(){const[e,t,r,n]=this.toArray();return`rgba(${Math.round(e)},${Math.round(t)},${Math.round(r)},${n})`}toArray(){const{r:e,g:t,b:r,a:n}=this;return 0===n?[0,0,0,0]:[255*e/n,255*t/n,255*r/n,n]}toArray01(){const{r:e,g:t,b:r,a:n}=this;return 0===n?[0,0,0,0]:[e/n,t/n,r/n,n]}toArray01PremultipliedAlpha(){const{r:e,g:t,b:r,a:n}=this;return[e,t,r,n]}}St.black=new St(0,0,0,1),St.white=new St(1,1,1,1),St.transparent=new St(0,0,0,0),St.red=new St(1,0,0,1),St.blue=new St(0,0,1,1);var Tt=St;class Mt{constructor(e,t,r){this.sensitivity=e?t?"variant":"case":t?"accent":"base",this.locale=r,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,t){return this.collator.compare(e,t)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class It{constructor(e,t,r,n,i){this.text=e.normalize?e.normalize():e,this.image=t,this.scale=r,this.fontStack=n,this.textColor=i}}class Pt{constructor(e){this.sections=e}static fromString(e){return new Pt([new It(e,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some((e=>0!==e.text.length||e.image&&0!==e.image.name.length))}static factory(e){return e instanceof Pt?e:Pt.fromString(e)}toString(){return 0===this.sections.length?"":this.sections.map((e=>e.text)).join("")}serialize(){const e=["format"];for(const t of this.sections){if(t.image){e.push(["image",t.image.name]);continue}e.push(t.text);const r={};t.fontStack&&(r["text-font"]=["literal",t.fontStack.split(",")]),t.scale&&(r["font-scale"]=t.scale),t.textColor&&(r["text-color"]=["rgba"].concat(t.textColor.toArray())),e.push(r)}return e}}class Ct{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new Ct({name:e,available:!1}):null}serialize(){return["image",this.name]}}function Bt(e,t,r,n){return"number"==typeof e&&e>=0&&e<=255&&"number"==typeof t&&t>=0&&t<=255&&"number"==typeof r&&r>=0&&r<=255?void 0===n||"number"==typeof n&&n>=0&&n<=1?null:`Invalid rgba value [${[e,t,r,n].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof n?[e,t,r,n]:[e,t,r]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Dt(e){if(null===e)return!0;if("string"==typeof e)return!0;if("boolean"==typeof e)return!0;if("number"==typeof e)return!0;if(e instanceof Tt)return!0;if(e instanceof Mt)return!0;if(e instanceof Pt)return!0;if(e instanceof Ct)return!0;if(Array.isArray(e)){for(const t of e)if(!Dt(t))return!1;return!0}if("object"==typeof e){for(const t in e)if(!Dt(e[t]))return!1;return!0}return!1}function Rt(e){if(null===e)return it;if("string"==typeof e)return at;if("boolean"==typeof e)return st;if("number"==typeof e)return ot;if(e instanceof Tt)return ut;if(e instanceof Mt)return ht;if(e instanceof Pt)return ft;if(e instanceof Ct)return dt;if(Array.isArray(e)){const t=e.length;let r;for(const n of e){const e=Rt(n);if(r){if(r===e)continue;r=lt;break}r=e}return pt(r||lt,t)}return ct}function Lt(e){const t=typeof e;return null===e?"":"string"===t||"number"===t||"boolean"===t?String(e):e instanceof Tt||e instanceof Pt||e instanceof Ct?e.toString():JSON.stringify(e)}class Ot{constructor(e,t){this.type=e,this.value=t}static parse(e,t){if(2!==e.length)return t.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!Dt(e[1]))return t.error("invalid value");const r=e[1];let n=Rt(r);const i=t.expectedType;return"array"!==n.kind||0!==n.N||!i||"array"!==i.kind||"number"==typeof i.N&&0!==i.N||(n=i),new Ot(n,r)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof Tt?["rgba"].concat(this.value.toArray()):this.value instanceof Pt?this.value.serialize():this.value}}var zt=Ot,Nt=class{constructor(e){this.name="ExpressionEvaluationError",this.message=e}toJSON(){return this.message}};const Ut={string:at,number:ot,boolean:st,object:ct};class Zt{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");let r,n=1;const i=e[0];if("array"===i){let i,o;if(e.length>2){const r=e[1];if("string"!=typeof r||!(r in Ut)||"object"===r)return t.error('The item type argument of "array" must be one of string, number, boolean',1);i=Ut[r],n++}else i=lt;if(e.length>3){if(null!==e[2]&&("number"!=typeof e[2]||e[2]<0||e[2]!==Math.floor(e[2])))return t.error('The length argument to "array" must be a positive integer literal',2);o=e[2],n++}r=pt(i,o)}else r=Ut[i];const o=[];for(;n<e.length;n++){const r=t.parse(e[n],n,lt);if(!r)return null;o.push(r)}return new Zt(r,o)}evaluate(e){for(let t=0;t<this.args.length;t++){const r=this.args[t].evaluate(e);if(!yt(this.type,Rt(r)))return r;if(t===this.args.length-1)throw new Nt(`Expected value to be of type ${mt(this.type)}, but found ${mt(Rt(r))} instead.`)}return null}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}serialize(){const e=this.type,t=[e.kind];if("array"===e.kind){const r=e.itemType;if("string"===r.kind||"number"===r.kind||"boolean"===r.kind){t.push(r.kind);const n=e.N;("number"==typeof n||this.args.length>1)&&t.push(n)}}return t.concat(this.args.map((e=>e.serialize())))}}var Ft=Zt;class jt{constructor(e){this.type=ft,this.sections=e}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");const r=e[1];if(!Array.isArray(r)&&"object"==typeof r)return t.error("First argument must be an image or text section.");const n=[];let i=!1;for(let o=1;o<=e.length-1;++o){const r=e[o];if(i&&"object"==typeof r&&!Array.isArray(r)){i=!1;let e=null;if(r["font-scale"]&&(e=t.parse(r["font-scale"],1,ot),!e))return null;let o=null;if(r["text-font"]&&(o=t.parse(r["text-font"],1,pt(at)),!o))return null;let a=null;if(r["text-color"]&&(a=t.parse(r["text-color"],1,ut),!a))return null;const s=n[n.length-1];s.scale=e,s.font=o,s.textColor=a}else{const r=t.parse(e[o],1,lt);if(!r)return null;const a=r.type.kind;if("string"!==a&&"value"!==a&&"null"!==a&&"resolvedImage"!==a)return t.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");i=!0,n.push({content:r,scale:null,font:null,textColor:null})}}return new jt(n)}evaluate(e){return new Pt(this.sections.map((t=>{const r=t.content.evaluate(e);return Rt(r)===dt?new It("",r,null,null,null):new It(Lt(r),null,t.scale?t.scale.evaluate(e):null,t.font?t.font.evaluate(e).join(","):null,t.textColor?t.textColor.evaluate(e):null)})))}eachChild(e){for(const t of this.sections)e(t.content),t.scale&&e(t.scale),t.font&&e(t.font),t.textColor&&e(t.textColor)}outputDefined(){return!1}serialize(){const e=["format"];for(const t of this.sections){e.push(t.content.serialize());const r={};t.scale&&(r["font-scale"]=t.scale.serialize()),t.font&&(r["text-font"]=t.font.serialize()),t.textColor&&(r["text-color"]=t.textColor.serialize()),e.push(r)}return e}}class Vt{constructor(e){this.type=dt,this.input=e}static parse(e,t){if(2!==e.length)return t.error("Expected two arguments.");const r=t.parse(e[1],1,at);return r?new Vt(r):t.error("No image name provided.")}evaluate(e){const t=this.input.evaluate(e),r=Ct.fromString(t);return r&&e.availableImages&&(r.available=e.availableImages.indexOf(t)>-1),r}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const Wt={"to-boolean":st,"to-color":ut,"to-number":ot,"to-string":at};class Kt{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expected at least one argument.");const r=e[0];if(("to-boolean"===r||"to-string"===r)&&2!==e.length)return t.error("Expected one argument.");const n=Wt[r],i=[];for(let o=1;o<e.length;o++){const r=t.parse(e[o],o,lt);if(!r)return null;i.push(r)}return new Kt(n,i)}evaluate(e){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(e));if("color"===this.type.kind){let t,r;for(const n of this.args){if(t=n.evaluate(e),r=null,t instanceof Tt)return t;if("string"==typeof t){const r=e.parseColor(t);if(r)return r}else if(Array.isArray(t)&&(r=t.length<3||t.length>4?`Invalid rbga value ${JSON.stringify(t)}: expected an array containing either three or four numeric values.`:Bt(t[0],t[1],t[2],t[3]),!r))return new Tt(t[0]/255,t[1]/255,t[2]/255,t[3])}throw new Nt(r||`Could not parse color from value '${"string"==typeof t?t:String(JSON.stringify(t))}'`)}if("number"===this.type.kind){let t=null;for(const r of this.args){if(t=r.evaluate(e),null===t)return 0;const n=Number(t);if(!isNaN(n))return n}throw new Nt(`Could not convert ${JSON.stringify(t)} to number.`)}return"formatted"===this.type.kind?Pt.fromString(Lt(this.args[0].evaluate(e))):"resolvedImage"===this.type.kind?Ct.fromString(Lt(this.args[0].evaluate(e))):Lt(this.args[0].evaluate(e))}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}serialize(){if("formatted"===this.type.kind)return new jt([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new Vt(this.args[0]).serialize();const e=[`to-${this.type.kind}`];return this.eachChild((t=>{e.push(t.serialize())})),e}}var Gt=Kt;const Ht=["Unknown","Point","LineString","Polygon"];var qt=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&void 0!==this.feature.id?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?Ht[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const e=this.featureDistanceData.center,t=this.featureDistanceData.scale,{x:r,y:n}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(r*t-e[0])+this.featureDistanceData.bearing[1]*(n*t-e[1])}return 0}parseColor(e){let t=this._parseColorCache[e];return t||(t=this._parseColorCache[e]=Tt.parse(e)),t}};class Yt{constructor(e,t,r,n){this.name=e,this.type=t,this._evaluate=r,this.args=n}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map((e=>e.serialize())))}static parse(e,t){const r=e[0],n=Yt.definitions[r];if(!n)return t.error(`Unknown expression "${r}". If you wanted a literal array, use ["literal", [...]].`,0);const i=Array.isArray(n)?n[0]:n.type,o=Array.isArray(n)?[[n[1],n[2]]]:n.overloads,a=o.filter((([t])=>!Array.isArray(t)||t.length===e.length-1));let s=null;for(const[u,c]of a){s=new wr(t.registry,t.path,null,t.scope);const n=[];let o=!1;for(let t=1;t<e.length;t++){const r=e[t],i=Array.isArray(u)?u[t-1]:u.type,a=s.parse(r,1+n.length,i);if(!a){o=!0;break}n.push(a)}if(!o)if(Array.isArray(u)&&u.length!==n.length)s.error(`Expected ${u.length} arguments, but found ${n.length} instead.`);else{for(let e=0;e<n.length;e++){const t=Array.isArray(u)?u[e]:u.type,r=n[e];s.concat(e+1).checkSubtype(t,r.type)}if(0===s.errors.length)return new Yt(r,i,c,n)}}if(1===a.length)t.errors.push(...s.errors);else{const r=(a.length?a:o).map((([e])=>{return t=e,Array.isArray(t)?`(${t.map(mt).join(", ")})`:`(${mt(t.type)}...)`;var t})).join(" | "),n=[];for(let i=1;i<e.length;i++){const r=t.parse(e[i],1+n.length);if(!r)return null;n.push(mt(r.type))}t.error(`Expected arguments of type ${r}, but found (${n.join(", ")}) instead.`)}return null}static register(e,t){Yt.definitions=t;for(const r in t)e[r]=Yt}}var Xt=Yt;class Qt{constructor(e,t,r){this.type=ht,this.locale=r,this.caseSensitive=e,this.diacriticSensitive=t}static parse(e,t){if(2!==e.length)return t.error("Expected one argument.");const r=e[1];if("object"!=typeof r||Array.isArray(r))return t.error("Collator options argument must be an object.");const n=t.parse(void 0!==r["case-sensitive"]&&r["case-sensitive"],1,st);if(!n)return null;const i=t.parse(void 0!==r["diacritic-sensitive"]&&r["diacritic-sensitive"],1,st);if(!i)return null;let o=null;return r.locale&&(o=t.parse(r.locale,1,at),!o)?null:new Qt(n,i,o)}evaluate(e){return new Mt(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}serialize(){const e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]}}const $t=8192;function Jt(e,t){e[0]=Math.min(e[0],t[0]),e[1]=Math.min(e[1],t[1]),e[2]=Math.max(e[2],t[0]),e[3]=Math.max(e[3],t[1])}function er(e,t){return!(e[0]<=t[0]||e[2]>=t[2]||e[1]<=t[1]||e[3]>=t[3])}function tr(e,t){const r=(180+e[0])/360,n=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e[1]*Math.PI/360)))/360,i=Math.pow(2,t.z);return[Math.round(r*i*$t),Math.round(n*i*$t)]}function rr(e,t,r){const n=e[0]-t[0],i=e[1]-t[1],o=e[0]-r[0],a=e[1]-r[1];return n*a-o*i==0&&n*o<=0&&i*a<=0}function nr(e,t){let r=!1;for(let a=0,s=t.length;a<s;a++){const s=t[a];for(let t=0,a=s.length;t<a-1;t++){if(rr(e,s[t],s[t+1]))return!1;(i=s[t])[1]>(n=e)[1]!=(o=s[t+1])[1]>n[1]&&n[0]<(o[0]-i[0])*(n[1]-i[1])/(o[1]-i[1])+i[0]&&(r=!r)}}var n,i,o;return r}function ir(e,t){for(let r=0;r<t.length;r++)if(nr(e,t[r]))return!0;return!1}function or(e,t,r,n){const i=n[0]-r[0],o=n[1]-r[1],a=(e[0]-r[0])*o-i*(e[1]-r[1]),s=(t[0]-r[0])*o-i*(t[1]-r[1]);return a>0&&s<0||a<0&&s>0}function ar(e,t,r){for(const c of r)for(let r=0;r<c.length-1;++r)if(0!=(s=[(a=c[r+1])[0]-(o=c[r])[0],a[1]-o[1]])[0]*(u=[(i=t)[0]-(n=e)[0],i[1]-n[1]])[1]-s[1]*u[0]&&or(n,i,o,a)&&or(o,a,n,i))return!0;var n,i,o,a,s,u;return!1}function sr(e,t){for(let r=0;r<e.length;++r)if(!nr(e[r],t))return!1;for(let r=0;r<e.length-1;++r)if(ar(e[r],e[r+1],t))return!1;return!0}function ur(e,t){for(let r=0;r<t.length;r++)if(sr(e,t[r]))return!0;return!1}function cr(e,t,r){const n=[];for(let i=0;i<e.length;i++){const o=[];for(let n=0;n<e[i].length;n++){const a=tr(e[i][n],r);Jt(t,a),o.push(a)}n.push(o)}return n}function lr(e,t,r){const n=[];for(let i=0;i<e.length;i++){const o=cr(e[i],t,r);n.push(o)}return n}function hr(e,t,r,n){if(e[0]<r[0]||e[0]>r[2]){const t=.5*n;let i=e[0]-r[0]>t?-n:r[0]-e[0]>t?n:0;0===i&&(i=e[0]-r[2]>t?-n:r[2]-e[0]>t?n:0),e[0]+=i}Jt(t,e)}function fr(e,t,r,n){const i=Math.pow(2,n.z)*$t,o=[n.x*$t,n.y*$t],a=[];if(!e)return a;for(const s of e)for(const e of s){const n=[e.x+o[0],e.y+o[1]];hr(n,t,r,i),a.push(n)}return a}function dr(e,t,r,n){const i=Math.pow(2,n.z)*$t,o=[n.x*$t,n.y*$t],a=[];if(!e)return a;for(const u of e){const e=[];for(const r of u){const n=[r.x+o[0],r.y+o[1]];Jt(t,n),e.push(n)}a.push(e)}if(t[2]-t[0]<=i/2){(s=t)[0]=s[1]=1/0,s[2]=s[3]=-1/0;for(const e of a)for(const n of e)hr(n,t,r,i)}var s;return a}class pr{constructor(e,t){this.type=st,this.geojson=e,this.geometries=t}static parse(e,t){if(2!==e.length)return t.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(Dt(e[1])){const t=e[1];if("FeatureCollection"===t.type)for(let e=0;e<t.features.length;++e){const r=t.features[e].geometry.type;if("Polygon"===r||"MultiPolygon"===r)return new pr(t,t.features[e].geometry)}else if("Feature"===t.type){const e=t.geometry.type;if("Polygon"===e||"MultiPolygon"===e)return new pr(t,t.geometry)}else if("Polygon"===t.type||"MultiPolygon"===t.type)return new pr(t,t)}return t.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(null!=e.geometry()&&null!=e.canonicalID()){if("Point"===e.geometryType())return function(e,t){const r=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],i=e.canonicalID();if(!i)return!1;if("Polygon"===t.type){const o=cr(t.coordinates,n,i),a=fr(e.geometry(),r,n,i);if(!er(r,n))return!1;for(const e of a)if(!nr(e,o))return!1}if("MultiPolygon"===t.type){const o=lr(t.coordinates,n,i),a=fr(e.geometry(),r,n,i);if(!er(r,n))return!1;for(const e of a)if(!ir(e,o))return!1}return!0}(e,this.geometries);if("LineString"===e.geometryType())return function(e,t){const r=[1/0,1/0,-1/0,-1/0],n=[1/0,1/0,-1/0,-1/0],i=e.canonicalID();if(!i)return!1;if("Polygon"===t.type){const o=cr(t.coordinates,n,i),a=dr(e.geometry(),r,n,i);if(!er(r,n))return!1;for(const e of a)if(!sr(e,o))return!1}if("MultiPolygon"===t.type){const o=lr(t.coordinates,n,i),a=dr(e.geometry(),r,n,i);if(!er(r,n))return!1;for(const e of a)if(!ur(e,o))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var mr=pr;function gr(e){if(e instanceof Xt){if("get"===e.name&&1===e.args.length)return!1;if("feature-state"===e.name)return!1;if("has"===e.name&&1===e.args.length)return!1;if("properties"===e.name||"geometry-type"===e.name||"id"===e.name)return!1;if(/^filter-/.test(e.name))return!1}if(e instanceof mr)return!1;let t=!0;return e.eachChild((e=>{t&&!gr(e)&&(t=!1)})),t}function yr(e){if(e instanceof Xt&&"feature-state"===e.name)return!1;let t=!0;return e.eachChild((e=>{t&&!yr(e)&&(t=!1)})),t}function vr(e,t){if(e instanceof Xt&&t.indexOf(e.name)>=0)return!1;let r=!0;return e.eachChild((e=>{r&&!vr(e,t)&&(r=!1)})),r}class _r{constructor(e,t){this.type=t.type,this.name=e,this.boundExpression=t}static parse(e,t){if(2!==e.length||"string"!=typeof e[1])return t.error("'var' expression requires exactly one string literal argument.");const r=e[1];return t.scope.has(r)?new _r(r,t.scope.get(r)):t.error(`Unknown variable "${r}". Make sure "${r}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var br=_r;class xr{constructor(e,t=[],r,n=new nt,i=[]){this.registry=e,this.path=t,this.key=t.map((e=>`[${e}]`)).join(""),this.scope=n,this.errors=i,this.expectedType=r}parse(e,t,r,n,i={}){return t?this.concat(t,r,n)._parse(e,i):this._parse(e,i)}_parse(e,t){function r(e,t,r){return"assert"===r?new Ft(t,[e]):"coerce"===r?new Gt(t,[e]):e}if(null!==e&&"string"!=typeof e&&"boolean"!=typeof e&&"number"!=typeof e||(e=["literal",e]),Array.isArray(e)){if(0===e.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const n=e[0];if("string"!=typeof n)return this.error(`Expression name must be a string, but found ${typeof n} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const i=this.registry[n];if(i){let n=i.parse(e,this);if(!n)return null;if(this.expectedType){const e=this.expectedType,i=n.type;if("string"!==e.kind&&"number"!==e.kind&&"boolean"!==e.kind&&"object"!==e.kind&&"array"!==e.kind||"value"!==i.kind)if("color"!==e.kind&&"formatted"!==e.kind&&"resolvedImage"!==e.kind||"value"!==i.kind&&"string"!==i.kind){if(this.checkSubtype(e,i))return null}else n=r(n,e,t.typeAnnotation||"coerce");else n=r(n,e,t.typeAnnotation||"assert")}if(!(n instanceof zt)&&"resolvedImage"!==n.type.kind&&kr(n)){const t=new qt;try{n=new zt(n.type,n.evaluate(t))}catch(e){return this.error(e.message),null}}return n}return this.error(`Unknown expression "${n}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===e?"'undefined' value invalid. Use null instead.":"object"==typeof e?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,t,r){const n="number"==typeof e?this.path.concat(e):this.path,i=r?this.scope.concat(r):this.scope;return new xr(this.registry,n,t||null,i,this.errors)}error(e,...t){const r=`${this.key}${t.map((e=>`[${e}]`)).join("")}`;this.errors.push(new tt(r,e))}checkSubtype(e,t){const r=yt(e,t);return r&&this.error(r),r}}var wr=xr;function kr(e){if(e instanceof br)return kr(e.boundExpression);if(e instanceof Xt&&"error"===e.name)return!1;if(e instanceof Qt)return!1;if(e instanceof mr)return!1;const t=e instanceof Gt||e instanceof Ft;let r=!0;return e.eachChild((e=>{r=t?r&&kr(e):r&&e instanceof zt})),!!r&&gr(e)&&vr(e,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function Ar(e,t){const r=e.length-1;let n,i,o=0,a=r,s=0;for(;o<=a;)if(s=Math.floor((o+a)/2),n=e[s],i=e[s+1],n<=t){if(s===r||t<i)return s;o=s+1}else{if(!(n>t))throw new Nt("Input is not a number.");a=s-1}return 0}class Er{constructor(e,t,r){this.type=e,this.input=t,this.labels=[],this.outputs=[];for(const[n,i]of r)this.labels.push(n),this.outputs.push(i)}static parse(e,t){if(e.length-1<4)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");const r=t.parse(e[1],1,ot);if(!r)return null;const n=[];let i=null;t.expectedType&&"value"!==t.expectedType.kind&&(i=t.expectedType);for(let o=1;o<e.length;o+=2){const r=1===o?-1/0:e[o],a=e[o+1],s=o,u=o+1;if("number"!=typeof r)return t.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',s);if(n.length&&n[n.length-1][0]>=r)return t.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',s);const c=t.parse(a,u,i);if(!c)return null;i=i||c.type,n.push([r,c])}return new Er(i,r,n)}evaluate(e){const t=this.labels,r=this.outputs;if(1===t.length)return r[0].evaluate(e);const n=this.input.evaluate(e);if(n<=t[0])return r[0].evaluate(e);const i=t.length;return n>=t[i-1]?r[i-1].evaluate(e):r[Ar(t,n)].evaluate(e)}eachChild(e){e(this.input);for(const t of this.outputs)e(t)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))}serialize(){const e=["step",this.input.serialize()];for(let t=0;t<this.labels.length;t++)t>0&&e.push(this.labels[t]),e.push(this.outputs[t].serialize());return e}}var Sr=Er;function Tr(e,t,r){return e*(1-r)+t*r}var Mr=Object.freeze({__proto__:null,number:Tr,color:function(e,t,r){return new Tt(Tr(e.r,t.r,r),Tr(e.g,t.g,r),Tr(e.b,t.b,r),Tr(e.a,t.a,r))},array:function(e,t,r){return e.map(((e,n)=>Tr(e,t[n],r)))}});const Ir=.95047,Pr=1.08883,Cr=4/29,Br=6/29,Dr=3*Br*Br,Rr=Math.PI/180,Lr=180/Math.PI;function Or(e){return e>.008856451679035631?Math.pow(e,1/3):e/Dr+Cr}function zr(e){return e>Br?e*e*e:Dr*(e-Cr)}function Nr(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Ur(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function Zr(e){const t=Ur(e.r),r=Ur(e.g),n=Ur(e.b),i=Or((.4124564*t+.3575761*r+.1804375*n)/Ir),o=Or((.2126729*t+.7151522*r+.072175*n)/1);return{l:116*o-16,a:500*(i-o),b:200*(o-Or((.0193339*t+.119192*r+.9503041*n)/Pr)),alpha:e.a}}function Fr(e){let t=(e.l+16)/116,r=isNaN(e.a)?t:t+e.a/500,n=isNaN(e.b)?t:t-e.b/200;return t=1*zr(t),r=Ir*zr(r),n=Pr*zr(n),new Tt(Nr(3.2404542*r-1.5371385*t-.4985314*n),Nr(-.969266*r+1.8760108*t+.041556*n),Nr(.0556434*r-.2040259*t+1.0572252*n),e.alpha)}function jr(e,t,r){const n=t-e;return e+r*(n>180||n<-180?n-360*Math.round(n/360):n)}const Vr={forward:Zr,reverse:Fr,interpolate:function(e,t,r){return{l:Tr(e.l,t.l,r),a:Tr(e.a,t.a,r),b:Tr(e.b,t.b,r),alpha:Tr(e.alpha,t.alpha,r)}}},Wr={forward:function(e){const{l:t,a:r,b:n}=Zr(e),i=Math.atan2(n,r)*Lr;return{h:i<0?i+360:i,c:Math.sqrt(r*r+n*n),l:t,alpha:e.a}},reverse:function(e){const t=e.h*Rr,r=e.c;return Fr({l:e.l,a:Math.cos(t)*r,b:Math.sin(t)*r,alpha:e.alpha})},interpolate:function(e,t,r){return{h:jr(e.h,t.h,r),c:Tr(e.c,t.c,r),l:Tr(e.l,t.l,r),alpha:Tr(e.alpha,t.alpha,r)}}};var Kr=Object.freeze({__proto__:null,lab:Vr,hcl:Wr});class Gr{constructor(e,t,r,n,i){this.type=e,this.operator=t,this.interpolation=r,this.input=n,this.labels=[],this.outputs=[];for(const[o,a]of i)this.labels.push(o),this.outputs.push(a)}static interpolationFactor(e,t,r,n){let i=0;if("exponential"===e.name)i=Hr(t,e.base,r,n);else if("linear"===e.name)i=Hr(t,1,r,n);else if("cubic-bezier"===e.name){const o=e.controlPoints;i=new f(o[0],o[1],o[2],o[3]).solve(Hr(t,1,r,n))}return i}static parse(e,t){let[r,n,i,...o]=e;if(!Array.isArray(n)||0===n.length)return t.error("Expected an interpolation type expression.",1);if("linear"===n[0])n={name:"linear"};else if("exponential"===n[0]){const e=n[1];if("number"!=typeof e)return t.error("Exponential interpolation requires a numeric base.",1,1);n={name:"exponential",base:e}}else{if("cubic-bezier"!==n[0])return t.error(`Unknown interpolation type ${String(n[0])}`,1,0);{const e=n.slice(1);if(4!==e.length||e.some((e=>"number"!=typeof e||e<0||e>1)))return t.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);n={name:"cubic-bezier",controlPoints:e}}}if(e.length-1<4)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return t.error("Expected an even number of arguments.");if(i=t.parse(i,2,ot),!i)return null;const a=[];let s=null;"interpolate-hcl"===r||"interpolate-lab"===r?s=ut:t.expectedType&&"value"!==t.expectedType.kind&&(s=t.expectedType);for(let u=0;u<o.length;u+=2){const e=o[u],r=o[u+1],n=u+3,i=u+4;if("number"!=typeof e)return t.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',n);if(a.length&&a[a.length-1][0]>=e)return t.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',n);const c=t.parse(r,i,s);if(!c)return null;s=s||c.type,a.push([e,c])}return"number"===s.kind||"color"===s.kind||"array"===s.kind&&"number"===s.itemType.kind&&"number"==typeof s.N?new Gr(s,r,n,i,a):t.error(`Type ${mt(s)} is not interpolatable.`)}evaluate(e){const t=this.labels,r=this.outputs;if(1===t.length)return r[0].evaluate(e);const n=this.input.evaluate(e);if(n<=t[0])return r[0].evaluate(e);const i=t.length;if(n>=t[i-1])return r[i-1].evaluate(e);const o=Ar(t,n),a=Gr.interpolationFactor(this.interpolation,n,t[o],t[o+1]),s=r[o].evaluate(e),u=r[o+1].evaluate(e);return"interpolate"===this.operator?Mr[this.type.kind.toLowerCase()](s,u,a):"interpolate-hcl"===this.operator?Wr.reverse(Wr.interpolate(Wr.forward(s),Wr.forward(u),a)):Vr.reverse(Vr.interpolate(Vr.forward(s),Vr.forward(u),a))}eachChild(e){e(this.input);for(const t of this.outputs)e(t)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))}serialize(){let e;e="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const t=[this.operator,e,this.input.serialize()];for(let r=0;r<this.labels.length;r++)t.push(this.labels[r],this.outputs[r].serialize());return t}}function Hr(e,t,r,n){const i=n-r,o=e-r;return 0===i?0:1===t?o/i:(Math.pow(t,o)-1)/(Math.pow(t,i)-1)}var qr=Gr;class Yr{constructor(e,t){this.type=e,this.args=t}static parse(e,t){if(e.length<2)return t.error("Expectected at least one argument.");let r=null;const n=t.expectedType;n&&"value"!==n.kind&&(r=n);const i=[];for(const a of e.slice(1)){const e=t.parse(a,1+i.length,r,void 0,{typeAnnotation:"omit"});if(!e)return null;r=r||e.type,i.push(e)}const o=n&&i.some((e=>yt(n,e.type)));return new Yr(o?lt:r,i)}evaluate(e){let t,r=null,n=0;for(const i of this.args){if(n++,r=i.evaluate(e),r&&r instanceof Ct&&!r.available&&(t||(t=r),r=null,n===this.args.length))return t;if(null!==r)break}return r}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every((e=>e.outputDefined()))}serialize(){const e=["coalesce"];return this.eachChild((t=>{e.push(t.serialize())})),e}}var Xr=Yr;class Qr{constructor(e,t){this.type=t.type,this.bindings=[].concat(e),this.result=t}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const t of this.bindings)e(t[1]);e(this.result)}static parse(e,t){if(e.length<4)return t.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const r=[];for(let i=1;i<e.length-1;i+=2){const n=e[i];if("string"!=typeof n)return t.error(`Expected string, but found ${typeof n} instead.`,i);if(/[^a-zA-Z0-9_]/.test(n))return t.error("Variable names must contain only alphanumeric characters or '_'.",i);const o=t.parse(e[i+1],i+1);if(!o)return null;r.push([n,o])}const n=t.parse(e[e.length-1],e.length-1,t.expectedType,r);return n?new Qr(r,n):null}outputDefined(){return this.result.outputDefined()}serialize(){const e=["let"];for(const[t,r]of this.bindings)e.push(t,r.serialize());return e.push(this.result.serialize()),e}}var $r=Qr;class Jr{constructor(e,t,r){this.type=e,this.index=t,this.input=r}static parse(e,t){if(3!==e.length)return t.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const r=t.parse(e[1],1,ot),n=t.parse(e[2],2,pt(t.expectedType||lt));return r&&n?new Jr(n.type.itemType,r,n):null}evaluate(e){const t=this.index.evaluate(e),r=this.input.evaluate(e);if(t<0)throw new Nt(`Array index out of bounds: ${t} < 0.`);if(t>=r.length)throw new Nt(`Array index out of bounds: ${t} > ${r.length-1}.`);if(t!==Math.floor(t))throw new Nt(`Array index must be an integer, but found ${t} instead.`);return r[t]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var en=Jr;class tn{constructor(e,t){this.type=st,this.needle=e,this.haystack=t}static parse(e,t){if(3!==e.length)return t.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const r=t.parse(e[1],1,lt),n=t.parse(e[2],2,lt);return r&&n?vt(r.type,[st,at,ot,it,lt])?new tn(r,n):t.error(`Expected first argument to be of type boolean, string, number or null, but found ${mt(r.type)} instead`):null}evaluate(e){const t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(null==r)return!1;if(!_t(t,["boolean","string","number","null"]))throw new Nt(`Expected first argument to be of type boolean, string, number or null, but found ${mt(Rt(t))} instead.`);if(!_t(r,["string","array"]))throw new Nt(`Expected second argument to be of type array or string, but found ${mt(Rt(r))} instead.`);return r.indexOf(t)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var rn=tn;class nn{constructor(e,t,r){this.type=ot,this.needle=e,this.haystack=t,this.fromIndex=r}static parse(e,t){if(e.length<=2||e.length>=5)return t.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const r=t.parse(e[1],1,lt),n=t.parse(e[2],2,lt);if(!r||!n)return null;if(!vt(r.type,[st,at,ot,it,lt]))return t.error(`Expected first argument to be of type boolean, string, number or null, but found ${mt(r.type)} instead`);if(4===e.length){const i=t.parse(e[3],3,ot);return i?new nn(r,n,i):null}return new nn(r,n)}evaluate(e){const t=this.needle.evaluate(e),r=this.haystack.evaluate(e);if(!_t(t,["boolean","string","number","null"]))throw new Nt(`Expected first argument to be of type boolean, string, number or null, but found ${mt(Rt(t))} instead.`);if(!_t(r,["string","array"]))throw new Nt(`Expected second argument to be of type array or string, but found ${mt(Rt(r))} instead.`);if(this.fromIndex){const n=this.fromIndex.evaluate(e);return r.indexOf(t,n)}return r.indexOf(t)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}serialize(){if(null!=this.fromIndex&&void 0!==this.fromIndex){const e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var on=nn;class an{constructor(e,t,r,n,i,o){this.inputType=e,this.type=t,this.input=r,this.cases=n,this.outputs=i,this.otherwise=o}static parse(e,t){if(e.length<5)return t.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return t.error("Expected an even number of arguments.");let r,n;t.expectedType&&"value"!==t.expectedType.kind&&(n=t.expectedType);const i={},o=[];for(let u=2;u<e.length-1;u+=2){let a=e[u];const s=e[u+1];Array.isArray(a)||(a=[a]);const c=t.concat(u);if(0===a.length)return c.error("Expected at least one branch label.");for(const e of a){if("number"!=typeof e&&"string"!=typeof e)return c.error("Branch labels must be numbers or strings.");if("number"==typeof e&&Math.abs(e)>Number.MAX_SAFE_INTEGER)return c.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof e&&Math.floor(e)!==e)return c.error("Numeric branch labels must be integer values.");if(r){if(c.checkSubtype(r,Rt(e)))return null}else r=Rt(e);if(void 0!==i[String(e)])return c.error("Branch labels must be unique.");i[String(e)]=o.length}const l=t.parse(s,u,n);if(!l)return null;n=n||l.type,o.push(l)}const a=t.parse(e[1],1,lt);if(!a)return null;const s=t.parse(e[e.length-1],e.length-1,n);return s?"value"!==a.type.kind&&t.concat(1).checkSubtype(r,a.type)?null:new an(r,n,a,i,o,s):null}evaluate(e){const t=this.input.evaluate(e);return(Rt(t)===this.inputType&&this.outputs[this.cases[t]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every((e=>e.outputDefined()))&&this.otherwise.outputDefined()}serialize(){const e=["match",this.input.serialize()],t=Object.keys(this.cases).sort(),r=[],n={};for(const o of t){const e=n[this.cases[o]];void 0===e?(n[this.cases[o]]=r.length,r.push([this.cases[o],[o]])):r[e][1].push(o)}const i=e=>"number"===this.inputType.kind?Number(e):e;for(const[o,a]of r)e.push(1===a.length?i(a[0]):a.map(i)),e.push(this.outputs[o].serialize());return e.push(this.otherwise.serialize()),e}}var sn=an;class un{constructor(e,t,r){this.type=e,this.branches=t,this.otherwise=r}static parse(e,t){if(e.length<4)return t.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return t.error("Expected an odd number of arguments.");let r;t.expectedType&&"value"!==t.expectedType.kind&&(r=t.expectedType);const n=[];for(let o=1;o<e.length-1;o+=2){const i=t.parse(e[o],o,st);if(!i)return null;const a=t.parse(e[o+1],o+1,r);if(!a)return null;n.push([i,a]),r=r||a.type}const i=t.parse(e[e.length-1],e.length-1,r);return i?new un(r,n,i):null}evaluate(e){for(const[t,r]of this.branches)if(t.evaluate(e))return r.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[t,r]of this.branches)e(t),e(r);e(this.otherwise)}outputDefined(){return this.branches.every((([e,t])=>t.outputDefined()))&&this.otherwise.outputDefined()}serialize(){const e=["case"];return this.eachChild((t=>{e.push(t.serialize())})),e}}var cn=un;class ln{constructor(e,t,r,n){this.type=e,this.input=t,this.beginIndex=r,this.endIndex=n}static parse(e,t){if(e.length<=2||e.length>=5)return t.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const r=t.parse(e[1],1,lt),n=t.parse(e[2],2,ot);if(!r||!n)return null;if(!vt(r.type,[pt(lt),at,lt]))return t.error(`Expected first argument to be of type array or string, but found ${mt(r.type)} instead`);if(4===e.length){const i=t.parse(e[3],3,ot);return i?new ln(r.type,r,n,i):null}return new ln(r.type,r,n)}evaluate(e){const t=this.input.evaluate(e),r=this.beginIndex.evaluate(e);if(!_t(t,["string","array"]))throw new Nt(`Expected first argument to be of type array or string, but found ${mt(Rt(t))} instead.`);if(this.endIndex){const n=this.endIndex.evaluate(e);return t.slice(r,n)}return t.slice(r)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}serialize(){if(null!=this.endIndex&&void 0!==this.endIndex){const e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var hn=ln;function fn(e,t){return"=="===e||"!="===e?"boolean"===t.kind||"string"===t.kind||"number"===t.kind||"null"===t.kind||"value"===t.kind:"string"===t.kind||"number"===t.kind||"value"===t.kind}function dn(e,t,r,n){return 0===n.compare(t,r)}function pn(e,t,r){const n="=="!==e&&"!="!==e;return class i{constructor(e,t,r){this.type=st,this.lhs=e,this.rhs=t,this.collator=r,this.hasUntypedArgument="value"===e.type.kind||"value"===t.type.kind}static parse(e,t){if(3!==e.length&&4!==e.length)return t.error("Expected two or three arguments.");const r=e[0];let o=t.parse(e[1],1,lt);if(!o)return null;if(!fn(r,o.type))return t.concat(1).error(`"${r}" comparisons are not supported for type '${mt(o.type)}'.`);let a=t.parse(e[2],2,lt);if(!a)return null;if(!fn(r,a.type))return t.concat(2).error(`"${r}" comparisons are not supported for type '${mt(a.type)}'.`);if(o.type.kind!==a.type.kind&&"value"!==o.type.kind&&"value"!==a.type.kind)return t.error(`Cannot compare types '${mt(o.type)}' and '${mt(a.type)}'.`);n&&("value"===o.type.kind&&"value"!==a.type.kind?o=new Ft(a.type,[o]):"value"!==o.type.kind&&"value"===a.type.kind&&(a=new Ft(o.type,[a])));let s=null;if(4===e.length){if("string"!==o.type.kind&&"string"!==a.type.kind&&"value"!==o.type.kind&&"value"!==a.type.kind)return t.error("Cannot use collator to compare non-string types.");if(s=t.parse(e[3],3,ht),!s)return null}return new i(o,a,s)}evaluate(i){const o=this.lhs.evaluate(i),a=this.rhs.evaluate(i);if(n&&this.hasUntypedArgument){const t=Rt(o),r=Rt(a);if(t.kind!==r.kind||"string"!==t.kind&&"number"!==t.kind)throw new Nt(`Expected arguments for "${e}" to be (string, string) or (number, number), but found (${t.kind}, ${r.kind}) instead.`)}if(this.collator&&!n&&this.hasUntypedArgument){const e=Rt(o),r=Rt(a);if("string"!==e.kind||"string"!==r.kind)return t(i,o,a)}return this.collator?r(i,o,a,this.collator.evaluate(i)):t(i,o,a)}eachChild(e){e(this.lhs),e(this.rhs),this.collator&&e(this.collator)}outputDefined(){return!0}serialize(){const t=[e];return this.eachChild((e=>{t.push(e.serialize())})),t}}}const mn=pn("==",(function(e,t,r){return t===r}),dn),gn=pn("!=",(function(e,t,r){return t!==r}),(function(e,t,r,n){return!dn(0,t,r,n)})),yn=pn("<",(function(e,t,r){return t<r}),(function(e,t,r,n){return n.compare(t,r)<0})),vn=pn(">",(function(e,t,r){return t>r}),(function(e,t,r,n){return n.compare(t,r)>0})),_n=pn("<=",(function(e,t,r){return t<=r}),(function(e,t,r,n){return n.compare(t,r)<=0})),bn=pn(">=",(function(e,t,r){return t>=r}),(function(e,t,r,n){return n.compare(t,r)>=0}));class xn{constructor(e,t,r,n,i,o){this.type=at,this.number=e,this.locale=t,this.currency=r,this.unit=n,this.minFractionDigits=i,this.maxFractionDigits=o}static parse(e,t){if(3!==e.length)return t.error("Expected two arguments.");const r=t.parse(e[1],1,ot);if(!r)return null;const n=e[2];if("object"!=typeof n||Array.isArray(n))return t.error("NumberFormat options argument must be an object.");let i=null;if(n.locale&&(i=t.parse(n.locale,1,at),!i))return null;let o=null;if(n.currency&&(o=t.parse(n.currency,1,at),!o))return null;let a=null;if(n.unit&&(a=t.parse(n.unit,1,at),!a))return null;let s=null;if(n["min-fraction-digits"]&&(s=t.parse(n["min-fraction-digits"],1,ot),!s))return null;let u=null;return n["max-fraction-digits"]&&(u=t.parse(n["max-fraction-digits"],1,ot),!u)?null:new xn(r,i,o,a,s,u)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(e):void 0,unit:this.unit?this.unit.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.unit&&e(this.unit),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.unit&&(e.unit=this.unit.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]}}class wn{constructor(e){this.type=ot,this.input=e}static parse(e,t){if(2!==e.length)return t.error(`Expected 1 argument, but found ${e.length-1} instead.`);const r=t.parse(e[1],1);return r?"array"!==r.type.kind&&"string"!==r.type.kind&&"value"!==r.type.kind?t.error(`Expected argument of type string or array, but found ${mt(r.type)} instead.`):new wn(r):null}evaluate(e){const t=this.input.evaluate(e);if("string"==typeof t)return t.length;if(Array.isArray(t))return t.length;throw new Nt(`Expected value to be of type string or array, but found ${mt(Rt(t))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){const e=["length"];return this.eachChild((t=>{e.push(t.serialize())})),e}}const kn={"==":mn,"!=":gn,">":vn,"<":yn,">=":bn,"<=":_n,array:Ft,at:en,boolean:Ft,case:cn,coalesce:Xr,collator:Qt,format:jt,image:Vt,in:rn,"index-of":on,interpolate:qr,"interpolate-hcl":qr,"interpolate-lab":qr,length:wn,let:$r,literal:zt,match:sn,number:Ft,"number-format":xn,object:Ft,slice:hn,step:Sr,string:Ft,"to-boolean":Gt,"to-color":Gt,"to-number":Gt,"to-string":Gt,var:br,within:mr};function An(e,[t,r,n,i]){t=t.evaluate(e),r=r.evaluate(e),n=n.evaluate(e);const o=i?i.evaluate(e):1,a=Bt(t,r,n,o);if(a)throw new Nt(a);return new Tt(t/255*o,r/255*o,n/255*o,o)}function En(e,t){return e in t}function Sn(e,t){const r=t[e];return void 0===r?null:r}function Tn(e){return{type:e}}Xt.register(kn,{error:[{kind:"error"},[at],(e,[t])=>{throw new Nt(t.evaluate(e))}],typeof:[at,[lt],(e,[t])=>mt(Rt(t.evaluate(e)))],"to-rgba":[pt(ot,4),[ut],(e,[t])=>t.evaluate(e).toArray()],rgb:[ut,[ot,ot,ot],An],rgba:[ut,[ot,ot,ot,ot],An],has:{type:st,overloads:[[[at],(e,[t])=>En(t.evaluate(e),e.properties())],[[at,ct],(e,[t,r])=>En(t.evaluate(e),r.evaluate(e))]]},get:{type:lt,overloads:[[[at],(e,[t])=>Sn(t.evaluate(e),e.properties())],[[at,ct],(e,[t,r])=>Sn(t.evaluate(e),r.evaluate(e))]]},"feature-state":[lt,[at],(e,[t])=>Sn(t.evaluate(e),e.featureState||{})],properties:[ct,[],e=>e.properties()],"geometry-type":[at,[],e=>e.geometryType()],id:[lt,[],e=>e.id()],zoom:[ot,[],e=>e.globals.zoom],pitch:[ot,[],e=>e.globals.pitch||0],"distance-from-center":[ot,[],e=>e.distanceFromCenter()],"heatmap-density":[ot,[],e=>e.globals.heatmapDensity||0],"line-progress":[ot,[],e=>e.globals.lineProgress||0],"sky-radial-progress":[ot,[],e=>e.globals.skyRadialProgress||0],accumulated:[lt,[],e=>void 0===e.globals.accumulated?null:e.globals.accumulated],"+":[ot,Tn(ot),(e,t)=>{let r=0;for(const n of t)r+=n.evaluate(e);return r}],"*":[ot,Tn(ot),(e,t)=>{let r=1;for(const n of t)r*=n.evaluate(e);return r}],"-":{type:ot,overloads:[[[ot,ot],(e,[t,r])=>t.evaluate(e)-r.evaluate(e)],[[ot],(e,[t])=>-t.evaluate(e)]]},"/":[ot,[ot,ot],(e,[t,r])=>t.evaluate(e)/r.evaluate(e)],"%":[ot,[ot,ot],(e,[t,r])=>t.evaluate(e)%r.evaluate(e)],ln2:[ot,[],()=>Math.LN2],pi:[ot,[],()=>Math.PI],e:[ot,[],()=>Math.E],"^":[ot,[ot,ot],(e,[t,r])=>Math.pow(t.evaluate(e),r.evaluate(e))],sqrt:[ot,[ot],(e,[t])=>Math.sqrt(t.evaluate(e))],log10:[ot,[ot],(e,[t])=>Math.log(t.evaluate(e))/Math.LN10],ln:[ot,[ot],(e,[t])=>Math.log(t.evaluate(e))],log2:[ot,[ot],(e,[t])=>Math.log(t.evaluate(e))/Math.LN2],sin:[ot,[ot],(e,[t])=>Math.sin(t.evaluate(e))],cos:[ot,[ot],(e,[t])=>Math.cos(t.evaluate(e))],tan:[ot,[ot],(e,[t])=>Math.tan(t.evaluate(e))],asin:[ot,[ot],(e,[t])=>Math.asin(t.evaluate(e))],acos:[ot,[ot],(e,[t])=>Math.acos(t.evaluate(e))],atan:[ot,[ot],(e,[t])=>Math.atan(t.evaluate(e))],min:[ot,Tn(ot),(e,t)=>Math.min(...t.map((t=>t.evaluate(e))))],max:[ot,Tn(ot),(e,t)=>Math.max(...t.map((t=>t.evaluate(e))))],abs:[ot,[ot],(e,[t])=>Math.abs(t.evaluate(e))],round:[ot,[ot],(e,[t])=>{const r=t.evaluate(e);return r<0?-Math.round(-r):Math.round(r)}],floor:[ot,[ot],(e,[t])=>Math.floor(t.evaluate(e))],ceil:[ot,[ot],(e,[t])=>Math.ceil(t.evaluate(e))],"filter-==":[st,[at,lt],(e,[t,r])=>e.properties()[t.value]===r.value],"filter-id-==":[st,[lt],(e,[t])=>e.id()===t.value],"filter-type-==":[st,[at],(e,[t])=>e.geometryType()===t.value],"filter-<":[st,[at,lt],(e,[t,r])=>{const n=e.properties()[t.value],i=r.value;return typeof n==typeof i&&n<i}],"filter-id-<":[st,[lt],(e,[t])=>{const r=e.id(),n=t.value;return typeof r==typeof n&&r<n}],"filter->":[st,[at,lt],(e,[t,r])=>{const n=e.properties()[t.value],i=r.value;return typeof n==typeof i&&n>i}],"filter-id->":[st,[lt],(e,[t])=>{const r=e.id(),n=t.value;return typeof r==typeof n&&r>n}],"filter-<=":[st,[at,lt],(e,[t,r])=>{const n=e.properties()[t.value],i=r.value;return typeof n==typeof i&&n<=i}],"filter-id-<=":[st,[lt],(e,[t])=>{const r=e.id(),n=t.value;return typeof r==typeof n&&r<=n}],"filter->=":[st,[at,lt],(e,[t,r])=>{const n=e.properties()[t.value],i=r.value;return typeof n==typeof i&&n>=i}],"filter-id->=":[st,[lt],(e,[t])=>{const r=e.id(),n=t.value;return typeof r==typeof n&&r>=n}],"filter-has":[st,[lt],(e,[t])=>t.value in e.properties()],"filter-has-id":[st,[],e=>null!==e.id()&&void 0!==e.id()],"filter-type-in":[st,[pt(at)],(e,[t])=>t.value.indexOf(e.geometryType())>=0],"filter-id-in":[st,[pt(lt)],(e,[t])=>t.value.indexOf(e.id())>=0],"filter-in-small":[st,[at,pt(lt)],(e,[t,r])=>r.value.indexOf(e.properties()[t.value])>=0],"filter-in-large":[st,[at,pt(lt)],(e,[t,r])=>function(e,t,r,n){for(;r<=n;){const i=r+n>>1;if(t[i]===e)return!0;t[i]>e?n=i-1:r=i+1}return!1}(e.properties()[t.value],r.value,0,r.value.length-1)],all:{type:st,overloads:[[[st,st],(e,[t,r])=>t.evaluate(e)&&r.evaluate(e)],[Tn(st),(e,t)=>{for(const r of t)if(!r.evaluate(e))return!1;return!0}]]},any:{type:st,overloads:[[[st,st],(e,[t,r])=>t.evaluate(e)||r.evaluate(e)],[Tn(st),(e,t)=>{for(const r of t)if(r.evaluate(e))return!0;return!1}]]},"!":[st,[st],(e,[t])=>!t.evaluate(e)],"is-supported-script":[st,[at],(e,[t])=>{const r=e.globals&&e.globals.isSupportedScript;return!r||r(t.evaluate(e))}],upcase:[at,[at],(e,[t])=>t.evaluate(e).toUpperCase()],downcase:[at,[at],(e,[t])=>t.evaluate(e).toLowerCase()],concat:[at,Tn(lt),(e,t)=>t.map((t=>Lt(t.evaluate(e)))).join("")],"resolved-locale":[at,[ht],(e,[t])=>t.evaluate(e).resolvedLocale()]});var Mn=kn;function In(e){return{result:"success",value:e}}function Pn(e){return{result:"error",value:e}}function Cn(e){return"data-driven"===e["property-type"]}function Bn(e){return!!e.expression&&e.expression.parameters.indexOf("zoom")>-1}function Dn(e){return!!e.expression&&e.expression.interpolated}function Rn(e){return e instanceof Number?"number":e instanceof String?"string":e instanceof Boolean?"boolean":Array.isArray(e)?"array":null===e?"null":typeof e}function Ln(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}function On(e){return e}function zn(e,t){const r="color"===t.type,n=e.stops&&"object"==typeof e.stops[0][0],i=n||!(n||void 0!==e.property),o=e.type||(Dn(t)?"exponential":"interval");if(r&&((e=Qe({},e)).stops&&(e.stops=e.stops.map((e=>[e[0],Tt.parse(e[1])]))),e.default=Tt.parse(e.default?e.default:t.default)),e.colorSpace&&"rgb"!==e.colorSpace&&!Kr[e.colorSpace])throw new Error(`Unknown color space: ${e.colorSpace}`);let a,s,u;if("exponential"===o)a=Fn;else if("interval"===o)a=Zn;else if("categorical"===o){a=Un,s=Object.create(null);for(const t of e.stops)s[t[0]]=t[1];u=typeof e.stops[0][0]}else{if("identity"!==o)throw new Error(`Unknown function type "${o}"`);a=jn}if(n){const r={},n=[];for(let t=0;t<e.stops.length;t++){const i=e.stops[t],o=i[0].zoom;void 0===r[o]&&(r[o]={zoom:o,type:e.type,property:e.property,default:e.default,stops:[]},n.push(o)),r[o].stops.push([i[0].value,i[1]])}const i=[];for(const e of n)i.push([r[e].zoom,zn(r[e],t)]);const o={name:"linear"};return{kind:"composite",interpolationType:o,interpolationFactor:qr.interpolationFactor.bind(void 0,o),zoomStops:i.map((e=>e[0])),evaluate:({zoom:r},n)=>Fn({stops:i,base:e.base},t,r).evaluate(r,n)}}if(i){const r="exponential"===o?{name:"exponential",base:void 0!==e.base?e.base:1}:null;return{kind:"camera",interpolationType:r,interpolationFactor:qr.interpolationFactor.bind(void 0,r),zoomStops:e.stops.map((e=>e[0])),evaluate:({zoom:r})=>a(e,t,r,s,u)}}return{kind:"source",evaluate(r,n){const i=n&&n.properties?n.properties[e.property]:void 0;return void 0===i?Nn(e.default,t.default):a(e,t,i,s,u)}}}function Nn(e,t,r){return void 0!==e?e:void 0!==t?t:void 0!==r?r:void 0}function Un(e,t,r,n,i){return Nn(typeof r===i?n[r]:void 0,e.default,t.default)}function Zn(e,t,r){if("number"!==Rn(r))return Nn(e.default,t.default);const n=e.stops.length;if(1===n)return e.stops[0][1];if(r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[n-1][0])return e.stops[n-1][1];const i=Ar(e.stops.map((e=>e[0])),r);return e.stops[i][1]}function Fn(e,t,r){const n=void 0!==e.base?e.base:1;if("number"!==Rn(r))return Nn(e.default,t.default);const i=e.stops.length;if(1===i)return e.stops[0][1];if(r<=e.stops[0][0])return e.stops[0][1];if(r>=e.stops[i-1][0])return e.stops[i-1][1];const o=Ar(e.stops.map((e=>e[0])),r),a=function(e,t,r,n){const i=n-r,o=e-r;return 0===i?0:1===t?o/i:(Math.pow(t,o)-1)/(Math.pow(t,i)-1)}(r,n,e.stops[o][0],e.stops[o+1][0]),s=e.stops[o][1],u=e.stops[o+1][1];let c=Mr[t.type]||On;if(e.colorSpace&&"rgb"!==e.colorSpace){const t=Kr[e.colorSpace];c=(e,r)=>t.reverse(t.interpolate(t.forward(e),t.forward(r),a))}return"function"==typeof s.evaluate?{evaluate(...e){const t=s.evaluate.apply(void 0,e),r=u.evaluate.apply(void 0,e);if(void 0!==t&&void 0!==r)return c(t,r,a)}}:c(s,u,a)}function jn(e,t,r){return"color"===t.type?r=Tt.parse(r):"formatted"===t.type?r=Pt.fromString(r.toString()):"resolvedImage"===t.type?r=Ct.fromString(r.toString()):Rn(r)===t.type||"enum"===t.type&&t.values[r]||(r=void 0),Nn(r,e.default,t.default)}class Vn{constructor(e,t){this.expression=e,this._warningHistory={},this._evaluator=new qt,this._defaultValue=t?function(e){return"color"===e.type&&(Ln(e.default)||Array.isArray(e.default))?new Tt(0,0,0,0):"color"===e.type?Tt.parse(e.default)||null:void 0===e.default?null:e.default}(t):null,this._enumValues=t&&"enum"===t.type?t.values:null}evaluateWithoutErrorHandling(e,t,r,n,i,o,a,s){return this._evaluator.globals=e,this._evaluator.feature=t,this._evaluator.featureState=r,this._evaluator.canonical=n||null,this._evaluator.availableImages=i||null,this._evaluator.formattedSection=o,this._evaluator.featureTileCoord=a||null,this._evaluator.featureDistanceData=s||null,this.expression.evaluate(this._evaluator)}evaluate(e,t,r,n,i,o,a,s){this._evaluator.globals=e,this._evaluator.feature=t||null,this._evaluator.featureState=r||null,this._evaluator.canonical=n||null,this._evaluator.availableImages=i||null,this._evaluator.formattedSection=o||null,this._evaluator.featureTileCoord=a||null,this._evaluator.featureDistanceData=s||null;try{const e=this.expression.evaluate(this._evaluator);if(null==e||"number"==typeof e&&e!=e)return this._defaultValue;if(this._enumValues&&!(e in this._enumValues))throw new Nt(`Expected value to be one of ${Object.keys(this._enumValues).map((e=>JSON.stringify(e))).join(", ")}, but found ${JSON.stringify(e)} instead.`);return e}catch(e){return this._warningHistory[e.message]||(this._warningHistory[e.message]=!0,"undefined"!=typeof console&&console.warn(e.message)),this._defaultValue}}}function Wn(e){return Array.isArray(e)&&e.length>0&&"string"==typeof e[0]&&e[0]in Mn}function Kn(e,t){const r=new wr(Mn,[],t?function(e){const t={color:ut,string:at,number:ot,enum:at,boolean:st,formatted:ft,resolvedImage:dt};return"array"===e.type?pt(t[e.value]||lt,e.length):t[e.type]}(t):void 0),n=r.parse(e,void 0,void 0,void 0,t&&"string"===t.type?{typeAnnotation:"coerce"}:void 0);return n?In(new Vn(n,t)):Pn(r.errors)}class Gn{constructor(e,t){this.kind=e,this._styleExpression=t,this.isStateDependent="constant"!==e&&!yr(t.expression)}evaluateWithoutErrorHandling(e,t,r,n,i,o){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,n,i,o)}evaluate(e,t,r,n,i,o){return this._styleExpression.evaluate(e,t,r,n,i,o)}}class Hn{constructor(e,t,r,n){this.kind=e,this.zoomStops=r,this._styleExpression=t,this.isStateDependent="camera"!==e&&!yr(t.expression),this.interpolationType=n}evaluateWithoutErrorHandling(e,t,r,n,i,o){return this._styleExpression.evaluateWithoutErrorHandling(e,t,r,n,i,o)}evaluate(e,t,r,n,i,o){return this._styleExpression.evaluate(e,t,r,n,i,o)}interpolationFactor(e,t,r){return this.interpolationType?qr.interpolationFactor(this.interpolationType,e,t,r):0}}function qn(e,t){if("error"===(e=Kn(e,t)).result)return e;const r=e.value.expression,n=gr(r);if(!n&&!Cn(t))return Pn([new tt("","data expressions not supported")]);const i=vr(r,["zoom","pitch","distance-from-center"]);if(!i&&!Bn(t))return Pn([new tt("","zoom expressions not supported")]);const o=Xn(r);return o||i?o instanceof tt?Pn([o]):o instanceof qr&&!Dn(t)?Pn([new tt("",'"interpolate" expressions cannot be used with this property')]):In(o?new Hn(n?"camera":"composite",e.value,o.labels,o instanceof qr?o.interpolation:void 0):new Gn(n?"constant":"source",e.value)):Pn([new tt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Yn{constructor(e,t){this._parameters=e,this._specification=t,Qe(this,zn(this._parameters,this._specification))}static deserialize(e){return new Yn(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function Xn(e){let t=null;if(e instanceof $r)t=Xn(e.result);else if(e instanceof Xr){for(const r of e.args)if(t=Xn(r),t)break}else(e instanceof Sr||e instanceof qr)&&e.input instanceof Xt&&"zoom"===e.input.name&&(t=e);return t instanceof tt||e.eachChild((e=>{const r=Xn(e);r instanceof tt?t=r:!t&&r?t=new tt("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):t&&r&&t!==r&&(t=new tt("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),t}class Qn{constructor(e,t,r,n){this.message=(e?`${e}: `:"")+r,n&&(this.identifier=n),null!=t&&t.__line__&&(this.line=t.__line__)}}function $n(e){const t=e.key,r=e.value,n=e.valueSpec||{},i=e.objectElementValidators||{},o=e.style,a=e.styleSpec;let s=[];const u=Rn(r);if("object"!==u)return[new Qn(t,r,`object expected, ${u} found`)];for(const c in r){const e=c.split(".")[0],u=n[e]||n["*"];let l;i[e]?l=i[e]:n[e]?l=Bi:i["*"]?l=i["*"]:n["*"]&&(l=Bi),l?s=s.concat(l({key:(t?`${t}.`:t)+c,value:r[c],valueSpec:u,style:o,styleSpec:a,object:r,objectKey:c},r)):s.push(new Qn(t,r[c],`unknown property "${c}"`))}for(const c in n)i[c]||n[c].required&&void 0===n[c].default&&void 0===r[c]&&s.push(new Qn(t,r,`missing required property "${c}"`));return s}function Jn(e){const t=e.value,r=e.valueSpec,n=e.style,i=e.styleSpec,o=e.key,a=e.arrayElementValidator||Bi;if("array"!==Rn(t))return[new Qn(o,t,`array expected, ${Rn(t)} found`)];if(r.length&&t.length!==r.length)return[new Qn(o,t,`array length ${r.length} expected, length ${t.length} found`)];if(r["min-length"]&&t.length<r["min-length"])return[new Qn(o,t,`array length at least ${r["min-length"]} expected, length ${t.length} found`)];let s={type:r.value,values:r.values,minimum:r.minimum,maximum:r.maximum,function:void 0};i.$version<7&&(s.function=r.function),"object"===Rn(r.value)&&(s=r.value);let u=[];for(let c=0;c<t.length;c++)u=u.concat(a({array:t,arrayIndex:c,value:t[c],valueSpec:s,style:n,styleSpec:i,key:`${o}[${c}]`}));return u}function ei(e){const t=e.key,r=e.value,n=e.valueSpec;let i=Rn(r);if("number"===i&&r!=r&&(i="NaN"),"number"!==i)return[new Qn(t,r,`number expected, ${i} found`)];if("minimum"in n){let i=n.minimum;if("array"===Rn(n.minimum)&&(i=n.minimum[e.arrayIndex]),r<i)return[new Qn(t,r,`${r} is less than the minimum value ${i}`)]}if("maximum"in n){let i=n.maximum;if("array"===Rn(n.maximum)&&(i=n.maximum[e.arrayIndex]),r>i)return[new Qn(t,r,`${r} is greater than the maximum value ${i}`)]}return[]}function ti(e){const t=e.valueSpec,r=$e(e.value.type);let n,i,o,a={};const s="categorical"!==r&&void 0===e.value.property,u=!s,c="array"===Rn(e.value.stops)&&"array"===Rn(e.value.stops[0])&&"object"===Rn(e.value.stops[0][0]),l=$n({key:e.key,value:e.value,valueSpec:e.styleSpec.function,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{stops:function(e){if("identity"===r)return[new Qn(e.key,e.value,'identity function may not have a "stops" property')];let t=[];const n=e.value;return t=t.concat(Jn({key:e.key,value:n,valueSpec:e.valueSpec,style:e.style,styleSpec:e.styleSpec,arrayElementValidator:h})),"array"===Rn(n)&&0===n.length&&t.push(new Qn(e.key,n,"array must have at least one stop")),t},default:function(e){return Bi({key:e.key,value:e.value,valueSpec:t,style:e.style,styleSpec:e.styleSpec})}}});return"identity"===r&&s&&l.push(new Qn(e.key,e.value,'missing required property "property"')),"identity"===r||e.value.stops||l.push(new Qn(e.key,e.value,'missing required property "stops"')),"exponential"===r&&e.valueSpec.expression&&!Dn(e.valueSpec)&&l.push(new Qn(e.key,e.value,"exponential functions not supported")),e.styleSpec.$version>=8&&(u&&!Cn(e.valueSpec)?l.push(new Qn(e.key,e.value,"property functions not supported")):s&&!Bn(e.valueSpec)&&l.push(new Qn(e.key,e.value,"zoom functions not supported"))),"categorical"!==r&&!c||void 0!==e.value.property||l.push(new Qn(e.key,e.value,'"property" property is required')),l;function h(e){let r=[];const n=e.value,s=e.key;if("array"!==Rn(n))return[new Qn(s,n,`array expected, ${Rn(n)} found`)];if(2!==n.length)return[new Qn(s,n,`array length 2 expected, length ${n.length} found`)];if(c){if("object"!==Rn(n[0]))return[new Qn(s,n,`object expected, ${Rn(n[0])} found`)];if(void 0===n[0].zoom)return[new Qn(s,n,"object stop key must have zoom")];if(void 0===n[0].value)return[new Qn(s,n,"object stop key must have value")];const t=$e(n[0].zoom);if("number"!=typeof t)return[new Qn(s,n[0].zoom,"stop zoom values must be numbers")];if(o&&o>t)return[new Qn(s,n[0].zoom,"stop zoom values must appear in ascending order")];t!==o&&(o=t,i=void 0,a={}),r=r.concat($n({key:`${s}[0]`,value:n[0],valueSpec:{zoom:{}},style:e.style,styleSpec:e.styleSpec,objectElementValidators:{zoom:ei,value:f}}))}else r=r.concat(f({key:`${s}[0]`,value:n[0],valueSpec:{},style:e.style,styleSpec:e.styleSpec},n));return Wn(Je(n[1]))?r.concat([new Qn(`${s}[1]`,n[1],"expressions are not allowed in function stops.")]):r.concat(Bi({key:`${s}[1]`,value:n[1],valueSpec:t,style:e.style,styleSpec:e.styleSpec}))}function f(e,o){const s=Rn(e.value),u=$e(e.value),c=null!==e.value?e.value:o;if(n){if(s!==n)return[new Qn(e.key,c,`${s} stop domain type must match previous stop domain type ${n}`)]}else n=s;if("number"!==s&&"string"!==s&&"boolean"!==s&&"number"!=typeof u&&"string"!=typeof u&&"boolean"!=typeof u)return[new Qn(e.key,c,"stop domain value must be a number, string, or boolean")];if("number"!==s&&"categorical"!==r){let n=`number expected, ${s} found`;return Cn(t)&&void 0===r&&(n+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Qn(e.key,c,n)]}return"categorical"!==r||"number"!==s||"number"==typeof u&&isFinite(u)&&Math.floor(u)===u?"categorical"!==r&&"number"===s&&"number"==typeof u&&"number"==typeof i&&void 0!==i&&u<i?[new Qn(e.key,c,"stop domain values must appear in ascending order")]:(i=u,"categorical"===r&&u in a?[new Qn(e.key,c,"stop domain values must be unique")]:(a[u]=!0,[])):[new Qn(e.key,c,`integer expected, found ${String(u)}`)]}}function ri(e){const t=("property"===e.expressionContext?qn:Kn)(Je(e.value),e.valueSpec);if("error"===t.result)return t.value.map((t=>new Qn(`${e.key}${t.key}`,e.value,t.message)));const r=t.value.expression||t.value._styleExpression.expression;if("property"===e.expressionContext&&"text-font"===e.propertyKey&&!r.outputDefined())return[new Qn(e.key,e.value,`Invalid data expression for "${e.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===e.expressionContext&&"layout"===e.propertyType&&!yr(r))return[new Qn(e.key,e.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===e.expressionContext)return ni(r,e);if(e.expressionContext&&0===e.expressionContext.indexOf("cluster")){if(!vr(r,["zoom","feature-state"]))return[new Qn(e.key,e.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===e.expressionContext&&!gr(r))return[new Qn(e.key,e.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function ni(e,t){const r=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(t.valueSpec&&t.valueSpec.expression)for(const i of t.valueSpec.expression.parameters)r.delete(i);if(0===r.size)return[];const n=[];return e instanceof Xt&&r.has(e.name)?[new Qn(t.key,t.value,`["${e.name}"] expression is not supported in a filter for a ${t.object.type} layer with id: ${t.object.id}`)]:(e.eachChild((e=>{n.push(...ni(e,t))})),n)}function ii(e){const t=e.key,r=e.value,n=e.valueSpec,i=[];return Array.isArray(n.values)?-1===n.values.indexOf($e(r))&&i.push(new Qn(t,r,`expected one of [${n.values.join(", ")}], ${JSON.stringify(r)} found`)):-1===Object.keys(n.values).indexOf($e(r))&&i.push(new Qn(t,r,`expected one of [${Object.keys(n.values).join(", ")}], ${JSON.stringify(r)} found`)),i}function oi(e){if(!0===e||!1===e)return!0;if(!Array.isArray(e)||0===e.length)return!1;switch(e[0]){case"has":return e.length>=2&&"$id"!==e[1]&&"$type"!==e[1];case"in":return e.length>=3&&("string"!=typeof e[1]||Array.isArray(e[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==e.length||Array.isArray(e[1])||Array.isArray(e[2]);case"any":case"all":for(const t of e.slice(1))if(!oi(t)&&"boolean"!=typeof t)return!1;return!0;default:return!0}}function ai(e,t="fill"){if(null==e)return{filter:()=>!0,needGeometry:!1,needFeature:!1};oi(e)||(e=di(e));const r=e;let n=!0;try{n=function(e){if(!ci(e))return e;let t=Je(e);return ui(t),t=si(t),t}(r)}catch(e){console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.\nThis is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md\nand paste the contents of this message in the report.\nThank you!\nFilter Expression:\n${JSON.stringify(r,null,2)}\n        `)}const i=Xe[`filter_${t}`],o=Kn(n,i);let a=null;if("error"===o.result)throw new Error(o.value.map((e=>`${e.key}: ${e.message}`)).join(", "));a=(e,t,r)=>o.value.evaluate(e,t,{},r);let s=null,u=null;if(n!==r){const e=Kn(r,i);if("error"===e.result)throw new Error(e.value.map((e=>`${e.key}: ${e.message}`)).join(", "));s=(t,r,n,i,o)=>e.value.evaluate(t,r,{},n,void 0,void 0,i,o),u=!gr(e.value.expression)}return{filter:a,dynamicFilter:s||void 0,needGeometry:fi(n),needFeature:!!u}}function si(e){if(!Array.isArray(e))return e;const t=function(e){if(li.has(e[0]))for(let t=1;t<e.length;t++)if(ci(e[t]))return!0;return e}(e);return!0===t?t:t.map((e=>si(e)))}function ui(e){let t=!1;const r=[];if("case"===e[0]){for(let n=1;n<e.length-1;n+=2)t=t||ci(e[n]),r.push(e[n+1]);r.push(e[e.length-1])}else if("match"===e[0]){t=t||ci(e[1]);for(let t=2;t<e.length-1;t+=2)r.push(e[t+1]);r.push(e[e.length-1])}else if("step"===e[0]){t=t||ci(e[1]);for(let t=1;t<e.length-1;t+=2)r.push(e[t+1])}t&&(e.length=0,e.push("any",...r));for(let n=1;n<e.length;n++)ui(e[n])}function ci(e){if(!Array.isArray(e))return!1;if("pitch"===(t=e[0])||"distance-from-center"===t)return!0;var t;for(let r=1;r<e.length;r++)if(ci(e[r]))return!0;return!1}const li=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function hi(e,t){return e<t?-1:e>t?1:0}function fi(e){if(!Array.isArray(e))return!1;if("within"===e[0])return!0;for(let t=1;t<e.length;t++)if(fi(e[t]))return!0;return!1}function di(e){if(!e)return!0;const t=e[0];return e.length<=1?"any"!==t:"=="===t?pi(e[1],e[2],"=="):"!="===t?yi(pi(e[1],e[2],"==")):"<"===t||">"===t||"<="===t||">="===t?pi(e[1],e[2],t):"any"===t?(r=e.slice(1),["any"].concat(r.map(di))):"all"===t?["all"].concat(e.slice(1).map(di)):"none"===t?["all"].concat(e.slice(1).map(di).map(yi)):"in"===t?mi(e[1],e.slice(2)):"!in"===t?yi(mi(e[1],e.slice(2))):"has"===t?gi(e[1]):"!has"===t?yi(gi(e[1])):"within"!==t||e;var r}function pi(e,t,r){switch(e){case"$type":return[`filter-type-${r}`,t];case"$id":return[`filter-id-${r}`,t];default:return[`filter-${r}`,e,t]}}function mi(e,t){if(0===t.length)return!1;switch(e){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some((e=>typeof e!=typeof t[0]))?["filter-in-large",e,["literal",t.sort(hi)]]:["filter-in-small",e,["literal",t]]}}function gi(e){switch(e){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",e]}}function yi(e){return["!",e]}function vi(e){return oi(Je(e.value))?ri(Qe({},e,{expressionContext:"filter",valueSpec:e.styleSpec[`filter_${e.layerType||"fill"}`]})):_i(e)}function _i(e){const t=e.value,r=e.key;if("array"!==Rn(t))return[new Qn(r,t,`array expected, ${Rn(t)} found`)];const n=e.styleSpec;let i,o=[];if(t.length<1)return[new Qn(r,t,"filter array must have at least 1 element")];switch(o=o.concat(ii({key:`${r}[0]`,value:t[0],valueSpec:n.filter_operator,style:e.style,styleSpec:e.styleSpec})),$e(t[0])){case"<":case"<=":case">":case">=":t.length>=2&&"$type"===$e(t[1])&&o.push(new Qn(r,t,`"$type" cannot be use with operator "${t[0]}"`));case"==":case"!=":3!==t.length&&o.push(new Qn(r,t,`filter array for operator "${t[0]}" must have 3 elements`));case"in":case"!in":t.length>=2&&(i=Rn(t[1]),"string"!==i&&o.push(new Qn(`${r}[1]`,t[1],`string expected, ${i} found`)));for(let a=2;a<t.length;a++)i=Rn(t[a]),"$type"===$e(t[1])?o=o.concat(ii({key:`${r}[${a}]`,value:t[a],valueSpec:n.geometry_type,style:e.style,styleSpec:e.styleSpec})):"string"!==i&&"number"!==i&&"boolean"!==i&&o.push(new Qn(`${r}[${a}]`,t[a],`string, number, or boolean expected, ${i} found`));break;case"any":case"all":case"none":for(let n=1;n<t.length;n++)o=o.concat(_i({key:`${r}[${n}]`,value:t[n],style:e.style,styleSpec:e.styleSpec}));break;case"has":case"!has":i=Rn(t[1]),2!==t.length?o.push(new Qn(r,t,`filter array for "${t[0]}" operator must have 2 elements`)):"string"!==i&&o.push(new Qn(`${r}[1]`,t[1],`string expected, ${i} found`));break;case"within":i=Rn(t[1]),2!==t.length?o.push(new Qn(r,t,`filter array for "${t[0]}" operator must have 2 elements`)):"object"!==i&&o.push(new Qn(`${r}[1]`,t[1],`object expected, ${i} found`))}return o}function bi(e,t){const r=e.key,n=e.style,i=e.styleSpec,o=e.value,a=e.objectKey,s=i[`${t}_${e.layerType}`];if(!s)return[];const u=a.match(/^(.*)-transition$/);if("paint"===t&&u&&s[u[1]]&&s[u[1]].transition)return Bi({key:r,value:o,valueSpec:i.transition,style:n,styleSpec:i});const c=e.valueSpec||s[a];if(!c)return[new Qn(r,o,`unknown property "${a}"`)];let l;if("string"===Rn(o)&&Cn(c)&&!c.tokens&&(l=/^{([^}]+)}$/.exec(o)))return[new Qn(r,o,`"${a}" does not support interpolation syntax\nUse an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(l[1])} }\`.`)];const h=[];return"symbol"===e.layerType&&("text-field"===a&&n&&!n.glyphs&&h.push(new Qn(r,o,'use of "text-field" requires a style "glyphs" property')),"text-font"===a&&Ln(Je(o))&&"identity"===$e(o.type)&&h.push(new Qn(r,o,'"text-font" does not support identity functions'))),h.concat(Bi({key:e.key,value:o,valueSpec:c,style:n,styleSpec:i,expressionContext:"property",propertyType:t,propertyKey:a}))}function xi(e){return bi(e,"paint")}function wi(e){return bi(e,"layout")}function ki(e){let t=[];const r=e.value,n=e.key,i=e.style,o=e.styleSpec;r.type||r.ref||t.push(new Qn(n,r,'either "type" or "ref" is required'));let a=$e(r.type);const s=$e(r.ref);if(r.id){const o=$e(r.id);for(let a=0;a<e.arrayIndex;a++){const e=i.layers[a];$e(e.id)===o&&t.push(new Qn(n,r.id,`duplicate layer id "${r.id}", previously used at line ${e.id.__line__}`))}}if("ref"in r){let e;["type","source","source-layer","filter","layout"].forEach((e=>{e in r&&t.push(new Qn(n,r[e],`"${e}" is prohibited for ref layers`))})),i.layers.forEach((t=>{$e(t.id)===s&&(e=t)})),e?e.ref?t.push(new Qn(n,r.ref,"ref cannot reference another ref layer")):a=$e(e.type):"string"==typeof s&&t.push(new Qn(n,r.ref,`ref layer "${s}" not found`))}else if("background"!==a&&"sky"!==a)if(r.source){const e=i.sources&&i.sources[r.source],o=e&&$e(e.type);e?"vector"===o&&"raster"===a?t.push(new Qn(n,r.source,`layer "${r.id}" requires a raster source`)):"raster"===o&&"raster"!==a?t.push(new Qn(n,r.source,`layer "${r.id}" requires a vector source`)):"vector"!==o||r["source-layer"]?"raster-dem"===o&&"hillshade"!==a?t.push(new Qn(n,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==a||!r.paint||!r.paint["line-gradient"]&&!r.paint["line-trim-offset"]||"geojson"===o&&e.lineMetrics||t.push(new Qn(n,r,`layer "${r.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):t.push(new Qn(n,r,`layer "${r.id}" must specify a "source-layer"`)):t.push(new Qn(n,r.source,`source "${r.source}" not found`))}else t.push(new Qn(n,r,'missing required property "source"'));return t=t.concat($n({key:n,value:r,valueSpec:o.layer,style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Bi({key:`${n}.type`,value:r.type,valueSpec:o.layer.type,style:e.style,styleSpec:e.styleSpec,object:r,objectKey:"type"}),filter:e=>vi(Qe({layerType:a},e)),layout:e=>$n({layer:r,key:e.key,value:e.value,valueSpec:{},style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":e=>wi(Qe({layerType:a},e))}}),paint:e=>$n({layer:r,key:e.key,value:e.value,valueSpec:{},style:e.style,styleSpec:e.styleSpec,objectElementValidators:{"*":e=>xi(Qe({layerType:a},e))}})}})),t}function Ai(e){const t=e.value,r=e.key,n=Rn(t);return"string"!==n?[new Qn(r,t,`string expected, ${n} found`)]:[]}const Ei={promoteId:function({key:e,value:t}){if("string"===Rn(t))return Ai({key:e,value:t});{const r=[];for(const n in t)r.push(...Ai({key:`${e}.${n}`,value:t[n]}));return r}}};function Si(e){const t=e.value,r=e.key,n=e.styleSpec,i=e.style;if(!t.type)return[new Qn(r,t,'"type" is required')];const o=$e(t.type);let a;switch(o){case"vector":case"raster":case"raster-dem":return a=$n({key:r,value:t,valueSpec:n[`source_${o.replace("-","_")}`],style:e.style,styleSpec:n,objectElementValidators:Ei}),a;case"geojson":if(a=$n({key:r,value:t,valueSpec:n.source_geojson,style:i,styleSpec:n,objectElementValidators:Ei}),t.cluster)for(const e in t.clusterProperties){const[n,i]=t.clusterProperties[e],o="string"==typeof n?[n,["accumulated"],["get",e]]:n;a.push(...ri({key:`${r}.${e}.map`,value:i,expressionContext:"cluster-map"})),a.push(...ri({key:`${r}.${e}.reduce`,value:o,expressionContext:"cluster-reduce"}))}return a;case"video":return $n({key:r,value:t,valueSpec:n.source_video,style:i,styleSpec:n});case"image":return $n({key:r,value:t,valueSpec:n.source_image,style:i,styleSpec:n});case"canvas":return[new Qn(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return ii({key:`${r}.type`,value:t.type,valueSpec:{values:Ti(n)},style:i,styleSpec:n})}}function Ti(e){return e.source.reduce(((t,r)=>{const n=e[r];return"enum"===n.type.type&&(t=t.concat(Object.keys(n.type.values))),t}),[])}function Mi(e){const t=e.value,r=e.styleSpec,n=r.light,i=e.style;let o=[];const a=Rn(t);if(void 0===t)return o;if("object"!==a)return o=o.concat([new Qn("light",t,`object expected, ${a} found`)]),o;for(const s in t){const e=s.match(/^(.*)-transition$/);o=o.concat(e&&n[e[1]]&&n[e[1]].transition?Bi({key:s,value:t[s],valueSpec:r.transition,style:i,styleSpec:r}):n[s]?Bi({key:s,value:t[s],valueSpec:n[s],style:i,styleSpec:r}):[new Qn(s,t[s],`unknown property "${s}"`)])}return o}function Ii(e){const t=e.value,r=e.key,n=e.style,i=e.styleSpec,o=i.terrain;let a=[];const s=Rn(t);if(void 0===t)return a;if("object"!==s)return a=a.concat([new Qn("terrain",t,`object expected, ${s} found`)]),a;for(const u in t){const e=u.match(/^(.*)-transition$/);a=a.concat(e&&o[e[1]]&&o[e[1]].transition?Bi({key:u,value:t[u],valueSpec:i.transition,style:n,styleSpec:i}):o[u]?Bi({key:u,value:t[u],valueSpec:o[u],style:n,styleSpec:i}):[new Qn(u,t[u],`unknown property "${u}"`)])}if(t.source){const e=n.sources&&n.sources[t.source],i=e&&$e(e.type);e?"raster-dem"!==i&&a.push(new Qn(r,t.source,`terrain cannot be used with a source of type ${String(i)}, it only be used with a "raster-dem" source type`)):a.push(new Qn(r,t.source,`source "${t.source}" not found`))}else a.push(new Qn(r,t,'terrain is missing required property "source"'));return a}function Pi(e){const t=e.value,r=e.style,n=e.styleSpec,i=n.fog;let o=[];const a=Rn(t);if(void 0===t)return o;if("object"!==a)return o=o.concat([new Qn("fog",t,`object expected, ${a} found`)]),o;for(const s in t){const e=s.match(/^(.*)-transition$/);o=o.concat(e&&i[e[1]]&&i[e[1]].transition?Bi({key:s,value:t[s],valueSpec:n.transition,style:r,styleSpec:n}):i[s]?Bi({key:s,value:t[s],valueSpec:i[s],style:r,styleSpec:n}):[new Qn(s,t[s],`unknown property "${s}"`)])}return o}const Ci={"*":()=>[],array:Jn,boolean:function(e){const t=e.value,r=e.key,n=Rn(t);return"boolean"!==n?[new Qn(r,t,`boolean expected, ${n} found`)]:[]},number:ei,color:function(e){const t=e.key,r=e.value,n=Rn(r);return"string"!==n?[new Qn(t,r,`color expected, ${n} found`)]:null===bt(r)?[new Qn(t,r,`color expected, "${r}" found`)]:[]},enum:ii,filter:vi,function:ti,layer:ki,object:$n,source:Si,light:Mi,terrain:Ii,fog:Pi,string:Ai,formatted:function(e){return 0===Ai(e).length?[]:ri(e)},resolvedImage:function(e){return 0===Ai(e).length?[]:ri(e)},projection:function(e){const t=e.value,r=e.styleSpec,n=r.projection,i=e.style;let o=[];const a=Rn(t);if("object"===a)for(const s in t)o=o.concat(Bi({key:s,value:t[s],valueSpec:n[s],style:i,styleSpec:r}));else"string"!==a&&(o=o.concat([new Qn("projection",t,`object or string expected, ${a} found`)]));return o}};function Bi(e){const t=e.value,r=e.valueSpec,n=e.styleSpec;return r.expression&&Ln($e(t))?ti(e):r.expression&&Wn(Je(t))?ri(e):r.type&&Ci[r.type]?Ci[r.type](e):$n(Qe({},e,{valueSpec:r.type?n[r.type]:r}))}function Di(e){const t=e.value,r=e.key,n=Ai(e);return n.length||(-1===t.indexOf("{fontstack}")&&n.push(new Qn(r,t,'"glyphs" url must include a "{fontstack}" token')),-1===t.indexOf("{range}")&&n.push(new Qn(r,t,'"glyphs" url must include a "{range}" token'))),n}function Ri(e,t=Xe){return zi(Bi({key:"",value:e,valueSpec:t.$root,styleSpec:t,style:e,objectElementValidators:{glyphs:Di,"*":()=>[]}}))}const Li=e=>zi(xi(e)),Oi=e=>zi(wi(e));function zi(e){return e.slice().sort(((e,t)=>e.line&&t.line?e.line-t.line:0))}function Ni(e,t){let r=!1;if(t&&t.length)for(const n of t)e.fire(new qe(new Error(n.message))),r=!0;return r}var Ui=Zi;function Zi(e,t,r){var n=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;var i=new Int32Array(this.arrayBuffer);e=i[0],this.d=(t=i[1])+2*(r=i[2]);for(var o=0;o<this.d*this.d;o++){var a=i[3+o],s=i[3+o+1];n.push(a===s?null:i.subarray(a,s))}var u=i[3+n.length+1];this.keys=i.subarray(i[3+n.length],u),this.bboxes=i.subarray(u),this.insert=this._insertReadonly}else{this.d=t+2*r;for(var c=0;c<this.d*this.d;c++)n.push([]);this.keys=[],this.bboxes=[]}this.n=t,this.extent=e,this.padding=r,this.scale=t/e,this.uid=0;var l=r/t*e;this.min=-l,this.max=e+l}Zi.prototype.insert=function(e,t,r,n,i){this._forEachCell(t,r,n,i,this._insertCell,this.uid++),this.keys.push(e),this.bboxes.push(t),this.bboxes.push(r),this.bboxes.push(n),this.bboxes.push(i)},Zi.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Zi.prototype._insertCell=function(e,t,r,n,i,o){this.cells[i].push(o)},Zi.prototype.query=function(e,t,r,n,i){var o=this.min,a=this.max;if(e<=o&&t<=o&&a<=r&&a<=n&&!i)return Array.prototype.slice.call(this.keys);var s=[];return this._forEachCell(e,t,r,n,this._queryCell,s,{},i),s},Zi.prototype._queryCell=function(e,t,r,n,i,o,a,s){var u=this.cells[i];if(null!==u)for(var c=this.keys,l=this.bboxes,h=0;h<u.length;h++){var f=u[h];if(void 0===a[f]){var d=4*f;(s?s(l[d+0],l[d+1],l[d+2],l[d+3]):e<=l[d+2]&&t<=l[d+3]&&r>=l[d+0]&&n>=l[d+1])?(a[f]=!0,o.push(c[f])):a[f]=!1}}},Zi.prototype._forEachCell=function(e,t,r,n,i,o,a,s){for(var u=this._convertToCellCoord(e),c=this._convertToCellCoord(t),l=this._convertToCellCoord(r),h=this._convertToCellCoord(n),f=u;f<=l;f++)for(var d=c;d<=h;d++){var p=this.d*d+f;if((!s||s(this._convertFromCellCoord(f),this._convertFromCellCoord(d),this._convertFromCellCoord(f+1),this._convertFromCellCoord(d+1)))&&i.call(this,e,t,r,n,p,o,a,s))return}},Zi.prototype._convertFromCellCoord=function(e){return(e-this.padding)/this.scale},Zi.prototype._convertToCellCoord=function(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))},Zi.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var e=this.cells,t=3+this.cells.length+1+1,r=0,n=0;n<this.cells.length;n++)r+=this.cells[n].length;var i=new Int32Array(t+r+this.keys.length+this.bboxes.length);i[0]=this.extent,i[1]=this.n,i[2]=this.padding;for(var o=t,a=0;a<e.length;a++){var s=e[a];i[3+a]=o,i.set(s,o),o+=s.length}return i[3+e.length]=o,i.set(this.keys,o),i[3+e.length+1]=o+=this.keys.length,i.set(this.bboxes,o),o+=this.bboxes.length,i.buffer};const Fi={};function ji(e,t,r={}){Object.defineProperty(e,"_classRegistryKey",{value:t,writeable:!1}),Fi[t]={klass:e,omit:r.omit||[]}}ji(Object,"Object"),Ui.serialize=function(e,t){const r=e.toArrayBuffer();return t&&t.push(r),{buffer:r}},Ui.deserialize=function(e){return new Ui(e.buffer)},Object.defineProperty(Ui,"name",{value:"Grid"}),ji(Ui,"Grid"),ji(Tt,"Color"),ji(Error,"Error"),ji(ae,"AJAXError"),ji(Ct,"ResolvedImage"),ji(Yn,"StylePropertyFunction"),ji(Vn,"StyleExpression",{omit:["_evaluator"]}),ji(Hn,"ZoomDependentExpression"),ji(Gn,"ZoomConstantExpression"),ji(Xt,"CompoundExpression",{omit:["_evaluate"]});for(const ym in Mn)Fi[Mn[ym]._classRegistryKey]||ji(Mn[ym],`Expression${ym}`);function Vi(e){return e&&"undefined"!=typeof ArrayBuffer&&(e instanceof ArrayBuffer||e.constructor&&"ArrayBuffer"===e.constructor.name)}function Wi(e){return t.ImageBitmap&&e instanceof t.ImageBitmap}function Ki(e,r){if(null==e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp)return e;if(Vi(e)||Wi(e))return r&&r.push(e),e;if(ArrayBuffer.isView(e)){const t=e;return r&&r.push(t.buffer),t}if(e instanceof t.ImageData)return r&&r.push(e.data.buffer),e;if(Array.isArray(e)){const t=[];for(const n of e)t.push(Ki(n,r));return t}if("object"==typeof e){const t=e.constructor,n=t._classRegistryKey;if(!n)throw new Error(`can't serialize object of unregistered class ${n}`);const i=t.serialize?t.serialize(e,r):{};if(!t.serialize){for(const t in e)e.hasOwnProperty(t)&&(Fi[n].omit.indexOf(t)>=0||(i[t]=Ki(e[t],r)));e instanceof Error&&(i.message=e.message)}if(i.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==n&&(i.$name=n),i}throw new Error("can't serialize object of type "+typeof e)}function Gi(e){if(null==e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||e instanceof Boolean||e instanceof Number||e instanceof String||e instanceof Date||e instanceof RegExp||Vi(e)||Wi(e)||ArrayBuffer.isView(e)||e instanceof t.ImageData)return e;if(Array.isArray(e))return e.map(Gi);if("object"==typeof e){const t=e.$name||"Object",{klass:r}=Fi[t];if(!r)throw new Error(`can't deserialize unregistered class ${t}`);if(r.deserialize)return r.deserialize(e);const n=Object.create(r.prototype);for(const i of Object.keys(e))"$name"!==i&&(n[i]=Gi(e[i]));return n}throw new Error("can't deserialize object of type "+typeof e)}const Hi=e=>e>=1536&&e<=1791,qi=e=>e>=1872&&e<=1919,Yi=e=>e>=2208&&e<=2303,Xi=e=>e>=11904&&e<=12031,Qi=e=>e>=12032&&e<=12255,$i=e=>e>=12272&&e<=12287,Ji=e=>e>=12288&&e<=12351,eo=e=>e>=12352&&e<=12447,to=e=>e>=12448&&e<=12543,ro=e=>e>=12544&&e<=12591,no=e=>e>=12704&&e<=12735,io=e=>e>=12736&&e<=12783,oo=e=>e>=12784&&e<=12799,ao=e=>e>=12800&&e<=13055,so=e=>e>=13056&&e<=13311,uo=e=>e>=13312&&e<=19903,co=e=>e>=19968&&e<=40959,lo=e=>e>=40960&&e<=42127,ho=e=>e>=42128&&e<=42191,fo=e=>e>=44032&&e<=55215,po=e=>e>=63744&&e<=64255,mo=e=>e>=64336&&e<=65023,go=e=>e>=65040&&e<=65055,yo=e=>e>=65072&&e<=65103,vo=e=>e>=65104&&e<=65135,_o=e=>e>=65136&&e<=65279,bo=e=>e>=65280&&e<=65519;function xo(e){for(const t of e)if(Ao(t.charCodeAt(0)))return!0;return!1}function wo(e){for(const t of e)if(!ko(t.charCodeAt(0)))return!1;return!0}function ko(e){return!(Hi(e)||qi(e)||Yi(e)||mo(e)||_o(e))}function Ao(e){return!(746!==e&&747!==e&&(e<4352||!(no(e)||ro(e)||yo(e)&&!(e>=65097&&e<=65103)||po(e)||so(e)||Xi(e)||io(e)||!(!Ji(e)||e>=12296&&e<=12305||e>=12308&&e<=12319||12336===e)||uo(e)||co(e)||ao(e)||(e=>e>=12592&&e<=12687)(e)||(e=>e>=43360&&e<=43391)(e)||(e=>e>=55216&&e<=55295)(e)||(e=>e>=4352&&e<=4607)(e)||fo(e)||eo(e)||$i(e)||(e=>e>=12688&&e<=12703)(e)||Qi(e)||oo(e)||to(e)&&12540!==e||!(!bo(e)||65288===e||65289===e||65293===e||e>=65306&&e<=65310||65339===e||65341===e||65343===e||e>=65371&&e<=65503||65507===e||e>=65512&&e<=65519)||!(!vo(e)||e>=65112&&e<=65118||e>=65123&&e<=65126)||(e=>e>=5120&&e<=5759)(e)||(e=>e>=6320&&e<=6399)(e)||go(e)||(e=>e>=19904&&e<=19967)(e)||lo(e)||ho(e))))}function Eo(e){return!(Ao(e)||function(e){return!!((e=>e>=128&&e<=255)(e)&&(167===e||169===e||174===e||177===e||188===e||189===e||190===e||215===e||247===e)||(e=>e>=8192&&e<=8303)(e)&&(8214===e||8224===e||8225===e||8240===e||8241===e||8251===e||8252===e||8258===e||8263===e||8264===e||8265===e||8273===e)||(e=>e>=8448&&e<=8527)(e)||(e=>e>=8528&&e<=8591)(e)||(e=>e>=8960&&e<=9215)(e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||9003===e||e>=9085&&e<=9114||e>=9150&&e<=9165||9167===e||e>=9169&&e<=9179||e>=9186&&e<=9215)||(e=>e>=9216&&e<=9279)(e)&&9251!==e||(e=>e>=9280&&e<=9311)(e)||(e=>e>=9312&&e<=9471)(e)||(e=>e>=9632&&e<=9727)(e)||(e=>e>=9728&&e<=9983)(e)&&!(e>=9754&&e<=9759)||(e=>e>=11008&&e<=11263)(e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||Ji(e)||to(e)||(e=>e>=57344&&e<=63743)(e)||yo(e)||vo(e)||bo(e)||8734===e||8756===e||8757===e||e>=9984&&e<=10087||e>=10102&&e<=10131||65532===e||65533===e)}(e))}function So(e){return e>=1424&&e<=2303||mo(e)||_o(e)}function To(e,t){return!(!t&&So(e)||e>=2304&&e<=3583||e>=3840&&e<=4255||(e=>e>=6016&&e<=6143)(e))}function Mo(e){for(const t of e)if(So(t.charCodeAt(0)))return!0;return!1}const Io="deferred",Po="loading",Co="loaded";let Bo=null,Do="unavailable",Ro=null;const Lo=function(e){e&&"string"==typeof e&&e.indexOf("NetworkError")>-1&&(Do="error"),Bo&&Bo(e)};function Oo(){zo.fire(new He("pluginStateChange",{pluginStatus:Do,pluginURL:Ro}))}const zo=new Ye,No=function(){return Do},Uo=function(){if(Do!==Io||!Ro)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Do=Po,Oo(),Ro&&ce({url:Ro},(e=>{e?Lo(e):(Do=Co,Oo())}))},Zo={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Do===Co||null!=Zo.applyArabicShaping,isLoading:()=>Do===Po,setState(e){Do=e.pluginStatus,Ro=e.pluginURL},isParsed:()=>null!=Zo.applyArabicShaping&&null!=Zo.processBidirectionalText&&null!=Zo.processStyledBidirectionalText,getPluginURL:()=>Ro};class Fo{constructor(e,t){this.zoom=e,t?(this.now=t.now,this.fadeDuration=t.fadeDuration,this.transition=t.transition,this.pitch=t.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(e){return function(e,t){for(const r of e)if(!To(r.charCodeAt(0),t))return!1;return!0}(e,Zo.isLoaded())}}class jo{constructor(e,t){this.property=e,this.value=t,this.expression=function(e,t){if(Ln(e))return new Yn(e,t);if(Wn(e)){const r=qn(e,t);if("error"===r.result)throw new Error(r.value.map((e=>`${e.key}: ${e.message}`)).join(", "));return r.value}{let r=e;return"string"==typeof e&&"color"===t.type&&(r=Tt.parse(e)),{kind:"constant",evaluate:()=>r}}}(void 0===t?e.specification.default:t,e.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(e,t,r){return this.property.possiblyEvaluate(this,e,t,r)}}class Vo{constructor(e){this.property=e,this.value=new jo(e,void 0)}transitioned(e,t){return new Ko(this.property,this.value,t,I({},e.transition,this.transition),e.now)}untransitioned(){return new Ko(this.property,this.value,null,{},0)}}class Wo{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return U(this._values[e].value.value)}setValue(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new Vo(this._values[e].property)),this._values[e].value=new jo(this._values[e].property,null===t?void 0:U(t))}getTransition(e){return U(this._values[e].transition)}setTransition(e,t){this._values.hasOwnProperty(e)||(this._values[e]=new Vo(this._values[e].property)),this._values[e].transition=U(t)||void 0}serialize(){const e={};for(const t of Object.keys(this._values)){const r=this.getValue(t);void 0!==r&&(e[t]=r);const n=this.getTransition(t);void 0!==n&&(e[`${t}-transition`]=n)}return e}transitioned(e,t){const r=new Go(this._properties);for(const n of Object.keys(this._values))r._values[n]=this._values[n].transitioned(e,t._values[n]);return r}untransitioned(){const e=new Go(this._properties);for(const t of Object.keys(this._values))e._values[t]=this._values[t].untransitioned();return e}}class Ko{constructor(e,t,r,n,i){const o=n.delay||0,a=n.duration||0;i=i||0,this.property=e,this.value=t,this.begin=i+o,this.end=this.begin+a,e.specification.transition&&(n.delay||n.duration)&&(this.prior=r)}possiblyEvaluate(e,t,r){const n=e.now||0,i=this.value.possiblyEvaluate(e,t,r),o=this.prior;if(o){if(n>this.end)return this.prior=null,i;if(this.value.isDataDriven())return this.prior=null,i;if(n<this.begin)return o.possiblyEvaluate(e,t,r);{const a=(n-this.begin)/(this.end-this.begin);return this.property.interpolate(o.possiblyEvaluate(e,t,r),i,x(a))}}return i}}class Go{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,t,r){const n=new Yo(this._properties);for(const i of Object.keys(this._values))n._values[i]=this._values[i].possiblyEvaluate(e,t,r);return n}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class Ho{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}getValue(e){return U(this._values[e].value)}setValue(e,t){this._values[e]=new jo(this._values[e].property,null===t?void 0:U(t))}serialize(){const e={};for(const t of Object.keys(this._values)){const r=this.getValue(t);void 0!==r&&(e[t]=r)}return e}possiblyEvaluate(e,t,r){const n=new Yo(this._properties);for(const i of Object.keys(this._values))n._values[i]=this._values[i].possiblyEvaluate(e,t,r);return n}}class qo{constructor(e,t,r){this.property=e,this.value=t,this.parameters=r}isConstant(){return"constant"===this.value.kind}constantOr(e){return"constant"===this.value.kind?this.value.value:e}evaluate(e,t,r,n){return this.property.evaluate(this.value,this.parameters,e,t,r,n)}}class Yo{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class Xo{constructor(e){this.specification=e}possiblyEvaluate(e,t){return e.expression.evaluate(t)}interpolate(e,t,r){const n=Mr[this.specification.type];return n?n(e,t,r):e}}class Qo{constructor(e,t){this.specification=e,this.overrides=t}possiblyEvaluate(e,t,r,n){return new qo(this,"constant"===e.expression.kind||"camera"===e.expression.kind?{kind:"constant",value:e.expression.evaluate(t,null,{},r,n)}:e.expression,t)}interpolate(e,t,r){if("constant"!==e.value.kind||"constant"!==t.value.kind)return e;if(void 0===e.value.value||void 0===t.value.value)return new qo(this,{kind:"constant",value:void 0},e.parameters);const n=Mr[this.specification.type];return n?new qo(this,{kind:"constant",value:n(e.value.value,t.value.value,r)},e.parameters):e}evaluate(e,t,r,n,i,o){return"constant"===e.kind?e.value:e.evaluate(t,r,n,i,o)}}class $o{constructor(e){this.specification=e}possiblyEvaluate(e,t,r,n){return!!e.expression.evaluate(t,null,{},r,n)}interpolate(){return!1}}class Jo{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const t=new Fo(0,{});for(const r in e){const n=e[r];n.specification.overridable&&this.overridableProperties.push(r);const i=this.defaultPropertyValues[r]=new jo(n,void 0),o=this.defaultTransitionablePropertyValues[r]=new Vo(n);this.defaultTransitioningPropertyValues[r]=o.untransitioned(),this.defaultPossiblyEvaluatedValues[r]=i.possiblyEvaluate(t)}}}function ea(e,t){return 256*(e=A(Math.floor(e),0,255))+A(Math.floor(t),0,255)}ji(Qo,"DataDrivenProperty"),ji(Xo,"DataConstantProperty"),ji($o,"ColorRampProperty");const ta={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class ra{constructor(e,t){this._structArray=e,this._pos1=t*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class na{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,t){return e._trim(),t&&(e.isTransferred=!0,t.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const t=Object.create(this.prototype);return t.arrayBuffer=e.arrayBuffer,t.length=e.length,t.capacity=e.arrayBuffer.byteLength/t.bytesPerElement,t._refreshViews(),t}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const t=this.uint8;this._refreshViews(),t&&this.uint8.set(t)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function ia(e,t=1){let r=0,n=0;return{members:e.map((e=>{const i=ta[e.type].BYTES_PER_ELEMENT,o=r=oa(r,Math.max(t,i)),a=e.components||1;return n=Math.max(n,i),r+=i*a,{name:e.name,type:e.type,components:a,offset:o}})),size:oa(r,Math.max(n,t)),alignment:t}}function oa(e,t){return Math.ceil(e/t)*t}class aa extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t){const r=this.length;return this.resize(r+1),this.emplace(r,e,t)}emplace(e,t,r){const n=2*e;return this.int16[n+0]=t,this.int16[n+1]=r,e}}aa.prototype.bytesPerElement=4,ji(aa,"StructArrayLayout2i4");class sa extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r){const n=this.length;return this.resize(n+1),this.emplace(n,e,t,r)}emplace(e,t,r,n){const i=3*e;return this.int16[i+0]=t,this.int16[i+1]=r,this.int16[i+2]=n,e}}sa.prototype.bytesPerElement=6,ji(sa,"StructArrayLayout3i6");class ua extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r,n){const i=this.length;return this.resize(i+1),this.emplace(i,e,t,r,n)}emplace(e,t,r,n,i){const o=4*e;return this.int16[o+0]=t,this.int16[o+1]=r,this.int16[o+2]=n,this.int16[o+3]=i,e}}ua.prototype.bytesPerElement=8,ji(ua,"StructArrayLayout4i8");class ca extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i,o,a){const s=this.length;return this.resize(s+1),this.emplace(s,e,t,r,n,i,o,a)}emplace(e,t,r,n,i,o,a,s){const u=6*e,c=12*e,l=3*e;return this.int16[u+0]=t,this.int16[u+1]=r,this.uint8[c+4]=n,this.uint8[c+5]=i,this.uint8[c+6]=o,this.uint8[c+7]=a,this.float32[l+2]=s,e}}ca.prototype.bytesPerElement=12,ji(ca,"StructArrayLayout2i4ub1f12");class la extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,r,n){const i=this.length;return this.resize(i+1),this.emplace(i,e,t,r,n)}emplace(e,t,r,n,i){const o=4*e;return this.float32[o+0]=t,this.float32[o+1]=r,this.float32[o+2]=n,this.float32[o+3]=i,e}}la.prototype.bytesPerElement=16,ji(la,"StructArrayLayout4f16");class ha extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i){const o=this.length;return this.resize(o+1),this.emplace(o,e,t,r,n,i)}emplace(e,t,r,n,i,o){const a=6*e,s=3*e;return this.uint16[a+0]=t,this.uint16[a+1]=r,this.uint16[a+2]=n,this.uint16[a+3]=i,this.float32[s+2]=o,e}}ha.prototype.bytesPerElement=12,ji(ha,"StructArrayLayout4ui1f12");class fa extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,r,n){const i=this.length;return this.resize(i+1),this.emplace(i,e,t,r,n)}emplace(e,t,r,n,i){const o=4*e;return this.uint16[o+0]=t,this.uint16[o+1]=r,this.uint16[o+2]=n,this.uint16[o+3]=i,e}}fa.prototype.bytesPerElement=8,ji(fa,"StructArrayLayout4ui8");class da extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i,o){const a=this.length;return this.resize(a+1),this.emplace(a,e,t,r,n,i,o)}emplace(e,t,r,n,i,o,a){const s=6*e;return this.int16[s+0]=t,this.int16[s+1]=r,this.int16[s+2]=n,this.int16[s+3]=i,this.int16[s+4]=o,this.int16[s+5]=a,e}}da.prototype.bytesPerElement=12,ji(da,"StructArrayLayout6i12");class pa extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i,o,a,s,u,c,l,h){const f=this.length;return this.resize(f+1),this.emplace(f,e,t,r,n,i,o,a,s,u,c,l,h)}emplace(e,t,r,n,i,o,a,s,u,c,l,h,f){const d=12*e;return this.int16[d+0]=t,this.int16[d+1]=r,this.int16[d+2]=n,this.int16[d+3]=i,this.uint16[d+4]=o,this.uint16[d+5]=a,this.uint16[d+6]=s,this.uint16[d+7]=u,this.int16[d+8]=c,this.int16[d+9]=l,this.int16[d+10]=h,this.int16[d+11]=f,e}}pa.prototype.bytesPerElement=24,ji(pa,"StructArrayLayout4i4ui4i24");class ma extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i,o){const a=this.length;return this.resize(a+1),this.emplace(a,e,t,r,n,i,o)}emplace(e,t,r,n,i,o,a){const s=10*e,u=5*e;return this.int16[s+0]=t,this.int16[s+1]=r,this.int16[s+2]=n,this.float32[u+2]=i,this.float32[u+3]=o,this.float32[u+4]=a,e}}ma.prototype.bytesPerElement=20,ji(ma,"StructArrayLayout3i3f20");class ga extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const t=this.length;return this.resize(t+1),this.emplace(t,e)}emplace(e,t){return this.uint32[1*e+0]=t,e}}ga.prototype.bytesPerElement=4,ji(ga,"StructArrayLayout1ul4");class ya extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i,o,a,s,u,c,l,h,f){const d=this.length;return this.resize(d+1),this.emplace(d,e,t,r,n,i,o,a,s,u,c,l,h,f)}emplace(e,t,r,n,i,o,a,s,u,c,l,h,f,d){const p=20*e,m=10*e;return this.int16[p+0]=t,this.int16[p+1]=r,this.int16[p+2]=n,this.int16[p+3]=i,this.int16[p+4]=o,this.float32[m+3]=a,this.float32[m+4]=s,this.float32[m+5]=u,this.float32[m+6]=c,this.int16[p+14]=l,this.uint32[m+8]=h,this.uint16[p+18]=f,this.uint16[p+19]=d,e}}ya.prototype.bytesPerElement=40,ji(ya,"StructArrayLayout5i4f1i1ul2ui40");class va extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i,o,a){const s=this.length;return this.resize(s+1),this.emplace(s,e,t,r,n,i,o,a)}emplace(e,t,r,n,i,o,a,s){const u=8*e;return this.int16[u+0]=t,this.int16[u+1]=r,this.int16[u+2]=n,this.int16[u+4]=i,this.int16[u+5]=o,this.int16[u+6]=a,this.int16[u+7]=s,e}}va.prototype.bytesPerElement=16,ji(va,"StructArrayLayout3i2i2i16");class _a extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i){const o=this.length;return this.resize(o+1),this.emplace(o,e,t,r,n,i)}emplace(e,t,r,n,i,o){const a=4*e,s=8*e;return this.float32[a+0]=t,this.float32[a+1]=r,this.float32[a+2]=n,this.int16[s+6]=i,this.int16[s+7]=o,e}}_a.prototype.bytesPerElement=16,ji(_a,"StructArrayLayout2f1f2i16");class ba extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,r,n){const i=this.length;return this.resize(i+1),this.emplace(i,e,t,r,n)}emplace(e,t,r,n,i){const o=12*e,a=3*e;return this.uint8[o+0]=t,this.uint8[o+1]=r,this.float32[a+1]=n,this.float32[a+2]=i,e}}ba.prototype.bytesPerElement=12,ji(ba,"StructArrayLayout2ub2f12");class xa extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,r){const n=this.length;return this.resize(n+1),this.emplace(n,e,t,r)}emplace(e,t,r,n){const i=3*e;return this.float32[i+0]=t,this.float32[i+1]=r,this.float32[i+2]=n,e}}xa.prototype.bytesPerElement=12,ji(xa,"StructArrayLayout3f12");class wa extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,r){const n=this.length;return this.resize(n+1),this.emplace(n,e,t,r)}emplace(e,t,r,n){const i=3*e;return this.uint16[i+0]=t,this.uint16[i+1]=r,this.uint16[i+2]=n,e}}wa.prototype.bytesPerElement=6,ji(wa,"StructArrayLayout3ui6");class ka extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i,o,a,s,u,c,l,h,f,d,p,m,g,y,v,_,b){const x=this.length;return this.resize(x+1),this.emplace(x,e,t,r,n,i,o,a,s,u,c,l,h,f,d,p,m,g,y,v,_,b)}emplace(e,t,r,n,i,o,a,s,u,c,l,h,f,d,p,m,g,y,v,_,b,x){const w=30*e,k=15*e,A=60*e;return this.int16[w+0]=t,this.int16[w+1]=r,this.int16[w+2]=n,this.float32[k+2]=i,this.float32[k+3]=o,this.uint16[w+8]=a,this.uint16[w+9]=s,this.uint32[k+5]=u,this.uint32[k+6]=c,this.uint32[k+7]=l,this.uint16[w+16]=h,this.uint16[w+17]=f,this.uint16[w+18]=d,this.float32[k+10]=p,this.float32[k+11]=m,this.uint8[A+48]=g,this.uint8[A+49]=y,this.uint8[A+50]=v,this.uint32[k+13]=_,this.int16[w+28]=b,this.uint8[A+58]=x,e}}ka.prototype.bytesPerElement=60,ji(ka,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Aa extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i,o,a,s,u,c,l,h,f,d,p,m,g,y,v,_,b,x,w,k,A,E,S,T,M,I){const P=this.length;return this.resize(P+1),this.emplace(P,e,t,r,n,i,o,a,s,u,c,l,h,f,d,p,m,g,y,v,_,b,x,w,k,A,E,S,T,M,I)}emplace(e,t,r,n,i,o,a,s,u,c,l,h,f,d,p,m,g,y,v,_,b,x,w,k,A,E,S,T,M,I,P){const C=38*e,B=19*e;return this.int16[C+0]=t,this.int16[C+1]=r,this.int16[C+2]=n,this.float32[B+2]=i,this.float32[B+3]=o,this.int16[C+8]=a,this.int16[C+9]=s,this.int16[C+10]=u,this.int16[C+11]=c,this.int16[C+12]=l,this.int16[C+13]=h,this.uint16[C+14]=f,this.uint16[C+15]=d,this.uint16[C+16]=p,this.uint16[C+17]=m,this.uint16[C+18]=g,this.uint16[C+19]=y,this.uint16[C+20]=v,this.uint16[C+21]=_,this.uint16[C+22]=b,this.uint16[C+23]=x,this.uint16[C+24]=w,this.uint16[C+25]=k,this.uint16[C+26]=A,this.uint16[C+27]=E,this.uint16[C+28]=S,this.uint32[B+15]=T,this.float32[B+16]=M,this.float32[B+17]=I,this.float32[B+18]=P,e}}Aa.prototype.bytesPerElement=76,ji(Aa,"StructArrayLayout3i2f6i15ui1ul3f76");class Ea extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const t=this.length;return this.resize(t+1),this.emplace(t,e)}emplace(e,t){return this.float32[1*e+0]=t,e}}Ea.prototype.bytesPerElement=4,ji(Ea,"StructArrayLayout1f4");class Sa extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t,r,n,i){const o=this.length;return this.resize(o+1),this.emplace(o,e,t,r,n,i)}emplace(e,t,r,n,i,o){const a=5*e;return this.float32[a+0]=t,this.float32[a+1]=r,this.float32[a+2]=n,this.float32[a+3]=i,this.float32[a+4]=o,e}}Sa.prototype.bytesPerElement=20,ji(Sa,"StructArrayLayout5f20");class Ta extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t,r,n){const i=this.length;return this.resize(i+1),this.emplace(i,e,t,r,n)}emplace(e,t,r,n,i){const o=6*e;return this.uint32[3*e+0]=t,this.uint16[o+2]=r,this.uint16[o+3]=n,this.uint16[o+4]=i,e}}Ta.prototype.bytesPerElement=12,ji(Ta,"StructArrayLayout1ul3ui12");class Ma extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,t){const r=this.length;return this.resize(r+1),this.emplace(r,e,t)}emplace(e,t,r){const n=2*e;return this.uint16[n+0]=t,this.uint16[n+1]=r,e}}Ma.prototype.bytesPerElement=4,ji(Ma,"StructArrayLayout2ui4");class Ia extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const t=this.length;return this.resize(t+1),this.emplace(t,e)}emplace(e,t){return this.uint16[1*e+0]=t,e}}Ia.prototype.bytesPerElement=2,ji(Ia,"StructArrayLayout1ui2");class Pa extends na{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,t){const r=this.length;return this.resize(r+1),this.emplace(r,e,t)}emplace(e,t,r){const n=2*e;return this.float32[n+0]=t,this.float32[n+1]=r,e}}Pa.prototype.bytesPerElement=8,ji(Pa,"StructArrayLayout2f8");class Ca extends ra{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Ca.prototype.size=40;class Ba extends ya{get(e){return new Ca(this,e)}}ji(Ba,"CollisionBoxArray");class Da extends ra{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(e){this._structArray.uint8[this._pos1+49]=e}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(e){this._structArray.uint8[this._pos1+50]=e}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(e){this._structArray.uint32[this._pos4+13]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(e){this._structArray.uint8[this._pos1+58]=e}}Da.prototype.size=60;class Ra extends ka{get(e){return new Da(this,e)}}ji(Ra,"PlacedSymbolArray");class La extends ra{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(e){this._structArray.uint32[this._pos4+15]=e}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}La.prototype.size=76;class Oa extends Aa{get(e){return new La(this,e)}}ji(Oa,"SymbolInstanceArray");class za extends Ea{getoffsetX(e){return this.float32[1*e+0]}}ji(za,"GlyphOffsetArray");class Na extends aa{getx(e){return this.int16[2*e+0]}gety(e){return this.int16[2*e+1]}}ji(Na,"SymbolLineVertexArray");class Ua extends ra{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Ua.prototype.size=12;class Za extends Ta{get(e){return new Ua(this,e)}}ji(Za,"FeatureIndexArray");class Fa extends Ma{geta_centroid_pos0(e){return this.uint16[2*e+0]}geta_centroid_pos1(e){return this.uint16[2*e+1]}}ji(Fa,"FillExtrusionCentroidArray");const ja=ia([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),Va=ia([{name:"a_dash",components:4,type:"Uint16"}]);var Wa={},Ka={get exports(){return Wa},set exports(e){Wa=e}},Ga={};({get exports(){return Ga},set exports(e){Ga=e}}).exports=function(e,t){var r,n,i,o,a,s,u,c;for(n=e.length-(r=3&e.length),i=t,a=3432918353,s=461845907,c=0;c<n;)u=255&e.charCodeAt(c)|(255&e.charCodeAt(++c))<<8|(255&e.charCodeAt(++c))<<16|(255&e.charCodeAt(++c))<<24,++c,i=27492+(65535&(o=5*(65535&(i=(i^=u=(65535&(u=(u=(65535&u)*a+(((u>>>16)*a&65535)<<16)&4294967295)<<15|u>>>17))*s+(((u>>>16)*s&65535)<<16)&4294967295)<<13|i>>>19))+((5*(i>>>16)&65535)<<16)&4294967295))+((58964+(o>>>16)&65535)<<16);switch(u=0,r){case 3:u^=(255&e.charCodeAt(c+2))<<16;case 2:u^=(255&e.charCodeAt(c+1))<<8;case 1:i^=u=(65535&(u=(u=(65535&(u^=255&e.charCodeAt(c)))*a+(((u>>>16)*a&65535)<<16)&4294967295)<<15|u>>>17))*s+(((u>>>16)*s&65535)<<16)&4294967295}return i^=e.length,i=2246822507*(65535&(i^=i>>>16))+((2246822507*(i>>>16)&65535)<<16)&4294967295,i=3266489909*(65535&(i^=i>>>13))+((3266489909*(i>>>16)&65535)<<16)&4294967295,(i^=i>>>16)>>>0};var Ha={};({get exports(){return Ha},set exports(e){Ha=e}}).exports=function(e,t){for(var r,n=e.length,i=t^n,o=0;n>=4;)r=1540483477*(65535&(r=255&e.charCodeAt(o)|(255&e.charCodeAt(++o))<<8|(255&e.charCodeAt(++o))<<16|(255&e.charCodeAt(++o))<<24))+((1540483477*(r>>>16)&65535)<<16),i=1540483477*(65535&i)+((1540483477*(i>>>16)&65535)<<16)^(r=1540483477*(65535&(r^=r>>>24))+((1540483477*(r>>>16)&65535)<<16)),n-=4,++o;switch(n){case 3:i^=(255&e.charCodeAt(o+2))<<16;case 2:i^=(255&e.charCodeAt(o+1))<<8;case 1:i=1540483477*(65535&(i^=255&e.charCodeAt(o)))+((1540483477*(i>>>16)&65535)<<16)}return i=1540483477*(65535&(i^=i>>>13))+((1540483477*(i>>>16)&65535)<<16),(i^=i>>>15)>>>0};var qa=Ga,Ya=Ha;Ka.exports=qa,Wa.murmur3=qa,Wa.murmur2=Ya;class Xa{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,t,r,n){this.ids.push(Qa(e)),this.positions.push(t,r,n)}getPositions(e){const t=Qa(e);let r=0,n=this.ids.length-1;for(;r<n;){const e=r+n>>1;this.ids[e]>=t?n=e:r=e+1}const i=[];for(;this.ids[r]===t;)i.push({index:this.positions[3*r],start:this.positions[3*r+1],end:this.positions[3*r+2]}),r++;return i}static serialize(e,t){const r=new Float64Array(e.ids),n=new Uint32Array(e.positions);return $a(r,n,0,r.length-1),t&&t.push(r.buffer,n.buffer),{ids:r,positions:n}}static deserialize(e){const t=new Xa;return t.ids=e.ids,t.positions=e.positions,t.indexed=!0,t}}function Qa(e){const t=+e;return!isNaN(t)&&Number.MIN_SAFE_INTEGER<=t&&t<=Number.MAX_SAFE_INTEGER?t:Wa(String(e))}function $a(e,t,r,n){for(;r<n;){const i=e[r+n>>1];let o=r-1,a=n+1;for(;;){do{o++}while(e[o]<i);do{a--}while(e[a]>i);if(o>=a)break;Ja(e,o,a),Ja(t,3*o,3*a),Ja(t,3*o+1,3*a+1),Ja(t,3*o+2,3*a+2)}a-r<n-a?($a(e,t,r,a),r=a+1):($a(e,t,a+1,n),n=a)}}function Ja(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}ji(Xa,"FeaturePositionMap");class es{constructor(e){this.gl=e.gl,this.initialized=!1}fetchUniformLocation(e,t){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(e,t),this.initialized=!0),!!this.location}}class ts extends es{constructor(e){super(e),this.current=0}set(e,t,r){this.fetchUniformLocation(e,t)&&this.current!==r&&(this.current=r,this.gl.uniform1f(this.location,r))}}class rs extends es{constructor(e){super(e),this.current=[0,0,0,0]}set(e,t,r){this.fetchUniformLocation(e,t)&&(r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]&&r[3]===this.current[3]||(this.current=r,this.gl.uniform4f(this.location,r[0],r[1],r[2],r[3])))}}class ns extends es{constructor(e){super(e),this.current=Tt.transparent}set(e,t,r){this.fetchUniformLocation(e,t)&&(r.r===this.current.r&&r.g===this.current.g&&r.b===this.current.b&&r.a===this.current.a||(this.current=r,this.gl.uniform4f(this.location,r.r,r.g,r.b,r.a)))}}const is=new Float32Array(16),os=new Float32Array(9),as=new Float32Array(4);function ss(e){return[ea(255*e.r,255*e.g),ea(255*e.b,255*e.a)]}class us{constructor(e,t,r){this.value=e,this.uniformNames=t.map((e=>`u_${e}`)),this.type=r}setUniform(e,t,r,n,i){t.set(e,i,n.constantOr(this.value))}getBinding(e,t){return"color"===this.type?new ns(e):new ts(e)}}class cs{constructor(e,t){this.uniformNames=t.map((e=>`u_${e}`)),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(e){this.pixelRatio=e.pixelRatio||1,this.pattern=e.tl.concat(e.br)}setUniform(e,t,r,n,i){const o="u_pattern"===i||"u_dash"===i?this.pattern:"u_pixel_ratio"===i?this.pixelRatio:null;o&&t.set(e,i,o)}getBinding(e,t){return"u_pattern"===t||"u_dash"===t?new rs(e):new ts(e)}}class ls{constructor(e,t,r,n){this.expression=e,this.type=r,this.maxValue=0,this.paintVertexAttributes=t.map((e=>({name:`a_${e}`,type:"Float32",components:"color"===r?2:1,offset:0}))),this.paintVertexArray=new n}populatePaintArray(e,t,r,n,i,o){const a=this.paintVertexArray.length,s=this.expression.evaluate(new Fo(0),t,{},i,n,o);this.paintVertexArray.resize(e),this._setPaintValue(a,e,s)}updatePaintArray(e,t,r,n,i){const o=this.expression.evaluate({zoom:0},r,n,void 0,i);this._setPaintValue(e,t,o)}_setPaintValue(e,t,r){if("color"===this.type){const n=ss(r);for(let r=e;r<t;r++)this.paintVertexArray.emplace(r,n[0],n[1])}else{for(let n=e;n<t;n++)this.paintVertexArray.emplace(n,r);this.maxValue=Math.max(this.maxValue,Math.abs(r))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class hs{constructor(e,t,r,n,i,o){this.expression=e,this.uniformNames=t.map((e=>`u_${e}_t`)),this.type=r,this.useIntegerZoom=n,this.zoom=i,this.maxValue=0,this.paintVertexAttributes=t.map((e=>({name:`a_${e}`,type:"Float32",components:"color"===r?4:2,offset:0}))),this.paintVertexArray=new o}populatePaintArray(e,t,r,n,i,o){const a=this.expression.evaluate(new Fo(this.zoom),t,{},i,n,o),s=this.expression.evaluate(new Fo(this.zoom+1),t,{},i,n,o),u=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(u,e,a,s)}updatePaintArray(e,t,r,n,i){const o=this.expression.evaluate({zoom:this.zoom},r,n,void 0,i),a=this.expression.evaluate({zoom:this.zoom+1},r,n,void 0,i);this._setPaintValue(e,t,o,a)}_setPaintValue(e,t,r,n){if("color"===this.type){const i=ss(r),o=ss(n);for(let r=e;r<t;r++)this.paintVertexArray.emplace(r,i[0],i[1],o[0],o[1])}else{for(let i=e;i<t;i++)this.paintVertexArray.emplace(i,r,n);this.maxValue=Math.max(this.maxValue,Math.abs(r),Math.abs(n))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,t,r,n,i){const o=this.useIntegerZoom?Math.floor(r.zoom):r.zoom,a=A(this.expression.interpolationFactor(o,this.zoom,this.zoom+1),0,1);t.set(e,i,a)}getBinding(e,t){return new ts(e)}}class fs{constructor(e,t,r,n,i){this.expression=e,this.layerId=i,this.paintVertexAttributes=("array"===r?Va:ja).members;for(let o=0;o<t.length;++o);this.paintVertexArray=new n}populatePaintArray(e,t,r){const n=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValues(n,e,t.patterns&&t.patterns[this.layerId],r)}updatePaintArray(e,t,r,n,i,o){this._setPaintValues(e,t,r.patterns&&r.patterns[this.layerId],o)}_setPaintValues(e,t,r,n){if(!n||!r)return;const i=n[r];if(!i)return;const{tl:o,br:a,pixelRatio:s}=i;for(let u=e;u<t;u++)this.paintVertexArray.emplace(u,o[0],o[1],a[0],a[1],s)}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class ds{constructor(e,t,r=(()=>!0)){this.binders={},this._buffers=[];const n=[];for(const i in e.paint._values){if(!r(i))continue;const o=e.paint.get(i);if(!(o instanceof qo&&Cn(o.property.specification)))continue;const a=gs(i,e.type),s=o.value,u=o.property.specification.type,c=o.property.useIntegerZoom,l="line-dasharray"===i||i.endsWith("pattern"),h="line-dasharray"===i&&"constant"!==e.layout.get("line-cap").value.kind;if("constant"!==s.kind||h)if("source"===s.kind||h||l){const t=_s(i,u,"source");this.binders[i]=l?new fs(s,a,u,t,e.id):new ls(s,a,u,t),n.push(`/a_${i}`)}else{const e=_s(i,u,"composite");this.binders[i]=new hs(s,a,u,c,t,e),n.push(`/z_${i}`)}else this.binders[i]=l?new cs(s.value,a):new us(s.value,a,u),n.push(`/u_${i}`)}this.cacheKey=n.sort().join("")}getMaxValue(e){const t=this.binders[e];return t instanceof ls||t instanceof hs?t.maxValue:0}populatePaintArrays(e,t,r,n,i,o){for(const a in this.binders){const s=this.binders[a];(s instanceof ls||s instanceof hs||s instanceof fs)&&s.populatePaintArray(e,t,r,n,i,o)}}setConstantPatternPositions(e){for(const t in this.binders){const r=this.binders[t];r instanceof cs&&r.setConstantPatternPositions(e)}}updatePaintArrays(e,t,r,n,i,o){let a=!1;for(const s in e){const u=t.getPositions(s);for(const t of u){const u=r.feature(t.index);for(const r in this.binders){const c=this.binders[r];if((c instanceof ls||c instanceof hs||c instanceof fs)&&!0===c.expression.isStateDependent){const l=n.paint.get(r);c.expression=l.value,c.updatePaintArray(t.start,t.end,u,e[s],i,o),a=!0}}}}return a}defines(){const e=[];for(const t in this.binders){const r=this.binders[t];(r instanceof us||r instanceof cs)&&e.push(...r.uniformNames.map((e=>`#define HAS_UNIFORM_${e}`)))}return e}getBinderAttributes(){const e=[];for(const t in this.binders){const r=this.binders[t];if(r instanceof ls||r instanceof hs||r instanceof fs)for(let t=0;t<r.paintVertexAttributes.length;t++)e.push(r.paintVertexAttributes[t].name)}return e}getBinderUniforms(){const e=[];for(const t in this.binders){const r=this.binders[t];if(r instanceof us||r instanceof cs||r instanceof hs)for(const t of r.uniformNames)e.push(t)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e){const t=[];for(const r in this.binders){const n=this.binders[r];if(n instanceof us||n instanceof cs||n instanceof hs)for(const i of n.uniformNames)t.push({name:i,property:r,binding:n.getBinding(e,i)})}return t}setUniforms(e,t,r,n,i){for(const{name:o,property:a,binding:s}of r)this.binders[a].setUniform(e,s,i,n.get(a),o)}updatePaintBuffers(){this._buffers=[];for(const e in this.binders){const t=this.binders[e];(t instanceof ls||t instanceof hs||t instanceof fs)&&t.paintVertexBuffer&&this._buffers.push(t.paintVertexBuffer)}}upload(e){for(const t in this.binders){const r=this.binders[t];(r instanceof ls||r instanceof hs||r instanceof fs)&&r.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const t=this.binders[e];(t instanceof ls||t instanceof hs||t instanceof fs)&&t.destroy()}}}class ps{constructor(e,t,r=(()=>!0)){this.programConfigurations={};for(const n of e)this.programConfigurations[n.id]=new ds(n,t,r);this.needsUpload=!1,this._featureMap=new Xa,this._bufferOffset=0}populatePaintArrays(e,t,r,n,i,o,a){for(const s in this.programConfigurations)this.programConfigurations[s].populatePaintArrays(e,t,n,i,o,a);void 0!==t.id&&this._featureMap.add(t.id,r,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,t,r,n,i){for(const o of r)this.needsUpload=this.programConfigurations[o.id].updatePaintArrays(e,this._featureMap,t,o,n,i)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const t in this.programConfigurations)this.programConfigurations[t].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}const ms={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function gs(e,t){return ms[e]||[e.replace(`${t}-`,"").replace(/-/g,"_")]}const ys={"line-pattern":{source:ha,composite:ha},"fill-pattern":{source:ha,composite:ha},"fill-extrusion-pattern":{source:ha,composite:ha},"line-dasharray":{source:fa,composite:fa}},vs={color:{source:Pa,composite:la},number:{source:Ea,composite:Pa}};function _s(e,t,r){const n=ys[e];return n&&n[r]||vs[t][r]}ji(us,"ConstantBinder"),ji(cs,"PatternConstantBinder"),ji(ls,"SourceExpressionBinder"),ji(fs,"PatternCompositeBinder"),ji(hs,"CompositeExpressionBinder"),ji(ds,"ProgramConfiguration",{omit:["_buffers"]}),ji(ps,"ProgramConfigurationSet");const bs="-transition";class xs extends Ye{constructor(e,t){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,"custom"!==e.type&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,"background"!==e.type&&"sky"!==e.type&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),t.layout&&(this._unevaluatedLayout=new Ho(t.layout)),t.paint)){this._transitionablePaint=new Wo(t.paint);for(const t in e.paint)this.setPaintProperty(t,e.paint[t],{validate:!1});for(const t in e.layout)this.setLayoutProperty(t,e.layout[t],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Yo(t.paint)}}getLayoutProperty(e){return"visibility"===e?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,t,r={}){null!=t&&this._validate(Oi,`layers.${this.id}.layout.${e}`,e,t,r)||("visibility"!==e?this._unevaluatedLayout.setValue(e,t):this.visibility=t)}getPaintProperty(e){return O(e,bs)?this._transitionablePaint.getTransition(e.slice(0,-bs.length)):this._transitionablePaint.getValue(e)}setPaintProperty(e,t,r={}){if(null!=t&&this._validate(Li,`layers.${this.id}.paint.${e}`,e,t,r))return!1;if(O(e,bs))return this._transitionablePaint.setTransition(e.slice(0,-bs.length),t||void 0),!1;{const r=this._transitionablePaint._values[e],n=r.value.isDataDriven(),i=r.value;this._transitionablePaint.setValue(e,t),this._handleSpecialPaintPropertyUpdate(e);const o=this._transitionablePaint._values[e].value,a=o.isDataDriven(),s=O(e,"pattern")||"line-dasharray"===e;return a||n||s||this._handleOverridablePaintPropertyUpdate(e,i,o)}}_handleSpecialPaintPropertyUpdate(e){}getProgramIds(){return null}getProgramConfiguration(e){return null}_handleOverridablePaintPropertyUpdate(e,t,r){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||"none"===this.visibility}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,t){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,t)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,t)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),N(e,((e,t)=>!(void 0===e||"layout"===t&&!Object.keys(e).length||"paint"===t&&!Object.keys(e).length)))}_validate(e,t,r,n,i={}){return(!i||!1!==i.validate)&&Ni(this,e.call(Ri,{key:t,layerType:this.type,objectKey:r,value:n,styleSpec:Xe,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const t=this.paint.get(e);if(t instanceof qo&&Cn(t.property.specification)&&("source"===t.value.kind||"composite"===t.value.kind)&&t.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=ai(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const ws=ia([{name:"a_pos",components:2,type:"Int16"}],4),ks=ia([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class As{constructor(e=[]){this.segments=e}prepareSegment(e,t,r,n){let i=this.segments[this.segments.length-1];return e>As.MAX_VERTEX_ARRAY_LENGTH&&F(`Max vertices per segment is ${As.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!i||i.vertexLength+e>As.MAX_VERTEX_ARRAY_LENGTH||i.sortKey!==n)&&(i={vertexOffset:t.length,primitiveOffset:r.length,vertexLength:0,primitiveLength:0},void 0!==n&&(i.sortKey=n),this.segments.push(i)),i}get(){return this.segments}destroy(){for(const e of this.segments)for(const t in e.vaos)e.vaos[t].destroy()}static simpleSegment(e,t,r,n){return new As([{vertexOffset:e,primitiveOffset:t,vertexLength:r,primitiveLength:n,vaos:{},sortKey:0}])}}As.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,ji(As,"SegmentVector");var Es=8192;class Ss{constructor(e,t){e&&(t?this.setSouthWest(e).setNorthEast(t):4===e.length?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))}setNorthEast(e){return this._ne=e instanceof rc?new rc(e.lng,e.lat):rc.convert(e),this}setSouthWest(e){return this._sw=e instanceof rc?new rc(e.lng,e.lat):rc.convert(e),this}extend(e){const t=this._sw,r=this._ne;let n,i;if(e instanceof rc)n=e,i=e;else{if(!(e instanceof Ss))return Array.isArray(e)?4===e.length||e.every(Array.isArray)?this.extend(Ss.convert(e)):this.extend(rc.convert(e)):"object"==typeof e&&null!==e&&e.hasOwnProperty("lat")&&e.hasOwnProperty("lon")?this.extend(rc.convert(e)):this;if(n=e._sw,i=e._ne,!n||!i)return this}return t||r?(t.lng=Math.min(n.lng,t.lng),t.lat=Math.min(n.lat,t.lat),r.lng=Math.max(i.lng,r.lng),r.lat=Math.max(i.lat,r.lat)):(this._sw=new rc(n.lng,n.lat),this._ne=new rc(i.lng,i.lat)),this}getCenter(){return new rc((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new rc(this.getWest(),this.getNorth())}getSouthEast(){return new rc(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:t,lat:r}=rc.convert(e);let n=this._sw.lng<=t&&t<=this._ne.lng;return this._sw.lng>this._ne.lng&&(n=this._sw.lng>=t&&t>=this._ne.lng),this._sw.lat<=r&&r<=this._ne.lat&&n}static convert(e){return!e||e instanceof Ss?e:new Ss(e)}}var Ts=1e-6,Ms="undefined"!=typeof Float32Array?Float32Array:Array;function Is(){var e=new Ms(9);return Ms!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function Ps(e,t,r){var n=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=t[6],l=t[7],h=t[8],f=r[0],d=r[1],p=r[2],m=r[3],g=r[4],y=r[5],v=r[6],_=r[7],b=r[8];return e[0]=f*n+d*a+p*c,e[1]=f*i+d*s+p*l,e[2]=f*o+d*u+p*h,e[3]=m*n+g*a+y*c,e[4]=m*i+g*s+y*l,e[5]=m*o+g*u+y*h,e[6]=v*n+_*a+b*c,e[7]=v*i+_*s+b*l,e[8]=v*o+_*u+b*h,e}function Cs(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Bs(e,t){var r=t[0],n=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],l=t[8],h=t[9],f=t[10],d=t[11],p=t[12],m=t[13],g=t[14],y=t[15],v=r*s-n*a,_=r*u-i*a,b=r*c-o*a,x=n*u-i*s,w=n*c-o*s,k=i*c-o*u,A=l*m-h*p,E=l*g-f*p,S=l*y-d*p,T=h*g-f*m,M=h*y-d*m,I=f*y-d*g,P=v*I-_*M+b*T+x*S-w*E+k*A;return P?(e[0]=(s*I-u*M+c*T)*(P=1/P),e[1]=(i*M-n*I-o*T)*P,e[2]=(m*k-g*w+y*x)*P,e[3]=(f*w-h*k-d*x)*P,e[4]=(u*S-a*I-c*E)*P,e[5]=(r*I-i*S+o*E)*P,e[6]=(g*b-p*k-y*_)*P,e[7]=(l*k-f*b+d*_)*P,e[8]=(a*M-s*S+c*A)*P,e[9]=(n*S-r*M-o*A)*P,e[10]=(p*w-m*b+y*v)*P,e[11]=(h*b-l*w-d*v)*P,e[12]=(s*E-a*T-u*A)*P,e[13]=(r*T-n*E+i*A)*P,e[14]=(m*_-p*x-g*v)*P,e[15]=(l*x-h*_+f*v)*P,e):null}function Ds(e,t,r){var n=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=t[6],l=t[7],h=t[8],f=t[9],d=t[10],p=t[11],m=t[12],g=t[13],y=t[14],v=t[15],_=r[0],b=r[1],x=r[2],w=r[3];return e[0]=_*n+b*s+x*h+w*m,e[1]=_*i+b*u+x*f+w*g,e[2]=_*o+b*c+x*d+w*y,e[3]=_*a+b*l+x*p+w*v,e[4]=(_=r[4])*n+(b=r[5])*s+(x=r[6])*h+(w=r[7])*m,e[5]=_*i+b*u+x*f+w*g,e[6]=_*o+b*c+x*d+w*y,e[7]=_*a+b*l+x*p+w*v,e[8]=(_=r[8])*n+(b=r[9])*s+(x=r[10])*h+(w=r[11])*m,e[9]=_*i+b*u+x*f+w*g,e[10]=_*o+b*c+x*d+w*y,e[11]=_*a+b*l+x*p+w*v,e[12]=(_=r[12])*n+(b=r[13])*s+(x=r[14])*h+(w=r[15])*m,e[13]=_*i+b*u+x*f+w*g,e[14]=_*o+b*c+x*d+w*y,e[15]=_*a+b*l+x*p+w*v,e}function Rs(e,t,r){var n,i,o,a,s,u,c,l,h,f,d,p,m=r[0],g=r[1],y=r[2];return t===e?(e[12]=t[0]*m+t[4]*g+t[8]*y+t[12],e[13]=t[1]*m+t[5]*g+t[9]*y+t[13],e[14]=t[2]*m+t[6]*g+t[10]*y+t[14],e[15]=t[3]*m+t[7]*g+t[11]*y+t[15]):(i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=t[6],l=t[7],h=t[8],f=t[9],d=t[10],p=t[11],e[0]=n=t[0],e[1]=i,e[2]=o,e[3]=a,e[4]=s,e[5]=u,e[6]=c,e[7]=l,e[8]=h,e[9]=f,e[10]=d,e[11]=p,e[12]=n*m+s*g+h*y+t[12],e[13]=i*m+u*g+f*y+t[13],e[14]=o*m+c*g+d*y+t[14],e[15]=a*m+l*g+p*y+t[15]),e}function Ls(e,t,r){var n=r[0],i=r[1],o=r[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*o,e[9]=t[9]*o,e[10]=t[10]*o,e[11]=t[11]*o,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Os(e,t,r){var n=Math.sin(r),i=Math.cos(r),o=t[4],a=t[5],s=t[6],u=t[7],c=t[8],l=t[9],h=t[10],f=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=o*i+c*n,e[5]=a*i+l*n,e[6]=s*i+h*n,e[7]=u*i+f*n,e[8]=c*i-o*n,e[9]=l*i-a*n,e[10]=h*i-s*n,e[11]=f*i-u*n,e}function zs(e,t,r){var n=Math.sin(r),i=Math.cos(r),o=t[0],a=t[1],s=t[2],u=t[3],c=t[8],l=t[9],h=t[10],f=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i-c*n,e[1]=a*i-l*n,e[2]=s*i-h*n,e[3]=u*i-f*n,e[8]=o*n+c*i,e[9]=a*n+l*i,e[10]=s*n+h*i,e[11]=u*n+f*i,e}function Ns(e,t){return e[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Us(e,t,r){var n,i,o,a=r[0],s=r[1],u=r[2],c=Math.hypot(a,s,u);return c<Ts?null:(a*=c=1/c,s*=c,u*=c,n=Math.sin(t),i=Math.cos(t),e[0]=a*a*(o=1-i)+i,e[1]=s*a*o+u*n,e[2]=u*a*o-s*n,e[3]=0,e[4]=a*s*o-u*n,e[5]=s*s*o+i,e[6]=u*s*o+a*n,e[7]=0,e[8]=a*u*o+s*n,e[9]=s*u*o-a*n,e[10]=u*u*o+i,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e)}Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)});var Zs=Ds;function Fs(){var e=new Ms(3);return Ms!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function js(e){var t=new Ms(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function Vs(e){return Math.hypot(e[0],e[1],e[2])}function Ws(e,t,r){var n=new Ms(3);return n[0]=e,n[1]=t,n[2]=r,n}function Ks(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e}function Gs(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e}function Hs(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e}function qs(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e}function Ys(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e}function Xs(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e}function Qs(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e}function $s(e,t){var r=t[0],n=t[1],i=t[2],o=r*r+n*n+i*i;return o>0&&(o=1/Math.sqrt(o)),e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o,e}function Js(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function eu(e,t,r){var n=t[0],i=t[1],o=t[2],a=r[0],s=r[1],u=r[2];return e[0]=i*u-o*s,e[1]=o*a-n*u,e[2]=n*s-i*a,e}function tu(e,t,r){var n=t[0],i=t[1],o=t[2],a=r[3]*n+r[7]*i+r[11]*o+r[15];return e[0]=(r[0]*n+r[4]*i+r[8]*o+r[12])/(a=a||1),e[1]=(r[1]*n+r[5]*i+r[9]*o+r[13])/a,e[2]=(r[2]*n+r[6]*i+r[10]*o+r[14])/a,e}function ru(e,t,r){var n=r[0],i=r[1],o=r[2],a=t[0],s=t[1],u=t[2],c=i*u-o*s,l=o*a-n*u,h=n*s-i*a,f=i*h-o*l,d=o*c-n*h,p=n*l-i*c,m=2*r[3];return l*=m,h*=m,d*=2,p*=2,e[0]=a+(c*=m)+(f*=2),e[1]=s+l+d,e[2]=u+h+p,e}var nu,iu=Gs,ou=Hs,au=Vs;function su(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e}function uu(e,t){var r=t[0],n=t[1],i=t[2],o=t[3],a=r*r+n*n+i*i+o*o;return a>0&&(a=1/Math.sqrt(a)),e[0]=r*a,e[1]=n*a,e[2]=i*a,e[3]=o*a,e}function cu(e,t,r){var n=t[0],i=t[1],o=t[2],a=t[3];return e[0]=r[0]*n+r[4]*i+r[8]*o+r[12]*a,e[1]=r[1]*n+r[5]*i+r[9]*o+r[13]*a,e[2]=r[2]*n+r[6]*i+r[10]*o+r[14]*a,e[3]=r[3]*n+r[7]*i+r[11]*o+r[15]*a,e}function lu(){var e=new Ms(4);return Ms!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function hu(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function fu(e,t,r){r*=.5;var n=t[0],i=t[1],o=t[2],a=t[3],s=Math.sin(r),u=Math.cos(r);return e[0]=n*u+a*s,e[1]=i*u+o*s,e[2]=o*u-i*s,e[3]=a*u-n*s,e}function du(e,t,r){r*=.5;var n=t[0],i=t[1],o=t[2],a=t[3],s=Math.sin(r),u=Math.cos(r);return e[0]=n*u-o*s,e[1]=i*u+a*s,e[2]=o*u+n*s,e[3]=a*u-i*s,e}Fs(),nu=new Ms(4),Ms!=Float32Array&&(nu[0]=0,nu[1]=0,nu[2]=0,nu[3]=0);var pu=uu;Fs(),Ws(1,0,0),Ws(0,1,0),lu(),lu(),Is();const mu=ia([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:gu}=mu,yu=ia([{name:"a_pos_3",components:3,type:"Int16"}]);var vu=ia([{name:"a_pos",type:"Int16",components:2}]);class _u{constructor(e,t){this.pos=e,this.dir=t}intersectsPlane(e,t,r){const n=Js(t,this.dir);if(Math.abs(n)<1e-6)return!1;const i=((e[0]-this.pos[0])*t[0]+(e[1]-this.pos[1])*t[1]+(e[2]-this.pos[2])*t[2])/n;return r[0]=this.pos[0]+this.dir[0]*i,r[1]=this.pos[1]+this.dir[1]*i,r[2]=this.pos[2]+this.dir[2]*i,!0}closestPointOnSphere(e,t,r){if(function(e,t){var r=e[0],n=e[1],i=e[2],o=t[0],a=t[1],s=t[2];return Math.abs(r-o)<=Ts*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(n-a)<=Ts*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(i-s)<=Ts*Math.max(1,Math.abs(i),Math.abs(s))}(this.pos,e)||0===t)return r[0]=r[1]=r[2]=0,!1;const[n,i,o]=this.dir,a=this.pos[0]-e[0],s=this.pos[1]-e[1],u=this.pos[2]-e[2],c=n*n+i*i+o*o,l=2*(a*n+s*i+u*o),h=l*l-4*c*(a*a+s*s+u*u-t*t);if(h<0){const e=Math.max(-l/2,0),c=a+n*e,h=s+i*e,f=u+o*e,d=Math.hypot(c,h,f);return r[0]=c*t/d,r[1]=h*t/d,r[2]=f*t/d,!1}{const e=(-l-Math.sqrt(h))/(2*c);if(e<0){const e=Math.hypot(a,s,u);return r[0]=a*t/e,r[1]=s*t/e,r[2]=u*t/e,!1}return r[0]=a+n*e,r[1]=s+i*e,r[2]=u+o*e,!0}}}class bu{constructor(e,t,r,n,i){this.TL=e,this.TR=t,this.BR=r,this.BL=n,this.horizon=i}static fromInvProjectionMatrix(e,t,r){const n=[-1,1,1],i=[1,1,1],o=[1,-1,1],a=[-1,-1,1],s=tu(n,n,e),u=tu(i,i,e),c=tu(o,o,e),l=tu(a,a,e);return new bu(s,u,c,l,t/r)}}class xu{constructor(e,t){this.points=e,this.planes=t}static fromInvProjectionMatrix(e,t,r,n){const i=Math.pow(2,r),o=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((r=>{const o=cu([],r,e),a=1/o[3]/t*i;return function(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e[3]=t[3]*r[3],e}(o,o,[a,a,n?1/o[3]:a,a])})),a=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map((e=>{const t=$s([],eu([],iu([],o[e[0]],o[e[1]]),iu([],o[e[2]],o[e[1]]))),r=-Js(t,o[e[1]]);return t.concat(r)}));return new xu(o,a)}}class wu{static fromPoints(e){const t=[1/0,1/0,1/0],r=[-1/0,-1/0,-1/0];for(const n of e)qs(t,t,n),Ys(r,r,n);return new wu(t,r)}static applyTransform(e,t){const r=e.getCorners();for(let n=0;n<r.length;++n)tu(r[n],r[n],t);return wu.fromPoints(r)}constructor(e,t){this.min=e,this.max=t,this.center=Xs([],Ks([],this.min,this.max),.5)}quadrant(e){const t=[e%2==0,e<2],r=js(this.min),n=js(this.max);for(let i=0;i<t.length;i++)r[i]=t[i]?this.min[i]:this.center[i],n[i]=t[i]?this.center[i]:this.max[i];return n[2]=this.max[2],new wu(r,n)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}distanceZ(e){return Math.max(Math.min(this.max[2],e[2]),this.min[2])-e[2]}getCorners(){const e=this.min,t=this.max;return[[e[0],e[1],e[2]],[t[0],e[1],e[2]],[t[0],t[1],e[2]],[e[0],t[1],e[2]],[e[0],e[1],t[2]],[t[0],e[1],t[2]],[t[0],t[1],t[2]],[e[0],t[1],t[2]]]}intersects(e){const t=this.getCorners();let r=!0;for(let n=0;n<e.planes.length;n++){const i=e.planes[n];let o=0;for(let e=0;e<t.length;e++)o+=Js(i,t[e])+i[3]>=0;if(0===o)return 0;o!==t.length&&(r=!1)}if(r)return 2;for(let n=0;n<3;n++){let t=Number.MAX_VALUE,r=-Number.MAX_VALUE;for(let i=0;i<e.points.length;i++){const o=e.points[i][n]-this.min[n];t=Math.min(t,o),r=Math.max(r,o)}if(r<0||t>this.max[n]-this.min[n])return 0}return 1}}const ku=Es/Math.PI/2,Au=64,Eu=[Au,32,16],Su=-ku,Tu=ku,Mu=[new wu([Su,Su,Su],[Tu,Tu,Tu]),new wu([Su,Su,Su],[0,0,Tu]),new wu([0,Su,Su],[Tu,0,Tu]),new wu([Su,0,Su],[0,Tu,Tu]),new wu([0,0,Su],[Tu,Tu,Tu])];function Iu(e){return e*ku/ec}function Pu(e,t,r,n=!0){const i=Xs([],e._camera.position,e.worldSize),o=[t,r,1,1];cu(o,o,e.pixelMatrixInverse),su(o,o,1/o[3]);const a=$s([],iu([],o,i)),s=e.globeMatrix,u=[s[12],s[13],s[14]],c=iu([],u,i),l=Vs(c),h=$s([],c),f=e.worldSize/(2*Math.PI),d=Js(h,a),p=Math.asin(f/l);if(p<Math.acos(d)){if(!n)return null;const e=[],t=[];Xs(e,a,l/d),$s(t,iu(t,e,c)),$s(a,Ks(a,c,Xs(a,t,Math.tan(p)*l)))}const m=[];new _u(i,a).closestPointOnSphere(u,f,m);const g=$s([],Y(s,0)),y=$s([],Y(s,1)),v=$s([],Y(s,2)),b=Js(g,m),x=Js(y,m),w=Js(v,m),k=_(Math.asin(-x/f));let E=_(Math.atan2(b,w));E=e.center.lng+function(e,t){const r=(t-e+180)%360-180;return r<-180?r+360:r}(e.center.lng,E);const S=ic(E),T=A(oc(k),0,1);return new fc(S,T)}class Cu{constructor(e,t,r){this.a=iu([],e,r),this.b=iu([],t,r),this.center=r;const n=$s([],this.a),i=$s([],this.b);this.angle=Math.acos(Js(n,i))}}function Bu(e,t){if(0===e.angle)return null;let r;return r=0===e.a[t]?1/e.angle*.5*Math.PI:1/e.angle*Math.atan(e.b[t]/e.a[t]/Math.sin(e.angle)-1/Math.tan(e.angle)),r<0||r>1?null:function(e,t,r,n){const i=Math.sin(r);return e*(Math.sin((1-n)*r)/i)+t*(Math.sin(n*r)/i)}(e.a[t],e.b[t],e.angle,A(r,0,1))+e.center[t]}function Du(e){if(e.z<=1)return Mu[e.z+2*e.y+e.x];const t=Uu(Nu(e));return wu.fromPoints(t)}function Ru(e,t,r){return Xs(e,e,1-r),Qs(e,e,t,r)}function Lu(e,t){const r=qu(t.zoom);if(0===r)return Du(e);const n=Nu(e),i=Uu(n),o=ic(n.getWest())*t.worldSize,a=ic(n.getEast())*t.worldSize,s=oc(n.getNorth())*t.worldSize,u=oc(n.getSouth())*t.worldSize,c=[o,s,0],l=[a,s,0],h=[o,u,0],f=[a,u,0],d=Bs([],t.globeMatrix);return tu(c,c,d),tu(l,l,d),tu(h,h,d),tu(f,f,d),i[0]=Ru(i[0],h,r),i[1]=Ru(i[1],f,r),i[2]=Ru(i[2],l,r),i[3]=Ru(i[3],c,r),wu.fromPoints(i)}function Ou(e,t,r){for(const n of e)tu(n,n,t),Xs(n,n,r)}function zu(e,t,r){const n=t/e.worldSize,i=e.globeMatrix;if(r.z<=1){const e=Du(r).getCorners();return Ou(e,i,n),wu.fromPoints(e)}const o=Nu(r),a=Uu(o);Ou(a,i,n);const s=Number.MAX_VALUE,u=[-s,-s,-s],c=[s,s,s];if(o.contains(e.center)){for(const e of a)qs(c,c,e),Ys(u,u,e);u[2]=0;const t=e.point,r=[t.x*n,t.y*n,0];return qs(c,c,r),Ys(u,u,r),new wu(c,u)}const l=[i[12]*n,i[13]*n,i[14]*n],h=o.getCenter(),f=A(e.center.lat,-lc,lc),d=A(h.lat,-lc,lc),p=ic(e.center.lng),m=oc(f);let g=p-ic(h.lng);const y=m-oc(d);g>.5?g-=1:g<-.5&&(g+=1);let _=0;Math.abs(g)>Math.abs(y)?_=g>=0?1:3:(_=y>=0?0:2,Qs(l,l,[i[4]*n,i[5]*n,i[6]*n],-Math.sin(v(y>=0?o.getSouth():o.getNorth()))*ku));const b=a[_],x=a[(_+1)%4],w=new Cu(b,x,l),k=[Bu(w,0)||b[0],Bu(w,1)||b[1],Bu(w,2)||b[2]],E=qu(e.zoom);if(E>0){const n=function({x:e,y:t,z:r},n,i,o,a){const s=1/(1<<r);let u=e*s,c=u+s,l=t*s,h=l+s,f=0;const d=(u+c)/2-o;return d>.5?f=-1:d<-.5&&(f=1),u=((u+f)*n-(o*=n))*i+o,c=((c+f)*n-o)*i+o,l=(l*n-(a*=n))*i+a,h=(h*n-a)*i+a,[[u,h,0],[c,h,0],[c,l,0],[u,l,0]]}(r,t,e._pixelsPerMercatorPixel,p,m);for(let e=0;e<a.length;e++)Ru(a[e],n[e],E);const i=Ks([],n[_],n[(_+1)%4]);Xs(i,i,.5),Ru(k,i,E)}for(const v of a)qs(c,c,v),Ys(u,u,v);return c[2]=Math.min(b[2],x[2]),qs(c,c,k),Ys(u,u,k),new wu(c,u)}function Nu({x:e,y:t,z:r}){const n=1/(1<<r),i=new rc(sc(e*n),uc((t+1)*n)),o=new rc(sc((e+1)*n),uc(t*n));return new Ss(i,o)}function Uu(e){const t=v(e.getNorth()),r=v(e.getSouth()),n=Math.cos(t),i=Math.cos(r),o=Math.sin(t),a=Math.sin(r),s=e.getWest(),u=e.getEast();return[Zu(i,a,s),Zu(i,a,u),Zu(n,o,u),Zu(n,o,s)]}function Zu(e,t,r,n=ku){return r=v(r),[e*Math.sin(r)*n,-t*n,e*Math.cos(r)*n]}function Fu(e,t,r){return Zu(Math.cos(v(e)),Math.sin(v(e)),t,r)}function ju(e,t,r,n){const i=1<<r.z,o=(e/Es+r.x)/i;return Fu(uc((t/Es+r.y)/i),sc(o),n)}function Vu({min:e,max:t}){return 16383/Math.max(t[0]-e[0],t[1]-e[1],t[2]-e[2])}const Wu=new Float64Array(16);function Ku(e){const t=Vu(e),r=Ns(Wu,[t,t,t]);return Rs(r,r,((n=[])[0]=-(i=e.min)[0],n[1]=-i[1],n[2]=-i[2],n));var n,i}function Gu(e){const t=(n=e.min,(r=Wu)[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=n[0],r[13]=n[1],r[14]=n[2],r[15]=1,r);var r,n;const i=1/Vu(e);return Ls(t,t,[i,i,i])}function Hu(e,t,r,n,i){const o=function(e){const t=Es/(2*Math.PI);return e/(2*Math.PI)/t}(r),a=[e,t,-r/(2*Math.PI)],s=Cs(new Float64Array(16));return Rs(s,s,a),Ls(s,s,[o,o,o]),Os(s,s,v(-i)),zs(s,s,v(-n)),s}function qu(e){return E(5,6,e)}function Yu(e,t){const r=Fu(t.lat,t.lng),n=function(e){const t=Fu(e._center.lat,e._center.lng);let r=eu([],Ws(0,1,0),t);const n=Us([],-e.angle,t);r=tu(r,r,n),Us(n,-e._pitch,r);const i=$s([],t);return Xs(i,i,Iu(e.cameraToCenterDistance/e.pixelsPerMeter)),tu(i,i,n),Ks([],t,i)}(e);return a=(i=Gs([],n,r))[0],s=i[1],u=i[2],c=(o=r)[0],l=o[1],h=o[2],d=(f=Math.sqrt(a*a+s*s+u*u)*Math.sqrt(c*c+l*l+h*h))&&Js(i,o)/f,Math.acos(Math.min(Math.max(d,-1),1));var i,o,a,s,u,c,l,h,f,d}function Xu(e,t){return Yu(e,t)>Math.PI/2*1.01}const Qu=v(85),$u=Math.cos(Qu),Ju=Math.sin(Qu),ec=6371008.8,tc=2*Math.PI*ec;class rc{constructor(e,t){if(isNaN(e)||isNaN(t))throw new Error(`Invalid LngLat object: (${e}, ${t})`);if(this.lng=+e,this.lat=+t,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new rc(S(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const t=Math.PI/180,r=this.lat*t,n=e.lat*t,i=Math.sin(r)*Math.sin(n)+Math.cos(r)*Math.cos(n)*Math.cos((e.lng-this.lng)*t);return ec*Math.acos(Math.min(i,1))}toBounds(e=0){const t=360*e/40075017,r=t/Math.cos(Math.PI/180*this.lat);return new Ss(new rc(this.lng-r,this.lat-t),new rc(this.lng+r,this.lat+t))}toEcef(e){const t=Iu(e);return Fu(this.lat,this.lng,ku+t)}static convert(e){if(e instanceof rc)return e;if(Array.isArray(e)&&(2===e.length||3===e.length))return new rc(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&"object"==typeof e&&null!==e)return new rc(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}function nc(e){return tc*Math.cos(e*Math.PI/180)}function ic(e){return(180+e)/360}function oc(e){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+e*Math.PI/360)))/360}function ac(e,t){return e/nc(t)}function sc(e){return 360*e-180}function uc(e){return 360/Math.PI*Math.atan(Math.exp((180-360*e)*Math.PI/180))-90}function cc(e,t){return e*nc(uc(t))}const lc=85.051129;function hc(e){return 1/Math.cos(e*Math.PI/180)}class fc{constructor(e,t,r=0){this.x=+e,this.y=+t,this.z=+r}static fromLngLat(e,t=0){const r=rc.convert(e);return new fc(ic(r.lng),oc(r.lat),ac(t,r.lat))}toLngLat(){return new rc(sc(this.x),uc(this.y))}toAltitude(){return cc(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/tc*hc(uc(this.y))}}function dc(e,t,r,n,i,o,a,s,u){const c=(t+n)/2,l=(r+i)/2,h=new p(c,l);s(h),function(e,t,r,n,i,o){const a=r-i,s=n-o;return Math.abs((n-t)*a-(r-e)*s)/Math.hypot(a,s)}(h.x,h.y,o.x,o.y,a.x,a.y)>=u?(dc(e,t,r,c,l,o,h,s,u),dc(e,c,l,n,i,h,a,s,u)):e.push(a)}function pc(e,t,r){let n=e[0],i=n.x,o=n.y;t(n);const a=[n];for(let s=1;s<e.length;s++){const u=e[s],{x:c,y:l}=u;t(u),dc(a,i,o,c,l,n,u,t,r),i=c,o=l,n=u}return a}function mc(e,t,r,n){if(n(t,r)){const i=t.add(r)._mult(.5);mc(e,t,i,n),mc(e,i,r,n)}else e.push(r)}function gc(e,t){let r=e[0];const n=[r];for(let i=1;i<e.length;i++){const o=e[i];mc(n,r,o,t),r=o}return n}const yc=Math.pow(2,14)-1,vc=-yc-1;function _c(e,t){const r=Math.round(e.x*t),n=Math.round(e.y*t);return e.x=A(r,vc,yc),e.y=A(n,vc,yc),(r<e.x||r>e.x+1||n<e.y||n>e.y+1)&&F("Geometry exceeds allowed extent, reduce your vector tile buffer size"),e}function bc(e,t,r){const n=e.loadGeometry(),i=e.extent,o=Es/i;if(t&&r&&r.projection.isReprojectedInTileSpace){const o=1<<t.z,{scale:a,x:s,y:u,projection:c}=r,l=e=>{const r=sc((t.x+e.x/i)/o),n=uc((t.y+e.y/i)/o),l=c.project(r,n);e.x=(l.x*a-s)*i,e.y=(l.y*a-u)*i};for(let t=0;t<n.length;t++)if(1!==e.type)n[t]=pc(n[t],l,1);else{const e=[];for(const r of n[t])r.x<0||r.x>=i||r.y<0||r.y>=i||(l(r),e.push(r));n[t]=e}}for(const a of n)for(const e of a)_c(e,o);return n}function xc(e,t){return{type:e.type,id:e.id,properties:e.properties,geometry:t?bc(e):[]}}function wc(e,t,r,n,i){e.emplaceBack(2*t+(n+1)/2,2*r+(i+1)/2)}function kc(e,t,r){const n=16384;e.emplaceBack(t.x,t.y,t.z,r[0]*n,r[1]*n,r[2]*n)}class Ac{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((e=>e.id)),this.index=e.index,this.hasPattern=!1,this.projection=e.projection,this.layoutVertexArray=new aa,this.indexArray=new wa,this.segments=new As,this.programConfigurations=new ps(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter((e=>e.isStateDependent())).map((e=>e.id))}populate(e,t,r,n){const i=this.layers[0],o=[];let a=null;"circle"===i.type&&(a=i.layout.get("circle-sort-key"));for(const{feature:u,id:c,index:l,sourceLayerIndex:h}of e){const e=this.layers[0]._featureFilter.needGeometry,t=xc(u,e);if(!this.layers[0]._featureFilter.filter(new Fo(this.zoom),t,r))continue;const i=a?a.evaluate(t,{},r):void 0,s={id:c,properties:u.properties,type:u.type,sourceLayerIndex:h,index:l,geometry:e?t.geometry:bc(u,r,n),patterns:{},sortKey:i};o.push(s)}a&&o.sort(((e,t)=>e.sortKey-t.sortKey));let s=null;"globe"===n.projection.name&&(this.globeExtVertexArray=new da,s=n.projection);for(const u of o){const{geometry:n,index:i,sourceLayerIndex:o}=u,a=e[i].feature;this.addFeature(u,n,i,t.availableImages,r,s),t.featureIndex.insert(a,n,i,o,this.index)}}update(e,t,r,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r,n)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,ws.members),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,ks.members))),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(e,t,r,n,i,o){for(const a of t)for(const t of a){const r=t.x,n=t.y;if(r<0||r>=Es||n<0||n>=Es)continue;if(o){const e=o.projectTilePoint(r,n,i),t=o.upVector(i,r,n),a=this.globeExtVertexArray;kc(a,e,t),kc(a,e,t),kc(a,e,t),kc(a,e,t)}const a=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),s=a.vertexLength;wc(this.layoutVertexArray,r,n,-1,-1),wc(this.layoutVertexArray,r,n,1,-1),wc(this.layoutVertexArray,r,n,1,1),wc(this.layoutVertexArray,r,n,-1,1),this.indexArray.emplaceBack(s,s+1,s+2),this.indexArray.emplaceBack(s,s+2,s+3),a.vertexLength+=4,a.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,{},n,i)}}function Ec(e,t){for(let r=0;r<e.length;r++)if(Rc(t,e[r]))return!0;for(let r=0;r<t.length;r++)if(Rc(e,t[r]))return!0;return!!Ic(e,t)}function Sc(e,t,r){return!!Rc(e,t)||!!Cc(t,e,r)}function Tc(e,t){if(1===e.length)return Dc(t,e[0]);for(let r=0;r<t.length;r++){const n=t[r];for(let t=0;t<n.length;t++)if(Rc(e,n[t]))return!0}for(let r=0;r<e.length;r++)if(Dc(t,e[r]))return!0;for(let r=0;r<t.length;r++)if(Ic(e,t[r]))return!0;return!1}function Mc(e,t,r){if(e.length>1){if(Ic(e,t))return!0;for(let n=0;n<t.length;n++)if(Cc(t[n],e,r))return!0}for(let n=0;n<e.length;n++)if(Cc(e[n],t,r))return!0;return!1}function Ic(e,t){if(0===e.length||0===t.length)return!1;for(let r=0;r<e.length-1;r++){const n=e[r],i=e[r+1];for(let e=0;e<t.length-1;e++)if(Pc(n,i,t[e],t[e+1]))return!0}return!1}function Pc(e,t,r,n){return j(e,r,n)!==j(t,r,n)&&j(e,t,r)!==j(e,t,n)}function Cc(e,t,r){const n=r*r;if(1===t.length)return e.distSqr(t[0])<n;for(let i=1;i<t.length;i++)if(Bc(e,t[i-1],t[i])<n)return!0;return!1}function Bc(e,t,r){const n=t.distSqr(r);if(0===n)return e.distSqr(t);const i=((e.x-t.x)*(r.x-t.x)+(e.y-t.y)*(r.y-t.y))/n;return e.distSqr(i<0?t:i>1?r:r.sub(t)._mult(i)._add(t))}function Dc(e,t){let r,n,i,o=!1;for(let a=0;a<e.length;a++){r=e[a];for(let e=0,a=r.length-1;e<r.length;a=e++)n=r[e],i=r[a],n.y>t.y!=i.y>t.y&&t.x<(i.x-n.x)*(t.y-n.y)/(i.y-n.y)+n.x&&(o=!o)}return o}function Rc(e,t){let r=!1;for(let n=0,i=e.length-1;n<e.length;i=n++){const o=e[n],a=e[i];o.y>t.y!=a.y>t.y&&t.x<(a.x-o.x)*(t.y-o.y)/(a.y-o.y)+o.x&&(r=!r)}return r}function Lc(e,t,r,n,i){for(const a of e)if(t<=a.x&&r<=a.y&&n>=a.x&&i>=a.y)return!0;const o=[new p(t,r),new p(t,i),new p(n,i),new p(n,r)];if(e.length>2)for(const a of o)if(Rc(e,a))return!0;for(let a=0;a<e.length-1;a++)if(Oc(e[a],e[a+1],o))return!0;return!1}function Oc(e,t,r){const n=r[0],i=r[2];if(e.x<n.x&&t.x<n.x||e.x>i.x&&t.x>i.x||e.y<n.y&&t.y<n.y||e.y>i.y&&t.y>i.y)return!1;const o=j(e,t,r[0]);return o!==j(e,t,r[1])||o!==j(e,t,r[2])||o!==j(e,t,r[3])}function zc(e,t,r){const n=t.paint.get(e).value;return"constant"===n.kind?n.value:r.programConfigurations.get(t.id).getMaxValue(e)}function Nc(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function Uc(e,t,r,n,i){if(!t[0]&&!t[1])return e;const o=p.convert(t)._mult(i);"viewport"===r&&o._rotate(-n);const a=[];for(let s=0;s<e.length;s++)a.push(e[s].sub(o));return a}function Zc(e,t,r,n){const i=p.convert(e)._mult(n);return"viewport"===t&&i._rotate(-r),i}ji(Ac,"CircleBucket",{omit:["layers"]});const Fc=new Jo({"circle-sort-key":new Qo(Xe.layout_circle["circle-sort-key"])});var jc={paint:new Jo({"circle-radius":new Qo(Xe.paint_circle["circle-radius"]),"circle-color":new Qo(Xe.paint_circle["circle-color"]),"circle-blur":new Qo(Xe.paint_circle["circle-blur"]),"circle-opacity":new Qo(Xe.paint_circle["circle-opacity"]),"circle-translate":new Xo(Xe.paint_circle["circle-translate"]),"circle-translate-anchor":new Xo(Xe.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Xo(Xe.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Xo(Xe.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Qo(Xe.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Qo(Xe.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Qo(Xe.paint_circle["circle-stroke-opacity"])}),layout:Fc};function Vc(e,t,r,n,i,o,a,s,u){if(o&&e.queryGeometry.isAboveHorizon)return!1;o&&(u*=e.pixelToTileUnitsFactor);const c=e.tileID.canonical,l=r.projection.upVectorScale(c,r.center.lat,r.worldSize).metersToTile;for(const h of t)for(const t of h){const h=t.add(s),f=i&&r.elevation?r.elevation.exaggeration()*i.getElevationAt(h.x,h.y,!0):0,d=r.projection.projectTilePoint(h.x,h.y,c);if(f>0){const e=r.projection.upVector(c,h.x,h.y);d.x+=e[0]*l*f,d.y+=e[1]*l*f,d.z+=e[2]*l*f}const p=o?h:Wc(d.x,d.y,d.z,n),m=o?e.tilespaceRays.map((e=>Hc(e,f))):e.queryGeometry.screenGeometry,g=cu([],[d.x,d.y,d.z,1],n);if(!a&&o?u*=g[3]/r.cameraToCenterDistance:a&&!o&&(u*=r.cameraToCenterDistance/g[3]),o){const e=uc((t.y/Es+c.y)/(1<<c.z));u/=r.projection.pixelsPerMeter(e,1)/ac(1,e)}if(Sc(m,p,u))return!0}return!1}function Wc(e,t,r,n){const i=cu([],[e,t,r,1],n);return new p(i[0]/i[3],i[1]/i[3])}const Kc=Ws(0,0,0),Gc=Ws(0,0,1);function Hc(e,t){const r=Fs();return Kc[2]=t,e.intersectsPlane(Kc,Gc,r),new p(r[0],r[1])}class qc extends Ac{}function Yc(e,{width:t,height:r},n,i){if(i){if(i instanceof Uint8ClampedArray)i=new Uint8Array(i.buffer);else if(i.length!==t*r*n)throw new RangeError("mismatched image size")}else i=new Uint8Array(t*r*n);return e.width=t,e.height=r,e.data=i,e}function Xc(e,t,r){const{width:n,height:i}=t;n===e.width&&i===e.height||(Qc(e,t,{x:0,y:0},{x:0,y:0},{width:Math.min(e.width,n),height:Math.min(e.height,i)},r),e.width=n,e.height=i,e.data=t.data)}function Qc(e,t,r,n,i,o){if(0===i.width||0===i.height)return t;if(i.width>e.width||i.height>e.height||r.x>e.width-i.width||r.y>e.height-i.height)throw new RangeError("out of range source coordinates for image copy");if(i.width>t.width||i.height>t.height||n.x>t.width-i.width||n.y>t.height-i.height)throw new RangeError("out of range destination coordinates for image copy");const a=e.data,s=t.data;for(let u=0;u<i.height;u++){const c=((r.y+u)*e.width+r.x)*o,l=((n.y+u)*t.width+n.x)*o;for(let e=0;e<i.width*o;e++)s[l+e]=a[c+e]}return t}ji(qc,"HeatmapBucket",{omit:["layers"]});class $c{constructor(e,t){Yc(this,e,1,t)}resize(e){Xc(this,new $c(e),1)}clone(){return new $c({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,t,r,n,i){Qc(e,t,r,n,i,1)}}class Jc{constructor(e,t){Yc(this,e,4,t)}resize(e){Xc(this,new Jc(e),4)}replace(e,t){t?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new Jc({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,t,r,n,i){Qc(e,t,r,n,i,4)}}ji($c,"AlphaImage"),ji(Jc,"RGBAImage");var el={paint:new Jo({"heatmap-radius":new Qo(Xe.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Qo(Xe.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Xo(Xe.paint_heatmap["heatmap-intensity"]),"heatmap-color":new $o(Xe.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Xo(Xe.paint_heatmap["heatmap-opacity"])})};function tl(e){const t={},r=e.resolution||256,n=e.clips?e.clips.length:1,i=e.image||new Jc({width:r,height:n}),o=(r,n,o)=>{t[e.evaluationKey]=o;const a=e.expression.evaluate(t);i.data[r+n+0]=Math.floor(255*a.r/a.a),i.data[r+n+1]=Math.floor(255*a.g/a.a),i.data[r+n+2]=Math.floor(255*a.b/a.a),i.data[r+n+3]=Math.floor(255*a.a)};if(e.clips)for(let a=0,s=0;a<n;++a,s+=4*r)for(let t=0,n=0;t<r;t++,n+=4){const i=t/(r-1),{start:u,end:c}=e.clips[a];o(s,n,u*(1-i)+c*i)}else for(let a=0,s=0;a<r;a++,s+=4)o(0,s,a/(r-1));return i}var rl={paint:new Jo({"hillshade-illumination-direction":new Xo(Xe.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Xo(Xe.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Xo(Xe.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Xo(Xe.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Xo(Xe.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Xo(Xe.paint_hillshade["hillshade-accent-color"])})};const nl=ia([{name:"a_pos",components:2,type:"Int16"}],4),{members:il}=nl;var ol={};function al(e,t,r){r=r||2;var n,i,o,a,s,u,c,l=t&&t.length,h=l?t[0]*r:e.length,f=sl(e,0,h,r,!0),d=[];if(!f||f.next===f.prev)return d;if(l&&(f=function(e,t,r,n){var i,o,a,s=[];for(i=0,o=t.length;i<o;i++)(a=sl(e,t[i]*n,i<o-1?t[i+1]*n:e.length,n,!1))===a.next&&(a.steiner=!0),s.push(vl(a));for(s.sort(pl),i=0;i<s.length;i++)r=ml(s[i],r);return r}(e,t,f,r)),e.length>80*r){n=o=e[0],i=a=e[1];for(var p=r;p<h;p+=r)(s=e[p])<n&&(n=s),(u=e[p+1])<i&&(i=u),s>o&&(o=s),u>a&&(a=u);c=0!==(c=Math.max(o-n,a-i))?32767/c:0}return cl(f,d,r,n,i,c,0),d}function sl(e,t,r,n,i){var o,a;if(i===Cl(e,t,r,n)>0)for(o=t;o<r;o+=n)a=Ml(o,e[o],e[o+1],a);else for(o=r-n;o>=t;o-=n)a=Ml(o,e[o],e[o+1],a);return a&&wl(a,a.next)&&(Il(a),a=a.next),a}function ul(e,t){if(!e)return e;t||(t=e);var r,n=e;do{if(r=!1,n.steiner||!wl(n,n.next)&&0!==xl(n.prev,n,n.next))n=n.next;else{if(Il(n),(n=t=n.prev)===n.next)break;r=!0}}while(r||n!==t);return t}function cl(e,t,r,n,i,o,a){if(e){!a&&o&&function(e,t,r,n){var i=e;do{0===i.z&&(i.z=yl(i.x,i.y,t,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){var t,r,n,i,o,a,s,u,c=1;do{for(r=e,e=null,o=null,a=0;r;){for(a++,n=r,s=0,t=0;t<c&&(s++,n=n.nextZ);t++);for(u=c;s>0||u>0&&n;)0!==s&&(0===u||!n||r.z<=n.z)?(i=r,r=r.nextZ,s--):(i=n,n=n.nextZ,u--),o?o.nextZ=i:e=i,i.prevZ=o,o=i;r=n}o.nextZ=null,c*=2}while(a>1)}(i)}(e,n,i,o);for(var s,u,c=e;e.prev!==e.next;)if(s=e.prev,u=e.next,o?hl(e,n,i,o):ll(e))t.push(s.i/r|0),t.push(e.i/r|0),t.push(u.i/r|0),Il(e),e=u.next,c=u.next;else if((e=u)===c){a?1===a?cl(e=fl(ul(e),t,r),t,r,n,i,o,2):2===a&&dl(e,t,r,n,i,o):cl(ul(e),t,r,n,i,o,1);break}}}function ll(e){var t=e.prev,r=e,n=e.next;if(xl(t,r,n)>=0)return!1;for(var i=t.x,o=r.x,a=n.x,s=t.y,u=r.y,c=n.y,l=i<o?i<a?i:a:o<a?o:a,h=s<u?s<c?s:c:u<c?u:c,f=i>o?i>a?i:a:o>a?o:a,d=s>u?s>c?s:c:u>c?u:c,p=n.next;p!==t;){if(p.x>=l&&p.x<=f&&p.y>=h&&p.y<=d&&_l(i,s,o,u,a,c,p.x,p.y)&&xl(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function hl(e,t,r,n){var i=e.prev,o=e,a=e.next;if(xl(i,o,a)>=0)return!1;for(var s=i.x,u=o.x,c=a.x,l=i.y,h=o.y,f=a.y,d=s<u?s<c?s:c:u<c?u:c,p=l<h?l<f?l:f:h<f?h:f,m=s>u?s>c?s:c:u>c?u:c,g=l>h?l>f?l:f:h>f?h:f,y=yl(d,p,t,r,n),v=yl(m,g,t,r,n),_=e.prevZ,b=e.nextZ;_&&_.z>=y&&b&&b.z<=v;){if(_.x>=d&&_.x<=m&&_.y>=p&&_.y<=g&&_!==i&&_!==a&&_l(s,l,u,h,c,f,_.x,_.y)&&xl(_.prev,_,_.next)>=0)return!1;if(_=_.prevZ,b.x>=d&&b.x<=m&&b.y>=p&&b.y<=g&&b!==i&&b!==a&&_l(s,l,u,h,c,f,b.x,b.y)&&xl(b.prev,b,b.next)>=0)return!1;b=b.nextZ}for(;_&&_.z>=y;){if(_.x>=d&&_.x<=m&&_.y>=p&&_.y<=g&&_!==i&&_!==a&&_l(s,l,u,h,c,f,_.x,_.y)&&xl(_.prev,_,_.next)>=0)return!1;_=_.prevZ}for(;b&&b.z<=v;){if(b.x>=d&&b.x<=m&&b.y>=p&&b.y<=g&&b!==i&&b!==a&&_l(s,l,u,h,c,f,b.x,b.y)&&xl(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}function fl(e,t,r){var n=e;do{var i=n.prev,o=n.next.next;!wl(i,o)&&kl(i,n,n.next,o)&&Sl(i,o)&&Sl(o,i)&&(t.push(i.i/r|0),t.push(n.i/r|0),t.push(o.i/r|0),Il(n),Il(n.next),n=e=o),n=n.next}while(n!==e);return ul(n)}function dl(e,t,r,n,i,o){var a=e;do{for(var s=a.next.next;s!==a.prev;){if(a.i!==s.i&&bl(a,s)){var u=Tl(a,s);return a=ul(a,a.next),u=ul(u,u.next),cl(a,t,r,n,i,o,0),void cl(u,t,r,n,i,o,0)}s=s.next}a=a.next}while(a!==e)}function pl(e,t){return e.x-t.x}function ml(e,t){var r=function(e,t){var r,n=t,i=e.x,o=e.y,a=-1/0;do{if(o<=n.y&&o>=n.next.y&&n.next.y!==n.y){var s=n.x+(o-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(s<=i&&s>a&&(a=s,r=n.x<n.next.x?n:n.next,s===i))return r}n=n.next}while(n!==t);if(!r)return null;var u,c=r,l=r.x,h=r.y,f=1/0;n=r;do{i>=n.x&&n.x>=l&&i!==n.x&&_l(o<h?i:a,o,l,h,o<h?a:i,o,n.x,n.y)&&(u=Math.abs(o-n.y)/(i-n.x),Sl(n,e)&&(u<f||u===f&&(n.x>r.x||n.x===r.x&&gl(r,n)))&&(r=n,f=u)),n=n.next}while(n!==c);return r}(e,t);if(!r)return t;var n=Tl(r,e);return ul(n,n.next),ul(r,r.next)}function gl(e,t){return xl(e.prev,e,t.prev)<0&&xl(t.next,e,e.next)<0}function yl(e,t,r,n,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-r)*i|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*i|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function vl(e){var t=e,r=e;do{(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next}while(t!==e);return r}function _l(e,t,r,n,i,o,a,s){return(i-a)*(t-s)>=(e-a)*(o-s)&&(e-a)*(n-s)>=(r-a)*(t-s)&&(r-a)*(o-s)>=(i-a)*(n-s)}function bl(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&kl(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}(e,t)&&(Sl(e,t)&&Sl(t,e)&&function(e,t){var r=e,n=!1,i=(e.x+t.x)/2,o=(e.y+t.y)/2;do{r.y>o!=r.next.y>o&&r.next.y!==r.y&&i<(r.next.x-r.x)*(o-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next}while(r!==e);return n}(e,t)&&(xl(e.prev,e,t.prev)||xl(e,t.prev,t))||wl(e,t)&&xl(e.prev,e,e.next)>0&&xl(t.prev,t,t.next)>0)}function xl(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function wl(e,t){return e.x===t.x&&e.y===t.y}function kl(e,t,r,n){var i=El(xl(e,t,r)),o=El(xl(e,t,n)),a=El(xl(r,n,e)),s=El(xl(r,n,t));return i!==o&&a!==s||!(0!==i||!Al(e,r,t))||!(0!==o||!Al(e,n,t))||!(0!==a||!Al(r,e,n))||!(0!==s||!Al(r,t,n))}function Al(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function El(e){return e>0?1:e<0?-1:0}function Sl(e,t){return xl(e.prev,e,e.next)<0?xl(e,t,e.next)>=0&&xl(e,e.prev,t)>=0:xl(e,t,e.prev)<0||xl(e,e.next,t)<0}function Tl(e,t){var r=new Pl(e.i,e.x,e.y),n=new Pl(t.i,t.x,t.y),i=e.next,o=t.prev;return e.next=t,t.prev=e,r.next=i,i.prev=r,n.next=r,r.prev=n,o.next=n,n.prev=o,n}function Ml(e,t,r,n){var i=new Pl(e,t,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function Il(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Pl(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Cl(e,t,r,n){for(var i=0,o=t,a=r-n;o<r;o+=n)i+=(e[a]-e[o])*(e[o+1]+e[a+1]),a=o;return i}function Bl(e,t,r,n,i){Dl(e,t,r||0,n||e.length-1,i||Ll)}function Dl(e,t,r,n,i){for(;n>r;){if(n-r>600){var o=n-r+1,a=t-r+1,s=Math.log(o),u=.5*Math.exp(2*s/3),c=.5*Math.sqrt(s*u*(o-u)/o)*(a-o/2<0?-1:1);Dl(e,t,Math.max(r,Math.floor(t-a*u/o+c)),Math.min(n,Math.floor(t+(o-a)*u/o+c)),i)}var l=e[t],h=r,f=n;for(Rl(e,r,t),i(e[n],l)>0&&Rl(e,r,n);h<f;){for(Rl(e,h,f),h++,f--;i(e[h],l)<0;)h++;for(;i(e[f],l)>0;)f--}0===i(e[r],l)?Rl(e,r,f):Rl(e,++f,n),f<=t&&(r=f+1),t<=f&&(n=f-1)}}function Rl(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function Ll(e,t){return e<t?-1:e>t?1:0}function Ol(e,t){const r=e.length;if(r<=1)return[e];const n=[];let i,o;for(let a=0;a<r;a++){const t=V(e[a]);0!==t&&(e[a].area=Math.abs(t),void 0===o&&(o=t<0),o===t<0?(i&&n.push(i),i=[e[a]]):i.push(e[a]))}if(i&&n.push(i),t>1)for(let a=0;a<n.length;a++)n[a].length<=t||(Bl(n[a],t,1,n[a].length-1,zl),n[a]=n[a].slice(0,t));return n}function zl(e,t){return t.area-e.area}function Nl(e,t,r){const n=r.patternDependencies;let i=!1;for(const o of t){const t=o.paint.get(`${e}-pattern`);t.isConstant()||(i=!0);const r=t.constantOr(null);r&&(i=!0,n[r]=!0)}return i}function Ul(e,t,r,n,i){const o=i.patternDependencies;for(const a of t){const t=a.paint.get(`${e}-pattern`).value;if("constant"!==t.kind){let e=t.evaluate({zoom:n},r,{},i.availableImages);e=e&&e.name?e.name:e,o[e]=!0,r.patterns[a.id]=e}}return r}({get exports(){return ol},set exports(e){ol=e}}).exports=al,ol.default=al,al.deviation=function(e,t,r,n){var i=t&&t.length,o=Math.abs(Cl(e,0,i?t[0]*r:e.length,r));if(i)for(var a=0,s=t.length;a<s;a++)o-=Math.abs(Cl(e,t[a]*r,a<s-1?t[a+1]*r:e.length,r));var u=0;for(a=0;a<n.length;a+=3){var c=n[a]*r,l=n[a+1]*r,h=n[a+2]*r;u+=Math.abs((e[c]-e[h])*(e[l+1]-e[c+1])-(e[c]-e[l])*(e[h+1]-e[c+1]))}return 0===o&&0===u?0:Math.abs((u-o)/o)},al.flatten=function(e){for(var t=e[0][0].length,r={vertices:[],holes:[],dimensions:t},n=0,i=0;i<e.length;i++){for(var o=0;o<e[i].length;o++)for(var a=0;a<t;a++)r.vertices.push(e[i][o][a]);i>0&&r.holes.push(n+=e[i-1].length)}return r};class Zl{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((e=>e.id)),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new aa,this.indexArray=new wa,this.indexArray2=new Ma,this.programConfigurations=new ps(e.layers,e.zoom),this.segments=new As,this.segments2=new As,this.stateDependentLayerIds=this.layers.filter((e=>e.isStateDependent())).map((e=>e.id)),this.projection=e.projection}populate(e,t,r,n){this.hasPattern=Nl("fill",this.layers,t);const i=this.layers[0].layout.get("fill-sort-key"),o=[];for(const{feature:a,id:s,index:u,sourceLayerIndex:c}of e){const e=this.layers[0]._featureFilter.needGeometry,l=xc(a,e);if(!this.layers[0]._featureFilter.filter(new Fo(this.zoom),l,r))continue;const h=i?i.evaluate(l,{},r,t.availableImages):void 0,f={id:s,properties:a.properties,type:a.type,sourceLayerIndex:c,index:u,geometry:e?l.geometry:bc(a,r,n),patterns:{},sortKey:h};o.push(f)}i&&o.sort(((e,t)=>e.sortKey-t.sortKey));for(const a of o){const{geometry:n,index:i,sourceLayerIndex:o}=a;if(this.hasPattern){const e=Ul("fill",this.layers,a,this.zoom,t);this.patternFeatures.push(e)}else this.addFeature(a,n,i,r,{},t.availableImages);t.featureIndex.insert(e[i].feature,n,i,o,this.index)}}update(e,t,r,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r,n)}addFeatures(e,t,r,n,i){for(const o of this.patternFeatures)this.addFeature(o,o.geometry,o.index,t,r,n)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,il),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,t,r,n,i,o=[]){for(const a of Ol(t,500)){let e=0;for(const s of a)e+=s.length;const t=this.segments.prepareSegment(e,this.layoutVertexArray,this.indexArray),r=t.vertexLength,n=[],i=[];for(const s of a){if(0===s.length)continue;s!==a[0]&&i.push(n.length/2);const e=this.segments2.prepareSegment(s.length,this.layoutVertexArray,this.indexArray2),t=e.vertexLength;this.layoutVertexArray.emplaceBack(s[0].x,s[0].y),this.indexArray2.emplaceBack(t+s.length-1,t),n.push(s[0].x),n.push(s[0].y);for(let r=1;r<s.length;r++)this.layoutVertexArray.emplaceBack(s[r].x,s[r].y),this.indexArray2.emplaceBack(t+r-1,t+r),n.push(s[r].x),n.push(s[r].y);e.vertexLength+=s.length,e.primitiveLength+=s.length}const o=ol(n,i);for(let a=0;a<o.length;a+=3)this.indexArray.emplaceBack(r+o[a],r+o[a+1],r+o[a+2]);t.vertexLength+=e,t.primitiveLength+=o.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,i,o,n)}}ji(Zl,"FillBucket",{omit:["layers","patternFeatures"]});const Fl=new Jo({"fill-sort-key":new Qo(Xe.layout_fill["fill-sort-key"])});var jl={paint:new Jo({"fill-antialias":new Xo(Xe.paint_fill["fill-antialias"]),"fill-opacity":new Qo(Xe.paint_fill["fill-opacity"]),"fill-color":new Qo(Xe.paint_fill["fill-color"]),"fill-outline-color":new Qo(Xe.paint_fill["fill-outline-color"]),"fill-translate":new Xo(Xe.paint_fill["fill-translate"]),"fill-translate-anchor":new Xo(Xe.paint_fill["fill-translate-anchor"]),"fill-pattern":new Qo(Xe.paint_fill["fill-pattern"])}),layout:Fl};const Vl=ia([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),Wl=ia([{name:"a_centroid_pos",components:2,type:"Uint16"}]),Kl=ia([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:Gl}=Vl;var Hl={},ql=p,Yl=Xl;function Xl(e,t,r,n,i){this.properties={},this.extent=r,this.type=0,this._pbf=e,this._geometry=-1,this._keys=n,this._values=i,e.readFields(Ql,this,t)}function Ql(e,t,r){1==e?t.id=r.readVarint():2==e?function(e,t){for(var r=e.readVarint()+e.pos;e.pos<r;){var n=t._keys[e.readVarint()],i=t._values[e.readVarint()];t.properties[n]=i}}(r,t):3==e?t.type=r.readVarint():4==e&&(t._geometry=r.pos)}function $l(e){for(var t,r,n=0,i=0,o=e.length,a=o-1;i<o;a=i++)n+=((r=e[a]).x-(t=e[i]).x)*(t.y+r.y);return n}Xl.types=["Unknown","Point","LineString","Polygon"],Xl.prototype.loadGeometry=function(){var e=this._pbf;e.pos=this._geometry;for(var t,r=e.readVarint()+e.pos,n=1,i=0,o=0,a=0,s=[];e.pos<r;){if(i<=0){var u=e.readVarint();n=7&u,i=u>>3}if(i--,1===n||2===n)o+=e.readSVarint(),a+=e.readSVarint(),1===n&&(t&&s.push(t),t=[]),t.push(new ql(o,a));else{if(7!==n)throw new Error("unknown command "+n);t&&t.push(t[0].clone())}}return t&&s.push(t),s},Xl.prototype.bbox=function(){var e=this._pbf;e.pos=this._geometry;for(var t=e.readVarint()+e.pos,r=1,n=0,i=0,o=0,a=1/0,s=-1/0,u=1/0,c=-1/0;e.pos<t;){if(n<=0){var l=e.readVarint();r=7&l,n=l>>3}if(n--,1===r||2===r)(i+=e.readSVarint())<a&&(a=i),i>s&&(s=i),(o+=e.readSVarint())<u&&(u=o),o>c&&(c=o);else if(7!==r)throw new Error("unknown command "+r)}return[a,u,s,c]},Xl.prototype.toGeoJSON=function(e,t,r){var n,i,o=this.extent*Math.pow(2,r),a=this.extent*e,s=this.extent*t,u=this.loadGeometry(),c=Xl.types[this.type];function l(e){for(var t=0;t<e.length;t++){var r=e[t];e[t]=[360*(r.x+a)/o-180,360/Math.PI*Math.atan(Math.exp((180-360*(r.y+s)/o)*Math.PI/180))-90]}}switch(this.type){case 1:var h=[];for(n=0;n<u.length;n++)h[n]=u[n][0];l(u=h);break;case 2:for(n=0;n<u.length;n++)l(u[n]);break;case 3:for(u=function(e){var t=e.length;if(t<=1)return[e];for(var r,n,i=[],o=0;o<t;o++){var a=$l(e[o]);0!==a&&(void 0===n&&(n=a<0),n===a<0?(r&&i.push(r),r=[e[o]]):r.push(e[o]))}return r&&i.push(r),i}(u),n=0;n<u.length;n++)for(i=0;i<u[n].length;i++)l(u[n][i])}1===u.length?u=u[0]:c="Multi"+c;var f={type:"Feature",geometry:{type:c,coordinates:u},properties:this.properties};return"id"in this&&(f.id=this.id),f};var Jl=Yl,eh=th;function th(e,t){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=e,this._keys=[],this._values=[],this._features=[],e.readFields(rh,this,t),this.length=this._features.length}function rh(e,t,r){15===e?t.version=r.readVarint():1===e?t.name=r.readString():5===e?t.extent=r.readVarint():2===e?t._features.push(r.pos):3===e?t._keys.push(r.readString()):4===e&&t._values.push(function(e){for(var t=null,r=e.readVarint()+e.pos;e.pos<r;){var n=e.readVarint()>>3;t=1===n?e.readString():2===n?e.readFloat():3===n?e.readDouble():4===n?e.readVarint64():5===n?e.readVarint():6===n?e.readSVarint():7===n?e.readBoolean():null}return t}(r))}th.prototype.feature=function(e){if(e<0||e>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[e];var t=this._pbf.readVarint()+this._pbf.pos;return new Jl(this._pbf,t,this.extent,this._keys,this._values)};var nh=eh;function ih(e,t,r){if(3===e){var n=new nh(r,r.readVarint()+r.pos);n.length&&(t[n.name]=n)}}var oh=Hl.VectorTile=function(e,t){this.layers=e.readFields(ih,{},t)},ah=Hl.VectorTileFeature=Yl;function sh(e,t,r,n){const i=[],o=0===n?(e,t,r,n,i,o)=>{e.push(new p(o,r+(o-t)/(n-t)*(i-r)))}:(e,t,r,n,i,o)=>{e.push(new p(t+(o-r)/(i-r)*(n-t),o))};for(const a of e){const e=[];for(const i of a){if(i.length<=2)continue;const a=[];for(let e=0;e<i.length-1;e++){const s=i[e].x,u=i[e].y,c=i[e+1].x,l=i[e+1].y,h=0===n?s:u,f=0===n?c:l;h<t?f>t&&o(a,s,u,c,l,t):h>r?f<r&&o(a,s,u,c,l,r):a.push(i[e]),f<t&&h>=t&&o(a,s,u,c,l,t),f>r&&h<=r&&o(a,s,u,c,l,r)}let s=i[i.length-1];const u=0===n?s.x:s.y;u>=t&&u<=r&&a.push(s),a.length&&(s=a[a.length-1],a[0].x===s.x&&a[0].y===s.y||a.push(a[0]),e.push(a))}e.length&&i.push(e)}return i}Hl.VectorTileLayer=eh;const uh=ah.types,ch=Math.pow(2,13);function lh(e,t,r,n,i,o,a,s){e.emplaceBack((t<<1)+a,(r<<1)+o,(Math.floor(n*ch)<<1)+i,Math.round(s))}function hh(e,t,r){const n=16384;e.emplaceBack(t.x,t.y,t.z,r[0]*n,r[1]*n,r[2]*n)}class fh{constructor(){this.acc=new p(0,0),this.polyCount=[]}startRing(e){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new p(e.x,e.y),this.max=new p(e.x,e.y))}append(e,t){this.currentPolyCount.edges++,this.acc._add(e);const r=this.min,n=this.max;e.x<r.x?r.x=e.x:e.x>n.x&&(n.x=e.x),e.y<r.y?r.y=e.y:e.y>n.y&&(n.y=e.y),((0===e.x||e.x===Es)&&e.x===t.x)!=((0===e.y||e.y===Es)&&e.y===t.y)&&this.processBorderOverlap(e,t),t.x<0!=e.x<0&&this.addBorderIntersection(0,Tr(t.y,e.y,(0-t.x)/(e.x-t.x))),t.x>Es!=e.x>Es&&this.addBorderIntersection(1,Tr(t.y,e.y,(Es-t.x)/(e.x-t.x))),t.y<0!=e.y<0&&this.addBorderIntersection(2,Tr(t.x,e.x,(0-t.y)/(e.y-t.y))),t.y>Es!=e.y>Es&&this.addBorderIntersection(3,Tr(t.x,e.x,(Es-t.y)/(e.y-t.y)))}addBorderIntersection(e,t){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const r=this.borders[e];t<r[0]&&(r[0]=t),t>r[1]&&(r[1]=t)}processBorderOverlap(e,t){if(e.x===t.x){if(e.y===t.y)return;const r=0===e.x?0:1;this.addBorderIntersection(r,t.y),this.addBorderIntersection(r,e.y)}else{const r=0===e.y?2:3;this.addBorderIntersection(r,t.x),this.addBorderIntersection(r,e.x)}}centroid(){const e=this.polyCount.reduce(((e,t)=>e+t.edges),0);return 0!==e?this.acc.div(e)._round():new p(0,0)}span(){return new p(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce(((e,t)=>e+ +(t[0]!==Number.MAX_VALUE)),0)}}class dh{constructor(e){this.zoom=e.zoom,this.canonical=e.canonical,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((e=>e.id)),this.index=e.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=e.projection,this.layoutVertexArray=new ua,this.centroidVertexArray=new Fa,this.indexArray=new wa,this.programConfigurations=new ps(e.layers,e.zoom),this.segments=new As,this.stateDependentLayerIds=this.layers.filter((e=>e.isStateDependent())).map((e=>e.id)),this.enableTerrain=e.enableTerrain}populate(e,t,r,n){this.features=[],this.hasPattern=Nl("fill-extrusion",this.layers,t),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(e){const t=Math.exp(Math.PI*(1-e.y/(1<<e.z)*2));return 80150034*t/(t*t+1)/Es/(1<<e.z)}(r),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:i,id:o,index:a,sourceLayerIndex:s}of e){const e=this.layers[0]._featureFilter.needGeometry,u=xc(i,e);if(!this.layers[0]._featureFilter.filter(new Fo(this.zoom),u,r))continue;const c={id:o,sourceLayerIndex:s,index:a,geometry:e?u.geometry:bc(i,r,n),properties:i.properties,type:i.type,patterns:{}},l=this.layoutVertexArray.length;this.hasPattern?this.features.push(Ul("fill-extrusion",this.layers,c,this.zoom,t)):this.addFeature(c,c.geometry,a,r,{},t.availableImages,n),t.featureIndex.insert(i,c.geometry,a,s,this.index,l)}this.sortBorders()}addFeatures(e,t,r,n,i){for(const o of this.features){const{geometry:e}=o;this.addFeature(o,e,o.index,t,r,n,i)}this.sortBorders()}update(e,t,r,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r,n)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Gl),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=e.createVertexBuffer(this.layoutVertexExtArray,Kl.members,!0))),this.programConfigurations.upload(e),this.uploaded=!0}uploadCentroid(e){0!==this.centroidVertexArray.length&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,Wl.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,t,r,n,i,o,a){const s=[new p(0,0),new p(Es,Es)],u=a.projection,c="globe"===u.name,l=this.enableTerrain&&!c?new fh:null,h="Polygon"===uh[e.type];c&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new da);const f=Ol(t,500);for(let p=f.length-1;p>=0;p--){const e=f[p];(0===e.length||(d=e[0]).every((e=>e.x<=0))||d.every((e=>e.x>=Es))||d.every((e=>e.y<=0))||d.every((e=>e.y>=Es)))&&f.splice(p,1)}var d;let m;if(c)m=xh(f,s,n);else{m=[];for(const e of f)m.push({polygon:e,bounds:s})}const g=h?this.edgeRadius:0;for(const{polygon:p,bounds:y}of m){let e=0,t=0;for(const n of p)h&&!n[0].equals(n[n.length-1])&&n.push(n[0]),t+=h?n.length-1:n.length;const r=this.segments.prepareSegment((h?5:4)*t,this.layoutVertexArray,this.indexArray);if(h){const t=[],i=[];e=r.vertexLength;for(const e of p){let o,a;e.length&&e!==p[0]&&i.push(t.length/2),o=e[1].sub(e[0])._perp()._unit();for(let i=1;i<e.length;i++){const s=e[i],l=e[i===e.length-1?1:i+1];let{x:h,y:f}=s;if(g){a=l.sub(s)._perp()._unit();const e=o.add(a)._unit(),t=g*Math.min(4,1/(o.x*e.x+o.y*e.y));h+=t*e.x,f+=t*e.y,o=a}lh(this.layoutVertexArray,h,f,0,0,1,1,0),r.vertexLength++,t.push(s.x,s.y),c&&hh(this.layoutVertexExtArray,u.projectTilePoint(h,f,n),u.upVector(n,h,f))}}const o=ol(t,i);for(let n=0;n<o.length;n+=3)this.indexArray.emplaceBack(e+o[n],e+o[n+2],e+o[n+1]),r.primitiveLength++}for(const i of p){l&&i.length&&l.startRing(i[0]);let t,o,a,s=i.length>4&&vh(i[i.length-2],i[0],i[1]),f=g?mh(i[i.length-2],i[0],i[1],g):0;o=i[1].sub(i[0])._perp()._unit();let d=!0;for(let p=1,m=0;p<i.length;p++){let v=i[p-1],_=i[p];const b=i[p===i.length-1?1:p+1];if(l&&h&&l.currentPolyCount.top++,yh(_,v,y)){g&&(o=b.sub(_)._perp()._unit(),d=!d);continue}l&&l.append(_,v);const x=_.sub(v)._perp(),w=x.x/(Math.abs(x.x)+Math.abs(x.y)),k=x.y>0?1:0,A=v.dist(_);if(m+A>32768&&(m=0),g){a=b.sub(_)._perp()._unit();let e=gh(v,_,b,ph(o,a),g);isNaN(e)&&(e=0);const t=_.sub(v)._unit();v=v.add(t.mult(f))._round(),_=_.add(t.mult(-e))._round(),f=e,o=a}const E=r.vertexLength,S=i.length>4&&vh(v,_,b);let T=_h(m,s,d);if(lh(this.layoutVertexArray,v.x,v.y,w,k,0,0,T),lh(this.layoutVertexArray,v.x,v.y,w,k,0,1,T),m+=A,T=_h(m,S,!d),s=S,lh(this.layoutVertexArray,_.x,_.y,w,k,0,0,T),lh(this.layoutVertexArray,_.x,_.y,w,k,0,1,T),r.vertexLength+=4,this.indexArray.emplaceBack(E+0,E+1,E+2),this.indexArray.emplaceBack(E+1,E+3,E+2),r.primitiveLength+=2,g){const n=e+(1===p?i.length-2:p-2),o=1===p?e:n+1;if(this.indexArray.emplaceBack(E+1,n,E+3),this.indexArray.emplaceBack(n,o,E+3),r.primitiveLength+=2,void 0===t&&(t=E),!yh(b,i[p],y)){const e=p===i.length-1?t:r.vertexLength;this.indexArray.emplaceBack(E+2,E+3,e),this.indexArray.emplaceBack(E+3,e+1,e),this.indexArray.emplaceBack(E+3,o,e+1),r.primitiveLength+=3}d=!d}if(c){const e=this.layoutVertexExtArray,t=u.projectTilePoint(v.x,v.y,n),r=u.projectTilePoint(_.x,_.y,n),i=u.upVector(n,v.x,v.y),o=u.upVector(n,_.x,_.y);hh(e,t,i),hh(e,t,i),hh(e,r,o),hh(e,r,o)}}h&&(e+=i.length-1)}}if(l&&l.polyCount.length>0){if(l.borders){l.vertexArrayOffset=this.centroidVertexArray.length;const e=l.borders,t=this.featuresOnBorder.push(l)-1;for(let r=0;r<4;r++)e[r][0]!==Number.MAX_VALUE&&this.borders[r].push(t)}this.encodeCentroid(l.borders?void 0:l.centroid(),l)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,i,o,n)}sortBorders(){for(let e=0;e<4;e++)this.borders[e].sort(((t,r)=>this.featuresOnBorder[t].borders[e][0]-this.featuresOnBorder[r].borders[e][0]))}encodeCentroid(e,t,r=!0){let n,i;if(e)if(0!==e.y){const r=t.span()._mult(this.tileToMeter);n=(Math.max(e.x,1)<<3)+Math.min(7,Math.round(r.x/10)),i=(Math.max(e.y,1)<<3)+Math.min(7,Math.round(r.y/10))}else n=Math.ceil(7*(e.x+450)),i=0;else n=0,i=+r;let o=r?this.centroidVertexArray.length:t.vertexArrayOffset;for(const a of t.polyCount){r&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*a.edges+a.top);for(let e=0;e<a.top;e++)this.centroidVertexArray.emplace(o++,n,i);for(let e=0;e<2*a.edges;e++)this.centroidVertexArray.emplace(o++,0,i),this.centroidVertexArray.emplace(o++,n,i)}}}function ph(e,t){const r=e.add(t)._unit();return e.x*r.x+e.y*r.y}function mh(e,t,r,n){const i=t.sub(e)._perp()._unit(),o=r.sub(t)._perp()._unit();return gh(e,t,r,ph(i,o),n)}function gh(e,t,r,n,i){const o=Math.sqrt(1-n*n);return Math.min(e.dist(t)/3,t.dist(r)/3,i*o/n)}function yh(e,t,r){return e.x<r[0].x&&t.x<r[0].x||e.x>r[1].x&&t.x>r[1].x||e.y<r[0].y&&t.y<r[0].y||e.y>r[1].y&&t.y>r[1].y}function vh(e,t,r){if(e.x<0||e.x>=Es||t.x<0||t.x>=Es||r.x<0||r.x>=Es)return!1;const n=r.sub(t),i=n.perp(),o=e.sub(t);return(n.x*o.x+n.y*o.y)/Math.sqrt((n.x*n.x+n.y*n.y)*(o.x*o.x+o.y*o.y))>-.866&&i.x*o.x+i.y*o.y<0}function _h(e,t,r){const n=t?2|e:-3&e;return r?1|n:-2&n}function bh(){const e=Math.PI/32,t=Math.tan(e),r=ec;return r*Math.sqrt(1+2*t*t)-r}function xh(e,t,r){const n=1<<r.z,i=sc(r.x/n),o=sc((r.x+1)/n),a=uc(r.y/n),s=uc((r.y+1)/n);return function(e,t,r,n,i=0,o){const a=[];if(!e.length||!r||!n)return a;const s=(e,t)=>{for(const r of e)a.push({polygon:r,bounds:t})},u=Math.ceil(Math.log2(r)),c=Math.ceil(Math.log2(n)),l=u-c,h=[];for(let p=0;p<Math.abs(l);p++)h.push(l>0?0:1);for(let p=0;p<Math.min(u,c);p++)h.push(0),h.push(1);let f=e;if(f=sh(f,t[0].y-i,t[1].y+i,1),f=sh(f,t[0].x-i,t[1].x+i,0),!f.length)return a;const d=[];for(h.length?d.push({polygons:f,bounds:t,depth:0}):s(f,t);d.length;){const e=d.pop(),t=e.depth,r=h[t],n=e.bounds[0],a=e.bounds[1],u=0===r?n.x:n.y,c=0===r?a.x:a.y,l=o?o(r,u,c):.5*(u+c),f=sh(e.polygons,u-i,l+i,r),m=sh(e.polygons,l-i,c+i,r);if(f.length){const e=[n,new p(0===r?l:a.x,1===r?l:a.y)];h.length>t+1?d.push({polygons:f,bounds:e,depth:t+1}):s(f,e)}if(m.length){const e=[new p(0===r?l:n.x,1===r?l:n.y),a];h.length>t+1?d.push({polygons:m,bounds:e,depth:t+1}):s(m,e)}}return a}(e,t,Math.ceil((o-i)/11.25),Math.ceil((a-s)/11.25),1,((e,t,i)=>{if(0===e)return.5*(t+i);{const e=uc((r.y+t/Es)/n);return(oc(.5*(uc((r.y+i/Es)/n)+e))*n-r.y)*Es}}))}ji(dh,"FillExtrusionBucket",{omit:["layers","features"]}),ji(fh,"PartMetadata");const wh=new Jo({"fill-extrusion-edge-radius":new Xo(Xe["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var kh={paint:new Jo({"fill-extrusion-opacity":new Xo(Xe["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Qo(Xe["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Xo(Xe["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Xo(Xe["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Qo(Xe["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Qo(Xe["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Qo(Xe["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Xo(Xe["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Xo(Xe["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Xo(Xe["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"])}),layout:wh};function Ah(e,t,r){var n=2*Math.PI*6378137/256/Math.pow(2,r);return[e*n-2*Math.PI*6378137/2,t*n-2*Math.PI*6378137/2]}class Eh{constructor(e,t,r){this.z=e,this.x=t,this.y=r,this.key=Mh(0,e,e,t,r)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,t){const r=function(e,t,r){var n=Ah(256*e,256*(t=Math.pow(2,r)-t-1),r),i=Ah(256*(e+1),256*(t+1),r);return n[0]+","+n[1]+","+i[0]+","+i[1]}(this.x,this.y,this.z),n=function(e,t,r){let n,i="";for(let o=e;o>0;o--)n=1<<o-1,i+=(t&n?1:0)+(r&n?2:0);return i}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===t?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",n).replace("{bbox-epsg-3857}",r)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Sh{constructor(e,t){this.wrap=e,this.canonical=t,this.key=Mh(e,t.z,t.z,t.x,t.y)}}class Th{constructor(e,t,r,n,i){this.overscaledZ=e,this.wrap=t,this.canonical=new Eh(r,+n,+i),this.key=0===t&&e===r?this.canonical.key:Mh(t,e,r,n,i)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){const t=this.canonical.z-e;return e>this.canonical.z?new Th(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Th(e,this.wrap,e,this.canonical.x>>t,this.canonical.y>>t)}calculateScaledKey(e,t=!0){if(this.overscaledZ===e&&t)return this.key;if(e>this.canonical.z)return Mh(this.wrap*+t,e,this.canonical.z,this.canonical.x,this.canonical.y);{const r=this.canonical.z-e;return Mh(this.wrap*+t,e,e,this.canonical.x>>r,this.canonical.y>>r)}}isChildOf(e){if(e.wrap!==this.wrap)return!1;const t=this.canonical.z-e.canonical.z;return 0===e.overscaledZ||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>t&&e.canonical.y===this.canonical.y>>t}children(e){if(this.overscaledZ>=e)return[new Th(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const t=this.canonical.z+1,r=2*this.canonical.x,n=2*this.canonical.y;return[new Th(t,this.wrap,t,r,n),new Th(t,this.wrap,t,r+1,n),new Th(t,this.wrap,t,r,n+1),new Th(t,this.wrap,t,r+1,n+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new Th(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new Th(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Sh(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Mh(e,t,r,n,i){const o=1<<Math.min(r,22);let a=o*(i%o)+n%o;return e&&r<22&&(a+=o*o*((e<0?-2*e-1:2*e)%(1<<2*(22-r)))),16*(32*a+r)+(t-r)}ji(Eh,"CanonicalTileID"),ji(Th,"OverscaledTileID",{omit:["projMatrix"]});class Ih extends p{constructor(e,t,r){super(e,t),this.z=r}}function Ph(e,t){return e.x*t.x+e.y*t.y}function Ch(e,t){if(1===e.length){let r=0;const n=t[r++];let i;for(;!i||n.equals(i);)if(i=t[r++],!i)return 1/0;for(;r<t.length;r++){const o=t[r],a=e[0],s=i.sub(n),u=o.sub(n),c=a.sub(n),l=Ph(s,s),h=Ph(s,u),f=Ph(u,u),d=Ph(c,s),p=Ph(c,u),m=l*f-h*h,g=(f*d-h*p)/m,y=(l*p-h*d)/m,v=n.z*(1-g-y)+i.z*g+o.z*y;if(isFinite(v))return v}return 1/0}{let e=1/0;for(const r of t)e=Math.min(e,r.z);return e}}function Bh(e,t,r,n,i,o,a,s){const u=a*i.getElevationAt(e,t,!0,!0),c=0!==o[0],l=c?0===o[1]?a*(o[0]/7-450):a*function(e,t,r){const n=Math.floor(t[0]/8),i=Math.floor(t[1]/8),o=10*(t[0]-8*n),a=10*(t[1]-8*i),s=e.getElevationAt(n,i,!0,!0),u=e.getMeterToDEM(r),c=Math.floor(.5*(o*u-1)),l=Math.floor(.5*(a*u-1)),h=e.tileCoordToPixel(n,i),f=2*c+1,d=2*l+1,p=function(e,t,r,n,i){return[e.getElevationAtPixel(t,r,!0),e.getElevationAtPixel(t+i,r,!0),e.getElevationAtPixel(t,r+i,!0),e.getElevationAtPixel(t+n,r+i,!0)]}(e,h.x-c,h.y-l,f,d),m=Math.abs(p[0]-p[1]),g=Math.abs(p[2]-p[3]),y=Math.abs(p[0]-p[2])+Math.abs(p[1]-p[3]),v=Math.min(.25,.5*u*(m+g)/f),_=Math.min(.25,.5*u*y/d);return s+Math.max(v*o,_*a)}(i,o,s):u;return{base:u+(0===r)?-1:r,top:c?Math.max(l+n,u+r+2):u+n}}const Dh=ia([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:Rh}=Dh,Lh=ia([{name:"a_packed",components:4,type:"Float32"}]),{members:Oh}=Lh,zh=ah.types,Nh=Math.cos(Math.PI/180*37.5);class Uh{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((e=>e.id)),this.index=e.index,this.projection=e.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((e=>{this.gradients[e.id]={}})),this.layoutVertexArray=new ca,this.layoutVertexArray2=new la,this.indexArray=new wa,this.programConfigurations=new ps(e.layers,e.zoom),this.segments=new As,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((e=>e.isStateDependent())).map((e=>e.id))}populate(e,t,r,n){this.hasPattern=Nl("line",this.layers,t);const i=this.layers[0].layout.get("line-sort-key"),o=[];for(const{feature:c,id:l,index:h,sourceLayerIndex:f}of e){const e=this.layers[0]._featureFilter.needGeometry,t=xc(c,e);if(!this.layers[0]._featureFilter.filter(new Fo(this.zoom),t,r))continue;const a=i?i.evaluate(t,{},r):void 0,s={id:l,properties:c.properties,type:c.type,sourceLayerIndex:f,index:h,geometry:e?t.geometry:bc(c,r,n),patterns:{},sortKey:a};o.push(s)}i&&o.sort(((e,t)=>e.sortKey-t.sortKey));const{lineAtlas:a,featureIndex:s}=t,u=this.addConstantDashes(a);for(const c of o){const{geometry:n,index:i,sourceLayerIndex:o}=c;if(u&&this.addFeatureDashes(c,a),this.hasPattern){const e=Ul("line",this.layers,c,this.zoom,t);this.patternFeatures.push(e)}else this.addFeature(c,n,i,r,a.positions,t.availableImages);s.insert(e[i].feature,n,i,o,this.index)}}addConstantDashes(e){let t=!1;for(const r of this.layers){const n=r.paint.get("line-dasharray").value,i=r.layout.get("line-cap").value;if("constant"!==n.kind||"constant"!==i.kind)t=!0;else{const t=i.value,r=n.value;if(!r)continue;e.addDash(r,t)}}return t}addFeatureDashes(e,t){const r=this.zoom;for(const n of this.layers){const i=n.paint.get("line-dasharray").value,o=n.layout.get("line-cap").value;if("constant"===i.kind&&"constant"===o.kind)continue;let a,s;if("constant"===i.kind){if(a=i.value,!a)continue}else a=i.evaluate({zoom:r},e);s="constant"===o.kind?o.value:o.evaluate({zoom:r},e),t.addDash(a,s),e.patterns[n.id]=t.getKey(a,s)}}update(e,t,r,n){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,t,this.stateDependentLayers,r,n)}addFeatures(e,t,r,n,i){for(const o of this.patternFeatures)this.addFeature(o,o.geometry,o.index,t,r,n)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,Oh)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Rh),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,t,r,n,i,o){const a=this.layers[0].layout,s=a.get("line-join").evaluate(e,{}),u=a.get("line-cap").evaluate(e,{}),c=a.get("line-miter-limit"),l=a.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const h of t)this.addLine(h,e,s,u,c,l);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,r,i,o,n)}addLine(e,t,r,n,i,o){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let t=0;t<e.length-1;t++)this.totalDistance+=e[t].dist(e[t+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const a="Polygon"===zh[t.type];let s=e.length;for(;s>=2&&e[s-1].equals(e[s-2]);)s--;let u=0;for(;u<s-1&&e[u].equals(e[u+1]);)u++;if(s<(a?3:2))return;"bevel"===r&&(i=1.05);const c=this.overscaling<=16?122880/(512*this.overscaling):0,l=this.segments.prepareSegment(10*s,this.layoutVertexArray,this.indexArray);let h,f,d,p,m;this.e1=this.e2=-1,a&&(h=e[s-2],m=e[u].sub(h)._unit()._perp());for(let g=u;g<s;g++){if(d=g===s-1?a?e[u+1]:void 0:e[g+1],d&&e[g].equals(d))continue;m&&(p=m),h&&(f=h),h=e[g],m=d?d.sub(h)._unit()._perp():p,p=p||m;let t=p.add(m);0===t.x&&0===t.y||t._unit();const y=p.x*m.x+p.y*m.y,v=t.x*m.x+t.y*m.y,_=0!==v?1/v:1/0,b=2*Math.sqrt(2-2*v),x=v<Nh&&f&&d,w=p.x*m.y-p.y*m.x>0;if(x&&g>u){const e=h.dist(f);if(e>2*c){const t=h.sub(h.sub(f)._mult(c/e)._round());this.updateDistance(f,t),this.addCurrentVertex(t,p,0,0,l),f=t}}const k=f&&d;let A=k?r:a?"butt":n;if(k&&"round"===A&&(_<o?A="miter":_<=2&&(A="fakeround")),"miter"===A&&_>i&&(A="bevel"),"bevel"===A&&(_>2&&(A="flipbevel"),_<i&&(A="miter")),f&&this.updateDistance(f,h),"miter"===A)t._mult(_),this.addCurrentVertex(h,t,0,0,l);else if("flipbevel"===A){if(_>100)t=m.mult(-1);else{const e=_*p.add(m).mag()/p.sub(m).mag();t._perp()._mult(e*(w?-1:1))}this.addCurrentVertex(h,t,0,0,l),this.addCurrentVertex(h,t.mult(-1),0,0,l)}else if("bevel"===A||"fakeround"===A){const e=-Math.sqrt(_*_-1),t=w?e:0,r=w?0:e;if(f&&this.addCurrentVertex(h,p,t,r,l),"fakeround"===A){const e=Math.round(180*b/Math.PI/20);for(let t=1;t<e;t++){let r=t/e;if(.5!==r){const e=r-.5;r+=r*e*(r-1)*((1.0904+y*(y*(3.55645-1.43519*y)-3.2452))*e*e+(.848013+y*(.215638*y-1.06021)))}const n=m.sub(p)._mult(r)._add(p)._unit()._mult(w?-1:1);this.addHalfVertex(h,n.x,n.y,!1,w,0,l)}}d&&this.addCurrentVertex(h,m,-t,-r,l)}else if("butt"===A)this.addCurrentVertex(h,t,0,0,l);else if("square"===A){const e=f?1:-1;f||this.addCurrentVertex(h,t,e,e,l),this.addCurrentVertex(h,t,0,0,l),f&&this.addCurrentVertex(h,t,e,e,l)}else"round"===A&&(f&&(this.addCurrentVertex(h,p,0,0,l),this.addCurrentVertex(h,p,1,1,l,!0)),d&&(this.addCurrentVertex(h,m,-1,-1,l,!0),this.addCurrentVertex(h,m,0,0,l)));if(x&&g<s-1){const e=h.dist(d);if(e>2*c){const t=h.add(d.sub(h)._mult(c/e)._round());this.updateDistance(h,t),this.addCurrentVertex(t,m,0,0,l),h=t}}}}addCurrentVertex(e,t,r,n,i,o=!1){const a=t.y*n-t.x,s=-t.y-t.x*n;this.addHalfVertex(e,t.x+t.y*r,t.y-t.x*r,o,!1,r,i),this.addHalfVertex(e,a,s,o,!0,-n,i)}addHalfVertex({x:e,y:t},r,n,i,o,a,s){this.layoutVertexArray.emplaceBack((e<<1)+(i?1:0),(t<<1)+(o?1:0),Math.round(63*r)+128,Math.round(63*n)+128,1+(0===a?0:a<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const u=s.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,u),s.primitiveLength++),o?this.e2=u:this.e1=u}updateScaledDistance(){if(this.lineClips){const e=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=e*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(e,t){this.distance+=e.dist(t),this.updateScaledDistance()}}ji(Uh,"LineBucket",{omit:["layers","patternFeatures"]});const Zh=new Jo({"line-cap":new Qo(Xe.layout_line["line-cap"]),"line-join":new Qo(Xe.layout_line["line-join"]),"line-miter-limit":new Xo(Xe.layout_line["line-miter-limit"]),"line-round-limit":new Xo(Xe.layout_line["line-round-limit"]),"line-sort-key":new Qo(Xe.layout_line["line-sort-key"])});var Fh={paint:new Jo({"line-opacity":new Qo(Xe.paint_line["line-opacity"]),"line-color":new Qo(Xe.paint_line["line-color"]),"line-translate":new Xo(Xe.paint_line["line-translate"]),"line-translate-anchor":new Xo(Xe.paint_line["line-translate-anchor"]),"line-width":new Qo(Xe.paint_line["line-width"]),"line-gap-width":new Qo(Xe.paint_line["line-gap-width"]),"line-offset":new Qo(Xe.paint_line["line-offset"]),"line-blur":new Qo(Xe.paint_line["line-blur"]),"line-dasharray":new Qo(Xe.paint_line["line-dasharray"]),"line-pattern":new Qo(Xe.paint_line["line-pattern"]),"line-gradient":new $o(Xe.paint_line["line-gradient"]),"line-trim-offset":new Xo(Xe.paint_line["line-trim-offset"])}),layout:Zh};const jh=new class extends Qo{possiblyEvaluate(e,t){return t=new Fo(Math.floor(t.zoom),{now:t.now,fadeDuration:t.fadeDuration,transition:t.transition}),super.possiblyEvaluate(e,t)}evaluate(e,t,r,n){return t=I({},t,{zoom:Math.floor(t.zoom)}),super.evaluate(e,t,r,n)}}(Fh.paint.properties["line-width"].specification);function Vh(e,t){return t>0?t+2*e:e}jh.useIntegerZoom=!0;const Wh=ia([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Kh=ia([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),Gh=ia([{name:"a_projected_pos",components:4,type:"Float32"}],4);ia([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Hh=ia([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),qh=ia([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);ia([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Yh=ia([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Xh=ia([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);ia([{name:"triangle",components:3,type:"Uint16"}]),ia([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),ia([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),ia([{type:"Float32",name:"offsetX"}]),ia([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var Qh=24;const $h=128;function Jh(e,t){const{expression:r}=t;if("constant"===r.kind)return{kind:"constant",layoutSize:r.evaluate(new Fo(e+1))};if("source"===r.kind)return{kind:"source"};{const{zoomStops:t,interpolationType:n}=r;let i=0;for(;i<t.length&&t[i]<=e;)i++;i=Math.max(0,i-1);let o=i;for(;o<t.length&&t[o]<e+1;)o++;o=Math.min(t.length-1,o);const a=t[i],s=t[o];return"composite"===r.kind?{kind:"composite",minZoom:a,maxZoom:s,interpolationType:n}:{kind:"camera",minZoom:a,maxZoom:s,minSize:r.evaluate(new Fo(a)),maxSize:r.evaluate(new Fo(s)),interpolationType:n}}}function ef(e,{uSize:t,uSizeT:r},{lowerSize:n,upperSize:i}){return"source"===e.kind?n/$h:"composite"===e.kind?Tr(n/$h,i/$h,r):t}function tf(e,t){let r=0,n=0;if("constant"===e.kind)n=e.layoutSize;else if("source"!==e.kind){const{interpolationType:i,minZoom:o,maxZoom:a}=e,s=i?A(qr.interpolationFactor(i,t,o,a),0,1):0;"camera"===e.kind?n=Tr(e.minSize,e.maxSize,s):r=s}return{uSizeT:r,uSize:n}}var rf=Object.freeze({__proto__:null,getSizeData:Jh,evaluateSizeForFeature:ef,evaluateSizeForZoom:tf,SIZE_PACK_FACTOR:$h});function nf(e,t,r){return e.sections.forEach((e=>{e.text=function(e,t,r){const n=t.layout.get("text-transform").evaluate(r,{});return"uppercase"===n?e=e.toLocaleUpperCase():"lowercase"===n&&(e=e.toLocaleLowerCase()),Zo.applyArabicShaping&&(e=Zo.applyArabicShaping(e)),e}(e.text,t,r)})),e}const of={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"};function af(e){return"\ufe36"===e||"\ufe48"===e||"\ufe38"===e||"\ufe44"===e||"\ufe42"===e||"\ufe3e"===e||"\ufe3c"===e||"\ufe3a"===e||"\ufe18"===e||"\ufe40"===e||"\ufe10"===e||"\ufe13"===e||"\ufe14"===e||"\uff40"===e||"\uffe3"===e||"\ufe11"===e||"\ufe12"===e}function sf(e){return"\ufe35"===e||"\ufe47"===e||"\ufe37"===e||"\ufe43"===e||"\ufe41"===e||"\ufe3d"===e||"\ufe3b"===e||"\ufe39"===e||"\ufe17"===e||"\ufe3f"===e}var uf=hf,cf=function(e,t,r,n,i){var o,a,s=8*i-n-1,u=(1<<s)-1,c=u>>1,l=-7,h=r?i-1:0,f=r?-1:1,d=e[t+h];for(h+=f,o=d&(1<<-l)-1,d>>=-l,l+=s;l>0;o=256*o+e[t+h],h+=f,l-=8);for(a=o&(1<<-l)-1,o>>=-l,l+=n;l>0;a=256*a+e[t+h],h+=f,l-=8);if(0===o)o=1-c;else{if(o===u)return a?NaN:1/0*(d?-1:1);a+=Math.pow(2,n),o-=c}return(d?-1:1)*a*Math.pow(2,o-n)},lf=function(e,t,r,n,i,o){var a,s,u,c=8*o-i-1,l=(1<<c)-1,h=l>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=n?0:o-1,p=n?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=l):(a=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-a))<1&&(a--,u*=2),(t+=a+h>=1?f/u:f*Math.pow(2,1-h))*u>=2&&(a++,u/=2),a+h>=l?(s=0,a=l):a+h>=1?(s=(t*u-1)*Math.pow(2,i),a+=h):(s=t*Math.pow(2,h-1)*Math.pow(2,i),a=0));i>=8;e[r+d]=255&s,d+=p,s/=256,i-=8);for(a=a<<i|s,c+=i;c>0;e[r+d]=255&a,d+=p,a/=256,c-=8);e[r+d-p]|=128*m};function hf(e){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(e)?e:new Uint8Array(e||0),this.pos=0,this.type=0,this.length=this.buf.length}hf.Varint=0,hf.Fixed64=1,hf.Bytes=2,hf.Fixed32=5;var ff=4294967296,df=1/ff,pf="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function mf(e){return e.type===hf.Bytes?e.readVarint()+e.pos:e.pos+1}function gf(e,t,r){return r?4294967296*t+(e>>>0):4294967296*(t>>>0)+(e>>>0)}function yf(e,t,r){var n=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(7*Math.LN2));r.realloc(n);for(var i=r.pos-1;i>=e;i--)r.buf[i+n]=r.buf[i]}function vf(e,t){for(var r=0;r<e.length;r++)t.writeVarint(e[r])}function _f(e,t){for(var r=0;r<e.length;r++)t.writeSVarint(e[r])}function bf(e,t){for(var r=0;r<e.length;r++)t.writeFloat(e[r])}function xf(e,t){for(var r=0;r<e.length;r++)t.writeDouble(e[r])}function wf(e,t){for(var r=0;r<e.length;r++)t.writeBoolean(e[r])}function kf(e,t){for(var r=0;r<e.length;r++)t.writeFixed32(e[r])}function Af(e,t){for(var r=0;r<e.length;r++)t.writeSFixed32(e[r])}function Ef(e,t){for(var r=0;r<e.length;r++)t.writeFixed64(e[r])}function Sf(e,t){for(var r=0;r<e.length;r++)t.writeSFixed64(e[r])}function Tf(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+16777216*e[t+3]}function Mf(e,t,r){e[r]=t,e[r+1]=t>>>8,e[r+2]=t>>>16,e[r+3]=t>>>24}function If(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16)+(e[t+3]<<24)}function Pf(e,t,r){t.glyphs=[],1===e&&r.readMessage(Cf,t)}function Cf(e,t,r){if(3===e){const{id:e,bitmap:n,width:i,height:o,left:a,top:s,advance:u}=r.readMessage(Bf,{});t.glyphs.push({id:e,bitmap:new $c({width:i+6,height:o+6},n),metrics:{width:i,height:o,left:a,top:s,advance:u}})}else 4===e?t.ascender=r.readSVarint():5===e&&(t.descender=r.readSVarint())}function Bf(e,t,r){1===e?t.id=r.readVarint():2===e?t.bitmap=r.readBytes():3===e?t.width=r.readVarint():4===e?t.height=r.readVarint():5===e?t.left=r.readSVarint():6===e?t.top=r.readSVarint():7===e&&(t.advance=r.readVarint())}function Df(e){let t=0,r=0;for(const a of e)t+=a.w*a.h,r=Math.max(r,a.w);e.sort(((e,t)=>t.h-e.h));const n=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),r),h:1/0}];let i=0,o=0;for(const a of e)for(let e=n.length-1;e>=0;e--){const t=n[e];if(!(a.w>t.w||a.h>t.h)){if(a.x=t.x,a.y=t.y,o=Math.max(o,a.y+a.h),i=Math.max(i,a.x+a.w),a.w===t.w&&a.h===t.h){const t=n.pop();e<n.length&&(n[e]=t)}else a.h===t.h?(t.x+=a.w,t.w-=a.w):a.w===t.w?(t.y+=a.h,t.h-=a.h):(n.push({x:t.x+a.w,y:t.y,w:t.w-a.w,h:a.h}),t.y+=a.h,t.h-=a.h);break}}return{w:i,h:o,fill:t/(i*o)||0}}hf.prototype={destroy:function(){this.buf=null},readFields:function(e,t,r){for(r=r||this.length;this.pos<r;){var n=this.readVarint(),i=n>>3,o=this.pos;this.type=7&n,e(i,t,this),this.pos===o&&this.skip(n)}return t},readMessage:function(e,t){return this.readFields(e,t,this.readVarint()+this.pos)},readFixed32:function(){var e=Tf(this.buf,this.pos);return this.pos+=4,e},readSFixed32:function(){var e=If(this.buf,this.pos);return this.pos+=4,e},readFixed64:function(){var e=Tf(this.buf,this.pos)+Tf(this.buf,this.pos+4)*ff;return this.pos+=8,e},readSFixed64:function(){var e=Tf(this.buf,this.pos)+If(this.buf,this.pos+4)*ff;return this.pos+=8,e},readFloat:function(){var e=cf(this.buf,this.pos,!0,23,4);return this.pos+=4,e},readDouble:function(){var e=cf(this.buf,this.pos,!0,52,8);return this.pos+=8,e},readVarint:function(e){var t,r,n=this.buf;return t=127&(r=n[this.pos++]),r<128?t:(t|=(127&(r=n[this.pos++]))<<7,r<128?t:(t|=(127&(r=n[this.pos++]))<<14,r<128?t:(t|=(127&(r=n[this.pos++]))<<21,r<128?t:function(e,t,r){var n,i,o=r.buf;if(n=(112&(i=o[r.pos++]))>>4,i<128)return gf(e,n,t);if(n|=(127&(i=o[r.pos++]))<<3,i<128)return gf(e,n,t);if(n|=(127&(i=o[r.pos++]))<<10,i<128)return gf(e,n,t);if(n|=(127&(i=o[r.pos++]))<<17,i<128)return gf(e,n,t);if(n|=(127&(i=o[r.pos++]))<<24,i<128)return gf(e,n,t);if(n|=(1&(i=o[r.pos++]))<<31,i<128)return gf(e,n,t);throw new Error("Expected varint not more than 10 bytes")}(t|=(15&(r=n[this.pos]))<<28,e,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var e=this.readVarint();return e%2==1?(e+1)/-2:e/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var e=this.readVarint()+this.pos,t=this.pos;return this.pos=e,e-t>=12&&pf?function(e,t,r){return pf.decode(e.subarray(t,r))}(this.buf,t,e):function(e,t,r){for(var n="",i=t;i<r;){var o,a,s,u=e[i],c=null,l=u>239?4:u>223?3:u>191?2:1;if(i+l>r)break;1===l?u<128&&(c=u):2===l?128==(192&(o=e[i+1]))&&(c=(31&u)<<6|63&o)<=127&&(c=null):3===l?(a=e[i+2],128==(192&(o=e[i+1]))&&128==(192&a)&&((c=(15&u)<<12|(63&o)<<6|63&a)<=2047||c>=55296&&c<=57343)&&(c=null)):4===l&&(a=e[i+2],s=e[i+3],128==(192&(o=e[i+1]))&&128==(192&a)&&128==(192&s)&&((c=(15&u)<<18|(63&o)<<12|(63&a)<<6|63&s)<=65535||c>=1114112)&&(c=null)),null===c?(c=65533,l=1):c>65535&&(c-=65536,n+=String.fromCharCode(c>>>10&1023|55296),c=56320|1023&c),n+=String.fromCharCode(c),i+=l}return n}(this.buf,t,e)},readBytes:function(){var e=this.readVarint()+this.pos,t=this.buf.subarray(this.pos,e);return this.pos=e,t},readPackedVarint:function(e,t){if(this.type!==hf.Bytes)return e.push(this.readVarint(t));var r=mf(this);for(e=e||[];this.pos<r;)e.push(this.readVarint(t));return e},readPackedSVarint:function(e){if(this.type!==hf.Bytes)return e.push(this.readSVarint());var t=mf(this);for(e=e||[];this.pos<t;)e.push(this.readSVarint());return e},readPackedBoolean:function(e){if(this.type!==hf.Bytes)return e.push(this.readBoolean());var t=mf(this);for(e=e||[];this.pos<t;)e.push(this.readBoolean());return e},readPackedFloat:function(e){if(this.type!==hf.Bytes)return e.push(this.readFloat());var t=mf(this);for(e=e||[];this.pos<t;)e.push(this.readFloat());return e},readPackedDouble:function(e){if(this.type!==hf.Bytes)return e.push(this.readDouble());var t=mf(this);for(e=e||[];this.pos<t;)e.push(this.readDouble());return e},readPackedFixed32:function(e){if(this.type!==hf.Bytes)return e.push(this.readFixed32());var t=mf(this);for(e=e||[];this.pos<t;)e.push(this.readFixed32());return e},readPackedSFixed32:function(e){if(this.type!==hf.Bytes)return e.push(this.readSFixed32());var t=mf(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed32());return e},readPackedFixed64:function(e){if(this.type!==hf.Bytes)return e.push(this.readFixed64());var t=mf(this);for(e=e||[];this.pos<t;)e.push(this.readFixed64());return e},readPackedSFixed64:function(e){if(this.type!==hf.Bytes)return e.push(this.readSFixed64());var t=mf(this);for(e=e||[];this.pos<t;)e.push(this.readSFixed64());return e},skip:function(e){var t=7&e;if(t===hf.Varint)for(;this.buf[this.pos++]>127;);else if(t===hf.Bytes)this.pos=this.readVarint()+this.pos;else if(t===hf.Fixed32)this.pos+=4;else{if(t!==hf.Fixed64)throw new Error("Unimplemented type: "+t);this.pos+=8}},writeTag:function(e,t){this.writeVarint(e<<3|t)},realloc:function(e){for(var t=this.length||16;t<this.pos+e;)t*=2;if(t!==this.length){var r=new Uint8Array(t);r.set(this.buf),this.buf=r,this.length=t}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(e){this.realloc(4),Mf(this.buf,e,this.pos),this.pos+=4},writeSFixed32:function(e){this.realloc(4),Mf(this.buf,e,this.pos),this.pos+=4},writeFixed64:function(e){this.realloc(8),Mf(this.buf,-1&e,this.pos),Mf(this.buf,Math.floor(e*df),this.pos+4),this.pos+=8},writeSFixed64:function(e){this.realloc(8),Mf(this.buf,-1&e,this.pos),Mf(this.buf,Math.floor(e*df),this.pos+4),this.pos+=8},writeVarint:function(e){(e=+e||0)>268435455||e<0?function(e,t){var r,n;if(e>=0?(r=e%4294967296|0,n=e/4294967296|0):(n=~(-e/4294967296),4294967295^(r=~(-e%4294967296))?r=r+1|0:(r=0,n=n+1|0)),e>=0x10000000000000000||e<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");t.realloc(10),function(e,t,r){r.buf[r.pos++]=127&e|128,e>>>=7,r.buf[r.pos++]=127&e|128,e>>>=7,r.buf[r.pos++]=127&e|128,e>>>=7,r.buf[r.pos++]=127&e|128,r.buf[r.pos]=127&(e>>>=7)}(r,0,t),function(e,t){var r=(7&e)<<4;t.buf[t.pos++]|=r|((e>>>=3)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e|((e>>>=7)?128:0),e&&(t.buf[t.pos++]=127&e)))))}(n,t)}(e,this):(this.realloc(4),this.buf[this.pos++]=127&e|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=127&(e>>>=7)|(e>127?128:0),e<=127||(this.buf[this.pos++]=e>>>7&127))))},writeSVarint:function(e){this.writeVarint(e<0?2*-e-1:2*e)},writeBoolean:function(e){this.writeVarint(Boolean(e))},writeString:function(e){e=String(e),this.realloc(4*e.length),this.pos++;var t=this.pos;this.pos=function(e,t,r){for(var n,i,o=0;o<t.length;o++){if((n=t.charCodeAt(o))>55295&&n<57344){if(!i){n>56319||o+1===t.length?(e[r++]=239,e[r++]=191,e[r++]=189):i=n;continue}if(n<56320){e[r++]=239,e[r++]=191,e[r++]=189,i=n;continue}n=i-55296<<10|n-56320|65536,i=null}else i&&(e[r++]=239,e[r++]=191,e[r++]=189,i=null);n<128?e[r++]=n:(n<2048?e[r++]=n>>6|192:(n<65536?e[r++]=n>>12|224:(e[r++]=n>>18|240,e[r++]=n>>12&63|128),e[r++]=n>>6&63|128),e[r++]=63&n|128)}return r}(this.buf,e,this.pos);var r=this.pos-t;r>=128&&yf(t,r,this),this.pos=t-1,this.writeVarint(r),this.pos+=r},writeFloat:function(e){this.realloc(4),lf(this.buf,e,this.pos,!0,23,4),this.pos+=4},writeDouble:function(e){this.realloc(8),lf(this.buf,e,this.pos,!0,52,8),this.pos+=8},writeBytes:function(e){var t=e.length;this.writeVarint(t),this.realloc(t);for(var r=0;r<t;r++)this.buf[this.pos++]=e[r]},writeRawMessage:function(e,t){this.pos++;var r=this.pos;e(t,this);var n=this.pos-r;n>=128&&yf(r,n,this),this.pos=r-1,this.writeVarint(n),this.pos+=n},writeMessage:function(e,t,r){this.writeTag(e,hf.Bytes),this.writeRawMessage(t,r)},writePackedVarint:function(e,t){t.length&&this.writeMessage(e,vf,t)},writePackedSVarint:function(e,t){t.length&&this.writeMessage(e,_f,t)},writePackedBoolean:function(e,t){t.length&&this.writeMessage(e,wf,t)},writePackedFloat:function(e,t){t.length&&this.writeMessage(e,bf,t)},writePackedDouble:function(e,t){t.length&&this.writeMessage(e,xf,t)},writePackedFixed32:function(e,t){t.length&&this.writeMessage(e,kf,t)},writePackedSFixed32:function(e,t){t.length&&this.writeMessage(e,Af,t)},writePackedFixed64:function(e,t){t.length&&this.writeMessage(e,Ef,t)},writePackedSFixed64:function(e,t){t.length&&this.writeMessage(e,Sf,t)},writeBytesField:function(e,t){this.writeTag(e,hf.Bytes),this.writeBytes(t)},writeFixed32Field:function(e,t){this.writeTag(e,hf.Fixed32),this.writeFixed32(t)},writeSFixed32Field:function(e,t){this.writeTag(e,hf.Fixed32),this.writeSFixed32(t)},writeFixed64Field:function(e,t){this.writeTag(e,hf.Fixed64),this.writeFixed64(t)},writeSFixed64Field:function(e,t){this.writeTag(e,hf.Fixed64),this.writeSFixed64(t)},writeVarintField:function(e,t){this.writeTag(e,hf.Varint),this.writeVarint(t)},writeSVarintField:function(e,t){this.writeTag(e,hf.Varint),this.writeSVarint(t)},writeStringField:function(e,t){this.writeTag(e,hf.Bytes),this.writeString(t)},writeFloatField:function(e,t){this.writeTag(e,hf.Fixed32),this.writeFloat(t)},writeDoubleField:function(e,t){this.writeTag(e,hf.Fixed64),this.writeDouble(t)},writeBooleanField:function(e,t){this.writeVarintField(e,Boolean(t))}};class Rf{constructor(e,{pixelRatio:t,version:r,stretchX:n,stretchY:i,content:o}){this.paddedRect=e,this.pixelRatio=t,this.stretchX=n,this.stretchY=i,this.content=o,this.version=r}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class Lf{constructor(e,t){const r={},n={};this.haveRenderCallbacks=[];const i=[];this.addImages(e,r,i),this.addImages(t,n,i);const{w:o,h:a}=Df(i),s=new Jc({width:o||1,height:a||1});for(const u in e){const t=e[u],n=r[u].paddedRect;Jc.copy(t.data,s,{x:0,y:0},{x:n.x+1,y:n.y+1},t.data)}for(const u in t){const e=t[u],r=n[u].paddedRect,i=r.x+1,o=r.y+1,a=e.data.width,c=e.data.height;Jc.copy(e.data,s,{x:0,y:0},{x:i,y:o},e.data),Jc.copy(e.data,s,{x:0,y:c-1},{x:i,y:o-1},{width:a,height:1}),Jc.copy(e.data,s,{x:0,y:0},{x:i,y:o+c},{width:a,height:1}),Jc.copy(e.data,s,{x:a-1,y:0},{x:i-1,y:o},{width:1,height:c}),Jc.copy(e.data,s,{x:0,y:0},{x:i+a,y:o},{width:1,height:c})}this.image=s,this.iconPositions=r,this.patternPositions=n}addImages(e,t,r){for(const n in e){const i=e[n],o={x:0,y:0,w:i.data.width+2,h:i.data.height+2};r.push(o),t[n]=new Rf(o,i),i.hasRenderCallback&&this.haveRenderCallbacks.push(n)}}patchUpdatedImages(e,t){this.haveRenderCallbacks=this.haveRenderCallbacks.filter((t=>e.hasImage(t))),e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const r in e.updatedImages)this.patchUpdatedImage(this.iconPositions[r],e.getImage(r),t),this.patchUpdatedImage(this.patternPositions[r],e.getImage(r),t)}patchUpdatedImage(e,t,r){if(!e||!t)return;if(e.version===t.version)return;e.version=t.version;const[n,i]=e.tl;r.update(t.data,void 0,{x:n,y:i})}}ji(Rf,"ImagePosition"),ji(Lf,"ImageAtlas");const Of={horizontal:1,vertical:2,horizontalOnly:3};class zf{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,t){const r=new zf;return r.scale=e||1,r.fontStack=t,r}static forImage(e){const t=new zf;return t.imageName=e,t}}class Nf{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,t){const r=new Nf;for(let n=0;n<e.sections.length;n++){const i=e.sections[n];i.image?r.addImageSection(i):r.addTextSection(i,t)}return r}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSections(){return this.sections}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(e){this.text=function(e,t){let r="";for(let n=0;n<e.length;n++){const i=e.charCodeAt(n+1)||null,o=e.charCodeAt(n-1)||null;r+=!t&&(i&&Eo(i)&&!of[e[n+1]]||o&&Eo(o)&&!of[e[n-1]])||!of[e[n]]?e[n]:of[e[n]]}return r}(this.text,e)}trim(){let e=0;for(let r=0;r<this.text.length&&Zf[this.text.charCodeAt(r)];r++)e++;let t=this.text.length;for(let r=this.text.length-1;r>=0&&r>=e&&Zf[this.text.charCodeAt(r)];r--)t--;this.text=this.text.substring(e,t),this.sectionIndex=this.sectionIndex.slice(e,t)}substring(e,t){const r=new Nf;return r.text=this.text.substring(e,t),r.sectionIndex=this.sectionIndex.slice(e,t),r.sections=this.sections,r}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((e,t)=>Math.max(e,this.sections[t].scale)),0)}addTextSection(e,t){this.text+=e.text,this.sections.push(zf.forText(e.scale,e.fontStack||t));const r=this.sections.length-1;for(let n=0;n<e.text.length;++n)this.sectionIndex.push(r)}addImageSection(e){const t=e.image?e.image.name:"";if(0===t.length)return void F("Can't add FormattedSection with an empty image.");const r=this.getNextImageSectionCharCode();r?(this.text+=String.fromCharCode(r),this.sections.push(zf.forImage(t)),this.sectionIndex.push(this.sections.length-1)):F("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Uf(e,t,r,n,i,o,a,s,u,c,l,h,f,d,p){const m=Nf.fromFeature(e,i);h===Of.vertical&&m.verticalizePunctuation(f);let g=[];const y=function(e,t,r,n,i,o){if(!e)return[];const a=[],s=function(e,t,r,n,i,o){let a=0;for(let s=0;s<e.length();s++){const r=e.getSection(s);a+=jf(e.getCharCode(s),r,n,i,t,o)}return a/Math.max(1,Math.ceil(a/r))}(e,t,r,n,i,o),u=e.text.indexOf("\u200b")>=0;let c=0;for(let h=0;h<e.length();h++){const r=e.getSection(h),f=e.getCharCode(h);if(Zf[f]||(c+=jf(f,r,n,i,t,o)),h<e.length()-1){const t=!((l=f)<11904||!(no(l)||ro(l)||yo(l)||po(l)||so(l)||Xi(l)||io(l)||Ji(l)||uo(l)||co(l)||ao(l)||bo(l)||eo(l)||$i(l)||Qi(l)||oo(l)||to(l)||go(l)||ho(l)||lo(l)));(Ff[f]||t||r.imageName)&&a.push(Kf(h+1,c,s,a,Wf(f,e.getCharCode(h+1),t&&u),!1))}}var l;return Gf(Kf(e.length(),c,s,a,0,!0))}(m,c,o,t,n,d),{processBidirectionalText:v,processStyledBidirectionalText:_}=Zo;if(v&&1===m.sections.length){const e=v(m.toString(),y);for(const t of e){const e=new Nf;e.text=t,e.sections=m.sections;for(let r=0;r<t.length;r++)e.sectionIndex.push(0);g.push(e)}}else if(_){const e=_(m.text,m.sectionIndex,y);for(const t of e){const e=new Nf;e.text=t[0],e.sectionIndex=t[1],e.sections=m.sections,g.push(e)}}else g=function(e,t){const r=[],n=e.text;let i=0;for(const o of t)r.push(e.substring(i,o)),i=o;return i<n.length&&r.push(e.substring(i,n.length)),r}(m,y);const b=[],x={positionedLines:b,text:m.toString(),top:l[1],bottom:l[1],left:l[0],right:l[0],writingMode:h,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(e,t,r,n,i,o,a,s,u,c,l,h){let f=0,d=0,p=0;const m="right"===s?1:"left"===s?0:.5;let g=!1;for(const w of i){const e=w.getSections();for(const r of e){if(r.imageName)continue;const e=t[r.fontStack];if(e&&(g=void 0!==e.ascender&&void 0!==e.descender,!g))break}if(!g)break}let y=0;for(const w of i){w.trim();const i=w.getMaxScale(),a=(i-1)*Qh,s={positionedGlyphs:[],lineOffset:0};e.positionedLines[y]=s;const _=s.positionedGlyphs;let b=0;if(!w.length()){d+=o,++y;continue}let x=0,k=0;for(let o=0;o<w.length();o++){const a=w.getSection(o),s=w.getSectionIndex(o),p=w.getCharCode(o);let m=a.scale,y=null,A=null,E=null,S=Qh,T=0;const M=!(u===Of.horizontal||!l&&!Ao(p)||l&&(Zf[p]||(v=p,Hi(v)||qi(v)||Yi(v)||mo(v)||_o(v))));if(a.imageName){const t=n[a.imageName];if(!t)continue;E=a.imageName,e.iconsInText=e.iconsInText||!0,A=t.paddedRect;const r=t.displaySize;m=m*Qh/h,y={width:r[0],height:r[1],left:1,top:-3,advance:M?r[1]:r[0],localGlyph:!1},T=g?-y.height*m:i*Qh-17-r[1]*m,S=y.advance;const o=(M?r[0]:r[1])*m-Qh*i;o>0&&o>b&&(b=o)}else{const e=r[a.fontStack];if(!e)continue;e[p]&&(A=e[p]);const n=t[a.fontStack];if(!n)continue;const o=n.glyphs[p];if(!o)continue;if(y=o.metrics,S=8203!==p?Qh:0,g){const e=void 0!==n.ascender?Math.abs(n.ascender):0,t=void 0!==n.descender?Math.abs(n.descender):0,r=(e+t)*m;x<r&&(x=r,k=(e-t)/2*m),T=-e*m}else T=(i-m)*Qh-17}M?(e.verticalizable=!0,_.push({glyph:p,imageName:E,x:f,y:d+T,vertical:M,scale:m,localGlyph:y.localGlyph,fontStack:a.fontStack,sectionIndex:s,metrics:y,rect:A}),f+=S*m+c):(_.push({glyph:p,imageName:E,x:f,y:d+T,vertical:M,scale:m,localGlyph:y.localGlyph,fontStack:a.fontStack,sectionIndex:s,metrics:y,rect:A}),f+=y.advance*m+c)}0!==_.length&&(p=Math.max(f-c,p),g?qf(_,m,b,k,o*i/2):qf(_,m,b,0,o/2)),f=0;const A=o*i+b;s.lineOffset=Math.max(b,a),d+=A,++y}var v;const _=d,{horizontalAlign:b,verticalAlign:x}=Hf(a);(function(e,t,r,n,i,o){const a=(t-r)*i,s=-o*n;for(const u of e)for(const e of u.positionedGlyphs)e.x+=a,e.y+=s})(e.positionedLines,m,b,x,p,_),e.top+=-x*_,e.bottom=e.top+_,e.left+=-b*p,e.right=e.left+p,e.hasBaseline=g}(x,t,r,n,g,a,s,u,h,c,f,p),!function(e){for(const t of e)if(0!==t.positionedGlyphs.length)return!1;return!0}(b)&&x}const Zf={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Ff={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function jf(e,t,r,n,i,o){if(t.imageName){const e=n[t.imageName];return e?e.displaySize[0]*t.scale*Qh/o+i:0}{const n=r[t.fontStack],o=n&&n.glyphs[e];return o?o.metrics.advance*t.scale+i:0}}function Vf(e,t,r,n){const i=Math.pow(e-t,2);return n?e<t?i/2:2*i:i+Math.abs(r)*r}function Wf(e,t,r){let n=0;return 10===e&&(n-=1e4),r&&(n+=150),40!==e&&65288!==e||(n+=50),41!==t&&65289!==t||(n+=50),n}function Kf(e,t,r,n,i,o){let a=null,s=Vf(t,r,i,o);for(const u of n){const e=Vf(t-u.x,r,i,o)+u.badness;e<=s&&(a=u,s=e)}return{index:e,x:t,priorBreak:a,badness:s}}function Gf(e){return e?Gf(e.priorBreak).concat(e.index):[]}function Hf(e){let t=.5,r=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(e){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:t,verticalAlign:r}}function qf(e,t,r,n,i){if(!(t||r||n||i))return;const o=e.length-1,a=e[o],s=(a.x+a.metrics.advance*a.scale)*t;for(let u=0;u<=o;u++)e[u].x-=s,e[u].y+=r+n+i}function Yf(e,t,r){const{horizontalAlign:n,verticalAlign:i}=Hf(r),o=t[0]-e.displaySize[0]*n,a=t[1]-e.displaySize[1]*i;return{image:e,top:a,bottom:a+e.displaySize[1],left:o,right:o+e.displaySize[0]}}function Xf(e,t,r,n,i,o){const a=e.image;let s;if(a.content){const e=a.content,t=a.pixelRatio||1;s=[e[0]/t,e[1]/t,a.displaySize[0]-e[2]/t,a.displaySize[1]-e[3]/t]}const u=t.left*o,c=t.right*o;let l,h,f,d;"width"===r||"both"===r?(d=i[0]+u-n[3],h=i[0]+c+n[1]):(d=i[0]+(u+c-a.displaySize[0])/2,h=d+a.displaySize[0]);const p=t.top*o,m=t.bottom*o;return"height"===r||"both"===r?(l=i[1]+p-n[0],f=i[1]+m+n[2]):(l=i[1]+(p+m-a.displaySize[1])/2,f=l+a.displaySize[1]),{image:a,top:l,right:h,bottom:f,left:d,collisionPadding:s}}class Qf extends p{constructor(e,t,r,n,i){super(e,t),this.angle=n,this.z=r,void 0!==i&&(this.segment=i)}clone(){return new Qf(this.x,this.y,this.z,this.angle,this.segment)}}function $f(e,t,r,n,i){if(void 0===t.segment)return!0;let o=t,a=t.segment+1,s=0;for(;s>-r/2;){if(a--,a<0)return!1;s-=e[a].dist(o),o=e[a]}s+=e[a].dist(e[a+1]),a++;const u=[];let c=0;for(;s<r/2;){const t=e[a],r=e[a+1];if(!r)return!1;let o=e[a-1].angleTo(t)-t.angleTo(r);for(o=Math.abs((o+3*Math.PI)%(2*Math.PI)-Math.PI),u.push({distance:s,angleDelta:o}),c+=o;s-u[0].distance>n;)c-=u.shift().angleDelta;if(c>i)return!1;a++,s+=t.dist(r)}return!0}function Jf(e){let t=0;for(let r=0;r<e.length-1;r++)t+=e[r].dist(e[r+1]);return t}function ed(e,t,r){return e?.6*t*r:0}function td(e,t){return Math.max(e?e.right-e.left:0,t?t.right-t.left:0)}function rd(e,t,r,n,i,o){const a=ed(r,i,o),s=td(r,n)*o;let u=0;const c=Jf(e)/2;for(let l=0;l<e.length-1;l++){const r=e[l],n=e[l+1],i=r.dist(n);if(u+i>c){const o=(c-u)/i,h=Tr(r.x,n.x,o),f=Tr(r.y,n.y,o),d=new Qf(h,f,0,n.angleTo(r),l);return!a||$f(e,d,s,a,t)?d:void 0}u+=i}}function nd(e,t,r,n,i,o,a,s,u){const c=ed(n,o,a),l=td(n,i),h=l*a,f=0===e[0].x||e[0].x===u||0===e[0].y||e[0].y===u;return t-h<t/4&&(t=h+t/4),id(e,f?t/2*s%t:(l/2+2*o)*a*s%t,t,c,r,h,f,!1,u)}function id(e,t,r,n,i,o,a,s,u){const c=o/2,l=Jf(e);let h=0,f=t-r,d=[];for(let p=0;p<e.length-1;p++){const t=e[p],a=e[p+1],s=t.dist(a),m=a.angleTo(t);for(;f+r<h+s;){f+=r;const g=(f-h)/s,y=Tr(t.x,a.x,g),v=Tr(t.y,a.y,g);if(y>=0&&y<u&&v>=0&&v<u&&f-c>=0&&f+c<=l){const t=new Qf(y,v,0,m,p);t._round(),n&&!$f(e,t,o,n,i)||d.push(t)}}h+=s}return s||d.length||a||(d=id(e,h/2,r,n,i,o,a,!0,u)),d}function od(e,t,r,n,i){const o=[];for(let a=0;a<e.length;a++){const s=e[a];let u;for(let e=0;e<s.length-1;e++){let a=s[e],c=s[e+1];a.x<t&&c.x<t||(a.x<t?a=new p(t,a.y+(t-a.x)/(c.x-a.x)*(c.y-a.y))._round():c.x<t&&(c=new p(t,a.y+(t-a.x)/(c.x-a.x)*(c.y-a.y))._round()),a.y<r&&c.y<r||(a.y<r?a=new p(a.x+(r-a.y)/(c.y-a.y)*(c.x-a.x),r)._round():c.y<r&&(c=new p(a.x+(r-a.y)/(c.y-a.y)*(c.x-a.x),r)._round()),a.x>=n&&c.x>=n||(a.x>=n?a=new p(n,a.y+(n-a.x)/(c.x-a.x)*(c.y-a.y))._round():c.x>=n&&(c=new p(n,a.y+(n-a.x)/(c.x-a.x)*(c.y-a.y))._round()),a.y>=i&&c.y>=i||(a.y>=i?a=new p(a.x+(i-a.y)/(c.y-a.y)*(c.x-a.x),i)._round():c.y>=i&&(c=new p(a.x+(i-a.y)/(c.y-a.y)*(c.x-a.x),i)._round()),u&&a.equals(u[u.length-1])||(u=[a],o.push(u)),u.push(c)))))}}return o}ji(Qf,"Anchor");const ad=1e20;function sd(e,t,r,n,i,o,a,s,u){for(let c=t;c<t+n;c++)ud(e,r*o+c,o,i,a,s,u);for(let c=r;c<r+i;c++)ud(e,c*o+t,1,n,a,s,u)}function ud(e,t,r,n,i,o,a){o[0]=0,a[0]=-ad,a[1]=ad,i[0]=e[t];for(let s=1,u=0,c=0;s<n;s++){i[s]=e[t+s*r];const n=s*s;do{const e=o[u];c=(i[s]-i[e]+n-e*e)/(s-e)/2}while(c<=a[u]&&--u>-1);u++,o[u]=s,a[u]=c,a[u+1]=ad}for(let s=0,u=0;s<n;s++){for(;a[u+1]<s;)u++;const n=o[u],c=s-n;e[t+s*r]=i[n]+c*c}}const cd={none:0,ideographs:1,all:2};class ld{constructor(e,t,r){this.requestManager=e,this.localGlyphMode=t,this.localFontFamily=r,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(e){this.url=e}getGlyphs(e,t){const r=[];for(const n in e)for(const t of e[n])r.push({stack:n,id:t});T(r,(({stack:e,id:t},r)=>{let n=this.entries[e];n||(n=this.entries[e]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let i=n.glyphs[t];if(void 0!==i)return void r(null,{stack:e,id:t,glyph:i});if(i=this._tinySDF(n,e,t),i)return n.glyphs[t]=i,void r(null,{stack:e,id:t,glyph:i});const o=Math.floor(t/256);if(256*o>65535)return void r(new Error("glyphs > 65535 not supported"));if(n.ranges[o])return void r(null,{stack:e,id:t,glyph:i});let a=n.requests[o];a||(a=n.requests[o]=[],ld.loadGlyphRange(e,o,this.url,this.requestManager,((e,t)=>{if(t){n.ascender=t.ascender,n.descender=t.descender;for(const e in t.glyphs)this._doesCharSupportLocalGlyph(+e)||(n.glyphs[+e]=t.glyphs[+e]);n.ranges[o]=!0}for(const r of a)r(e,t);delete n.requests[o]}))),a.push(((n,i)=>{n?r(n):i&&r(null,{stack:e,id:t,glyph:i.glyphs[t]||null})}))}),((e,r)=>{if(e)t(e);else if(r){const e={};for(const{stack:t,id:n,glyph:i}of r)void 0===e[t]&&(e[t]={}),void 0===e[t].glyphs&&(e[t].glyphs={}),e[t].glyphs[n]=i&&{id:i.id,bitmap:i.bitmap.clone(),metrics:i.metrics},e[t].ascender=this.entries[t].ascender,e[t].descender=this.entries[t].descender;t(null,e)}}))}_doesCharSupportLocalGlyph(e){return this.localGlyphMode!==cd.none&&(this.localGlyphMode===cd.all?!!this.localFontFamily:!!this.localFontFamily&&(co(e)||fo(e)||eo(e)||to(e)||Ji(e)))}_tinySDF(e,t,r){const n=this.localFontFamily;if(!n||!this._doesCharSupportLocalGlyph(r))return;let i=e.tinySDF;if(!i){let r="400";/bold/i.test(t)?r="900":/medium/i.test(t)?r="500":/light/i.test(t)&&(r="200"),i=e.tinySDF=new ld.TinySDF({fontFamily:n,fontWeight:r,fontSize:48,buffer:6,radius:16}),i.fontWeight=r}if(this.localGlyphs[i.fontWeight][r])return this.localGlyphs[i.fontWeight][r];const o=String.fromCharCode(r),{data:a,width:s,height:u,glyphWidth:c,glyphHeight:l,glyphLeft:h,glyphTop:f,glyphAdvance:d}=i.draw(o);return this.localGlyphs[i.fontWeight][r]={id:r,bitmap:new $c({width:s,height:u},a),metrics:{width:c/2,height:l/2,left:h/2,top:f/2-27,advance:d/2,localGlyph:!0}}}}function hd(e,t,r,n){const i=[],o=e.image,a=o.pixelRatio,s=o.paddedRect.w-2,u=o.paddedRect.h-2,c=e.right-e.left,l=e.bottom-e.top,h=o.stretchX||[[0,s]],f=o.stretchY||[[0,u]],d=(e,t)=>e+t[1]-t[0],m=h.reduce(d,0),g=f.reduce(d,0),y=s-m,v=u-g;let _=0,b=m,x=0,w=g,k=0,A=y,E=0,S=v;if(o.content&&n){const e=o.content;_=fd(h,0,e[0]),x=fd(f,0,e[1]),b=fd(h,e[0],e[2]),w=fd(f,e[1],e[3]),k=e[0]-_,E=e[1]-x,A=e[2]-e[0]-b,S=e[3]-e[1]-w}const T=(n,i,s,u)=>{const h=pd(n.stretch-_,b,c,e.left),f=md(n.fixed-k,A,n.stretch,m),d=pd(i.stretch-x,w,l,e.top),y=md(i.fixed-E,S,i.stretch,g),v=pd(s.stretch-_,b,c,e.left),T=md(s.fixed-k,A,s.stretch,m),M=pd(u.stretch-x,w,l,e.top),I=md(u.fixed-E,S,u.stretch,g),P=new p(h,d),C=new p(v,d),B=new p(v,M),D=new p(h,M),R=new p(f/a,y/a),L=new p(T/a,I/a),O=t*Math.PI/180;if(O){const e=Math.sin(O),t=Math.cos(O),r=[t,-e,e,t];P._matMult(r),C._matMult(r),D._matMult(r),B._matMult(r)}const z=n.stretch+n.fixed,N=i.stretch+i.fixed;return{tl:P,tr:C,bl:D,br:B,tex:{x:o.paddedRect.x+1+z,y:o.paddedRect.y+1+N,w:s.stretch+s.fixed-z,h:u.stretch+u.fixed-N},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:R,pixelOffsetBR:L,minFontScaleX:A/a/c,minFontScaleY:S/a/l,isSDF:r}};if(n&&(o.stretchX||o.stretchY)){const e=dd(h,y,m),t=dd(f,v,g);for(let r=0;r<e.length-1;r++){const n=e[r],o=e[r+1];for(let e=0;e<t.length-1;e++)i.push(T(n,t[e],o,t[e+1]))}}else i.push(T({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:s+1},{fixed:0,stretch:u+1}));return i}function fd(e,t,r){let n=0;for(const i of e)n+=Math.max(t,Math.min(r,i[1]))-Math.max(t,Math.min(r,i[0]));return n}function dd(e,t,r){const n=[{fixed:-1,stretch:0}];for(const[i,o]of e){const e=n[n.length-1];n.push({fixed:i-e.stretch,stretch:e.stretch}),n.push({fixed:i-e.stretch,stretch:e.stretch+(o-i)})}return n.push({fixed:t+1,stretch:r}),n}function pd(e,t,r,n){return e/t*r+n}function md(e,t,r,n){return e-t*r/n}function gd(e,t,r,n){const i=t+e.positionedLines[n].lineOffset;return 0===n?r+i/2:r+(i+(t+e.positionedLines[n-1].lineOffset))/2}ld.loadGlyphRange=function(e,t,r,n,i){const o=256*t,a=o+255,s=n.transformRequest(n.normalizeGlyphsURL(r).replace("{fontstack}",e).replace("{range}",`${o}-${a}`),oe.Glyphs);ce(s,((e,t)=>{if(e)i(e);else if(t){const e={},r=function(e){return new uf(e).readFields(Pf,{})}(t);for(const t of r.glyphs)e[t.id]=t;i(null,{glyphs:e,ascender:r.ascender,descender:r.descender})}}))},ld.TinySDF=class{constructor({fontSize:e=24,buffer:t=3,radius:r=8,cutoff:n=.25,fontFamily:i="sans-serif",fontWeight:o="normal",fontStyle:a="normal"}={}){this.buffer=t,this.cutoff=n,this.radius=r;const s=this.size=e+4*t,u=this._createCanvas(s),c=this.ctx=u.getContext("2d",{willReadFrequently:!0});c.font=`${a} ${o} ${e}px ${i}`,c.textBaseline="alphabetic",c.textAlign="left",c.fillStyle="black",this.gridOuter=new Float64Array(s*s),this.gridInner=new Float64Array(s*s),this.f=new Float64Array(s),this.z=new Float64Array(s+1),this.v=new Uint16Array(s)}_createCanvas(e){const t=document.createElement("canvas");return t.width=t.height=e,t}draw(e){const{width:t,actualBoundingBoxAscent:r,actualBoundingBoxDescent:n,actualBoundingBoxLeft:i,actualBoundingBoxRight:o}=this.ctx.measureText(e),a=Math.ceil(r),s=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(o-i))),u=Math.min(this.size-this.buffer,a+Math.ceil(n)),c=s+2*this.buffer,l=u+2*this.buffer,h=Math.max(c*l,0),f=new Uint8ClampedArray(h),d={data:f,width:c,height:l,glyphWidth:s,glyphHeight:u,glyphTop:a,glyphLeft:0,glyphAdvance:t};if(0===s||0===u)return d;const{ctx:p,buffer:m,gridInner:g,gridOuter:y}=this;p.clearRect(m,m,s,u),p.fillText(e,m,m+a);const v=p.getImageData(m,m,s,u);y.fill(ad,0,h),g.fill(0,0,h);for(let _=0;_<u;_++)for(let e=0;e<s;e++){const t=v.data[4*(_*s+e)+3]/255;if(0===t)continue;const r=(_+m)*c+e+m;if(1===t)y[r]=0,g[r]=ad;else{const e=.5-t;y[r]=e>0?e*e:0,g[r]=e<0?e*e:0}}sd(y,0,0,c,l,c,this.f,this.v,this.z),sd(g,m,m,s,u,c,this.f,this.v,this.z);for(let _=0;_<h;_++){const e=Math.sqrt(y[_])-Math.sqrt(g[_]);f[_]=Math.round(255-255*(e/this.radius+this.cutoff))}return d}};class yd{constructor(e=[],t=vd){if(this.data=e,this.length=this.data.length,this.compare=t,this.length>0)for(let r=(this.length>>1)-1;r>=0;r--)this._down(r)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const e=this.data[0],t=this.data.pop();return this.length--,this.length>0&&(this.data[0]=t,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:t,compare:r}=this,n=t[e];for(;e>0;){const i=e-1>>1,o=t[i];if(r(n,o)>=0)break;t[e]=o,e=i}t[e]=n}_down(e){const{data:t,compare:r}=this,n=this.length>>1,i=t[e];for(;e<n;){let n=1+(e<<1),o=t[n];const a=n+1;if(a<this.length&&r(t[a],o)<0&&(n=a,o=t[a]),r(o,i)>=0)break;t[e]=o,e=n}t[e]=i}}function vd(e,t){return e<t?-1:e>t?1:0}function _d(e,t=1,r=!1){let n=1/0,i=1/0,o=-1/0,a=-1/0;const s=e[0];for(let d=0;d<s.length;d++){const e=s[d];(!d||e.x<n)&&(n=e.x),(!d||e.y<i)&&(i=e.y),(!d||e.x>o)&&(o=e.x),(!d||e.y>a)&&(a=e.y)}const u=Math.min(o-n,a-i);let c=u/2;const l=new yd([],bd);if(0===u)return new p(n,i);for(let d=n;d<o;d+=u)for(let t=i;t<a;t+=u)l.push(new xd(d+c,t+c,c,e));let h=function(e){let t=0,r=0,n=0;const i=e[0];for(let o=0,a=i.length,s=a-1;o<a;s=o++){const e=i[o],a=i[s],u=e.x*a.y-a.x*e.y;r+=(e.x+a.x)*u,n+=(e.y+a.y)*u,t+=3*u}return new xd(r/t,n/t,0,e)}(e),f=l.length;for(;l.length;){const n=l.pop();(n.d>h.d||!h.d)&&(h=n,r&&console.log("found best %d after %d probes",Math.round(1e4*n.d)/1e4,f)),n.max-h.d<=t||(c=n.h/2,l.push(new xd(n.p.x-c,n.p.y-c,c,e)),l.push(new xd(n.p.x+c,n.p.y-c,c,e)),l.push(new xd(n.p.x-c,n.p.y+c,c,e)),l.push(new xd(n.p.x+c,n.p.y+c,c,e)),f+=4)}return r&&(console.log(`num probes: ${f}`),console.log(`best distance: ${h.d}`)),h.p}function bd(e,t){return t.max-e.max}function xd(e,t,r,n){this.p=new p(e,t),this.h=r,this.d=function(e,t){let r=!1,n=1/0;for(let i=0;i<t.length;i++){const o=t[i];for(let t=0,i=o.length,a=i-1;t<i;a=t++){const i=o[t],s=o[a];i.y>e.y!=s.y>e.y&&e.x<(s.x-i.x)*(e.y-i.y)/(s.y-i.y)+i.x&&(r=!r),n=Math.min(n,Bc(e,i,s))}}return(r?1:-1)*Math.sqrt(n)}(this.p,n),this.max=this.d+this.h*Math.SQRT2}const wd=Number.POSITIVE_INFINITY,kd=Math.sqrt(2);function Ad(e,[t,r]){let n=0,i=0;if(r===wd){t<0&&(t=0);const r=t/kd;switch(e){case"top-right":case"top-left":i=r-7;break;case"bottom-right":case"bottom-left":i=7-r;break;case"bottom":i=7-t;break;case"top":i=t-7}switch(e){case"top-right":case"bottom-right":n=-r;break;case"top-left":case"bottom-left":n=r;break;case"left":n=t;break;case"right":n=-t}}else{switch(t=Math.abs(t),r=Math.abs(r),e){case"top-right":case"top-left":case"top":i=r-7;break;case"bottom-right":case"bottom-left":case"bottom":i=7-r}switch(e){case"top-right":case"bottom-right":case"right":n=-t;break;case"top-left":case"bottom-left":case"left":n=t}}return[n,i]}function Ed(e,t,r,n,i,o,a,s,u,c){e.createArrays(),e.tilePixelRatio=Es/(512*e.overscaling),e.compareText={},e.iconsNeedLinear=!1;const l=e.layers[0].layout,h=e.layers[0]._unevaluatedLayout._values,f={};if("composite"===e.textSizeData.kind){const{minZoom:t,maxZoom:r}=e.textSizeData;f.compositeTextSizes=[h["text-size"].possiblyEvaluate(new Fo(t),s),h["text-size"].possiblyEvaluate(new Fo(r),s)]}if("composite"===e.iconSizeData.kind){const{minZoom:t,maxZoom:r}=e.iconSizeData;f.compositeIconSizes=[h["icon-size"].possiblyEvaluate(new Fo(t),s),h["icon-size"].possiblyEvaluate(new Fo(r),s)]}f.layoutTextSize=h["text-size"].possiblyEvaluate(new Fo(u+1),s),f.layoutIconSize=h["icon-size"].possiblyEvaluate(new Fo(u+1),s),f.textMaxSize=h["text-size"].possiblyEvaluate(new Fo(18),s);const d="map"===l.get("text-rotation-alignment")&&"point"!==l.get("symbol-placement"),p=l.get("text-size");for(const m of e.features){const o=l.get("text-font").evaluate(m,{},s).join(","),u=p.evaluate(m,{},s),h=f.layoutTextSize.evaluate(m,{},s),g=(f.layoutIconSize.evaluate(m,{},s),{horizontal:{},vertical:void 0}),y=m.text;let v,_=[0,0];if(y){const n=y.toString(),a=l.get("text-letter-spacing").evaluate(m,{},s)*Qh,c=l.get("text-line-height").evaluate(m,{},s)*Qh,f=wo(n)?a:0,p=l.get("text-anchor").evaluate(m,{},s),v=l.get("text-variable-anchor");if(!v){const e=l.get("text-radial-offset").evaluate(m,{},s);_=e?Ad(p,[e*Qh,wd]):l.get("text-offset").evaluate(m,{},s).map((e=>e*Qh))}let b=d?"center":l.get("text-justify").evaluate(m,{},s);const x="point"===l.get("symbol-placement"),w=x?l.get("text-max-width").evaluate(m,{},s)*Qh:1/0,k=a=>{e.allowVerticalPlacement&&xo(n)&&(g.vertical=Uf(y,t,r,i,o,w,c,p,a,f,_,Of.vertical,!0,h,u))};if(!d&&v){const e="auto"===b?v.map((e=>Sd(e))):[b];let n=!1;for(let a=0;a<e.length;a++){const s=e[a];if(!g.horizontal[s])if(n)g.horizontal[s]=g.horizontal[0];else{const e=Uf(y,t,r,i,o,w,c,"center",s,f,_,Of.horizontal,!1,h,u);e&&(g.horizontal[s]=e,n=1===e.positionedLines.length)}}k("left")}else{if("auto"===b&&(b=Sd(p)),x||l.get("text-writing-mode").indexOf("horizontal")>=0||!xo(n)){const e=Uf(y,t,r,i,o,w,c,p,b,f,_,Of.horizontal,!1,h,u);e&&(g.horizontal[b]=e)}k(x?"left":b)}}let b=!1;if(m.icon&&m.icon.name){const t=n[m.icon.name];t&&(v=Yf(i[m.icon.name],l.get("icon-offset").evaluate(m,{},s),l.get("icon-anchor").evaluate(m,{},s)),b=t.sdf,void 0===e.sdfIcons?e.sdfIcons=t.sdf:e.sdfIcons!==t.sdf&&F("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(t.pixelRatio!==e.pixelRatio||0!==l.get("icon-rotate").constantOr(1))&&(e.iconsNeedLinear=!0))}const x=Pd(g.horizontal)||g.vertical;e.iconsInText||(e.iconsInText=!!x&&x.iconsInText),(x||v)&&Td(e,m,g,v,n,f,h,0,_,b,a,s,c)}o&&e.generateCollisionDebugBuffers(u,e.collisionBoxArray)}function Sd(e){switch(e){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Td(e,t,r,n,i,o,a,s,u,c,l,h,f){let d=o.textMaxSize.evaluate(t,{},h);void 0===d&&(d=a);const p=e.layers[0].layout,m=p.get("icon-offset").evaluate(t,{},h),g=Pd(r.horizontal)||r.vertical,y="globe"===f.name,_=a/24,b=e.tilePixelRatio*d/24,x=(I=e.overscaling,e.zoom>18&&I>2&&(I>>=1),Math.max(Es/(512*I),1)*p.get("symbol-spacing")),w=p.get("text-padding")*e.tilePixelRatio,k=p.get("icon-padding")*e.tilePixelRatio,A=v(p.get("text-max-angle")),E="map"===p.get("text-rotation-alignment")&&"point"!==p.get("symbol-placement"),S="map"===p.get("icon-rotation-alignment")&&"point"!==p.get("symbol-placement"),T=p.get("symbol-placement"),M=x/2;var I;const P=p.get("icon-text-fit");let C;n&&"none"!==P&&(e.allowVerticalPlacement&&r.vertical&&(C=Xf(n,r.vertical,P,p.get("icon-text-fit-padding"),m,_)),g&&(n=Xf(n,g,P,p.get("icon-text-fit-padding"),m,_)));const B=(a,s,d)=>{if(s.x<0||s.x>=Es||s.y<0||s.y>=Es)return;let p=null;if(y){const{x:e,y:t,z:r}=f.projectTilePoint(s.x,s.y,d);p={anchor:new Qf(e,t,r,0,void 0),up:f.upVector(d,s.x,s.y)}}!function(e,t,r,n,i,o,a,s,u,c,l,h,f,d,p,m,g,y,v,_,b,x,w,k,A){const E=e.addToLineVertexArray(t,n);let S,T,M,I,P,C,B,D=0,R=0,L=0,O=0,z=-1,N=-1;const U={};let Z=Wa("");const j=r?r.anchor:t;let V=0,W=0;if(void 0===u._unevaluatedLayout.getValue("text-radial-offset")?[V,W]=u.layout.get("text-offset").evaluate(b,{},A).map((e=>e*Qh)):(V=u.layout.get("text-radial-offset").evaluate(b,{},A)*Qh,W=wd),e.allowVerticalPlacement&&i.vertical){const e=i.vertical;if(p)C=Bd(e),s&&(B=Bd(s));else{const r=u.layout.get("text-rotate").evaluate(b,{},A)+90;M=Cd(c,j,t,l,h,f,e,d,r,m),s&&(I=Cd(c,j,t,l,h,f,s,y,r))}}if(o){const n=u.layout.get("icon-rotate").evaluate(b,{},A),i="none"!==u.layout.get("icon-text-fit"),a=hd(o,n,w,i),d=s?hd(s,n,w,i):void 0;T=Cd(c,j,t,l,h,f,o,y,n),D=4*a.length;const p=e.iconSizeData;let m=null;"source"===p.kind?(m=[$h*u.layout.get("icon-size").evaluate(b,{},A)],m[0]>Md&&F(`${e.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):"composite"===p.kind&&(m=[$h*x.compositeIconSizes[0].evaluate(b,{},A),$h*x.compositeIconSizes[1].evaluate(b,{},A)],(m[0]>Md||m[1]>Md)&&F(`${e.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),e.addSymbols(e.icon,a,m,_,v,b,!1,r,t,E.lineStartIndex,E.lineLength,-1,k,A),z=e.icon.placedSymbolArray.length-1,d&&(R=4*d.length,e.addSymbols(e.icon,d,m,_,v,b,Of.vertical,r,t,E.lineStartIndex,E.lineLength,-1,k,A),N=e.icon.placedSymbolArray.length-1)}for(const F in i.horizontal){const n=i.horizontal[F];S||(Z=Wa(n.text),p?P=Bd(n):S=Cd(c,j,t,l,h,f,n,d,u.layout.get("text-rotate").evaluate(b,{},A),m));const o=1===n.positionedLines.length;if(L+=Id(e,r,t,n,a,u,p,b,m,E,i.vertical?Of.horizontal:Of.horizontalOnly,o?Object.keys(i.horizontal):[F],U,z,x,k,A),o)break}i.vertical&&(O+=Id(e,r,t,i.vertical,a,u,p,b,m,E,Of.vertical,["vertical"],U,N,x,k,A));let K=-1;const G=(e,t)=>e?Math.max(e,t):t;K=G(P,K),K=G(C,K),K=G(B,K);const H=K>-1?1:0;e.glyphOffsetArray.length>=hp.MAX_GLYPHS&&F("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==b.sortKey&&e.addToSortKeyRanges(e.symbolInstances.length,b.sortKey),e.symbolInstances.emplaceBack(j.x,j.y,j.z,t.x,t.y,U.right>=0?U.right:-1,U.center>=0?U.center:-1,U.left>=0?U.left:-1,U.vertical>=0?U.vertical:-1,z,N,Z,void 0!==S?S:e.collisionBoxArray.length,void 0!==S?S+1:e.collisionBoxArray.length,void 0!==M?M:e.collisionBoxArray.length,void 0!==M?M+1:e.collisionBoxArray.length,void 0!==T?T:e.collisionBoxArray.length,void 0!==T?T+1:e.collisionBoxArray.length,I||e.collisionBoxArray.length,I?I+1:e.collisionBoxArray.length,l,L,O,D,R,H,0,V,W,K)}(e,s,p,a,r,n,i,C,e.layers[0],e.collisionBoxArray,t.index,t.sourceLayerIndex,e.index,w,E,u,0,k,S,m,t,o,c,l,h)};if("line"===T)for(const v of od(t.geometry,0,0,Es,Es)){const t=nd(v,x,A,r.vertical||g,n,24,b,e.overscaling,Es);for(const r of t)g&&Dd(e,g.text,M,r)||B(v,r,h)}else if("line-center"===T){for(const v of t.geometry)if(v.length>1){const e=rd(v,A,r.vertical||g,n,24,b);e&&B(v,e,h)}}else if("Polygon"===t.type)for(const v of Ol(t.geometry,0)){const e=_d(v,16);B(v[0],new Qf(e.x,e.y,0,0,void 0),h)}else if("LineString"===t.type)for(const v of t.geometry)B(v,new Qf(v[0].x,v[0].y,0,0,void 0),h);else if("Point"===t.type)for(const v of t.geometry)for(const e of v)B([e],new Qf(e.x,e.y,0,0,void 0),h)}const Md=32640;function Id(e,t,r,n,i,o,a,s,u,c,l,h,f,d,m,g,y){const v=function(e,t,r,n,i,o,a,s){const u=[];if(0===t.positionedLines.length)return u;const c=n.layout.get("text-rotate").evaluate(o,{})*Math.PI/180,l=function(e){const t=e[0],r=e[1],n=t*r;return n>0?[t,-r]:n<0?[-t,r]:0===t?[r,t]:[r,-t]}(r);let h=Math.abs(t.top-t.bottom);for(const p of t.positionedLines)h-=p.lineOffset;const f=t.positionedLines.length,d=h/f;let m=t.top-r[1];for(let g=0;g<f;++g){const e=t.positionedLines[g];m=gd(t,d,m,g);for(const n of e.positionedGlyphs){if(!n.rect)continue;const e=n.rect||{};let o=4,h=!0,f=1,d=0;if(n.imageName){const e=a[n.imageName];if(!e)continue;if(e.sdf){F("SDF images are not supported in formatted text and will be ignored.");continue}h=!1,f=e.pixelRatio,o=1/f}const g=(i||s)&&n.vertical,y=n.metrics.advance*n.scale/2,v=n.metrics,_=n.rect;if(null===_)continue;s&&t.verticalizable&&(d=n.imageName?y-n.metrics.width*n.scale/2:0);const b=i?[n.x+y,n.y]:[0,0];let x=[0,0],w=[0,0],k=!1;i||(g?(w=[n.x+y+l[0],n.y+l[1]-d],k=!0):x=[n.x+y+r[0],n.y+r[1]-d]);const A=_.w*n.scale/(f*(n.localGlyph?2:1)),E=_.h*n.scale/(f*(n.localGlyph?2:1));let S,T,M,I;if(g){const e=n.y-m,t=new p(-y,y-e),r=-Math.PI/2,i=new p(...w);S=new p(-y+x[0],x[1]),S._rotateAround(r,t)._add(i),S.x+=-e+y,S.y-=(v.left-o)*n.scale;const a=n.imageName?v.advance*n.scale:Qh*n.scale,s=String.fromCharCode(n.glyph);af(s)?S.x+=(1-o)*n.scale:sf(s)?S.x+=a-v.height*n.scale+(-o-1)*n.scale:S.x+=n.imageName||v.width+2*o===_.w&&v.height+2*o===_.h?(a-E)/2:(a-(v.height+2*o)*n.scale)/2,T=new p(S.x,S.y-A),M=new p(S.x+E,S.y),I=new p(S.x+E,S.y-A)}else{const e=(v.left-o)*n.scale-y+x[0],t=(-v.top-o)*n.scale+x[1],r=e+A,i=t+E;S=new p(e,t),T=new p(r,t),M=new p(e,i),I=new p(r,i)}if(c){let e;e=i?new p(0,0):k?new p(l[0],l[1]):new p(r[0],r[1]),S._rotateAround(c,e),T._rotateAround(c,e),M._rotateAround(c,e),I._rotateAround(c,e)}const P=new p(0,0),C=new p(0,0);u.push({tl:S,tr:T,bl:M,br:I,tex:e,writingMode:t.writingMode,glyphOffset:b,sectionIndex:n.sectionIndex,isSDF:h,pixelOffsetTL:P,pixelOffsetBR:C,minFontScaleX:0,minFontScaleY:0})}}return u}(0,n,u,o,a,s,i,e.allowVerticalPlacement),_=e.textSizeData;let b=null;"source"===_.kind?(b=[$h*o.layout.get("text-size").evaluate(s,{},y)],b[0]>Md&&F(`${e.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):"composite"===_.kind&&(b=[$h*m.compositeTextSizes[0].evaluate(s,{},y),$h*m.compositeTextSizes[1].evaluate(s,{},y)],(b[0]>Md||b[1]>Md)&&F(`${e.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),e.addSymbols(e.text,v,b,u,a,s,l,t,r,c.lineStartIndex,c.lineLength,d,g,y);for(const p of h)f[p]=e.text.placedSymbolArray.length-1;return 4*v.length}function Pd(e){for(const t in e)return e[t];return null}function Cd(e,t,r,n,i,o,a,s,u,c){let l=a.top,h=a.bottom,f=a.left,d=a.right;const m=a.collisionPadding;if(m&&(f-=m[0],l-=m[1],d+=m[2],h+=m[3]),u){const e=new p(f,l),t=new p(d,l),r=new p(f,h),n=new p(d,h),i=v(u);let o=new p(0,0);c&&(o=new p(c[0],c[1])),e._rotateAround(i,o),t._rotateAround(i,o),r._rotateAround(i,o),n._rotateAround(i,o),f=Math.min(e.x,t.x,r.x,n.x),d=Math.max(e.x,t.x,r.x,n.x),l=Math.min(e.y,t.y,r.y,n.y),h=Math.max(e.y,t.y,r.y,n.y)}return e.emplaceBack(t.x,t.y,t.z,r.x,r.y,f,l,d,h,s,n,i,o),e.length-1}function Bd(e){e.collisionPadding&&(e.top-=e.collisionPadding[1],e.bottom+=e.collisionPadding[3]);const t=e.bottom-e.top;return t>0?Math.max(10,t):null}function Dd(e,t,r,n){const i=e.compareText;if(t in i){const e=i[t];for(let t=e.length-1;t>=0;t--)if(n.dist(e[t])<r)return!0}else i[t]=[];return i[t].push(n),!1}function Rd(e,t){const r=e.fovAboveCenter,n=e.elevation?e.elevation.getMinElevationBelowMSL()*t:0,i=(e._camera.position[2]*e.worldSize-n)/Math.cos(e._pitch),o=Math.sin(r)*i/Math.sin(Math.max(Math.PI/2-e._pitch-r,.01)),a=Math.sin(e._pitch)*o+i;return Math.min(1.01*a,i*(1/e._horizonShift))}function Ld(e,t){if(!t.isReprojectedInTileSpace)return{scale:1<<e.z,x:e.x,y:e.y,x2:e.x+1,y2:e.y+1,projection:t};const r=Math.pow(2,-e.z),n=e.x*r,i=(e.x+1)*r,o=e.y*r,a=(e.y+1)*r,s=sc(n),u=sc(i),c=uc(o),l=uc(a),h=t.project(s,c),f=t.project(u,c),d=t.project(u,l),p=t.project(s,l);let m=Math.min(h.x,f.x,d.x,p.x),g=Math.min(h.y,f.y,d.y,p.y),y=Math.max(h.x,f.x,d.x,p.x),v=Math.max(h.y,f.y,d.y,p.y);const _=r/16;function b(e,r,n,i,o,a){const s=(n+o)/2,u=(i+a)/2,c=t.project(sc(s),uc(u)),l=Math.max(0,m-c.x,g-c.y,c.x-y,c.y-v);m=Math.min(m,c.x),y=Math.max(y,c.x),g=Math.min(g,c.y),v=Math.max(v,c.y),l>_&&(b(e,c,n,i,s,u),b(c,r,s,u,o,a))}b(h,f,n,o,i,o),b(f,d,i,o,i,a),b(d,p,i,a,n,a),b(p,h,n,a,n,o),m-=_,g-=_,y+=_,v+=_;const x=1/Math.max(y-m,v-g);return{scale:x,x:m*x,y:g*x,x2:y*x,y2:v*x,projection:t}}const Od=Cs(new Float32Array(16));class zd{constructor(e){this.spec=e,this.name=e.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(e,t){return{x:0,y:0,z:0}}unproject(e,t){return new rc(0,0)}projectTilePoint(e,t,r){return{x:e,y:t,z:0}}locationPoint(e,t,r=!0){return e._coordinatePoint(e.locationCoordinate(t),r)}pixelsPerMeter(e,t){return ac(1,e)*t}pixelSpaceConversion(e,t,r){return 1}farthestPixelDistance(e){return Rd(e,e.pixelsPerMeter)}pointCoordinate(e,t,r,n){const i=e.horizonLineFromTop(!1),o=new p(t,Math.max(i,r));return e.rayIntersectionCoordinate(e.pointRayIntersection(o,n))}pointCoordinate3D(e,t,r){const n=new p(t,r);if(e.elevation)return e.elevation.pointCoordinate(n);{const t=this.pointCoordinate(e,n.x,n.y,0);return[t.x,t.y,t.z]}}isPointAboveHorizon(e,t){if(e.elevation)return!this.pointCoordinate3D(e,t.x,t.y);const r=e.horizonLineFromTop();return t.y<r}createInversionMatrix(e,t){return Od}createTileMatrix(e,t,r){let n,i,o;const a=r.canonical,s=Cs(new Float64Array(16));if(this.isReprojectedInTileSpace){const u=Ld(a,this);n=1,i=u.x+r.wrap*u.scale,o=u.y,Ls(s,s,[n/u.scale,n/u.scale,e.pixelsPerMeter/t])}else n=t/e.zoomScale(a.z),i=(a.x+Math.pow(2,a.z)*r.wrap)*n,o=a.y*n;return Rs(s,s,[i,o,0]),Ls(s,s,[n/Es,n/Es,1]),s}upVector(e,t,r){return[0,0,1]}upVectorScale(e,t,r){return{metersToTile:1}}}class Nd extends zd{constructor(e){super(e),this.range=[4,7],this.center=e.center||[-96,37.5];const[t,r]=this.parallels=e.parallels||[29.5,45.5],n=Math.sin(v(t));this.n=(n+Math.sin(v(r)))/2,this.c=1+n*(2*this.n-n),this.r0=Math.sqrt(this.c)/this.n}project(e,t){const{n:r,c:n,r0:i}=this,o=v(e-this.center[0]),a=v(t),s=Math.sqrt(n-2*r*Math.sin(a))/r;return{x:s*Math.sin(o*r),y:s*Math.cos(o*r)-i,z:0}}unproject(e,t){const{n:r,c:n,r0:i}=this,o=i+t;let a=Math.atan2(e,Math.abs(o))*Math.sign(o);o*r<0&&(a-=Math.PI*Math.sign(e)*Math.sign(o));const s=v(this.center[0])*r;a=S(a,-Math.PI-s,Math.PI-s);const u=A(_(a/r)+this.center[0],-180,180),c=Math.asin(A((n-(e*e+o*o)*r*r)/(2*r),-1,1)),l=A(_(c),-lc,lc);return new rc(u,l)}}const Ud=1.340264,Zd=-.081106,Fd=893e-6,jd=.003796,Vd=Math.sqrt(3)/2;class Wd extends zd{project(e,t){t=t/180*Math.PI,e=e/180*Math.PI;const r=Math.asin(Vd*Math.sin(t)),n=r*r,i=n*n*n;return{x:.5*(e*Math.cos(r)/(Vd*(Ud+3*Zd*n+i*(7*Fd+9*jd*n)))/Math.PI+.5),y:1-.5*(r*(Ud+Zd*n+i*(Fd+jd*n))/Math.PI+1),z:0}}unproject(e,t){e=(2*e-.5)*Math.PI;let r=t=(2*(1-t)-1)*Math.PI,n=r*r,i=n*n*n;for(let c,l,h,f=0;f<12&&(l=r*(Ud+Zd*n+i*(Fd+jd*n))-t,h=Ud+3*Zd*n+i*(7*Fd+9*jd*n),c=l/h,r=A(r-c,-Math.PI/3,Math.PI/3),n=r*r,i=n*n*n,!(Math.abs(c)<1e-12));++f);const o=Vd*e*(Ud+3*Zd*n+i*(7*Fd+9*jd*n))/Math.cos(r),a=Math.asin(Math.sin(r)/Vd),s=A(180*o/Math.PI,-180,180),u=A(180*a/Math.PI,-lc,lc);return new rc(s,u)}}class Kd extends zd{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0}project(e,t){return{x:.5+e/360,y:.5-t/360,z:0}}unproject(e,t){const r=360*(e-.5),n=A(360*(.5-t),-lc,lc);return new rc(r,n)}}const Gd=Math.PI/2;function Hd(e){return Math.tan((Gd+e)/2)}class qd extends zd{constructor(e){super(e),this.center=e.center||[0,30];const[t,r]=this.parallels=e.parallels||[30,30];let n=v(t),i=v(r);this.southernCenter=n+i<0,this.southernCenter&&(n=-n,i=-i);const o=Math.cos(n),a=Hd(n);this.n=n===i?Math.sin(n):Math.log(o/Math.cos(i))/Math.log(Hd(i)/a),this.f=o*Math.pow(Hd(n),this.n)/this.n}project(e,t){t=v(t),this.southernCenter&&(t=-t),e=v(e-this.center[0]);const r=1e-6,{n:n,f:i}=this;i>0?t<-Gd+r&&(t=-Gd+r):t>Gd-r&&(t=Gd-r);const o=i/Math.pow(Hd(t),n);let a=o*Math.sin(n*e),s=i-o*Math.cos(n*e);return a=.5*(a/Math.PI+.5),s=.5*(s/Math.PI+.5),{x:a,y:this.southernCenter?s:1-s,z:0}}unproject(e,t){e=(2*e-.5)*Math.PI,this.southernCenter&&(t=1-t),t=(2*(1-t)-.5)*Math.PI;const{n:r,f:n}=this,i=n-t,o=Math.sign(i),a=Math.sign(r)*Math.sqrt(e*e+i*i);let s=Math.atan2(e,Math.abs(i))*o;i*r<0&&(s-=Math.PI*Math.sign(e)*o);const u=A(_(s/r)+this.center[0],-180,180),c=A(_(2*Math.atan(Math.pow(n/a,1/r))-Gd),-lc,lc);return new rc(u,this.southernCenter?-c:c)}}class Yd extends zd{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(e,t){return{x:ic(e),y:oc(t),z:0}}unproject(e,t){const r=sc(e),n=uc(t);return new rc(r,n)}}const Xd=v(lc);class Qd extends zd{project(e,t){const r=(t=v(t))*t,n=r*r;return{x:.5*((e=v(e))*(.8707-.131979*r+n*(n*(.003971*r-.001529*n)-.013791))/Math.PI+.5),y:1-.5*(t*(1.007226+r*(.015085+n*(.028874*r-.044475-.005916*n)))/Math.PI+1),z:0}}unproject(e,t){e=(2*e-.5)*Math.PI;let r=t=(2*(1-t)-1)*Math.PI,n=25,i=0,o=r*r;do{o=r*r;const e=o*o;i=(r*(1.007226+o*(.015085+e*(.028874*o-.044475-.005916*e)))-t)/(1.007226+o*(.045255+e*(.259866*o-.311325-.005916*11*e))),r=A(r-i,-Xd,Xd)}while(Math.abs(i)>1e-6&&--n>0);o=r*r;const a=A(_(e/(.8707+o*(o*(o*o*o*(.003971-.001529*o)-.013791)-.131979))),-180,180),s=_(r);return new rc(a,s)}}const $d=v(lc);class Jd extends zd{project(e,t){t=v(t),e=v(e);const r=Math.cos(t),n=2/Math.PI,i=Math.acos(r*Math.cos(e/2)),o=Math.sin(i)/i,a=.5*(e*n+2*r*Math.sin(e/2)/o)||0,s=.5*(t+Math.sin(t)/o)||0;return{x:.5*(a/Math.PI+.5),y:1-.5*(s/Math.PI+1),z:0}}unproject(e,t){let r=e=(2*e-.5)*Math.PI,n=t=(2*(1-t)-1)*Math.PI,i=25;const o=1e-6;let a=0,s=0;do{const i=Math.cos(n),o=Math.sin(n),u=2*o*i,c=o*o,l=i*i,h=Math.cos(r/2),f=Math.sin(r/2),d=2*h*f,p=f*f,m=1-l*h*h,g=m?1/m:0,y=m?Math.acos(i*h)*Math.sqrt(1/m):0,v=.5*(2*y*i*f+2*r/Math.PI)-e,_=.5*(y*o+n)-t,b=.5*g*(l*p+y*i*h*c)+1/Math.PI,x=g*(d*u/4-y*o*f),w=.125*g*(u*f-y*o*l*d),k=.5*g*(c*h+y*p*i)+.5,E=x*w-k*b;a=(_*x-v*k)/E,s=(v*w-_*b)/E,r=A(r-a,-Math.PI,Math.PI),n=A(n-s,-$d,$d)}while((Math.abs(a)>o||Math.abs(s)>o)&&--i>0);return new rc(_(r),_(n))}}class ep extends zd{constructor(e){super(e),this.center=e.center||[0,0],this.parallels=e.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(v(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(e,t){const{scale:r,cosPhi:n}=this;return{x:v(e)*n*r+.5,y:-Math.sin(v(t))/n*r+.5,z:0}}unproject(e,t){const{scale:r,cosPhi:n}=this,i=-(t-.5)/r,o=A(_((e-.5)/r)/n,-180,180),a=Math.asin(A(i*n,-1,1)),s=A(_(a),-lc,lc);return new rc(o,s)}}class tp extends Yd{constructor(e){super(e),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(e,t,r){const n=ju(e,t,r);return tu(n,n,Ku(Du(r))),{x:n[0],y:n[1],z:n[2]}}locationPoint(e,t){const r=Fu(t.lat,t.lng),n=$s([],r),i=e.elevation?e.elevation.getAtPointOrZero(e.locationCoordinate(t),e._centerAltitude):e._centerAltitude;Qs(r,r,n,ac(1,0)*Es*i);const o=Cs(new Float64Array(16));return Ds(o,e.pixelMatrix,e.globeMatrix),tu(r,r,o),new p(r[0],r[1])}pixelsPerMeter(e,t){return ac(1,0)*t}pixelSpaceConversion(e,t,r){const n=ac(1,e)*t,i=Tr(ac(1,45)*t,n,r);return this.pixelsPerMeter(e,t)/i}createTileMatrix(e,t,r){const n=Gu(Du(r.canonical));return Ds(new Float64Array(16),e.globeMatrix,n)}createInversionMatrix(e,t){const{center:r}=e,n=Ku(Du(t));return zs(n,n,v(r.lng)),Os(n,n,v(r.lat)),Ls(n,n,[e._pixelsPerMercatorPixel,e._pixelsPerMercatorPixel,1]),Float32Array.from(n)}pointCoordinate(e,t,r,n){return Pu(e,t,r,!0)||new fc(0,0)}pointCoordinate3D(e,t,r){const n=this.pointCoordinate(e,t,r,0);return[n.x,n.y,n.z]}isPointAboveHorizon(e,t){return!Pu(e,t.x,t.y,!1)}farthestPixelDistance(e){const t=function(e,t){const r=e.cameraToCenterDistance,n=e._centerAltitude*t,i=e._camera,o=e._camera.forward(),a=Ks([],Xs([],o,-r),[0,0,n]),s=e.worldSize/(2*Math.PI),u=[0,0,-s],c=e.width/e.height,l=Math.tan(e.fovAboveCenter),h=Xs([],i.up(),l),f=Xs([],i.right(),l*c),d=$s([],Ks([],Ks([],o,h),f)),p=[];let m;if(new _u(a,d).closestPointOnSphere(u,s,p)){const t=Ks([],p,u),r=iu([],t,a);m=Math.cos(e.fovAboveCenter)*Vs(r)}else{const e=iu([],a,u),t=iu([],u,a);$s(t,t);const r=Vs(e)-s;m=Math.sqrt(r*(r+2*s));const n=Math.acos(m/(s+r))-Math.acos(Js(o,t));m*=Math.cos(n)}return 1.01*m}(e,this.pixelsPerMeter(e.center.lat,e.worldSize)),r=qu(e.zoom);if(r>0){const n=Rd(e,ac(1,e.center.lat)*e.worldSize),i=e.worldSize/(2*Math.PI),o=Math.max(e.width,e.height)/e.worldSize*Math.PI;return Tr(t,n+i*(1-Math.cos(o)),Math.pow(r,10))}return t}upVector(e,t,r){return ju(t,r,e,1)}upVectorScale(e){return{metersToTile:Iu(Vu(Du(e)))}}}function rp(e){const t=e.parallels,r=!!t&&Math.abs(t[0]+t[1])<.01;switch(e.name){case"mercator":return new Yd(e);case"equirectangular":return new Kd(e);case"naturalEarth":return new Qd(e);case"equalEarth":return new Wd(e);case"winkelTripel":return new Jd(e);case"albers":return r?new ep(e):new Nd(e);case"lambertConformalConic":return r?new ep(e):new qd(e);case"globe":return new tp(e)}throw new Error(`Invalid projection name: ${e.name}`)}const np=ah.types,ip=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function op(e,t,r,n,i,o,a,s,u,c,l,h,f){const d=s?Math.min(Md,Math.round(s[0])):0,p=s?Math.min(Md,Math.round(s[1])):0;e.emplaceBack(t,r,Math.round(32*n),Math.round(32*i),o,a,(d<<1)+(u?1:0),p,16*c,16*l,256*h,256*f)}function ap(e,t,r,n,i,o,a){e.emplaceBack(t,r,n,i,o,a)}function sp(e,t,r,n,i){e.emplaceBack(t,r,n,i),e.emplaceBack(t,r,n,i),e.emplaceBack(t,r,n,i),e.emplaceBack(t,r,n,i)}function up(e){for(const t of e.sections)if(Mo(t.text))return!0;return!1}class cp{constructor(e){this.layoutVertexArray=new pa,this.indexArray=new wa,this.programConfigurations=e,this.segments=new As,this.dynamicLayoutVertexArray=new la,this.opacityVertexArray=new ga,this.placedSymbolArray=new Ra,this.globeExtVertexArray=new ma}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(e,t,r,n){this.isEmpty()||(r&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Wh.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,t),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,Gh.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,ip,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,Kh.members,!0)),this.opacityVertexBuffer.itemSize=1),(r||n)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}ji(cp,"SymbolBuffers");class lp{constructor(e,t,r){this.layoutVertexArray=new e,this.layoutAttributes=t,this.indexArray=new r,this.segments=new As,this.collisionVertexArray=new ba,this.collisionVertexArrayExt=new xa}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,Hh.members,!0),this.collisionVertexBufferExt=e.createVertexBuffer(this.collisionVertexArrayExt,qh.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}ji(lp,"CollisionBuffers");class hp{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map((e=>e.id)),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Cs([]),this.placementViewportMatrix=Cs([]);const t=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Jh(this.zoom,t["text-size"]),this.iconSizeData=Jh(this.zoom,t["icon-size"]);const r=this.layers[0].layout,n=r.get("symbol-sort-key"),i=r.get("symbol-z-order");this.canOverlap=r.get("text-allow-overlap")||r.get("icon-allow-overlap")||r.get("text-ignore-placement")||r.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==i&&void 0!==n.constantOr(1),this.sortFeaturesByY=("viewport-y"===i||"auto"===i&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=r.get("text-writing-mode").map((e=>Of[e])),this.stateDependentLayerIds=this.layers.filter((e=>e.isStateDependent())).map((e=>e.id)),this.sourceID=e.sourceID,this.projection=e.projection}createArrays(){this.text=new cp(new ps(this.layers,this.zoom,(e=>/^text/.test(e)))),this.icon=new cp(new ps(this.layers,this.zoom,(e=>/^icon/.test(e)))),this.glyphOffsetArray=new za,this.lineVertexArray=new Na,this.symbolInstances=new Oa}calculateGlyphDependencies(e,t,r,n,i){for(let o=0;o<e.length;o++)if(t[e.charCodeAt(o)]=!0,n&&i){const r=of[e.charAt(o)];r&&(t[r.charCodeAt(0)]=!0)}}populate(e,t,r,n){const i=this.layers[0],o=i.layout,a="globe"===this.projection.name,s=o.get("text-font"),u=o.get("text-field"),c=o.get("icon-image"),l=("constant"!==u.value.kind||u.value.value instanceof Pt&&!u.value.value.isEmpty()||u.value.value.toString().length>0)&&("constant"!==s.value.kind||s.value.value.length>0),h="constant"!==c.value.kind||!!c.value.value||Object.keys(c.parameters).length>0,f=o.get("symbol-sort-key");if(this.features=[],!l&&!h)return;const d=t.iconDependencies,p=t.glyphDependencies,m=t.availableImages,g=new Fo(this.zoom);for(const{feature:y,id:v,index:_,sourceLayerIndex:b}of e){const e=i._featureFilter.needGeometry,t=xc(y,e);if(!i._featureFilter.filter(g,t,r))continue;if(e||(t.geometry=bc(y,r,n)),a&&1!==y.type&&r.z<=5){const e=t.geometry,n=.98078528056,i=(e,t)=>Js(ju(e.x,e.y,r,1),ju(t.x,t.y,r,1))<n;for(let t=0;t<e.length;t++)e[t]=gc(e[t],i)}let u,c;if(l){const e=i.getValueAndResolveTokens("text-field",t,r,m),n=Pt.factory(e);up(n)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===No()||this.hasRTLText&&Zo.isParsed())&&(u=nf(n,i,t))}if(h){const e=i.getValueAndResolveTokens("icon-image",t,r,m);c=e instanceof Ct?e:Ct.fromString(e)}if(!u&&!c)continue;const x=this.sortFeaturesByKey?f.evaluate(t,{},r):void 0;if(this.features.push({id:v,text:u,icon:c,index:_,sourceLayerIndex:b,geometry:t.geometry,properties:y.properties,type:np[y.type],sortKey:x}),c&&(d[c.name]=!0),u){const e=s.evaluate(t,{},r).join(","),n="map"===o.get("text-rotation-alignment")&&"point"!==o.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Of.vertical)>=0;for(const t of u.sections)if(t.image)d[t.image.name]=!0;else{const r=xo(u.toString()),i=t.fontStack||e,o=p[i]=p[i]||{};this.calculateGlyphDependencies(t.text,o,n,this.allowVerticalPlacement,r)}}}"line"===o.get("symbol-placement")&&(this.features=function(e){const t={},r={},n=[];let i=0;function o(t){n.push(e[t]),i++}function a(e,t,i){const o=r[e];return delete r[e],r[t]=o,n[o].geometry[0].pop(),n[o].geometry[0]=n[o].geometry[0].concat(i[0]),o}function s(e,r,i){const o=t[r];return delete t[r],t[e]=o,n[o].geometry[0].shift(),n[o].geometry[0]=i[0].concat(n[o].geometry[0]),o}function u(e,t,r){const n=r?t[0][t[0].length-1]:t[0][0];return`${e}:${n.x}:${n.y}`}for(let c=0;c<e.length;c++){const l=e[c],h=l.geometry,f=l.text?l.text.toString():null;if(!f){o(c);continue}const d=u(f,h),p=u(f,h,!0);if(d in r&&p in t&&r[d]!==t[p]){const e=s(d,p,h),i=a(d,p,n[e].geometry);delete t[d],delete r[p],r[u(f,n[i].geometry,!0)]=i,n[e].geometry=null}else d in r?a(d,p,h):p in t?s(d,p,h):(o(c),t[d]=i-1,r[p]=i-1)}return n.filter((e=>e.geometry))}(this.features)),this.sortFeaturesByKey&&this.features.sort(((e,t)=>e.sortKey-t.sortKey))}update(e,t,r,n){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,t,this.layers,r,n),this.icon.programConfigurations.updatePaintArrays(e,t,this.layers,r,n))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=rp(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,t){const r=this.lineVertexArray.length;if(void 0!==e.segment)for(const{x:n,y:i}of t)this.lineVertexArray.emplaceBack(n,i);return{lineStartIndex:r,lineLength:this.lineVertexArray.length-r}}addSymbols(e,t,r,n,i,o,a,s,u,c,l,h,f,d){const p=e.indexArray,m=e.layoutVertexArray,g=e.globeExtVertexArray,y=e.segments.prepareSegment(4*t.length,m,p,this.canOverlap?o.sortKey:void 0),v=this.glyphOffsetArray.length,_=y.vertexLength,b=this.allowVerticalPlacement&&a===Of.vertical?Math.PI/2:0,x=o.text&&o.text.sections;for(let k=0;k<t.length;k++){const{tl:n,tr:i,bl:a,br:c,tex:l,pixelOffsetTL:h,pixelOffsetBR:v,minFontScaleX:_,minFontScaleY:w,glyphOffset:A,isSDF:E,sectionIndex:S}=t[k],T=y.vertexLength,M=A[1];if(op(m,u.x,u.y,n.x,M+n.y,l.x,l.y,r,E,h.x,h.y,_,w),op(m,u.x,u.y,i.x,M+i.y,l.x+l.w,l.y,r,E,v.x,h.y,_,w),op(m,u.x,u.y,a.x,M+a.y,l.x,l.y+l.h,r,E,h.x,v.y,_,w),op(m,u.x,u.y,c.x,M+c.y,l.x+l.w,l.y+l.h,r,E,v.x,v.y,_,w),s){const{x:t,y:r,z:n}=s.anchor,[i,o,a]=s.up;ap(g,t,r,n,i,o,a),ap(g,t,r,n,i,o,a),ap(g,t,r,n,i,o,a),ap(g,t,r,n,i,o,a),sp(e.dynamicLayoutVertexArray,t,r,n,b)}else sp(e.dynamicLayoutVertexArray,u.x,u.y,u.z,b);p.emplaceBack(T,T+1,T+2),p.emplaceBack(T+1,T+2,T+3),y.vertexLength+=4,y.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(A[0]),k!==t.length-1&&S===t[k+1].sectionIndex||e.programConfigurations.populatePaintArrays(m.length,o,o.index,{},f,d,x&&x[S])}const w=s?s.anchor:u;e.placedSymbolArray.emplaceBack(w.x,w.y,w.z,u.x,u.y,v,this.glyphOffsetArray.length-v,_,c,l,u.segment,r?r[0]:0,r?r[1]:0,n[0],n[1],a,0,!1,0,h,0)}_commitLayoutVertex(e,t,r,n,i,o,a){e.emplaceBack(t,r,n,i,o,Math.round(a.x),Math.round(a.y))}_addCollisionDebugVertices(e,t,r,n,i,o,a){const s=r.segments.prepareSegment(4,r.layoutVertexArray,r.indexArray),u=s.vertexLength,c=a.tileAnchorX,l=a.tileAnchorY;for(let f=0;f<4;f++)r.collisionVertexArray.emplaceBack(0,0,0,0);r.collisionVertexArrayExt.emplaceBack(t,-e.padding,-e.padding),r.collisionVertexArrayExt.emplaceBack(t,e.padding,-e.padding),r.collisionVertexArrayExt.emplaceBack(t,e.padding,e.padding),r.collisionVertexArrayExt.emplaceBack(t,-e.padding,e.padding),this._commitLayoutVertex(r.layoutVertexArray,n,i,o,c,l,new p(e.x1,e.y1)),this._commitLayoutVertex(r.layoutVertexArray,n,i,o,c,l,new p(e.x2,e.y1)),this._commitLayoutVertex(r.layoutVertexArray,n,i,o,c,l,new p(e.x2,e.y2)),this._commitLayoutVertex(r.layoutVertexArray,n,i,o,c,l,new p(e.x1,e.y2)),s.vertexLength+=4;const h=r.indexArray;h.emplaceBack(u,u+1),h.emplaceBack(u+1,u+2),h.emplaceBack(u+2,u+3),h.emplaceBack(u+3,u),s.primitiveLength+=4}_addTextDebugCollisionBoxes(e,t,r,n,i,o){for(let a=n;a<i;a++){const n=r.get(a),i=this.getSymbolInstanceTextSize(e,o,t,a);this._addCollisionDebugVertices(n,i,this.textCollisionBox,n.projectedAnchorX,n.projectedAnchorY,n.projectedAnchorZ,o)}}_addIconDebugCollisionBoxes(e,t,r,n,i,o){for(let a=n;a<i;a++){const n=r.get(a),i=this.getSymbolInstanceIconSize(e,t,o.placedIconSymbolIndex);this._addCollisionDebugVertices(n,i,this.iconCollisionBox,n.projectedAnchorX,n.projectedAnchorY,n.projectedAnchorZ,o)}}generateCollisionDebugBuffers(e,t){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new lp(va,Yh.members,Ma),this.iconCollisionBox=new lp(va,Yh.members,Ma);const r=tf(this.iconSizeData,e),n=tf(this.textSizeData,e);for(let i=0;i<this.symbolInstances.length;i++){const o=this.symbolInstances.get(i);this._addTextDebugCollisionBoxes(n,e,t,o.textBoxStartIndex,o.textBoxEndIndex,o),this._addTextDebugCollisionBoxes(n,e,t,o.verticalTextBoxStartIndex,o.verticalTextBoxEndIndex,o),this._addIconDebugCollisionBoxes(r,e,t,o.iconBoxStartIndex,o.iconBoxEndIndex,o),this._addIconDebugCollisionBoxes(r,e,t,o.verticalIconBoxStartIndex,o.verticalIconBoxEndIndex,o)}}getSymbolInstanceTextSize(e,t,r,n){const i=this.text.placedSymbolArray.get(t.rightJustifiedTextSymbolIndex>=0?t.rightJustifiedTextSymbolIndex:t.centerJustifiedTextSymbolIndex>=0?t.centerJustifiedTextSymbolIndex:t.leftJustifiedTextSymbolIndex>=0?t.leftJustifiedTextSymbolIndex:t.verticalPlacedTextSymbolIndex>=0?t.verticalPlacedTextSymbolIndex:n),o=ef(this.textSizeData,e,i)/Qh;return this.tilePixelRatio*o}getSymbolInstanceIconSize(e,t,r){const n=this.icon.placedSymbolArray.get(r),i=ef(this.iconSizeData,e,n);return this.tilePixelRatio*i}_commitDebugCollisionVertexUpdate(e,t,r){e.emplaceBack(t,-r,-r),e.emplaceBack(t,r,-r),e.emplaceBack(t,r,r),e.emplaceBack(t,-r,r)}_updateTextDebugCollisionBoxes(e,t,r,n,i,o){for(let a=n;a<i;a++){const n=r.get(a),i=this.getSymbolInstanceTextSize(e,o,t,a);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,i,n.padding)}}_updateIconDebugCollisionBoxes(e,t,r,n,i,o){for(let a=n;a<i;a++){const n=r.get(a),i=this.getSymbolInstanceIconSize(e,t,o);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,i,n.padding)}}updateCollisionDebugBuffers(e,t){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const r=tf(this.iconSizeData,e),n=tf(this.textSizeData,e);for(let i=0;i<this.symbolInstances.length;i++){const o=this.symbolInstances.get(i);this._updateTextDebugCollisionBoxes(n,e,t,o.textBoxStartIndex,o.textBoxEndIndex,o),this._updateTextDebugCollisionBoxes(n,e,t,o.verticalTextBoxStartIndex,o.verticalTextBoxEndIndex,o),this._updateIconDebugCollisionBoxes(r,e,t,o.iconBoxStartIndex,o.iconBoxEndIndex,o.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(r,e,t,o.verticalIconBoxStartIndex,o.verticalIconBoxEndIndex,o.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(e,t,r,n,i,o,a,s,u){const c={};if(t<r){const{x1:r,y1:n,x2:i,y2:o,padding:a,projectedAnchorX:s,projectedAnchorY:u,projectedAnchorZ:l,tileAnchorX:h,tileAnchorY:f,featureIndex:d}=e.get(t);c.textBox={x1:r,y1:n,x2:i,y2:o,padding:a,projectedAnchorX:s,projectedAnchorY:u,projectedAnchorZ:l,tileAnchorX:h,tileAnchorY:f},c.textFeatureIndex=d}if(n<i){const{x1:t,y1:r,x2:i,y2:o,padding:a,projectedAnchorX:s,projectedAnchorY:u,projectedAnchorZ:l,tileAnchorX:h,tileAnchorY:f,featureIndex:d}=e.get(n);c.verticalTextBox={x1:t,y1:r,x2:i,y2:o,padding:a,projectedAnchorX:s,projectedAnchorY:u,projectedAnchorZ:l,tileAnchorX:h,tileAnchorY:f},c.verticalTextFeatureIndex=d}if(o<a){const{x1:t,y1:r,x2:n,y2:i,padding:a,projectedAnchorX:s,projectedAnchorY:u,projectedAnchorZ:l,tileAnchorX:h,tileAnchorY:f,featureIndex:d}=e.get(o);c.iconBox={x1:t,y1:r,x2:n,y2:i,padding:a,projectedAnchorX:s,projectedAnchorY:u,projectedAnchorZ:l,tileAnchorX:h,tileAnchorY:f},c.iconFeatureIndex=d}if(s<u){const{x1:t,y1:r,x2:n,y2:i,padding:o,projectedAnchorX:a,projectedAnchorY:u,projectedAnchorZ:l,tileAnchorX:h,tileAnchorY:f,featureIndex:d}=e.get(s);c.verticalIconBox={x1:t,y1:r,x2:n,y2:i,padding:o,projectedAnchorX:a,projectedAnchorY:u,projectedAnchorZ:l,tileAnchorX:h,tileAnchorY:f},c.verticalIconFeatureIndex=d}return c}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let t=0;t<this.symbolInstances.length;t++){const r=this.symbolInstances.get(t);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,r.textBoxStartIndex,r.textBoxEndIndex,r.verticalTextBoxStartIndex,r.verticalTextBoxEndIndex,r.iconBoxStartIndex,r.iconBoxEndIndex,r.verticalIconBoxStartIndex,r.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,t){const r=e.placedSymbolArray.get(t),n=r.vertexStartIndex+4*r.numGlyphs;for(let i=r.vertexStartIndex;i<n;i+=4)e.indexArray.emplaceBack(i,i+1,i+2),e.indexArray.emplaceBack(i+1,i+2,i+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const t=Math.sin(e),r=Math.cos(e),n=[],i=[],o=[];for(let a=0;a<this.symbolInstances.length;++a){o.push(a);const e=this.symbolInstances.get(a);n.push(0|Math.round(t*e.tileAnchorX+r*e.tileAnchorY)),i.push(e.featureIndex)}return o.sort(((e,t)=>n[e]-n[t]||i[t]-i[e])),o}addToSortKeyRanges(e,t){const r=this.sortKeyRanges[this.sortKeyRanges.length-1];r&&r.sortKey===t?r.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:t,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const e of this.symbolInstanceIndexes){const t=this.symbolInstances.get(e);this.featureSortOrder.push(t.featureIndex);const{rightJustifiedTextSymbolIndex:r,centerJustifiedTextSymbolIndex:n,leftJustifiedTextSymbolIndex:i,verticalPlacedTextSymbolIndex:o,placedIconSymbolIndex:a,verticalPlacedIconSymbolIndex:s}=t;r>=0&&this.addIndicesForPlacedSymbol(this.text,r),n>=0&&n!==r&&this.addIndicesForPlacedSymbol(this.text,n),i>=0&&i!==n&&i!==r&&this.addIndicesForPlacedSymbol(this.text,i),o>=0&&this.addIndicesForPlacedSymbol(this.text,o),a>=0&&this.addIndicesForPlacedSymbol(this.icon,a),s>=0&&this.addIndicesForPlacedSymbol(this.icon,s)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}ji(hp,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),hp.MAX_GLYPHS=65535,hp.addDynamicAttributes=sp;const fp=new Jo({"symbol-placement":new Xo(Xe.layout_symbol["symbol-placement"]),"symbol-spacing":new Xo(Xe.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Xo(Xe.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Qo(Xe.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Xo(Xe.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Xo(Xe.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Xo(Xe.layout_symbol["icon-ignore-placement"]),"icon-optional":new Xo(Xe.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Xo(Xe.layout_symbol["icon-rotation-alignment"]),"icon-size":new Qo(Xe.layout_symbol["icon-size"]),"icon-text-fit":new Xo(Xe.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Xo(Xe.layout_symbol["icon-text-fit-padding"]),"icon-image":new Qo(Xe.layout_symbol["icon-image"]),"icon-rotate":new Qo(Xe.layout_symbol["icon-rotate"]),"icon-padding":new Xo(Xe.layout_symbol["icon-padding"]),"icon-keep-upright":new Xo(Xe.layout_symbol["icon-keep-upright"]),"icon-offset":new Qo(Xe.layout_symbol["icon-offset"]),"icon-anchor":new Qo(Xe.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Xo(Xe.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Xo(Xe.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Xo(Xe.layout_symbol["text-rotation-alignment"]),"text-field":new Qo(Xe.layout_symbol["text-field"]),"text-font":new Qo(Xe.layout_symbol["text-font"]),"text-size":new Qo(Xe.layout_symbol["text-size"]),"text-max-width":new Qo(Xe.layout_symbol["text-max-width"]),"text-line-height":new Qo(Xe.layout_symbol["text-line-height"]),"text-letter-spacing":new Qo(Xe.layout_symbol["text-letter-spacing"]),"text-justify":new Qo(Xe.layout_symbol["text-justify"]),"text-radial-offset":new Qo(Xe.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Xo(Xe.layout_symbol["text-variable-anchor"]),"text-anchor":new Qo(Xe.layout_symbol["text-anchor"]),"text-max-angle":new Xo(Xe.layout_symbol["text-max-angle"]),"text-writing-mode":new Xo(Xe.layout_symbol["text-writing-mode"]),"text-rotate":new Qo(Xe.layout_symbol["text-rotate"]),"text-padding":new Xo(Xe.layout_symbol["text-padding"]),"text-keep-upright":new Xo(Xe.layout_symbol["text-keep-upright"]),"text-transform":new Qo(Xe.layout_symbol["text-transform"]),"text-offset":new Qo(Xe.layout_symbol["text-offset"]),"text-allow-overlap":new Xo(Xe.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Xo(Xe.layout_symbol["text-ignore-placement"]),"text-optional":new Xo(Xe.layout_symbol["text-optional"])});var dp={paint:new Jo({"icon-opacity":new Qo(Xe.paint_symbol["icon-opacity"]),"icon-color":new Qo(Xe.paint_symbol["icon-color"]),"icon-halo-color":new Qo(Xe.paint_symbol["icon-halo-color"]),"icon-halo-width":new Qo(Xe.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Qo(Xe.paint_symbol["icon-halo-blur"]),"icon-translate":new Xo(Xe.paint_symbol["icon-translate"]),"icon-translate-anchor":new Xo(Xe.paint_symbol["icon-translate-anchor"]),"text-opacity":new Qo(Xe.paint_symbol["text-opacity"]),"text-color":new Qo(Xe.paint_symbol["text-color"],{runtimeType:ut,getOverride:e=>e.textColor,hasOverride:e=>!!e.textColor}),"text-halo-color":new Qo(Xe.paint_symbol["text-halo-color"]),"text-halo-width":new Qo(Xe.paint_symbol["text-halo-width"]),"text-halo-blur":new Qo(Xe.paint_symbol["text-halo-blur"]),"text-translate":new Xo(Xe.paint_symbol["text-translate"]),"text-translate-anchor":new Xo(Xe.paint_symbol["text-translate-anchor"])}),layout:fp};class pp{constructor(e){this.type=e.property.overrides?e.property.overrides.runtimeType:it,this.defaultValue=e}evaluate(e){if(e.formattedSection){const t=this.defaultValue.property.overrides;if(t&&t.hasOverride(e.formattedSection))return t.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}ji(pp,"FormatSectionOverride",{omit:["defaultValue"]});class mp extends xs{constructor(e){super(e,dp)}recalculate(e,t){super.recalculate(e,t),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const r=this.layout.get("text-writing-mode");if(r){const e=[];for(const t of r)e.indexOf(t)<0&&e.push(t);this.layout._values["text-writing-mode"]=e}else this.layout._values["text-writing-mode"]="point"===this.layout.get("symbol-placement")?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(e,t,r,n){const i=this.layout.get(e).evaluate(t,{},r,n),o=this._unevaluatedLayout._values[e];return o.isDataDriven()||Wn(o.value)||!i?i:function(e,t){return t.replace(/{([^{}]+)}/g,((t,r)=>r in e?String(e[r]):""))}(t.properties,i)}createBucket(e){return new hp(e)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const e of dp.paint.overridableProperties){if(!mp.hasPaintOverride(this.layout,e))continue;const t=this.paint.get(e),r=new pp(t),n=new Vn(r,t.property.specification);let i=null;i="constant"===t.value.kind||"source"===t.value.kind?new Gn("source",n):new Hn("composite",n,t.value.zoomStops,t.value._interpolationType),this.paint._values[e]=new qo(t.property,i,t.parameters)}}_handleOverridablePaintPropertyUpdate(e,t,r){return!(!this.layout||t.isDataDriven()||r.isDataDriven())&&mp.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,t){const r=e.get("text-field"),n=dp.paint.properties[t];let i=!1;const o=e=>{for(const t of e)if(n.overrides&&n.overrides.hasOverride(t))return void(i=!0)};if("constant"===r.value.kind&&r.value.value instanceof Pt)o(r.value.value.sections);else if("source"===r.value.kind){const e=t=>{i||(t instanceof zt&&Rt(t.value)===ft?o(t.value.sections):t instanceof jt?o(t.sections):t.eachChild(e))},t=r.value;t._styleExpression&&e(t._styleExpression.expression)}return i}getProgramConfiguration(e){return new ds(this,e)}}var gp={paint:new Jo({"background-color":new Xo(Xe.paint_background["background-color"]),"background-pattern":new Xo(Xe.paint_background["background-pattern"]),"background-opacity":new Xo(Xe.paint_background["background-opacity"])})},yp={paint:new Jo({"raster-opacity":new Xo(Xe.paint_raster["raster-opacity"]),"raster-hue-rotate":new Xo(Xe.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Xo(Xe.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Xo(Xe.paint_raster["raster-brightness-max"]),"raster-saturation":new Xo(Xe.paint_raster["raster-saturation"]),"raster-contrast":new Xo(Xe.paint_raster["raster-contrast"]),"raster-resampling":new Xo(Xe.paint_raster["raster-resampling"]),"raster-fade-duration":new Xo(Xe.paint_raster["raster-fade-duration"])})};class vp extends xs{constructor(e){super(e,{}),this.implementation=e}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}isLayerDraped(){return void 0!==this.implementation.renderToTile}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(e){this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)}onRemove(e){this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)}}var _p={paint:new Jo({"sky-type":new Xo(Xe.paint_sky["sky-type"]),"sky-atmosphere-sun":new Xo(Xe.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Xo(Xe.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Xo(Xe.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Xo(Xe.paint_sky["sky-gradient-radius"]),"sky-gradient":new $o(Xe.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Xo(Xe.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Xo(Xe.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Xo(Xe.paint_sky["sky-opacity"])})};function bp(e,t,r){const n=[0,0,1],i=hu([]);return du(i,i,r?-v(e)+Math.PI:v(e)),fu(i,i,-v(t)),ru(n,n,i),$s(n,n)}const xp={circle:class extends xs{constructor(e){super(e,jc)}createBucket(e){return new Ac(e)}queryRadius(e){const t=e;return zc("circle-radius",this,t)+zc("circle-stroke-width",this,t)+Nc(this.paint.get("circle-translate"))}queryIntersectsFeature(e,t,r,n,i,o,a,s){const u=Zc(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),o.angle,e.pixelToTileUnitsFactor),c=this.paint.get("circle-radius").evaluate(t,r)+this.paint.get("circle-stroke-width").evaluate(t,r);return Vc(e,n,o,a,s,"map"===this.paint.get("circle-pitch-alignment"),"map"===this.paint.get("circle-pitch-scale"),u,c)}getProgramIds(){return["circle"]}getProgramConfiguration(e){return new ds(this,e)}},heatmap:class extends xs{createBucket(e){return new qc(e)}constructor(e){super(e,el),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(e){"heatmap-color"===e&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=tl({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(e){return zc("heatmap-radius",this,e)}queryIntersectsFeature(e,t,r,n,i,o,a,s){const u=this.paint.get("heatmap-radius").evaluate(t,r);return Vc(e,n,o,a,s,!0,!0,new p(0,0),u)}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(e){return new ds(this,e)}},hillshade:class extends xs{constructor(e){super(e,rl)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends xs{constructor(e){super(e,jl)}getProgramIds(){const e=this.paint.get("fill-pattern"),t=e&&e.constantOr(1),r=[t?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&r.push(t&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),r}getProgramConfiguration(e){return new ds(this,e)}recalculate(e,t){super.recalculate(e,t);const r=this.paint._values["fill-outline-color"];"constant"===r.value.kind&&void 0===r.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(e){return new Zl(e)}queryRadius(){return Nc(this.paint.get("fill-translate"))}queryIntersectsFeature(e,t,r,n,i,o){return!e.queryGeometry.isAboveHorizon&&Tc(Uc(e.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),o.angle,e.pixelToTileUnitsFactor),n)}isTileClipped(){return!0}},"fill-extrusion":class extends xs{constructor(e){super(e,kh)}createBucket(e){return new dh(e)}queryRadius(){return Nc(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(e){return new ds(this,e)}queryIntersectsFeature(e,t,r,n,i,o,a,s,u){const c=Zc(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),o.angle,e.pixelToTileUnitsFactor),l=this.paint.get("fill-extrusion-height").evaluate(t,r),h=this.paint.get("fill-extrusion-base").evaluate(t,r),f=[0,0],d=s&&o.elevation,m=o.elevation?o.elevation.exaggeration():1,g=e.tile.getBucket(this);if(d&&g instanceof dh){const e=g.centroidVertexArray,t=u+1;t<e.length&&(f[0]=e.geta_centroid_pos0(t),f[1]=e.geta_centroid_pos1(t))}if(0===f[0]&&1===f[1])return!1;"globe"===o.projection.name&&(n=xh([n],[new p(0,0),new p(Es,Es)],e.tileID.canonical).map((e=>e.polygon)).flat());const y=d?s:null,[v,_]=function(e,t,r,n,i,o,a,s,u,c,l){return"globe"===e.projection.name?function(e,t,r,n,i,o,a,s,u,c,l){const h=[],f=[],d=e.projection.upVectorScale(l,e.center.lat,e.worldSize).metersToTile,p=[0,0,0,1],m=[0,0,0,1],g=(e,t,r,n)=>{e[0]=t,e[1]=r,e[2]=n,e[3]=1},y=bh();r>0&&(r+=y),n+=y;for(const v of t){const t=[],y=[];for(const h of v){const f=h.x+i.x,v=h.y+i.y,_=e.projection.projectTilePoint(f,v,l),b=e.projection.upVector(l,h.x,h.y);let x=r,w=n;if(a){const e=Bh(f,v,r,n,a,s,u,c);x+=e.base,w+=e.top}0!==r?g(p,_.x+b[0]*d*x,_.y+b[1]*d*x,_.z+b[2]*d*x):g(p,_.x,_.y,_.z),g(m,_.x+b[0]*d*w,_.y+b[1]*d*w,_.z+b[2]*d*w),tu(p,p,o),tu(m,m,o),t.push(new Ih(p[0],p[1],p[2])),y.push(new Ih(m[0],m[1],m[2]))}h.push(t),f.push(y)}return[h,f]}(e,t,r,n,i,o,a,s,u,c,l):a?function(e,t,r,n,i,o,a,s,u){const c=[],l=[],h=[0,0,0,1];for(const f of e){const e=[],d=[];for(const c of f){const l=c.x+n.x,f=c.y+n.y,p=Bh(l,f,t,r,o,a,s,u);h[0]=l,h[1]=f,h[2]=p.base,h[3]=1,cu(h,h,i),h[3]=Math.max(h[3],1e-5);const m=new Ih(h[0]/h[3],h[1]/h[3],h[2]/h[3]);h[0]=l,h[1]=f,h[2]=p.top,h[3]=1,cu(h,h,i),h[3]=Math.max(h[3],1e-5);const g=new Ih(h[0]/h[3],h[1]/h[3],h[2]/h[3]);e.push(m),d.push(g)}c.push(e),l.push(d)}return[c,l]}(t,r,n,i,o,a,s,u,c):function(e,t,r,n,i){const o=[],a=[],s=i[8]*t,u=i[9]*t,c=i[10]*t,l=i[11]*t,h=i[8]*r,f=i[9]*r,d=i[10]*r,p=i[11]*r;for(const m of e){const e=[],t=[];for(const r of m){const o=r.x+n.x,a=r.y+n.y,m=i[0]*o+i[4]*a+i[12],g=i[1]*o+i[5]*a+i[13],y=i[2]*o+i[6]*a+i[14],v=i[3]*o+i[7]*a+i[15],_=m+s,b=g+u,x=y+c,w=Math.max(v+l,1e-5),k=m+h,A=g+f,E=y+d,S=Math.max(v+p,1e-5);e.push(new Ih(_/w,b/w,x/w)),t.push(new Ih(k/S,A/S,E/S))}o.push(e),a.push(t)}return[o,a]}(t,r,n,i,o)}(o,n,h,l,c,a,y,f,m,o.center.lat,e.tileID.canonical),b=e.queryGeometry;return function(e,t,r){let n=1/0;Tc(r,t)&&(n=Ch(r,t[0]));for(let i=0;i<t.length;i++){const o=t[i],a=e[i];for(let e=0;e<o.length-1;e++){const t=o[e],i=[t,o[e+1],a[e+1],a[e],t];Ec(r,i)&&(n=Math.min(n,Ch(r,i)))}}return n!==1/0&&n}(v,_,b.isPointQuery()?b.screenBounds:b.screenGeometry)}},line:class extends xs{constructor(e){super(e,Fh),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(e){if("line-gradient"===e){const e=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=e._styleExpression&&e._styleExpression.expression instanceof Sr,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(e,t){super.recalculate(e,t),this.paint._values["line-floorwidth"]=jh.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)}createBucket(e){return new Uh(e)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(e){return new ds(this,e)}queryRadius(e){const t=e,r=Vh(zc("line-width",this,t),zc("line-gap-width",this,t)),n=zc("line-offset",this,t);return r/2+Math.abs(n)+Nc(this.paint.get("line-translate"))}queryIntersectsFeature(e,t,r,n,i,o){if(e.queryGeometry.isAboveHorizon)return!1;const a=Uc(e.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),o.angle,e.pixelToTileUnitsFactor),s=e.pixelToTileUnitsFactor/2*Vh(this.paint.get("line-width").evaluate(t,r),this.paint.get("line-gap-width").evaluate(t,r)),u=this.paint.get("line-offset").evaluate(t,r);return u&&(n=function(e,t){const r=[],n=new p(0,0);for(let i=0;i<e.length;i++){const o=e[i],a=[];for(let e=0;e<o.length;e++){const r=o[e-1],i=o[e],s=o[e+1],u=0===e?n:i.sub(r)._unit()._perp(),c=e===o.length-1?n:s.sub(i)._unit()._perp(),l=u._add(c)._unit();l._mult(1/(l.x*c.x+l.y*c.y)),a.push(l._mult(t)._add(i))}r.push(a)}return r}(n,u*e.pixelToTileUnitsFactor)),function(e,t,r){for(let n=0;n<t.length;n++){const i=t[n];if(e.length>=3)for(let t=0;t<i.length;t++)if(Rc(e,i[t]))return!0;if(Mc(e,i,r))return!0}return!1}(a,n,s)}isTileClipped(){return!0}},symbol:mp,background:class extends xs{constructor(e){super(e,gp)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends xs{constructor(e){super(e,yp)}getProgramIds(){return["raster"]}},sky:class extends xs{constructor(e){super(e,_p),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(e){"sky-gradient"===e?this._updateColorRamp():"sky-atmosphere-sun"!==e&&"sky-atmosphere-halo-color"!==e&&"sky-atmosphere-color"!==e&&"sky-atmosphere-sun-intensity"!==e||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=tl({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(e){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const t=e.style.light.properties.get("position");return this._lightPosition.azimuthal!==t.azimuthal||this._lightPosition.polar!==t.polar}return!1}getCenter(e,t){if("atmosphere"===this.paint.get("sky-type")){const r=this.paint.get("sky-atmosphere-sun"),n=!r,i=e.style.light,o=i.properties.get("position");return n&&"viewport"===i.properties.get("anchor")&&F("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),n?bp(o.azimuthal,90-o.polar,t):bp(r[0],90-r[1],t)}const r=this.paint.get("sky-gradient-center");return bp(r[0],90-r[1],t)}is3D(){return!1}isSky(){return!0}markSkyboxValid(e){this._skyboxInvalidated=!1,this._lightPosition=e.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const e=this.paint.get("sky-type");return"atmosphere"===e?["skyboxCapture","skybox"]:"gradient"===e?["skyboxGradient"]:null}}};class wp{constructor(e,t,r,n){this.context=e,this.format=r,this.texture=e.gl.createTexture(),this.update(t,n)}update(e,r,n){const{width:i,height:o}=e,{context:a}=this,{gl:s}=a,{HTMLImageElement:u,HTMLCanvasElement:c,HTMLVideoElement:l,ImageData:h,ImageBitmap:f}=t;if(s.bindTexture(s.TEXTURE_2D,this.texture),a.pixelStoreUnpackFlipY.set(!1),a.pixelStoreUnpack.set(1),a.pixelStoreUnpackPremultiplyAlpha.set(this.format===s.RGBA&&(!r||!1!==r.premultiply)),n||this.size&&this.size[0]===i&&this.size[1]===o){const{x:t,y:r}=n||{x:0,y:0};e instanceof u||e instanceof c||e instanceof l||e instanceof h||f&&e instanceof f?s.texSubImage2D(s.TEXTURE_2D,0,t,r,s.RGBA,s.UNSIGNED_BYTE,e):s.texSubImage2D(s.TEXTURE_2D,0,t,r,i,o,s.RGBA,s.UNSIGNED_BYTE,e.data)}else this.size=[i,o],e instanceof u||e instanceof c||e instanceof l||e instanceof h||f&&e instanceof f?s.texImage2D(s.TEXTURE_2D,0,this.format,this.format,s.UNSIGNED_BYTE,e):s.texImage2D(s.TEXTURE_2D,0,this.format,i,o,0,this.format,s.UNSIGNED_BYTE,e.data);this.useMipmap=Boolean(r&&r.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&s.generateMipmap(s.TEXTURE_2D)}bind(e,t){const{context:r}=this,{gl:n}=r;n.bindTexture(n.TEXTURE_2D,this.texture),e!==this.filter&&(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,e),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,this.useMipmap?e===n.NEAREST?n.NEAREST_MIPMAP_NEAREST:n.LINEAR_MIPMAP_NEAREST:e),this.filter=e),t!==this.wrap&&(n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,t),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,t),this.wrap=t)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}class kp{constructor(e){this._callback=e,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._callback()}),0))}remove(){this._channel=void 0,this._callback=()=>{}}}class Ap{constructor(){this.tasks={},this.taskQueue=[],L(["process"],this),this.invoker=new kp(this.process),this.nextId=0}add(e,t){const r=this.nextId++,n=function({type:e,isSymbolTile:t,zoom:r}){return r=r||0,"message"===e?0:"maybePrepare"!==e||t?"parseTile"!==e||t?"parseTile"===e&&t?300-r:"maybePrepare"===e&&t?400-r:500:200-r:100-r}(t);if(0===n){W();try{e()}finally{}return{cancel:()=>{}}}return this.tasks[r]={fn:e,metadata:t,priority:n,id:r},this.taskQueue.push(r),this.invoker.trigger(),{cancel:()=>{delete this.tasks[r]}}}process(){W();try{if(this.taskQueue=this.taskQueue.filter((e=>!!this.tasks[e])),!this.taskQueue.length)return;const e=this.pick();if(null===e)return;const t=this.tasks[e];if(delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),!t)return;t.fn()}finally{}}pick(){let e=null,t=1/0;for(let n=0;n<this.taskQueue.length;n++){const r=this.tasks[this.taskQueue[n]];r.priority<t&&(t=r.priority,e=n)}if(null===e)return null;const r=this.taskQueue[e];return this.taskQueue.splice(e,1),r}remove(){this.invoker.remove()}}class Ep{constructor(e){this._stringToNumber={},this._numberToString=[];for(let t=0;t<e.length;t++){const r=e[t];this._stringToNumber[r]=t,this._numberToString[t]=r}}encode(e){return this._stringToNumber[e]}decode(e){return this._numberToString[e]}}const Sp=["tile","layer","source","sourceLayer","state"];class Tp{constructor(e,t,r,n,i){this.type="Feature",this._vectorTileFeature=e,this._z=t,this._x=r,this._y=n,this.properties=e.properties,this.id=i}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={type:"Feature",geometry:this.geometry,properties:this.properties};void 0!==this.id&&(e.id=this.id);for(const t of Sp)void 0!==this[t]&&(e[t]=this[t]);return e}}const Mp=32,Ip=33,Pp=new Uint16Array(8184);for(let ym=0;ym<2046;ym++){let e=ym+2,t=0,r=0,n=0,i=0,o=0,a=0;for(1&e?n=i=o=Mp:t=r=a=Mp;(e>>=1)>1;){const s=t+n>>1,u=r+i>>1;1&e?(n=t,i=r,t=o,r=a):(t=n,r=i,n=o,i=a),o=s,a=u}const s=4*ym;Pp[s+0]=t,Pp[s+1]=r,Pp[s+2]=n,Pp[s+3]=i}const Cp=new Uint16Array(2178),Bp=new Uint8Array(1089),Dp=new Uint16Array(1089);function Rp(e){return 0===e?-.03125:32===e?.03125:0}var Lp=ia([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const Op={type:2,extent:Es,loadGeometry:()=>[[new p(0,0),new p(8193,0),new p(8193,8193),new p(0,8193),new p(0,0)]]};class zp{constructor(e,t,r,n,i){this.tileID=e,this.uid=C(),this.uses=0,this.tileSize=t,this.tileZoom=r,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=i,this.expiredRequestCount=0,this.state="loading",n&&n.transform&&(this.projection=n.transform.projection)}registerFadeDuration(e){const t=e+this.timeAdded;t<We.now()||this.fadeEndTime&&t<this.fadeEndTime||(this.fadeEndTime=t)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}get tileTransform(){return this._tileTransform||(this._tileTransform=Ld(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(e,t,r){if(this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(e,t){const r={};if(!t)return r;for(const n of e){const e=n.layerIds.map((e=>t.getLayer(e))).filter(Boolean);if(0!==e.length){n.layers=e,n.stateDependentLayerIds&&(n.stateDependentLayers=n.stateDependentLayerIds.map((t=>e.filter((e=>e.id===t))[0])));for(const t of e)r[t.id]=n}}return r}(e.buckets,t.style),this.hasSymbolBuckets=!1;for(const e in this.buckets){const t=this.buckets[e];if(t instanceof hp){if(this.hasSymbolBuckets=!0,!r)break;t.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const e in this.buckets){const t=this.buckets[e];if(t instanceof hp&&t.hasRTLText){this.hasRTLText=!0,Zo.isLoading()||Zo.isLoaded()||"deferred"!==No()||Uo();break}}this.queryPadding=0;for(const e in this.buckets){const r=this.buckets[e];this.queryPadding=Math.max(this.queryPadding,t.style.getLayer(e).queryRadius(r))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage),e.lineAtlas&&(this.lineAtlas=e.lineAtlas)}else this.collisionBoxArray=new Ba}unloadVectorData(){if(this.hasData()){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(e){return this.buckets[e.id]}upload(e){for(const r in this.buckets){const t=this.buckets[r];t.uploadPending()&&t.upload(e)}const t=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new wp(e,this.imageAtlas.image,t.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new wp(e,this.glyphAtlasImage,t.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new wp(e,this.lineAtlas.image,t.ALPHA),this.lineAtlas.uploaded=!0)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,t,r,n,i,o,a,s){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:n,pixelPosMatrix:a,transform:o,params:i,tileTransform:this.tileTransform},e,t,r):{}}querySourceFeatures(e,t){const r=this.latestFeatureIndex;if(!r||!r.rawTileData)return;const n=r.loadVTLayers(),i=t?t.sourceLayer:"",o=n._geojsonTileLayer||n[i];if(!o)return;const a=ai(t&&t.filter),{z:s,x:u,y:c}=this.tileID.canonical,l={z:s,x:u,y:c};for(let h=0;h<o.length;h++){const t=o.feature(h);if(a.needGeometry){const e=xc(t,!0);if(!a.filter(new Fo(this.tileID.overscaledZ),e,this.tileID.canonical))continue}else if(!a.filter(new Fo(this.tileID.overscaledZ),t))continue;const n=r.getId(t,i),f=new Tp(t,s,u,c,n);f.tile=l,e.push(f)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const t=this.expirationTime;if(e.cacheControl){const t=K(e.cacheControl);t["max-age"]&&(this.expirationTime=Date.now()+1e3*t["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const e=Date.now();let r=!1;if(this.expirationTime>e)r=!1;else if(t)if(this.expirationTime<t)r=!0;else{const n=this.expirationTime-t;n?this.expirationTime=e+Math.max(n,3e4):r=!0}else r=!0;r?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(e,t){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(e).length||!t)return;const r=this.latestFeatureIndex.loadVTLayers(),n=t.style.listImages();for(const i in this.buckets){if(!t.style.hasLayer(i))continue;const o=this.buckets[i],a=o.layers[0].sourceLayer||"_geojsonTileLayer",s=r[a],u=e[a];if(!s||!u||0===Object.keys(u).length)continue;if(o.update(u,s,n,this.imageAtlas&&this.imageAtlas.patternPositions||{}),o instanceof Uh||o instanceof Zl){const e=t.style._getSourceCache(o.layers[0].source);t._terrain&&t._terrain.enabled&&e&&o.programConfigurations.needsUpload&&t._terrain._clearRenderCacheForTile(e.id,this.tileID)}const c=t&&t.style&&t.style.getLayer(i);c&&(this.queryPadding=Math.max(this.queryPadding,c.queryRadius(o)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<We.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=We.now()+e}setTexture(e,t){const r=t.context,n=r.gl;this.texture=this.texture||t.getTileTexture(e.width),this.texture?this.texture.update(e,{useMipmap:!0}):(this.texture=new wp(r,e,n.RGBA,{useMipmap:!0}),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),r.extTextureFilterAnisotropic&&n.texParameterf(n.TEXTURE_2D,r.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,r.extTextureFilterAnisotropicMax))}setDependencies(e,t){const r={};for(const n of t)r[n]=!0;this.dependencies[e]=r}hasDependency(e,t){for(const r of e){const e=this.dependencies[r];if(e)for(const r of t)if(e[r])return!0}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(e,t){if(!t||"mercator"===t.name||this._tileDebugBuffer)return;const r=bc(Op,this.tileID.canonical,this.tileTransform)[0],n=new aa,i=new Ia;for(let o=0;o<r.length;o++){const{x:e,y:t}=r[o];n.emplaceBack(e,t),i.emplaceBack(o)}i.emplaceBack(0),this._tileDebugIndexBuffer=e.createIndexBuffer(i),this._tileDebugBuffer=e.createVertexBuffer(n,vu.members),this._tileDebugSegments=As.simpleSegment(0,0,n.length,i.length)}_makeTileBoundsBuffers(e,t){if(this._tileBoundsBuffer||!t||"mercator"===t.name)return;const r=bc(Op,this.tileID.canonical,this.tileTransform)[0];let n,i;if(this.isRaster){const e=function(e,t){const r=Ld(e,t),n=Math.pow(2,e.z);for(let c=0;c<Ip;c++)for(let i=0;i<Ip;i++){const o=sc((e.x+(i+Rp(i))/Mp)/n),a=uc((e.y+(c+Rp(c))/Mp)/n),s=t.project(o,a),u=c*Ip+i;Cp[2*u+0]=Math.round((s.x*r.scale-r.x)*Es),Cp[2*u+1]=Math.round((s.y*r.scale-r.y)*Es)}Bp.fill(0),Dp.fill(0);for(let c=2045;c>=0;c--){const e=4*c,t=Pp[e+0],r=Pp[e+1],n=Pp[e+2],i=Pp[e+3],o=t+n>>1,a=r+i>>1,s=o+a-r,u=a+t-o,l=r*Ip+t,h=i*Ip+n,f=a*Ip+o,d=Math.hypot((Cp[2*l+0]+Cp[2*h+0])/2-Cp[2*f+0],(Cp[2*l+1]+Cp[2*h+1])/2-Cp[2*f+1])>=16;if(Bp[f]=Bp[f]||(d?1:0),c<1022){const e=(r+u>>1)*Ip+(t+s>>1),o=(i+u>>1)*Ip+(n+s>>1);Bp[f]=Bp[f]||Bp[e]||Bp[o]}}const i=new ua,o=new wa;let a=0;function s(e,t){const r=t*Ip+e;return 0===Dp[r]&&(i.emplaceBack(Cp[2*r+0],Cp[2*r+1],e*Es/Mp,t*Es/Mp),Dp[r]=++a),Dp[r]-1}function u(e,t,r,n,i,a){const c=e+r>>1,l=t+n>>1;if(Math.abs(e-i)+Math.abs(t-a)>1&&Bp[l*Ip+c])u(i,a,e,t,c,l),u(r,n,i,a,c,l);else{const u=s(e,t),c=s(r,n),l=s(i,a);o.emplaceBack(u,c,l)}}return u(0,0,Mp,Mp,Mp,0),u(Mp,Mp,0,0,0,Mp),{vertices:i,indices:o}}(this.tileID.canonical,t);n=e.vertices,i=e.indices}else{n=new ua,i=new wa;for(const{x:t,y:i}of r)n.emplaceBack(t,i,0,0);const e=ol(n.int16,void 0,4);for(let t=0;t<e.length;t+=3)i.emplaceBack(e[t],e[t+1],e[t+2])}this._tileBoundsBuffer=e.createVertexBuffer(n,Lp.members),this._tileBoundsIndexBuffer=e.createIndexBuffer(i),this._tileBoundsSegments=As.simpleSegment(0,0,n.length,i.length)}_makeGlobeTileDebugBuffers(e,t){const r=t.projection;if(!r||"globe"!==r.name||t.freezeTileCoverage)return;const n=this.tileID.canonical,i=Ku(Lu(n,t)),o=qu(t.zoom);let a;o>0&&(a=Bs(new Float64Array(16),t.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(e,n,t,i,a,o),this._makeGlobeTileDebugTextBuffer(e,n,t,i,a,o)}_globePoint(e,t,r,n,i,o,a){let s=ju(e,t,r);if(o){const i=1<<r.z,u=ic(n.center.lng),c=oc(n.center.lat),l=(r.x+.5)/i-u;let h=0;l>.5?h=-1:l<-.5&&(h=1);let f=(e/Es+r.x)/i+h,d=(t/Es+r.y)/i;f=(f-u)*n._pixelsPerMercatorPixel+u,d=(d-c)*n._pixelsPerMercatorPixel+c;const p=[f*n.worldSize,d*n.worldSize,0];tu(p,p,o),s=Ru(s,p,a)}return tu(s,s,i)}_makeGlobeTileDebugBorderBuffer(e,t,r,n,i,o){const a=new aa,s=new Ia,u=new sa,c=(e,c,l,h,f)=>{const d=(l-e)/(f-1),p=(h-c)/(f-1),m=a.length;for(let g=0;g<f;g++){const l=e+g*d,h=c+g*p;a.emplaceBack(l,h);const f=this._globePoint(l,h,t,r,n,i,o);u.emplaceBack(f[0],f[1],f[2]),s.emplaceBack(m+g)}},l=Es;c(0,0,l,0,16),c(l,0,l,l,16),c(l,l,0,l,16),c(0,l,0,0,16),this._tileDebugIndexBuffer=e.createIndexBuffer(s),this._tileDebugBuffer=e.createVertexBuffer(a,vu.members),this._globeTileDebugBorderBuffer=e.createVertexBuffer(u,yu.members),this._tileDebugSegments=As.simpleSegment(0,0,a.length,s.length)}_makeGlobeTileDebugTextBuffer(e,t,r,n,i,o){const a=new aa,s=new wa,u=new sa,c=25;s.reserve(32),a.reserve(c),u.reserve(c);const l=(e,t)=>c*e+t;for(let h=0;h<c;h++){const e=2048*h;for(let s=0;s<c;s++){const c=2048*s;a.emplaceBack(c,e);const l=this._globePoint(c,e,t,r,n,i,o);u.emplaceBack(l[0],l[1],l[2])}}for(let h=0;h<4;h++)for(let e=0;e<4;e++){const t=l(h,e),r=l(h,e+1),n=l(h+1,e),i=l(h+1,e+1);s.emplaceBack(t,r,n),s.emplaceBack(n,r,i)}this._tileDebugTextIndexBuffer=e.createIndexBuffer(s),this._tileDebugTextBuffer=e.createVertexBuffer(a,vu.members),this._globeTileDebugTextBuffer=e.createVertexBuffer(u,yu.members),this._tileDebugTextSegments=As.simpleSegment(0,0,c,32)}}class Np{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,t,r){const n=String(t);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][n]=this.stateChanges[e][n]||{},I(this.stateChanges[e][n],r),null===this.deletedStates[e]){this.deletedStates[e]={};for(const t in this.state[e])t!==n&&(this.deletedStates[e][t]=null)}else if(this.deletedStates[e]&&null===this.deletedStates[e][n]){this.deletedStates[e][n]={};for(const t in this.state[e][n])r[t]||(this.deletedStates[e][n][t]=null)}else for(const i in r)this.deletedStates[e]&&this.deletedStates[e][n]&&null===this.deletedStates[e][n][i]&&delete this.deletedStates[e][n][i]}removeFeatureState(e,t,r){if(null===this.deletedStates[e])return;const n=String(t);if(this.deletedStates[e]=this.deletedStates[e]||{},r&&void 0!==t)null!==this.deletedStates[e][n]&&(this.deletedStates[e][n]=this.deletedStates[e][n]||{},this.deletedStates[e][n][r]=null);else if(void 0!==t)if(this.stateChanges[e]&&this.stateChanges[e][n])for(r in this.deletedStates[e][n]={},this.stateChanges[e][n])this.deletedStates[e][n][r]=null;else this.deletedStates[e][n]=null;else this.deletedStates[e]=null}getState(e,t){const r=String(t),n=I({},(this.state[e]||{})[r],(this.stateChanges[e]||{})[r]);if(null===this.deletedStates[e])return{};if(this.deletedStates[e]){const r=this.deletedStates[e][t];if(null===r)return{};for(const e in r)delete n[e]}return n}initializeTileState(e,t){e.setFeatureState(this.state,t)}coalesceChanges(e,t){const r={};for(const n in this.stateChanges){this.state[n]=this.state[n]||{};const e={};for(const t in this.stateChanges[n])this.state[n][t]||(this.state[n][t]={}),I(this.state[n][t],this.stateChanges[n][t]),e[t]=this.state[n][t];r[n]=e}for(const n in this.deletedStates){this.state[n]=this.state[n]||{};const e={};if(null===this.deletedStates[n])for(const t in this.state[n])e[t]={},this.state[n][t]={};else for(const t in this.deletedStates[n]){if(null===this.deletedStates[n][t])this.state[n][t]={};else if(this.state[n][t])for(const e of Object.keys(this.deletedStates[n][t]))delete this.state[n][t][e];e[t]=this.state[n][t]}r[n]=r[n]||{},I(r[n],e)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(r).length)for(const n in e)e[n].setFeatureState(r,t)}}class Up{constructor(e){this.size=e,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(e,t){const r=this.toIdx(e,t);return{min:this.minimums[r],max:this.maximums[r]}}isLeaf(e,t){return this.leaves[this.toIdx(e,t)]}toIdx(e,t){return t*this.size+e}}function Zp(e,t,r,n){let i=0,o=Number.MAX_VALUE;for(let a=0;a<3;a++)if(Math.abs(n[a])<1e-15){if(r[a]<e[a]||r[a]>t[a])return null}else{const s=1/n[a];let u=(e[a]-r[a])*s,c=(t[a]-r[a])*s;if(u>c){const e=u;u=c,c=e}if(u>i&&(i=u),c<o&&(o=c),i>o)return null}return i}function Fp(e,t,r,n,i,o,a,s,u,c,l){const h=n-e,f=i-t,d=o-r,p=a-e,m=s-t,g=u-r,y=l[1]*g-l[2]*m,v=l[2]*p-l[0]*g,_=l[0]*m-l[1]*p,b=h*y+f*v+d*_;if(Math.abs(b)<1e-15)return null;const x=1/b,w=c[0]-e,k=c[1]-t,A=c[2]-r,E=(w*y+k*v+A*_)*x;if(E<0||E>1)return null;const S=k*d-A*f,T=A*h-w*d,M=w*f-k*h,I=(l[0]*S+l[1]*T+l[2]*M)*x;return I<0||E+I>1?null:(p*S+m*T+g*M)*x}function jp(e,t,r){return(e-t)/(r-t)}function Vp(e,t,r,n,i,o,a,s,u){const c=1<<r,l=o-n,h=a-i,f=(e+1)/c*l+n,d=(t+0)/c*h+i,p=(t+1)/c*h+i;s[0]=(e+0)/c*l+n,s[1]=d,u[0]=f,u[1]=p}class Wp{constructor(e){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=e,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const t=function(e){const t=Math.ceil(Math.log2(e.dim/8)),r=[];let n=Math.ceil(Math.pow(2,t));const i=1/n,o=(e,t,r,n,i)=>{const o=n?1:0,a=(e+1)*r-o,s=t*r,u=(t+1)*r-o;i[0]=e*r,i[1]=s,i[2]=a,i[3]=u};let a=new Up(n);const s=[];for(let u=0;u<n*n;u++){o(u%n,Math.floor(u/n),i,!1,s);const t=Gp(s[0],s[1],e),r=Gp(s[2],s[1],e),c=Gp(s[2],s[3],e),l=Gp(s[0],s[3],e);a.minimums.push(Math.min(t,r,c,l)),a.maximums.push(Math.max(t,r,c,l)),a.leaves.push(1)}for(r.push(a),n/=2;n>=1;n/=2){const e=r[r.length-1];a=new Up(n);for(let t=0;t<n*n;t++){o(t%n,Math.floor(t/n),2,!0,s);const r=e.getElevation(s[0],s[1]),i=e.getElevation(s[2],s[1]),u=e.getElevation(s[2],s[3]),c=e.getElevation(s[0],s[3]),l=e.isLeaf(s[0],s[1]),h=e.isLeaf(s[2],s[1]),f=e.isLeaf(s[2],s[3]),d=e.isLeaf(s[0],s[3]),p=Math.min(r.min,i.min,u.min,c.min),m=Math.max(r.max,i.max,u.max,c.max),g=l&&h&&f&&d;a.maximums.push(m),a.minimums.push(p),a.leaves.push(m-p<=5&&g?1:0)}r.push(a)}return r}(this.dem),r=t.length-1,n=t[r];this._addNode(n.minimums[0],n.maximums[0],n.leaves[0]),this._construct(t,0,0,r,0)}raycastRoot(e,t,r,n,i,o,a=1){return Zp([e,t,-100],[r,n,this.maximums[0]*a],i,o)}raycast(e,t,r,n,i,o,a=1){if(!this.nodeCount)return null;const s=this.raycastRoot(e,t,r,n,i,o,a);if(null==s)return null;const u=[],c=[],l=[],h=[],f=[{idx:0,t:s,nodex:0,nodey:0,depth:0}];for(;f.length>0;){const{idx:s,t:d,nodex:p,nodey:m,depth:g}=f.pop();if(this.leaves[s]){Vp(p,m,g,e,t,r,n,l,h);const s=1<<g,u=(p+0)/s,c=(p+1)/s,f=(m+0)/s,y=(m+1)/s,v=Gp(u,f,this.dem)*a,_=Gp(c,f,this.dem)*a,b=Gp(c,y,this.dem)*a,x=Gp(u,y,this.dem)*a,w=Fp(l[0],l[1],v,h[0],l[1],_,h[0],h[1],b,i,o),k=Fp(h[0],h[1],b,l[0],h[1],x,l[0],l[1],v,i,o),A=Math.min(null!==w?w:Number.MAX_VALUE,null!==k?k:Number.MAX_VALUE);if(A!==Number.MAX_VALUE)return A;{const e=Qs([],i,o,d);if(Kp(v,_,x,b,jp(e[0],l[0],h[0]),jp(e[1],l[1],h[1]))>=e[2])return d}continue}let y=0;for(let f=0;f<this._siblingOffset.length;f++){Vp((p<<1)+this._siblingOffset[f][0],(m<<1)+this._siblingOffset[f][1],g+1,e,t,r,n,l,h),l[2]=-100,h[2]=this.maximums[this.childOffsets[s]+f]*a;const d=Zp(l,h,i,o);if(null!=d){const e=d;u[f]=e;let t=!1;for(let r=0;r<y&&!t;r++)e>=u[c[r]]&&(c.splice(r,0,f),t=!0);t||(c[y]=f),y++}}for(let e=0;e<y;e++){const t=c[e];f.push({idx:this.childOffsets[s]+t,t:u[t],nodex:(p<<1)+this._siblingOffset[t][0],nodey:(m<<1)+this._siblingOffset[t][1],depth:g+1})}}return null}_addNode(e,t,r){return this.minimums.push(e),this.maximums.push(t),this.leaves.push(r),this.childOffsets.push(0),this.nodeCount++}_construct(e,t,r,n,i){if(1===e[n].isLeaf(t,r))return;this.childOffsets[i]||(this.childOffsets[i]=this.nodeCount);const o=n-1,a=e[o];let s=0,u=0;for(let c=0;c<this._siblingOffset.length;c++){const e=2*t+this._siblingOffset[c][0],n=2*r+this._siblingOffset[c][1],i=a.getElevation(e,n),o=a.isLeaf(e,n),l=this._addNode(i.min,i.max,o);o&&(s|=1<<c),u||(u=l)}for(let c=0;c<this._siblingOffset.length;c++)s&1<<c||this._construct(e,2*t+this._siblingOffset[c][0],2*r+this._siblingOffset[c][1],o,u+c)}}function Kp(e,t,r,n,i,o){return Tr(Tr(e,r,o),Tr(t,n,o),i)}function Gp(e,t,r){const n=r.dim,i=A(e*n-.5,0,n-1),o=A(t*n-.5,0,n-1),a=Math.floor(i),s=Math.floor(o),u=Math.min(a+1,n-1),c=Math.min(s+1,n-1);return Kp(r.get(a,s),r.get(u,s),r.get(a,c),r.get(u,c),i-a,o-s)}const Hp={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};class qp{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(e,t,r,n=!1,i=!1){if(this.uid=e,t.height!==t.width)throw new RangeError("DEM tiles must be square");if(r&&"mapbox"!==r&&"terrarium"!==r)return F(`"${r}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=t.height;const o=this.dim=t.height-2,a=new Uint32Array(t.data.buffer);if(this.pixels=new Uint8Array(t.data.buffer),this.encoding=r||"mapbox",this.borderReady=n,!n){for(let e=0;e<o;e++)a[this._idx(-1,e)]=a[this._idx(0,e)],a[this._idx(o,e)]=a[this._idx(o-1,e)],a[this._idx(e,-1)]=a[this._idx(e,0)],a[this._idx(e,o)]=a[this._idx(e,o-1)];a[this._idx(-1,-1)]=a[this._idx(0,0)],a[this._idx(o,-1)]=a[this._idx(o-1,0)],a[this._idx(-1,o)]=a[this._idx(0,o-1)],a[this._idx(o,o)]=a[this._idx(o-1,o-1)],i&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new Wp(this)}get(e,t,r=!1){r&&(e=A(e,-1,this.dim),t=A(t,-1,this.dim));const n=4*this._idx(e,t);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(this.pixels[n],this.pixels[n+1],this.pixels[n+2])}static getUnpackVector(e){return Hp[e]}get unpackVector(){return Hp[this.encoding]}_idx(e,t){if(e<-1||e>=this.dim+1||t<-1||t>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(t+1)*this.stride+(e+1)}_unpackMapbox(e,t,r){return(256*e*256+256*t+r)/10-1e4}_unpackTerrarium(e,t,r){return 256*e+t+r/256-32768}static pack(e,t){const r=[0,0,0,0],n=qp.getUnpackVector(t);let i=Math.floor((e+n[3])/n[2]);return r[2]=i%256,i=Math.floor(i/256),r[1]=i%256,i=Math.floor(i/256),r[0]=i,r}getPixels(){return new Jc({width:this.stride,height:this.stride},this.pixels)}backfillBorder(e,t,r){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let n=t*this.dim,i=t*this.dim+this.dim,o=r*this.dim,a=r*this.dim+this.dim;switch(t){case-1:n=i-1;break;case 1:i=n+1}switch(r){case-1:o=a-1;break;case 1:a=o+1}const s=-t*this.dim,u=-r*this.dim;for(let c=o;c<a;c++)for(let t=n;t<i;t++){const r=4*this._idx(t,c),n=4*this._idx(t+s,c+u);this.pixels[r+0]=e.pixels[n+0],this.pixels[r+1]=e.pixels[n+1],this.pixels[r+2]=e.pixels[n+2],this.pixels[r+3]=e.pixels[n+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}ji(qp,"DEMData"),ji(Wp,"DemMinMaxQuadTree",{omit:["dem"]});class Yp{constructor(e,t){this.max=e,this.onRemove=t,this.reset()}reset(){for(const e in this.data)for(const t of this.data[e])t.timeout&&clearTimeout(t.timeout),this.onRemove(t.value);return this.data={},this.order=[],this}add(e,t,r){const n=e.wrapped().key;void 0===this.data[n]&&(this.data[n]=[]);const i={value:t,timeout:void 0};if(void 0!==r&&(i.timeout=setTimeout((()=>{this.remove(e,i)}),r)),this.data[n].push(i),this.order.push(n),this.order.length>this.max){const e=this._getAndRemoveByKey(this.order[0]);e&&this.onRemove(e)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const t=this.data[e].shift();return t.timeout&&clearTimeout(t.timeout),0===this.data[e].length&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),t.value}getByKey(e){const t=this.data[e];return t?t[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,t){if(!this.has(e))return this;const r=e.wrapped().key,n=void 0===t?0:this.data[r].indexOf(t),i=this.data[r][n];return this.data[r].splice(n,1),i.timeout&&clearTimeout(i.timeout),0===this.data[r].length&&delete this.data[r],this.onRemove(i.value),this.order.splice(this.order.indexOf(r),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const e=this._getAndRemoveByKey(this.order[0]);e&&this.onRemove(e)}return this}filter(e){const t=[];for(const r in this.data)for(const n of this.data[r])e(n.value)||t.push(n);for(const r of t)this.remove(r.value.tileID,r)}}class Xp{constructor(e,t,r){this.func=e,this.mask=t,this.range=r}}Xp.ReadOnly=!1,Xp.ReadWrite=!0,Xp.disabled=new Xp(519,Xp.ReadOnly,[0,1]);const Qp=7680;class $p{constructor(e,t,r,n,i,o){this.test=e,this.ref=t,this.mask=r,this.fail=n,this.depthFail=i,this.pass=o}}$p.disabled=new $p({func:519,mask:0},0,0,Qp,Qp,Qp);class Jp{constructor(e,t,r){this.blendFunction=e,this.blendColor=t,this.mask=r}}Jp.Replace=[1,0],Jp.disabled=new Jp(Jp.Replace,Tt.transparent,[!1,!1,!1,!1]),Jp.unblended=new Jp(Jp.Replace,Tt.transparent,[!0,!0,!0,!0]),Jp.alphaBlended=new Jp([1,771],Tt.transparent,[!0,!0,!0,!0]);const em=1029,tm=2305;class rm{constructor(e,t,r){this.enable=e,this.mode=t,this.frontFace=r}}rm.disabled=new rm(!1,em,tm),rm.backCCW=new rm(!0,em,tm),rm.backCW=new rm(!0,em,2304),rm.frontCW=new rm(!0,1028,2304),rm.frontCCW=new rm(!0,1028,tm);class nm extends Ye{constructor(e,t,r){super(),this.id=e,this._onlySymbols=r,t.on("data",(e=>{"source"===e.dataType&&"metadata"===e.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===e.dataType&&"content"===e.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform))})),t.on("error",(()=>{this._sourceErrored=!0})),this._source=t,this._tiles={},this._cache=new Yp(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=t.minTileCacheSize,this._maxTileCacheSize=t.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new Np,this._isRaster="raster"===this._source.type||"raster-dem"===this._source.type||"custom"===this._source.type&&"raster"===this._source._dataType}onAdd(e){this.map=e,this._minTileCacheSize=void 0===this._minTileCacheSize&&e?e._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=void 0===this._maxTileCacheSize&&e?e._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded)return!1;if(!this._source.loaded())return!1;for(const e in this._tiles){const t=this._tiles[e];if("loaded"!==t.state&&"errored"!==t.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(e,t){return e.isSymbolTile=this._onlySymbols,this._source.loadTile(e,t)}_unloadTile(e){if(this._source.unloadTile)return this._source.unloadTile(e,(()=>{}))}_abortTile(e){if(this._source.abortTile)return this._source.abortTile(e,(()=>{}))}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const t in this._tiles){const r=this._tiles[t];r.upload(e),r.prepare(this.map.style.imageManager)}}getIds(){return M(this._tiles).map((e=>e.tileID)).sort(im).map((e=>e.key))}getRenderableIds(e){const t=[];for(const r in this._tiles)this._isIdRenderable(+r,e)&&t.push(this._tiles[r]);return e?t.sort(((e,t)=>{const r=e.tileID,n=t.tileID,i=new p(r.canonical.x,r.canonical.y)._rotate(this.transform.angle),o=new p(n.canonical.x,n.canonical.y)._rotate(this.transform.angle);return r.overscaledZ-n.overscaledZ||o.y-i.y||o.x-i.x})).map((e=>e.tileID.key)):t.map((e=>e.tileID)).sort(im).map((e=>e.key))}hasRenderableParent(e){const t=this.findLoadedParent(e,0);return!!t&&this._isIdRenderable(t.tileID.key)}_isIdRenderable(e,t){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(t||!this._tiles[e].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const e in this._tiles)"errored"!==this._tiles[e].state&&this._reloadTile(+e,"reloading")}}_reloadTile(e,t){const r=this._tiles[e];r&&("loading"!==r.state&&(r.state=t),this._loadTile(r,this._tileLoaded.bind(this,r,e,t)))}_tileLoaded(e,t,r,n){if(n)if(e.state="errored",404!==n.status)this._source.fire(new qe(n,{tile:e}));else if("raster-dem"===this._source.type&&this.usedForTerrain&&this.map.painter.terrain){const e=this.map.painter.terrain;this.update(this.transform,e.getScaledDemTileSize(),!0),e.resetTileLookupCache(this.id)}else this.update(this.transform);else e.timeAdded=We.now(),"expired"===r&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(t,e),"raster-dem"===this._source.type&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),this._source.fire(new He("data",{dataType:"source",tile:e,coord:e.tileID,sourceCacheId:this.id}))}_backfillDEM(e){const t=this.getRenderableIds();for(let n=0;n<t.length;n++){const i=t[n];if(e.neighboringTiles&&e.neighboringTiles[i]){const t=this.getTileByID(i);r(e,t),r(t,e)}}function r(e,t){if(!e.dem||e.dem.borderReady)return;e.needsHillshadePrepare=!0,e.needsDEMTextureUpload=!0;let r=t.tileID.canonical.x-e.tileID.canonical.x;const n=t.tileID.canonical.y-e.tileID.canonical.y,i=Math.pow(2,e.tileID.canonical.z),o=t.tileID.key;0===r&&0===n||Math.abs(n)>1||(Math.abs(r)>1&&(1===Math.abs(r+i)?r+=i:1===Math.abs(r-i)&&(r-=i)),t.dem&&e.dem&&(e.dem.backfillBorder(t.dem,r,n),e.neighboringTiles&&e.neighboringTiles[o]&&(e.neighboringTiles[o].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,t,r,n){for(const i in this._tiles){let o=this._tiles[i];if(n[i]||!o.hasData()||o.tileID.overscaledZ<=t||o.tileID.overscaledZ>r)continue;let a=o.tileID;for(;o&&o.tileID.overscaledZ>t+1;){const e=o.tileID.scaledTo(o.tileID.overscaledZ-1);o=this._tiles[e.key],o&&o.hasData()&&(a=e)}let s=a;for(;s.overscaledZ>t;)if(s=s.scaledTo(s.overscaledZ-1),e[s.key]){n[a.key]=a;break}}}findLoadedParent(e,t){if(e.key in this._loadedParentTiles){const r=this._loadedParentTiles[e.key];return r&&r.tileID.overscaledZ>=t?r:null}for(let r=e.overscaledZ-1;r>=t;r--){const t=e.scaledTo(r),n=this._getLoadedTile(t);if(n)return n}}_getLoadedTile(e){const t=this._tiles[e.key];return t&&t.hasData()?t:this._cache.getByKey(this._source.reparseOverscaled?e.wrapped().key:e.canonical.key)}updateCacheSize(e,t){t=t||this._source.tileSize;const r=Math.ceil(e.width/t)+1,n=Math.ceil(e.height/t)+1,i=Math.floor(r*n*5),o="number"==typeof this._minTileCacheSize?Math.max(this._minTileCacheSize,i):i,a="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,o):o;this._cache.setMaxSize(a)}handleWrapJump(e){const t=Math.round((e-(void 0===this._prevLng?e:this._prevLng))/360);if(this._prevLng=e,t){const e={};for(const r in this._tiles){const n=this._tiles[r];n.tileID=n.tileID.unwrapTo(n.tileID.wrap+t),e[n.tileID.key]=n}this._tiles=e;for(const t in this._timers)clearTimeout(this._timers[t]),delete this._timers[t];for(const t in this._tiles)this._setTileReloadTimer(+t,this._tiles[t])}}update(e,t,r){if(this.transform=e,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage)return;if(this.usedForTerrain&&!r)return;let n;this.updateCacheSize(e,t),"globe"!==this.transform.projection.name&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?n=e.getVisibleUnwrappedCoordinates(this._source.tileID).map((e=>new Th(e.canonical.z,e.wrap,e.canonical.z,e.canonical.x,e.canonical.y))):(n=e.coveringTiles({tileSize:t||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!r,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(n=n.filter((e=>this._source.hasTile(e))))):n=[];const i=this._updateRetainedTiles(n);if(om(this._source.type)&&0!==n.length){const e={},t={},r=Object.keys(i);for(const n of r){const r=i[n],o=this._tiles[n];if(!o||o.fadeEndTime&&o.fadeEndTime<=We.now())continue;const a=this.findLoadedParent(r,Math.max(r.overscaledZ-nm.maxOverzooming,this._source.minzoom));a&&(this._addTile(a.tileID),e[a.tileID.key]=a.tileID),t[n]=r}const o=n[n.length-1].overscaledZ;for(const n in this._tiles){const e=this._tiles[n];if(i[n]||!e.hasData())continue;let r=e.tileID;for(;r.overscaledZ>o;){r=r.scaledTo(r.overscaledZ-1);const o=this._tiles[r.key];if(o&&o.hasData()&&t[r.key]){i[n]=e.tileID;break}}}for(const n in e)i[n]||(this._coveredTiles[n]=!0,i[n]=e[n])}for(const a in i)this._tiles[a].clearFadeHold();const o=function(e,t){const r=[];for(const n in e)n in t||r.push(n);return r}(this._tiles,i);for(const a of o){const e=this._tiles[a];e.hasSymbolBuckets&&!e.holdingForFade()?e.setHoldDuration(this.map._fadeDuration):e.hasSymbolBuckets&&!e.symbolFadeFinished()||this._removeTile(+a)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(+e)}_updateRetainedTiles(e){const t={};if(0===e.length)return t;const r={},n=e.reduce(((e,t)=>Math.min(e,t.overscaledZ)),1/0),i=e[0].overscaledZ,o=Math.max(i-nm.maxOverzooming,this._source.minzoom),a=Math.max(i+nm.maxUnderzooming,this._source.minzoom),s={};for(const u of e){const e=this._addTile(u);t[u.key]=u,e.hasData()||n<this._source.maxzoom&&(s[u.key]=u)}this._retainLoadedChildren(s,n,a,t);for(const u of e){let e=this._tiles[u.key];if(e.hasData())continue;if(u.canonical.z>=this._source.maxzoom){const e=u.children(this._source.maxzoom)[0],r=this.getTile(e);if(r&&r.hasData()){t[e.key]=e;continue}}else{const e=u.children(this._source.maxzoom);if(t[e[0].key]&&t[e[1].key]&&t[e[2].key]&&t[e[3].key])continue}let n=e.wasRequested();for(let i=u.overscaledZ-1;i>=o;--i){const o=u.scaledTo(i);if(r[o.key])break;if(r[o.key]=!0,e=this.getTile(o),!e&&n&&(e=this._addTile(o)),e&&(t[o.key]=o,n=e.wasRequested(),e.hasData()))break}}return t}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const t=[];let r,n=this._tiles[e].tileID;for(;n.overscaledZ>0;){if(n.key in this._loadedParentTiles){r=this._loadedParentTiles[n.key];break}t.push(n.key);const e=n.scaledTo(n.overscaledZ-1);if(r=this._getLoadedTile(e),r)break;n=e}for(const e of t)this._loadedParentTiles[e]=r}}_addTile(e){let t=this._tiles[e.key];if(t)return t;t=this._cache.getAndRemove(e),t&&(this._setTileReloadTimer(e.key,t),t.tileID=e,this._state.initializeTileState(t,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,t)));const r=Boolean(t);if(!r){const r=this.map?this.map.painter:null;t=new zp(e,this._source.tileSize*e.overscaleFactor(),this.transform.tileZoom,r,this._isRaster),this._loadTile(t,this._tileLoaded.bind(this,t,e.key,t.state))}return t?(t.uses++,this._tiles[e.key]=t,r||this._source.fire(new He("dataloading",{tile:t,coord:t.tileID,dataType:"source"})),t):null}_setTileReloadTimer(e,t){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const r=t.getExpiryTimeout();r&&(this._timers[e]=setTimeout((()=>{this._reloadTile(e,"expired"),delete this._timers[e]}),r))}_removeTile(e){const t=this._tiles[e];t&&(t.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),t.uses>0||(t.hasData()&&"reloading"!==t.state?this._cache.add(t.tileID,t,t.getExpiryTimeout()):(t.aborted=!0,this._abortTile(t),this._unloadTile(t))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(+e);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(e,t,r){const n=[],i=this.transform;if(!i)return n;const o="globe"===i.projection.name,a=ic(i.center.lng);for(const s in this._tiles){const u=this._tiles[s];if(r&&u.clearQueryDebugViz(),u.holdingForFade())continue;let c;if(o){const e=u.tileID.canonical;if(0===e.z){const t=[Math.abs(A(a,...am(e,-1))-a),Math.abs(A(a,...am(e,1))-a)];c=[0,2*t.indexOf(Math.min(...t))-1]}else{const t=[Math.abs(A(a,...am(e,-1))-a),Math.abs(A(a,...am(e,0))-a),Math.abs(A(a,...am(e,1))-a)];c=[t.indexOf(Math.min(...t))-1]}}else c=[0];for(const r of c){const o=e.containsTile(u,i,t,r);o&&n.push(o)}}return n}getVisibleCoordinates(e){const t=this.getRenderableIds(e).map((e=>this._tiles[e].tileID));for(const r of t)r.projMatrix=this.transform.calculateProjMatrix(r.toUnwrapped());return t}hasTransition(){if(this._source.hasTransition())return!0;if(om(this._source.type))for(const e in this._tiles){const t=this._tiles[e];if(void 0!==t.fadeEndTime&&t.fadeEndTime>=We.now())return!0}return!1}setFeatureState(e,t,r){this._state.updateState(e=e||"_geojsonTileLayer",t,r)}removeFeatureState(e,t,r){this._state.removeFeatureState(e=e||"_geojsonTileLayer",t,r)}getFeatureState(e,t){return this._state.getState(e=e||"_geojsonTileLayer",t)}setDependencies(e,t,r){const n=this._tiles[e];n&&n.setDependencies(t,r)}reloadTilesForDependencies(e,t){for(const r in this._tiles)this._tiles[r].hasDependency(e,t)&&this._reloadTile(+r,"reloading");this._cache.filter((r=>!r.hasDependency(e,t)))}_preloadTiles(e,t){const r=new Map,n=Array.isArray(e)?e:[e],i=this.map.painter.terrain,o=this.usedForTerrain&&i?i.getScaledDemTileSize():this._source.tileSize;for(const a of n){const e=a.coveringTiles({tileSize:o,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const t of e)r.set(t.key,t);this.usedForTerrain&&a.updateElevation(!1)}T(Array.from(r.values()),((e,t)=>{const r=new zp(e,this._source.tileSize*e.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(r,(e=>{"raster-dem"===this._source.type&&r.dem&&this._backfillDEM(r),t(e,r)}))}),t)}}function im(e,t){const r=Math.abs(2*e.wrap)-+(e.wrap<0),n=Math.abs(2*t.wrap)-+(t.wrap<0);return e.overscaledZ-t.overscaledZ||n-r||t.canonical.y-e.canonical.y||t.canonical.x-e.canonical.x}function om(e){return"raster"===e||"image"===e||"video"===e||"custom"===e}function am(e,t){const r=1<<e.z;return[e.x/r+t,(e.x+1)/r+t]}nm.maxOverzooming=10,nm.maxUnderzooming=3;class sm{constructor(e,t,r){this._demTile=e,this._dem=this._demTile.dem,this._scale=t,this._offset=r}static create(e,t,r){const n=r||e.findDEMTileFor(t);if(!n||!n.dem)return;const i=n.dem,o=n.tileID,a=1<<t.canonical.z-o.canonical.z;return new sm(n,n.tileSize/Es/a,[(t.canonical.x/a-o.canonical.x)*i.dim,(t.canonical.y/a-o.canonical.y)*i.dim])}tileCoordToPixel(e,t){const r=t*this._scale+this._offset[1],n=Math.floor(e*this._scale+this._offset[0]),i=Math.floor(r);return new p(n,i)}getElevationAt(e,t,r,n){const i=e*this._scale+this._offset[0],o=t*this._scale+this._offset[1],a=Math.floor(i),s=Math.floor(o),u=this._dem;return n=!!n,r?Tr(Tr(u.get(a,s,n),u.get(a,s+1,n),o-s),Tr(u.get(a+1,s,n),u.get(a+1,s+1,n),o-s),i-a):u.get(a,s,n)}getElevationAtPixel(e,t,r){return this._dem.get(e,t,!!r)}getMeterToDEM(e){return(1<<this._demTile.tileID.canonical.z)*ac(1,e)*this._dem.stride}}class um{constructor(e,t){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new Ui(Es,16,0),this.featureIndexArray=new Za,this.promoteId=t}insert(e,t,r,n,i,o=0){const a=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(r,n,i,o);const s=this.grid;for(let u=0;u<t.length;u++){const e=t[u],r=[1/0,1/0,-1/0,-1/0];for(let t=0;t<e.length;t++){const n=e[t];r[0]=Math.min(r[0],n.x),r[1]=Math.min(r[1],n.y),r[2]=Math.max(r[2],n.x),r[3]=Math.max(r[3],n.y)}r[0]<Es&&r[1]<Es&&r[2]>=0&&r[3]>=0&&s.insert(a,r[0],r[1],r[2],r[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new oh(new uf(this.rawTileData)).layers,this.sourceLayerCoder=new Ep(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const e in this.vtLayers)this.vtFeatures[e]=[]}return this.vtLayers}query(e,t,r,n){this.loadVTLayers();const i=e.params||{},o=ai(i.filter),a=e.tileResult,s=e.transform,u=a.bufferedTilespaceBounds,c=this.grid.query(u.min.x,u.min.y,u.max.x,u.max.y,((e,t,r,n)=>Lc(a.bufferedTilespaceGeometry,e,t,r,n)));c.sort(lm);let l=null;s.elevation&&c.length>0&&(l=sm.create(s.elevation,this.tileID));const h={};let f;for(let d=0;d<c.length;d++){const s=c[d];if(s===f)continue;f=s;const u=this.featureIndexArray.get(s);let p=null;this.loadMatchingFeature(h,u,o,i.layers,i.availableImages,t,r,n,((t,r,n,i=0)=>(p||(p=bc(t,this.tileID.canonical,e.tileTransform)),r.queryIntersectsFeature(a,t,n,p,this.z,e.transform,e.pixelPosMatrix,l,i))))}return h}loadMatchingFeature(e,t,r,n,i,o,a,s,u){const{featureIndex:c,bucketIndex:l,sourceLayerIndex:h,layoutVertexArrayOffset:f}=t,d=this.bucketLayerIDs[l];if(n&&!function(e,t){for(let r=0;r<e.length;r++)if(t.indexOf(e[r])>=0)return!0;return!1}(n,d))return;const p=this.sourceLayerCoder.decode(h),m=this.vtLayers[p].feature(c);if(r.needGeometry){const e=xc(m,!0);if(!r.filter(new Fo(this.tileID.overscaledZ),e,this.tileID.canonical))return}else if(!r.filter(new Fo(this.tileID.overscaledZ),m))return;const g=this.getId(m,p);for(let y=0;y<d.length;y++){const t=d[y];if(n&&n.indexOf(t)<0)continue;const r=o[t];if(!r)continue;let l={};void 0!==g&&s&&(l=s.getState(r.sourceLayer||"_geojsonTileLayer",g));const h=I({},a[t]);h.paint=cm(h.paint,r.paint,m,l,i),h.layout=cm(h.layout,r.layout,m,l,i);const p=!u||u(m,r,l,f);if(!p)continue;const v=new Tp(m,this.z,this.x,this.y,g);v.layer=h;let _=e[t];void 0===_&&(_=e[t]=[]),_.push({featureIndex:c,feature:v,intersectionZ:p})}}lookupSymbolFeatures(e,t,r,n,i,o,a,s){const u={};this.loadVTLayers();const c=ai(i);for(const l of e)this.loadMatchingFeature(u,{bucketIndex:r,sourceLayerIndex:n,featureIndex:l,layoutVertexArrayOffset:0},c,o,a,s,t);return u}loadFeature(e){const{featureIndex:t,sourceLayerIndex:r}=e;this.loadVTLayers();const n=this.sourceLayerCoder.decode(r),i=this.vtFeatures[n];if(i[t])return i[t];const o=this.vtLayers[n].feature(t);return i[t]=o,o}hasLayer(e){for(const t of this.bucketLayerIDs)for(const r of t)if(e===r)return!0;return!1}getId(e,t){let r=e.id;if(this.promoteId){const n="string"==typeof this.promoteId?this.promoteId:this.promoteId[t];null!=n&&(r=e.properties[n]),"boolean"==typeof r&&(r=Number(r))}return r}}function cm(e,t,r,n,i){return z(e,((e,o)=>{const a=t instanceof Yo?t.get(o):null;return a&&a.evaluate?a.evaluate(r,n,i):a}))}function lm(e,t){return t-e}ji(um,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class hm{constructor(e,t){this.width=e,this.height=t,this.nextRow=0,this.image=new $c({width:e,height:t}),this.positions={},this.uploaded=!1}getDash(e,t){const r=this.getKey(e,t);return this.positions[r]}trim(){const e=this.width,t=this.height=D(this.nextRow);this.image.resize({width:e,height:t})}getKey(e,t){return e.join(",")+t}getDashRanges(e,t,r){const n=[];let i=e.length%2==1?-e[e.length-1]*r:0,o=e[0]*r,a=!0;n.push({left:i,right:o,isDash:a,zeroLength:0===e[0]});let s=e[0];for(let u=1;u<e.length;u++){a=!a;const t=e[u];i=s*r,s+=t,o=s*r,n.push({left:i,right:o,isDash:a,zeroLength:0===t})}return n}addRoundDash(e,t,r){const n=t/2;for(let i=-r;i<=r;i++){const t=this.width*(this.nextRow+r+i);let o=0,a=e[o];for(let s=0;s<this.width;s++){s/a.right>1&&(a=e[++o]);const u=Math.abs(s-a.left),c=Math.abs(s-a.right),l=Math.min(u,c);let h;const f=i/r*(n+1);if(a.isDash){const e=n-Math.abs(f);h=Math.sqrt(l*l+e*e)}else h=n-Math.sqrt(l*l+f*f);this.image.data[t+s]=Math.max(0,Math.min(255,h+128))}}}addRegularDash(e,t){for(let s=e.length-1;s>=0;--s){const t=e[s],r=e[s+1];t.zeroLength?e.splice(s,1):r&&r.isDash===t.isDash&&(r.left=t.left,e.splice(s,1))}const r=e[0],n=e[e.length-1];r.isDash===n.isDash&&(r.left=n.left-this.width,n.right=r.right+this.width);const i=this.width*this.nextRow;let o=0,a=e[o];for(let s=0;s<this.width;s++){s/a.right>1&&(a=e[++o]);const r=Math.abs(s-a.left),n=Math.abs(s-a.right),u=Math.min(r,n);this.image.data[i+s]=Math.max(0,Math.min(255,(a.isDash?u:-u)+t+128))}}addDash(e,t){const r=this.getKey(e,t);if(this.positions[r])return this.positions[r];const n="round"===t,i=n?7:0,o=2*i+1;if(this.nextRow+o>this.height)return F("LineAtlas out of space"),null;0===e.length&&e.push(1);let a=0;for(let c=0;c<e.length;c++)e[c]<0&&(F("Negative value is found in line dasharray, replacing values with 0"),e[c]=0),a+=e[c];if(0!==a){const r=this.width/a,o=this.getDashRanges(e,this.width,r);n?this.addRoundDash(o,r,i):this.addRegularDash(o,"square"===t?.5*r:0)}const s=this.nextRow+i;this.nextRow+=o;const u={tl:[s,i],br:[a,0]};return this.positions[r]=u,u}}ji(hm,"LineAtlas");class fm{constructor(e){const t={},r=[];for(const a in e){const n=e[a],i=t[a]={};for(const e in n.glyphs){const t=n.glyphs[+e];if(!t||0===t.bitmap.width||0===t.bitmap.height)continue;const o=t.metrics.localGlyph?2:1,a={x:0,y:0,w:t.bitmap.width+2*o,h:t.bitmap.height+2*o};r.push(a),i[e]=a}}const{w:n,h:i}=Df(r),o=new $c({width:n||1,height:i||1});for(const a in e){const r=e[a];for(const e in r.glyphs){const n=r.glyphs[+e];if(!n||0===n.bitmap.width||0===n.bitmap.height)continue;const i=t[a][e],s=n.metrics.localGlyph?2:1;$c.copy(n.bitmap,o,{x:0,y:0},{x:i.x+s,y:i.y+s},n.bitmap)}}this.image=o,this.positions=t}}ji(fm,"GlyphAtlas");class dm{constructor(e){this.tileID=new Th(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.tileZoom=e.tileZoom,this.uid=e.uid,this.zoom=e.zoom,this.canonical=e.tileID.canonical,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming,this.returnDependencies=!!e.returnDependencies,this.promoteId=e.promoteId,this.enableTerrain=!!e.enableTerrain,this.isSymbolTile=e.isSymbolTile,this.tileTransform=Ld(e.tileID.canonical,e.projection),this.projection=e.projection}parse(e,t,r,n,i){this.status="parsing",this.data=e,this.collisionBoxArray=new Ba;const o=new Ep(Object.keys(e.layers).sort()),a=new um(this.tileID,this.promoteId);a.bucketLayerIDs=[];const s={},u=new hm(256,256),c={featureIndex:a,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:u,availableImages:r},l=t.familiesBySource[this.source];for(const b in l){const t=e.layers[b];if(!t)continue;let n=!1,i=!1;for(const e of l[b])"symbol"===e[0].type?n=!0:i=!0;if(!0===this.isSymbolTile&&!n)continue;if(!1===this.isSymbolTile&&!i)continue;1===t.version&&F(`Vector tile source "${this.source}" layer "${b}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const u=o.encode(b),h=[];for(let e=0;e<t.length;e++){const r=t.feature(e),n=a.getId(r,b);h.push({feature:r,id:n,index:e,sourceLayerIndex:u})}for(const e of l[b]){const t=e[0];void 0!==this.isSymbolTile&&"symbol"===t.type!==this.isSymbolTile||t.minzoom&&this.zoom<Math.floor(t.minzoom)||t.maxzoom&&this.zoom>=t.maxzoom||"none"!==t.visibility&&(pm(e,this.zoom,r),(s[t.id]=t.createBucket({index:a.bucketLayerIDs.length,layers:e,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:u,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:r})).populate(h,c,this.tileID.canonical,this.tileTransform),a.bucketLayerIDs.push(e.map((e=>e.id))))}}let h,f,d,p;u.trim();const m={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},g=z(c.glyphDependencies,(e=>Object.keys(e).map(Number)));Object.keys(g).length?n.send("getGlyphs",{uid:this.uid,stacks:g},((e,t)=>{h||(h=e,f=t,_.call(this))}),void 0,!1,m):f={};const y=Object.keys(c.iconDependencies);y.length?n.send("getImages",{icons:y,source:this.source,tileID:this.tileID,type:"icons"},((e,t)=>{h||(h=e,d=t,_.call(this))}),void 0,!1,m):d={};const v=Object.keys(c.patternDependencies);function _(){if(h)return i(h);if(f&&d&&p){const e=new fm(f),t=new Lf(d,p);for(const n in s){const i=s[n];i instanceof hp?(pm(i.layers,this.zoom,r),Ed(i,f,e.positions,d,t.iconPositions,this.showCollisionBoxes,r,this.tileID.canonical,this.tileZoom,this.projection)):i.hasPattern&&(i instanceof Uh||i instanceof Zl||i instanceof dh)&&(pm(i.layers,this.zoom,r),i.addFeatures(c,this.tileID.canonical,t.patternPositions,r,this.tileTransform))}this.status="done",i(null,{buckets:M(s).filter((e=>!e.isEmpty())),featureIndex:a,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:e.image,lineAtlas:u,imageAtlas:t,glyphMap:this.returnDependencies?f:null,iconMap:this.returnDependencies?d:null,glyphPositions:this.returnDependencies?e.positions:null})}}v.length?n.send("getImages",{icons:v,source:this.source,tileID:this.tileID,type:"patterns"},((e,t)=>{h||(h=e,p=t,_.call(this))}),void 0,!1,m):p={},_.call(this)}}function pm(e,t,r){const n=new Fo(t);for(const i of e)i.recalculate(n,r)}class mm{constructor(e){this.entries={},this.scheduler=e}request(e,t,r,n){const i=this.entries[e]=this.entries[e]||{callbacks:[]};if(i.result){const[e,r]=i.result;return this.scheduler?this.scheduler.add((()=>{n(e,r)}),t):n(e,r),()=>{}}return i.callbacks.push(n),i.cancel||(i.cancel=r(((r,n)=>{i.result=[r,n];for(const e of i.callbacks)this.scheduler?this.scheduler.add((()=>{e(r,n)}),t):e(r,n);setTimeout((()=>delete this.entries[e]),3e3)}))),()=>{i.result||(i.callbacks=i.callbacks.filter((e=>e!==n)),i.callbacks.length||(i.cancel(),delete this.entries[e]))}}}function gm(e,t,r){const n=JSON.stringify(e.request);return e.data&&(this.deduped.entries[n]={result:[null,e.data]}),this.deduped.request(n,{type:"parseTile",isSymbolTile:e.isSymbolTile,zoom:e.tileZoom},(t=>{const n=ce(e.request,((e,n,i,o)=>{e?t(e):n&&t(null,{vectorTile:r?void 0:new oh(new uf(n)),rawData:n,cacheControl:i,expires:o})}));return()=>{n.cancel(),t()}}),t)}e.ARRAY_TYPE=Ms,e.AUTH_ERR_MSG=me,e.Aabb=wu,e.Actor=class{constructor(e,r,n){this.target=e,this.parent=r,this.mapId=n,this.callbacks={},this.cancelCallbacks={},L(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=W()?e:t,this.scheduler=new Ap}send(e,t,r,n,i=!1,o){const a=Math.round(1e18*Math.random()).toString(36).substring(0,10);r&&(r.metadata=o,this.callbacks[a]=r);const s=H(this.globalScope)?void 0:[];return this.target.postMessage({id:a,type:e,hasCallback:!!r,targetMapId:n,mustQueue:i,sourceMapId:this.mapId,data:Ki(t,s)},s),{cancel:()=>{r&&delete this.callbacks[a],this.target.postMessage({id:a,type:"<cancel>",targetMapId:n,sourceMapId:this.mapId})}}}receive(e){const t=e.data,r=t.id;if(r&&(!t.targetMapId||this.mapId===t.targetMapId))if("<cancel>"===t.type){const e=this.cancelCallbacks[r];delete this.cancelCallbacks[r],e&&e.cancel()}else if(t.mustQueue||W()){const e=this.callbacks[r];this.cancelCallbacks[r]=this.scheduler.add((()=>this.processTask(r,t)),e&&e.metadata||{type:"message"})}else this.processTask(r,t)}processTask(e,t){if("<response>"===t.type){const r=this.callbacks[e];delete this.callbacks[e],r&&(t.error?r(Gi(t.error)):r(null,Gi(t.data)))}else{const r=H(this.globalScope)?void 0:[],n=t.hasCallback?(t,n)=>{delete this.cancelCallbacks[e],this.target.postMessage({id:e,type:"<response>",sourceMapId:this.mapId,error:t?Ki(t):null,data:Ki(n,r)},r)}:e=>{},i=Gi(t.data);if(this.parent[t.type])this.parent[t.type](t.sourceMapId,i,n);else if(this.parent.getWorkerSource){const e=t.type.split(".");this.parent.getWorkerSource(t.sourceMapId,e[0],i.source)[e[1]](i,n)}else n(new Error(`Could not find function ${t.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},e.CanonicalTileID=Eh,e.Color=Tt,e.ColorMode=Jp,e.CullFaceMode=rm,e.DEMData=qp,e.DataConstantProperty=Xo,e.DedupedRequest=mm,e.DepthMode=Xp,e.EXTENT=Es,e.Elevation=class{isDataAvailableAtPoint(e){const t=this._source();if(this.isUsingMockSource()||!t||e.y<0||e.y>1)return!1;const r=t.getSource().maxzoom,n=1<<r,i=Math.floor(e.x),o=Math.floor((e.x-i)*n),a=Math.floor(e.y*n),s=this.findDEMTileFor(new Th(r,i,r,o,a));return!(!s||!s.dem)}getAtPointOrZero(e,t=0){return this.getAtPoint(e,t)||0}getAtPoint(e,t,r=!0){if(this.isUsingMockSource())return null;null==t&&(t=null);const n=this._source();if(!n)return t;if(e.y<0||e.y>1)return t;const i=n.getSource().maxzoom,o=1<<i,a=Math.floor(e.x),s=e.x-a,u=new Th(i,a,i,Math.floor(s*o),Math.floor(e.y*o)),c=this.findDEMTileFor(u);if(!c||!c.dem)return t;const l=c.dem,h=1<<c.tileID.canonical.z,f=(s*h-c.tileID.canonical.x)*l.dim,d=(e.y*h-c.tileID.canonical.y)*l.dim,p=Math.floor(f),m=Math.floor(d);return(r?this.exaggeration():1)*Tr(Tr(l.get(p,m),l.get(p,m+1),d-m),Tr(l.get(p+1,m),l.get(p+1,m+1),d-m),f-p)}getAtTileOffset(e,t,r){const n=1<<e.canonical.z;return this.getAtPointOrZero(new fc(e.wrap+(e.canonical.x+t/Es)/n,(e.canonical.y+r/Es)/n))}getAtTileOffsetFunc(e,t,r,n){return i=>{const o=this.getAtTileOffset(e,i.x,i.y),a=n.upVector(e.canonical,i.x,i.y);return Xs(a,a,o*n.upVectorScale(e.canonical,t,r).metersToTile),a}}getForTilePoints(e,t,r,n){if(this.isUsingMockSource())return!1;const i=sm.create(this,e,n);return!!i&&(t.forEach((e=>{e[2]=this.exaggeration()*i.getElevationAt(e[0],e[1],r)})),!0)}getMinMaxForTile(e){if(this.isUsingMockSource())return null;const t=this.findDEMTileFor(e);if(!t||!t.dem)return null;const r=t.dem.tree,n=t.tileID,i=1<<e.canonical.z-n.canonical.z;let o=e.canonical.x/i-n.canonical.x,a=e.canonical.y/i-n.canonical.y,s=0;for(let u=0;u<e.canonical.z-n.canonical.z&&!r.leaves[s];u++){o*=2,a*=2;const e=2*Math.floor(a)+Math.floor(o);s=r.childOffsets[s]+e,o%=1,a%=1}return{min:this.exaggeration()*r.minimums[s],max:this.exaggeration()*r.maximums[s]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(e,t,r){throw new Error("Pure virtual method called.")}pointCoordinate(e){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(e){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},e.ErrorEvent=qe,e.EvaluationParameters=Fo,e.Event=He,e.Evented=Ye,e.FillExtrusionBucket=dh,e.Frustum=xu,e.FrustumCorners=bu,e.GLOBE_RADIUS=ku,e.GLOBE_SCALE_MATCH_LATITUDE=45,e.GLOBE_ZOOM_THRESHOLD_MAX=6,e.GLOBE_ZOOM_THRESHOLD_MIN=5,e.GlobeSharedBuffers=class{constructor(e){this._createGrid(e),this._createPoles(e)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const e of this._poleSegments)e.destroy();for(const e of this._gridSegments)e.withSkirts.destroy(),e.withoutSkirts.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const e of this._wireframeSegments)e.destroy()}}_fillGridMeshWithLods(e,t){const r=new aa,n=new wa,i=[],o=e+1+2,a=t[0]+1,s=t[0]+1+(1+t.length),u=(e,t,r)=>{let n=e===o-1?e-2:0===e?e:e-1;return n+=r?24575:0,[n,t]};for(let c=0;c<o;++c)r.emplaceBack(...u(c,0,!0));for(let c=0;c<a;++c)for(let e=0;e<o;++e)r.emplaceBack(...u(e,c,(0===e||e===o-1)&&!0));for(let c=0;c<t.length;++c){const e=t[c];for(let t=0;t<o;++t)r.emplaceBack(...u(t,e,!0))}for(let c=0;c<t.length;++c){const e=n.length,a=t[c]+1+2,u=new wa;for(let r=0;r<a-1;r++){const e=r===a-2,i=e?o*(s-t.length+c-r):o;for(let t=0;t<o-1;t++){const a=r*o+t;0===r||e||0===t||t===o-2?(u.emplaceBack(a+1,a,a+i),u.emplaceBack(a+i,a+i+1,a+1)):(n.emplaceBack(a+1,a,a+i),n.emplaceBack(a+i,a+i+1,a+1))}}const l=As.simpleSegment(0,e,r.length,n.length-e);for(let t=0;t<u.uint16.length;t+=3)n.emplaceBack(u.uint16[t],u.uint16[t+1],u.uint16[t+2]);const h=As.simpleSegment(0,e,r.length,n.length-e);i.push({withoutSkirts:l,withSkirts:h})}return{vertices:r,indices:n,segments:i}}_createGrid(e){const t=this._fillGridMeshWithLods(Au,Eu);this._gridSegments=t.segments,this._gridBuffer=e.createVertexBuffer(t.vertices,vu.members),this._gridIndexBuffer=e.createIndexBuffer(t.indices,!0)}_createPoles(e){const t=new wa;for(let i=0;i<=Au;i++)t.emplaceBack(0,i+1,i+2);this._poleIndexBuffer=e.createIndexBuffer(t,!0);const r=new Sa,n=new Sa;this._poleSegments=[];for(let i=0,o=0;i<5;i++){const e=360/(1<<i);r.emplaceBack(0,-ku,0,.5,0),n.emplaceBack(0,-ku,0,.5,1);for(let t=0;t<=Au;t++){const i=t/Au,o=Tr(0,e,i),[a,s,u]=Zu($u,Ju,o,ku);r.emplaceBack(a,s,u,i,0),n.emplaceBack(a,s,u,i,1)}this._poleSegments.push(As.simpleSegment(o,0,66,64)),o+=66}this._poleNorthVertexBuffer=e.createVertexBuffer(r,gu,!1),this._poleSouthVertexBuffer=e.createVertexBuffer(n,gu,!1)}getGridBuffers(e,t){return[this._gridBuffer,this._gridIndexBuffer,t?this._gridSegments[e].withSkirts:this._gridSegments[e].withoutSkirts]}getPoleBuffers(e){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[e]]}getWirefameBuffers(e,t){if(!this._wireframeSegments){const t=new Ma,r=Au,n=r+1+2,i=1;this._wireframeSegments=[];for(let e=0,o=0;e<Eu.length;e++){const a=Eu[e];for(let e=i;e<a+i;e++)for(let o=i;o<r+i;o++){const r=e*n+o;t.emplaceBack(r,r+1),t.emplaceBack(r,r+n),t.emplaceBack(r,r+n+1)}const s=a*r*3;this._wireframeSegments.push(As.simpleSegment(0,o,(a+1)*n,s)),o+=s}this._wireframeIndexBuffer=e.createIndexBuffer(t)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[t]]}},e.GlyphManager=ld,e.ImagePosition=Rf,e.LivePerformanceUtils=Oe,e.LngLat=rc,e.LngLatBounds=Ss,e.LocalGlyphMode=cd,e.MAX_MERCATOR_LATITUDE=lc,e.MercatorCoordinate=fc,e.ONE_EM=Qh,e.OverscaledTileID=Th,e.PerformanceMarkers=Le,e.Properties=Jo,e.RGBAImage=Jc,e.Ray=_u,e.RequestManager=class{constructor(e,t,r){this._transformRequestFn=e,this._customAccessToken=t,this._silenceAuthErrors=!!r,this._createSkuToken()}_createSkuToken(){const e=function(){let e="";for(let t=0;t<10;t++)e+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",h,e].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=e.token,this._skuTokenExpiresAt=e.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(e,t){return this._transformRequestFn&&this._transformRequestFn(e,t)||{url:e}}normalizeStyleURL(e,t){if(!ge(e))return e;const r=we(e);return r.path=`/styles/v1${r.path}`,this._makeAPIURL(r,this._customAccessToken||t)}normalizeGlyphsURL(e,t){if(!ge(e))return e;const r=we(e);return r.path=`/fonts/v1${r.path}`,this._makeAPIURL(r,this._customAccessToken||t)}normalizeSourceURL(e,t,r,n){if(!ge(e))return e;const i=we(e);return i.path=`/v4/${i.authority}.json`,i.params.push("secure"),r&&i.params.push(`language=${r}`),n&&i.params.push(`worldview=${n}`),this._makeAPIURL(i,this._customAccessToken||t)}normalizeSpriteURL(e,t,r,n){const i=we(e);return ge(e)?(i.path=`/styles/v1${i.path}/sprite${t}${r}`,this._makeAPIURL(i,this._customAccessToken||n)):(i.path+=`${t}${r}`,ke(i))}normalizeTileURL(e,t,r){if(this._isSkuTokenExpired()&&this._createSkuToken(),e&&!ge(e))return e;const n=we(e);n.path=n.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${t||r&&"raster"!==n.authority&&512===r?"@2x":""}${o.supported?".webp":"$1"}`),"raster"===n.authority?n.path=`/${i.RASTER_URL_PREFIX}${n.path}`:(n.path=n.path.replace(/^.+\/v4\//,"/"),n.path=`/${i.TILE_URL_VERSION}${n.path}`);const a=this._customAccessToken||function(e){for(const t of e){const e=t.match(/^access_token=(.*)$/);if(e)return e[1]}return null}(n.params)||i.ACCESS_TOKEN;return i.REQUIRE_ACCESS_TOKEN&&a&&this._skuToken&&n.params.push(`sku=${this._skuToken}`),this._makeAPIURL(n,a)}canonicalizeTileURL(e,t){const r=we(e);if(!r.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!r.path.match(/\.[\w]+$/))return e;let n="mapbox://";r.path.match(/^\/raster\/v1\//)?n+=`raster/${r.path.replace(`/${i.RASTER_URL_PREFIX}/`,"")}`:n+=`tiles/${r.path.replace(`/${i.TILE_URL_VERSION}/`,"")}`;let o=r.params;return t&&(o=o.filter((e=>!e.match(/^access_token=/)))),o.length&&(n+=`?${o.join("&")}`),n}canonicalizeTileset(e,t){const r=!!t&&ge(t),n=[];for(const i of e.tiles||[])ye(i)?n.push(this.canonicalizeTileURL(i,r)):n.push(i);return n}_makeAPIURL(e,t){const r="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",n=we(i.API_URL);if(e.protocol=n.protocol,e.authority=n.authority,"http"===e.protocol){const t=e.params.indexOf("secure");t>=0&&e.params.splice(t,1)}if("/"!==n.path&&(e.path=`${n.path}${e.path}`),!i.REQUIRE_ACCESS_TOKEN)return ke(e);if(t=t||i.ACCESS_TOKEN,!this._silenceAuthErrors){if(!t)throw new Error(`An API access token is required to use Mapbox GL. ${r}`);if("s"===t[0])throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${r}`)}return e.params=e.params.filter((e=>-1===e.indexOf("access_token"))),e.params.push(`access_token=${t||""}`),ke(e)}},e.ResourceType=oe,e.SegmentVector=As,e.SourceCache=nm,e.StencilMode=$p,e.StructArrayLayout1ui2=Ia,e.StructArrayLayout2f1f2i16=_a,e.StructArrayLayout2i4=aa,e.StructArrayLayout2ui4=Ma,e.StructArrayLayout3f12=xa,e.StructArrayLayout3ui6=wa,e.StructArrayLayout4i8=ua,e.StructArrayLayout5f20=Sa,e.Texture=wp,e.Tile=zp,e.Transitionable=Wo,e.Uniform1f=ts,e.Uniform1i=class extends es{constructor(e){super(e),this.current=0}set(e,t,r){this.fetchUniformLocation(e,t)&&this.current!==r&&(this.current=r,this.gl.uniform1i(this.location,r))}},e.Uniform2f=class extends es{constructor(e){super(e),this.current=[0,0]}set(e,t,r){this.fetchUniformLocation(e,t)&&(r[0]===this.current[0]&&r[1]===this.current[1]||(this.current=r,this.gl.uniform2f(this.location,r[0],r[1])))}},e.Uniform3f=class extends es{constructor(e){super(e),this.current=[0,0,0]}set(e,t,r){this.fetchUniformLocation(e,t)&&(r[0]===this.current[0]&&r[1]===this.current[1]&&r[2]===this.current[2]||(this.current=r,this.gl.uniform3f(this.location,r[0],r[1],r[2])))}},e.Uniform4f=rs,e.UniformColor=ns,e.UniformMatrix2f=class extends es{constructor(e){super(e),this.current=as}set(e,t,r){if(this.fetchUniformLocation(e,t))for(let n=0;n<4;n++)if(r[n]!==this.current[n]){this.current=r,this.gl.uniformMatrix2fv(this.location,!1,r);break}}},e.UniformMatrix3f=class extends es{constructor(e){super(e),this.current=os}set(e,t,r){if(this.fetchUniformLocation(e,t))for(let n=0;n<9;n++)if(r[n]!==this.current[n]){this.current=r,this.gl.uniformMatrix3fv(this.location,!1,r);break}}},e.UniformMatrix4f=class extends es{constructor(e){super(e),this.current=is}set(e,t,r){if(this.fetchUniformLocation(e,t)){if(r[12]!==this.current[12]||r[0]!==this.current[0])return this.current=r,void this.gl.uniformMatrix4fv(this.location,!1,r);for(let e=1;e<16;e++)if(r[e]!==this.current[e]){this.current=r,this.gl.uniformMatrix4fv(this.location,!1,r);break}}}},e.UnwrappedTileID=Sh,e.ValidationError=Qn,e.VectorTileFeature=ah,e.VectorTileWorkerSource=class extends Ye{constructor(e,t,r,n,i){super(),this.actor=e,this.layerIndex=t,this.availableImages=r,this.loadVectorData=i||gm,this.loading={},this.loaded={},this.deduped=new mm(e.scheduler),this.isSpriteLoaded=n,this.scheduler=e.scheduler}loadTile(e,t){const r=e.uid,n=e&&e.request,i=n&&n.collectResourceTiming,o=this.loading[r]=new dm(e);o.abort=this.loadVectorData(e,((a,s)=>{const u=!this.loading[r];if(delete this.loading[r],u||a||!s)return o.status="done",u||(this.loaded[r]=o),t(a);const c=s.rawData,l={};s.expires&&(l.expires=s.expires),s.cacheControl&&(l.cacheControl=s.cacheControl),o.vectorTile=s.vectorTile||new oh(new uf(c));const h=()=>{o.parse(o.vectorTile,this.layerIndex,this.availableImages,this.actor,((e,r)=>{if(e||!r)return t(e);const o={};if(i){const e=Ue(n);e.length>0&&(o.resourceTiming=JSON.parse(JSON.stringify(e)))}t(null,I({rawTileData:c.slice(0)},r,l,o))}))};this.isSpriteLoaded?h():this.once("isSpriteLoaded",(()=>{this.scheduler?this.scheduler.add(h,{type:"parseTile",isSymbolTile:e.isSymbolTile,zoom:e.tileZoom}):h()})),this.loaded=this.loaded||{},this.loaded[r]=o}))}reloadTile(e,t){const r=this.loaded,n=e.uid,i=this;if(r&&r[n]){const o=r[n];o.showCollisionBoxes=e.showCollisionBoxes,o.enableTerrain=!!e.enableTerrain,o.projection=e.projection,o.tileTransform=Ld(e.tileID.canonical,e.projection);const a=(e,r)=>{const n=o.reloadCallback;n&&(delete o.reloadCallback,o.parse(o.vectorTile,i.layerIndex,this.availableImages,i.actor,n)),t(e,r)};"parsing"===o.status?o.reloadCallback=a:"done"===o.status&&(o.vectorTile?o.parse(o.vectorTile,this.layerIndex,this.availableImages,this.actor,a):a())}}abortTile(e,t){const r=e.uid,n=this.loading[r];n&&(n.abort&&n.abort(),delete this.loading[r]),t()}removeTile(e,t){const r=this.loaded,n=e.uid;r&&r[n]&&delete r[n],t()}},e.WritingMode=Of,e.ZoomDependentExpression=Hn,e.add=Ks,e.addDynamicAttributes=sp,e.adjoint=function(e,t){var r=t[0],n=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],l=t[8];return e[0]=a*l-s*c,e[1]=i*c-n*l,e[2]=n*s-i*a,e[3]=s*u-o*l,e[4]=r*l-i*u,e[5]=i*o-r*s,e[6]=o*c-a*u,e[7]=n*u-r*c,e[8]=r*a-n*o,e},e.asyncAll=T,e.bezier=w,e.bindAll=L,e.boundsAttributes=Lp,e.bufferConvexPolygon=function(e,t){const r=[];for(let n=0;n<e.length;n++){const i=S(n-1,-1,e.length-1),o=S(n+1,-1,e.length-1),a=e[n],s=e[o],u=e[i].sub(a).unit(),c=s.sub(a).unit(),l=c.angleWithSep(u.x,u.y),h=u.add(c).unit().mult(-1*t/Math.sin(l/2));r.push(a.add(h))}return r},e.cacheEntryPossiblyAdded=function(e){ie++,ie>ee&&(e.getActor().send("enforceCacheSizeLimit",J),ie=0)},e.calculateGlobeLabelMatrix=function(e,t){const{x:r,y:n}=e.point,i=Hu(r,n,e.worldSize/e._pixelsPerMercatorPixel,0,0);return Ds(i,i,Gu(Du(t)))},e.calculateGlobeMatrix=function(e){const{x:t,y:r}=e.point,{lng:n,lat:i}=e._center;return Hu(t,r,e.worldSize,n,i)},e.calculateGlobeMercatorMatrix=function(e){const t=e.pixelsPerMeter,r=t/ac(1,e.center.lat),n=Cs(new Float64Array(16));return Rs(n,n,[e.point.x,e.point.y,0]),Ls(n,n,[r,r,t]),Float32Array.from(n)},e.circumferenceAtLatitude=nc,e.clamp=A,e.clearTileCache=function(e){if(!te())return;const r=t.caches.delete(X);e&&r.catch(e).then((()=>e()))},e.clipLine=od,e.clone=function(e){var t=new Ms(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},e.clone$1=U,e.collisionCircleLayout=Xh,e.config=i,e.conjugate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e},e.create=function(){var e=new Ms(16);return Ms!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e},e.create$1=Is,e.createExpression=Kn,e.createLayout=ia,e.createStyleLayer=function(e){return"custom"===e.type?new vp(e):new xp[e.type](e)},e.cross=eu,e.degToRad=v,e.distance=function(e,t){return Math.hypot(t[0]-e[0],t[1]-e[1],t[2]-e[2])},e.div=function(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e},e.dot=Js,e.earthRadius=ec,e.ease=k,e.easeCubicInOut=x,e.ecefToLatLng=function([e,t,r]){const n=Math.hypot(e,t,r),i=Math.atan2(e,r),o=.5*Math.PI-Math.acos(-t/n);return new rc(_(i),_(o))},e.emitValidationErrors=Ni,e.endsWith=O,e.enforceCacheSizeLimit=function(e){re(),Q&&Q.then((t=>{t.keys().then((r=>{for(let n=0;n<r.length-e;n++)t.delete(r[n])}))}))},e.evaluateSizeForFeature=ef,e.evaluateSizeForZoom=tf,e.evaluateVariableOffset=Ad,e.evented=zo,e.exactEquals=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]},e.exactEquals$1=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]},e.exported=We,e.exported$1=o,e.extend=I,e.extend$1=Qe,e.fillExtrusionHeightLift=bh,e.filterObject=N,e.fromMat4=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e},e.fromQuat=function(e,t){var r=t[0],n=t[1],i=t[2],o=t[3],a=r+r,s=n+n,u=i+i,c=r*a,l=n*a,h=n*s,f=i*a,d=i*s,p=i*u,m=o*a,g=o*s,y=o*u;return e[0]=1-h-p,e[1]=l+y,e[2]=f-g,e[3]=0,e[4]=l-y,e[5]=1-c-p,e[6]=d+m,e[7]=0,e[8]=f+g,e[9]=d-m,e[10]=1-c-h,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},e.fromRotation=function(e,t){var r=Math.sin(t),n=Math.cos(t);return e[0]=n,e[1]=r,e[2]=0,e[3]=-r,e[4]=n,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},e.fromScaling=Ns,e.furthestTileCorner=function(e){const t=Math.round((e+45+360)%360/90)%4;return b[t]},e.getAABBPointSquareDist=function(e,t,r){let n=0;for(let i=0;i<2;++i){const o=r?r[i]:0;e[i]>o&&(n+=(e[i]-o)*(e[i]-o)),t[i]<o&&(n+=(o-t[i])*(o-t[i]))}return n},e.getAnchorAlignment=Hf,e.getAnchorJustification=Sd,e.getBounds=function(e){let t=1/0,r=1/0,n=-1/0,i=-1/0;for(const o of e)t=Math.min(t,o.x),r=Math.min(r,o.y),n=Math.max(n,o.x),i=Math.max(i,o.y);return{min:new p(t,r),max:new p(n,i)}},e.getColumn=Y,e.getGridMatrix=function(e,t,r,n){const i=t.getNorth(),o=t.getSouth(),a=t.getWest(),s=t.getEast(),u=1<<e.z,c=s-a,l=i-o,h=c/Au,f=-l/Eu[r],d=[0,h,0,f,0,0,i,a,0];if(e.z>0){const e=180/n;Ps(d,d,[e/c+1,0,0,0,e/l+1,0,-.5*e/h,.5*e/f,1])}return d[2]=u,d[5]=e.x,d[8]=e.y,d},e.getImage=pe,e.getJSON=function(e,t){return ue(I(e,{type:"json"}),t)},e.getLatitudinalLod=function(e){const t=lc-5;e=A(e,-t,t)/t*90;const r=Math.pow(Math.abs(Math.sin(v(e))),3);return Math.round(r*(Eu.length-1))},e.getMapSessionAPI=De,e.getPerformanceMeasurement=Ue,e.getProjection=rp,e.getRTLTextPluginStatus=No,e.getReferrer=se,e.getTilePoint=function(e,{x:t,y:r},n=0){return new p(((t-n)*e.scale-e.x)*Es,(r*e.scale-e.y)*Es)},e.getTileVec3=function(e,t,r=0){return Ws(((t.x-r)*e.scale-e.x)*Es,(t.y*e.scale-e.y)*Es,cc(t.z,t.y))},e.getVideo=function(e,r){const n=t.document.createElement("video");n.muted=!0,n.onloadstart=function(){r(null,n)};for(let i=0;i<e.length;i++){const r=t.document.createElement("source");le(e[i])||(n.crossOrigin="Anonymous"),r.src=e[i],n.appendChild(r)}return{cancel:()=>{}}},e.globeCenterToScreenPoint=function(e){const t=[0,0,0],r=Cs(new Float64Array(16));return Ds(r,e.pixelMatrix,e.globeMatrix),tu(t,t,r),new p(t[0],t[1])},e.globeDenormalizeECEF=Gu,e.globeECEFOrigin=function(e,t){const r=[0,0,0];return tu(r,r,Ku(Du(t.canonical))),tu(r,r,e),r},e.globeMetersToEcef=Iu,e.globeNormalizeECEF=Ku,e.globePixelsToTileUnits=function(e,t){return Es/(512*Math.pow(2,e))*Vu(Du(t))},e.globePoleMatrixForTile=function(e,t,r){const n=Cs(new Float64Array(16)),i=(t/(1<<e)-.5)*Math.PI*2;return zs(n,r.globeMatrix,i),Float32Array.from(n)},e.globeTileBounds=Du,e.globeTiltAtLngLat=Yu,e.globeToMercatorTransition=qu,e.globeUseCustomAntiAliasing=function(e,t,r){const n=qu(r.zoom),i=e.style.map._antialias,o=!!t.extStandardDerivatives,a=t.extStandardDerivativesForceOff||e.terrain&&e.terrain.exaggeration()>0;return 0===n&&!i&&!a&&o},e.identity=Cs,e.identity$1=hu,e.invert=Bs,e.isFullscreen=function(){return!!t.document.fullscreenElement||!!t.document.webkitFullscreenElement},e.isLngLatBehindGlobe=Xu,e.isMapAuthenticated=function(e){return Re.has(e)},e.isMapboxURL=ge,e.isSafariWithAntialiasingBug=function(e){const t=e.navigator?e.navigator.userAgent:null;return!!H(e)&&t&&(t.match("Version/15.4")||t.match("Version/15.5")||t.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},e.latFromMercatorY=uc,e.latLngToECEF=Fu,e.len=au,e.length=Vs,e.length$1=function(e){return Math.hypot(e[0],e[1],e[2],e[3])},e.lngFromMercatorX=sc,e.loadVectorTile=gm,e.makeRequest=ue,e.mapValue=function(e,t,r,n,i){return A((e-t)/(r-t)*(i-n)+n,n,i)},e.mercatorScale=hc,e.mercatorXfromLng=ic,e.mercatorYfromLat=oc,e.mercatorZfromAltitude=ac,e.mul=Zs,e.mul$1=ou,e.multiply=Ds,e.multiply$1=Ps,e.multiply$2=Hs,e.nextPowerOfTwo=D,e.normalize=$s,e.normalize$1=pu,e.normalize$2=uu,e.number=Tr,e.ortho=function(e,t,r,n,i,o,a){var s=1/(t-r),u=1/(n-i),c=1/(o-a);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*u,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+r)*s,e[13]=(i+n)*u,e[14]=(a+o)*c,e[15]=1,e},e.pbf=uf,e.perspective=function(e,t,r,n,i){var o,a=1/Math.tan(t/2);return e[0]=a/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=i&&i!==1/0?(e[10]=(i+n)*(o=1/(n-i)),e[14]=2*i*n*o):(e[10]=-1,e[14]=-2*n),e},e.pick=function(e,t){const r={};for(let n=0;n<t.length;n++){const i=t[n];i in e&&(r[i]=e[i])}return r},e.plugin=Zo,e.pointGeometry=p,e.polesInViewport=function(e){const t=Cs(new Float64Array(16));Ds(t,e.pixelMatrix,e.globeMatrix);const r=[0,Su,0],n=[0,Tu,0];return tu(r,r,t),tu(n,n,t),[r[0]>0&&r[0]<=e.width&&r[1]>0&&r[1]<=e.height&&!Xu(e,new rc(e.center.lat,90)),n[0]>0&&n[0]<=e.width&&n[1]>0&&n[1]<=e.height&&!Xu(e,new rc(e.center.lat,-90))]},e.polygonContainsPoint=Rc,e.polygonIntersectsBox=Lc,e.polygonIntersectsPolygon=Ec,e.polygonizeBounds=function(e,t,r=0,n=!0){const i=new p(r,r),o=e.sub(i),a=t.add(i),s=[o,new p(a.x,o.y),a,new p(o.x,a.y)];return n&&s.push(o.clone()),s},e.posAttributes=vu,e.postMapLoadEvent=Ie,e.postPerformanceEvent=Ce,e.postTurnstileEvent=Te,e.potpack=Df,e.prevPowerOfTwo=function(e){return e<=1?1:Math.pow(2,Math.floor(Math.log(e)/Math.LN2))},e.radToDeg=_,e.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],e.registerForPluginStateChange=function(e){return e({pluginStatus:Do,pluginURL:Ro}),zo.on("pluginStateChange",e),e},e.removeAuthState=function(e){Re.delete(e)},e.renderColorRamp=tl,e.resample=pc,e.rotateX=Os,e.rotateX$1=fu,e.rotateY=zs,e.rotateY$1=du,e.rotateZ=function(e,t,r){var n=Math.sin(r),i=Math.cos(r),o=t[0],a=t[1],s=t[2],u=t[3],c=t[4],l=t[5],h=t[6],f=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i+c*n,e[1]=a*i+l*n,e[2]=s*i+h*n,e[3]=u*i+f*n,e[4]=c*i-o*n,e[5]=l*i-a*n,e[6]=h*i-s*n,e[7]=f*i-u*n,e},e.rotateZ$1=function(e,t,r){r*=.5;var n=t[0],i=t[1],o=t[2],a=t[3],s=Math.sin(r),u=Math.cos(r);return e[0]=n*u+i*s,e[1]=i*u-n*s,e[2]=o*u+a*s,e[3]=a*u-o*s,e},e.scale=Ls,e.scale$1=su,e.scale$2=Xs,e.scaleAndAdd=Qs,e.set=function(e,t,r,n){return e[0]=t,e[1]=r,e[2]=n,e},e.setCacheLimits=function(e,t){J=e,ee=t},e.setColumn=function(e,t,r){e[4*t+0]=r[0],e[4*t+1]=r[1],e[4*t+2]=r[2],e[4*t+3]=r[3]},e.setRTLTextPlugin=function(e,t,r=!1){if(Do===Io||Do===Po||Do===Co)throw new Error("setRTLTextPlugin cannot be called multiple times.");Ro=We.resolveURL(e),Do=Io,Bo=t,Oo(),r||Uo()},e.smoothstep=E,e.spec=Xe,e.squaredLength=function(e){var t=e[0],r=e[1],n=e[2];return t*t+r*r+n*n},e.storeAuthState=function(e,t){t?Re.add(e):Re.delete(e)},e.sub=iu,e.subtract=Gs,e.symbolSize=rf,e.tileAABB=function(e,t,r,n,i,o,a,s,u){if("globe"===u.name)return zu(e,t,new Eh(r,n,i));const c=Ld({z:r,x:n,y:i},u);return new wu([(o+c.x/c.scale)*t,t*(c.y/c.scale),a],[(o+c.x2/c.scale)*t,t*(c.y2/c.scale),s])},e.tileCornersToBounds=Nu,e.tileTransform=Ld,e.transformMat3=function(e,t,r){var n=t[0],i=t[1],o=t[2];return e[0]=n*r[0]+i*r[3]+o*r[6],e[1]=n*r[1]+i*r[4]+o*r[7],e[2]=n*r[2]+i*r[5]+o*r[8],e},e.transformMat4=tu,e.transformMat4$1=cu,e.transformQuat=ru,e.transitionTileAABBinECEF=Lu,e.translate=Rs,e.transpose=function(e,t){if(e===t){var r=t[1],n=t[2],i=t[5];e[1]=t[3],e[2]=t[6],e[3]=r,e[5]=t[7],e[6]=n,e[7]=i}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e},e.triggerPluginCompletionEvent=Lo,e.uniqueId=C,e.updateGlobeVertexNormal=function(e,t,r,n,i){const o=5*t+2;e.float32[o+0]=r,e.float32[o+1]=n,e.float32[o+2]=i},e.validateCustomStyleLayer=function(e){const t=[],r=e.id;return void 0===r&&t.push({message:`layers.${r}: missing required property "id"`}),void 0===e.render&&t.push({message:`layers.${r}: missing required method "render"`}),e.renderingMode&&"2d"!==e.renderingMode&&"3d"!==e.renderingMode&&t.push({message:`layers.${r}: property "renderingMode" must be either "2d" or "3d"`}),t},e.validateFilter=e=>zi(vi(e)),e.validateFog=e=>zi(Pi(e)),e.validateLayer=e=>zi(ki(e)),e.validateLight=e=>zi(Mi(e)),e.validateSource=e=>zi(Si(e)),e.validateStyle=Ri,e.validateTerrain=e=>zi(Ii(e)),e.values=M,e.vectorTile=Hl,e.version=r,e.warnOnce=F,e.window=t,e.wrap=S})),n(["./shared"],(function(e){function t(e){if("number"==typeof e||"boolean"==typeof e||"string"==typeof e||null==e)return JSON.stringify(e);if(Array.isArray(e)){let r="[";for(const n of e)r+=`${t(n)},`;return`${r}]`}let r="{";for(const n of Object.keys(e).sort())r+=`${n}:${t(e[n])},`;return`${r}}`}function r(r){let n="";for(const i of e.refProperties)n+=`/${t(r[i])}`;return n}class n{constructor(e){this.keyCache={},e&&this.replace(e)}replace(e){this._layerConfigs={},this._layers={},this.update(e,[])}update(t,n){for(const r of t)this._layerConfigs[r.id]=r,(this._layers[r.id]=e.createStyleLayer(r)).compileFilter(),this.keyCache[r.id]&&delete this.keyCache[r.id];for(const e of n)delete this.keyCache[e],delete this._layerConfigs[e],delete this._layers[e];this.familiesBySource={};const i=function(e,t){const n={};for(let o=0;o<e.length;o++){const i=t&&t[e[o].id]||r(e[o]);t&&(t[e[o].id]=i);let a=n[i];a||(a=n[i]=[]),a.push(e[o])}const i=[];for(const r in n)i.push(n[r]);return i}(e.values(this._layerConfigs),this.keyCache);for(const e of i){const t=e.map((e=>this._layers[e.id])),r=t[0];if("none"===r.visibility)continue;const n=r.source||"";let i=this.familiesBySource[n];i||(i=this.familiesBySource[n]={});const o=r.sourceLayer||"_geojsonTileLayer";let a=i[o];a||(a=i[o]=[]),a.push(t)}}}class i{loadTile(t,r){const{uid:n,encoding:i,rawImageData:o,padding:a,buildQuadTree:s}=t,u=e.window.ImageBitmap&&o instanceof e.window.ImageBitmap?this.getImageData(o,a):o;r(null,new e.DEMData(n,u,i,a<1,s))}getImageData(e,t){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(e.width,e.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=e.width,this.offscreenCanvas.height=e.height,this.offscreenCanvasContext.drawImage(e,0,0,e.width,e.height);const r=this.offscreenCanvasContext.getImageData(-t,-t,e.width+2*t,e.height+2*t);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),r}}var o=function e(t,r){var n,i=t&&t.type;if("FeatureCollection"===i)for(n=0;n<t.features.length;n++)e(t.features[n],r);else if("GeometryCollection"===i)for(n=0;n<t.geometries.length;n++)e(t.geometries[n],r);else if("Feature"===i)e(t.geometry,r);else if("Polygon"===i)a(t.coordinates,r);else if("MultiPolygon"===i)for(n=0;n<t.coordinates.length;n++)a(t.coordinates[n],r);return t};function a(e,t){if(0!==e.length){s(e[0],t);for(var r=1;r<e.length;r++)s(e[r],!t)}}function s(e,t){for(var r=0,n=0,i=0,o=e.length,a=o-1;i<o;a=i++){var s=(e[i][0]-e[a][0])*(e[a][1]+e[i][1]),u=r+s;n+=Math.abs(r)>=Math.abs(s)?r-u+s:s-u+r,r=u}r+n>=0!=!!t&&e.reverse()}const u=e.VectorTileFeature.prototype.toGeoJSON;class c{constructor(t){this._feature=t,this.extent=e.EXTENT,this.type=t.type,this.properties=t.tags,"id"in t&&!isNaN(t.id)&&(this.id=parseInt(t.id,10))}loadGeometry(){if(1===this._feature.type){const t=[];for(const r of this._feature.geometry)t.push([new e.pointGeometry(r[0],r[1])]);return t}{const t=[];for(const r of this._feature.geometry){const n=[];for(const t of r)n.push(new e.pointGeometry(t[0],t[1]));t.push(n)}return t}}toGeoJSON(e,t,r){return u.call(this,e,t,r)}}class l{constructor(t){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=e.EXTENT,this.length=t.length,this._features=t}feature(e){return new c(this._features[e])}}var h={},f={get exports(){return h},set exports(e){h=e}},d=e.pointGeometry,p=e.vectorTile.VectorTileFeature,m=g;function g(e,t){this.options=t||{},this.features=e,this.length=e.length}function y(e,t){this.id="number"==typeof e.id?e.id:void 0,this.type=e.type,this.rawGeometry=1===e.type?[e.geometry]:e.geometry,this.properties=e.tags,this.extent=t||4096}g.prototype.feature=function(e){return new y(this.features[e],this.options.extent)},y.prototype.loadGeometry=function(){var e=this.rawGeometry;this.geometry=[];for(var t=0;t<e.length;t++){for(var r=e[t],n=[],i=0;i<r.length;i++)n.push(new d(r[i][0],r[i][1]));this.geometry.push(n)}return this.geometry},y.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var e=this.geometry,t=1/0,r=-1/0,n=1/0,i=-1/0,o=0;o<e.length;o++)for(var a=e[o],s=0;s<a.length;s++){var u=a[s];t=Math.min(t,u.x),r=Math.max(r,u.x),n=Math.min(n,u.y),i=Math.max(i,u.y)}return[t,n,r,i]},y.prototype.toGeoJSON=p.prototype.toGeoJSON;var v=e.pbf,_=m;function b(e){var t=new v;return function(e,t){for(var r in e.layers)t.writeMessage(3,x,e.layers[r])}(e,t),t.finish()}function x(e,t){var r;t.writeVarintField(15,e.version||1),t.writeStringField(1,e.name||""),t.writeVarintField(5,e.extent||4096);var n={keys:[],values:[],keycache:{},valuecache:{}};for(r=0;r<e.length;r++)n.feature=e.feature(r),t.writeMessage(2,w,n);var i=n.keys;for(r=0;r<i.length;r++)t.writeStringField(3,i[r]);var o=n.values;for(r=0;r<o.length;r++)t.writeMessage(4,T,o[r])}function w(e,t){var r=e.feature;void 0!==r.id&&t.writeVarintField(1,r.id),t.writeMessage(2,k,e),t.writeVarintField(3,r.type),t.writeMessage(4,S,r)}function k(e,t){var r=e.feature,n=e.keys,i=e.values,o=e.keycache,a=e.valuecache;for(var s in r.properties){var u=r.properties[s],c=o[s];if(null!==u){void 0===c&&(n.push(s),o[s]=c=n.length-1),t.writeVarint(c);var l=typeof u;"string"!==l&&"boolean"!==l&&"number"!==l&&(u=JSON.stringify(u));var h=l+":"+u,f=a[h];void 0===f&&(i.push(u),a[h]=f=i.length-1),t.writeVarint(f)}}}function A(e,t){return(t<<3)+(7&e)}function E(e){return e<<1^e>>31}function S(e,t){for(var r=e.loadGeometry(),n=e.type,i=0,o=0,a=r.length,s=0;s<a;s++){var u=r[s],c=1;1===n&&(c=u.length),t.writeVarint(A(1,c));for(var l=3===n?u.length-1:u.length,h=0;h<l;h++){1===h&&1!==n&&t.writeVarint(A(2,l-1));var f=u[h].x-i,d=u[h].y-o;t.writeVarint(E(f)),t.writeVarint(E(d)),i+=f,o+=d}3===n&&t.writeVarint(A(7,1))}}function T(e,t){var r=typeof e;"string"===r?t.writeStringField(1,e):"boolean"===r?t.writeBooleanField(7,e):"number"===r&&(e%1!=0?t.writeDoubleField(3,e):e<0?t.writeSVarintField(6,e):t.writeVarintField(5,e))}function M(e,t,r,n,i,o){if(i-n<=r)return;const a=n+i>>1;I(e,t,a,n,i,o%2),M(e,t,r,n,a-1,o+1),M(e,t,r,a+1,i,o+1)}function I(e,t,r,n,i,o){for(;i>n;){if(i-n>600){const a=i-n+1,s=r-n+1,u=Math.log(a),c=.5*Math.exp(2*u/3),l=.5*Math.sqrt(u*c*(a-c)/a)*(s-a/2<0?-1:1);I(e,t,r,Math.max(n,Math.floor(r-s*c/a+l)),Math.min(i,Math.floor(r+(a-s)*c/a+l)),o)}const a=t[2*r+o];let s=n,u=i;for(P(e,t,n,r),t[2*i+o]>a&&P(e,t,n,i);s<u;){for(P(e,t,s,u),s++,u--;t[2*s+o]<a;)s++;for(;t[2*u+o]>a;)u--}t[2*n+o]===a?P(e,t,n,u):(u++,P(e,t,u,i)),u<=r&&(n=u+1),r<=u&&(i=u-1)}}function P(e,t,r,n){C(e,r,n),C(t,2*r,2*n),C(t,2*r+1,2*n+1)}function C(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function B(e,t,r,n){const i=e-r,o=t-n;return i*i+o*o}f.exports=b,h.fromVectorTileJs=b,h.fromGeojsonVt=function(e,t){t=t||{};var r={};for(var n in e)r[n]=new _(e[n].features,t),r[n].name=n,r[n].version=t.version,r[n].extent=t.extent;return b({layers:r})},h.GeoJSONWrapper=_;const D=e=>e[0],R=e=>e[1];class L{constructor(e,t=D,r=R,n=64,i=Float64Array){this.nodeSize=n,this.points=e;const o=e.length<65536?Uint16Array:Uint32Array,a=this.ids=new o(e.length),s=this.coords=new i(2*e.length);for(let u=0;u<e.length;u++)a[u]=u,s[2*u]=t(e[u]),s[2*u+1]=r(e[u]);M(a,s,n,0,a.length-1,0)}range(e,t,r,n){return function(e,t,r,n,i,o,a){const s=[0,e.length-1,0],u=[];let c,l;for(;s.length;){const h=s.pop(),f=s.pop(),d=s.pop();if(f-d<=a){for(let a=d;a<=f;a++)c=t[2*a],l=t[2*a+1],c>=r&&c<=i&&l>=n&&l<=o&&u.push(e[a]);continue}const p=Math.floor((d+f)/2);c=t[2*p],l=t[2*p+1],c>=r&&c<=i&&l>=n&&l<=o&&u.push(e[p]);const m=(h+1)%2;(0===h?r<=c:n<=l)&&(s.push(d),s.push(p-1),s.push(m)),(0===h?i>=c:o>=l)&&(s.push(p+1),s.push(f),s.push(m))}return u}(this.ids,this.coords,e,t,r,n,this.nodeSize)}within(e,t,r){return function(e,t,r,n,i,o){const a=[0,e.length-1,0],s=[],u=i*i;for(;a.length;){const c=a.pop(),l=a.pop(),h=a.pop();if(l-h<=o){for(let i=h;i<=l;i++)B(t[2*i],t[2*i+1],r,n)<=u&&s.push(e[i]);continue}const f=Math.floor((h+l)/2),d=t[2*f],p=t[2*f+1];B(d,p,r,n)<=u&&s.push(e[f]);const m=(c+1)%2;(0===c?r-i<=d:n-i<=p)&&(a.push(h),a.push(f-1),a.push(m)),(0===c?r+i>=d:n+i>=p)&&(a.push(f+1),a.push(l),a.push(m))}return s}(this.ids,this.coords,e,t,r,this.nodeSize)}}const O={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:e=>e},z=Math.fround||(N=new Float32Array(1),e=>(N[0]=+e,N[0]));var N;class U{constructor(e){this.options=H(Object.create(O),e),this.trees=new Array(this.options.maxZoom+1)}load(e){const{log:t,minZoom:r,maxZoom:n,nodeSize:i}=this.options;t&&console.time("total time");const o=`prepare ${e.length} points`;t&&console.time(o),this.points=e;let a=[];for(let s=0;s<e.length;s++)e[s].geometry&&a.push(F(e[s],s));this.trees[n+1]=new L(a,q,Y,i,Float32Array),t&&console.timeEnd(o);for(let s=n;s>=r;s--){const e=+Date.now();a=this._cluster(a,s),this.trees[s]=new L(a,q,Y,i,Float32Array),t&&console.log("z%d: %d clusters in %dms",s,a.length,+Date.now()-e)}return t&&console.timeEnd("total time"),this}getClusters(e,t){let r=((e[0]+180)%360+360)%360-180;const n=Math.max(-90,Math.min(90,e[1]));let i=180===e[2]?180:((e[2]+180)%360+360)%360-180;const o=Math.max(-90,Math.min(90,e[3]));if(e[2]-e[0]>=360)r=-180,i=180;else if(r>i){const e=this.getClusters([r,n,180,o],t),a=this.getClusters([-180,n,i,o],t);return e.concat(a)}const a=this.trees[this._limitZoom(t)],s=a.range(W(r),K(o),W(i),K(n)),u=[];for(const c of s){const e=a.points[c];u.push(e.numPoints?j(e):this.points[e.index])}return u}getChildren(e){const t=this._getOriginId(e),r=this._getOriginZoom(e),n="No cluster with the specified id.",i=this.trees[r];if(!i)throw new Error(n);const o=i.points[t];if(!o)throw new Error(n);const a=this.options.radius/(this.options.extent*Math.pow(2,r-1)),s=i.within(o.x,o.y,a),u=[];for(const c of s){const t=i.points[c];t.parentId===e&&u.push(t.numPoints?j(t):this.points[t.index])}if(0===u.length)throw new Error(n);return u}getLeaves(e,t,r){const n=[];return this._appendLeaves(n,e,t=t||10,r=r||0,0),n}getTile(e,t,r){const n=this.trees[this._limitZoom(e)],i=Math.pow(2,e),{extent:o,radius:a}=this.options,s=a/o,u=(r-s)/i,c=(r+1+s)/i,l={features:[]};return this._addTileFeatures(n.range((t-s)/i,u,(t+1+s)/i,c),n.points,t,r,i,l),0===t&&this._addTileFeatures(n.range(1-s/i,u,1,c),n.points,i,r,i,l),t===i-1&&this._addTileFeatures(n.range(0,u,s/i,c),n.points,-1,r,i,l),l.features.length?l:null}getClusterExpansionZoom(e){let t=this._getOriginZoom(e)-1;for(;t<=this.options.maxZoom;){const r=this.getChildren(e);if(t++,1!==r.length)break;e=r[0].properties.cluster_id}return t}_appendLeaves(e,t,r,n,i){const o=this.getChildren(t);for(const a of o){const t=a.properties;if(t&&t.cluster?i+t.point_count<=n?i+=t.point_count:i=this._appendLeaves(e,t.cluster_id,r,n,i):i<n?i++:e.push(a),e.length===r)break}return i}_addTileFeatures(e,t,r,n,i,o){for(const a of e){const e=t[a],s=e.numPoints;let u,c,l;if(s)u=V(e),c=e.x,l=e.y;else{const t=this.points[e.index];u=t.properties,c=W(t.geometry.coordinates[0]),l=K(t.geometry.coordinates[1])}const h={type:1,geometry:[[Math.round(this.options.extent*(c*i-r)),Math.round(this.options.extent*(l*i-n))]],tags:u};let f;s?f=e.id:this.options.generateId?f=e.index:this.points[e.index].id&&(f=this.points[e.index].id),void 0!==f&&(h.id=f),o.features.push(h)}}_limitZoom(e){return Math.max(this.options.minZoom,Math.min(Math.floor(+e),this.options.maxZoom+1))}_cluster(e,t){const r=[],{radius:n,extent:i,reduce:o,minPoints:a}=this.options,s=n/(i*Math.pow(2,t));for(let u=0;u<e.length;u++){const n=e[u];if(n.zoom<=t)continue;n.zoom=t;const i=this.trees[t+1],c=i.within(n.x,n.y,s),l=n.numPoints||1;let h=l;for(const e of c){const r=i.points[e];r.zoom>t&&(h+=r.numPoints||1)}if(h>l&&h>=a){let e=n.x*l,a=n.y*l,s=o&&l>1?this._map(n,!0):null;const f=(u<<5)+(t+1)+this.points.length;for(const r of c){const u=i.points[r];if(u.zoom<=t)continue;u.zoom=t;const c=u.numPoints||1;e+=u.x*c,a+=u.y*c,u.parentId=f,o&&(s||(s=this._map(n,!0)),o(s,this._map(u)))}n.parentId=f,r.push(Z(e/h,a/h,f,h,s))}else if(r.push(n),h>1)for(const e of c){const n=i.points[e];n.zoom<=t||(n.zoom=t,r.push(n))}}return r}_getOriginId(e){return e-this.points.length>>5}_getOriginZoom(e){return(e-this.points.length)%32}_map(e,t){if(e.numPoints)return t?H({},e.properties):e.properties;const r=this.points[e.index].properties,n=this.options.map(r);return t&&n===r?H({},n):n}}function Z(e,t,r,n,i){return{x:z(e),y:z(t),zoom:1/0,id:r,parentId:-1,numPoints:n,properties:i}}function F(e,t){const[r,n]=e.geometry.coordinates;return{x:z(W(r)),y:z(K(n)),zoom:1/0,index:t,parentId:-1}}function j(e){return{type:"Feature",id:e.id,properties:V(e),geometry:{type:"Point",coordinates:[(t=e.x,360*(t-.5)),G(e.y)]}};var t}function V(e){const t=e.numPoints,r=t>=1e4?`${Math.round(t/1e3)}k`:t>=1e3?Math.round(t/100)/10+"k":t;return H(H({},e.properties),{cluster:!0,cluster_id:e.id,point_count:t,point_count_abbreviated:r})}function W(e){return e/360+.5}function K(e){const t=Math.sin(e*Math.PI/180),r=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return r<0?0:r>1?1:r}function G(e){const t=(180-360*e)*Math.PI/180;return 360*Math.atan(Math.exp(t))/Math.PI-90}function H(e,t){for(const r in t)e[r]=t[r];return e}function q(e){return e.x}function Y(e){return e.y}function X(e,t,r,n){for(var i,o=n,a=r-t>>1,s=r-t,u=e[t],c=e[t+1],l=e[r],h=e[r+1],f=t+3;f<r;f+=3){var d=Q(e[f],e[f+1],u,c,l,h);if(d>o)i=f,o=d;else if(d===o){var p=Math.abs(f-a);p<s&&(i=f,s=p)}}o>n&&(i-t>3&&X(e,t,i,n),e[i+2]=o,r-i>3&&X(e,i,r,n))}function Q(e,t,r,n,i,o){var a=i-r,s=o-n;if(0!==a||0!==s){var u=((e-r)*a+(t-n)*s)/(a*a+s*s);u>1?(r=i,n=o):u>0&&(r+=a*u,n+=s*u)}return(a=e-r)*a+(s=t-n)*s}function $(e,t,r,n){var i={id:void 0===e?null:e,type:t,geometry:r,tags:n,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(e){var t=e.geometry,r=e.type;if("Point"===r||"MultiPoint"===r||"LineString"===r)J(e,t);else if("Polygon"===r||"MultiLineString"===r)for(var n=0;n<t.length;n++)J(e,t[n]);else if("MultiPolygon"===r)for(n=0;n<t.length;n++)for(var i=0;i<t[n].length;i++)J(e,t[n][i])}(i),i}function J(e,t){for(var r=0;r<t.length;r+=3)e.minX=Math.min(e.minX,t[r]),e.minY=Math.min(e.minY,t[r+1]),e.maxX=Math.max(e.maxX,t[r]),e.maxY=Math.max(e.maxY,t[r+1])}function ee(e,t,r,n){if(t.geometry){var i=t.geometry.coordinates,o=t.geometry.type,a=Math.pow(r.tolerance/((1<<r.maxZoom)*r.extent),2),s=[],u=t.id;if(r.promoteId?u=t.properties[r.promoteId]:r.generateId&&(u=n||0),"Point"===o)te(i,s);else if("MultiPoint"===o)for(var c=0;c<i.length;c++)te(i[c],s);else if("LineString"===o)re(i,s,a,!1);else if("MultiLineString"===o){if(r.lineMetrics){for(c=0;c<i.length;c++)re(i[c],s=[],a,!1),e.push($(u,"LineString",s,t.properties));return}ne(i,s,a,!1)}else if("Polygon"===o)ne(i,s,a,!0);else{if("MultiPolygon"!==o){if("GeometryCollection"===o){for(c=0;c<t.geometry.geometries.length;c++)ee(e,{id:u,geometry:t.geometry.geometries[c],properties:t.properties},r,n);return}throw new Error("Input data is not a valid GeoJSON object.")}for(c=0;c<i.length;c++){var l=[];ne(i[c],l,a,!0),s.push(l)}}e.push($(u,o,s,t.properties))}}function te(e,t){t.push(ie(e[0])),t.push(oe(e[1])),t.push(0)}function re(e,t,r,n){for(var i,o,a=0,s=0;s<e.length;s++){var u=ie(e[s][0]),c=oe(e[s][1]);t.push(u),t.push(c),t.push(0),s>0&&(a+=n?(i*c-u*o)/2:Math.sqrt(Math.pow(u-i,2)+Math.pow(c-o,2))),i=u,o=c}var l=t.length-3;t[2]=1,X(t,0,l,r),t[l+2]=1,t.size=Math.abs(a),t.start=0,t.end=t.size}function ne(e,t,r,n){for(var i=0;i<e.length;i++){var o=[];re(e[i],o,r,n),t.push(o)}}function ie(e){return e/360+.5}function oe(e){var t=Math.sin(e*Math.PI/180),r=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return r<0?0:r>1?1:r}function ae(e,t,r,n,i,o,a,s){if(n/=t,o>=(r/=t)&&a<n)return e;if(a<r||o>=n)return null;for(var u=[],c=0;c<e.length;c++){var l=e[c],h=l.geometry,f=l.type,d=0===i?l.minX:l.minY,p=0===i?l.maxX:l.maxY;if(d>=r&&p<n)u.push(l);else if(!(p<r||d>=n)){var m=[];if("Point"===f||"MultiPoint"===f)se(h,m,r,n,i);else if("LineString"===f)ue(h,m,r,n,i,!1,s.lineMetrics);else if("MultiLineString"===f)le(h,m,r,n,i,!1);else if("Polygon"===f)le(h,m,r,n,i,!0);else if("MultiPolygon"===f)for(var g=0;g<h.length;g++){var y=[];le(h[g],y,r,n,i,!0),y.length&&m.push(y)}if(m.length){if(s.lineMetrics&&"LineString"===f){for(g=0;g<m.length;g++)u.push($(l.id,f,m[g],l.tags));continue}"LineString"!==f&&"MultiLineString"!==f||(1===m.length?(f="LineString",m=m[0]):f="MultiLineString"),"Point"!==f&&"MultiPoint"!==f||(f=3===m.length?"Point":"MultiPoint"),u.push($(l.id,f,m,l.tags))}}}return u.length?u:null}function se(e,t,r,n,i){for(var o=0;o<e.length;o+=3){var a=e[o+i];a>=r&&a<=n&&(t.push(e[o]),t.push(e[o+1]),t.push(e[o+2]))}}function ue(e,t,r,n,i,o,a){for(var s,u,c=ce(e),l=0===i?fe:de,h=e.start,f=0;f<e.length-3;f+=3){var d=e[f],p=e[f+1],m=e[f+2],g=e[f+3],y=e[f+4],v=0===i?d:p,_=0===i?g:y,b=!1;a&&(s=Math.sqrt(Math.pow(d-g,2)+Math.pow(p-y,2))),v<r?_>r&&(u=l(c,d,p,g,y,r),a&&(c.start=h+s*u)):v>n?_<n&&(u=l(c,d,p,g,y,n),a&&(c.start=h+s*u)):he(c,d,p,m),_<r&&v>=r&&(u=l(c,d,p,g,y,r),b=!0),_>n&&v<=n&&(u=l(c,d,p,g,y,n),b=!0),!o&&b&&(a&&(c.end=h+s*u),t.push(c),c=ce(e)),a&&(h+=s)}var x=e.length-3;d=e[x],p=e[x+1],m=e[x+2],(v=0===i?d:p)>=r&&v<=n&&he(c,d,p,m),x=c.length-3,o&&x>=3&&(c[x]!==c[0]||c[x+1]!==c[1])&&he(c,c[0],c[1],c[2]),c.length&&t.push(c)}function ce(e){var t=[];return t.size=e.size,t.start=e.start,t.end=e.end,t}function le(e,t,r,n,i,o){for(var a=0;a<e.length;a++)ue(e[a],t,r,n,i,o,!1)}function he(e,t,r,n){e.push(t),e.push(r),e.push(n)}function fe(e,t,r,n,i,o){var a=(o-t)/(n-t);return e.push(o),e.push(r+(i-r)*a),e.push(1),a}function de(e,t,r,n,i,o){var a=(o-r)/(i-r);return e.push(t+(n-t)*a),e.push(o),e.push(1),a}function pe(e,t){for(var r=[],n=0;n<e.length;n++){var i,o=e[n],a=o.type;if("Point"===a||"MultiPoint"===a||"LineString"===a)i=me(o.geometry,t);else if("MultiLineString"===a||"Polygon"===a){i=[];for(var s=0;s<o.geometry.length;s++)i.push(me(o.geometry[s],t))}else if("MultiPolygon"===a)for(i=[],s=0;s<o.geometry.length;s++){for(var u=[],c=0;c<o.geometry[s].length;c++)u.push(me(o.geometry[s][c],t));i.push(u)}r.push($(o.id,a,i,o.tags))}return r}function me(e,t){var r=[];r.size=e.size,void 0!==e.start&&(r.start=e.start,r.end=e.end);for(var n=0;n<e.length;n+=3)r.push(e[n]+t,e[n+1],e[n+2]);return r}function ge(e,t){if(e.transformed)return e;var r,n,i,o=1<<e.z,a=e.x,s=e.y;for(r=0;r<e.features.length;r++){var u=e.features[r],c=u.geometry,l=u.type;if(u.geometry=[],1===l)for(n=0;n<c.length;n+=2)u.geometry.push(ye(c[n],c[n+1],t,o,a,s));else for(n=0;n<c.length;n++){var h=[];for(i=0;i<c[n].length;i+=2)h.push(ye(c[n][i],c[n][i+1],t,o,a,s));u.geometry.push(h)}}return e.transformed=!0,e}function ye(e,t,r,n,i,o){return[Math.round(r*(e*n-i)),Math.round(r*(t*n-o))]}function ve(e,t,r,n,i){for(var o=t===i.maxZoom?0:i.tolerance/((1<<t)*i.extent),a={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:r,y:n,z:t,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},s=0;s<e.length;s++){a.numFeatures++,_e(a,e[s],o,i);var u=e[s].minX,c=e[s].minY,l=e[s].maxX,h=e[s].maxY;u<a.minX&&(a.minX=u),c<a.minY&&(a.minY=c),l>a.maxX&&(a.maxX=l),h>a.maxY&&(a.maxY=h)}return a}function _e(e,t,r,n){var i=t.geometry,o=t.type,a=[];if("Point"===o||"MultiPoint"===o)for(var s=0;s<i.length;s+=3)a.push(i[s]),a.push(i[s+1]),e.numPoints++,e.numSimplified++;else if("LineString"===o)be(a,i,e,r,!1,!1);else if("MultiLineString"===o||"Polygon"===o)for(s=0;s<i.length;s++)be(a,i[s],e,r,"Polygon"===o,0===s);else if("MultiPolygon"===o)for(var u=0;u<i.length;u++){var c=i[u];for(s=0;s<c.length;s++)be(a,c[s],e,r,!0,0===s)}if(a.length){var l=t.tags||null;if("LineString"===o&&n.lineMetrics){for(var h in l={},t.tags)l[h]=t.tags[h];l.mapbox_clip_start=i.start/i.size,l.mapbox_clip_end=i.end/i.size}var f={geometry:a,type:"Polygon"===o||"MultiPolygon"===o?3:"LineString"===o||"MultiLineString"===o?2:1,tags:l};null!==t.id&&(f.id=t.id),e.features.push(f)}}function be(e,t,r,n,i,o){var a=n*n;if(n>0&&t.size<(i?a:n))r.numPoints+=t.length/3;else{for(var s=[],u=0;u<t.length;u+=3)(0===n||t[u+2]>a)&&(r.numSimplified++,s.push(t[u]),s.push(t[u+1])),r.numPoints++;i&&function(e,t){for(var r=0,n=0,i=e.length,o=i-2;n<i;o=n,n+=2)r+=(e[n]-e[o])*(e[n+1]+e[o+1]);if(r>0===t)for(n=0,i=e.length;n<i/2;n+=2){var a=e[n],s=e[n+1];e[n]=e[i-2-n],e[n+1]=e[i-1-n],e[i-2-n]=a,e[i-1-n]=s}}(s,o),e.push(s)}}function xe(e,t){var r=(t=this.options=function(e,t){for(var r in t)e[r]=t[r];return e}(Object.create(this.options),t)).debug;if(r&&console.time("preprocess data"),t.maxZoom<0||t.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(t.promoteId&&t.generateId)throw new Error("promoteId and generateId cannot be used together.");var n=function(e,t){var r=[];if("FeatureCollection"===e.type)for(var n=0;n<e.features.length;n++)ee(r,e.features[n],t,n);else ee(r,"Feature"===e.type?e:{geometry:e},t);return r}(e,t);this.tiles={},this.tileCoords=[],r&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",t.indexMaxZoom,t.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),n=function(e,t){var r=t.buffer/t.extent,n=e,i=ae(e,1,-1-r,r,0,-1,2,t),o=ae(e,1,1-r,2+r,0,-1,2,t);return(i||o)&&(n=ae(e,1,-r,1+r,0,-1,2,t)||[],i&&(n=pe(i,1).concat(n)),o&&(n=n.concat(pe(o,-1)))),n}(n,t),n.length&&this.splitTile(n,0,0,0),r&&(n.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function we(e,t,r){return 32*((1<<e)*r+t)+e}function ke(e,t){const r=e.tileID.canonical;if(!this._geoJSONIndex)return t(null,null);const n=this._geoJSONIndex.getTile(r.z,r.x,r.y);if(!n)return t(null,null);const i=new l(n.features);let o=h(i);0===o.byteOffset&&o.byteLength===o.buffer.byteLength||(o=new Uint8Array(o)),t(null,{vectorTile:i,rawData:o.buffer})}xe.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},xe.prototype.splitTile=function(e,t,r,n,i,o,a){for(var s=[e,t,r,n],u=this.options,c=u.debug;s.length;){n=s.pop(),r=s.pop(),t=s.pop(),e=s.pop();var l=1<<t,h=we(t,r,n),f=this.tiles[h];if(!f&&(c>1&&console.time("creation"),f=this.tiles[h]=ve(e,t,r,n,u),this.tileCoords.push({z:t,x:r,y:n}),c)){c>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",t,r,n,f.numFeatures,f.numPoints,f.numSimplified),console.timeEnd("creation"));var d="z"+t;this.stats[d]=(this.stats[d]||0)+1,this.total++}if(f.source=e,i){if(t===u.maxZoom||t===i)continue;var p=1<<i-t;if(r!==Math.floor(o/p)||n!==Math.floor(a/p))continue}else if(t===u.indexMaxZoom||f.numPoints<=u.indexMaxPoints)continue;if(f.source=null,0!==e.length){c>1&&console.time("clipping");var m,g,y,v,_,b,x=.5*u.buffer/u.extent,w=.5-x,k=.5+x,A=1+x;m=g=y=v=null,_=ae(e,l,r-x,r+k,0,f.minX,f.maxX,u),b=ae(e,l,r+w,r+A,0,f.minX,f.maxX,u),e=null,_&&(m=ae(_,l,n-x,n+k,1,f.minY,f.maxY,u),g=ae(_,l,n+w,n+A,1,f.minY,f.maxY,u),_=null),b&&(y=ae(b,l,n-x,n+k,1,f.minY,f.maxY,u),v=ae(b,l,n+w,n+A,1,f.minY,f.maxY,u),b=null),c>1&&console.timeEnd("clipping"),s.push(m||[],t+1,2*r,2*n),s.push(g||[],t+1,2*r,2*n+1),s.push(y||[],t+1,2*r+1,2*n),s.push(v||[],t+1,2*r+1,2*n+1)}}},xe.prototype.getTile=function(e,t,r){var n=this.options,i=n.extent,o=n.debug;if(e<0||e>24)return null;var a=1<<e,s=we(e,t=(t%a+a)%a,r);if(this.tiles[s])return ge(this.tiles[s],i);o>1&&console.log("drilling down to z%d-%d-%d",e,t,r);for(var u,c=e,l=t,h=r;!u&&c>0;)c--,l=Math.floor(l/2),h=Math.floor(h/2),u=this.tiles[we(c,l,h)];return u&&u.source?(o>1&&console.log("found parent tile z%d-%d-%d",c,l,h),o>1&&console.time("drilling down"),this.splitTile(u.source,c,l,h,e,t,r),o>1&&console.timeEnd("drilling down"),this.tiles[s]?ge(this.tiles[s],i):null):null};class Ae extends e.VectorTileWorkerSource{constructor(e,t,r,n,i){super(e,t,r,n,ke),i&&(this.loadGeoJSON=i)}loadData(t,r){const n=t&&t.request,i=n&&n.collectResourceTiming;this.loadGeoJSON(t,((a,s)=>{if(a||!s)return r(a);if("object"!=typeof s)return r(new Error(`Input data given to '${t.source}' is not a valid GeoJSON object.`));{o(s,!0);try{if(t.filter){const r=e.createExpression(t.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===r.result)throw new Error(r.value.map((e=>`${e.key}: ${e.message}`)).join(", "));const n=s.features.filter((e=>r.value.evaluate({zoom:0},e)));s={type:"FeatureCollection",features:n}}this._geoJSONIndex=t.cluster?new U(function({superclusterOptions:t,clusterProperties:r}){if(!r||!t)return t;const n={},i={},o={accumulated:null,zoom:0},a={properties:null},s=Object.keys(r);for(const u of s){const[t,o]=r[u],a=e.createExpression(o),s=e.createExpression("string"==typeof t?[t,["accumulated"],["get",u]]:t);n[u]=a.value,i[u]=s.value}return t.map=e=>{a.properties=e;const t={};for(const r of s)t[r]=n[r].evaluate(o,a);return t},t.reduce=(e,t)=>{a.properties=t;for(const r of s)o.accumulated=e[r],e[r]=i[r].evaluate(o,a)},t}(t)).load(s.features):function(e,t){return new xe(e,t)}(s,t.geojsonVtOptions)}catch(a){return r(a)}this.loaded={};const u={};if(i){const r=e.getPerformanceMeasurement(n);r&&(u.resourceTiming={},u.resourceTiming[t.source]=JSON.parse(JSON.stringify(r)))}r(null,u)}}))}reloadTile(e,t){const r=this.loaded;return r&&r[e.uid]?super.reloadTile(e,t):this.loadTile(e,t)}loadGeoJSON(t,r){if(t.request)e.getJSON(t.request,r);else{if("string"!=typeof t.data)return r(new Error(`Input data given to '${t.source}' is not a valid GeoJSON object.`));try{return r(null,JSON.parse(t.data))}catch(e){return r(new Error(`Input data given to '${t.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(e,t){try{t(null,this._geoJSONIndex.getClusterExpansionZoom(e.clusterId))}catch(e){t(e)}}getClusterChildren(e,t){try{t(null,this._geoJSONIndex.getChildren(e.clusterId))}catch(e){t(e)}}getClusterLeaves(e,t){try{t(null,this._geoJSONIndex.getLeaves(e.clusterId,e.limit,e.offset))}catch(e){t(e)}}}class Ee{constructor(t){this.self=t,this.actor=new e.Actor(t,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=e.getProjection({name:"mercator"}),this.workerSourceTypes={vector:e.VectorTileWorkerSource,geojson:Ae},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(e,t)=>{if(this.workerSourceTypes[e])throw new Error(`Worker source with name "${e}" already registered.`);this.workerSourceTypes[e]=t},this.self.registerRTLTextPlugin=t=>{if(e.plugin.isParsed())throw new Error("RTL text plugin already registered.");e.plugin.applyArabicShaping=t.applyArabicShaping,e.plugin.processBidirectionalText=t.processBidirectionalText,e.plugin.processStyledBidirectionalText=t.processStyledBidirectionalText}}clearCaches(e,t,r){delete this.layerIndexes[e],delete this.availableImages[e],delete this.workerSources[e],delete this.demWorkerSources[e],r()}checkIfReady(e,t,r){r()}setReferrer(e,t){this.referrer=t}spriteLoaded(t,r){this.isSpriteLoaded[t]=r;for(const n in this.workerSources[t]){const i=this.workerSources[t][n];for(const t in i)i[t]instanceof e.VectorTileWorkerSource&&(i[t].isSpriteLoaded=r,i[t].fire(new e.Event("isSpriteLoaded")))}}setImages(e,t,r){this.availableImages[e]=t;for(const n in this.workerSources[e]){const r=this.workerSources[e][n];for(const e in r)r[e].availableImages=t}r()}enableTerrain(e,t,r){this.terrain=t,r()}setProjection(t,r){this.projections[t]=e.getProjection(r)}setLayers(e,t,r){this.getLayerIndex(e).replace(t),r()}updateLayers(e,t,r){this.getLayerIndex(e).update(t.layers,t.removedIds),r()}loadTile(t,r,n){const i=this.enableTerrain?e.extend({enableTerrain:this.terrain},r):r;i.projection=this.projections[t]||this.defaultProjection,this.getWorkerSource(t,r.type,r.source).loadTile(i,n)}loadDEMTile(t,r,n){const i=this.enableTerrain?e.extend({buildQuadTree:this.terrain},r):r;this.getDEMWorkerSource(t,r.source).loadTile(i,n)}reloadTile(t,r,n){const i=this.enableTerrain?e.extend({enableTerrain:this.terrain},r):r;i.projection=this.projections[t]||this.defaultProjection,this.getWorkerSource(t,r.type,r.source).reloadTile(i,n)}abortTile(e,t,r){this.getWorkerSource(e,t.type,t.source).abortTile(t,r)}removeTile(e,t,r){this.getWorkerSource(e,t.type,t.source).removeTile(t,r)}removeSource(e,t,r){if(!this.workerSources[e]||!this.workerSources[e][t.type]||!this.workerSources[e][t.type][t.source])return;const n=this.workerSources[e][t.type][t.source];delete this.workerSources[e][t.type][t.source],void 0!==n.removeSource?n.removeSource(t,r):r()}loadWorkerSource(e,t,r){try{this.self.importScripts(t.url),r()}catch(e){r(e.toString())}}syncRTLPluginState(t,r,n){try{e.plugin.setState(r);const t=e.plugin.getPluginURL();if(e.plugin.isLoaded()&&!e.plugin.isParsed()&&null!=t){this.self.importScripts(t);const r=e.plugin.isParsed();n(r?void 0:new Error(`RTL Text Plugin failed to import scripts from ${t}`),r)}}catch(e){n(e.toString())}}getAvailableImages(e){let t=this.availableImages[e];return t||(t=[]),t}getLayerIndex(e){let t=this.layerIndexes[e];return t||(t=this.layerIndexes[e]=new n),t}getWorkerSource(e,t,r){if(this.workerSources[e]||(this.workerSources[e]={}),this.workerSources[e][t]||(this.workerSources[e][t]={}),!this.workerSources[e][t][r]){const n={send:(t,r,n,i,o,a)=>{this.actor.send(t,r,n,e,o,a)},scheduler:this.actor.scheduler};this.workerSources[e][t][r]=new this.workerSourceTypes[t](n,this.getLayerIndex(e),this.getAvailableImages(e),this.isSpriteLoaded[e])}return this.workerSources[e][t][r]}getDEMWorkerSource(e,t){return this.demWorkerSources[e]||(this.demWorkerSources[e]={}),this.demWorkerSources[e][t]||(this.demWorkerSources[e][t]=new i),this.demWorkerSources[e][t]}enforceCacheSizeLimit(t,r){e.enforceCacheSizeLimit(r)}getWorkerPerformanceMetrics(e,t,r){r(void 0,void 0)}}return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope&&(self.worker=new Ee(self)),Ee})),n(["./shared"],(function(e){function t(e,r){if(Array.isArray(e)){if(!Array.isArray(r)||e.length!==r.length)return!1;for(let n=0;n<e.length;n++)if(!t(e[n],r[n]))return!1;return!0}if("object"==typeof e&&null!==e&&null!==r){if("object"!=typeof r)return!1;if(Object.keys(e).length!==Object.keys(r).length)return!1;for(const n in e)if(!t(e[n],r[n]))return!1;return!0}return e===r}var r=n;function n(e){return!function(e){return"undefined"==typeof window||"undefined"==typeof document?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var e,t,r=new Blob([""],{type:"text/javascript"}),n=URL.createObjectURL(r);try{t=new Worker(n),e=!0}catch(t){e=!1}return t&&t.terminate(),URL.revokeObjectURL(n),e}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var e=document.createElement("canvas");e.width=e.height=1;var t=e.getContext("2d");if(!t)return!1;var r=t.getImageData(0,0,1,1);return r&&r.width===e.width}()?(void 0===i[t=e&&e.failIfMajorPerformanceCaveat]&&(i[t]=function(e){var t,r=function(e){var t=document.createElement("canvas"),r=Object.create(n.webGLContextAttributes);return r.failIfMajorPerformanceCaveat=e,t.getContext("webgl",r)||t.getContext("experimental-webgl",r)}(e);if(!r)return!1;try{t=r.createShader(r.VERTEX_SHADER)}catch(e){return!1}return!(!t||r.isContextLost())&&(r.shaderSource(t,"void main() {}"),r.compileShader(t),!0===r.getShaderParameter(t,r.COMPILE_STATUS))}(t)),i[t]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var t}(e)}var i={};function o(t,r,n){const i=e.window.document.createElement(t);return void 0!==r&&(i.className=r),n&&n.appendChild(i),i}function a(t,r,n){const i=e.window.document.createElementNS("http://www.w3.org/2000/svg",t);for(const e of Object.keys(r))i.setAttributeNS(null,e,r[e]);return n&&n.appendChild(i),i}n.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const s=e.window.document&&e.window.document.documentElement.style,u=s&&void 0!==s.userSelect?"userSelect":"WebkitUserSelect";let c;function l(){s&&u&&(c=s[u],s[u]="none")}function h(){s&&u&&(s[u]=c)}function f(t){t.preventDefault(),t.stopPropagation(),e.window.removeEventListener("click",f,!0)}function d(){e.window.addEventListener("click",f,!0),e.window.setTimeout((()=>{e.window.removeEventListener("click",f,!0)}),0)}function p(e,t){const r=e.getBoundingClientRect();return y(e,r,t)}function m(e,t){const r=e.getBoundingClientRect(),n=[];for(let i=0;i<t.length;i++)n.push(y(e,r,t[i]));return n}function g(t){return void 0!==e.window.InstallTrigger&&2===t.button&&t.ctrlKey&&e.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:t.button}function y(t,r,n){const i=t.offsetWidth===r.width?1:t.offsetWidth/r.width;return new e.pointGeometry((n.clientX-r.left)*i,(n.clientY-r.top)*i)}function v(e,t){var r=t[0],n=t[1],i=t[2],o=t[3],a=r*o-i*n;return a?(e[0]=o*(a=1/a),e[1]=-n*a,e[2]=-i*a,e[3]=r*a,e):null}function _(e){const{userImage:t}=e;return!!(t&&t.render&&t.render())&&(e.data.replace(new Uint8Array(t.data.buffer)),!0)}class b extends e.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new e.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(e){if(this.loaded!==e&&(this.loaded=e,e)){for(const{ids:e,callback:t}of this.requestors)this._notify(e,t);this.requestors=[]}}hasImage(e){return!!this.getImage(e)}getImage(e){return this.images[e]}addImage(e,t){this._validate(e,t)&&(this.images[e]=t)}_validate(t,r){let n=!0;return this._validateStretch(r.stretchX,r.data&&r.data.width)||(this.fire(new e.ErrorEvent(new Error(`Image "${t}" has invalid "stretchX" value`))),n=!1),this._validateStretch(r.stretchY,r.data&&r.data.height)||(this.fire(new e.ErrorEvent(new Error(`Image "${t}" has invalid "stretchY" value`))),n=!1),this._validateContent(r.content,r)||(this.fire(new e.ErrorEvent(new Error(`Image "${t}" has invalid "content" value`))),n=!1),n}_validateStretch(e,t){if(!e)return!0;let r=0;for(const n of e){if(n[0]<r||n[1]<n[0]||t<n[1])return!1;r=n[1]}return!0}_validateContent(e,t){return!(e&&(4!==e.length||e[0]<0||t.data.width<e[0]||e[1]<0||t.data.height<e[1]||e[2]<0||t.data.width<e[2]||e[3]<0||t.data.height<e[3]||e[2]<e[0]||e[3]<e[1]))}updateImage(e,t){t.version=this.images[e].version+1,this.images[e]=t,this.updatedImages[e]=!0}removeImage(e){const t=this.images[e];delete this.images[e],delete this.patterns[e],t.userImage&&t.userImage.onRemove&&t.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(e,t){let r=!0;if(!this.isLoaded())for(const n of e)this.images[n]||(r=!1);this.isLoaded()||r?this._notify(e,t):this.requestors.push({ids:e,callback:t})}_notify(t,r){const n={};for(const i of t){this.images[i]||this.fire(new e.Event("styleimagemissing",{id:i}));const t=this.images[i];t?n[i]={data:t.data.clone(),pixelRatio:t.pixelRatio,sdf:t.sdf,version:t.version,stretchX:t.stretchX,stretchY:t.stretchY,content:t.content,hasRenderCallback:Boolean(t.userImage&&t.userImage.render)}:e.warnOnce(`Image "${i}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}r(null,n)}getPixelSize(){const{width:e,height:t}=this.atlasImage;return{width:e,height:t}}getPattern(t){const r=this.patterns[t],n=this.getImage(t);if(!n)return null;if(r&&r.position.version===n.version)return r.position;if(r)r.position.version=n.version;else{const r={w:n.data.width+2,h:n.data.height+2,x:0,y:0},i=new e.ImagePosition(r,n);this.patterns[t]={bin:r,position:i}}return this._updatePatternAtlas(),this.patterns[t].position}bind(t){const r=t.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new e.Texture(t,this.atlasImage,r.RGBA),this.atlasTexture.bind(r.LINEAR,r.CLAMP_TO_EDGE)}_updatePatternAtlas(){const t=[];for(const e in this.patterns)t.push(this.patterns[e].bin);const{w:r,h:n}=e.potpack(t),i=this.atlasImage;i.resize({width:r||1,height:n||1});for(const o in this.patterns){const{bin:t}=this.patterns[o],r=t.x+1,n=t.y+1,a=this.images[o].data,s=a.width,u=a.height;e.RGBAImage.copy(a,i,{x:0,y:0},{x:r,y:n},{width:s,height:u}),e.RGBAImage.copy(a,i,{x:0,y:u-1},{x:r,y:n-1},{width:s,height:1}),e.RGBAImage.copy(a,i,{x:0,y:0},{x:r,y:n+u},{width:s,height:1}),e.RGBAImage.copy(a,i,{x:s-1,y:0},{x:r-1,y:n},{width:1,height:u}),e.RGBAImage.copy(a,i,{x:0,y:0},{x:r+s,y:n},{width:1,height:u})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(e){for(const t of e){if(this.callbackDispatchedThisFrame[t])continue;this.callbackDispatchedThisFrame[t]=!0;const e=this.images[t];_(e)&&this.updateImage(t,e)}}}const x=new e.Properties({anchor:new e.DataConstantProperty(e.spec.light.anchor),position:new class{constructor(){this.specification=e.spec.light.position}possiblyEvaluate(t,r){return function([t,r,n]){const i=e.degToRad(r+90),o=e.degToRad(n);return{x:t*Math.cos(i)*Math.sin(o),y:t*Math.sin(i)*Math.sin(o),z:t*Math.cos(o),azimuthal:r,polar:n}}(t.expression.evaluate(r))}interpolate(t,r,n){return{x:e.number(t.x,r.x,n),y:e.number(t.y,r.y,n),z:e.number(t.z,r.z,n),azimuthal:e.number(t.azimuthal,r.azimuthal,n),polar:e.number(t.polar,r.polar,n)}}},color:new e.DataConstantProperty(e.spec.light.color),intensity:new e.DataConstantProperty(e.spec.light.intensity)}),w="-transition";class k extends e.Evented{constructor(t){super(),this._transitionable=new e.Transitionable(x),this.setLight(t),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(t,r={}){if(!this._validate(e.validateLight,t,r))for(const n in t){const r=t[n];e.endsWith(n,w)?this._transitionable.setTransition(n.slice(0,-w.length),r):this._transitionable.setValue(n,r)}}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(t,r,n){return(!n||!1!==n.validate)&&e.emitValidationErrors(this,t.call(e.validateStyle,e.extend({value:r,style:{glyphs:!0,sprite:!0},styleSpec:e.spec})))}}const A=new e.Properties({source:new e.DataConstantProperty(e.spec.terrain.source),exaggeration:new e.DataConstantProperty(e.spec.terrain.exaggeration)}),E="-transition";class S extends e.Evented{constructor(t,r){super(),this._transitionable=new e.Transitionable(A),this.set(t),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=r}get(){return this._transitionable.serialize()}set(t){for(const r in t){const n=t[r];e.endsWith(r,E)?this._transitionable.setTransition(r.slice(0,-E.length),n):this._transitionable.setValue(r,n)}}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}}function T(t,r,n,i){const o=e.smoothstep(45,65,n),[a,s]=M(t,i),u=e.length(r);let c=1-Math.min(1,Math.exp((u-a)/(s-a)*-6));return c*=c*c,c=Math.min(1,1.00747*c),c*o*t.alpha}function M(e,t){const r=.5/Math.tan(.5*t);return[e.range[0]+r,e.range[1]+r]}const I=new e.Properties({range:new e.DataConstantProperty(e.spec.fog.range),color:new e.DataConstantProperty(e.spec.fog.color),"high-color":new e.DataConstantProperty(e.spec.fog["high-color"]),"space-color":new e.DataConstantProperty(e.spec.fog["space-color"]),"horizon-blend":new e.DataConstantProperty(e.spec.fog["horizon-blend"]),"star-intensity":new e.DataConstantProperty(e.spec.fog["star-intensity"])}),P="-transition";class C extends e.Evented{constructor(t,r){super(),this._transitionable=new e.Transitionable(I),this.set(t),this._transitioning=this._transitionable.untransitioned(),this._transform=r}get state(){const t=this._transform,r="globe"===t.projection.name,n=e.globeToMercatorTransition(t.zoom),i=this.properties.get("range"),o=[.5,3];return{range:r?[e.number(o[0],i[0],n),e.number(o[1],i[1],n)]:i,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(t,r={}){if(!this._validate(e.validateFog,t,r)){for(const r of Object.keys(e.spec.fog))t&&void 0===t[r]&&(t[r]=e.spec.fog[r].default);for(const r in t){const n=t[r];e.endsWith(r,P)?this._transitionable.setTransition(r.slice(0,-P.length),n):this._transitionable.setValue(r,n)}}}getOpacity(t){if(!this._transform.projection.supportsFog)return 0;const r=this.properties&&this.properties.get("color")||1;return("globe"===this._transform.projection.name?1:e.smoothstep(45,65,t))*r.a}getOpacityAtLatLng(t,r){return this._transform.projection.supportsFog?function(t,r,n){const i=e.MercatorCoordinate.fromLngLat(r),o=n.elevation?n.elevation.getAtPointOrZero(i):0,a=[i.x,i.y,o];return e.transformMat4(a,a,n.mercatorFogMatrix),T(t,a,n.pitch,n._fov)}(this.state,t,r):0}getFovAdjustedRange(e){return this._transform.projection.supportsFog?M(this.state,e):[0,1]}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(t,r,n){return(!n||!1!==n.validate)&&e.emitValidationErrors(this,t.call(e.validateStyle,e.extend({value:r,style:{glyphs:!0,sprite:!0},styleSpec:e.spec})))}}class B{constructor(t,r){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=e.uniqueId();const n=this.workerPool.acquire(this.id);for(let e=0;e<n.length;e++){const t=new B.Actor(n[e],r,this.id);t.name=`Worker ${e}`,this.actors.push(t)}this.ready=!1,this.broadcast("checkIfReady",null,(()=>{this.ready=!0}))}broadcast(t,r,n){e.asyncAll(this.actors,((e,n)=>{e.send(t,r,n)}),n=n||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach((e=>{e.remove()})),this.actors=[],this.workerPool.release(this.id)}}function D(t,r,n){return r*(e.EXTENT/(t.tileSize*Math.pow(2,n-t.tileID.overscaledZ)))}B.Actor=e.Actor;class R{constructor(e,t,r,n){this.screenBounds=e,this.cameraPoint=t,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=r,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,n)}static createFromScreenPoints(t,r){let n,i;if(t instanceof e.pointGeometry||"number"==typeof t[0]){const o=e.pointGeometry.convert(t);n=[o],i=r.isPointAboveHorizon(o)}else{const o=e.pointGeometry.convert(t[0]),a=e.pointGeometry.convert(t[1]);n=[o,a],i=e.polygonizeBounds(o,a).every((e=>r.isPointAboveHorizon(e)))}return new R(n,r.getCameraPoint(),i,r)}isPointQuery(){return 1===this.screenBounds.length}bufferedScreenGeometry(t){return e.polygonizeBounds(this.screenBounds[0],1===this.screenBounds.length?this.screenBounds[0]:this.screenBounds[1],t)}bufferedCameraGeometry(t){const r=this.screenBounds[0],n=1===this.screenBounds.length?this.screenBounds[0].add(new e.pointGeometry(1,1)):this.screenBounds[1],i=e.polygonizeBounds(r,n,0,!1);return this.cameraPoint.y>n.y&&(this.cameraPoint.x>r.x&&this.cameraPoint.x<n.x?i.splice(3,0,this.cameraPoint):this.cameraPoint.x>=n.x?i[2]=this.cameraPoint:this.cameraPoint.x<=r.x&&(i[3]=this.cameraPoint)),e.bufferConvexPolygon(i,t)}bufferedCameraGeometryGlobe(t){const r=this.screenBounds[0],n=1===this.screenBounds.length?this.screenBounds[0].add(new e.pointGeometry(1,1)):this.screenBounds[1],i=e.polygonizeBounds(r,n,t),o=this.cameraPoint.clone();switch(3*((o.y>r.y)+(o.y>n.y))+((o.x>r.x)+(o.x>n.x))){case 0:i[0]=o,i[4]=o.clone();break;case 1:i.splice(1,0,o);break;case 2:i[1]=o;break;case 3:i.splice(4,0,o);break;case 5:i.splice(2,0,o);break;case 6:i[3]=o;break;case 7:i.splice(3,0,o);break;case 8:i[2]=o}return i}containsTile(t,r,n,i=0){const o=t.queryPadding/r._pixelsPerMercatorPixel+1,a=n?this._bufferedCameraMercator(o,r):this._bufferedScreenMercator(o,r);let s=t.tileID.wrap+(a.unwrapped?i:0);const u=a.polygon.map((r=>e.getTilePoint(t.tileTransform,r,s)));if(!e.polygonIntersectsBox(u,0,0,e.EXTENT,e.EXTENT))return;s=t.tileID.wrap+(this.screenGeometryMercator.unwrapped?i:0);const c=this.screenGeometryMercator.polygon.map((r=>e.getTileVec3(t.tileTransform,r,s))),l=c.map((t=>new e.pointGeometry(t[0],t[1]))),h=r.getFreeCameraOptions().position||new e.MercatorCoordinate(0,0,0),f=e.getTileVec3(t.tileTransform,h,s),d=c.map((t=>{const r=e.sub(t,t,f);return e.normalize(r,r),new e.Ray(f,r)})),p=D(t,1,r.zoom)*r._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:l,tilespaceRays:d,bufferedTilespaceGeometry:u,bufferedTilespaceBounds:(m=e.getBounds(u),m.min.x=e.clamp(m.min.x,0,e.EXTENT),m.min.y=e.clamp(m.min.y,0,e.EXTENT),m.max.x=e.clamp(m.max.x,0,e.EXTENT),m.max.y=e.clamp(m.max.y,0,e.EXTENT),m),tile:t,tileID:t.tileID,pixelToTileUnitsFactor:p};var m}_bufferedScreenMercator(e,t){const r=z(e);if(this._screenRaycastCache[r])return this._screenRaycastCache[r];{let n;return n="globe"===t.projection.name?this._projectAndResample(this.bufferedScreenGeometry(e),t):{polygon:this.bufferedScreenGeometry(e).map((e=>t.pointCoordinate3D(e))),unwrapped:!0},this._screenRaycastCache[r]=n,n}}_bufferedCameraMercator(e,t){const r=z(e);if(this._cameraRaycastCache[r])return this._cameraRaycastCache[r];{let n;return n="globe"===t.projection.name?this._projectAndResample(this.bufferedCameraGeometryGlobe(e),t):{polygon:this.bufferedCameraGeometry(e).map((e=>t.pointCoordinate3D(e))),unwrapped:!0},this._cameraRaycastCache[r]=n,n}}_projectAndResample(t,r){const n=function(t,r){const n=e.multiply([],r.pixelMatrix,r.globeMatrix),i=[0,-e.GLOBE_RADIUS,0,1],o=[0,e.GLOBE_RADIUS,0,1],a=[0,0,0,1];e.transformMat4$1(i,i,n),e.transformMat4$1(o,o,n),e.transformMat4$1(a,a,n);const s=new e.pointGeometry(i[0]/i[3],i[1]/i[3]),u=new e.pointGeometry(o[0]/o[3],o[1]/o[3]),c=e.polygonContainsPoint(t,s)&&i[3]<a[3],l=e.polygonContainsPoint(t,u)&&o[3]<a[3];if(!c&&!l)return null;const h=function(e,t,r){for(let n=1;n<e.length;n++){const i=O(t.pointCoordinate3D(e[n-1]).x),o=O(t.pointCoordinate3D(e[n]).x);if(r<0){if(i<o)return{idx:n,t:-i/(o-1-i)}}else if(o<i)return{idx:n,t:(1-i)/(o+1-i)}}return null}(t,r,c?-1:1);if(!h)return null;const{idx:f,t:d}=h;let p=f>1?L(t.slice(0,f),r):[],m=f<t.length?L(t.slice(f),r):[];p=p.map((t=>new e.pointGeometry(O(t.x),t.y))),m=m.map((t=>new e.pointGeometry(O(t.x),t.y)));const g=[...p];0===g.length&&g.push(m[m.length-1]);const y=e.number(g[g.length-1].y,(0===m.length?p[0]:m[0]).y,d);let v;return v=c?[new e.pointGeometry(0,y),new e.pointGeometry(0,0),new e.pointGeometry(1,0),new e.pointGeometry(1,y)]:[new e.pointGeometry(1,y),new e.pointGeometry(1,1),new e.pointGeometry(0,1),new e.pointGeometry(0,y)],g.push(...v),0===m.length?g.push(p[0]):g.push(...m),{polygon:g.map((t=>new e.MercatorCoordinate(t.x,t.y))),unwrapped:!1}}(t,r);if(n)return n;const i=function(t,r){let n=!1,i=-1/0,o=0;for(let e=0;e<t.length-1;e++)t[e].x>i&&(i=t[e].x,o=e);for(let e=0;e<t.length-1;e++){const r=(o+e)%(t.length-1),i=t[r],a=t[r+1];Math.abs(i.x-a.x)>.5&&(i.x<a.x?(i.x+=1,0===r&&(t[t.length-1].x+=1)):(a.x+=1,r+1===t.length-1&&(t[0].x+=1)),n=!0)}const a=e.mercatorXfromLng(r.center.lng);return n&&a<Math.abs(a-1)&&t.forEach((e=>{e.x-=1})),{polygon:t,unwrapped:n}}(L(t,r).map((t=>new e.pointGeometry(O(t.x),t.y))),r);return{polygon:i.polygon.map((t=>new e.MercatorCoordinate(t.x,t.y))),unwrapped:i.unwrapped}}}function L(t,r){return e.resample(t,(e=>{const t=r.pointCoordinate3D(e);e.x=t.x,e.y=t.y}),1/256)}function O(e){return e<0?1+e%1:e%1}function z(e){return 100*e|0}function N(t,r,n,i,o){const a=function(n,i){if(n)return o(n);if(i){t.url&&i.tiles&&t.tiles&&delete t.tiles;const n=e.pick(e.extend(i,t),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);i.vector_layers&&(n.vectorLayers=i.vector_layers,n.vectorLayerIds=n.vectorLayers.map((e=>e.id))),n.tiles=r.canonicalizeTileset(n,t.url),o(null,n)}};return t.url?e.getJSON(r.transformRequest(r.normalizeSourceURL(t.url,null,n,i),e.ResourceType.Source),a):e.exported.frame((()=>a(null,t)))}class U{constructor(t,r,n){this.bounds=e.LngLatBounds.convert(this.validateBounds(t)),this.minzoom=r||0,this.maxzoom=n||24}validateBounds(e){return Array.isArray(e)&&4===e.length?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]}contains(t){const r=Math.pow(2,t.z),n=Math.floor(e.mercatorXfromLng(this.bounds.getWest())*r),i=Math.floor(e.mercatorYfromLat(this.bounds.getNorth())*r),o=Math.ceil(e.mercatorXfromLng(this.bounds.getEast())*r),a=Math.ceil(e.mercatorYfromLat(this.bounds.getSouth())*r);return t.x>=n&&t.x<o&&t.y>=i&&t.y<a}}class Z{constructor(e,t,r){this.context=e;const n=e.gl;this.buffer=n.createBuffer(),this.dynamicDraw=Boolean(r),this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),n.bufferData(n.ELEMENT_ARRAY_BUFFER,t.arrayBuffer,this.dynamicDraw?n.DYNAMIC_DRAW:n.STATIC_DRAW),this.dynamicDraw||t.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(e){const t=this.context.gl;this.context.unbindVAO(),this.bind(),t.bufferSubData(t.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const F={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class j{constructor(e,t,r,n){this.length=t.length,this.attributes=r,this.itemSize=t.bytesPerElement,this.dynamicDraw=n,this.context=e;const i=e.gl;this.buffer=i.createBuffer(),e.bindVertexBuffer.set(this.buffer),i.bufferData(i.ARRAY_BUFFER,t.arrayBuffer,this.dynamicDraw?i.DYNAMIC_DRAW:i.STATIC_DRAW),this.dynamicDraw||t.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(e){const t=this.context.gl;this.bind(),t.bufferSubData(t.ARRAY_BUFFER,0,e.arrayBuffer)}enableAttributes(e,t){for(let r=0;r<this.attributes.length;r++){const n=t.attributes[this.attributes[r].name];void 0!==n&&e.enableVertexAttribArray(n)}}setVertexAttribPointers(e,t,r){for(let n=0;n<this.attributes.length;n++){const i=this.attributes[n],o=t.attributes[i.name];void 0!==o&&e.vertexAttribPointer(o,i.components,e[F[i.type]],!1,this.itemSize,i.offset+this.itemSize*(r||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class V{constructor(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(e){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class W extends V{getDefault(){return e.Color.transparent}set(e){const t=this.current;(e.r!==t.r||e.g!==t.g||e.b!==t.b||e.a!==t.a||this.dirty)&&(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class K extends V{getDefault(){return 1}set(e){(e!==this.current||this.dirty)&&(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}}class G extends V{getDefault(){return 0}set(e){(e!==this.current||this.dirty)&&(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}}class H extends V{getDefault(){return[!0,!0,!0,!0]}set(e){const t=this.current;(e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||e[3]!==t[3]||this.dirty)&&(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class q extends V{getDefault(){return!0}set(e){(e!==this.current||this.dirty)&&(this.gl.depthMask(e),this.current=e,this.dirty=!1)}}class Y extends V{getDefault(){return 255}set(e){(e!==this.current||this.dirty)&&(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}}class X extends V{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(e){const t=this.current;(e.func!==t.func||e.ref!==t.ref||e.mask!==t.mask||this.dirty)&&(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}}class Q extends V{getDefault(){const e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}set(e){const t=this.current;(e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||this.dirty)&&(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}}class $ extends V{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;e?t.enable(t.STENCIL_TEST):t.disable(t.STENCIL_TEST),this.current=e,this.dirty=!1}}class J extends V{getDefault(){return[0,1]}set(e){const t=this.current;(e[0]!==t[0]||e[1]!==t[1]||this.dirty)&&(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}}class ee extends V{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;e?t.enable(t.DEPTH_TEST):t.disable(t.DEPTH_TEST),this.current=e,this.dirty=!1}}class te extends V{getDefault(){return this.gl.LESS}set(e){(e!==this.current||this.dirty)&&(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}}class re extends V{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;e?t.enable(t.BLEND):t.disable(t.BLEND),this.current=e,this.dirty=!1}}class ne extends V{getDefault(){const e=this.gl;return[e.ONE,e.ZERO]}set(e){const t=this.current;(e[0]!==t[0]||e[1]!==t[1]||this.dirty)&&(this.gl.blendFunc(e[0],e[1]),this.current=e,this.dirty=!1)}}class ie extends V{getDefault(){return e.Color.transparent}set(e){const t=this.current;(e.r!==t.r||e.g!==t.g||e.b!==t.b||e.a!==t.a||this.dirty)&&(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class oe extends V{getDefault(){return this.gl.FUNC_ADD}set(e){(e!==this.current||this.dirty)&&(this.gl.blendEquation(e),this.current=e,this.dirty=!1)}}class ae extends V{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;e?t.enable(t.CULL_FACE):t.disable(t.CULL_FACE),this.current=e,this.dirty=!1}}class se extends V{getDefault(){return this.gl.BACK}set(e){(e!==this.current||this.dirty)&&(this.gl.cullFace(e),this.current=e,this.dirty=!1)}}class ue extends V{getDefault(){return this.gl.CCW}set(e){(e!==this.current||this.dirty)&&(this.gl.frontFace(e),this.current=e,this.dirty=!1)}}class ce extends V{getDefault(){return null}set(e){(e!==this.current||this.dirty)&&(this.gl.useProgram(e),this.current=e,this.dirty=!1)}}class le extends V{getDefault(){return this.gl.TEXTURE0}set(e){(e!==this.current||this.dirty)&&(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}}class he extends V{getDefault(){const e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}set(e){const t=this.current;(e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||e[3]!==t[3]||this.dirty)&&(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class fe extends V{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.bindFramebuffer(t.FRAMEBUFFER,e),this.current=e,this.dirty=!1}}class de extends V{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.bindRenderbuffer(t.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class pe extends V{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.bindTexture(t.TEXTURE_2D,e),this.current=e,this.dirty=!1}}class me extends V{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.bindBuffer(t.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class ge extends V{getDefault(){return null}set(e){const t=this.gl;t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class ye extends V{constructor(e){super(e),this.vao=e.extVertexArrayObject}getDefault(){return null}set(e){this.vao&&(e!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(e),this.current=e,this.dirty=!1)}}class ve extends V{getDefault(){return 4}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.pixelStorei(t.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}}class _e extends V{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}}class be extends V{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const t=this.gl;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}}class xe extends V{constructor(e,t){super(e),this.context=e,this.parent=t}getDefault(){return null}}class we extends xe{setDirty(){this.dirty=!0}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const t=this.gl;t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}}class ke extends xe{attachment(){return this.gl.DEPTH_ATTACHMENT}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const t=this.gl;t.framebufferRenderbuffer(t.FRAMEBUFFER,this.attachment(),t.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class Ae extends ke{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class Ee{constructor(e,t,r,n){this.context=e,this.width=t,this.height=r;const i=this.framebuffer=e.gl.createFramebuffer();this.colorAttachment=new we(e,i),n&&(this.depthAttachment=new ke(e,i))}destroy(){const e=this.context.gl,t=this.colorAttachment.get();if(t&&e.deleteTexture(t),this.depthAttachment){const t=this.depthAttachment.get();t&&e.deleteRenderbuffer(t)}e.deleteFramebuffer(this.framebuffer)}}class Se{constructor(e,t=!1){if(this.gl=e,this.isWebGL2=t,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),t){const t=e;this.extVertexArrayObject={createVertexArrayOES:t.createVertexArray.bind(e),deleteVertexArrayOES:t.deleteVertexArray.bind(e),bindVertexArrayOES:t.bindVertexArray.bind(e)}}this.clearColor=new W(this),this.clearDepth=new K(this),this.clearStencil=new G(this),this.colorMask=new H(this),this.depthMask=new q(this),this.stencilMask=new Y(this),this.stencilFunc=new X(this),this.stencilOp=new Q(this),this.stencilTest=new $(this),this.depthRange=new J(this),this.depthTest=new ee(this),this.depthFunc=new te(this),this.blend=new re(this),this.blendFunc=new ne(this),this.blendColor=new ie(this),this.blendEquation=new oe(this),this.cullFace=new ae(this),this.cullFaceSide=new se(this),this.frontFace=new ue(this),this.program=new ce(this),this.activeTexture=new le(this),this.viewport=new he(this),this.bindFramebuffer=new fe(this),this.bindRenderbuffer=new de(this),this.bindTexture=new pe(this),this.bindVertexBuffer=new me(this),this.bindElementBuffer=new ge(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new ye(this),this.pixelStoreUnpack=new ve(this),this.pixelStoreUnpackPremultiplyAlpha=new _e(this),this.pixelStoreUnpackFlipY=new be(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=e.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=e.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=e.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),t||(this.extTextureHalfFloat=e.getExtension("OES_texture_half_float")),(t||this.extTextureHalfFloat&&e.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=e.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=t||e.getExtension("OES_standard_derivatives"),this.extTimerQuery=e.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,t){return new Z(this,e,t)}createVertexBuffer(e,t,r){return new j(this,e,t,r)}createRenderbuffer(e,t,r){const n=this.gl,i=n.createRenderbuffer();return this.bindRenderbuffer.set(i),n.renderbufferStorage(n.RENDERBUFFER,e,t,r),this.bindRenderbuffer.set(null),i}createFramebuffer(e,t,r){return new Ee(this,e,t,r)}clear({color:e,depth:t,stencil:r}){const n=this.gl;let i=0;e&&(i|=n.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set([!0,!0,!0,!0])),void 0!==t&&(i|=n.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(t),this.depthMask.set(!0)),void 0!==r&&(i|=n.STENCIL_BUFFER_BIT,this.clearStencil.set(r),this.stencilMask.set(255)),n.clear(i)}setCullFace(e){!1===e.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}setDepthMode(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)}setStencilMode(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)}setColorMode(r){t(r.blendFunction,e.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(r.blendFunction),this.blendColor.set(r.blendColor)),this.colorMask.set(r.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class Te extends e.Evented{constructor(t,r,n,i){if(super(),this.id=t,this.dispatcher=n,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,e.extend(this,e.pick(r,["url","scheme","tileSize","promoteId"])),this._options=e.extend({type:"vector"},r),this._collectResourceTiming=r.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(i),this._tileWorkers={},this._deduped=new e.DedupedRequest}load(t){this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"}));const r=Array.isArray(this.map._language)?this.map._language.join():this.map._language,n=this.map._worldview;this._tileJSONRequest=N(this._options,this.map._requestManager,r,n,((i,o)=>{this._tileJSONRequest=null,this._loaded=!0,i?(r&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${r}`),n&&2!==n.length&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${n}`),this.fire(new e.ErrorEvent(i))):o&&(e.extend(this,o),o.bounds&&(this.tileBounds=new U(o.bounds,this.minzoom,this.maxzoom)),e.postTurnstileEvent(o.tiles,this.map._requestManager._customAccessToken),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"}))),t&&t(i)}))}loaded(){return this._loaded}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}onAdd(e){this.map=e,this.load()}reload(){this.cancelTileJSONRequest(),this.load((()=>this.map.style._clearSource(this.id)))}setTiles(e){return this._options.tiles=e,this.reload(),this}setUrl(e){return this.url=e,this._options.url=e,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return e.extend({},this._options)}loadTile(t,r){const n=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme)),i={request:this.map._requestManager.transformRequest(n,e.ResourceType.Tile),data:void 0,uid:t.uid,tileID:t.tileID,tileZoom:t.tileZoom,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:e.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:t.isSymbolTile};if(i.request.collectResourceTiming=this._collectResourceTiming,t.actor&&"expired"!==t.state)"loading"===t.state?t.reloadCallback=r:t.request=t.actor.send("reloadTile",i,o.bind(this));else if(t.actor=this._tileWorkers[n]=this._tileWorkers[n]||this.dispatcher.getActor(),this.dispatcher.ready)t.request=t.actor.send("loadTile",i,o.bind(this),void 0,!0);else{const r=e.loadVectorTile.call({deduped:this._deduped},i,((e,r)=>{e||!r?o.call(this,e):(i.data={cacheControl:r.cacheControl,expires:r.expires,rawData:r.rawData.slice(0)},t.actor&&t.actor.send("loadTile",i,o.bind(this),void 0,!0))}),!0);t.request={cancel:r}}function o(n,i){return delete t.request,t.aborted?r(null):n&&404!==n.status?r(n):(i&&i.resourceTiming&&(t.resourceTiming=i.resourceTiming),this.map._refreshExpiredTiles&&i&&t.setExpiryData(i),t.loadVectorData(i,this.map.painter),e.cacheEntryPossiblyAdded(this.dispatcher),r(null),void(t.reloadCallback&&(this.loadTile(t,t.reloadCallback),t.reloadCallback=null)))}}abortTile(e){e.request&&(e.request.cancel(),delete e.request),e.actor&&e.actor.send("abortTile",{uid:e.uid,type:this.type,source:this.id})}unloadTile(e){e.unloadVectorData(),e.actor&&e.actor.send("removeTile",{uid:e.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Me extends e.Evented{constructor(t,r,n,i){super(),this.id=t,this.dispatcher=n,this.setEventedParent(i),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=e.extend({type:"raster"},r),e.extend(this,e.pick(r,["url","scheme","tileSize"]))}load(t){this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=N(this._options,this.map._requestManager,null,null,((r,n)=>{this._tileJSONRequest=null,this._loaded=!0,r?this.fire(new e.ErrorEvent(r)):n&&(e.extend(this,n),n.bounds&&(this.tileBounds=new U(n.bounds,this.minzoom,this.maxzoom)),e.postTurnstileEvent(n.tiles),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"}))),t&&t(r)}))}loaded(){return this._loaded}onAdd(e){this.map=e,this.load()}reload(){this.cancelTileJSONRequest(),this.load((()=>this.map.style._clearSource(this.id)))}setTiles(e){return this._options.tiles=e,this.reload(),this}setUrl(e){return this.url=e,this._options.url=e,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return e.extend({},this._options)}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(t,r){const n=e.exported.devicePixelRatio>=2,i=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme),n,this.tileSize);t.request=e.getImage(this.map._requestManager.transformRequest(i,e.ResourceType.Tile),((n,i,o,a)=>(delete t.request,t.aborted?(t.state="unloaded",r(null)):n?(t.state="errored",r(n)):i?(this.map._refreshExpiredTiles&&t.setExpiryData({cacheControl:o,expires:a}),t.setTexture(i,this.map.painter),t.state="loaded",e.cacheEntryPossiblyAdded(this.dispatcher),void r(null)):r(null))))}static loadTileData(e,t,r){e.setTexture(t,r)}static unloadTileData(e,t){e.texture&&t.saveTileTexture(e.texture)}abortTile(e,t){e.request&&(e.request.cancel(),delete e.request),t()}unloadTile(e,t){e.texture&&this.map.painter.saveTileTexture(e.texture),t()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}let Ie;function Pe(t,r,n,i,o,a,s,u){const c=[t,n,o,r,i,a,1,1,1],l=[s,u,1],h=e.adjoint([],c),[f,d,p]=e.transformMat3(l,l,e.transpose(h,h));return e.multiply$1(c,[f,0,0,0,d,0,0,0,p],c)}class Ce extends e.Evented{constructor(e,t,r,n){super(),this.id=e,this.dispatcher=r,this.coordinates=t.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(n),this.options=t,this._dirty=!1}load(t,r){this._loaded=r||!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=e.getImage(this.map._requestManager.transformRequest(this.url,e.ResourceType.Image),((r,n)=>{if(this._imageRequest=null,this._loaded=!0,r)this.fire(new e.ErrorEvent(r));else if(n){const{HTMLImageElement:r}=e.window;this.image=n instanceof r?e.exported.getImageData(n):n,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,t&&(this.coordinates=t),this._finishLoading()}}))}loaded(){return this._loaded}updateImage(e){return this.image&&e.url?(this._imageRequest&&e.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=e.url,this.load(e.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(t){this.coordinates=t,this._boundsArray=void 0;const r=t.map(e.MercatorCoordinate.fromLngLat);return this.tileID=function(t){let r=1/0,n=1/0,i=-1/0,o=-1/0;for(const e of t)r=Math.min(r,e.x),n=Math.min(n,e.y),i=Math.max(i,e.x),o=Math.max(o,e.y);const a=Math.max(i-r,o-n),s=Math.max(0,Math.floor(-Math.log(a)/Math.LN2)),u=Math.pow(2,s);return new e.CanonicalTileID(s,Math.floor((r+i)/2*u),Math.floor((n+o)/2*u))}(r),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(t){for(const e in this.tiles){const t=this.tiles[e];"loaded"!==t.state&&(t.state="loaded",t.texture=this.texture)}if(this._boundsArray)return;const r=e.tileTransform(this.tileID,this.map.transform.projection),[n,i,o,a]=this.coordinates.map((t=>{const n=r.projection.project(t[0],t[1]);return e.getTilePoint(r,n)._round()}));this.perspectiveTransform=function(t,r,n,i,o,a,s,u,c,l){const h=Pe(0,0,t,0,0,r,t,r),f=Pe(n,i,o,a,s,u,c,l);return e.multiply$1(f,e.adjoint(h,h),f),[f[6]/f[8]*t/e.EXTENT,f[7]/f[8]*r/e.EXTENT]}(this.width,this.height,n.x,n.y,i.x,i.y,a.x,a.y,o.x,o.y);const s=this._boundsArray=new e.StructArrayLayout4i8;s.emplaceBack(n.x,n.y,0,0),s.emplaceBack(i.x,i.y,e.EXTENT,0),s.emplaceBack(a.x,a.y,0,e.EXTENT),s.emplaceBack(o.x,o.y,e.EXTENT,e.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=t.createVertexBuffer(s,e.boundsAttributes.members),this.boundsSegments=e.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(0===Object.keys(this.tiles).length||!this.image)return;const t=this.map.painter.context,r=t.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new e.Texture(t,this.image,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(t)}loadTile(e,t){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={},t(null)):(e.state="errored",t(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const Be={vector:Te,raster:Me,"raster-dem":class extends Me{constructor(t,r,n,i){super(t,r,n,i),this.type="raster-dem",this.maxzoom=22,this._options=e.extend({type:"raster-dem"},r),this.encoding=r.encoding||"mapbox"}loadTile(t,r){const n=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function i(e,n){e&&(t.state="errored",r(e)),n&&(t.dem=n,t.dem.onDeserialize(),t.needsHillshadePrepare=!0,t.needsDEMTextureUpload=!0,t.state="loaded",r(null))}t.request=e.getImage(this.map._requestManager.transformRequest(n,e.ResourceType.Tile),function(n,o,a,s){if(delete t.request,t.aborted)t.state="unloaded",r(null);else if(n)t.state="errored",r(n);else if(o){this.map._refreshExpiredTiles&&t.setExpiryData({cacheControl:a,expires:s});const r=e.window.ImageBitmap&&o instanceof e.window.ImageBitmap&&(null==Ie&&(Ie=e.window.OffscreenCanvas&&new e.window.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof e.window.createImageBitmap),Ie),n=1-(o.width-e.prevPowerOfTwo(o.width))/2;n<1||t.neighboringTiles||(t.neighboringTiles=this._getNeighboringTiles(t.tileID));const u=r?o:e.exported.getImageData(o,n),c={uid:t.uid,coord:t.tileID,source:this.id,rawImageData:u,encoding:this.encoding,padding:n};t.actor&&"expired"!==t.state||(t.actor=this.dispatcher.getActor(),t.actor.send("loadDEMTile",c,i.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(t){const r=t.canonical,n=Math.pow(2,r.z),i=(r.x-1+n)%n,o=0===r.x?t.wrap-1:t.wrap,a=(r.x+1+n)%n,s=r.x+1===n?t.wrap+1:t.wrap,u={};return u[new e.OverscaledTileID(t.overscaledZ,o,r.z,i,r.y).key]={backfilled:!1},u[new e.OverscaledTileID(t.overscaledZ,s,r.z,a,r.y).key]={backfilled:!1},r.y>0&&(u[new e.OverscaledTileID(t.overscaledZ,o,r.z,i,r.y-1).key]={backfilled:!1},u[new e.OverscaledTileID(t.overscaledZ,t.wrap,r.z,r.x,r.y-1).key]={backfilled:!1},u[new e.OverscaledTileID(t.overscaledZ,s,r.z,a,r.y-1).key]={backfilled:!1}),r.y+1<n&&(u[new e.OverscaledTileID(t.overscaledZ,o,r.z,i,r.y+1).key]={backfilled:!1},u[new e.OverscaledTileID(t.overscaledZ,t.wrap,r.z,r.x,r.y+1).key]={backfilled:!1},u[new e.OverscaledTileID(t.overscaledZ,s,r.z,a,r.y+1).key]={backfilled:!1}),u}unloadTile(e){e.demTexture&&this.map.painter.saveTileTexture(e.demTexture),e.fbo&&(e.fbo.destroy(),delete e.fbo),e.dem&&delete e.dem,delete e.neighboringTiles,e.state="unloaded"}},geojson:class extends e.Evented{constructor(t,r,n,i){super(),this.id=t,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=n.getActor(),this.setEventedParent(i),this._data=r.data,this._options=e.extend({},r),this._collectResourceTiming=r.collectResourceTiming,void 0!==r.maxzoom&&(this.maxzoom=r.maxzoom),r.type&&(this.type=r.type),r.attribution&&(this.attribution=r.attribution),this.promoteId=r.promoteId;const o=e.EXTENT/this.tileSize;this.workerOptions=e.extend({source:this.id,cluster:r.cluster||!1,geojsonVtOptions:{buffer:(void 0!==r.buffer?r.buffer:128)*o,tolerance:(void 0!==r.tolerance?r.tolerance:.375)*o,extent:e.EXTENT,maxZoom:this.maxzoom,lineMetrics:r.lineMetrics||!1,generateId:r.generateId||!1},superclusterOptions:{maxZoom:void 0!==r.clusterMaxZoom?r.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,r.clusterMinPoints||2),extent:e.EXTENT,radius:(void 0!==r.clusterRadius?r.clusterRadius:50)*o,log:!1,generateId:r.generateId||!1},clusterProperties:r.clusterProperties,filter:r.filter},r.workerOptions)}onAdd(e){this.map=e,this.setData(this._data)}setData(e){return this._data=e,this._updateWorkerData(),this}getClusterExpansionZoom(e,t){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:e,source:this.id},t),this}getClusterChildren(e,t){return this.actor.send("geojson.getClusterChildren",{clusterId:e,source:this.id},t),this}getClusterLeaves(e,t,r,n){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:e,limit:t,offset:r},n),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new e.Event("dataloading",{dataType:"source"})),this._loaded=!1;const t=e.extend({},this.workerOptions),r=this._data;"string"==typeof r?(t.request=this.map._requestManager.transformRequest(e.exported.resolveURL(r),e.ResourceType.Source),t.request.collectResourceTiming=this._collectResourceTiming):t.data=JSON.stringify(r),this._pendingLoad=this.actor.send(`${this.type}.loadData`,t,((t,r)=>{if(this._loaded=!0,this._pendingLoad=null,t)this.fire(new e.ErrorEvent(t));else{const t={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&r&&r.resourceTiming&&r.resourceTiming[this.id]&&(t.resourceTiming=r.resourceTiming[this.id]),this.fire(new e.Event("data",t)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)}))}loaded(){return this._loaded}loadTile(t,r){const n=t.actor?"reloadTile":"loadTile";t.actor=this.actor,t.request=this.actor.send(n,{type:this.type,uid:t.uid,tileID:t.tileID,tileZoom:t.tileZoom,zoom:t.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:e.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},((e,i)=>(delete t.request,t.unloadVectorData(),t.aborted?r(null):e?r(e):(t.loadVectorData(i,this.map.painter,"reloadTile"===n),r(null)))),void 0,"loadTile"===n)}abortTile(e){e.request&&(e.request.cancel(),delete e.request),e.aborted=!0}unloadTile(e){e.unloadVectorData(),this.actor.send("removeTile",{uid:e.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return e.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends Ce{constructor(e,t,r,n){super(e,t,r,n),this.roundZoom=!0,this.type="video",this.options=t}load(){this._loaded=!1;const t=this.options;this.urls=[];for(const r of t.urls)this.urls.push(this.map._requestManager.transformRequest(r,e.ResourceType.Source).url);e.getVideo(this.urls,((t,r)=>{this._loaded=!0,t?this.fire(new e.ErrorEvent(t)):r&&(this.video=r,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading())}))}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(t){if(this.video){const r=this.video.seekable;t<r.start(0)||t>r.end(0)?this.fire(new e.ErrorEvent(new e.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${r.start(0)} and ${r.end(0)}-second mark.`))):this.video.currentTime=t}}getVideo(){return this.video}onAdd(e){this.map||(this.map=e,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const t=this.map.painter.context,r=t.gl;this.texture?this.video.paused||(this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),r.texSubImage2D(r.TEXTURE_2D,0,0,0,r.RGBA,r.UNSIGNED_BYTE,this.video)):(this.texture=new e.Texture(t,this.video,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(t)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:Ce,canvas:class extends Ce{constructor(t,r,n,i){super(t,r,n,i),r.coordinates?Array.isArray(r.coordinates)&&4===r.coordinates.length&&!r.coordinates.some((e=>!Array.isArray(e)||2!==e.length||e.some((e=>"number"!=typeof e))))||this.fire(new e.ErrorEvent(new e.ValidationError(`sources.${t}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new e.ErrorEvent(new e.ValidationError(`sources.${t}`,null,'missing required property "coordinates"'))),r.animate&&"boolean"!=typeof r.animate&&this.fire(new e.ErrorEvent(new e.ValidationError(`sources.${t}`,null,'optional "animate" property must be a boolean value'))),r.canvas?"string"==typeof r.canvas||r.canvas instanceof e.window.HTMLCanvasElement||this.fire(new e.ErrorEvent(new e.ValidationError(`sources.${t}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new e.ErrorEvent(new e.ValidationError(`sources.${t}`,null,'missing required property "canvas"'))),this.options=r,this.animate=void 0===r.animate||r.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof e.window.HTMLCanvasElement?this.options.canvas:e.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new e.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(e){this.map=e,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let t=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,t=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,t=!0),this._hasInvalidDimensions())return;if(0===Object.keys(this.tiles).length)return;const r=this.map.painter.context;this.texture?(t||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new e.Texture(r,this.canvas,r.gl.RGBA,{premultiply:!0}),this._prepareData(r)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const e of[this.canvas.width,this.canvas.height])if(isNaN(e)||e<=0)return!0;return!1}},custom:class extends e.Evented{constructor(t,r,n,i){super(),this.id=t,this.type="custom",this._dataType="raster",this._dispatcher=n,this._implementation=r,this.setEventedParent(i),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new e.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new e.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new U(this._implementation.bounds,this.minzoom,this.maxzoom)),r.update=this._update.bind(this),r.clearTiles=this._clearTiles.bind(this),r.coveringTiles=this._coveringTiles.bind(this),e.extend(this,e.pick(r,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return e.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new e.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(t){this._map=t,this._loaded=!1,this.fire(new e.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(t),this.load()}onRemove(e){this._implementation.onRemove&&this._implementation.onRemove(e)}hasTile(e){if(this._implementation.hasTile){const{x:t,y:r,z:n}=e.canonical;return this._implementation.hasTile({x:t,y:r,z:n})}return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(t,r){const{x:n,y:i,z:o}=t.tileID.canonical,a=new e.window.AbortController;t.request=Promise.resolve(this._implementation.loadTile({x:n,y:i,z:o},{signal:a.signal})).then(function(n){return delete t.request,t.aborted?(t.state="unloaded",r(null)):void 0===n?(t.state="errored",r(null)):null===n?(this.loadTileData(t,{width:this.tileSize,height:this.tileSize,data:null}),t.state="loaded",r(null)):function(t){return t instanceof e.window.ImageData||t instanceof e.window.HTMLCanvasElement||t instanceof e.window.ImageBitmap||t instanceof e.window.HTMLImageElement}(n)?(this.loadTileData(t,n),t.state="loaded",void r(null)):(t.state="errored",r(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}.bind(this)).catch((e=>{20!==e.code&&(t.state="errored",r(e))})),t.request.cancel=()=>a.abort()}loadTileData(e,t){Me.loadTileData(e,t,this._map.painter)}unloadTileData(e){Me.unloadTileData(e,this._map.painter)}unloadTile(e,t){if(this.unloadTileData(e),this._implementation.unloadTile){const{x:t,y:r,z:n}=e.tileID.canonical;this._implementation.unloadTile({x:t,y:r,z:n})}t()}abortTile(e,t){e.request&&e.request.cancel&&(e.request.cancel(),delete e.request),t()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map((e=>({x:e.canonical.x,y:e.canonical.y,z:e.canonical.z})))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new e.Event("data",{dataType:"source",sourceDataType:"content"}))}}},De=function(t,r,n,i){const o=new Be[r.type](t,r,n,i);if(o.id!==t)throw new Error(`Expected Source id to be ${t} instead of ${o.id}`);return e.bindAll(["load","abort","unload","serialize","prepare"],o),o};function Re(t,r){const n=e.identity([]);return e.scale(n,n,[.5*t.width,.5*-t.height,1]),e.translate(n,n,[1,-1,0]),e.multiply(n,n,t.calculateProjMatrix(r.toUnwrapped())),Float32Array.from(n)}function Le(e,t,r,n,i,o,a,s=!1){const u=e.tilesIn(n,a,s);u.sort(ze);const c=[];for(const h of u)c.push({wrappedTileID:h.tile.tileID.wrapped().key,queryResults:h.tile.queryRenderedFeatures(t,r,e._state,h,i,o,Re(e.transform,h.tile.tileID),s)});const l=function(e){const t={},r={};for(const n of e){const e=n.queryResults,i=n.wrappedTileID,o=r[i]=r[i]||{};for(const r in e){const n=e[r],i=o[r]=o[r]||{},a=t[r]=t[r]||[];for(const e of n)i[e.featureIndex]||(i[e.featureIndex]=!0,a.push(e))}}return t}(c);for(const h in l)l[h].forEach((t=>{const r=t.feature,n=r.layer;n&&"background"!==n.type&&"sky"!==n.type&&(r.source=n.source,n["source-layer"]&&(r.sourceLayer=n["source-layer"]),r.state=void 0!==r.id?e.getFeatureState(n["source-layer"],r.id):{})}));return l}function Oe(e,t){const r=e.getRenderableIds().map((t=>e.getTileByID(t))),n=[],i={};for(let o=0;o<r.length;o++){const e=r[o],a=e.tileID.canonical.key;i[a]||(i[a]=!0,e.querySourceFeatures(n,t))}return n}function ze(e,t){const r=e.tileID,n=t.tileID;return r.overscaledZ-n.overscaledZ||r.canonical.y-n.canonical.y||r.wrap-n.wrap||r.canonical.x-n.canonical.x}function Ne(){return null!=go.workerClass?new go.workerClass:new e.window.Worker(go.workerUrl)}const Ue="mapboxgl_preloaded_worker_pool";class Ze{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<Ze.workerCount;)this.workers.push(new Ne);return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],0===this.numActive()&&(this.workers.forEach((e=>{e.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[Ue]}numActive(){return Object.keys(this.active).length}}let Fe;function je(){return Fe||(Fe=new Ze),Fe}function Ve(t,r){const n={};for(const e in t)"ref"!==e&&(n[e]=t[e]);return e.refProperties.forEach((e=>{e in r&&(n[e]=r[e])})),n}function We(e){e=e.slice();const t=Object.create(null);for(let r=0;r<e.length;r++)t[e[r].id]=e[r];for(let r=0;r<e.length;r++)"ref"in e[r]&&(e[r]=Ve(e[r],t[e[r].ref]));return e}Ze.workerCount=2;const Ke={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function Ge(e,t,r){r.push({command:Ke.addSource,args:[e,t[e]]})}function He(e,t,r){t.push({command:Ke.removeSource,args:[e]}),r[e]=!0}function qe(e,t,r,n){He(e,r,n),Ge(e,t,r)}function Ye(e,r,n){let i;for(i in e[n])if(e[n].hasOwnProperty(i)&&"data"!==i&&!t(e[n][i],r[n][i]))return!1;for(i in r[n])if(r[n].hasOwnProperty(i)&&"data"!==i&&!t(e[n][i],r[n][i]))return!1;return!0}function Xe(e,r,n,i,o,a){let s;for(s in r=r||{},e=e||{})e.hasOwnProperty(s)&&(t(e[s],r[s])||n.push({command:a,args:[i,s,r[s],o]}));for(s in r)r.hasOwnProperty(s)&&!e.hasOwnProperty(s)&&(t(e[s],r[s])||n.push({command:a,args:[i,s,r[s],o]}))}function Qe(e){return e.id}function $e(e,t){return e[t.id]=t,e}class Je{constructor(e,t){this.reset(e,t)}reset(e,t){this.points=e||[],this._distances=[0];for(let r=1;r<this.points.length;r++)this._distances[r]=this._distances[r-1]+this.points[r].dist(this.points[r-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(t||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(t){if(1===this.points.length)return this.points[0];t=e.clamp(t,0,1);let r=1,n=this._distances[r];const i=t*this.paddedLength+this.padding;for(;n<i&&r<this._distances.length;)n=this._distances[++r];const o=r-1,a=this._distances[o],s=n-a,u=s>0?(i-a)/s:0;return this.points[o].mult(1-u).add(this.points[r].mult(u))}}class et{constructor(e,t,r){const n=this.boxCells=[],i=this.circleCells=[];this.xCellCount=Math.ceil(e/r),this.yCellCount=Math.ceil(t/r);for(let o=0;o<this.xCellCount*this.yCellCount;o++)n.push([]),i.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=t,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/t,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(e,t,r,n,i){this._forEachCell(t,r,n,i,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(t),this.bboxes.push(r),this.bboxes.push(n),this.bboxes.push(i)}insertCircle(e,t,r,n){this._forEachCell(t-n,r-n,t+n,r+n,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(t),this.circles.push(r),this.circles.push(n)}_insertBoxCell(e,t,r,n,i,o){this.boxCells[i].push(o)}_insertCircleCell(e,t,r,n,i,o){this.circleCells[i].push(o)}_query(e,t,r,n,i,o){if(r<0||e>this.width||n<0||t>this.height)return!i&&[];const a=[];if(e<=0&&t<=0&&this.width<=r&&this.height<=n){if(i)return!0;for(let e=0;e<this.boxKeys.length;e++)a.push({key:this.boxKeys[e],x1:this.bboxes[4*e],y1:this.bboxes[4*e+1],x2:this.bboxes[4*e+2],y2:this.bboxes[4*e+3]});for(let e=0;e<this.circleKeys.length;e++){const t=this.circles[3*e],r=this.circles[3*e+1],n=this.circles[3*e+2];a.push({key:this.circleKeys[e],x1:t-n,y1:r-n,x2:t+n,y2:r+n})}return o?a.filter(o):a}return this._forEachCell(e,t,r,n,this._queryCell,a,{hitTest:i,seenUids:{box:{},circle:{}}},o),i?a.length>0:a}_queryCircle(e,t,r,n,i){const o=e-r,a=e+r,s=t-r,u=t+r;if(a<0||o>this.width||u<0||s>this.height)return!n&&[];const c=[];return this._forEachCell(o,s,a,u,this._queryCellCircle,c,{hitTest:n,circle:{x:e,y:t,radius:r},seenUids:{box:{},circle:{}}},i),n?c.length>0:c}query(e,t,r,n,i){return this._query(e,t,r,n,!1,i)}hitTest(e,t,r,n,i){return this._query(e,t,r,n,!0,i)}hitTestCircle(e,t,r,n){return this._queryCircle(e,t,r,!0,n)}_queryCell(e,t,r,n,i,o,a,s){const u=a.seenUids,c=this.boxCells[i];if(null!==c){const i=this.bboxes;for(const l of c)if(!u.box[l]){u.box[l]=!0;const c=4*l;if(e<=i[c+2]&&t<=i[c+3]&&r>=i[c+0]&&n>=i[c+1]&&(!s||s(this.boxKeys[l]))){if(a.hitTest)return o.push(!0),!0;o.push({key:this.boxKeys[l],x1:i[c],y1:i[c+1],x2:i[c+2],y2:i[c+3]})}}}const l=this.circleCells[i];if(null!==l){const i=this.circles;for(const c of l)if(!u.circle[c]){u.circle[c]=!0;const l=3*c;if(this._circleAndRectCollide(i[l],i[l+1],i[l+2],e,t,r,n)&&(!s||s(this.circleKeys[c]))){if(a.hitTest)return o.push(!0),!0;{const e=i[l],t=i[l+1],r=i[l+2];o.push({key:this.circleKeys[c],x1:e-r,y1:t-r,x2:e+r,y2:t+r})}}}}}_queryCellCircle(e,t,r,n,i,o,a,s){const u=a.circle,c=a.seenUids,l=this.boxCells[i];if(null!==l){const e=this.bboxes;for(const t of l)if(!c.box[t]){c.box[t]=!0;const r=4*t;if(this._circleAndRectCollide(u.x,u.y,u.radius,e[r+0],e[r+1],e[r+2],e[r+3])&&(!s||s(this.boxKeys[t])))return o.push(!0),!0}}const h=this.circleCells[i];if(null!==h){const e=this.circles;for(const t of h)if(!c.circle[t]){c.circle[t]=!0;const r=3*t;if(this._circlesCollide(e[r],e[r+1],e[r+2],u.x,u.y,u.radius)&&(!s||s(this.circleKeys[t])))return o.push(!0),!0}}}_forEachCell(e,t,r,n,i,o,a,s){const u=this._convertToXCellCoord(e),c=this._convertToYCellCoord(t),l=this._convertToXCellCoord(r),h=this._convertToYCellCoord(n);for(let f=u;f<=l;f++)for(let u=c;u<=h;u++)if(i.call(this,e,t,r,n,this.xCellCount*u+f,o,a,s))return}_convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}_convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}_circlesCollide(e,t,r,n,i,o){const a=n-e,s=i-t,u=r+o;return u*u>a*a+s*s}_circleAndRectCollide(e,t,r,n,i,o,a){const s=(o-n)/2,u=Math.abs(e-(n+s));if(u>s+r)return!1;const c=(a-i)/2,l=Math.abs(t-(i+c));if(l>c+r)return!1;if(u<=s||l<=c)return!0;const h=u-s,f=l-c;return h*h+f*f<=r*r}}const tt=Math.tan(85*Math.PI/180);function rt(t,r,n,i,o,a,s){const u=e.create();if(n)if("globe"===a.name){const t=e.calculateGlobeLabelMatrix(o,r);e.multiply(u,u,t)}else{const t=v([],s);u[0]=t[0],u[1]=t[1],u[4]=t[2],u[5]=t[3],i||e.rotateZ(u,u,o.angle)}else e.multiply(u,o.labelPlaneMatrix,t);return u}function nt(e,t,r,n,i,o,a){const s=rt(e,t,r,n,i,o,a);return"globe"===o.name&&r||(s[2]=s[6]=s[10]=s[14]=0),s}function it(t,r,n,i,o,a,s){if(n){if("globe"===a.name){const u=rt(t,r,n,i,o,a,s);return e.invert(u,u),e.multiply(u,t,u),u}{const r=e.clone(t),n=e.identity([]);return n[0]=s[0],n[1]=s[1],n[4]=s[2],n[5]=s[3],e.multiply(r,r,n),i||e.rotateZ(r,r,-o.angle),r}}return o.glCoordMatrix}function ot(t,r,n,i){const o=[t,r,n,1];n?e.transformMat4$1(o,o,i):gt(o,o,i);const a=o[3];return o[0]/=a,o[1]/=a,o[2]/=a,o}function at(e,t){return Math.min(.5+e/t*.5,1.5)}function st(e,t){const r=e[0]/e[3],n=e[1]/e[3];return r>=-t[0]&&r<=t[0]&&n>=-t[1]&&n<=t[1]}function ut(t,r,n,i,o,a,s,u,c,l){const h=n.transform,f=i?t.textSizeData:t.iconSizeData,d=e.evaluateSizeForZoom(f,n.transform.zoom),p="globe"===h.projection.name,m=[256/n.width*2+1,256/n.height*2+1],g=i?t.text.dynamicLayoutVertexArray:t.icon.dynamicLayoutVertexArray;g.clear();let y=null;p&&(y=i?t.text.globeExtVertexArray:t.icon.globeExtVertexArray);const v=t.lineVertexArray,_=i?t.text.placedSymbolArray:t.icon.placedSymbolArray,b=n.transform.width/n.transform.height;let x,w=!1;for(let k=0;k<_.length;k++){const i=_.get(k),{numGlyphs:p,writingMode:A}=i;if(A!==e.WritingMode.vertical||w||x===e.WritingMode.horizontal||(w=!0),x=A,(i.hidden||A===e.WritingMode.vertical)&&!w){mt(p,g);continue}w=!1;const E=new e.pointGeometry(i.tileAnchorX,i.tileAnchorY);let{x:S,y:T,z:M}=h.projection.projectTilePoint(E.x,E.y,l.canonical);if(c){const[e,t,r]=c(E);S+=e,T+=t,M+=r}const I=[S,T,M,1];if(e.transformMat4$1(I,I,r),!st(I,m)){mt(p,g);continue}const P=at(n.transform.cameraToCenterDistance,I[3]),C=e.evaluateSizeForFeature(f,d,i),B=s?C/P:C*P,D=ot(S,T,M,o);if(D[3]<=0){mt(p,g);continue}let R={};const L=s?null:c,O=ht(i,B,!1,u,r,o,a,t.glyphOffsetArray,v,g,y,D,E,R,b,L,h.projection,l,s);w=O.useVertical,L&&O.needsFlipping&&(R={}),(O.notEnoughRoom||w||O.needsFlipping&&ht(i,B,!0,u,r,o,a,t.glyphOffsetArray,v,g,y,D,E,R,b,L,h.projection,l,s).notEnoughRoom)&&mt(p,g)}i?(t.text.dynamicLayoutVertexBuffer.updateData(g),y&&t.text.globeExtVertexBuffer.updateData(y)):(t.icon.dynamicLayoutVertexBuffer.updateData(g),y&&t.icon.globeExtVertexBuffer.updateData(y))}function ct(e,t,r,n,i,o,a,s,u,c,l,h,f,d,p,m){const{lineStartIndex:g,glyphStartIndex:y,segment:v}=s,_=y+s.numGlyphs,b=g+s.lineLength,x=t.getoffsetX(y),w=t.getoffsetX(_-1),k=pt(e*x,r,n,i,o,a,v,g,b,u,c,l,h,f,!0,d,p,m);if(!k)return null;const A=pt(e*w,r,n,i,o,a,v,g,b,u,c,l,h,f,!0,d,p,m);return A?{first:k,last:A}:null}function lt(t,r,n,i){return t===e.WritingMode.horizontal&&Math.abs(i)>Math.abs(n)?{useVertical:!0}:t===e.WritingMode.vertical?i>0?{needsFlipping:!0}:null:0!==r&&function(e,t){return 0===e||Math.abs(t/e)>tt}(n,i)?1===r?{needsFlipping:!0}:null:n<0?{needsFlipping:!0}:null}function ht(t,r,n,i,o,a,s,u,c,l,h,f,d,p,m,g,y,v,_){const b=r/24,x=t.lineOffsetX*b,w=t.lineOffsetY*b,{lineStartIndex:k,glyphStartIndex:A,numGlyphs:E,segment:S,writingMode:T,flipState:M}=t,I=k+t.lineLength,P=t=>{if(h){const[r,n,i]=t.up,o=l.length;e.updateGlobeVertexNormal(h,o+0,r,n,i),e.updateGlobeVertexNormal(h,o+1,r,n,i),e.updateGlobeVertexNormal(h,o+2,r,n,i),e.updateGlobeVertexNormal(h,o+3,r,n,i)}const[r,n,i]=t.point;e.addDynamicAttributes(l,r,n,i,t.angle)};if(E>1){const e=ct(b,u,x,w,n,f,d,t,c,a,p,g,!1,y,v,_);if(!e)return{notEnoughRoom:!0};if(i&&!n){let[r,n,i]=e.first.point,[o,a,u]=e.last.point;[r,n]=ot(r,n,i,s),[o,a]=ot(o,a,u,s);const c=lt(T,M,(o-r)*m,a-n);if(t.flipState=c&&c.needsFlipping?1:2,c)return c}P(e.first);for(let t=A+1;t<A+E-1;t++){const e=pt(b*u.getoffsetX(t),x,w,n,f,d,S,k,I,c,a,p,g,!1,!1,y,v,_);if(!e)return l.length-=4*(t-A),{notEnoughRoom:!0};P(e)}P(e.last)}else{if(i&&!n){const r=ot(d.x,d.y,0,o),n=k+S+1,i=new e.pointGeometry(c.getx(n),c.gety(n)),a=ot(i.x,i.y,0,o),s=a[3]>0?a:dt(d,i,r,1,o,void 0,y,v.canonical),u=lt(T,M,(s[0]-r[0])*m,s[1]-r[1]);if(t.flipState=u&&u.needsFlipping?1:2,u)return u}const r=pt(b*u.getoffsetX(A),x,w,n,f,d,S,k,I,c,a,p,g,!1,!1,y,v,_);if(!r)return{notEnoughRoom:!0};P(r)}return{}}function ft(e,t,r,n,i){const{x:o,y:a,z:s}=n.projectTilePoint(e.x,e.y,t);if(!i)return ot(o,a,s,r);const[u,c,l]=i(e);return ot(o+u,a+c,s+l,r)}function dt(t,r,n,i,o,a,s,u){const c=ft(t.sub(r)._unit()._add(t),u,o,s,a);return e.sub(c,n,c),e.normalize(c,c),e.scaleAndAdd(c,n,c,i)}function pt(t,r,n,i,o,a,s,u,c,l,h,f,d,p,m,g,y,v){const _=i?t-r:t+r;let b=_>0?1:-1,x=0;i&&(b*=-1,x=Math.PI),b<0&&(x+=Math.PI);let w=u+s+(b>0?0:1)|0,k=o,A=o,E=0,S=0;const T=Math.abs(_),M=[],I=[];let P=a,C=P;const B=()=>dt(C,P,A,T-E+1,h,d,g,y.canonical);for(;E+S<=T;){if(w+=b,w<u||w>=c)return null;if(A=k,C=P,M.push(A),p&&I.push(C),P=new e.pointGeometry(l.getx(w),l.gety(w)),k=f[w],!k){const e=ft(P,y.canonical,h,g,d);k=e[3]>0?f[w]=e:B()}E+=S,S=e.distance(A,k)}m&&d&&(f[w]&&(k=B(),S=e.distance(A,k)),f[w]=k);const D=(T-E)/S,R=P.sub(C)._mult(D)._add(C),L=e.sub([],k,A),O=e.scaleAndAdd([],A,L,D);let z=[0,0,1],N=L[0],U=L[1];if(v&&(z=g.upVector(y.canonical,R.x,R.y),0!==z[0]||0!==z[1]||1!==z[2])){const t=[z[2],0,-z[0]],r=e.cross([],z,t);e.normalize(t,t),e.normalize(r,r),N=e.dot(L,t),U=e.dot(L,r)}if(n){const t=e.cross([],z,L);e.normalize(t,t),e.scaleAndAdd(O,O,t,n*b)}const Z=x+Math.atan2(U,N);return M.push(O),p&&I.push(R),{point:O,angle:Z,path:M,tilePath:I,up:z}}function mt(e,t){const r=t.length,n=r+4*e;t.resize(n),t.float32.fill(-1/0,4*r,4*n)}function gt(e,t,r){const n=t[0],i=t[1];return e[0]=r[0]*n+r[4]*i+r[12],e[1]=r[1]*n+r[5]*i+r[13],e[3]=r[3]*n+r[7]*i+r[15],e}const yt=100;class vt{constructor(e,t,r=new et(e.width+200,e.height+200,25),n=new et(e.width+200,e.height+200,25)){this.transform=e,this.grid=r,this.ignoredGrid=n,this.pitchfactor=Math.cos(e._pitch)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+yt,this.screenBottomBoundary=e.height+yt,this.gridRightBoundary=e.width+200,this.gridBottomBoundary=e.height+200,this.fogState=t}placeCollisionBox(e,t,r,n,i,o,a,s){let u=r.projectedAnchorX,c=r.projectedAnchorY,l=r.projectedAnchorZ;const h=r.elevation,f=r.tileID,d=e.getProjection();if(h&&f){const[e,t,n]=d.upVector(f.canonical,r.tileAnchorX,r.tileAnchorY),i=d.upVectorScale(f.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;u+=e*h*i,c+=t*h*i,l+=n*h*i}const p=this.projectAndGetPerspectiveRatio(a,u,c,l,r.tileID,"globe"===d.name||!!h||this.transform.pitch>0,d),m=o*p.perspectiveRatio,g=(r.x1*t+n.x-r.padding)*m+p.point.x,y=(r.y1*t+n.y-r.padding)*m+p.point.y,v=(r.x2*t+n.x+r.padding)*m+p.point.x,_=(r.y2*t+n.y+r.padding)*m+p.point.y,b=p.perspectiveRatio<=.55||p.occluded;return!this.isInsideGrid(g,y,v,_)||!i&&this.grid.hitTest(g,y,v,_,s)||b?{box:[],offscreen:!1,occluded:p.occluded}:{box:[g,y,v,_],offscreen:this.isOffscreen(g,y,v,_),occluded:!1}}placeCollisionCircles(t,r,n,i,o,a,s,u,c,l,h,f,d,p,m){const g=[],y=this.transform.elevation,v=t.getProjection(),_=y?y.getAtTileOffsetFunc(m,this.transform.center.lat,this.transform.worldSize,v):null,b=new e.pointGeometry(n.tileAnchorX,n.tileAnchorY);let{x:x,y:w,z:k}=v.projectTilePoint(b.x,b.y,m.canonical);if(_){const[e,t,r]=_(b);x+=e,w+=t,k+=r}const A="globe"===v.name,E=this.projectAndGetPerspectiveRatio(s,x,w,k,m,A||!!y||this.transform.pitch>0,v),{perspectiveRatio:S}=E,T=(h?a/S:a*S)/e.ONE_EM,M=ot(x,w,k,u),I=E.signedDistanceFromCamera>0?ct(T,o,n.lineOffsetX*T,n.lineOffsetY*T,!1,M,b,n,i,u,{},y&&!h?_:null,h&&!!y,v,m,h):null;let P=!1,C=!1,B=!0;if(I&&!E.occluded){const t=.5*d*S+p,n=new e.pointGeometry(-100,-100),i=new e.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),o=new Je,{first:a,last:s}=I,u=a.path.length;let h=[];for(let e=u-1;e>=1;e--)h.push(a.path[e]);for(let e=1;e<s.path.length;e++)h.push(s.path[e]);const m=2.5*t;c&&(h=h.map((([e,t,r],n)=>(_&&!A&&(r=_(n<u-1?a.tilePath[u-1-n]:s.tilePath[n-u+2])[2]),ot(e,t,r,c)))),h.some((e=>e[3]<=0))&&(h=[]));let y=[];if(h.length>0){let t=1/0,r=-1/0,o=1/0,a=-1/0;for(const e of h)t=Math.min(t,e[0]),o=Math.min(o,e[1]),r=Math.max(r,e[0]),a=Math.max(a,e[1]);r>=n.x&&t<=i.x&&a>=n.y&&o<=i.y&&(y=[h.map((t=>new e.pointGeometry(t[0],t[1])))],(t<n.x||r>i.x||o<n.y||a>i.y)&&(y=e.clipLine(y,n.x,n.y,i.x,i.y)))}for(const e of y){o.reset(e,.25*t);let n=0;n=o.length<=.5*t?1:Math.ceil(o.paddedLength/m)+1;for(let e=0;e<n;e++){const i=e/Math.max(n-1,1),a=o.lerp(i),s=a.x+yt,u=a.y+yt;g.push(s,u,t,0);const c=s-t,h=u-t,d=s+t,p=u+t;if(B=B&&this.isOffscreen(c,h,d,p),C=C||this.isInsideGrid(c,h,d,p),!r&&this.grid.hitTestCircle(s,u,t,f)&&(P=!0,!l))return{circles:[],offscreen:!1,collisionDetected:P,occluded:!1}}}}return{circles:!l&&P||!C?[]:g,offscreen:B,collisionDetected:P,occluded:E.occluded}}queryRenderedSymbols(t){if(0===t.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const r=[];let n=1/0,i=1/0,o=-1/0,a=-1/0;for(const l of t){const t=new e.pointGeometry(l.x+yt,l.y+yt);n=Math.min(n,t.x),i=Math.min(i,t.y),o=Math.max(o,t.x),a=Math.max(a,t.y),r.push(t)}const s=this.grid.query(n,i,o,a).concat(this.ignoredGrid.query(n,i,o,a)),u={},c={};for(const l of s){const t=l.key;if(void 0===u[t.bucketInstanceId]&&(u[t.bucketInstanceId]={}),u[t.bucketInstanceId][t.featureIndex])continue;const n=[new e.pointGeometry(l.x1,l.y1),new e.pointGeometry(l.x2,l.y1),new e.pointGeometry(l.x2,l.y2),new e.pointGeometry(l.x1,l.y2)];e.polygonIntersectsPolygon(r,n)&&(u[t.bucketInstanceId][t.featureIndex]=!0,void 0===c[t.bucketInstanceId]&&(c[t.bucketInstanceId]=[]),c[t.bucketInstanceId].push(t.featureIndex))}return c}insertCollisionBox(e,t,r,n,i){(t?this.ignoredGrid:this.grid).insert({bucketInstanceId:r,featureIndex:n,collisionGroupID:i},e[0],e[1],e[2],e[3])}insertCollisionCircles(e,t,r,n,i){const o=t?this.ignoredGrid:this.grid,a={bucketInstanceId:r,featureIndex:n,collisionGroupID:i};for(let s=0;s<e.length;s+=4)o.insertCircle(a,e[s],e[s+1],e[s+2])}projectAndGetPerspectiveRatio(t,r,n,i,o,a,s){const u=[r,n,i,1];let c=!1;if(i||this.transform.pitch>0){e.transformMat4$1(u,u,t);const a="globe"===s.name;if(this.fogState&&o&&!a){const t=function(t,r,n,i,o,a){const s=a.calculateFogTileMatrix(o),u=[r,n,i];return e.transformMat4(u,u,s),T(t,u,a.pitch,a._fov)}(this.fogState,r,n,i,o.toUnwrapped(),this.transform);c=t>.9}}else gt(u,u,t);const l=u[3];return{point:new e.pointGeometry((u[0]/l+1)/2*this.transform.width+yt,(-u[1]/l+1)/2*this.transform.height+yt),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(s)/l*.5,1.5),signedDistanceFromCamera:l,occluded:a&&u[2]>l||c}}isOffscreen(e,t,r,n){return r<yt||e>=this.screenRightBoundary||n<yt||t>this.screenBottomBoundary}isInsideGrid(e,t,r,n){return r>=0&&e<this.gridRightBoundary&&n>=0&&t<this.gridBottomBoundary}getViewportMatrix(){const t=e.identity([]);return e.translate(t,t,[-100,-100,0]),t}}function _t(t,r,n){const i=r.createTileMatrix(t,t.worldSize,n.toUnwrapped());return e.multiply(new Float32Array(16),t.projMatrix,i)}function bt(e,t,r){if(t.projection.name===r.projection.name)return e.projMatrix;const n=r.clone();return n.setProjection(t.projection),_t(n,t.getProjection(),e)}function xt(e,t,r){return t.name===r.projection.name?e.projMatrix:_t(r,t,e)}class wt{constructor(e,t,r,n){this.opacity=e?Math.max(0,Math.min(1,e.opacity+(e.placed?t:-t))):n&&r?1:0,this.placed=r}isHidden(){return 0===this.opacity&&!this.placed}}class kt{constructor(e,t,r,n,i,o=!1){this.text=new wt(e?e.text:null,t,r,i),this.icon=new wt(e?e.icon:null,t,n,i),this.clipped=o}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class At{constructor(e,t,r,n=!1){this.text=e,this.icon=t,this.skipFade=r,this.clipped=n}}class Et{constructor(){this.invProjMatrix=e.create(),this.viewportMatrix=e.create(),this.circles=[]}}class St{constructor(e,t,r,n,i){this.bucketInstanceId=e,this.featureIndex=t,this.sourceLayerIndex=r,this.bucketIndex=n,this.tileID=i}}class Tt{constructor(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}get(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){const t=++this.maxGroupID;this.collisionGroups[e]={ID:t,predicate:e=>e.collisionGroupID===t}}return this.collisionGroups[e]}}function Mt(t,r,n,i,o){const{horizontalAlign:a,verticalAlign:s}=e.getAnchorAlignment(t),u=-(a-.5)*r,c=-(s-.5)*n,l=e.evaluateVariableOffset(t,i);return new e.pointGeometry(u+l[0]*o,c+l[1]*o)}function It(t,r,n,i,o){const a=new e.pointGeometry(t,r);return n&&a._rotate(i?o:-o),a}class Pt{constructor(e,t,r,n,i){this.transform=e.clone(),this.projection=e.projection.name,this.collisionIndex=new vt(this.transform,i),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=t,this.retainedQueryData={},this.collisionGroups=new Tt(r),this.collisionCircleArrays={},this.prevPlacement=n,n&&(n.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(t,r,n,i){const o=n.getBucket(r),a=n.latestFeatureIndex;if(!o||!a||r.id!==o.layerIds[0])return;const s=o.layers[0].layout,u=n.collisionBoxArray,c=Math.pow(2,this.transform.zoom-n.tileID.overscaledZ),l=n.tileSize/e.EXTENT,h=n.tileID.toUnwrapped();this.transform.setProjection(o.projection);const f=(d=n.tileID,p=o.getProjection(),m=this.transform,p.name===this.projection?m.calculateProjMatrix(d.toUnwrapped()):_t(m,p,d));var d,p,m;const g="map"===s.get("text-pitch-alignment"),y="map"===s.get("text-rotation-alignment");r.compileFilter();const v=r.dynamicFilter(),_=r.dynamicFilterNeedsFeature(),b=this.transform.calculatePixelsToTileUnitsMatrix(n),x=nt(f,n.tileID.canonical,g,y,this.transform,o.getProjection(),b);let w=null;if(g){const t=it(f,n.tileID.canonical,g,y,this.transform,o.getProjection(),b);w=e.multiply([],this.transform.labelPlaneMatrix,t)}let k=null;v&&n.latestFeatureIndex&&(k={unwrappedTileID:h,dynamicFilter:v,dynamicFilterNeedsFeature:_,featureIndex:n.latestFeatureIndex}),this.retainedQueryData[o.bucketInstanceId]=new St(o.bucketInstanceId,a,o.sourceLayerIndex,o.index,n.tileID);const A={bucket:o,layout:s,posMatrix:f,textLabelPlaneMatrix:x,labelToScreenMatrix:w,clippingData:k,scale:c,textPixelRatio:l,holdingForFade:n.holdingForFade(),collisionBoxArray:u,partiallyEvaluatedTextSize:e.evaluateSizeForZoom(o.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:e.evaluateSizeForZoom(o.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(o.sourceID)};if(i)for(const e of o.sortKeyRanges){const{sortKey:r,symbolInstanceStart:n,symbolInstanceEnd:i}=e;t.push({sortKey:r,symbolInstanceStart:n,symbolInstanceEnd:i,parameters:A})}else t.push({symbolInstanceStart:0,symbolInstanceEnd:o.symbolInstances.length,parameters:A})}attemptAnchorPlacement(e,t,r,n,i,o,a,s,u,c,l,h,f,d,p,m,g,y){const{textOffset0:v,textOffset1:_,crossTileID:b}=h,x=[v,_],w=Mt(e,r,n,x,i),k=this.collisionIndex.placeCollisionBox(d,i,t,It(w.x,w.y,o,a,this.transform.angle),l,s,u,c.predicate);if(m){const e=d.getSymbolInstanceIconSize(y,this.transform.zoom,h.placedIconSymbolIndex);if(0===this.collisionIndex.placeCollisionBox(d,e,m,It(w.x,w.y,o,a,this.transform.angle),l,s,u,c.predicate).box.length)return}if(k.box.length>0){let t;return this.prevPlacement&&this.prevPlacement.variableOffsets[b]&&this.prevPlacement.placements[b]&&this.prevPlacement.placements[b].text&&(t=this.prevPlacement.variableOffsets[b].anchor),this.variableOffsets[b]={textOffset:x,width:r,height:n,anchor:e,textScale:i,prevAnchor:t},this.markUsedJustification(d,e,h,p),d.allowVerticalPlacement&&(this.markUsedOrientation(d,p,h),this.placedOrientations[b]=p),{shift:w,placedGlyphBoxes:k}}}placeLayerBucketPart(t,r,n,i){const{bucket:o,layout:a,posMatrix:s,textLabelPlaneMatrix:u,labelToScreenMatrix:c,clippingData:l,textPixelRatio:h,holdingForFade:f,collisionBoxArray:d,partiallyEvaluatedTextSize:p,partiallyEvaluatedIconSize:m,collisionGroup:g}=t.parameters,y=a.get("text-optional"),v=a.get("icon-optional"),_=a.get("text-allow-overlap"),b=a.get("icon-allow-overlap"),x="map"===a.get("text-rotation-alignment"),w="map"===a.get("text-pitch-alignment"),k="none"!==a.get("icon-text-fit"),A="viewport-y"===a.get("symbol-z-order");this.transform.setProjection(o.projection);let E=_&&(b||!o.hasIconData()||v),S=b&&(_||!o.hasTextData()||y);!o.collisionArrays&&d&&o.deserializeCollisionBoxes(d),n&&i&&o.updateCollisionDebugBuffers(this.transform.zoom,d);const T=(t,i,d)=>{const{crossTileID:A,numVerticalGlyphVertices:T}=t;if(l){const n={zoom:this.transform.zoom,pitch:this.transform.pitch};let i=null;if(l.dynamicFilterNeedsFeature){const e=this.retainedQueryData[o.bucketInstanceId];i=l.featureIndex.loadFeature({featureIndex:t.featureIndex,bucketIndex:e.bucketIndex,sourceLayerIndex:e.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,l.dynamicFilter)(n,i,this.retainedQueryData[o.bucketInstanceId].tileID.canonical,new e.pointGeometry(t.tileAnchorX,t.tileAnchorY),this.transform.calculateDistanceTileData(l.unwrappedTileID)))return this.placements[A]=new At(!1,!1,!1,!0),void(r[A]=!0)}if(r[A])return;if(f)return void(this.placements[A]=new At(!1,!1,!1));let M=!1,I=!1,P=!0,C=!1,B=!1,D=null,R={box:null,offscreen:null,occluded:null},L={box:null,offscreen:null,occluded:null},O=null,z=null,N=null,U=0,Z=0,F=0;d.textFeatureIndex?U=d.textFeatureIndex:t.useRuntimeCollisionCircles&&(U=t.featureIndex),d.verticalTextFeatureIndex&&(Z=d.verticalTextFeatureIndex);const j=e=>{e.tileID=this.retainedQueryData[o.bucketInstanceId].tileID;const t=this.transform.elevation;(t||e.elevation)&&(e.elevation=t?t.getAtTileOffset(e.tileID,e.tileAnchorX,e.tileAnchorY):0)},V=d.textBox;if(V){j(V);const r=r=>{let n=e.WritingMode.horizontal;if(o.allowVerticalPlacement&&!r&&this.prevPlacement){const e=this.prevPlacement.placedOrientations[A];e&&(this.placedOrientations[A]=e,n=e,this.markUsedOrientation(o,n,t))}return n},n=(t,r)=>{if(o.allowVerticalPlacement&&T>0&&d.verticalTextBox){for(const n of o.writingModes)if(n===e.WritingMode.vertical?(R=r(),L=R):R=t(),R&&R.box&&R.box.length)break}else R=t()};if(a.get("text-variable-anchor")){let u=a.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[A]){const e=this.prevPlacement.variableOffsets[A];u.indexOf(e.anchor)>0&&(u=u.filter((t=>t!==e.anchor)),u.unshift(e.anchor))}const c=(e,r,n)=>{const a=o.getSymbolInstanceTextSize(p,t,this.transform.zoom,i),c=(e.x2-e.x1)*a+2*e.padding,l=(e.y2-e.y1)*a+2*e.padding,f=k&&!b?r:null;f&&j(f);let d={box:[],offscreen:!1,occluded:!1};const y=_?2*u.length:u.length;for(let v=0;v<y;++v){const r=this.attemptAnchorPlacement(u[v%u.length],e,c,l,a,x,w,h,s,g,v>=u.length,t,i,o,n,f,p,m);if(r&&(d=r.placedGlyphBoxes,d&&d.box&&d.box.length)){M=!0,D=r.shift;break}}return d};n((()=>c(V,d.iconBox,e.WritingMode.horizontal)),(()=>{const t=d.verticalTextBox;return t&&j(t),o.allowVerticalPlacement&&!(R&&R.box&&R.box.length)&&T>0&&t?c(t,d.verticalIconBox,e.WritingMode.vertical):{box:null,offscreen:null,occluded:null}})),R&&(M=R.box,P=R.offscreen,C=R.occluded);const l=r(R&&R.box);if(!M&&this.prevPlacement){const e=this.prevPlacement.variableOffsets[A];e&&(this.variableOffsets[A]=e,this.markUsedJustification(o,e.anchor,t,l))}}else{const a=(r,n)=>{const a=o.getSymbolInstanceTextSize(p,t,this.transform.zoom,i),u=this.collisionIndex.placeCollisionBox(o,a,r,new e.pointGeometry(0,0),_,h,s,g.predicate);return u&&u.box&&u.box.length&&(this.markUsedOrientation(o,n,t),this.placedOrientations[A]=n),u};n((()=>a(V,e.WritingMode.horizontal)),(()=>{const t=d.verticalTextBox;return o.allowVerticalPlacement&&T>0&&t?(j(t),a(t,e.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}})),r(R&&R.box&&R.box.length)}}if(O=R,M=O&&O.box&&O.box.length>0,P=O&&O.offscreen,C=O&&O.occluded,t.useRuntimeCollisionCircles){const r=o.text.placedSymbolArray.get(t.centerJustifiedTextSymbolIndex>=0?t.centerJustifiedTextSymbolIndex:t.verticalPlacedTextSymbolIndex),i=e.evaluateSizeForFeature(o.textSizeData,p,r),l=a.get("text-padding");z=this.collisionIndex.placeCollisionCircles(o,_,r,o.lineVertexArray,o.glyphOffsetArray,i,s,u,c,n,w,g.predicate,t.collisionCircleDiameter*i/e.ONE_EM,l,this.retainedQueryData[o.bucketInstanceId].tileID),M=_||z.circles.length>0&&!z.collisionDetected,P=P&&z.offscreen,C=z.occluded}if(d.iconFeatureIndex&&(F=d.iconFeatureIndex),d.iconBox){const r=r=>{j(r);const n=k&&D?It(D.x,D.y,x,w,this.transform.angle):new e.pointGeometry(0,0),i=o.getSymbolInstanceIconSize(m,this.transform.zoom,t.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(o,i,r,n,b,h,s,g.predicate)};L&&L.box&&L.box.length&&d.verticalIconBox?(N=r(d.verticalIconBox),I=N.box.length>0):(N=r(d.iconBox),I=N.box.length>0),P=P&&N.offscreen,B=N.occluded}const W=y||0===t.numHorizontalGlyphVertices&&0===T,K=v||0===t.numIconVertices;if(W||K?K?W||(I=I&&M):M=I&&M:I=M=I&&M,M&&O&&O.box&&this.collisionIndex.insertCollisionBox(O.box,a.get("text-ignore-placement"),o.bucketInstanceId,L&&L.box&&Z?Z:U,g.ID),I&&N&&this.collisionIndex.insertCollisionBox(N.box,a.get("icon-ignore-placement"),o.bucketInstanceId,F,g.ID),z&&(M&&this.collisionIndex.insertCollisionCircles(z.circles,a.get("text-ignore-placement"),o.bucketInstanceId,U,g.ID),n)){const e=o.bucketInstanceId;let t=this.collisionCircleArrays[e];void 0===t&&(t=this.collisionCircleArrays[e]=new Et);for(let r=0;r<z.circles.length;r+=4)t.circles.push(z.circles[r+0]),t.circles.push(z.circles[r+1]),t.circles.push(z.circles[r+2]),t.circles.push(z.collisionDetected?1:0)}const G="globe"!==o.projection.name;E=E&&(G||!C),S=S&&(G||!B),this.placements[A]=new At(M||E,I||S,P||o.justReloaded),r[A]=!0};if(A){const e=o.getSortedSymbolIndexes(this.transform.angle);for(let t=e.length-1;t>=0;--t){const r=e[t];T(o.symbolInstances.get(r),r,o.collisionArrays[r])}}else for(let e=t.symbolInstanceStart;e<t.symbolInstanceEnd;e++)T(o.symbolInstances.get(e),e,o.collisionArrays[e]);if(n&&o.bucketInstanceId in this.collisionCircleArrays){const t=this.collisionCircleArrays[o.bucketInstanceId];e.invert(t.invProjMatrix,s),t.viewportMatrix=this.collisionIndex.getViewportMatrix()}o.justReloaded=!1}markUsedJustification(t,r,n,i){const{leftJustifiedTextSymbolIndex:o,centerJustifiedTextSymbolIndex:a,rightJustifiedTextSymbolIndex:s,verticalPlacedTextSymbolIndex:u,crossTileID:c}=n,l=e.getAnchorJustification(r),h=i===e.WritingMode.vertical?u:"left"===l?o:"center"===l?a:"right"===l?s:-1;o>=0&&(t.text.placedSymbolArray.get(o).crossTileID=h>=0&&o!==h?0:c),a>=0&&(t.text.placedSymbolArray.get(a).crossTileID=h>=0&&a!==h?0:c),s>=0&&(t.text.placedSymbolArray.get(s).crossTileID=h>=0&&s!==h?0:c),u>=0&&(t.text.placedSymbolArray.get(u).crossTileID=h>=0&&u!==h?0:c)}markUsedOrientation(t,r,n){const i=r===e.WritingMode.horizontal||r===e.WritingMode.horizontalOnly?r:0,o=r===e.WritingMode.vertical?r:0,{leftJustifiedTextSymbolIndex:a,centerJustifiedTextSymbolIndex:s,rightJustifiedTextSymbolIndex:u,verticalPlacedTextSymbolIndex:c}=n,l=t.text.placedSymbolArray;a>=0&&(l.get(a).placedOrientation=i),s>=0&&(l.get(s).placedOrientation=i),u>=0&&(l.get(u).placedOrientation=i),c>=0&&(l.get(c).placedOrientation=o)}commit(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;const t=this.prevPlacement;let r=!1;this.prevZoomAdjustment=t?t.zoomAdjustment(this.transform.zoom):0;const n=t?t.symbolFadeChange(e):1,i=t?t.opacities:{},o=t?t.variableOffsets:{},a=t?t.placedOrientations:{};for(const s in this.placements){const e=this.placements[s],t=i[s];t?(this.opacities[s]=new kt(t,n,e.text,e.icon,null,e.clipped),r=r||e.text!==t.text.placed||e.icon!==t.icon.placed):(this.opacities[s]=new kt(null,n,e.text,e.icon,e.skipFade,e.clipped),r=r||e.text||e.icon)}for(const s in i){const e=i[s];if(!this.opacities[s]){const t=new kt(e,n,!1,!1);t.isHidden()||(this.opacities[s]=t,r=r||e.text.placed||e.icon.placed)}}for(const s in o)this.variableOffsets[s]||!this.opacities[s]||this.opacities[s].isHidden()||(this.variableOffsets[s]=o[s]);for(const s in a)this.placedOrientations[s]||!this.opacities[s]||this.opacities[s].isHidden()||(this.placedOrientations[s]=a[s]);r?this.lastPlacementChangeTime=e:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=t?t.lastPlacementChangeTime:e)}updateLayerOpacities(e,t){const r={};for(const n of t){const t=n.getBucket(e);t&&n.latestFeatureIndex&&e.id===t.layerIds[0]&&this.updateBucketOpacities(t,r,n.collisionBoxArray)}}updateBucketOpacities(t,r,n){t.hasTextData()&&t.text.opacityVertexArray.clear(),t.hasIconData()&&t.icon.opacityVertexArray.clear(),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexArray.clear(),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexArray.clear();const i=t.layers[0].layout,o=!!t.layers[0].dynamicFilter(),a=new kt(null,0,!1,!1,!0),s=i.get("text-allow-overlap"),u=i.get("icon-allow-overlap"),c=i.get("text-variable-anchor"),l="map"===i.get("text-rotation-alignment"),h="map"===i.get("text-pitch-alignment"),f="none"!==i.get("icon-text-fit"),d=new kt(null,0,s&&(u||!t.hasIconData()||i.get("icon-optional")),u&&(s||!t.hasTextData()||i.get("text-optional")),!0);!t.collisionArrays&&n&&(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData())&&t.deserializeCollisionBoxes(n);const p=(e,t,r)=>{for(let n=0;n<t/4;n++)e.opacityVertexArray.emplaceBack(r)};let m=0;for(let g=0;g<t.symbolInstances.length;g++){const n=t.symbolInstances.get(g),{numHorizontalGlyphVertices:i,numVerticalGlyphVertices:s,crossTileID:u,numIconVertices:y}=n;let v=this.opacities[u];r[u]?v=a:v||(v=d,this.opacities[u]=v),r[u]=!0;const _=i>0||s>0,b=y>0,x=this.placedOrientations[u],w=x===e.WritingMode.vertical,k=x===e.WritingMode.horizontal||x===e.WritingMode.horizontalOnly;if(!_&&!b||v.isHidden()||m++,_){const e=Ut(v.text);p(t.text,i,w?Zt:e),p(t.text,s,k?Zt:e);const r=v.text.isHidden(),{leftJustifiedTextSymbolIndex:o,centerJustifiedTextSymbolIndex:a,rightJustifiedTextSymbolIndex:c,verticalPlacedTextSymbolIndex:l}=n,h=t.text.placedSymbolArray,f=r||w?1:0;o>=0&&(h.get(o).hidden=f),a>=0&&(h.get(a).hidden=f),c>=0&&(h.get(c).hidden=f),l>=0&&(h.get(l).hidden=r||k?1:0);const d=this.variableOffsets[u];d&&this.markUsedJustification(t,d.anchor,n,x);const m=this.placedOrientations[u];m&&(this.markUsedJustification(t,"left",n,m),this.markUsedOrientation(t,m,n))}if(b){const e=Ut(v.icon),{placedIconSymbolIndex:r,verticalPlacedIconSymbolIndex:i}=n,o=t.icon.placedSymbolArray,a=v.icon.isHidden()?1:0;r>=0&&(p(t.icon,y,w?Zt:e),o.get(r).hidden=a),i>=0&&(p(t.icon,n.numVerticalIconVertices,k?Zt:e),o.get(i).hidden=a)}if(t.hasIconCollisionBoxData()||t.hasTextCollisionBoxData()){const r=t.collisionArrays[g];if(r){let n=new e.pointGeometry(0,0),i=!0;if(r.textBox||r.verticalTextBox){if(c){const e=this.variableOffsets[u];e?(n=Mt(e.anchor,e.width,e.height,e.textOffset,e.textScale),l&&n._rotate(h?this.transform.angle:-this.transform.angle)):i=!1}o&&(i=!v.clipped),r.textBox&&Ct(t.textCollisionBox.collisionVertexArray,v.text.placed,!i||w,n.x,n.y),r.verticalTextBox&&Ct(t.textCollisionBox.collisionVertexArray,v.text.placed,!i||k,n.x,n.y)}const a=i&&Boolean(!k&&r.verticalIconBox);r.iconBox&&Ct(t.iconCollisionBox.collisionVertexArray,v.icon.placed,a,f?n.x:0,f?n.y:0),r.verticalIconBox&&Ct(t.iconCollisionBox.collisionVertexArray,v.icon.placed,!a,f?n.x:0,f?n.y:0)}}}if(t.fullyClipped=0===m,t.sortFeatures(this.transform.angle),this.retainedQueryData[t.bucketInstanceId]&&(this.retainedQueryData[t.bucketInstanceId].featureSortOrder=t.featureSortOrder),t.hasTextData()&&t.text.opacityVertexBuffer&&t.text.opacityVertexBuffer.updateData(t.text.opacityVertexArray),t.hasIconData()&&t.icon.opacityVertexBuffer&&t.icon.opacityVertexBuffer.updateData(t.icon.opacityVertexArray),t.hasIconCollisionBoxData()&&t.iconCollisionBox.collisionVertexBuffer&&t.iconCollisionBox.collisionVertexBuffer.updateData(t.iconCollisionBox.collisionVertexArray),t.hasTextCollisionBoxData()&&t.textCollisionBox.collisionVertexBuffer&&t.textCollisionBox.collisionVertexBuffer.updateData(t.textCollisionBox.collisionVertexArray),t.bucketInstanceId in this.collisionCircleArrays){const e=this.collisionCircleArrays[t.bucketInstanceId];t.placementInvProjMatrix=e.invProjMatrix,t.placementViewportMatrix=e.viewportMatrix,t.collisionCircleArray=e.circles,delete this.collisionCircleArrays[t.bucketInstanceId]}}symbolFadeChange(e){return 0===this.fadeDuration?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(e){return Math.max(0,(this.transform.zoom-e)/1.5)}hasTransitions(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(e,t){const r=this.zoomAtLastRecencyCheck===t?1-this.zoomAdjustment(t):1;return this.zoomAtLastRecencyCheck=t,this.commitTime+this.fadeDuration*r>e}setStale(){this.stale=!0}}function Ct(e,t,r,n,i){e.emplaceBack(t?1:0,r?1:0,n||0,i||0),e.emplaceBack(t?1:0,r?1:0,n||0,i||0),e.emplaceBack(t?1:0,r?1:0,n||0,i||0),e.emplaceBack(t?1:0,r?1:0,n||0,i||0)}const Bt=Math.pow(2,25),Dt=Math.pow(2,24),Rt=Math.pow(2,17),Lt=Math.pow(2,16),Ot=Math.pow(2,9),zt=Math.pow(2,8),Nt=Math.pow(2,1);function Ut(e){if(0===e.opacity&&!e.placed)return 0;if(1===e.opacity&&e.placed)return 4294967295;const t=e.placed?1:0,r=Math.floor(127*e.opacity);return r*Bt+t*Dt+r*Rt+t*Lt+r*Ot+t*zt+r*Nt+t}const Zt=0;class Ft{constructor(e){this._sortAcrossTiles="viewport-y"!==e.layout.get("symbol-z-order")&&void 0!==e.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(e,t,r,n,i){const o=this._bucketParts;for(;this._currentTileIndex<e.length;)if(t.getBucketParts(o,n,e[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,i())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,o.sort(((e,t)=>e.sortKey-t.sortKey)));this._currentPartIndex<o.length;){const e=o[this._currentPartIndex];if(t.placeLayerBucketPart(e,this._seenCrossTileIDs,r,0===e.symbolInstanceStart),this._currentPartIndex++,i())return!0}return!1}}class jt{constructor(e,t,r,n,i,o,a,s){this.placement=new Pt(e,i,o,a,s),this._currentPlacementIndex=t.length-1,this._forceFullPlacement=r,this._showCollisionBoxes=n,this._done=!1}isDone(){return this._done}continuePlacement(t,r,n){const i=e.exported.now(),o=()=>{const t=e.exported.now()-i;return!this._forceFullPlacement&&t>2};for(;this._currentPlacementIndex>=0;){const e=r[t[this._currentPlacementIndex]],i=this.placement.collisionIndex.transform.zoom;if("symbol"===e.type&&(!e.minzoom||e.minzoom<=i)&&(!e.maxzoom||e.maxzoom>i)){if(this._inProgressLayer||(this._inProgressLayer=new Ft(e)),this._inProgressLayer.continuePlacement(n[e.source],this.placement,this._showCollisionBoxes,e,o))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(e){return this.placement.commit(e),this.placement}}const Vt=512/e.EXTENT/2;class Wt{constructor(e,t,r){this.tileID=e,this.indexedSymbolInstances={},this.bucketInstanceId=r;for(let n=0;n<t.length;n++){const r=t.get(n),i=r.key;this.indexedSymbolInstances[i]||(this.indexedSymbolInstances[i]=[]),this.indexedSymbolInstances[i].push({crossTileID:r.crossTileID,coord:this.getScaledCoordinates(r,e)})}}getScaledCoordinates(t,r){const n=Vt/Math.pow(2,r.canonical.z-this.tileID.canonical.z);return{x:Math.floor((r.canonical.x*e.EXTENT+t.tileAnchorX)*n),y:Math.floor((r.canonical.y*e.EXTENT+t.tileAnchorY)*n)}}findMatches(e,t,r){const n=this.tileID.canonical.z<t.canonical.z?1:Math.pow(2,this.tileID.canonical.z-t.canonical.z);for(let i=0;i<e.length;i++){const o=e.get(i);if(o.crossTileID)continue;const a=this.indexedSymbolInstances[o.key];if(!a)continue;const s=this.getScaledCoordinates(o,t);for(const e of a)if(Math.abs(e.coord.x-s.x)<=n&&Math.abs(e.coord.y-s.y)<=n&&!r[e.crossTileID]){r[e.crossTileID]=!0,o.crossTileID=e.crossTileID;break}}}}class Kt{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Gt{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(e){const t=Math.round((e-this.lng)/360);if(0!==t)for(const r in this.indexes){const e=this.indexes[r],n={};for(const r in e){const i=e[r];i.tileID=i.tileID.unwrapTo(i.tileID.wrap+t),n[i.tileID.key]=i}this.indexes[r]=n}this.lng=e}addBucket(e,t,r){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===t.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(let i=0;i<t.symbolInstances.length;i++)t.symbolInstances.get(i).crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]={});const n=this.usedCrossTileIDs[e.overscaledZ];for(const i in this.indexes){const r=this.indexes[i];if(Number(i)>e.overscaledZ)for(const i in r){const o=r[i];o.tileID.isChildOf(e)&&o.findMatches(t.symbolInstances,e,n)}else{const o=r[e.scaledTo(Number(i)).key];o&&o.findMatches(t.symbolInstances,e,n)}}for(let i=0;i<t.symbolInstances.length;i++){const e=t.symbolInstances.get(i);e.crossTileID||(e.crossTileID=r.generate(),n[e.crossTileID]=!0)}return void 0===this.indexes[e.overscaledZ]&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new Wt(e,t.symbolInstances,t.bucketInstanceId),!0}removeBucketCrossTileIDs(e,t){for(const r in t.indexedSymbolInstances)for(const n of t.indexedSymbolInstances[r])delete this.usedCrossTileIDs[e][n.crossTileID]}removeStaleBuckets(e){let t=!1;for(const r in this.indexes){const n=this.indexes[r];for(const i in n)e[n[i].bucketInstanceId]||(this.removeBucketCrossTileIDs(r,n[i]),delete n[i],t=!0)}return t}}class Ht{constructor(){this.layerIndexes={},this.crossTileIDs=new Kt,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(e,t,r,n){let i=this.layerIndexes[e.id];void 0===i&&(i=this.layerIndexes[e.id]=new Gt);let o=!1;const a={};"globe"!==n.name&&i.handleWrapJump(r);for(const s of t){const t=s.getBucket(e);t&&e.id===t.layerIds[0]&&(t.bucketInstanceId||(t.bucketInstanceId=++this.maxBucketInstanceId),i.addBucket(s.tileID,t,this.crossTileIDs)&&(o=!0),a[t.bucketInstanceId]=!0)}return i.removeStaleBuckets(a)&&(o=!0),o}pruneUnusedLayers(e){const t={};e.forEach((e=>{t[e]=!0}));for(const r in this.layerIndexes)t[r]||delete this.layerIndexes[r]}}const qt=(t,r)=>e.emitValidationErrors(t,r&&r.filter((e=>"source.canvas"!==e.identifier))),Yt=e.pick(Ke,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),Xt=e.pick(Ke,["setCenter","setZoom","setBearing","setPitch"]),Qt={version:8,layers:[],sources:{}},$t={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class Jt extends e.Evented{constructor(t,r={}){super(),this.map=t,this.dispatcher=new B(je(),this),this.imageManager=new b,this.imageManager.setEventedParent(this),this.glyphManager=new e.GlyphManager(t._requestManager,r.localFontFamily?e.LocalGlyphMode.all:r.localIdeographFontFamily?e.LocalGlyphMode.ideographs:e.LocalGlyphMode.none,r.localFontFamily||r.localIdeographFontFamily),this.crossTileSymbolIndex=new Ht,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",e.getReferrer());const n=this;this._rtlTextPluginCallback=Jt.registerForPluginStateChange((t=>{n.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:t.pluginStatus,pluginURL:t.pluginURL},((t,r)=>{if(e.triggerPluginCompletionEvent(t),r&&r.every((e=>e)))for(const e in n._sourceCaches){const t=n._sourceCaches[e],r=t.getSource().type;"vector"!==r&&"geojson"!==r||t.reload()}}))})),this.on("data",(e=>{if("source"!==e.dataType||"metadata"!==e.sourceDataType)return;const t=this.getSource(e.sourceId);if(t&&t.vectorLayerIds)for(const r in this._layers){const e=this._layers[r];e.source===t.id&&this._validateLayer(e)}}))}loadURL(t,r={}){this.fire(new e.Event("dataloading",{dataType:"style"}));const n="boolean"==typeof r.validate?r.validate:!e.isMapboxURL(t);t=this.map._requestManager.normalizeStyleURL(t,r.accessToken);const i=this.map._requestManager.transformRequest(t,e.ResourceType.Style);this._request=e.getJSON(i,((t,r)=>{this._request=null,t?this.fire(new e.ErrorEvent(t)):r&&this._load(r,n)}))}loadJSON(t,r={}){this.fire(new e.Event("dataloading",{dataType:"style"})),this._request=e.exported.frame((()=>{this._request=null,this._load(t,!1!==r.validate)}))}loadEmpty(){this.fire(new e.Event("dataloading",{dataType:"style"})),this._load(Qt,!1)}_updateLayerCount(e,t){const r=t?1:-1;e.is3D()&&(this._num3DLayers+=r),"circle"===e.type&&(this._numCircleLayers+=r),"symbol"===e.type&&(this._numSymbolLayers+=r)}_load(t,r){if(r&&qt(this,e.validateStyle(t)))return;this._loaded=!0,this.stylesheet=e.clone$1(t),this._updateMapProjection();for(const e in t.sources)this.addSource(e,t.sources[e],{validate:!1});this._changed=!1,t.sprite?this._loadSprite(t.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(t.glyphs);const n=We(this.stylesheet.layers);this._order=n.map((e=>e.id)),this._layers={},this._serializedLayers={};for(let i of n)i=e.createStyleLayer(i),i.setEventedParent(this,{layer:{id:i.id}}),this._layers[i.id]=i,this._serializedLayers[i.id]=i.serialize(),this._updateLayerCount(i,!0);this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new k(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new e.Event("data",{dataType:"style"})),this.fire(new e.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&0===this.terrain.drapeRenderMode}setProjection(e){e?this.stylesheet.projection=e:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(t){this._spriteRequest=function(t,r,n){let i,o,a;const s=e.exported.devicePixelRatio>1?"@2x":"";let u=e.getJSON(r.transformRequest(r.normalizeSpriteURL(t,s,".json"),e.ResourceType.SpriteJSON),((e,t)=>{u=null,a||(a=e,i=t,l())})),c=e.getImage(r.transformRequest(r.normalizeSpriteURL(t,s,".png"),e.ResourceType.SpriteImage),((e,t)=>{c=null,a||(a=e,o=t,l())}));function l(){if(a)n(a);else if(i&&o){const t=e.exported.getImageData(o),r={};for(const n in i){const{width:o,height:a,x:s,y:u,sdf:c,pixelRatio:l,stretchX:h,stretchY:f,content:d}=i[n],p=new e.RGBAImage({width:o,height:a});e.RGBAImage.copy(t,p,{x:s,y:u},{x:0,y:0},{width:o,height:a}),r[n]={data:p,pixelRatio:l,sdf:c,stretchX:h,stretchY:f,content:d}}n(null,r)}}return{cancel(){u&&(u.cancel(),u=null),c&&(c.cancel(),c=null)}}}(t,this.map._requestManager,((t,r)=>{if(this._spriteRequest=null,t)this.fire(new e.ErrorEvent(t));else if(r)for(const e in r)this.imageManager.addImage(e,r[e]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new e.Event("data",{dataType:"style"}))}))}_validateLayer(t){const r=this.getSource(t.source);if(!r)return;const n=t.sourceLayer;n&&("geojson"===r.type||r.vectorLayerIds&&-1===r.vectorLayerIds.indexOf(n))&&this.fire(new e.ErrorEvent(new Error(`Source layer "${n}" does not exist on source "${r.id}" as specified by style layer "${t.id}"`)))}loaded(){if(!this._loaded)return!1;if(Object.keys(this._updatedSources).length)return!1;for(const e in this._sourceCaches)if(!this._sourceCaches[e].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(e){const t=[];for(const r of e){const e=this._layers[r];"custom"!==e.type&&t.push(e.serialize())}return t}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;if(this.fog&&this.fog.hasTransition())return!0;for(const e in this._sourceCaches)if(this._sourceCaches[e].hasTransition())return!0;for(const e in this._layers)if(this._layers[e].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(e){return!!this.terrain&&("function"==typeof e.isLayerDraped?e.isLayerDraped():$t[e.type])}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(t){if(!this._loaded)return;const r=this._changed;if(this._changed){const e=Object.keys(this._updatedLayers),r=Object.keys(this._removedLayers);(e.length||r.length)&&this._updateWorkerLayers(e,r);for(const t in this._updatedSources){const e=this._updatedSources[t];"reload"===e?this._reloadSource(t):"clear"===e&&this._clearSource(t)}this._updateTilesForChangedImages();for(const n in this._updatedPaintProps)this._layers[n].updateTransitions(t);this.light.updateTransitions(t),this.fog&&this.fog.updateTransitions(t),this._resetUpdates()}const n={};for(const e in this._sourceCaches){const t=this._sourceCaches[e];n[e]=t.used,t.used=!1}for(const e of this._order){const r=this._layers[e];if(r.recalculate(t,this._availableImages),!r.isHidden(t.zoom)){const e=this._getLayerSourceCache(r);e&&(e.used=!0)}const n=this.map.painter;if(n){const e=r.getProgramIds();if(!e)continue;const i=r.getProgramConfiguration(t.zoom);for(const t of e)n.useProgram(t,i)}}for(const i in n){const t=this._sourceCaches[i];n[i]!==t.used&&t.getSource().fire(new e.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:t.getSource().id}))}this.light.recalculate(t),this.terrain&&this.terrain.recalculate(t),this.fog&&this.fog.recalculate(t),this.z=t.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),r&&this.fire(new e.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const e=Object.keys(this._changedImages);if(e.length){for(const t in this._sourceCaches)this._sourceCaches[t].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}}_updateWorkerLayers(e,t){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(e),removedIds:t})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(r){if(this._checkLoaded(),qt(this,e.validateStyle(r)))return!1;(r=e.clone$1(r)).layers=We(r.layers);const n=function(e,r){if(!e)return[{command:Ke.setStyle,args:[r]}];let n=[];try{if(!t(e.version,r.version))return[{command:Ke.setStyle,args:[r]}];t(e.center,r.center)||n.push({command:Ke.setCenter,args:[r.center]}),t(e.zoom,r.zoom)||n.push({command:Ke.setZoom,args:[r.zoom]}),t(e.bearing,r.bearing)||n.push({command:Ke.setBearing,args:[r.bearing]}),t(e.pitch,r.pitch)||n.push({command:Ke.setPitch,args:[r.pitch]}),t(e.sprite,r.sprite)||n.push({command:Ke.setSprite,args:[r.sprite]}),t(e.glyphs,r.glyphs)||n.push({command:Ke.setGlyphs,args:[r.glyphs]}),t(e.transition,r.transition)||n.push({command:Ke.setTransition,args:[r.transition]}),t(e.light,r.light)||n.push({command:Ke.setLight,args:[r.light]}),t(e.fog,r.fog)||n.push({command:Ke.setFog,args:[r.fog]}),t(e.projection,r.projection)||n.push({command:Ke.setProjection,args:[r.projection]});const i={},o=[];!function(e,r,n,i){let o;for(o in r=r||{},e=e||{})e.hasOwnProperty(o)&&(r.hasOwnProperty(o)||He(o,n,i));for(o in r)r.hasOwnProperty(o)&&(e.hasOwnProperty(o)?t(e[o],r[o])||("geojson"===e[o].type&&"geojson"===r[o].type&&Ye(e,r,o)?n.push({command:Ke.setGeoJSONSourceData,args:[o,r[o].data]}):qe(o,r,n,i)):Ge(o,r,n))}(e.sources,r.sources,o,i);const a=[];e.layers&&e.layers.forEach((e=>{e.source&&i[e.source]?n.push({command:Ke.removeLayer,args:[e.id]}):a.push(e)}));let s=e.terrain;s&&i[s.source]&&(n.push({command:Ke.setTerrain,args:[void 0]}),s=void 0),n=n.concat(o),t(s,r.terrain)||n.push({command:Ke.setTerrain,args:[r.terrain]}),function(e,r,n){r=r||[];const i=(e=e||[]).map(Qe),o=r.map(Qe),a=e.reduce($e,{}),s=r.reduce($e,{}),u=i.slice(),c=Object.create(null);let l,h,f,d,p,m,g;for(l=0,h=0;l<i.length;l++)f=i[l],s.hasOwnProperty(f)?h++:(n.push({command:Ke.removeLayer,args:[f]}),u.splice(u.indexOf(f,h),1));for(l=0,h=0;l<o.length;l++)f=o[o.length-1-l],u[u.length-1-l]!==f&&(a.hasOwnProperty(f)?(n.push({command:Ke.removeLayer,args:[f]}),u.splice(u.lastIndexOf(f,u.length-h),1)):h++,m=u[u.length-l],n.push({command:Ke.addLayer,args:[s[f],m]}),u.splice(u.length-l,0,f),c[f]=!0);for(l=0;l<o.length;l++)if(f=o[l],d=a[f],p=s[f],!c[f]&&!t(d,p))if(t(d.source,p.source)&&t(d["source-layer"],p["source-layer"])&&t(d.type,p.type)){for(g in Xe(d.layout,p.layout,n,f,null,Ke.setLayoutProperty),Xe(d.paint,p.paint,n,f,null,Ke.setPaintProperty),t(d.filter,p.filter)||n.push({command:Ke.setFilter,args:[f,p.filter]}),t(d.minzoom,p.minzoom)&&t(d.maxzoom,p.maxzoom)||n.push({command:Ke.setLayerZoomRange,args:[f,p.minzoom,p.maxzoom]}),d)d.hasOwnProperty(g)&&"layout"!==g&&"paint"!==g&&"filter"!==g&&"metadata"!==g&&"minzoom"!==g&&"maxzoom"!==g&&(0===g.indexOf("paint.")?Xe(d[g],p[g],n,f,g.slice(6),Ke.setPaintProperty):t(d[g],p[g])||n.push({command:Ke.setLayerProperty,args:[f,g,p[g]]}));for(g in p)p.hasOwnProperty(g)&&!d.hasOwnProperty(g)&&"layout"!==g&&"paint"!==g&&"filter"!==g&&"metadata"!==g&&"minzoom"!==g&&"maxzoom"!==g&&(0===g.indexOf("paint.")?Xe(d[g],p[g],n,f,g.slice(6),Ke.setPaintProperty):t(d[g],p[g])||n.push({command:Ke.setLayerProperty,args:[f,g,p[g]]}))}else n.push({command:Ke.removeLayer,args:[f]}),m=u[u.lastIndexOf(f)+1],n.push({command:Ke.addLayer,args:[p,m]})}(a,r.layers,n)}catch(e){console.warn("Unable to compute style diff:",e),n=[{command:Ke.setStyle,args:[r]}]}return n}(this.serialize(),r).filter((e=>!(e.command in Xt)));if(0===n.length)return!1;const i=n.filter((e=>!(e.command in Yt)));if(i.length>0)throw new Error(`Unimplemented: ${i.map((e=>e.command)).join(", ")}.`);return n.forEach((e=>{"setTransition"!==e.command&&"setProjection"!==e.command&&this[e.command].apply(this,e.args)})),this.stylesheet=r,this._updateMapProjection(),!0}addImage(t,r){return this.getImage(t)?this.fire(new e.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(t,r),this._afterImageUpdated(t),this)}updateImage(e,t){this.imageManager.updateImage(e,t)}getImage(e){return this.imageManager.getImage(e)}removeImage(t){return this.getImage(t)?(this.imageManager.removeImage(t),this._afterImageUpdated(t),this):this.fire(new e.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(t){this._availableImages=this.imageManager.listImages(),this._changedImages[t]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new e.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(t,r,n={}){if(this._checkLoaded(),void 0!==this.getSource(t))throw new Error("There is already a source with this ID");if(!r.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(r).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(r.type)>=0&&this._validate(e.validateSource,`sources.${t}`,r,null,n))return;this.map&&this.map._collectResourceTiming&&(r.collectResourceTiming=!0);const i=De(t,r,this.dispatcher,this);i.setEventedParent(this,(()=>({isSourceLoaded:this._isSourceCacheLoaded(t),source:i.serialize(),sourceId:t})));const o=r=>{const n=(r?"symbol:":"other:")+t,o=this._sourceCaches[n]=new e.SourceCache(n,i,r);(r?this._symbolSourceCaches:this._otherSourceCaches)[t]=o,o.style=this,o.onAdd(this.map)};o(!1),"vector"!==r.type&&"geojson"!==r.type||o(!0),i.onAdd&&i.onAdd(this.map),this._changed=!0}removeSource(t){this._checkLoaded();const r=this.getSource(t);if(!r)throw new Error("There is no source with this ID");for(const i in this._layers)if(this._layers[i].source===t)return this.fire(new e.ErrorEvent(new Error(`Source "${t}" cannot be removed while layer "${i}" is using it.`)));if(this.terrain&&this.terrain.get().source===t)return this.fire(new e.ErrorEvent(new Error(`Source "${t}" cannot be removed while terrain is using it.`)));const n=this._getSourceCaches(t);for(const i of n)delete this._sourceCaches[i.id],delete this._updatedSources[i.id],i.fire(new e.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:i.getSource().id})),i.setEventedParent(null),i.clearTiles();return delete this._otherSourceCaches[t],delete this._symbolSourceCaches[t],r.setEventedParent(null),r.onRemove&&r.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(e,t){this._checkLoaded(),this.getSource(e).setData(t),this._changed=!0}getSource(e){const t=this._getSourceCache(e);return t&&t.getSource()}_getSources(){const e=[];for(const t in this._otherSourceCaches){const r=this._getSourceCache(t);r&&e.push(r.getSource())}return e}addLayer(t,r,n={}){this._checkLoaded();const i=t.id;if(this.getLayer(i))return void this.fire(new e.ErrorEvent(new Error(`Layer with id "${i}" already exists on this map`)));let o;if("custom"===t.type){if(qt(this,e.validateCustomStyleLayer(t)))return;o=e.createStyleLayer(t)}else{if("object"==typeof t.source&&(this.addSource(i,t.source),t=e.clone$1(t),t=e.extend(t,{source:i})),this._validate(e.validateLayer,`layers.${i}`,t,{arrayIndex:-1},n))return;o=e.createStyleLayer(t),this._validateLayer(o),o.setEventedParent(this,{layer:{id:i}}),this._serializedLayers[o.id]=o.serialize(),this._updateLayerCount(o,!0)}const a=r?this._order.indexOf(r):this._order.length;if(r&&-1===a)return void this.fire(new e.ErrorEvent(new Error(`Layer with id "${r}" does not exist on this map.`)));this._order.splice(a,0,i),this._layerOrderChanged=!0,this._layers[i]=o;const s=this._getLayerSourceCache(o);if(this._removedLayers[i]&&o.source&&s&&"custom"!==o.type){const e=this._removedLayers[i];delete this._removedLayers[i],e.type!==o.type?this._updatedSources[o.source]="clear":(this._updatedSources[o.source]="reload",s.pause())}this._updateLayer(o),o.onAdd&&o.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(t,r){if(this._checkLoaded(),this._changed=!0,!this._layers[t])return void this.fire(new e.ErrorEvent(new Error(`The layer '${t}' does not exist in the map's style and cannot be moved.`)));if(t===r)return;const n=this._order.indexOf(t);this._order.splice(n,1);const i=r?this._order.indexOf(r):this._order.length;r&&-1===i?this.fire(new e.ErrorEvent(new Error(`Layer with id "${r}" does not exist on this map.`))):(this._order.splice(i,0,t),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(t){this._checkLoaded();const r=this._layers[t];if(!r)return void this.fire(new e.ErrorEvent(new Error(`The layer '${t}' does not exist in the map's style and cannot be removed.`)));r.setEventedParent(null),this._updateLayerCount(r,!1);const n=this._order.indexOf(t);this._order.splice(n,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[t]=r,delete this._layers[t],delete this._serializedLayers[t],delete this._updatedLayers[t],delete this._updatedPaintProps[t],r.onRemove&&r.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(e){return this._layers[e]}hasLayer(e){return e in this._layers}hasLayerType(e){for(const t in this._layers)if(this._layers[t].type===e)return!0;return!1}setLayerZoomRange(t,r,n){this._checkLoaded();const i=this.getLayer(t);i?i.minzoom===r&&i.maxzoom===n||(null!=r&&(i.minzoom=r),null!=n&&(i.maxzoom=n),this._updateLayer(i)):this.fire(new e.ErrorEvent(new Error(`The layer '${t}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(r,n,i={}){this._checkLoaded();const o=this.getLayer(r);if(o){if(!t(o.filter,n))return null==n?(o.filter=void 0,void this._updateLayer(o)):void(this._validate(e.validateFilter,`layers.${o.id}.filter`,n,{layerType:o.type},i)||(o.filter=e.clone$1(n),this._updateLayer(o)))}else this.fire(new e.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be filtered.`)))}getFilter(t){const r=this.getLayer(t);return r&&e.clone$1(r.filter)}setLayoutProperty(r,n,i,o={}){this._checkLoaded();const a=this.getLayer(r);a?t(a.getLayoutProperty(n),i)||(a.setLayoutProperty(n,i,o),this._updateLayer(a)):this.fire(new e.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(t,r){const n=this.getLayer(t);if(n)return n.getLayoutProperty(r);this.fire(new e.ErrorEvent(new Error(`The layer '${t}' does not exist in the map's style.`)))}setPaintProperty(r,n,i,o={}){this._checkLoaded();const a=this.getLayer(r);a?t(a.getPaintProperty(n),i)||(a.setPaintProperty(n,i,o)&&this._updateLayer(a),this._changed=!0,this._updatedPaintProps[r]=!0):this.fire(new e.ErrorEvent(new Error(`The layer '${r}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(e,t){const r=this.getLayer(e);return r&&r.getPaintProperty(t)}setFeatureState(t,r){this._checkLoaded();const n=t.source,i=t.sourceLayer,o=this.getSource(n);if(!o)return void this.fire(new e.ErrorEvent(new Error(`The source '${n}' does not exist in the map's style.`)));const a=o.type;if("geojson"===a&&i)return void this.fire(new e.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if("vector"===a&&!i)return void this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));void 0===t.id&&this.fire(new e.ErrorEvent(new Error("The feature id parameter must be provided.")));const s=this._getSourceCaches(n);for(const e of s)e.setFeatureState(i,t.id,r)}removeFeatureState(t,r){this._checkLoaded();const n=t.source,i=this.getSource(n);if(!i)return void this.fire(new e.ErrorEvent(new Error(`The source '${n}' does not exist in the map's style.`)));const o=i.type,a="vector"===o?t.sourceLayer:void 0;if("vector"===o&&!a)return void this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(r&&"string"!=typeof t.id&&"number"!=typeof t.id)return void this.fire(new e.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const s=this._getSourceCaches(n);for(const e of s)e.removeFeatureState(a,t.id,r)}getFeatureState(t){this._checkLoaded();const r=t.source,n=t.sourceLayer,i=this.getSource(r);if(i){if("vector"!==i.type||n)return void 0===t.id&&this.fire(new e.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(r)[0].getFeatureState(n,t.id);this.fire(new e.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new e.ErrorEvent(new Error(`The source '${r}' does not exist in the map's style.`)))}getTransition(){return e.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const t={};for(const e in this._sourceCaches){const r=this._sourceCaches[e].getSource();t[r.id]||(t[r.id]=r.serialize())}return e.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:t,layers:this._serializeLayers(this._order)},(e=>void 0!==e))}_updateLayer(e){this._updatedLayers[e.id]=!0;const t=this._getLayerSourceCache(e);e.source&&!this._updatedSources[e.source]&&t&&"raster"!==t.getSource().type&&(this._updatedSources[e.source]="reload",t.pause()),this._changed=!0,e.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(e){const t=e=>"fill-extrusion"===this._layers[e].type,r={},n=[];for(let o=this._order.length-1;o>=0;o--){const i=this._order[o];if(t(i)){r[i]=o;for(const t of e){const e=t[i];if(e)for(const t of e)n.push(t)}}}n.sort(((e,t)=>t.intersectionZ-e.intersectionZ));const i=[];for(let o=this._order.length-1;o>=0;o--){const a=this._order[o];if(t(a))for(let e=n.length-1;e>=0;e--){const t=n[e].feature;if(r[t.layer.id]<o)break;i.push(t),n.pop()}else for(const t of e){const e=t[a];if(e)for(const t of e)i.push(t.feature)}}return i}queryRenderedFeatures(t,r,n){r&&r.filter&&this._validate(e.validateFilter,"queryRenderedFeatures.filter",r.filter,null,r);const i={};if(r&&r.layers){if(!Array.isArray(r.layers))return this.fire(new e.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const t of r.layers){const r=this._layers[t];if(!r)return this.fire(new e.ErrorEvent(new Error(`The layer '${t}' does not exist in the map's style and cannot be queried for features.`))),[];i[r.source]=!0}}const o=[];r.availableImages=this._availableImages;const a=r&&r.layers?r.layers.some((e=>{const t=this.getLayer(e);return t&&t.is3D()})):this.has3DLayers(),s=R.createFromScreenPoints(t,n);for(const e in this._sourceCaches){const t=this._sourceCaches[e].getSource().id;r.layers&&!i[t]||o.push(Le(this._sourceCaches[e],this._layers,this._serializedLayers,s,r,n,a,!!this.map._showQueryGeometry))}return this.placement&&o.push(function(e,t,r,n,i,o,a){const s={},u=o.queryRenderedSymbols(n),c=[];for(const l of Object.keys(u).map(Number))c.push(a[l]);c.sort(ze);for(const l of c){const r=l.featureIndex.lookupSymbolFeatures(u[l.bucketInstanceId],t,l.bucketIndex,l.sourceLayerIndex,i.filter,i.layers,i.availableImages,e);for(const e in r){const t=s[e]=s[e]||[],n=r[e];n.sort(((e,t)=>{const r=l.featureSortOrder;if(r){const n=r.indexOf(e.featureIndex);return r.indexOf(t.featureIndex)-n}return t.featureIndex-e.featureIndex}));for(const e of n)t.push(e)}}for(const l in s)s[l].forEach((t=>{const n=t.feature,i=r(e[l]).getFeatureState(n.layer["source-layer"],n.id);n.source=n.layer.source,n.layer["source-layer"]&&(n.sourceLayer=n.layer["source-layer"]),n.state=i}));return s}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),s.screenGeometry,r,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(o)}querySourceFeatures(t,r){r&&r.filter&&this._validate(e.validateFilter,"querySourceFeatures.filter",r.filter,null,r);const n=this._getSourceCaches(t);let i=[];for(const e of n)i=i.concat(Oe(e,r));return i}addSourceType(e,t,r){return Jt.getSourceType(e)?r(new Error(`A source type called "${e}" already exists.`)):(Jt.setSourceType(e,t),t.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:e,url:t.workerSourceURL},r):r(null,null))}getLight(){return this.light.getLight()}setLight(e,r={}){this._checkLoaded();const n=this.light.getLight();let i=!1;for(const a in e)if(!t(e[a],n[a])){i=!0;break}if(!i)return;const o=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(e,r),this.light.updateTransitions(o)}getTerrain(){return this.terrain&&1===this.terrain.drapeRenderMode?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(r,n=1){if(this._checkLoaded(),!r)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);if(1===n){if("object"==typeof r.source){const t="terrain-dem-src";this.addSource(t,r.source),r=e.clone$1(r),r=e.extend(r,{source:t})}if(this._validate(e.validateTerrain,"terrain",r))return}if(!this.terrain||this.terrain&&n!==this.terrain.drapeRenderMode)this._createTerrain(r,n);else{const n=this.terrain,i=n.get();for(const t of Object.keys(e.spec.terrain))!r.hasOwnProperty(t)&&e.spec.terrain[t].default&&(r[t]=e.spec.terrain[t].default);for(const e in r)if(!t(r[e],i[e])){n.set(r),this.stylesheet.terrain=r;const e=this._setTransitionParameters({duration:0});n.updateTransitions(e);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(e){const t=this.fog=new C(e,this.map.transform);this.stylesheet.fog=e;const r=this._setTransitionParameters({duration:0});t.updateTransitions(r)}_updateMarkersOpacity(){0!==this.map._markers.length&&this.map._requestDomTask((()=>{for(const e of this.map._markers)e._evaluateOpacity()}))}getFog(){return this.fog?this.fog.get():null}setFog(e){if(this._checkLoaded(),!e)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const r=this.fog,n=r.get();0===Object.keys(e).length&&r.set(e);for(const i in e)if(!t(e[i],n[i])){r.set(e),this.stylesheet.fog=e;const t=this._setTransitionParameters({duration:0});r.updateTransitions(t);break}}else this._createFog(e);this._markersNeedUpdate=!0}_setTransitionParameters(t){return{now:e.exported.now(),transition:e.extend(t,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const e=this._order.filter((e=>this.isLayerDraped(this._layers[e]))),t=this._order.filter((e=>!this.isLayerDraped(this._layers[e])));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...e),this._drapedFirstOrder.push(...t)}_createTerrain(e,t){const r=this.terrain=new S(e,t);this.stylesheet.terrain=e,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const n=this._setTransitionParameters({duration:0});r.updateTransitions(n)}_force3DLayerUpdate(){for(const e in this._layers){const t=this._layers[e];"fill-extrusion"===t.type&&this._updateLayer(t)}}_forceSymbolLayerUpdate(){for(const e in this._layers){const t=this._layers[e];"symbol"===t.type&&this._updateLayer(t)}}_validate(t,r,n,i,o={}){return(!o||!1!==o.validate)&&qt(this,t.call(e.validateStyle,e.extend({key:r,style:this.serialize(),value:n,styleSpec:e.spec},i)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),e.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const e in this._layers)this._layers[e].setEventedParent(null);for(const e in this._sourceCaches)this._sourceCaches[e].clearTiles(),this._sourceCaches[e].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(e){const t=this._getSourceCaches(e);for(const r of t)r.clearTiles()}_reloadSource(e){const t=this._getSourceCaches(e);for(const r of t)r.resume(),r.reload()}_reloadSources(){for(const e of this._getSources())e.reload&&e.reload()}_updateSources(e){for(const t in this._sourceCaches)this._sourceCaches[t].update(e)}_generateCollisionBoxes(){for(const e in this._sourceCaches){const t=this._sourceCaches[e];t.resume(),t.reload()}}_updatePlacement(t,r,n,i,o=!1){let a=!1,s=!1;const u={};for(const e of this._order){const r=this._layers[e];if("symbol"!==r.type)continue;if(!u[r.source]){const e=this._getLayerSourceCache(r);if(!e)continue;u[r.source]=e.getRenderableIds(!0).map((t=>e.getTileByID(t))).sort(((e,t)=>t.tileID.overscaledZ-e.tileID.overscaledZ||(e.tileID.isLessThan(t.tileID)?-1:1)))}const n=this.crossTileSymbolIndex.addLayer(r,u[r.source],t.center.lng,t.projection);a=a||n}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),o=o||this._layerOrderChanged||0===n,this._layerOrderChanged&&this.fire(new e.Event("neworder")),(o||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(e.exported.now(),t.zoom))&&(this.pauseablePlacement=new jt(t,this._order,o,r,n,i,this.placement,this.fog&&t.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,u),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(e.exported.now()),s=!0),a&&this.pauseablePlacement.placement.setStale()),s||a)for(const e of this._order){const t=this._layers[e];"symbol"===t.type&&this.placement.updateLayerOpacities(t,u[t.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(e.exported.now())}_releaseSymbolFadeTiles(){for(const e in this._sourceCaches)this._sourceCaches[e].releaseSymbolFadeTiles()}getImages(e,t,r){this.imageManager.getImages(t.icons,r),this._updateTilesForChangedImages();const n=e=>{e&&e.setDependencies(t.tileID.key,t.type,t.icons)};n(this._otherSourceCaches[t.source]),n(this._symbolSourceCaches[t.source])}getGlyphs(e,t,r){this.glyphManager.getGlyphs(t.stacks,r)}getResource(t,r,n){return e.makeRequest(r,n)}_getSourceCache(e){return this._otherSourceCaches[e]}_getLayerSourceCache(e){return"symbol"===e.type?this._symbolSourceCaches[e.source]:this._otherSourceCaches[e.source]}_getSourceCaches(e){const t=[];return this._otherSourceCaches[e]&&t.push(this._otherSourceCaches[e]),this._symbolSourceCaches[e]&&t.push(this._symbolSourceCaches[e]),t}_isSourceCacheLoaded(t){const r=this._getSourceCaches(t);return 0===r.length?(this.fire(new e.ErrorEvent(new Error(`There is no source with ID '${t}'`))),!1):r.every((e=>e.loaded()))}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Jt.getSourceType=function(e){return Be[e]},Jt.setSourceType=function(e,t){Be[e]=t},Jt.registerForPluginStateChange=e.registerForPluginStateChange;var er="\n#define EPSILON 0.0000001\n#define PI 3.141592653589793\n#define EXTENT 8192.0\n#define HALF_PI PI/2.0\n#define QUARTER_PI PI/4.0\n#define RAD_TO_DEG 180.0/PI\n#define DEG_TO_RAD PI/180.0\n#define GLOBE_RADIUS EXTENT/PI/2.0",tr="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",rr="\n#define ELEVATION_SCALE 7.0\n#define ELEVATION_OFFSET 450.0\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(\nmix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}\n#else\nvec3 elevationVector(vec2 pos) { return vec3(0,0,1); }\n#endif\nconst float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)\n{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}\n#ifdef TERRAIN\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nuniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;\n#else\nuniform sampler2D u_dem;uniform sampler2D u_dem_prev;\n#endif\nuniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));\n#ifdef TERRAIN_DEM_NEAREST_FILTER\nreturn u_exaggeration*tl;\n#endif\nfloat tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}float prevElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}\n#ifdef TERRAIN_VERTEX_MORPHING\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nfloat nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}\n#else\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nreturn currentElevation(apos);}\n#endif\nhighp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(\nunpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))\n);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nfloat tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;\n#else\nvec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);\n#endif\nreturn vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}\n#else\nfloat elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }\n#endif",nr="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}\n#endif",ir="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}\n#endif";let or={},ar={};const sr=[];fr(er,sr),fr(rr,sr),fr(nr,sr),fr(ir,sr),or=dr("",rr),ar=dr(ir,nr);const ur=dr("\n#if __VERSION__ >=300\n#define varying in\n#define gl_FragColor glFragColor\n#define texture2D texture\n#define textureCube texture\nout vec4 glFragColor;\n#endif\nhighp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}","\n#if __VERSION__ >=300\n#define attribute in\n#define varying out\n#define texture2D texture\n#endif\nfloat wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {\n#ifndef PROJECTED_POS_ON_VIEWPORT\nfloat tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;\n#else\nreturn vec3(0.0);\n#endif\n}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(\nunpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered."),cr=er,lr="\n#ifdef GL_ES\nprecision mediump float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif";var hr={background:dr("uniform vec4 u_color;uniform float u_opacity;\n#ifdef LIGHTING_3D_MODE\nvarying vec4 v_color;\n#endif\nvoid main() {vec4 out_color;\n#ifdef LIGHTING_3D_MODE\nout_color=v_color;\n#else\nout_color=u_color;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#ifdef LIGHTING_3D_MODE\nuniform vec4 u_color;varying vec4 v_color;\n#endif\nvoid main() {gl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting(u_color);\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),backgroundPattern:dr("uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),circle:dr("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(\nantialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)\n);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_apply_premultiplied(out_color,v_fog_pos);\n#endif\ngl_FragColor=out_color*(v_visibility*opacity_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","#define NUM_VISIBILITY_RINGS 2\n#define INV_SQRT2 0.70710678\n#define ELEVATION_BIAS 0.0001\n#define NUM_SAMPLES_PER_RING 16\nuniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {\n#if defined(TERRAIN)\nreturn elevation(pos)+ELEVATION_BIAS;\n#else\nreturn 0.0;\n#endif\n}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);\n#ifdef PITCH_WITH_MAP\n#ifdef PROJECTION_GLOBE_VIEW\nreturn u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );\n#else\nreturn u_matrix*( world_center+vec4(sample_offset,0,0) );\n#endif\n#else\nreturn projected_center+vec4(sample_offset,0,0);\n#endif\n}float get_sample_step() {\n#ifdef PITCH_WITH_MAP\nreturn 2.0*PI/float(NUM_SAMPLES_PER_RING);\n#else\nreturn PI/float(NUM_SAMPLES_PER_RING);\n#endif\n}void main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);\n#else \nsurface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);\n#endif\nvec4 projected_center=u_matrix*world_center;float view_scale=0.0;\n#ifdef PITCH_WITH_MAP\n#ifdef SCALE_WITH_MAP\nview_scale=1.0;\n#else\nview_scale=projected_center.w/u_camera_to_center_distance;\n#endif\n#else\n#ifdef SCALE_WITH_MAP\nview_scale=u_camera_to_center_distance;\n#else\nview_scale=projected_center.w;\n#endif\n#endif\ngl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;\n#ifdef TERRAIN\nfloat step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;\n#ifdef PITCH_WITH_MAP\nfloat cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;\n#else\nocclusion_world_center=world_center;occlusion_projected_center=projected_center;\n#endif\nfor(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);\n#else\nvisibility=1.0;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nvisibility=1.0;\n#endif\nv_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);\n#ifdef FOG\nv_fog_pos=fog_position(world_center.xyz);\n#endif\n}"),clippingMask:dr("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:dr("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef FOG\nif (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#else\npos=vec3(tilePos+extrude,elevation(tilePos));\n#endif\ngl_Position=u_matrix*vec4(pos,1);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),heatmapTexture:dr("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:dr("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}","attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:dr("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(\nmix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:dr("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;\n#endif\nvarying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;\n#ifdef PROJECTION_GLOBE_VIEW\ngl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);\n#else\ngl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);\n#endif\n}"),fill:dr("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nvec4 out_color=color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutline:dr("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutlinePattern:dr("uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillPattern:dr("uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillExtrusion:dr("varying vec4 v_color;\n#ifdef RENDER_SHADOWS\nvarying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef ZERO_ROOF_RADIUS\nvarying vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvarying highp vec3 v_normal;\n#endif\nvoid main() {\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvec3 normal=v_normal;\n#endif\nfloat z;vec4 color;\n#ifdef ZERO_ROOF_RADIUS\nz=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);\n#else\ncolor=v_color;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;\n#ifdef ZERO_ROOF_RADIUS\nconcave*=(1.0-z);\n#endif\nfloat x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;\n#endif\n#ifdef RENDER_SHADOWS\n#ifdef ZERO_ROOF_RADIUS\nnormal=mix(normal,vec3(0.0,0.0,1.0),z);\n#endif\ncolor.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec4 v_color;\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\n#endif\n#ifdef ZERO_ROOF_RADIUS\nvarying vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvarying highp vec3 v_normal;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nv_normal=normal;\n#endif\nbase=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=0.0;float c_ele;vec3 pos;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);\n#else\nh=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);\n#ifdef RENDER_SHADOWS\nv_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;\n#endif\nfloat NdotL=0.0;float colorvalue=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\ncolorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting(color,NdotL);\n#else\nv_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\n#endif\nv_color*=u_opacity;\n#ifdef ZERO_ROOF_RADIUS\nv_roof_color=vec4(0.0,0.0,0.0,1.0);\n#ifdef LIGHTING_3D_MODE\nv_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));\n#else\nfloat roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\n#endif\nv_roof_color*=u_opacity;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),fillExtrusionPattern:dr("uniform vec2 u_texsize;uniform sampler2D u_image;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nvarying float v_NdotL;\n#endif\nvarying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color,v_NdotL)*u_opacity;\n#else\nout_color=out_color*v_lighting;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec2 v_pos;varying vec4 v_lighting;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nvarying float v_NdotL;\n#endif\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=z;vec3 p;float c_ele;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);\n#else\np=vec3(pos_nx.xy,z);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0\n? pos_nx.xy\n: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\nNdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_NdotL=NdotL;\n#else\nv_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;\n#endif \n#ifdef FOG\nv_fog_pos=fog_position(p);\n#endif\n}"),hillshadePrepare:dr("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nreturn texture2D(u_image,coord).a/4.0;\n#else\nvec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;\n#endif\n}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(\n(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)\n)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(\nderiv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:dr("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef LIGHTING_3D_MODE\ngl_FragColor=apply_lighting(gl_FragColor);\n#endif\n#ifdef FOG\ngl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),line:dr("uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform sampler2D u_dash_image;varying vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform sampler2D u_gradient_image;\n#endif\nuniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nfloat linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);\n#ifdef RENDER_LINE_DASH\nfloat sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);\n#endif\nhighp vec4 out_color;\n#ifdef RENDER_LINE_GRADIENT\nout_color=texture2D(u_gradient_image,v_uv.xy);\n#else\nout_color=color;\n#endif\nfloat trimmed=1.0;\n#ifdef RENDER_LINE_TRIM_OFFSET\nhighp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}\n#endif\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\n#ifdef RENDER_LINE_ALPHA_DISCARD\nif (alpha < u_alpha_discard_threshold) {discard;}\n#endif\n#ifdef RENDER_LINE_BORDER\nfloat edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);\n#ifdef RENDER_LINE_BORDER_AUTO\nfloat Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}\n#else\nout_color.rgb=mix(u_border_color.rgb*u_border_color.a*trimmed,out_color.rgb,smoothAlpha);\n#endif\n}\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define EXTRUDE_SCALE 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nattribute highp vec4 a_packed;\n#endif\n#ifdef RENDER_LINE_DASH\nattribute float a_linesofar;\n#endif\nuniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform float u_image_height;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nfloat a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];\n#ifdef RENDER_LINE_GRADIENT\nhighp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);\n#else\nv_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);\n#endif\n#endif\n#ifdef RENDER_LINE_DASH\nfloat scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);\n#endif\nv_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),linePattern:dr("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\ncolor=apply_lighting(color);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),raster:dr("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(\ndot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply(out_color,v_fog_pos));\n#endif\ngl_FragColor=vec4(out_color*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),symbolIcon:dr("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}"),symbolSDF:dr("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nvec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}"),symbolTextAndIcon:dr("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}"),terrainRaster:dr("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nvarying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nvoid main() {vec4 color=texture2D(u_image0,v_pos0);\n#ifdef RENDER_SHADOWS\ncolor.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#else\ncolor=fog_dither(fog_apply_from_vert(color,v_fog_opacity));\n#endif\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nconst float wireframeOffset=0.00015;void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;\n#ifdef TERRAIN_WIREFRAME\nelevation+=wireframeOffset;\n#endif\nv_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\nv_fog_pos=fog_position(decodedPos);\n#else\nv_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));\n#endif\n#endif\n#ifdef RENDER_SHADOWS\nvec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;\n#endif\n}"),terrainDepth:dr("#ifdef GL_ES\nprecision highp float;\n#endif\nvarying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}","uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:dr("\nvarying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(\ncos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;\n#ifdef FOG\nsky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);\n#endif\nsky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",tr),skyboxGradient:dr("varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));\n#ifdef FOG\ncolor.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;\n#endif\ncolor*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",tr),skyboxCapture:dr("\nvarying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;\n#ifdef GL_ES\nprecision highp float;\n#endif\n#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)\n#define BETA_M                  vec3(21e-6,21e-6,21e-6)\n#define MIE_G                   0.76\n#define DENSITY_HEIGHT_SCALE_R  8000.0\n#define DENSITY_HEIGHT_SCALE_M  1200.0\n#define PLANET_RADIUS           6360e3\n#define ATMOSPHERE_RADIUS       6420e3\n#define SAMPLE_STEPS            10\n#define DENSITY_STEPS           4\nfloat ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}","attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:dr("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifndef FOG\nuniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;\n#endif\nvoid main() {vec4 color;\n#ifdef CUSTOM_ANTIALIASING\nvec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);\n#else\ncolor=texture2D(u_image0,v_pos0);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;\n#ifdef GLOBE_POLES\nattribute vec3 a_globe_pos;attribute vec2 a_uv;\n#else\nattribute vec2 a_pos;\n#endif\nvarying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {\n#ifdef GLOBE_POLES\nvec3 globe_pos=a_globe_pos;vec2 uv=a_uv;\n#else\nfloat tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);\n#endif\nv_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;\n#ifdef GLOBE_POLES\nvec3 up_vector=globe_derived_up_vector;\n#else\nvec3 up_vector=elevationVector(tile_pos);\n#endif\nfloat height=elevation(tile_pos);\n#ifdef TERRAIN_WIREFRAME\nheight+=wireframeOffset;\n#endif\nglobe_pos+=up_vector*height;\n#ifndef GLOBE_POLES\nglobe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;\n#endif\n#ifdef GLOBE_POLES\nvec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);\n#else\nvec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);\n#endif\ngl_Position=u_proj_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n}"),globeAtmosphere:dr("uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;\n#ifdef PROJECTION_GLOBE_VIEW\nglobe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}\n#endif\nhighp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?\n0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;\n#ifdef PROJECTION_GLOBE_VIEW\nhighp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?\nPI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);\n#else\nhorizon_angle=horizon_angle_mercator;\n#endif\nhorizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:\n(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:\nuv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}","attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(\nmix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}")};function fr(e,t){const r=e.replace(/\s*\/\/[^\n]*\n/g,"\n").split("\n");for(let n of r)if(n=n.trim(),"#"===n[0]&&n.includes("if")&&!n.includes("endif")){n=n.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const e=n.split(" ");for(const r of e)t.includes(r)||t.push(r)}}function dr(e,t){const r=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,n=t.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),i={},o=[...sr];return fr(e,o),fr(t,o),{fragmentSource:e=e.replace(r,((e,t,r,n,o)=>(i[o]=!0,"define"===t?`\n#ifndef HAS_UNIFORM_u_${o}\nvarying ${r} ${n} ${o};\n#else\nuniform ${r} ${n} u_${o};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${o}\n    ${r} ${n} ${o} = u_${o};\n#endif\n`))),vertexSource:t=t.replace(r,((e,t,r,n,o)=>{const a="float"===n?"vec2":"vec4",s=o.match(/color/)?"color":a;return i[o]?"define"===t?`\n#ifndef HAS_UNIFORM_u_${o}\nuniform lowp float u_${o}_t;\nattribute ${r} ${a} a_${o};\nvarying ${r} ${n} ${o};\n#else\nuniform ${r} ${n} u_${o};\n#endif\n`:"vec4"===s?`\n#ifndef HAS_UNIFORM_u_${o}\n    ${o} = a_${o};\n#else\n    ${r} ${n} ${o} = u_${o};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${o}\n    ${o} = unpack_mix_${s}(a_${o}, u_${o}_t);\n#else\n    ${r} ${n} ${o} = u_${o};\n#endif\n`:"define"===t?`\n#ifndef HAS_UNIFORM_u_${o}\nuniform lowp float u_${o}_t;\nattribute ${r} ${a} a_${o};\n#else\nuniform ${r} ${n} u_${o};\n#endif\n`:"vec4"===s?`\n#ifndef HAS_UNIFORM_u_${o}\n    ${r} ${n} ${o} = a_${o};\n#else\n    ${r} ${n} ${o} = u_${o};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${o}\n    ${r} ${n} ${o} = unpack_mix_${s}(a_${o}, u_${o}_t);\n#else\n    ${r} ${n} ${o} = u_${o};\n#endif\n`})),staticAttributes:n,usedDefines:o}}class pr{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(e,t,r,n,i,o,a){this.context=e;let s=this.boundPaintVertexBuffers.length!==n.length;for(let c=0;!s&&c<n.length;c++)this.boundPaintVertexBuffers[c]!==n[c]&&(s=!0);let u=this.boundDynamicVertexBuffers.length!==a.length;for(let c=0;!u&&c<a.length;c++)this.boundDynamicVertexBuffers[c]!==a[c]&&(u=!0);if(!e.extVertexArrayObject||!this.vao||this.boundProgram!==t||this.boundLayoutVertexBuffer!==r||s||u||this.boundIndexBuffer!==i||this.boundVertexOffset!==o)this.freshBind(t,r,n,i,o,a);else{e.bindVertexArrayOES.set(this.vao);for(const e of a)e&&e.bind();i&&i.dynamicDraw&&i.bind()}}freshBind(e,t,r,n,i,o){let a;const s=e.numAttributes,u=this.context,c=u.gl;if(u.extVertexArrayObject)this.vao&&this.destroy(),this.vao=u.extVertexArrayObject.createVertexArrayOES(),u.bindVertexArrayOES.set(this.vao),a=0,this.boundProgram=e,this.boundLayoutVertexBuffer=t,this.boundPaintVertexBuffers=r,this.boundIndexBuffer=n,this.boundVertexOffset=i,this.boundDynamicVertexBuffers=o;else{a=u.currentNumAttributes||0;for(let e=s;e<a;e++)c.disableVertexAttribArray(e)}t.enableAttributes(c,e),t.bind(),t.setVertexAttribPointers(c,e,i);for(const l of r)l.enableAttributes(c,e),l.bind(),l.setVertexAttribPointers(c,e,i);for(const l of o)l&&(l.enableAttributes(c,e),l.bind(),l.setVertexAttribPointers(c,e,i));n&&n.bind(),u.currentNumAttributes=s}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function mr(t,r){const n=Math.pow(2,r.canonical.z),i=r.canonical.y;return[new e.MercatorCoordinate(0,i/n).toLngLat().lat,new e.MercatorCoordinate(0,(i+1)/n).toLngLat().lat]}function gr(t,r,n,i,o,a,s){const u=t.context,c=u.gl,l=n.fbo;if(!l)return;t.prepareDrawTile();const h=t.useProgram("hillshade");u.activeTexture.set(c.TEXTURE0),c.bindTexture(c.TEXTURE_2D,l.colorAttachment.get());const f=((e,t,r,n)=>{const i=r.paint.get("hillshade-shadow-color"),o=r.paint.get("hillshade-highlight-color"),a=r.paint.get("hillshade-accent-color");let s=r.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===r.paint.get("hillshade-illumination-anchor")&&(s-=e.transform.angle);const u=!e.options.moving;return{u_matrix:n||e.transform.calculateProjMatrix(t.tileID.toUnwrapped(),u),u_image:0,u_latrange:mr(0,t.tileID),u_light:[r.paint.get("hillshade-exaggeration"),s],u_shadow:i,u_highlight:o,u_accent:a}})(t,n,i,t.terrain?r.projMatrix:null);t.prepareDrawProgram(u,h,r.toUnwrapped());const{tileBoundsBuffer:d,tileBoundsIndexBuffer:p,tileBoundsSegments:m}=t.getTileBoundsBuffers(n);h.draw(u,c.TRIANGLES,o,a,s,e.CullFaceMode.disabled,f,i.id,d,p,m)}function yr(t,r,n){if(!r.needsDEMTextureUpload)return;const i=t.context,o=i.gl;i.pixelStoreUnpackPremultiplyAlpha.set(!1),r.demTexture=r.demTexture||t.getTileTexture(n.stride);const a=n.getPixels();r.demTexture?r.demTexture.update(a,{premultiply:!1}):r.demTexture=new e.Texture(i,a,o.RGBA,{premultiply:!1}),r.needsDEMTextureUpload=!1}function vr(t,r,n,i,o,a){const s=t.context,u=s.gl;if(!r.dem)return;const c=r.dem;if(s.activeTexture.set(u.TEXTURE1),yr(t,r,c),!r.demTexture)return;r.demTexture.bind(u.NEAREST,u.CLAMP_TO_EDGE);const l=c.dim;s.activeTexture.set(u.TEXTURE0);let h=r.fbo;if(!h){const t=new e.Texture(s,{width:l,height:l,data:null},u.RGBA);t.bind(u.LINEAR,u.CLAMP_TO_EDGE),h=r.fbo=s.createFramebuffer(l,l,!0),h.colorAttachment.set(t.texture)}s.bindFramebuffer.set(h.framebuffer),s.viewport.set([0,0,l,l]);const{tileBoundsBuffer:f,tileBoundsIndexBuffer:d,tileBoundsSegments:p}=t.getMercatorTileBoundsBuffers();t.useProgram("hillshadePrepare").draw(s,u.TRIANGLES,i,o,a,e.CullFaceMode.disabled,((t,r)=>{const n=r.stride,i=e.create();return e.ortho(i,0,e.EXTENT,-e.EXTENT,0,0,1),e.translate(i,i,[0,-e.EXTENT,0]),{u_matrix:i,u_image:1,u_dimension:[n,n],u_zoom:t.overscaledZ,u_unpack:r.unpackVector}})(r.tileID,c),n.id,f,d,p),r.needsHillshadePrepare=!1}const _r=t=>({u_matrix:new e.UniformMatrix4f(t),u_image0:new e.Uniform1i(t),u_skirt_height:new e.Uniform1f(t)}),br=(e,t)=>({u_matrix:e,u_image0:0,u_skirt_height:t}),xr=(e,t,r,n,i,o,a,s,u,c,l,h,f,d,p)=>({u_proj_matrix:Float32Array.from(e),u_globe_matrix:t,u_normalize_matrix:Float32Array.from(n),u_merc_matrix:r,u_zoom_transition:i,u_merc_center:o,u_image0:0,u_frustum_tl:a,u_frustum_tr:s,u_frustum_br:u,u_frustum_bl:c,u_globe_pos:l,u_globe_radius:h,u_viewport:f,u_grid_matrix:p?Float32Array.from(p):new Float32Array(9),u_skirt_height:d});function wr(e,t){return null!=e&&null!=t&&!(!e.hasData()||!t.hasData())&&null!=e.demTexture&&null!=t.demTexture&&e.tileID.key!==t.tileID.key}const kr=new class{constructor(){this.operations={}}newMorphing(e,t,r,n,i){if(e in this.operations){const t=this.operations[e];t.to.tileID.key!==r.tileID.key&&(t.queued=r)}else this.operations[e]={startTime:n,phase:0,duration:i,from:t,to:r,queued:null}}getMorphValuesForProxy(e){if(!(e in this.operations))return null;const t=this.operations[e];return{from:t.from,to:t.to,phase:t.phase}}update(e){for(const t in this.operations){const r=this.operations[t];for(r.phase=(e-r.startTime)/r.duration;r.phase>=1||!this._validOp(r);)if(!this._nextOp(r,e)){delete this.operations[t];break}}}_nextOp(e,t){return!!e.queued&&(e.from=e.to,e.to=e.queued,e.queued=null,e.phase=0,e.startTime=t,!0)}_validOp(e){return e.from.hasData()&&e.to.hasData()}},Ar={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function Er(e){return 6*Math.pow(1.5,22-e)}function Sr(e,t){const r=1<<e.z;return!t&&(0===e.x||e.x===r-1)||0===e.y||e.y===r-1}const Tr=e=>({u_matrix:e});function Mr(t,r,n,i,o){if(o>0){const a=e.exported.now(),s=(a-t.timeAdded)/o,u=r?(a-r.timeAdded)/o:-1,c=n.getSource(),l=i.coveringZoomLevel({tileSize:c.tileSize,roundZoom:c.roundZoom}),h=!r||Math.abs(r.tileID.overscaledZ-l)>Math.abs(t.tileID.overscaledZ-l),f=h&&t.refreshedUponExpiration?1:e.clamp(h?s:1-u,0,1);return t.refreshedUponExpiration&&s>=1&&(t.refreshedUponExpiration=!1),r?{opacity:1,mix:1-f}:{opacity:f,mix:0}}return{opacity:1,mix:0}}class Ir extends e.SourceCache{constructor(e){const t={type:"raster-dem",maxzoom:e.transform.maxZoom},r=new B(je(),null),n=De("mock-dem",t,r,e.style);super("mock-dem",n,!1),n.setEventedParent(this),this._sourceLoaded=!0}_loadTile(e,t){e.state="loaded",t(null)}}class Pr extends e.SourceCache{constructor(e){const t=De("proxy",{type:"geojson",maxzoom:e.transform.maxZoom},new B(je(),null),e.style);super("proxy",t,!1),t.setEventedParent(this),this.map=this.getSource().map=e,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(t,r,n){if(t.freezeTileCoverage)return;this.transform=t;const i=t.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce(((r,n)=>{if(r[n.key]="",!this._tiles[n.key]){const r=new e.Tile(n,this._source.tileSize*n.overscaleFactor(),t.tileZoom);r.state="loaded",this._tiles[n.key]=r}return r}),{});for(const e in this._tiles)e in i||(this.freeFBO(e),this._tiles[e].unloadVectorData(),delete this._tiles[e])}freeFBO(e){const t=this.proxyCachedFBO[e];if(void 0!==t){const r=Object.values(t);this.renderCachePool.push(...r),delete this.proxyCachedFBO[e]}}deallocRenderCache(){this.renderCache.forEach((e=>e.fb.destroy())),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Cr extends e.OverscaledTileID{constructor(e,t,r){super(e.overscaledZ,e.wrap,e.canonical.z,e.canonical.x,e.canonical.y),this.proxyTileKey=t,this.projMatrix=r}}class Br extends e.Elevation{constructor(t,r){super(),this.painter=t,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[n,i,o]=function(t){const r=new e.StructArrayLayout2i4,n=new e.StructArrayLayout3ui6,i=131;r.reserve(17161),n.reserve(33800);const o=e.EXTENT/128,a=e.EXTENT+o/2,s=a+o;for(let c=-o;c<s;c+=o)for(let t=-o;t<s;t+=o){const n=t<0||t>a||c<0||c>a?24575:0,i=e.clamp(Math.round(t),0,e.EXTENT),o=e.clamp(Math.round(c),0,e.EXTENT);r.emplaceBack(i+n,o)}const u=(e,t)=>{const r=t*i+e;n.emplaceBack(r+1,r,r+i),n.emplaceBack(r+i,r+i+1,r+1)};for(let e=1;e<129;e++)for(let t=1;t<129;t++)u(t,e);return[0,129].forEach((e=>{for(let t=0;t<130;t++)u(t,e),u(e,t)})),[r,n,32768]}(),a=t.context;this.gridBuffer=a.createVertexBuffer(n,e.posAttributes.members),this.gridIndexBuffer=a.createIndexBuffer(i),this.gridSegments=e.SegmentVector.simpleSegment(0,0,n.length,i.length),this.gridNoSkirtSegments=e.SegmentVector.simpleSegment(0,0,n.length,o),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Pr(r.map),this.orthoMatrix=e.create(),e.ortho(this.orthoMatrix,"globe"===this.painter.transform.projection.name?.015:0,e.EXTENT,0,e.EXTENT,0,1);const s=a.gl;this._overlapStencilMode=new e.StencilMode({func:s.GEQUAL,mask:255},0,255,s.KEEP,s.KEEP,s.REPLACE),this._previousZoom=t.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=r,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Ir(r.map)}set style(e){e.on("data",this._onStyleDataEvent.bind(this)),e.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=e,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",(()=>{this._clearLineLayersFromRenderCache()}))}update(t,r,n){if(t&&t.terrain){this._style!==t&&(this.style=t),this.enabled=!0;const i=t.terrain.properties;this.sourceCache=0===t.terrain.drapeRenderMode?this._mockSourceCache:t._getSourceCache(i.get("source")),this._exaggeration=i.get("exaggeration");const o=()=>{this.sourceCache.used&&e.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.\nThis leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const t=this.getScaledDemTileSize();this.sourceCache.update(r,t,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,o(),this._initializing=!0),o(),r.updateElevation(!0,n),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(r),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(e){this._findCoveringTileCache[e]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const t=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||100!==t.efficiency&&e.warnOnce(`Terrain render cache efficiency is not optimal (${t.efficiency}%) and performance\n                may be affected negatively, consider placing all background, fill and line layers before layer\n                with id '${t.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(e){e.coord&&"source"===e.dataType?this._clearRenderCacheForTile(e.sourceCacheId,e.coord):"style"===e.dataType&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const e in this._style._sourceCaches)this._style._sourceCaches[e].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach((e=>e.fb.destroy())),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const e=2*this.proxySourceCache.getSource().tileSize;return[e,e]}set useVertexMorphing(e){this._useVertexMorphing=e}updateTileBinding(t){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const r=this.proxySourceCache,n=this.painter.transform;this._initializing&&(this._initializing=0===n._centerAltitude&&-1===this.getAtPointOrZero(e.MercatorCoordinate.fromLngLat(n.center),-1),this._emptyDEMTextureDirty=!this._initializing);const i=this.proxyCoords=r.getIds().map((e=>{const t=r.getTileByID(e).tileID;return t.projMatrix=n.calculateProjMatrix(t.toUnwrapped()),t}));!function(t,r){const n=r.transform.pointCoordinate(r.transform.getCameraPoint()),i=new e.pointGeometry(n.x,n.y);t.sort(((t,r)=>{if(r.overscaledZ-t.overscaledZ)return r.overscaledZ-t.overscaledZ;const n=new e.pointGeometry(t.canonical.x+(1<<t.canonical.z)*t.wrap,t.canonical.y),o=new e.pointGeometry(r.canonical.x+(1<<r.canonical.z)*r.wrap,r.canonical.y),a=i.mult(1<<t.canonical.z);return a.x-=.5,a.y-=.5,a.distSqr(n)-a.distSqr(o)}))}(i,this.painter),this._previousZoom=n.zoom;const o=this.proxyToSource||{};this.proxyToSource={},i.forEach((e=>{this.proxyToSource[e.key]={}})),this.terrainTileForTile={};const a=this._style._sourceCaches;for(const e in a){const r=a[e];if(!r.used)continue;if(r!==this.sourceCache&&this.resetTileLookupCache(r.id),this._setupProxiedCoordsForOrtho(r,t[e],o),r.usedForTerrain)continue;const n=t[e];r.getSource().reparseOverscaled&&this._assignTerrainTiles(n)}this.proxiedCoords[r.id]=i.map((e=>new Cr(e,e.key,this.orthoMatrix))),this._assignTerrainTiles(i),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(o),this.renderingToTexture=!1,this._updateTimestamp=e.exported.now();const s={};this._visibleDemTiles=[];for(const e of this.proxyCoords){const t=this.terrainTileForTile[e.key];if(!t)continue;const r=t.tileID.key;r in s||(this._visibleDemTiles.push(t),s[r]=r)}}_assignTerrainTiles(e){this._initializing||e.forEach((e=>{if(this.terrainTileForTile[e.key])return;const t=this._findTileCoveringTileID(e,this.sourceCache);t&&(this.terrainTileForTile[e.key]=t)}))}_prepareDEMTextures(){const e=this.painter.context,t=e.gl;for(const r in this.terrainTileForTile){const n=this.terrainTileForTile[r],i=n.dem;!i||n.demTexture&&!n.needsDEMTextureUpload||(e.activeTexture.set(t.TEXTURE1),yr(this.painter,n,i))}}_prepareDemTileUniforms(e,t,r,n){if(!t||null==t.demTexture)return!1;const i=e.tileID.canonical,o=Math.pow(2,t.tileID.canonical.z-i.z),a=n||"";return r[`u_dem_tl${a}`]=[i.x*o%1,i.y*o%1],r[`u_dem_scale${a}`]=o,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const t=this.painter.context,r=t.gl;if(!this._emptyDepthBufferTexture){const n=new e.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new e.Texture(t,n,r.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let e=0;const t=this._visibleDemTiles.reduce(((t,r)=>{if(!r.dem)return t;const n=r.dem.tree.minimums[0];return n>0&&e++,t+n}),0);return e?t/e:0}_updateEmptyDEMTexture(){const t=this.painter.context,r=t.gl;t.activeTexture.set(r.TEXTURE2);const n=this._getLoadedAreaMinimum(),i=new e.RGBAImage({width:1,height:1},new Uint8Array(e.DEMData.pack(n,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let o=this._emptyDEMTexture;return o?o.update(i,{premultiply:!1}):o=this._emptyDEMTexture=new e.Texture(t,i,r.RGBA,{premultiply:!1}),o}setupElevationDraw(t,r,n){const i=this.painter.context,o=i.gl,a=(s=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:e.DEMData.getUnpackVector(s),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var s;a.u_dem_size=this.sourceCache.getSource().tileSize,a.u_exaggeration=this.exaggeration();let u=null,c=null,l=1;if(n&&n.morphing&&this._useVertexMorphing){const e=n.morphing.srcDemTile,r=n.morphing.dstDemTile;l=n.morphing.phase,e&&r&&(this._prepareDemTileUniforms(t,e,a,"_prev")&&(c=e),this._prepareDemTileUniforms(t,r,a)&&(u=r))}if(c&&u?(i.activeTexture.set(o.TEXTURE2),u.demTexture.bind(o.NEAREST,o.CLAMP_TO_EDGE,o.NEAREST),i.activeTexture.set(o.TEXTURE4),c.demTexture.bind(o.NEAREST,o.CLAMP_TO_EDGE,o.NEAREST),a.u_dem_lerp=l):(u=this.terrainTileForTile[t.tileID.key],i.activeTexture.set(o.TEXTURE2),(this._prepareDemTileUniforms(t,u,a)?u.demTexture:this.emptyDEMTexture).bind(o.NEAREST,o.CLAMP_TO_EDGE)),i.activeTexture.set(o.TEXTURE3),n&&n.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(o.NEAREST,o.CLAMP_TO_EDGE),this._depthFBO&&(a.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(o.NEAREST,o.CLAMP_TO_EDGE),a.u_depth_size_inv=[1,1]),n&&n.useMeterToDem&&u){const t=(1<<u.tileID.canonical.z)*e.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;a.u_meter_to_dem=t}if(n&&n.labelPlaneMatrixInv&&(a.u_label_plane_matrix_inv=n.labelPlaneMatrixInv),r.setTerrainUniformValues(i,a),"globe"===this.painter.transform.projection.name){const e=this.globeUniformValues(this.painter.transform,t.tileID.canonical,n&&n.useDenormalizedUpVectorScale);r.setGlobeUniformValues(i,e)}}globeUniformValues(t,r,n){const i=t.projection;return{u_tile_tl_up:i.upVector(r,0,0),u_tile_tr_up:i.upVector(r,e.EXTENT,0),u_tile_br_up:i.upVector(r,e.EXTENT,e.EXTENT),u_tile_bl_up:i.upVector(r,0,e.EXTENT),u_tile_up_scale:n?e.globeMetersToEcef(1):i.upVectorScale(r,t.center.lat,t.worldSize).metersToTile}}renderToBackBuffer(t){const r=this.painter,n=this.painter.context;0!==t.length&&(n.bindFramebuffer.set(null),n.viewport.set([0,0,r.width,r.height]),r.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(t,r,n,i,o){if("globe"===t.transform.projection.name)!function(t,r,n,i,o){const a=t.context,s=a.gl;let u,c;const l=t.options.showTerrainWireframe?2:0,h=t.transform,f=e.globeUseCustomAntiAliasing(t,a,h),d=(e,r)=>{if(c===e)return;const n=[Ar[e],"PROJECTION_GLOBE_VIEW"];f&&n.push("CUSTOM_ANTIALIASING"),r&&n.push(Ar[l]),u=t.useProgram("globeRaster",null,n),c=e},p=t.colorModeForRenderPass(),m=new e.DepthMode(s.LEQUAL,e.DepthMode.ReadWrite,t.depthRangeFor3D);kr.update(o);const g=e.calculateGlobeMercatorMatrix(h),y=[e.mercatorXfromLng(h.center.lng),e.mercatorYfromLat(h.center.lat)],v=l?[!1,!0]:[!1],_=t.globeSharedBuffers,b=[h.width*e.exported.devicePixelRatio,h.height*e.exported.devicePixelRatio],x=Float32Array.from(h.globeMatrix),w={useDenormalizedUpVectorScale:!0};if(v.forEach((l=>{const h=t.transform,f=Er(h.zoom)*r.exaggeration();c=-1;const v=l?s.LINES:s.TRIANGLES;for(const c of i){const i=n.getTile(c),k=e.StencilMode.disabled,A=r.prevTerrainTileForTile[c.key],E=r.terrainTileForTile[c.key];wr(A,E)&&kr.newMorphing(c.key,A,E,o,250),a.activeTexture.set(s.TEXTURE0),i.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE);const S=kr.getMorphValuesForProxy(c.key),T=S?1:0;S&&e.extend$1(w,{morphing:{srcDemTile:S.from,dstDemTile:S.to,phase:e.easeCubicInOut(S.phase)}});const M=e.tileCornersToBounds(c.canonical),I=e.getLatitudinalLod(M.getCenter().lat),P=e.getGridMatrix(c.canonical,M,I,h.worldSize/h._pixelsPerMercatorPixel),C=e.globeNormalizeECEF(e.globeTileBounds(c.canonical)),B=xr(h.projMatrix,x,g,C,e.globeToMercatorTransition(h.zoom),y,h.frustumCorners.TL,h.frustumCorners.TR,h.frustumCorners.BR,h.frustumCorners.BL,h.globeCenterInViewSpace,h.globeRadius,b,f,P);if(d(T,l),r.setupElevationDraw(i,u,w),t.prepareDrawProgram(a,u,c.toUnwrapped()),_){const[r,n,i]=l?_.getWirefameBuffers(t.context,I):_.getGridBuffers(I,0!==f);u.draw(a,v,m,k,p,e.CullFaceMode.backCCW,B,"globe_raster",r,n,i)}}})),_){const o=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];f&&o.push("CUSTOM_ANTIALIASING"),u=t.useProgram("globeRaster",null,o);for(const c of i){const{x:i,y:o,z:l}=c.canonical,f=0===o,d=o===(1<<l)-1,[g,v,x,k]=_.getPoleBuffers(l);if(k&&(f||d)){const o=n.getTile(c);a.activeTexture.set(s.TEXTURE0),o.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE);let _=e.globePoleMatrixForTile(l,i,h);const A=e.globeNormalizeECEF(e.globeTileBounds(c.canonical)),E=(t,r)=>t.draw(a,s.TRIANGLES,m,e.StencilMode.disabled,p,e.CullFaceMode.disabled,xr(h.projMatrix,_,_,A,0,y,h.frustumCorners.TL,h.frustumCorners.TR,h.frustumCorners.BR,h.frustumCorners.BL,h.globeCenterInViewSpace,h.globeRadius,b,0),"globe_pole_raster",r,x,k);r.setupElevationDraw(o,u,w),t.prepareDrawProgram(a,u,c.toUnwrapped()),f&&E(u,g),d&&(_=e.scale(e.create(),_,[1,-1,1]),E(u,v))}}}}(t,r,n,i,o);else{const a=t.context,s=a.gl;let u,c;const l=t.options.showTerrainWireframe?2:0,h=(e,r)=>{if(c===e)return;const n=[Ar[e]];r&&n.push(Ar[l]),u=t.useProgram("terrainRaster",null,n),c=e},f=t.colorModeForRenderPass(),d=new e.DepthMode(s.LEQUAL,e.DepthMode.ReadWrite,t.depthRangeFor3D);kr.update(o);const p=t.transform,m=Er(p.zoom)*r.exaggeration();(l?[!1,!0]:[!1]).forEach((l=>{c=-1;const g=l?s.LINES:s.TRIANGLES,[y,v]=l?r.getWirefameBuffer():[r.gridIndexBuffer,r.gridSegments];for(const c of i){const i=n.getTile(c),_=e.StencilMode.disabled,b=r.prevTerrainTileForTile[c.key],x=r.terrainTileForTile[c.key];wr(b,x)&&kr.newMorphing(c.key,b,x,o,250),a.activeTexture.set(s.TEXTURE0),i.texture.bind(s.LINEAR,s.CLAMP_TO_EDGE,s.LINEAR_MIPMAP_NEAREST);const w=kr.getMorphValuesForProxy(c.key),k=w?1:0;let A;w&&(A={morphing:{srcDemTile:w.from,dstDemTile:w.to,phase:e.easeCubicInOut(w.phase)}});const E=br(c.projMatrix,Sr(c.canonical,p.renderWorldCopies)?m/10:m);h(k,l),r.setupElevationDraw(i,u,A),t.prepareDrawProgram(a,u,c.toUnwrapped()),u.draw(a,g,d,_,f,e.CullFaceMode.backCCW,E,"terrain_raster",r.gridBuffer,y,v)}}))}}(r,this,this.proxySourceCache,t,this._updateTimestamp),this.renderingToTexture=!0,r.gpuTimingDeferredRenderEnd(),t.splice(0,t.length))}renderBatch(t){if(0===this._drapedRenderBatches.length)return t+1;this.renderingToTexture=!0;const r=this.painter,n=this.painter.context,i=this.proxySourceCache,o=this.proxiedCoords[i.id],a=this._drapedRenderBatches.shift(),s=[],u=r.style.order;let c=0;for(const l of o){const o=i.getTileByID(l.proxyTileKey),h=i.proxyCachedFBO[l.key]?i.proxyCachedFBO[l.key][t]:void 0,f=void 0!==h?i.renderCache[h]:this.pool[c++],d=void 0!==h;if(o.texture=f.tex,d&&!f.dirty){s.push(o.tileID);continue}let p;n.bindFramebuffer.set(f.fb.framebuffer),this.renderedToTile=!1,f.dirty&&(n.clear({color:e.Color.transparent,stencil:0}),f.dirty=!1);for(let e=a.start;e<=a.end;++e){const t=r.style._layers[u[e]];if(t.isHidden(r.transform.zoom))continue;const i=r.style._getLayerSourceCache(t),o=i?this.proxyToSource[l.key][i.id]:[l];if(!o)continue;const a=o;n.viewport.set([0,0,f.fb.width,f.fb.height]),p!==(i?i.id:null)&&(this._setupStencil(f,o,t,i),p=i?i.id:null),r.renderLayer(r,i,t,a)}this.renderedToTile?(f.dirty=!0,s.push(o.tileID)):d||--c,5===c&&(c=0,this.renderToBackBuffer(s))}return this.renderToBackBuffer(s),this.renderingToTexture=!1,n.bindFramebuffer.set(null),n.viewport.set([0,0,r.width,r.height]),a.end+1}postRender(){}renderCacheEfficiency(e){const t=e.order.length;if(0===t)return{efficiency:100};let r,n=0,i=0,o=!1;for(let a=0;a<t;++a){const t=e._layers[e.order[a]];this._style.isLayerDraped(t)?(o&&++n,++i):o||(o=!0,r=t.id)}return 0===i?{efficiency:100}:{efficiency:100*(1-n/i),firstUndrapedLayer:r}}getMinElevationBelowMSL(){let e=0;return this._visibleDemTiles.filter((e=>e.dem)).forEach((t=>{e=Math.min(e,t.dem.tree.minimums[0])})),0===e?e:(e-30)*this._exaggeration}raycast(e,t,r){if(!this._visibleDemTiles)return null;const n=this._visibleDemTiles.filter((e=>e.dem)).map((n=>{const i=n.tileID,o=1<<i.overscaledZ,{x:a,y:s}=i.canonical,u=a/o,c=(a+1)/o,l=s/o,h=(s+1)/o;return{minx:u,miny:l,maxx:c,maxy:h,t:n.dem.tree.raycastRoot(u,l,c,h,e,t,r),tile:n}}));n.sort(((e,t)=>(null!==e.t?e.t:Number.MAX_VALUE)-(null!==t.t?t.t:Number.MAX_VALUE)));for(const i of n){if(null==i.t)return null;const n=i.tile.dem.tree.raycast(i.minx,i.miny,i.maxx,i.maxy,e,t,r);if(null!=n)return n}return null}_createFBO(){const t=this.painter.context,r=t.gl,n=this.drapeBufferSize;t.activeTexture.set(r.TEXTURE0);const i=new e.Texture(t,{width:n[0],height:n[1],data:null},r.RGBA);i.bind(r.LINEAR,r.CLAMP_TO_EDGE);const o=t.createFramebuffer(n[0],n[1],!1);return o.colorAttachment.set(i.texture),o.depthAttachment=new Ae(t,o.framebuffer),void 0===this._sharedDepthStencil?(this._sharedDepthStencil=t.createRenderbuffer(t.gl.DEPTH_STENCIL,n[0],n[1]),this._stencilRef=0,o.depthAttachment.set(this._sharedDepthStencil),t.clear({stencil:0})):o.depthAttachment.set(this._sharedDepthStencil),t.extTextureFilterAnisotropic&&!t.extTextureFilterAnisotropicForceOff&&r.texParameterf(r.TEXTURE_2D,t.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,t.extTextureFilterAnisotropicMax),{fb:o,tex:i,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const e in this._style._sourceCaches)if(this._style._sourceCaches[e].hasTransition())return!0;return this._style.order.some((e=>{const t=this._style._layers[e],r=t.isHidden(this.painter.transform.zoom);return"custom"===t.type?!r&&t.shouldRedrape():!r&&t.hasTransition()}))}_clearLineLayersFromRenderCache(){let t=!1;for(const e of this._style._getSources())if(e instanceof Te){t=!0;break}if(!t)return;const r={};for(let n=0;n<this._style.order.length;++n){const t=this._style._layers[this._style.order[n]],i=this._style._getLayerSourceCache(t);if(i&&!r[i.id]&&!t.isHidden(this.painter.transform.zoom)&&"line"===t.type&&t.widthExpression()instanceof e.ZoomDependentExpression){r[i.id]=!0;for(const e of this.proxyCoords){const t=this.proxyToSource[e.key][i.id];if(t)for(const e of t)this._clearRenderCacheForTile(i.id,e)}}}}_clearRasterLayersFromRenderCache(){let e=!1;for(const r in this._style._sourceCaches)if(this._style._sourceCaches[r]._source instanceof Me){e=!0;break}if(!e)return;const t={};for(let r=0;r<this._style.order.length;++r){const e=this._style._layers[this._style.order[r]],n=this._style._getLayerSourceCache(e);if(!n||t[n.id])continue;if(e.isHidden(this.painter.transform.zoom)||"raster"!==e.type)continue;const i=e.paint.get("raster-fade-duration");for(const t of this.proxyCoords){const e=this.proxyToSource[t.key][n.id];if(e)for(const t of e){const e=Mr(n.getTile(t),n.findLoadedParent(t,0),n,this.painter.transform,i);(1!==e.opacity||0!==e.mix)&&this._clearRenderCacheForTile(n.id,t)}}}}_setupDrapedRenderBatches(){const e=this._style.order,t=e.length;if(0===t)return;const r=[];let n,i=0,o=this._style._layers[e[i]];for(;!this._style.isLayerDraped(o)&&o.isHidden(this.painter.transform.zoom)&&++i<t;)o=this._style._layers[e[i]];for(;i<t;++i){const t=this._style._layers[e[i]];t.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(t)?void 0===n&&(n=i):void 0!==n&&(r.push({start:n,end:i-1}),n=void 0))}void 0!==n&&r.push({start:n,end:i-1}),this._drapedRenderBatches=r}_setupRenderCache(e){const t=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,t.renderCache.length>t.renderCachePool.length){const e=Object.values(t.proxyCachedFBO);t.proxyCachedFBO={};for(let r=0;r<e.length;++r){const n=Object.values(e[r]);t.renderCachePool.push(...n)}}return}this._clearRasterLayersFromRenderCache();const r=this.proxyCoords,n=this._tilesDirty;for(let o=r.length-1;o>=0;o--){const i=r[o];if(t.getTileByID(i.key),void 0!==t.proxyCachedFBO[i.key]){const r=e[i.key],o=this.proxyToSource[i.key];let a=0;for(const e in o){const t=o[e],i=r[e];if(!i||i.length!==t.length||t.some(((t,r)=>t!==i[r]||n[e]&&n[e].hasOwnProperty(t.key)))){a=-1;break}++a}for(const e in t.proxyCachedFBO[i.key])t.renderCache[t.proxyCachedFBO[i.key][e]].dirty=a<0||a!==Object.values(r).length}}const i=[...this._drapedRenderBatches];i.sort(((e,t)=>t.end-t.start-(e.end-e.start)));for(const o of i)for(const e of r){if(t.proxyCachedFBO[e.key])continue;let r=t.renderCachePool.pop();void 0===r&&t.renderCache.length<50&&(r=t.renderCache.length,t.renderCache.push(this._createFBO())),void 0!==r&&(t.proxyCachedFBO[e.key]={},t.proxyCachedFBO[e.key][o.start]=r,t.renderCache[r].dirty=!0)}this._tilesDirty={}}_setupStencil(e,t,r,n){if(!n||!this._sourceTilesOverlap[n.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const i=this.painter.context,o=i.gl;if(t.length<=1)return void(this._overlapStencilType=!1);let a;if(r.isTileClipped())a=t.length,this._overlapStencilMode.test={func:o.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(t[0].overscaledZ>t[t.length-1].overscaledZ))return void(this._overlapStencilType=!1);a=1,this._overlapStencilMode.test={func:o.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+a>255&&(i.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=a,this._overlapStencilMode.ref=this._stencilRef,r.isTileClipped()&&this._renderTileClippingMasks(t,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return"Clip"===this._overlapStencilType||"Mask"===this._overlapStencilType}stencilModeForRTTOverlap(t){return this.renderingToTexture&&this._overlapStencilType?("Clip"===this._overlapStencilType&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[t.key]),this._overlapStencilMode):e.StencilMode.disabled}_renderTileClippingMasks(t,r){const n=this.painter,i=this.painter.context,o=i.gl;n._tileClippingMaskIDs={},i.setColorMode(e.ColorMode.disabled),i.setDepthMode(e.DepthMode.disabled);const a=n.useProgram("clippingMask");for(const s of t){const t=n._tileClippingMaskIDs[s.key]=--r;a.draw(i,o.TRIANGLES,e.DepthMode.disabled,new e.StencilMode({func:o.ALWAYS,mask:0},t,255,o.KEEP,o.KEEP,o.REPLACE),e.ColorMode.disabled,e.CullFaceMode.disabled,Tr(s.projMatrix),"$clipping",n.tileExtentBuffer,n.quadTriangleIndexBuffer,n.tileExtentSegments)}}pointCoordinate(t){const r=this.painter.transform;if(t.x<0||t.x>r.width||t.y<0||t.y>r.height)return null;const n=[t.x,t.y,1,1];e.transformMat4$1(n,n,r.pixelMatrixInverse),e.scale$1(n,n,1/n[3]),n[0]/=r.worldSize,n[1]/=r.worldSize;const i=r._camera.position,o=e.mercatorZfromAltitude(1,r.center.lat),a=[i[0],i[1],i[2]/o,0],s=e.subtract([],n.slice(0,3),a);e.normalize(s,s);const u=this.raycast(a,s,this._exaggeration);return null!==u&&u?(e.scaleAndAdd(a,a,s,u),a[3]=a[2],a[2]*=o,a):null}drawDepth(){const t=this.painter,r=t.context,n=this.proxySourceCache,i=Math.ceil(t.width),o=Math.ceil(t.height);if(!this._depthFBO||this._depthFBO.width===i&&this._depthFBO.height===o||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const t=r.gl,n=r.createFramebuffer(i,o,!0);r.activeTexture.set(t.TEXTURE0);const a=new e.Texture(r,{width:i,height:o,data:null},t.RGBA);a.bind(t.NEAREST,t.CLAMP_TO_EDGE),n.colorAttachment.set(a.texture);const s=r.createRenderbuffer(r.gl.DEPTH_COMPONENT16,i,o);n.depthAttachment.set(s),this._depthFBO=n,this._depthTexture=a}r.bindFramebuffer.set(this._depthFBO.framebuffer),r.viewport.set([0,0,i,o]),function(t,r,n,i){if("globe"===t.transform.projection.name)return;const o=t.context,a=o.gl;o.clear({depth:1});const s=t.useProgram("terrainDepth"),u=new e.DepthMode(a.LESS,e.DepthMode.ReadWrite,t.depthRangeFor3D);for(const c of i){const t=n.getTile(c),i=br(c.projMatrix,0);r.setupElevationDraw(t,s),s.draw(o,a.TRIANGLES,u,e.StencilMode.disabled,e.ColorMode.unblended,e.CullFaceMode.backCCW,i,"terrain_depth",r.gridBuffer,r.gridIndexBuffer,r.gridNoSkirtSegments)}}(t,this,n,this.proxyCoords)}_setupProxiedCoordsForOrtho(e,t,r){if(e.getSource()instanceof Ce)return this._setupProxiedCoordsForImageSource(e,t,r);this._findCoveringTileCache[e.id]=this._findCoveringTileCache[e.id]||{};const n=this.proxiedCoords[e.id]=[],i=this.proxyCoords;for(let a=0;a<i.length;a++){const t=i[a],o=this._findTileCoveringTileID(t,e);if(o){const i=this._createProxiedId(t,o,r[t.key]&&r[t.key][e.id]);n.push(i),this.proxyToSource[t.key][e.id]=[i]}}let o=!1;for(let a=0;a<t.length;a++){const i=e.getTile(t[a]);if(!i||!i.hasData())continue;const s=this._findTileCoveringTileID(i.tileID,this.proxySourceCache);if(s&&s.tileID.canonical.z!==i.tileID.canonical.z){const t=this.proxyToSource[s.tileID.key][e.id],a=this._createProxiedId(s.tileID,i,r[s.tileID.key]&&r[s.tileID.key][e.id]);t?t.splice(t.length-1,0,a):this.proxyToSource[s.tileID.key][e.id]=[a],n.push(a),o=!0}}this._sourceTilesOverlap[e.id]=o}_setupProxiedCoordsForImageSource(t,r,n){if(!t.getSource().loaded())return;const i=this.proxiedCoords[t.id]=[],o=this.proxyCoords,a=t.getSource(),s=new e.pointGeometry(a.tileID.x,a.tileID.y)._div(1<<a.tileID.z),u=a.coordinates.map(e.MercatorCoordinate.fromLngLat).reduce(((e,t)=>(e.min.x=Math.min(e.min.x,t.x-s.x),e.min.y=Math.min(e.min.y,t.y-s.y),e.max.x=Math.max(e.max.x,t.x-s.x),e.max.y=Math.max(e.max.y,t.y-s.y),e)),{min:new e.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE),max:new e.pointGeometry(-Number.MAX_VALUE,-Number.MAX_VALUE)}),c=(t,r)=>{const n=t.wrap+t.canonical.x/(1<<t.canonical.z),i=t.canonical.y/(1<<t.canonical.z),o=e.EXTENT/(1<<t.canonical.z),a=r.wrap+r.canonical.x/(1<<r.canonical.z),s=r.canonical.y/(1<<r.canonical.z);return n+o<a+u.min.x||n>a+u.max.x||i+o<s+u.min.y||i>s+u.max.y};for(let e=0;e<o.length;e++){const a=o[e];for(let e=0;e<r.length;e++){const o=t.getTile(r[e]);if(!o||!o.hasData())continue;if(c(a,o.tileID))continue;const s=this._createProxiedId(a,o,n[a.key]&&n[a.key][t.id]),u=this.proxyToSource[a.key][t.id];u?u.push(s):this.proxyToSource[a.key][t.id]=[s],i.push(s)}}}_createProxiedId(t,r,n){let i=this.orthoMatrix;if(n){const e=n.find((e=>e.key===r.tileID.key));if(e)return e}if(r.tileID.key!==t.key){const n=t.canonical.z-r.tileID.canonical.z;let o,a,s;i=e.create();const u=r.tileID.wrap-t.wrap<<t.overscaledZ;n>0?(o=e.EXTENT>>n,a=o*((r.tileID.canonical.x<<n)-t.canonical.x+u),s=o*((r.tileID.canonical.y<<n)-t.canonical.y)):(o=e.EXTENT<<-n,a=e.EXTENT*(r.tileID.canonical.x-(t.canonical.x+u<<-n)),s=e.EXTENT*(r.tileID.canonical.y-(t.canonical.y<<-n))),e.ortho(i,0,o,0,o,0,1),e.translate(i,i,[a,s,0])}return new Cr(r.tileID,t.key,i)}_findTileCoveringTileID(t,r){let n=r.getTile(t);if(n&&n.hasData())return n;const i=this._findCoveringTileCache[r.id],o=i[t.key];if(n=o?r.getTileByID(o):null,n&&n.hasData()||null===o)return n;let a=n?n.tileID:t,s=a.overscaledZ;const u=r.getSource().minzoom,c=[];if(!o){const i=r.getSource().maxzoom;if(t.canonical.z>=i){const n=t.canonical.z-i;r.getSource().reparseOverscaled?(s=Math.max(t.canonical.z+2,r.transform.tileZoom),a=new e.OverscaledTileID(s,t.wrap,i,t.canonical.x>>n,t.canonical.y>>n)):0!==n&&(s=i,a=new e.OverscaledTileID(s,t.wrap,i,t.canonical.x>>n,t.canonical.y>>n))}a.key!==t.key&&(c.push(a.key),n=r.getTile(a))}const l=e=>{c.forEach((t=>{i[t]=e})),c.length=0};for(s-=1;s>=u&&(!n||!n.hasData());s--){n&&l(n.tileID.key);const e=a.calculateScaledKey(s);if(n=r.getTileByID(e),n&&n.hasData())break;const t=i[e];if(null===t)break;void 0===t?c.push(e):n=r.getTileByID(t)}return l(n?n.tileID.key:null),n&&n.hasData()?n:null}findDEMTileFor(e){return this.enabled?this._findTileCoveringTileID(e,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(e,t){let r=this._tilesDirty[e];r||(r=this._tilesDirty[e]={}),r[t.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const t=function(t){let r=0;const n=new e.StructArrayLayout2ui4,i=131;for(let e=1;e<129;e++){for(let t=1;t<129;t++)r=e*i+t,n.emplaceBack(r,r+1),n.emplaceBack(r,r+i),n.emplaceBack(r+1,r+i),128===e&&n.emplaceBack(r+i,r+i+1);n.emplaceBack(r+1,r+1+i)}return n}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(t),this.wireframeSegments=e.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,t.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class Dr{static cacheKey(e,t,r,n){let i=`${t}${n?n.cacheKey:""}`;for(const o of r)e.usedDefines.includes(o)&&(i+=`/${o}`);return i}constructor(t,r,n,i,o,a){const s=t.gl;this.program=s.createProgram();const u=function(e){const t=[];for(let r=0;r<e.length;r++){if(null===e[r])continue;const n=e[r].split(" ");t.push(n.pop())}return t}(n.staticAttributes),c=i?i.getBinderAttributes():[],l=u.concat(c);let h=i?i.defines():[];h=h.concat(a.map((e=>`#define ${e}`)));const f=t.isWebGL2?"#version 300 es\n":"",d=f+h.concat(t.extStandardDerivatives&&0===f.length?"#extension GL_OES_standard_derivatives : enable\n".concat(lr):lr,lr,cr,ur.fragmentSource,ar.fragmentSource,n.fragmentSource).join("\n"),p=f+h.concat("\n#ifdef GL_ES\nprecision highp float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif",cr,ur.vertexSource,ar.vertexSource,or.vertexSource,n.vertexSource).join("\n"),m=s.createShader(s.FRAGMENT_SHADER);if(s.isContextLost())return void(this.failedToCreate=!0);s.shaderSource(m,d),s.compileShader(m),s.attachShader(this.program,m);const g=s.createShader(s.VERTEX_SHADER);if(s.isContextLost())this.failedToCreate=!0;else{s.shaderSource(g,p),s.compileShader(g),s.attachShader(this.program,g),this.attributes={},this.numAttributes=l.length;for(let e=0;e<this.numAttributes;e++)l[e]&&(s.bindAttribLocation(this.program,e,l[e]),this.attributes[l[e]]=e);s.linkProgram(this.program),s.deleteShader(g),s.deleteShader(m),this.fixedUniforms=o(t),this.binderUniforms=i?i.getUniforms(t):[],a.includes("TERRAIN")&&(this.terrainUniforms=(t=>({u_dem:new e.Uniform1i(t),u_dem_prev:new e.Uniform1i(t),u_dem_unpack:new e.Uniform4f(t),u_dem_tl:new e.Uniform2f(t),u_dem_scale:new e.Uniform1f(t),u_dem_tl_prev:new e.Uniform2f(t),u_dem_scale_prev:new e.Uniform1f(t),u_dem_size:new e.Uniform1f(t),u_dem_lerp:new e.Uniform1f(t),u_exaggeration:new e.Uniform1f(t),u_depth:new e.Uniform1i(t),u_depth_size_inv:new e.Uniform2f(t),u_meter_to_dem:new e.Uniform1f(t),u_label_plane_matrix_inv:new e.UniformMatrix4f(t)}))(t)),a.includes("GLOBE")&&(this.globeUniforms=(t=>({u_tile_tl_up:new e.Uniform3f(t),u_tile_tr_up:new e.Uniform3f(t),u_tile_br_up:new e.Uniform3f(t),u_tile_bl_up:new e.Uniform3f(t),u_tile_up_scale:new e.Uniform1f(t)}))(t)),a.includes("FOG")&&(this.fogUniforms=(t=>({u_fog_matrix:new e.UniformMatrix4f(t),u_fog_range:new e.Uniform2f(t),u_fog_color:new e.Uniform4f(t),u_fog_horizon_blend:new e.Uniform1f(t),u_fog_temporal_offset:new e.Uniform1f(t),u_frustum_tl:new e.Uniform3f(t),u_frustum_tr:new e.Uniform3f(t),u_frustum_br:new e.Uniform3f(t),u_frustum_bl:new e.Uniform3f(t),u_globe_pos:new e.Uniform3f(t),u_globe_radius:new e.Uniform1f(t),u_globe_transition:new e.Uniform1f(t),u_is_globe:new e.Uniform1i(t),u_viewport:new e.Uniform2f(t)}))(t))}}setTerrainUniformValues(e,t){if(!this.terrainUniforms)return;const r=this.terrainUniforms;if(!this.failedToCreate){e.program.set(this.program);for(const e in t)r[e]&&r[e].set(this.program,e,t[e])}}setGlobeUniformValues(e,t){if(!this.globeUniforms)return;const r=this.globeUniforms;if(!this.failedToCreate){e.program.set(this.program);for(const e in t)r[e]&&r[e].set(this.program,e,t[e])}}setFogUniformValues(e,t){if(!this.fogUniforms)return;const r=this.fogUniforms;if(!this.failedToCreate){e.program.set(this.program);for(const e in t)r[e].set(this.program,e,t[e])}}draw(e,t,r,n,i,o,a,s,u,c,l,h,f,d,p){const m=e.gl;if(this.failedToCreate)return;e.program.set(this.program),e.setDepthMode(r),e.setStencilMode(n),e.setColorMode(i),e.setCullFace(o);for(const y of Object.keys(this.fixedUniforms))this.fixedUniforms[y].set(this.program,y,a[y]);d&&d.setUniforms(this.program,e,this.binderUniforms,h,{zoom:f});const g={[m.LINES]:2,[m.TRIANGLES]:3,[m.LINE_STRIP]:1}[t];for(const y of l.get()){const r=y.vaos||(y.vaos={});(r[s]||(r[s]=new pr)).bind(e,this,u,d?d.getPaintVertexBuffers():[],c,y.vertexOffset,p||[]),m.drawElements(t,y.primitiveLength*g,m.UNSIGNED_SHORT,y.primitiveOffset*g*2)}}}function Rr(e,t){const r=Math.pow(2,t.tileID.overscaledZ),n=t.tileSize*Math.pow(2,e.transform.tileZoom)/r,i=n*(t.tileID.canonical.x+t.tileID.wrap*r),o=n*t.tileID.canonical.y;return{u_image:0,u_texsize:t.imageAtlasTexture.size,u_tile_units_to_pixels:1/D(t,1,e.transform.tileZoom),u_pixel_coord_upper:[i>>16,o>>16],u_pixel_coord_lower:[65535&i,65535&o]}}const Lr=e.create(),Or=(t,r,n,i,o,a,s,u,c,l,h)=>{const f=r.style.light,d=f.properties.get("position"),p=[d.x,d.y,d.z],m=e.create$1();"viewport"===f.properties.get("anchor")&&(e.fromRotation(m,-r.transform.angle),e.transformMat3(p,p,m));const g=f.properties.get("color"),y=r.transform,v={u_matrix:t,u_lightpos:p,u_lightintensity:f.properties.get("intensity"),u_lightcolor:[g.r,g.g,g.b],u_vertical_gradient:+n,u_opacity:i,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Lr,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:o,u_edge_radius:a};return"globe"===y.projection.name&&(v.u_tile_id=[s.canonical.x,s.canonical.y,1<<s.canonical.z],v.u_zoom_transition=c,v.u_inv_rot_matrix=h,v.u_merc_center=l,v.u_up_dir=y.projection.upVector(new e.CanonicalTileID(0,0,0),l[0]*e.EXTENT,l[1]*e.EXTENT),v.u_height_lift=u),v},zr=(t,r,n,i,o,a,s,u,c,l,h,f)=>{const d=Or(t,r,n,i,o,a,s,c,l,h,f),p={u_height_factor:-Math.pow(2,s.overscaledZ)/u.tileSize/8};return e.extend(d,Rr(r,u),p)},Nr=e=>({u_matrix:e}),Ur=(t,r,n)=>e.extend(Nr(t),Rr(r,n)),Zr=(e,t)=>({u_matrix:e,u_world:t}),Fr=(t,r,n,i)=>e.extend(Ur(t,r,n),{u_world:i}),jr=e.create(),Vr=(t,r,n,i,o,a)=>{const s=t.transform,u="globe"===s.projection.name;let c;if("map"===a.paint.get("circle-pitch-alignment"))if(u){const t=e.globePixelsToTileUnits(s.zoom,r.canonical)*s._pixelsPerMercatorPixel;c=Float32Array.from([t,0,0,t])}else c=s.calculatePixelsToTileUnitsMatrix(n);else c=new Float32Array([s.pixelsToGLUnits[0],0,0,s.pixelsToGLUnits[1]]);const l={u_camera_to_center_distance:s.cameraToCenterDistance,u_matrix:t.translatePosMatrix(r.projMatrix,n,a.paint.get("circle-translate"),a.paint.get("circle-translate-anchor")),u_device_pixel_ratio:e.exported.devicePixelRatio,u_extrude_scale:c,u_inv_rot_matrix:jr,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(u){l.u_inv_rot_matrix=i,l.u_merc_center=o,l.u_tile_id=[r.canonical.x,r.canonical.y,1<<r.canonical.z],l.u_zoom_transition=e.globeToMercatorTransition(s.zoom);const t=o[0]*e.EXTENT,n=o[1]*e.EXTENT;l.u_up_dir=s.projection.upVector(new e.CanonicalTileID(0,0,0),t,n)}return l},Wr=e=>{const t=[];return"map"===e.paint.get("circle-pitch-alignment")&&t.push("PITCH_WITH_MAP"),"map"===e.paint.get("circle-pitch-scale")&&t.push("SCALE_WITH_MAP"),t},Kr=(t,r,n,i)=>{const o=e.EXTENT/n.tileSize;return{u_matrix:t,u_camera_to_center_distance:r.getCameraToCenterDistance(i),u_extrude_scale:[r.pixelsToGLUnits[0]/o,r.pixelsToGLUnits[1]/o]}},Gr=(e,t,r=1)=>({u_matrix:e,u_color:t,u_overlay:0,u_overlay_scale:r}),Hr=e.create(),qr=(t,r,n,i,o,a,s)=>{const u=t.transform,c="globe"===u.projection.name,l=c?e.globePixelsToTileUnits(u.zoom,r.canonical)*u._pixelsPerMercatorPixel:D(n,1,a),h={u_matrix:r.projMatrix,u_extrude_scale:l,u_intensity:s,u_inv_rot_matrix:Hr,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(c){h.u_inv_rot_matrix=i,h.u_merc_center=o,h.u_tile_id=[r.canonical.x,r.canonical.y,1<<r.canonical.z],h.u_zoom_transition=e.globeToMercatorTransition(u.zoom);const t=o[0]*e.EXTENT,n=o[1]*e.EXTENT;h.u_up_dir=u.projection.upVector(new e.CanonicalTileID(0,0,0),t,n)}return h},Yr=(e,t,r,n,i,o,a)=>{const s=e.transform,u=s.calculatePixelsToTileUnitsMatrix(t);return{u_matrix:$r(e,t,r,n),u_pixels_to_tile_units:u,u_device_pixel_ratio:o,u_units_to_pixels:[1/s.pixelsToGLUnits[0],1/s.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:i,u_texsize:Jr(r)?t.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:Qr(t,e.transform),u_alpha_discard_threshold:0,u_trim_offset:a}},Xr=(e,t,r,n,i)=>{const o=e.transform;return{u_matrix:$r(e,t,r,n),u_texsize:t.imageAtlasTexture.size,u_pixels_to_tile_units:o.calculatePixelsToTileUnitsMatrix(t),u_device_pixel_ratio:i,u_image:0,u_tile_units_to_pixels:Qr(t,o),u_units_to_pixels:[1/o.pixelsToGLUnits[0],1/o.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function Qr(e,t){return 1/D(e,1,t.tileZoom)}function $r(e,t,r,n){return e.translatePosMatrix(n||t.tileID.projMatrix,t,r.paint.get("line-translate"),r.paint.get("line-translate-anchor"))}function Jr(e){const t=e.paint.get("line-dasharray").value;return t.value||"constant"!==t.kind}const en=(e,t,r,n,i,o)=>{return{u_matrix:e,u_tl_parent:t,u_scale_parent:r,u_fade_t:n.mix,u_opacity:n.opacity*i.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:i.paint.get("raster-brightness-min"),u_brightness_high:i.paint.get("raster-brightness-max"),u_saturation_factor:(s=i.paint.get("raster-saturation"),s>0?1-1/(1.001-s):-s),u_contrast_factor:(a=i.paint.get("raster-contrast"),a>0?1/(1-a):1+a),u_spin_weights:tn(i.paint.get("raster-hue-rotate")),u_perspective_transform:o};var a,s};function tn(e){e*=Math.PI/180;const t=Math.sin(e),r=Math.cos(e);return[(2*r+1)/3,(-Math.sqrt(3)*t-r+1)/3,(Math.sqrt(3)*t-r+1)/3]}const rn=e.create(),nn=(t,r,n,i,o,a,s,u,c,l,h,f,d,p,m,g)=>{const y=o.transform,v={u_is_size_zoom_constant:+("constant"===t||"source"===t),u_is_size_feature_constant:+("constant"===t||"camera"===t),u_size_t:r?r.uSizeT:0,u_size:r?r.uSize:0,u_camera_to_center_distance:y.cameraToCenterDistance,u_rotate_symbol:+n,u_aspect_ratio:y.width/y.height,u_fade_change:o.options.fadeDuration?o.symbolFadeChange:1,u_matrix:a,u_label_plane_matrix:s,u_coord_matrix:u,u_is_text:+c,u_pitch_with_map:+i,u_texsize:l,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:rn,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:rn,u_up_vector:[0,-1,0]};return"globe"===g.name&&(v.u_tile_id=[h.canonical.x,h.canonical.y,1<<h.canonical.z],v.u_zoom_transition=f,v.u_inv_rot_matrix=p,v.u_merc_center=d,v.u_camera_forward=y._camera.forward(),v.u_ecef_origin=e.globeECEFOrigin(y.globeMatrix,h.toUnwrapped()),v.u_tile_matrix=Float32Array.from(y.globeMatrix),v.u_up_vector=m),v},on=(t,r,n,i,o,a,s,u,c,l,h,f,d,p,m,g,y)=>e.extend(nn(t,r,n,i,o,a,s,u,c,l,f,d,p,m,g,y),{u_gamma_scale:i?o.transform.cameraToCenterDistance*Math.cos(o.terrain?0:o.transform._pitch):1,u_device_pixel_ratio:e.exported.devicePixelRatio,u_is_halo:+h}),an=(t,r,n,i,o,a,s,u,c,l,h,f,d,p,m,g)=>e.extend(on(t,r,n,i,o,a,s,u,!0,c,!0,h,f,d,p,m,g),{u_texsize_icon:l,u_texture_icon:1}),sn=(e,t,r)=>({u_matrix:e,u_opacity:t,u_color:r}),un=(t,r,n,i,o)=>e.extend(function(e,t,r){const n=t.imageManager.getPattern(e.toString()),{width:i,height:o}=t.imageManager.getPixelSize(),a=Math.pow(2,r.tileID.overscaledZ),s=r.tileSize*Math.pow(2,t.transform.tileZoom)/a,u=s*(r.tileID.canonical.x+r.tileID.wrap*a),c=s*r.tileID.canonical.y;return{u_image:0,u_pattern_tl:n.tl,u_pattern_br:n.br,u_texsize:[i,o],u_pattern_size:n.displaySize,u_tile_units_to_pixels:1/D(r,1,t.transform.tileZoom),u_pixel_coord_upper:[u>>16,c>>16],u_pixel_coord_lower:[65535&u,65535&c]}}(i,n,o),{u_matrix:t,u_opacity:r}),cn={fillExtrusion:t=>({u_matrix:new e.UniformMatrix4f(t),u_lightpos:new e.Uniform3f(t),u_lightintensity:new e.Uniform1f(t),u_lightcolor:new e.Uniform3f(t),u_vertical_gradient:new e.Uniform1f(t),u_opacity:new e.Uniform1f(t),u_edge_radius:new e.Uniform1f(t),u_ao:new e.Uniform2f(t),u_tile_id:new e.Uniform3f(t),u_zoom_transition:new e.Uniform1f(t),u_inv_rot_matrix:new e.UniformMatrix4f(t),u_merc_center:new e.Uniform2f(t),u_up_dir:new e.Uniform3f(t),u_height_lift:new e.Uniform1f(t)}),fillExtrusionPattern:t=>({u_matrix:new e.UniformMatrix4f(t),u_lightpos:new e.Uniform3f(t),u_lightintensity:new e.Uniform1f(t),u_lightcolor:new e.Uniform3f(t),u_vertical_gradient:new e.Uniform1f(t),u_height_factor:new e.Uniform1f(t),u_edge_radius:new e.Uniform1f(t),u_ao:new e.Uniform2f(t),u_tile_id:new e.Uniform3f(t),u_zoom_transition:new e.Uniform1f(t),u_inv_rot_matrix:new e.UniformMatrix4f(t),u_merc_center:new e.Uniform2f(t),u_up_dir:new e.Uniform3f(t),u_height_lift:new e.Uniform1f(t),u_image:new e.Uniform1i(t),u_texsize:new e.Uniform2f(t),u_pixel_coord_upper:new e.Uniform2f(t),u_pixel_coord_lower:new e.Uniform2f(t),u_tile_units_to_pixels:new e.Uniform1f(t),u_opacity:new e.Uniform1f(t)}),fill:t=>({u_matrix:new e.UniformMatrix4f(t)}),fillPattern:t=>({u_matrix:new e.UniformMatrix4f(t),u_image:new e.Uniform1i(t),u_texsize:new e.Uniform2f(t),u_pixel_coord_upper:new e.Uniform2f(t),u_pixel_coord_lower:new e.Uniform2f(t),u_tile_units_to_pixels:new e.Uniform1f(t)}),fillOutline:t=>({u_matrix:new e.UniformMatrix4f(t),u_world:new e.Uniform2f(t)}),fillOutlinePattern:t=>({u_matrix:new e.UniformMatrix4f(t),u_world:new e.Uniform2f(t),u_image:new e.Uniform1i(t),u_texsize:new e.Uniform2f(t),u_pixel_coord_upper:new e.Uniform2f(t),u_pixel_coord_lower:new e.Uniform2f(t),u_tile_units_to_pixels:new e.Uniform1f(t)}),circle:t=>({u_camera_to_center_distance:new e.Uniform1f(t),u_extrude_scale:new e.UniformMatrix2f(t),u_device_pixel_ratio:new e.Uniform1f(t),u_matrix:new e.UniformMatrix4f(t),u_inv_rot_matrix:new e.UniformMatrix4f(t),u_merc_center:new e.Uniform2f(t),u_tile_id:new e.Uniform3f(t),u_zoom_transition:new e.Uniform1f(t),u_up_dir:new e.Uniform3f(t)}),collisionBox:t=>({u_matrix:new e.UniformMatrix4f(t),u_camera_to_center_distance:new e.Uniform1f(t),u_extrude_scale:new e.Uniform2f(t)}),collisionCircle:t=>({u_matrix:new e.UniformMatrix4f(t),u_inv_matrix:new e.UniformMatrix4f(t),u_camera_to_center_distance:new e.Uniform1f(t),u_viewport_size:new e.Uniform2f(t)}),debug:t=>({u_color:new e.UniformColor(t),u_matrix:new e.UniformMatrix4f(t),u_overlay:new e.Uniform1i(t),u_overlay_scale:new e.Uniform1f(t)}),clippingMask:t=>({u_matrix:new e.UniformMatrix4f(t)}),heatmap:t=>({u_extrude_scale:new e.Uniform1f(t),u_intensity:new e.Uniform1f(t),u_matrix:new e.UniformMatrix4f(t),u_inv_rot_matrix:new e.UniformMatrix4f(t),u_merc_center:new e.Uniform2f(t),u_tile_id:new e.Uniform3f(t),u_zoom_transition:new e.Uniform1f(t),u_up_dir:new e.Uniform3f(t)}),heatmapTexture:t=>({u_image:new e.Uniform1i(t),u_color_ramp:new e.Uniform1i(t),u_opacity:new e.Uniform1f(t)}),hillshade:t=>({u_matrix:new e.UniformMatrix4f(t),u_image:new e.Uniform1i(t),u_latrange:new e.Uniform2f(t),u_light:new e.Uniform2f(t),u_shadow:new e.UniformColor(t),u_highlight:new e.UniformColor(t),u_accent:new e.UniformColor(t)}),hillshadePrepare:t=>({u_matrix:new e.UniformMatrix4f(t),u_image:new e.Uniform1i(t),u_dimension:new e.Uniform2f(t),u_zoom:new e.Uniform1f(t),u_unpack:new e.Uniform4f(t)}),line:t=>({u_matrix:new e.UniformMatrix4f(t),u_pixels_to_tile_units:new e.UniformMatrix2f(t),u_device_pixel_ratio:new e.Uniform1f(t),u_units_to_pixels:new e.Uniform2f(t),u_dash_image:new e.Uniform1i(t),u_gradient_image:new e.Uniform1i(t),u_image_height:new e.Uniform1f(t),u_texsize:new e.Uniform2f(t),u_tile_units_to_pixels:new e.Uniform1f(t),u_alpha_discard_threshold:new e.Uniform1f(t),u_trim_offset:new e.Uniform2f(t)}),linePattern:t=>({u_matrix:new e.UniformMatrix4f(t),u_texsize:new e.Uniform2f(t),u_pixels_to_tile_units:new e.UniformMatrix2f(t),u_device_pixel_ratio:new e.Uniform1f(t),u_image:new e.Uniform1i(t),u_units_to_pixels:new e.Uniform2f(t),u_tile_units_to_pixels:new e.Uniform1f(t),u_alpha_discard_threshold:new e.Uniform1f(t)}),raster:t=>({u_matrix:new e.UniformMatrix4f(t),u_tl_parent:new e.Uniform2f(t),u_scale_parent:new e.Uniform1f(t),u_fade_t:new e.Uniform1f(t),u_opacity:new e.Uniform1f(t),u_image0:new e.Uniform1i(t),u_image1:new e.Uniform1i(t),u_brightness_low:new e.Uniform1f(t),u_brightness_high:new e.Uniform1f(t),u_saturation_factor:new e.Uniform1f(t),u_contrast_factor:new e.Uniform1f(t),u_spin_weights:new e.Uniform3f(t),u_perspective_transform:new e.Uniform2f(t)}),symbolIcon:t=>({u_is_size_zoom_constant:new e.Uniform1i(t),u_is_size_feature_constant:new e.Uniform1i(t),u_size_t:new e.Uniform1f(t),u_size:new e.Uniform1f(t),u_camera_to_center_distance:new e.Uniform1f(t),u_rotate_symbol:new e.Uniform1i(t),u_aspect_ratio:new e.Uniform1f(t),u_fade_change:new e.Uniform1f(t),u_matrix:new e.UniformMatrix4f(t),u_label_plane_matrix:new e.UniformMatrix4f(t),u_coord_matrix:new e.UniformMatrix4f(t),u_is_text:new e.Uniform1i(t),u_pitch_with_map:new e.Uniform1i(t),u_texsize:new e.Uniform2f(t),u_tile_id:new e.Uniform3f(t),u_zoom_transition:new e.Uniform1f(t),u_inv_rot_matrix:new e.UniformMatrix4f(t),u_merc_center:new e.Uniform2f(t),u_camera_forward:new e.Uniform3f(t),u_tile_matrix:new e.UniformMatrix4f(t),u_up_vector:new e.Uniform3f(t),u_ecef_origin:new e.Uniform3f(t),u_texture:new e.Uniform1i(t)}),symbolSDF:t=>({u_is_size_zoom_constant:new e.Uniform1i(t),u_is_size_feature_constant:new e.Uniform1i(t),u_size_t:new e.Uniform1f(t),u_size:new e.Uniform1f(t),u_camera_to_center_distance:new e.Uniform1f(t),u_rotate_symbol:new e.Uniform1i(t),u_aspect_ratio:new e.Uniform1f(t),u_fade_change:new e.Uniform1f(t),u_matrix:new e.UniformMatrix4f(t),u_label_plane_matrix:new e.UniformMatrix4f(t),u_coord_matrix:new e.UniformMatrix4f(t),u_is_text:new e.Uniform1i(t),u_pitch_with_map:new e.Uniform1i(t),u_texsize:new e.Uniform2f(t),u_texture:new e.Uniform1i(t),u_gamma_scale:new e.Uniform1f(t),u_device_pixel_ratio:new e.Uniform1f(t),u_tile_id:new e.Uniform3f(t),u_zoom_transition:new e.Uniform1f(t),u_inv_rot_matrix:new e.UniformMatrix4f(t),u_merc_center:new e.Uniform2f(t),u_camera_forward:new e.Uniform3f(t),u_tile_matrix:new e.UniformMatrix4f(t),u_up_vector:new e.Uniform3f(t),u_ecef_origin:new e.Uniform3f(t),u_is_halo:new e.Uniform1i(t)}),symbolTextAndIcon:t=>({u_is_size_zoom_constant:new e.Uniform1i(t),u_is_size_feature_constant:new e.Uniform1i(t),u_size_t:new e.Uniform1f(t),u_size:new e.Uniform1f(t),u_camera_to_center_distance:new e.Uniform1f(t),u_rotate_symbol:new e.Uniform1i(t),u_aspect_ratio:new e.Uniform1f(t),u_fade_change:new e.Uniform1f(t),u_matrix:new e.UniformMatrix4f(t),u_label_plane_matrix:new e.UniformMatrix4f(t),u_coord_matrix:new e.UniformMatrix4f(t),u_is_text:new e.Uniform1i(t),u_pitch_with_map:new e.Uniform1i(t),u_texsize:new e.Uniform2f(t),u_texsize_icon:new e.Uniform2f(t),u_texture:new e.Uniform1i(t),u_texture_icon:new e.Uniform1i(t),u_gamma_scale:new e.Uniform1f(t),u_device_pixel_ratio:new e.Uniform1f(t),u_is_halo:new e.Uniform1i(t)}),background:t=>({u_matrix:new e.UniformMatrix4f(t),u_opacity:new e.Uniform1f(t),u_color:new e.UniformColor(t)}),backgroundPattern:t=>({u_matrix:new e.UniformMatrix4f(t),u_opacity:new e.Uniform1f(t),u_image:new e.Uniform1i(t),u_pattern_tl:new e.Uniform2f(t),u_pattern_br:new e.Uniform2f(t),u_texsize:new e.Uniform2f(t),u_pattern_size:new e.Uniform2f(t),u_pixel_coord_upper:new e.Uniform2f(t),u_pixel_coord_lower:new e.Uniform2f(t),u_tile_units_to_pixels:new e.Uniform1f(t)}),terrainRaster:_r,terrainDepth:_r,skybox:t=>({u_matrix:new e.UniformMatrix4f(t),u_sun_direction:new e.Uniform3f(t),u_cubemap:new e.Uniform1i(t),u_opacity:new e.Uniform1f(t),u_temporal_offset:new e.Uniform1f(t)}),skyboxGradient:t=>({u_matrix:new e.UniformMatrix4f(t),u_color_ramp:new e.Uniform1i(t),u_center_direction:new e.Uniform3f(t),u_radius:new e.Uniform1f(t),u_opacity:new e.Uniform1f(t),u_temporal_offset:new e.Uniform1f(t)}),skyboxCapture:t=>({u_matrix_3f:new e.UniformMatrix3f(t),u_sun_direction:new e.Uniform3f(t),u_sun_intensity:new e.Uniform1f(t),u_color_tint_r:new e.Uniform4f(t),u_color_tint_m:new e.Uniform4f(t),u_luminance:new e.Uniform1f(t)}),globeRaster:t=>({u_proj_matrix:new e.UniformMatrix4f(t),u_globe_matrix:new e.UniformMatrix4f(t),u_normalize_matrix:new e.UniformMatrix4f(t),u_merc_matrix:new e.UniformMatrix4f(t),u_zoom_transition:new e.Uniform1f(t),u_merc_center:new e.Uniform2f(t),u_image0:new e.Uniform1i(t),u_grid_matrix:new e.UniformMatrix3f(t),u_skirt_height:new e.Uniform1f(t),u_frustum_tl:new e.Uniform3f(t),u_frustum_tr:new e.Uniform3f(t),u_frustum_br:new e.Uniform3f(t),u_frustum_bl:new e.Uniform3f(t),u_globe_pos:new e.Uniform3f(t),u_globe_radius:new e.Uniform1f(t),u_viewport:new e.Uniform2f(t)}),globeAtmosphere:t=>({u_frustum_tl:new e.Uniform3f(t),u_frustum_tr:new e.Uniform3f(t),u_frustum_br:new e.Uniform3f(t),u_frustum_bl:new e.Uniform3f(t),u_horizon:new e.Uniform1f(t),u_transition:new e.Uniform1f(t),u_fadeout_range:new e.Uniform1f(t),u_color:new e.Uniform4f(t),u_high_color:new e.Uniform4f(t),u_space_color:new e.Uniform4f(t),u_star_intensity:new e.Uniform1f(t),u_star_density:new e.Uniform1f(t),u_star_size:new e.Uniform1f(t),u_temporal_offset:new e.Uniform1f(t),u_horizon_angle:new e.Uniform1f(t),u_rotation_matrix:new e.UniformMatrix4f(t)})};let ln;function hn(t,r,n,i,o,a,s){const u=t.context,c=u.gl,l=t.transform,h=t.useProgram("collisionBox"),f=[];let d=0,p=0;for(let x=0;x<i.length;x++){const m=i[x],g=r.getTile(m),y=g.getBucket(n);if(!y)continue;const v=bt(m,y,l);let _=v;0===o[0]&&0===o[1]||(_=t.translatePosMatrix(v,g,o,a));const b=s?y.textCollisionBox:y.iconCollisionBox,w=y.collisionCircleArray;if(w.length>0){const t=e.create(),r=_;e.mul(t,y.placementInvProjMatrix,l.glCoordMatrix),e.mul(t,t,y.placementViewportMatrix),f.push({circleArray:w,circleOffset:p,transform:r,invTransform:t,projection:y.getProjection()}),d+=w.length/4,p=d}b&&(t.terrain&&t.terrain.setupElevationDraw(g,h),h.draw(u,c.LINES,e.DepthMode.disabled,e.StencilMode.disabled,t.colorModeForRenderPass(),e.CullFaceMode.disabled,Kr(_,l,g,y.getProjection()),n.id,b.layoutVertexBuffer,b.indexBuffer,b.segments,null,l.zoom,null,[b.collisionVertexBuffer,b.collisionVertexBufferExt]))}if(!s||!f.length)return;const m=t.useProgram("collisionCircle"),g=new e.StructArrayLayout2f1f2i16;g.resize(4*d),g._trim();let y=0;for(const e of f)for(let t=0;t<e.circleArray.length/4;t++){const r=4*t,n=e.circleArray[r+0],i=e.circleArray[r+1],o=e.circleArray[r+2],a=e.circleArray[r+3];g.emplace(y++,n,i,o,a,0),g.emplace(y++,n,i,o,a,1),g.emplace(y++,n,i,o,a,2),g.emplace(y++,n,i,o,a,3)}(!ln||ln.length<2*d)&&(ln=function(t){const r=2*t,n=new e.StructArrayLayout3ui6;n.resize(r),n._trim();for(let e=0;e<r;e++){const t=6*e;n.uint16[t+0]=4*e+0,n.uint16[t+1]=4*e+1,n.uint16[t+2]=4*e+2,n.uint16[t+3]=4*e+2,n.uint16[t+4]=4*e+3,n.uint16[t+5]=4*e+0}return n}(d));const v=u.createIndexBuffer(ln,!0),_=u.createVertexBuffer(g,e.collisionCircleLayout.members,!0);for(const x of f){const r={u_matrix:x.transform,u_inv_matrix:x.invTransform,u_camera_to_center_distance:(b=l).getCameraToCenterDistance(x.projection),u_viewport_size:[b.width,b.height]};m.draw(u,c.TRIANGLES,e.DepthMode.disabled,e.StencilMode.disabled,t.colorModeForRenderPass(),e.CullFaceMode.disabled,r,n.id,_,v,e.SegmentVector.simpleSegment(0,2*x.circleOffset,x.circleArray.length,x.circleArray.length/2),null,l.zoom)}var b;_.destroy(),v.destroy()}const fn=e.create();function dn({width:t,height:r,anchor:n,textOffset:i,textScale:o},a){const{horizontalAlign:s,verticalAlign:u}=e.getAnchorAlignment(n),c=-(s-.5)*t,l=-(u-.5)*r,h=e.evaluateVariableOffset(n,i);return new e.pointGeometry((c/o+h[0])*a,(l/o+h[1])*a)}function pn(t,r,n,i,o,a,s,u,c,l,h){const f=t.text.placedSymbolArray,d=t.text.dynamicLayoutVertexArray,p=t.icon.dynamicLayoutVertexArray,m={},g=t.getProjection(),y=xt(u,g,a),v=a.elevation,_=g.upVectorScale(u.canonical,a.center.lat,a.worldSize).metersToTile;d.clear();for(let b=0;b<f.length;b++){const p=f.get(b),{tileAnchorX:x,tileAnchorY:w,numGlyphs:k}=p,A=t.allowVerticalPlacement&&!p.placedOrientation,E=p.hidden||!p.crossTileID||A?null:i[p.crossTileID];if(E){let i=0,f=0,b=0;if(v){const e=v?v.getAtTileOffset(u,x,w):0,[t,r,n]=g.upVector(u.canonical,x,w);i=e*t*_,f=e*r*_,b=e*n*_}let[A,S,T,M]=ot(p.projectedAnchorX+i,p.projectedAnchorY+f,p.projectedAnchorZ+b,n?y:s);const I=at(a.getCameraToCenterDistance(g),M);let P=o.evaluateSizeForFeature(t.textSizeData,l,p)*I/e.ONE_EM;n&&(P*=t.tilePixelRatio/c);const C=dn(E,P);n?(({x:A,y:S,z:T}=g.projectTilePoint(x+C.x,w+C.y,u.canonical)),[A,S,T]=ot(A+i,S+f,T+b,s)):(r&&C._rotate(-a.angle),A+=C.x,S+=C.y,T=0);const B=t.allowVerticalPlacement&&p.placedOrientation===e.WritingMode.vertical?Math.PI/2:0;for(let t=0;t<k;t++)e.addDynamicAttributes(d,A,S,T,B);h&&p.associatedIconIndex>=0&&(m[p.associatedIconIndex]={x:A,y:S,z:T,angle:B})}else mt(k,d)}if(h){p.clear();const r=t.icon.placedSymbolArray;for(let t=0;t<r.length;t++){const n=r.get(t),{numGlyphs:i}=n,o=m[t];if(n.hidden||!o)mt(i,p);else{const{x:t,y:r,z:n,angle:a}=o;for(let o=0;o<i;o++)e.addDynamicAttributes(p,t,r,n,a)}}t.icon.dynamicLayoutVertexBuffer.updateData(p)}t.text.dynamicLayoutVertexBuffer.updateData(d)}function mn(e,t,r){return r.iconsInText&&t?"symbolTextAndIcon":e?"symbolSDF":"symbolIcon"}function gn(t,r,n,i,o,a,s,u,c,l,h,f){const d=t.context,p=d.gl,m=t.transform,g="map"===u,y="map"===c,v=g&&"point"!==n.layout.get("symbol-placement"),_=g&&!y&&!v,b=void 0!==n.layout.get("symbol-sort-key").constantOr(1);let x=!1;const w=t.depthModeForSublayer(0,e.DepthMode.ReadOnly),k=[e.mercatorXfromLng(m.center.lng),e.mercatorYfromLat(m.center.lat)],A=n.layout.get("text-variable-anchor"),E="globe"===m.projection.name,S=[],T=[0,-1,0];let M=T;!E&&!m.mercatorFromTransition||g||(M=function(t){const r=t._camera.getWorldToCamera(t.worldSize,1),n=e.multiply([],r,t.globeMatrix);e.invert(n,n);const i=[0,0,0],o=[0,1,0,0];return e.transformMat4$1(o,o,n),i[0]=o[0],i[1]=o[1],i[2]=o[2],e.normalize(i,i),i}(m));for(const I of i){const i=r.getTile(I),u=i.getBucket(n);if(!u)continue;if("mercator"===u.projection.name&&E)continue;const c=o?u.text:u.icon;if(!c||u.fullyClipped||!c.segments.get().length)continue;const h=c.programConfigurations.get(n.id),f=o||u.sdfIcons,d=o?u.textSizeData:u.iconSizeData,w=y||0!==m.pitch,P=e.evaluateSizeForZoom(d,m.zoom);let C,B,D,R,L=[0,0],O=null;if(o){if(B=i.glyphAtlasTexture,D=p.LINEAR,C=i.glyphAtlasTexture.size,u.iconsInText){L=i.imageAtlasTexture.size,O=i.imageAtlasTexture;const e="composite"===d.kind||"camera"===d.kind;R=w||t.options.rotating||t.options.zooming||e?p.LINEAR:p.NEAREST}}else{const e=1!==n.layout.get("icon-size").constantOr(0)||u.iconsNeedLinear;B=i.imageAtlasTexture,D=f||t.options.rotating||t.options.zooming||e||w?p.LINEAR:p.NEAREST,C=i.imageAtlasTexture.size}const z="globe"===u.projection.name,N=z?M:T,U=z?e.globeToMercatorTransition(m.zoom):0,Z=xt(I,u.getProjection(),m),F=m.calculatePixelsToTileUnitsMatrix(i),j=rt(Z,i.tileID.canonical,y,g,m,u.getProjection(),F),V=t.terrain&&y&&v?e.invert(e.create(),j):fn,W=it(Z,i.tileID.canonical,y,g,m,u.getProjection(),F),K=A&&u.hasTextData(),G="none"!==n.layout.get("icon-text-fit")&&K&&u.hasIconData();if(v){const e=m.elevation,r=e?e.getAtTileOffsetFunc(I,m.center.lat,m.worldSize,u.getProjection()):null,n=nt(Z,i.tileID.canonical,y,g,m,u.getProjection(),F);ut(u,Z,t,o,n,W,y,l,r,I)}const H=v||o&&A||G,q=t.translatePosMatrix(Z,i,a,s),Y=H?fn:j,X=t.translatePosMatrix(W,i,a,s,!0),Q=u.getProjection().createInversionMatrix(m,I.canonical),$=[];t.terrainRenderModeElevated()&&y&&$.push("PITCH_WITH_MAP_TERRAIN"),z&&$.push("PROJECTION_GLOBE_VIEW"),H&&$.push("PROJECTED_POS_ON_VIEWPORT");const J=f&&0!==n.paint.get(o?"text-halo-width":"icon-halo-width").constantOr(1);let ee;ee=f?u.iconsInText?an(d.kind,P,_,y,t,q,Y,X,C,L,I,U,k,Q,N,u.getProjection()):on(d.kind,P,_,y,t,q,Y,X,o,C,!0,I,U,k,Q,N,u.getProjection()):nn(d.kind,P,_,y,t,q,Y,X,o,C,I,U,k,Q,N,u.getProjection());const te={program:t.useProgram(mn(f,o,u),h,$),buffers:c,uniformValues:ee,atlasTexture:B,atlasTextureIcon:O,atlasInterpolation:D,atlasInterpolationIcon:R,isSDF:f,hasHalo:J,tile:i,labelPlaneMatrixInv:V};if(b&&u.canOverlap){x=!0;const t=c.segments.get();for(const r of t)S.push({segments:new e.SegmentVector([r]),sortKey:r.sortKey,state:te})}else S.push({segments:c.segments,sortKey:0,state:te})}x&&S.sort(((e,t)=>e.sortKey-t.sortKey));for(const e of S){const r=e.state;if(t.terrain&&t.terrain.setupElevationDraw(r.tile,r.program,{useDepthForOcclusion:!E,labelPlaneMatrixInv:r.labelPlaneMatrixInv}),d.activeTexture.set(p.TEXTURE0),r.atlasTexture.bind(r.atlasInterpolation,p.CLAMP_TO_EDGE),r.atlasTextureIcon&&(d.activeTexture.set(p.TEXTURE1),r.atlasTextureIcon&&r.atlasTextureIcon.bind(r.atlasInterpolationIcon,p.CLAMP_TO_EDGE)),r.isSDF){const i=r.uniformValues;r.hasHalo&&(i.u_is_halo=1,yn(r.buffers,e.segments,n,t,r.program,w,h,f,i)),i.u_is_halo=0}yn(r.buffers,e.segments,n,t,r.program,w,h,f,r.uniformValues)}}function yn(t,r,n,i,o,a,s,u,c){const l=i.context,h=[t.dynamicLayoutVertexBuffer,t.opacityVertexBuffer,t.globeExtVertexBuffer];o.draw(l,l.gl.TRIANGLES,a,s,u,e.CullFaceMode.disabled,c,n.id,t.layoutVertexBuffer,t.indexBuffer,r,n.paint,i.transform.zoom,t.programConfigurations.get(n.id),h)}function vn(t,r,n,i,o,a,s){const u=t.context.gl,c=n.paint.get("fill-pattern"),l=c&&c.constantOr(1);let h,f,d,p,m;s?(f=l&&!n.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",h=u.LINES):(f=l?"fillPattern":"fill",h=u.TRIANGLES);for(const g of i){const i=r.getTile(g);if(l&&!i.patternsLoaded())continue;const y=i.getBucket(n);if(!y)continue;t.prepareDrawTile();const v=y.programConfigurations.get(n.id),_=t.useProgram(f,v);l&&(t.context.activeTexture.set(u.TEXTURE0),i.imageAtlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE),v.updatePaintBuffers());const b=c.constantOr(null);if(b&&i.imageAtlas){const e=i.imageAtlas.patternPositions[b.toString()];e&&v.setConstantPatternPositions(e)}const x=t.translatePosMatrix(g.projMatrix,i,n.paint.get("fill-translate"),n.paint.get("fill-translate-anchor"));if(s){p=y.indexBuffer2,m=y.segments2;const e=t.terrain&&t.terrain.renderingToTexture?t.terrain.drapeBufferSize:[u.drawingBufferWidth,u.drawingBufferHeight];d="fillOutlinePattern"===f&&l?Fr(x,t,i,e):Zr(x,e)}else p=y.indexBuffer,m=y.segments,d=l?Ur(x,t,i):Nr(x);t.prepareDrawProgram(t.context,_,g.toUnwrapped()),_.draw(t.context,h,o,t.stencilModeForClipping(g),a,e.CullFaceMode.disabled,d,n.id,y.layoutVertexBuffer,p,m,n.paint,t.transform.zoom,v)}}function _n(t,r,n,i,o,a,s){const u=t.context,c=u.gl,l=t.transform,h=n.paint.get("fill-extrusion-pattern"),f=h.constantOr(1),d=n.paint.get("fill-extrusion-opacity"),p=[n.paint.get("fill-extrusion-ambient-occlusion-intensity"),n.paint.get("fill-extrusion-ambient-occlusion-radius")],m=n.layout.get("fill-extrusion-edge-radius"),g="globe"===l.projection.name?e.fillExtrusionHeightLift():0,y="globe"===l.projection.name,v=y?e.globeToMercatorTransition(l.zoom):0,_=[e.mercatorXfromLng(l.center.lng),e.mercatorYfromLat(l.center.lat)],b=[];y&&b.push("PROJECTION_GLOBE_VIEW"),p[0]>0&&b.push("FAUX_AO");for(const x of i){const i=r.getTile(x),w=i.getBucket(n);if(!w||w.projection.name!==l.projection.name)continue;const k=w.programConfigurations.get(n.id),A=t.useProgram(f?"fillExtrusionPattern":"fillExtrusion",k,b);if(t.terrain){const e=t.terrain;if(t.style.terrainSetForDrapingOnly())e.setupElevationDraw(i,A,{useMeterToDem:!0});else{if(!w.enableTerrain)continue;if(e.setupElevationDraw(i,A,{useMeterToDem:!0}),bn(u,r,x,w,n,e),!w.centroidVertexBuffer){const e=A.attributes.a_centroid_pos;void 0!==e&&c.vertexAttrib2f(e,0,0)}}}f&&(t.context.activeTexture.set(c.TEXTURE0),i.imageAtlasTexture.bind(c.LINEAR,c.CLAMP_TO_EDGE),k.updatePaintBuffers());const E=h.constantOr(null);if(E&&i.imageAtlas){const e=i.imageAtlas.patternPositions[E.toString()];e&&k.setConstantPatternPositions(e)}const S=t.translatePosMatrix(x.projMatrix,i,n.paint.get("fill-extrusion-translate"),n.paint.get("fill-extrusion-translate-anchor")),T=l.projection.createInversionMatrix(l,x.canonical),M=n.paint.get("fill-extrusion-vertical-gradient"),I=f?zr(S,t,M,d,p,m,x,i,g,v,_,T):Or(S,t,M,d,p,m,x,g,v,_,T);t.prepareDrawProgram(u,A,x.toUnwrapped());const P=[];t.terrain&&P.push(w.centroidVertexBuffer),y&&P.push(w.layoutVertexExtBuffer),A.draw(u,u.gl.TRIANGLES,o,a,s,e.CullFaceMode.backCCW,I,n.id,w.layoutVertexBuffer,w.indexBuffer,w.segments,n.paint,t.transform.zoom,k,P)}}function bn(t,r,n,i,o,a){const s=[t=>{let r=t.canonical.x-1,n=t.wrap;return r<0&&(r=(1<<t.canonical.z)-1,n--),new e.OverscaledTileID(t.overscaledZ,n,t.canonical.z,r,t.canonical.y)},t=>{let r=t.canonical.x+1,n=t.wrap;return r===1<<t.canonical.z&&(r=0,n++),new e.OverscaledTileID(t.overscaledZ,n,t.canonical.z,r,t.canonical.y)},t=>new e.OverscaledTileID(t.overscaledZ,t.wrap,t.canonical.z,t.canonical.x,(0===t.canonical.y?1<<t.canonical.z:t.canonical.y)-1),t=>new e.OverscaledTileID(t.overscaledZ,t.wrap,t.canonical.z,t.canonical.x,t.canonical.y===(1<<t.canonical.z)-1?0:t.canonical.y+1)],u=e=>{const t=r.getSource().minzoom,n=e=>{const t=r.getTileByID(e);if(t&&t.hasData())return t.getBucket(o)},i=[0,-1,1];for(const r of i){if(e.overscaledZ+r<t)continue;const i=n(e.calculateScaledKey(e.overscaledZ+r));if(i)return i}},c=[0,0,0],l=(t,r)=>(c[0]=Math.min(t.min.y,r.min.y),c[1]=Math.max(t.max.y,r.max.y),c[2]=e.EXTENT-r.min.x>t.max.x?r.min.x-e.EXTENT:t.max.x,c),h=(t,r)=>(c[0]=Math.min(t.min.x,r.min.x),c[1]=Math.max(t.max.x,r.max.x),c[2]=e.EXTENT-r.min.y>t.max.y?r.min.y-e.EXTENT:t.max.y,c),f=[(e,t)=>l(e,t),(e,t)=>l(t,e),(e,t)=>h(e,t),(e,t)=>h(t,e)],d=new e.pointGeometry(0,0);let p,m,g;const y=(t,r,i,o,s)=>{const u=[[o?i:t,o?t:i,0],[o?i:r,o?r:i,0]],c=s<0?e.EXTENT+s:s,l=[o?c:(t+r)/2,o?(t+r)/2:c,0];return 0===i&&s<0||0!==i&&s>0?a.getForTilePoints(g,[l],!0,m):u.push(l),a.getForTilePoints(n,u,!0,p),Math.max(u[0][2],u[1][2],l[2])/a.exaggeration()};for(let v=0;v<4;v++){const t=(v<2?1:5)-v,r=i.borders[v];if(0===r.length)continue;const o=g=s[v](n),c=u(o);if(!(c&&c instanceof e.FillExtrusionBucket&&c.enableTerrain))continue;if(i.borderDoneWithNeighborZ[v]===c.canonical.z&&c.borderDoneWithNeighborZ[t]===i.canonical.z)continue;if(m=a.findDEMTileFor(o),!m||!m.dem)continue;if(!p){const e=a.findDEMTileFor(n);if(!e||!e.dem)return;p=e}const l=c.borders[t];let h=0;const _=c.borderDoneWithNeighborZ[t]!==i.canonical.z;if(i.canonical.z===c.canonical.z){for(let n=0;n<r.length;n++){const o=i.featuresOnBorder[r[n]],a=o.borders[v];let s;for(;h<l.length&&(s=c.featuresOnBorder[l[h]],!(s.borders[t][1]>a[0]+3));)_&&c.encodeCentroid(void 0,s,!1),h++;if(s&&h<l.length){const r=h;let n=0;for(;!(s.borders[t][0]>a[1]-3)&&(n++,++h!==l.length);)s=c.featuresOnBorder[l[h]];if(s=c.featuresOnBorder[l[r]],o.intersectsCount()>1||s.intersectsCount()>1||1!==n){1!==n&&(h=r),i.encodeCentroid(void 0,o,!1),_&&c.encodeCentroid(void 0,s,!1);continue}const u=f[v](o,s),p=v%2?e.EXTENT-1:0;d.x=y(u[0],Math.min(e.EXTENT-1,u[1]),p,v<2,u[2]),d.y=0,i.encodeCentroid(d,o,!1),_&&c.encodeCentroid(d,s,!1)}else i.encodeCentroid(void 0,o,!1)}i.borderDoneWithNeighborZ[v]=c.canonical.z,i.needsCentroidUpdate=!0,_&&(c.borderDoneWithNeighborZ[t]=i.canonical.z,c.needsCentroidUpdate=!0)}else{for(const e of r)i.encodeCentroid(void 0,i.featuresOnBorder[e],!1);if(_){for(const e of l)c.encodeCentroid(void 0,c.featuresOnBorder[e],!1);c.borderDoneWithNeighborZ[t]=i.canonical.z,c.needsCentroidUpdate=!0}i.borderDoneWithNeighborZ[v]=c.canonical.z,i.needsCentroidUpdate=!0}}(i.needsCentroidUpdate||!i.centroidVertexBuffer&&0!==i.centroidVertexArray.length)&&i.uploadCentroid(t)}const xn=new e.Color(1,0,0,1),wn=new e.Color(0,1,0,1),kn=new e.Color(0,0,1,1),An=new e.Color(1,0,1,1),En=new e.Color(0,1,1,1);function Sn(t,r,n){const i=t.context,o=t.transform,a=i.gl,s="globe"===o.projection.name,u=s?["PROJECTION_GLOBE_VIEW"]:null;let c=n.projMatrix;if(s&&e.globeToMercatorTransition(o.zoom)>0){const t=e.transitionTileAABBinECEF(n.canonical,o),r=e.globeDenormalizeECEF(t);c=e.multiply(new Float32Array(16),o.globeMatrix,r),e.multiply(c,o.projMatrix,c)}const l=t.useProgram("debug",null,u),h=r.getTileByID(n.key);t.terrain&&t.terrain.setupElevationDraw(h,l);const f=e.DepthMode.disabled,d=e.StencilMode.disabled,p=t.colorModeForRenderPass(),m="$debug";i.activeTexture.set(a.TEXTURE0),t.emptyTexture.bind(a.LINEAR,a.CLAMP_TO_EDGE),s?h._makeGlobeTileDebugBuffers(t.context,o):h._makeDebugTileBoundsBuffers(t.context,o.projection);const g=h._tileDebugBuffer||t.debugBuffer,y=h._tileDebugIndexBuffer||t.debugIndexBuffer,v=h._tileDebugSegments||t.debugSegments;l.draw(i,a.LINE_STRIP,f,d,p,e.CullFaceMode.disabled,Gr(c,e.Color.red),m,g,y,v,null,null,null,[h._globeTileDebugBorderBuffer]);const _=h.latestRawTileData,b=Math.floor((_&&_.byteLength||0)/1024),x=r.getTile(n).tileSize,w=512/Math.min(x,512)*(n.overscaledZ/o.zoom)*.5;let k=n.canonical.toString();n.overscaledZ!==n.canonical.z&&(k+=` => ${n.overscaledZ}`),k+=` ${b}kb`,function(e,t){e.initDebugOverlayCanvas();const r=e.debugOverlayCanvas,n=e.context.gl,i=e.debugOverlayCanvas.getContext("2d");i.clearRect(0,0,r.width,r.height),i.shadowColor="white",i.shadowBlur=2,i.lineWidth=1.5,i.strokeStyle="white",i.textBaseline="top",i.font="bold 36px Open Sans, sans-serif",i.fillText(t,5,5),i.strokeText(t,5,5),e.debugOverlayTexture.update(r),e.debugOverlayTexture.bind(n.LINEAR,n.CLAMP_TO_EDGE)}(t,k);const A=h._tileDebugTextBuffer||t.debugBuffer,E=h._tileDebugTextIndexBuffer||t.quadTriangleIndexBuffer,S=h._tileDebugTextSegments||t.debugSegments;l.draw(i,a.TRIANGLES,f,d,e.ColorMode.alphaBlended,e.CullFaceMode.disabled,Gr(c,e.Color.transparent,w),m,A,E,S,null,null,null,[h._globeTileDebugTextBuffer])}function Tn(e,t,r,n){In(e,0,t+r/2,e.transform.width,r,n)}function Mn(e,t,r,n){In(e,t-r/2,0,r,e.transform.height,n)}function In(t,r,n,i,o,a){const s=t.context,u=s.gl;u.enable(u.SCISSOR_TEST),u.scissor(r*e.exported.devicePixelRatio,n*e.exported.devicePixelRatio,i*e.exported.devicePixelRatio,o*e.exported.devicePixelRatio),s.clear({color:a}),u.disable(u.SCISSOR_TEST)}const Pn=e.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Cn}=Pn;function Bn(e,t,r,n){e.emplaceBack(t,r,n)}class Dn{constructor(t){this.vertexArray=new e.StructArrayLayout3f12,this.indices=new e.StructArrayLayout3ui6,Bn(this.vertexArray,-1,-1,1),Bn(this.vertexArray,1,-1,1),Bn(this.vertexArray,-1,1,1),Bn(this.vertexArray,1,1,1),Bn(this.vertexArray,-1,-1,-1),Bn(this.vertexArray,1,-1,-1),Bn(this.vertexArray,-1,1,-1),Bn(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=t.createVertexBuffer(this.vertexArray,Cn),this.indexBuffer=t.createIndexBuffer(this.indices),this.segment=e.SegmentVector.simpleSegment(0,0,36,12)}}function Rn(t,r,n,i,o,a){const s=t.gl,u=r.paint.get("sky-atmosphere-color"),c=r.paint.get("sky-atmosphere-halo-color"),l=r.paint.get("sky-atmosphere-sun-intensity"),h=((e,t,r,n,i)=>({u_matrix_3f:e,u_sun_direction:t,u_sun_intensity:r,u_color_tint_r:[n.r,n.g,n.b,n.a],u_color_tint_m:[i.r,i.g,i.b,i.a],u_luminance:5e-5}))(e.fromMat4(e.create$1(),i),o,l,u,c);s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_CUBE_MAP_POSITIVE_X+a,r.skyboxTexture,0),n.draw(t,s.TRIANGLES,e.DepthMode.disabled,e.StencilMode.disabled,e.ColorMode.unblended,e.CullFaceMode.frontCW,h,"skyboxCapture",r.skyboxGeometry.vertexBuffer,r.skyboxGeometry.indexBuffer,r.skyboxGeometry.segment)}const Ln=e.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class On{constructor(t){const r=new e.StructArrayLayout5f20;r.emplaceBack(-1,1,1,0,0),r.emplaceBack(1,1,1,1,0),r.emplaceBack(1,-1,1,1,1),r.emplaceBack(-1,-1,1,0,1);const n=new e.StructArrayLayout3ui6;n.emplaceBack(0,1,2),n.emplaceBack(2,3,0),this.vertexBuffer=t.createVertexBuffer(r,Ln.members),this.indexBuffer=t.createIndexBuffer(n),this.segments=e.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const zn={symbol:function(t,r,n,i,o){if("translucent"!==t.renderPass)return;const a=e.StencilMode.disabled,s=t.colorModeForRenderPass();n.layout.get("text-variable-anchor")&&function(t,r,n,i,o,a,s){const u=r.transform,c="map"===o,l="map"===a;for(const h of t){const t=i.getTile(h),r=t.getBucket(n);if(!r||!r.text||!r.text.segments.get().length)continue;const o=e.evaluateSizeForZoom(r.textSizeData,u.zoom),a=xt(h,r.getProjection(),u),f=u.calculatePixelsToTileUnitsMatrix(t),d=rt(a,t.tileID.canonical,l,c,u,r.getProjection(),f),p="none"!==n.layout.get("icon-text-fit")&&r.hasIconData();if(o){const n=Math.pow(2,u.zoom-t.tileID.overscaledZ);pn(r,c,l,s,e.symbolSize,u,d,h,n,o,p)}}}(i,t,n,r,n.layout.get("text-rotation-alignment"),n.layout.get("text-pitch-alignment"),o),0!==n.paint.get("icon-opacity").constantOr(1)&&gn(t,r,n,i,!1,n.paint.get("icon-translate"),n.paint.get("icon-translate-anchor"),n.layout.get("icon-rotation-alignment"),n.layout.get("icon-pitch-alignment"),n.layout.get("icon-keep-upright"),a,s),0!==n.paint.get("text-opacity").constantOr(1)&&gn(t,r,n,i,!0,n.paint.get("text-translate"),n.paint.get("text-translate-anchor"),n.layout.get("text-rotation-alignment"),n.layout.get("text-pitch-alignment"),n.layout.get("text-keep-upright"),a,s),r.map.showCollisionBoxes&&(hn(t,r,n,i,n.paint.get("text-translate"),n.paint.get("text-translate-anchor"),!0),hn(t,r,n,i,n.paint.get("icon-translate"),n.paint.get("icon-translate-anchor"),!1))},circle:function(t,r,n,i){if("translucent"!==t.renderPass)return;const o=n.paint.get("circle-opacity"),a=n.paint.get("circle-stroke-width"),s=n.paint.get("circle-stroke-opacity"),u=void 0!==n.layout.get("circle-sort-key").constantOr(1);if(0===o.constantOr(1)&&(0===a.constantOr(1)||0===s.constantOr(1)))return;const c=t.context,l=c.gl,h=t.transform,f=t.depthModeForSublayer(0,e.DepthMode.ReadOnly),d=e.StencilMode.disabled,p=t.colorModeForRenderPass(),m="globe"===h.projection.name,g=[e.mercatorXfromLng(h.center.lng),e.mercatorYfromLat(h.center.lat)],y=[];for(let _=0;_<i.length;_++){const o=i[_],a=r.getTile(o),s=a.getBucket(n);if(!s||s.projection.name!==h.projection.name)continue;const c=s.programConfigurations.get(n.id),l=Wr(n);m&&l.push("PROJECTION_GLOBE_VIEW");const f=t.useProgram("circle",c,l),d=s.layoutVertexBuffer,p=s.globeExtVertexBuffer,v=s.indexBuffer,b=h.projection.createInversionMatrix(h,o.canonical),x={programConfiguration:c,program:f,layoutVertexBuffer:d,globeExtVertexBuffer:p,indexBuffer:v,uniformValues:Vr(t,o,a,b,g,n),tile:a};if(u){const t=s.segments.get();for(const r of t)y.push({segments:new e.SegmentVector([r]),sortKey:r.sortKey,state:x})}else y.push({segments:s.segments,sortKey:0,state:x})}u&&y.sort(((e,t)=>e.sortKey-t.sortKey));const v={useDepthForOcclusion:!m};for(const _ of y){const{programConfiguration:r,program:i,layoutVertexBuffer:o,globeExtVertexBuffer:a,indexBuffer:s,uniformValues:u,tile:m}=_.state,g=_.segments;t.terrain&&t.terrain.setupElevationDraw(m,i,v),t.prepareDrawProgram(c,i,m.tileID.toUnwrapped()),i.draw(c,l.TRIANGLES,f,d,p,e.CullFaceMode.disabled,u,n.id,o,s,g,n.paint,h.zoom,r,[a])}},heatmap:function(t,r,n,i){if(0!==n.paint.get("heatmap-opacity"))if("offscreen"===t.renderPass){const o=t.context,a=o.gl,s=e.StencilMode.disabled,u=new e.ColorMode([a.ONE,a.ONE],e.Color.transparent,[!0,!0,!0,!0]);!function(e,t,r,n){const i=e.gl,o=t.width*n,a=t.height*n;e.activeTexture.set(i.TEXTURE1),e.viewport.set([0,0,o,a]);let s=r.heatmapFbo;if(!s||s&&(s.width!==o||s.height!==a)){s&&s.destroy();const t=i.createTexture();i.bindTexture(i.TEXTURE_2D,t),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),s=r.heatmapFbo=e.createFramebuffer(o,a,!1),function(e,t,r,n,i,o){const a=e.gl;a.texImage2D(a.TEXTURE_2D,0,e.isWebGL2&&e.extRenderToTextureHalfFloat?a.RGBA16F:a.RGBA,i,o,0,a.RGBA,e.extRenderToTextureHalfFloat?e.isWebGL2?a.HALF_FLOAT:e.extTextureHalfFloat.HALF_FLOAT_OES:a.UNSIGNED_BYTE,null),n.colorAttachment.set(r)}(e,0,t,s,o,a)}else i.bindTexture(i.TEXTURE_2D,s.colorAttachment.get()),e.bindFramebuffer.set(s.framebuffer)}(o,t,n,"globe"===t.transform.projection.name?.5:.25),o.clear({color:e.Color.transparent});const c=t.transform,l="globe"===c.projection.name,h=l?["PROJECTION_GLOBE_VIEW"]:null,f=l?e.CullFaceMode.frontCCW:e.CullFaceMode.disabled,d=[e.mercatorXfromLng(c.center.lng),e.mercatorYfromLat(c.center.lat)];for(let p=0;p<i.length;p++){const m=i[p];if(r.hasRenderableParent(m))continue;const g=r.getTile(m),y=g.getBucket(n);if(!y||y.projection.name!==c.projection.name)continue;const v=y.programConfigurations.get(n.id),_=t.useProgram("heatmap",v,h),{zoom:b}=t.transform;t.terrain&&t.terrain.setupElevationDraw(g,_),t.prepareDrawProgram(o,_,m.toUnwrapped());const x=c.projection.createInversionMatrix(c,m.canonical);_.draw(o,a.TRIANGLES,e.DepthMode.disabled,s,u,f,qr(t,m,g,x,d,b,n.paint.get("heatmap-intensity")),n.id,y.layoutVertexBuffer,y.indexBuffer,y.segments,n.paint,t.transform.zoom,v,l?[y.globeExtVertexBuffer]:null)}o.viewport.set([0,0,t.width,t.height])}else"translucent"===t.renderPass&&(t.context.setColorMode(t.colorModeForRenderPass()),function(t,r){const n=t.context,i=n.gl,o=r.heatmapFbo;if(!o)return;n.activeTexture.set(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,o.colorAttachment.get()),n.activeTexture.set(i.TEXTURE1);let a=r.colorRampTexture;a||(a=r.colorRampTexture=new e.Texture(n,r.colorRamp,i.RGBA)),a.bind(i.LINEAR,i.CLAMP_TO_EDGE),t.useProgram("heatmapTexture").draw(n,i.TRIANGLES,e.DepthMode.disabled,e.StencilMode.disabled,t.colorModeForRenderPass(),e.CullFaceMode.disabled,((e,t,r,n)=>({u_image:0,u_color_ramp:1,u_opacity:t.paint.get("heatmap-opacity")}))(0,r),r.id,t.viewportBuffer,t.quadTriangleIndexBuffer,t.viewportSegments,r.paint,t.transform.zoom)}(t,n))},line:function(t,r,n,i){if("translucent"!==t.renderPass)return;const o=n.paint.get("line-opacity"),a=n.paint.get("line-width");if(0===o.constantOr(1)||0===a.constantOr(1))return;const s=t.depthModeForSublayer(0,e.DepthMode.ReadOnly),u=t.colorModeForRenderPass(),c=t.terrain&&t.terrain.renderingToTexture?1:e.exported.devicePixelRatio,l=n.paint.get("line-dasharray"),h=l.constantOr(1),f=n.layout.get("line-cap"),d=n.paint.get("line-pattern"),p=d.constantOr(1),m=n.paint.get("line-gradient"),g=p?"linePattern":"line",y=t.context,v=y.gl,_=(e=>{const t=[];Jr(e)&&t.push("RENDER_LINE_DASH"),e.paint.get("line-gradient")&&t.push("RENDER_LINE_GRADIENT");const r=e.paint.get("line-trim-offset");0===r[0]&&0===r[1]||t.push("RENDER_LINE_TRIM_OFFSET");const n=e.paint.get("line-pattern").constantOr(1),i=1!==e.paint.get("line-opacity").constantOr(1);return!n&&i&&t.push("RENDER_LINE_ALPHA_DISCARD"),t})(n);let b=_.includes("RENDER_LINE_ALPHA_DISCARD");t.terrain&&t.terrain.clipOrMaskOverlapStencilType()&&(b=!1);for(const x of i){const i=r.getTile(x);if(p&&!i.patternsLoaded())continue;const o=i.getBucket(n);if(!o)continue;t.prepareDrawTile();const a=o.programConfigurations.get(n.id),w=t.useProgram(g,a,_),k=d.constantOr(null);if(k&&i.imageAtlas){const e=i.imageAtlas.patternPositions[k.toString()];e&&a.setConstantPatternPositions(e)}const A=l.constantOr(null),E=f.constantOr(null);if(!p&&A&&E&&i.lineAtlas){const e=i.lineAtlas.getDash(A,E);e&&a.setConstantPatternPositions(e)}let[S,T]=n.paint.get("line-trim-offset");if("round"===E||"square"===E){const e=1;S!==T&&(0===S&&(S-=e),1===T&&(T+=e))}const M=t.terrain?x.projMatrix:null,I=p?Xr(t,i,n,M,c):Yr(t,i,n,M,o.lineClipsArray.length,c,[S,T]);if(m){const i=o.gradients[n.id];let a=i.texture;if(n.gradientVersion!==i.version){let s=256;if(n.stepInterpolant){const n=r.getSource().maxzoom,i=x.canonical.z===n?Math.ceil(1<<t.transform.maxZoom-x.canonical.z):1;s=e.clamp(e.nextPowerOfTwo(o.maxLineLength/e.EXTENT*1024*i),256,y.maxTextureSize)}i.gradient=e.renderColorRamp({expression:n.gradientExpression(),evaluationKey:"lineProgress",resolution:s,image:i.gradient||void 0,clips:o.lineClipsArray}),i.texture?i.texture.update(i.gradient):i.texture=new e.Texture(y,i.gradient,v.RGBA),i.version=n.gradientVersion,a=i.texture}y.activeTexture.set(v.TEXTURE1),a.bind(n.stepInterpolant?v.NEAREST:v.LINEAR,v.CLAMP_TO_EDGE)}h&&(y.activeTexture.set(v.TEXTURE0),i.lineAtlasTexture.bind(v.LINEAR,v.REPEAT),a.updatePaintBuffers()),p&&(y.activeTexture.set(v.TEXTURE0),i.imageAtlasTexture.bind(v.LINEAR,v.CLAMP_TO_EDGE),a.updatePaintBuffers()),t.prepareDrawProgram(y,w,x.toUnwrapped());const P=r=>{w.draw(y,v.TRIANGLES,s,r,u,e.CullFaceMode.disabled,I,n.id,o.layoutVertexBuffer,o.indexBuffer,o.segments,n.paint,t.transform.zoom,a,[o.layoutVertexBuffer2])};if(b){const r=t.stencilModeForClipping(x).ref;0===r&&t.terrain&&y.clear({stencil:0});const n={func:v.EQUAL,mask:255};I.u_alpha_discard_threshold=.8,P(new e.StencilMode(n,r,255,v.KEEP,v.KEEP,v.INVERT)),I.u_alpha_discard_threshold=0,P(new e.StencilMode(n,r,255,v.KEEP,v.KEEP,v.KEEP))}else P(t.stencilModeForClipping(x))}b&&(t.resetStencilClippingMasks(),t.terrain&&y.clear({stencil:0}))},fill:function(t,r,n,i){const o=n.paint.get("fill-color"),a=n.paint.get("fill-opacity");if(0===a.constantOr(1))return;const s=t.colorModeForRenderPass(),u=n.paint.get("fill-pattern"),c=t.opaquePassEnabledForLayer()&&!u.constantOr(1)&&1===o.constantOr(e.Color.transparent).a&&1===a.constantOr(0)?"opaque":"translucent";if(t.renderPass===c){const o=t.depthModeForSublayer(1,"opaque"===t.renderPass?e.DepthMode.ReadWrite:e.DepthMode.ReadOnly);vn(t,r,n,i,o,s,!1)}if("translucent"===t.renderPass&&n.paint.get("fill-antialias")){const o=t.depthModeForSublayer(n.getPaintProperty("fill-outline-color")?2:0,e.DepthMode.ReadOnly);vn(t,r,n,i,o,s,!0)}},"fill-extrusion":function(t,r,n,i){const o=n.paint.get("fill-extrusion-opacity");if(0!==o&&"translucent"===t.renderPass){const a=new e.DepthMode(t.context.gl.LEQUAL,e.DepthMode.ReadWrite,t.depthRangeFor3D);if(1!==o||n.paint.get("fill-extrusion-pattern").constantOr(1))_n(t,r,n,i,a,e.StencilMode.disabled,e.ColorMode.disabled),_n(t,r,n,i,a,t.stencilModeFor3D(),t.colorModeForRenderPass()),t.resetStencilClippingMasks();else{const o=t.colorModeForRenderPass();_n(t,r,n,i,a,e.StencilMode.disabled,o)}}},hillshade:function(t,r,n,i){if("offscreen"!==t.renderPass&&"translucent"!==t.renderPass)return;const o=t.context,a=t.depthModeForSublayer(0,e.DepthMode.ReadOnly),s=t.colorModeForRenderPass(),u=t.terrain&&t.terrain.renderingToTexture,[c,l]="translucent"!==t.renderPass||u?[{},i]:t.stencilConfigForOverlap(i);for(const h of l){const i=r.getTile(h);if(i.needsHillshadePrepare&&"offscreen"===t.renderPass)vr(t,i,n,a,e.StencilMode.disabled,s);else if("translucent"===t.renderPass){const e=u&&t.terrain?t.terrain.stencilModeForRTTOverlap(h):c[h.overscaledZ];gr(t,h,i,n,a,e,s)}}o.viewport.set([0,0,t.width,t.height]),t.resetStencilClippingMasks()},raster:function(t,r,n,i,o,a){if("translucent"!==t.renderPass)return;if(0===n.paint.get("raster-opacity"))return;if(!i.length)return;const s=t.context,u=s.gl,c=r.getSource(),l=t.useProgram("raster"),h=t.colorModeForRenderPass(),f=t.terrain&&t.terrain.renderingToTexture,[d,p]=c instanceof Ce||f?[{},i]:t.stencilConfigForOverlap(i),m=p[p.length-1].overscaledZ,g=!t.options.moving;for(const y of p){const i=f?e.DepthMode.disabled:t.depthModeForSublayer(y.overscaledZ-m,1===n.paint.get("raster-opacity")?e.DepthMode.ReadWrite:e.DepthMode.ReadOnly,u.LESS),o=y.toUnwrapped(),p=r.getTile(y);if(f&&(!p||!p.hasData()))continue;const v=f?y.projMatrix:t.transform.calculateProjMatrix(o,g),_=t.terrain&&f?t.terrain.stencilModeForRTTOverlap(y):d[y.overscaledZ],b=a?0:n.paint.get("raster-fade-duration");p.registerFadeDuration(b);const x=r.findLoadedParent(y,0),w=Mr(p,x,r,t.transform,b);let k,A;t.terrain&&t.terrain.prepareDrawTile();const E="nearest"===n.paint.get("raster-resampling")?u.NEAREST:u.LINEAR;s.activeTexture.set(u.TEXTURE0),p.texture.bind(E,u.CLAMP_TO_EDGE),s.activeTexture.set(u.TEXTURE1),x?(x.texture.bind(E,u.CLAMP_TO_EDGE),k=Math.pow(2,x.tileID.overscaledZ-p.tileID.overscaledZ),A=[p.tileID.canonical.x*k%1,p.tileID.canonical.y*k%1]):p.texture.bind(E,u.CLAMP_TO_EDGE);const S=en(v,A||[0,0],k||1,w,n,c instanceof Ce?c.perspectiveTransform:[0,0]);if(t.prepareDrawProgram(s,l,o),c instanceof Ce)c.boundsBuffer&&c.boundsSegments&&l.draw(s,u.TRIANGLES,i,e.StencilMode.disabled,h,e.CullFaceMode.disabled,S,n.id,c.boundsBuffer,t.quadTriangleIndexBuffer,c.boundsSegments);else{const{tileBoundsBuffer:r,tileBoundsIndexBuffer:o,tileBoundsSegments:a}=t.getTileBoundsBuffers(p);l.draw(s,u.TRIANGLES,i,_,h,e.CullFaceMode.disabled,S,n.id,r,o,a)}}t.resetStencilClippingMasks()},background:function(t,r,n,i){const o=n.paint.get("background-color"),a=n.paint.get("background-opacity");if(0===a)return;const s=t.context,u=s.gl,c=t.transform,l=c.tileSize,h=n.paint.get("background-pattern");if(t.isPatternMissing(h))return;const f=!h&&1===o.a&&1===a&&t.opaquePassEnabledForLayer()?"opaque":"translucent";if(t.renderPass!==f)return;const d=e.StencilMode.disabled,p=t.depthModeForSublayer(0,"opaque"===f?e.DepthMode.ReadWrite:e.DepthMode.ReadOnly),m=t.colorModeForRenderPass(),g=t.useProgram(h?"backgroundPattern":"background");let y,v=i;v||(y=t.getBackgroundTiles(),v=Object.values(y).map((e=>e.tileID))),h&&(s.activeTexture.set(u.TEXTURE0),t.imageManager.bind(t.context));for(const _ of v){const f=_.toUnwrapped(),v=i?_.projMatrix:t.transform.calculateProjMatrix(f);t.prepareDrawTile();const b=r?r.getTile(_):y?y[_.key]:new e.Tile(_,l,c.zoom,t),x=h?un(v,a,t,h,{tileID:_,tileSize:l}):sn(v,a,o);t.prepareDrawProgram(s,g,f);const{tileBoundsBuffer:w,tileBoundsIndexBuffer:k,tileBoundsSegments:A}=t.getTileBoundsBuffers(b);g.draw(s,u.TRIANGLES,p,d,m,e.CullFaceMode.disabled,x,n.id,w,k,A)}},sky:function(t,r,n){const i=t.transform,o="mercator"===i.projection.name||"globe"===i.projection.name?1:e.smoothstep(7,8,i.zoom),a=n.paint.get("sky-opacity")*o;if(0===a)return;const s=t.context,u=n.paint.get("sky-type"),c=new e.DepthMode(s.gl.LEQUAL,e.DepthMode.ReadOnly,[0,1]),l=t.frameCounter/1e3%1;"atmosphere"===u?"offscreen"===t.renderPass?n.needsSkyboxCapture(t)&&(function(t,r,n,i){const o=t.context,a=o.gl;let s=r.skyboxFbo;if(!s){s=r.skyboxFbo=o.createFramebuffer(32,32,!1),r.skyboxGeometry=new Dn(o),r.skyboxTexture=o.gl.createTexture(),a.bindTexture(a.TEXTURE_CUBE_MAP,r.skyboxTexture),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_CUBE_MAP,a.TEXTURE_MAG_FILTER,a.LINEAR);for(let e=0;e<6;++e)a.texImage2D(a.TEXTURE_CUBE_MAP_POSITIVE_X+e,0,a.RGBA,32,32,0,a.RGBA,a.UNSIGNED_BYTE,null)}o.bindFramebuffer.set(s.framebuffer),o.viewport.set([0,0,32,32]);const u=r.getCenter(t,!0),c=t.useProgram("skyboxCapture"),l=new Float64Array(16);e.identity(l),e.rotateY(l,l,.5*-Math.PI),Rn(o,r,c,l,u,0),e.identity(l),e.rotateY(l,l,.5*Math.PI),Rn(o,r,c,l,u,1),e.identity(l),e.rotateX(l,l,.5*-Math.PI),Rn(o,r,c,l,u,2),e.identity(l),e.rotateX(l,l,.5*Math.PI),Rn(o,r,c,l,u,3),e.identity(l),Rn(o,r,c,l,u,4),e.identity(l),e.rotateY(l,l,Math.PI),Rn(o,r,c,l,u,5),o.viewport.set([0,0,t.width,t.height])}(t,n),n.markSkyboxValid(t)):"sky"===t.renderPass&&function(t,r,n,i,o){const a=t.context,s=a.gl,u=t.transform,c=t.useProgram("skybox");a.activeTexture.set(s.TEXTURE0),s.bindTexture(s.TEXTURE_CUBE_MAP,r.skyboxTexture);const l=((e,t,r,n,i)=>({u_matrix:e,u_sun_direction:t,u_cubemap:0,u_opacity:n,u_temporal_offset:i}))(u.skyboxMatrix,r.getCenter(t,!1),0,i,o);t.prepareDrawProgram(a,c),c.draw(a,s.TRIANGLES,n,e.StencilMode.disabled,t.colorModeForRenderPass(),e.CullFaceMode.backCW,l,"skybox",r.skyboxGeometry.vertexBuffer,r.skyboxGeometry.indexBuffer,r.skyboxGeometry.segment)}(t,n,c,a,l):"gradient"===u&&"sky"===t.renderPass&&function(t,r,n,i,o){const a=t.context,s=a.gl,u=t.transform,c=t.useProgram("skyboxGradient");r.skyboxGeometry||(r.skyboxGeometry=new Dn(a)),a.activeTexture.set(s.TEXTURE0);let l=r.colorRampTexture;l||(l=r.colorRampTexture=new e.Texture(a,r.colorRamp,s.RGBA)),l.bind(s.LINEAR,s.CLAMP_TO_EDGE);const h=((t,r,n,i,o)=>({u_matrix:t,u_color_ramp:0,u_center_direction:r,u_radius:e.degToRad(n),u_opacity:i,u_temporal_offset:o}))(u.skyboxMatrix,r.getCenter(t,!1),r.paint.get("sky-gradient-radius"),i,o);t.prepareDrawProgram(a,c),c.draw(a,s.TRIANGLES,n,e.StencilMode.disabled,t.colorModeForRenderPass(),e.CullFaceMode.backCW,h,"skyboxGradient",r.skyboxGeometry.vertexBuffer,r.skyboxGeometry.indexBuffer,r.skyboxGeometry.segment)}(t,n,c,a,l)},debug:function(e,t,r){for(let n=0;n<r.length;n++)Sn(e,t,r[n])},custom:function(t,r,n,i){const o=t.context,a=n.implementation;if(!t.transform.projection.unsupportedLayers||!t.transform.projection.unsupportedLayers.includes("custom")||t.terrain&&(t.terrain.renderingToTexture||"offscreen"===t.renderPass)&&n.isLayerDraped()){if("offscreen"===t.renderPass){const r=a.prerender;if(r){if(t.setCustomLayerDefaults(),o.setColorMode(t.colorModeForRenderPass()),"globe"===t.transform.projection.name){const n=t.transform.pointMerc;r.call(a,o.gl,t.transform.customLayerMatrix(),t.transform.getProjection(),t.transform.globeToMercatorMatrix(),e.globeToMercatorTransition(t.transform.zoom),[n.x,n.y],t.transform.pixelsPerMeterRatio)}else r.call(a,o.gl,t.transform.customLayerMatrix());o.setDirty(),t.setBaseState()}}else if("translucent"===t.renderPass){if(t.terrain&&t.terrain.renderingToTexture){const r=a.renderToTile;if(r){const n=i[0].canonical,s=new e.MercatorCoordinate(n.x+i[0].wrap*(1<<n.z),n.y,n.z);o.setDepthMode(e.DepthMode.disabled),o.setStencilMode(e.StencilMode.disabled),o.setColorMode(t.colorModeForRenderPass()),t.setCustomLayerDefaults(),r.call(a,o.gl,s),o.setDirty(),t.setBaseState()}return}t.setCustomLayerDefaults(),o.setColorMode(t.colorModeForRenderPass()),o.setStencilMode(e.StencilMode.disabled);const r="3d"===a.renderingMode?new e.DepthMode(t.context.gl.LEQUAL,e.DepthMode.ReadWrite,t.depthRangeFor3D):t.depthModeForSublayer(0,e.DepthMode.ReadOnly);if(o.setDepthMode(r),"globe"===t.transform.projection.name){const r=t.transform.pointMerc;a.render(o.gl,t.transform.customLayerMatrix(),t.transform.getProjection(),t.transform.globeToMercatorMatrix(),e.globeToMercatorTransition(t.transform.zoom),[r.x,r.y],t.transform.pixelsPerMeterRatio)}else a.render(o.gl,t.transform.customLayerMatrix());o.setDirty(),t.setBaseState(),o.bindFramebuffer.set(null)}}else e.warnOnce("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")}};class Nn{constructor(t,r,n=!1){this.context=new Se(t,n),this.transform=r,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=e.SourceCache.maxUnderzooming+e.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Ht,this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(e,t){const r=!!e&&!!e.terrain&&this.transform.projection.supportsTerrain;if(!(r||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Br(this,e));const n=this._terrain;this.transform.elevation=r?n:null,n.update(e,this.transform,t)}_updateFog(e){const t=e.fog;if(!t||"globe"===this.transform.projection.name||t.getOpacity(this.transform.pitch)<1||t.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[r,n]=t.getFovAdjustedRange(this.transform._fov);if(r>n)return void(this.transform.fogCullDistSq=null);const i=r+.78*(n-r);this.transform.fogCullDistSq=i*i}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(t,r){if(this.width=t*e.exported.devicePixelRatio,this.height=r*e.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const e of this.style.order)this.style._layers[e].resize()}setup(){const t=this.context,r=new e.StructArrayLayout2i4;r.emplaceBack(0,0),r.emplaceBack(e.EXTENT,0),r.emplaceBack(0,e.EXTENT),r.emplaceBack(e.EXTENT,e.EXTENT),this.tileExtentBuffer=t.createVertexBuffer(r,e.posAttributes.members),this.tileExtentSegments=e.SegmentVector.simpleSegment(0,0,4,2);const n=new e.StructArrayLayout2i4;n.emplaceBack(0,0),n.emplaceBack(e.EXTENT,0),n.emplaceBack(0,e.EXTENT),n.emplaceBack(e.EXTENT,e.EXTENT),this.debugBuffer=t.createVertexBuffer(n,e.posAttributes.members),this.debugSegments=e.SegmentVector.simpleSegment(0,0,4,5);const i=new e.StructArrayLayout2i4;i.emplaceBack(-1,-1),i.emplaceBack(1,-1),i.emplaceBack(-1,1),i.emplaceBack(1,1),this.viewportBuffer=t.createVertexBuffer(i,e.posAttributes.members),this.viewportSegments=e.SegmentVector.simpleSegment(0,0,4,2);const o=new e.StructArrayLayout4i8;o.emplaceBack(0,0,0,0),o.emplaceBack(e.EXTENT,0,e.EXTENT,0),o.emplaceBack(0,e.EXTENT,0,e.EXTENT),o.emplaceBack(e.EXTENT,e.EXTENT,e.EXTENT,e.EXTENT),this.mercatorBoundsBuffer=t.createVertexBuffer(o,e.boundsAttributes.members),this.mercatorBoundsSegments=e.SegmentVector.simpleSegment(0,0,4,2);const a=new e.StructArrayLayout3ui6;a.emplaceBack(0,1,2),a.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=t.createIndexBuffer(a);const s=new e.StructArrayLayout1ui2;for(const e of[0,1,3,2,0])s.emplaceBack(e);this.debugIndexBuffer=t.createIndexBuffer(s),this.emptyTexture=new e.Texture(t,new e.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),t.gl.RGBA),this.identityMat=e.create();const u=this.context.gl;this.stencilClearMode=new e.StencilMode({func:u.ALWAYS,mask:0},0,255,u.ZERO,u.ZERO,u.ZERO),this.loadTimeStamps.push(e.window.performance.now()),this.atmosphereBuffer=new On(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(e){return e._makeTileBoundsBuffers(this.context,this.transform.projection),e._tileBoundsBuffer?{tileBoundsBuffer:e._tileBoundsBuffer,tileBoundsIndexBuffer:e._tileBoundsIndexBuffer,tileBoundsSegments:e._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const t=this.context,r=t.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(t,r.TRIANGLES,e.DepthMode.disabled,this.stencilClearMode,e.ColorMode.disabled,e.CullFaceMode.disabled,Tr(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(t,r,n){if(!r||this.currentStencilSource===r.id||!t.isTileClipped()||!n||0===n.length)return;if(this._tileClippingMaskIDs&&!this.terrain){let e=!1;for(const t of n)if(void 0===this._tileClippingMaskIDs[t.key]){e=!0;break}if(!e)return}this.currentStencilSource=r.id;const i=this.context,o=i.gl;this.nextStencilID+n.length>256&&this.clearStencil(),i.setColorMode(e.ColorMode.disabled),i.setDepthMode(e.DepthMode.disabled);const a=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const s of n){const t=r.getTile(s),n=this._tileClippingMaskIDs[s.key]=this.nextStencilID++,{tileBoundsBuffer:u,tileBoundsIndexBuffer:c,tileBoundsSegments:l}=this.getTileBoundsBuffers(t);a.draw(i,o.TRIANGLES,e.DepthMode.disabled,new e.StencilMode({func:o.ALWAYS,mask:0},n,255,o.KEEP,o.KEEP,o.REPLACE),e.ColorMode.disabled,e.CullFaceMode.disabled,Tr(s.projMatrix),"$clipping",u,c,l)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const t=this.nextStencilID++,r=this.context.gl;return new e.StencilMode({func:r.NOTEQUAL,mask:255},t,255,r.KEEP,r.KEEP,r.REPLACE)}stencilModeForClipping(t){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(t);const r=this.context.gl;return new e.StencilMode({func:r.EQUAL,mask:255},this._tileClippingMaskIDs[t.key],0,r.KEEP,r.KEEP,r.REPLACE)}stencilConfigForOverlap(t){const r=this.context.gl,n=t.sort(((e,t)=>t.overscaledZ-e.overscaledZ)),i=n[n.length-1].overscaledZ,o=n[0].overscaledZ-i+1;if(o>1){this.currentStencilSource=void 0,this.nextStencilID+o>256&&this.clearStencil();const t={};for(let n=0;n<o;n++)t[n+i]=new e.StencilMode({func:r.GEQUAL,mask:255},n+this.nextStencilID,255,r.KEEP,r.KEEP,r.REPLACE);return this.nextStencilID+=o,[t,n]}return[{[i]:e.StencilMode.disabled},n]}colorModeForRenderPass(){const t=this.context.gl;if(this._showOverdrawInspector){const r=1/8;return new e.ColorMode([t.CONSTANT_COLOR,t.ONE],new e.Color(r,r,r,0),[!0,!0,!0,!0])}return"opaque"===this.renderPass?e.ColorMode.unblended:e.ColorMode.alphaBlended}depthModeForSublayer(t,r,n){if(!this.opaquePassEnabledForLayer())return e.DepthMode.disabled;const i=1-((1+this.currentLayer)*this.numSublayers+t)*this.depthEpsilon;return new e.DepthMode(n||this.context.gl.LEQUAL,r,[i,i])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(t,r){this.style=t,this.options=r,this.imageManager=t.imageManager,this.glyphManager=t.glyphManager,this.symbolFadeChange=t.placement.symbolFadeChange(e.exported.now()),this.imageManager.beginFrame();const n=this.style.order,i=this.style._sourceCaches;for(const e in i){const t=i[e];t.used&&t.prepare(this.context)}const o={},a={},s={};for(const e in i){const t=i[e];o[e]=t.getVisibleCoordinates(),a[e]=o[e].slice().reverse(),s[e]=t.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let e=0;e<n.length;e++)if(this.style._layers[n[e]].is3D()){this.opaquePassCutoff=e;break}if(this.terrain&&(this.terrain.updateTileBinding(s),this.opaquePassCutoff=0),"globe"!==this.transform.projection.name||this.globeSharedBuffers||(this.globeSharedBuffers=new e.GlobeSharedBuffers(this.context)),e.isMapAuthenticated(this.context.gl)){this.renderPass="offscreen";for(const e of n){const r=this.style._layers[e],n=t._getLayerSourceCache(r);if(!r.hasOffscreenPass()||r.isHidden(this.transform.zoom))continue;const i=n?a[n.id]:void 0;("custom"===r.type||r.isSky()||i&&i.length)&&this.renderLayer(this,n,r,i)}if(this.depthRangeFor3D=[0,1-(t.order.length+2)*this.numSublayers*this.depthEpsilon],this.terrain&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&this.terrain.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:r.showOverdrawInspector?e.Color.black:e.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=r.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=n.length-1;this.currentLayer>=0;this.currentLayer--){const e=this.style._layers[n[this.currentLayer]],r=t._getLayerSourceCache(e);if(e.isSky())continue;const i=r?a[r.id]:void 0;this._renderTileClippingMasks(e,r,i),this.renderLayer(this,r,e,i)}if(this.style.fog&&this.transform.projection.supportsFog&&function(t,r){const n=t.context,i=n.gl,o=t.transform,a=new e.DepthMode(i.LEQUAL,e.DepthMode.ReadOnly,[0,1]),s=t.useProgram("globeAtmosphere",null,"globe"===o.projection.name?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),u=e.globeToMercatorTransition(o.zoom),c=r.properties.get("color").toArray01(),l=r.properties.get("high-color").toArray01(),h=r.properties.get("space-color").toArray01PremultipliedAlpha(),f=e.identity$1([]);e.rotateY$1(f,f,-e.degToRad(o._center.lng)),e.rotateX$1(f,f,e.degToRad(o._center.lat)),e.rotateZ$1(f,f,o.angle),e.rotateX$1(f,f,-o._pitch);const d=e.fromQuat(new Float32Array(16),f),p=e.mapValue(r.properties.get("star-intensity"),0,1,0,.25),m=5e-4,g=e.mapValue(r.properties.get("horizon-blend"),0,1,m,.25),y=e.globeUseCustomAntiAliasing(t,n,o)&&g===m?o.worldSize/(2*Math.PI*1.025)-1:o.globeRadius,v=t.frameCounter/1e3%1,_=e.length(o.globeCenterInViewSpace),b=Math.sqrt(Math.pow(_,2)-Math.pow(y,2)),x=Math.acos(b/_),w=((t,r,n,i,o,a,s,u,c,l,h,f,d,p)=>({u_frustum_tl:t,u_frustum_tr:r,u_frustum_br:n,u_frustum_bl:i,u_horizon:o,u_transition:a,u_fadeout_range:s,u_color:u,u_high_color:c,u_space_color:l,u_star_intensity:h,u_star_size:5*e.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:f,u_horizon_angle:d,u_rotation_matrix:p}))(o.frustumCorners.TL,o.frustumCorners.TR,o.frustumCorners.BR,o.frustumCorners.BL,o.frustumCorners.horizon,u,g,c,l,h,p,v,x,d);t.prepareDrawProgram(n,s);const k=t.atmosphereBuffer;k&&s.draw(n,i.TRIANGLES,a,e.StencilMode.disabled,e.ColorMode.alphaBlended,e.CullFaceMode.backCW,w,"skybox",k.vertexBuffer,k.indexBuffer,k.segments)}(this,this.style.fog),this.renderPass="sky",(e.globeToMercatorTransition(this.transform.zoom)>0||"globe"!==this.transform.projection.name)&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<n.length;this.currentLayer++){const e=this.style._layers[n[this.currentLayer]],r=t._getLayerSourceCache(e);e.isSky()&&this.renderLayer(this,r,e,r?a[r.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<n.length;){const e=this.style._layers[n[this.currentLayer]],r=t._getLayerSourceCache(e);if(e.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(e)){if(e.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const i=r?("symbol"===e.type?s:a)[r.id]:void 0;this._renderTileClippingMasks(e,r,r?o[r.id]:void 0),this.renderLayer(this,r,e,i),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let r=null;e.values(this.style._layers).forEach((e=>{const n=t._getLayerSourceCache(e);n&&!e.isHidden(this.transform.zoom)&&(!r||r.getSource().maxzoom<n.getSource().maxzoom)&&(r=n)})),r&&this.options.showTileBoundaries&&zn.debug(this,r,r.getVisibleCoordinates())}this.options.showPadding&&function(e){const t=e.transform.padding;Tn(e,e.transform.height-(t.top||0),3,xn),Tn(e,t.bottom||0,3,wn),Mn(e,t.left||0,3,kn),Mn(e,e.transform.width-(t.right||0),3,An);const r=e.transform.centerPoint;!function(e,t,r,n){In(e,t-1,r-10,2,20,n),In(e,t-10,r-1,20,2,n)}(e,r.x,e.transform.height-r.y,En)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(e.window.performance.now()),this.saveCanvasCopy())}}renderLayer(e,t,r,n){r.isHidden(this.transform.zoom)||("background"===r.type||"sky"===r.type||"custom"===r.type||n&&n.length)&&(this.id=r.id,this.gpuTimingStart(r),(!e.transform.projection.unsupportedLayers||!e.transform.projection.unsupportedLayers.includes(r.type)||e.terrain&&"custom"===r.type)&&zn[r.type](e,t,r,n,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(e){if(!this.options.gpuTiming)return;const t=this.context.extTimerQuery;let r=this.gpuTimers[e.id];r||(r=this.gpuTimers[e.id]={calls:0,cpuTime:0,query:t.createQueryEXT()}),r.calls++,t.beginQueryEXT(t.TIME_ELAPSED_EXT,r.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const e=this.context.extTimerQuery,t=e.createQueryEXT();this.deferredRenderGpuTimeQueries.push(t),e.beginQueryEXT(e.TIME_ELAPSED_EXT,t)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const e=this.context.extTimerQuery;e.endQueryEXT(e.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const e=this.context.extTimerQuery;e.endQueryEXT(e.TIME_ELAPSED_EXT)}collectGpuTimers(){const e=this.gpuTimers;return this.gpuTimers={},e}collectDeferredRenderGpuQueries(){const e=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],e}queryGpuTimers(e){const t={};for(const r in e){const n=e[r],i=this.context.extTimerQuery,o=i.getQueryObjectEXT(n.query,i.QUERY_RESULT_EXT)/1e6;i.deleteQueryEXT(n.query),t[r]=o}return t}queryGpuTimeDeferredRender(e){if(!this.options.gpuTimingDeferredRender)return 0;const t=this.context.extTimerQuery;let r=0;for(const n of e)r+=t.getQueryObjectEXT(n,t.QUERY_RESULT_EXT)/1e6,t.deleteQueryEXT(n);return r}translatePosMatrix(t,r,n,i,o){if(!n[0]&&!n[1])return t;const a=o?"map"===i?this.transform.angle:0:"viewport"===i?-this.transform.angle:0;if(a){const e=Math.sin(a),t=Math.cos(a);n=[n[0]*t-n[1]*e,n[0]*e+n[1]*t]}const s=[o?n[0]:D(r,n[0],this.transform.zoom),o?n[1]:D(r,n[1],this.transform.zoom),0],u=new Float32Array(16);return e.translate(u,t,s),u}saveTileTexture(e){const t=this._tileTextures[e.size[0]];t?t.push(e):this._tileTextures[e.size[0]]=[e]}getTileTexture(e){const t=this._tileTextures[e];return t&&t.length>0?t.pop():null}isPatternMissing(e){return null===e||void 0!==e&&!this.imageManager.getPattern(e.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const e=this.terrain&&this.terrain.renderingToTexture,t=this.terrain&&0===this.terrain.exaggeration(),r=this.style&&this.style.fog,n=[];return this.terrainRenderModeElevated()&&n.push("TERRAIN"),"globe"===this.transform.projection.name&&n.push("GLOBE"),t&&n.push("ZERO_EXAGGERATION"),r&&!e&&0!==r.getOpacity(this.transform.pitch)&&n.push("FOG"),e&&n.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&n.push("OVERDRAW_INSPECTOR"),n}useProgram(e,t,r){this.cache=this.cache||{};const n=r||[],i=this.currentGlobalDefines().concat(n),o=Dr.cacheKey(hr[e],e,i,t);return this.cache[o]||(this.cache[o]=new Dr(this.context,e,hr[e],t,cn[e],i)),this.cache[o]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=e.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new e.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(t,r,n){if(this.terrain&&this.terrain.renderingToTexture)return;const i=this.style.fog;if(i){const o=i.getOpacity(this.transform.pitch),a=((t,r,n,i,o,a,s,u,c,l,h)=>{const f=t.transform,d=r.properties.get("color").toArray01();d[3]=i;const p=t.frameCounter/1e3%1;return{u_fog_matrix:n?f.calculateFogTileMatrix(n):t.identityMat,u_fog_range:r.getFovAdjustedRange(f._fov),u_fog_color:d,u_fog_horizon_blend:r.properties.get("horizon-blend"),u_fog_temporal_offset:p,u_frustum_tl:o,u_frustum_tr:a,u_frustum_br:s,u_frustum_bl:u,u_globe_pos:c,u_globe_radius:l,u_viewport:h,u_globe_transition:e.globeToMercatorTransition(f.zoom),u_is_globe:+("globe"===f.projection.name)}})(this,i,n,o,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*e.exported.devicePixelRatio,this.transform.height*e.exported.devicePixelRatio]);r.setFogUniformValues(t,a)}}setTileLoadedFlag(e){this.tileLoaded=e}saveCanvasCopy(){const e=this.canvasCopy();e&&(this.frameCopies.push(e),this.tileLoaded=!1)}canvasCopy(){const e=this.context.gl,t=e.createTexture();return e.bindTexture(e.TEXTURE_2D,t),e.copyTexImage2D(e.TEXTURE_2D,0,e.RGBA,0,0,e.drawingBufferWidth,e.drawingBufferHeight,0),t}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const e=this.style&&this.style.fog;return!!e&&0!==e.getOpacity(this.transform.pitch)}getBackgroundTiles(){const t=this._backgroundTiles,r=this._backgroundTiles={},n=this.transform.coveringTiles({tileSize:512});for(const i of n)r[i.key]=t[i.key]||new e.Tile(i,512,this.transform.tileZoom,this);return r}clearBackgroundTiles(){this._backgroundTiles={}}}class Un{constructor(e=0,t=0,r=0,n=0){if(isNaN(e)||e<0||isNaN(t)||t<0||isNaN(r)||r<0||isNaN(n)||n<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=t,this.left=r,this.right=n}interpolate(t,r,n){return null!=r.top&&null!=t.top&&(this.top=e.number(t.top,r.top,n)),null!=r.bottom&&null!=t.bottom&&(this.bottom=e.number(t.bottom,r.bottom,n)),null!=r.left&&null!=t.left&&(this.left=e.number(t.left,r.left,n)),null!=r.right&&null!=t.right&&(this.right=e.number(t.right,r.right,n)),this}getCenter(t,r){const n=e.clamp((this.left+t-this.right)/2,0,t),i=e.clamp((this.top+r-this.bottom)/2,0,r);return new e.pointGeometry(n,i)}equals(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}clone(){return new Un(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Zn(t,r){const n=e.getColumn(t,3);e.fromQuat(t,r),e.setColumn(t,3,n)}function Fn(t,r){const n=e.identity$1([]);return e.rotateZ$1(n,n,-r),e.rotateX$1(n,n,-t),n}function jn(t,r){const n=[t[0],t[1],0],i=[r[0],r[1],0];if(e.length(n)>=1e-15){const t=e.normalize([],n);e.scale$2(i,t,e.dot(i,t)),r[0]=i[0],r[1]=i[1]}const o=e.cross([],r,t);if(e.len(o)<1e-15)return null;const a=Math.atan2(-o[1],o[0]);return Fn(Math.atan2(Math.sqrt(t[0]*t[0]+t[1]*t[1]),-t[2]),a)}class Vn{constructor(e,t){this.position=e,this.orientation=t}get position(){return this._position}set position(t){if(t){const r=t instanceof e.MercatorCoordinate?t:new e.MercatorCoordinate(t[0],t[1],t[2]);this._renderWorldCopies&&(r.x=e.wrap(r.x,0,1)),this._position=r}else this._position=null}lookAtPoint(t,r){if(this.orientation=null,!this.position)return;const n=this._elevation?this._elevation.getAtPointOrZero(e.MercatorCoordinate.fromLngLat(t)):0,i=this.position,o=e.MercatorCoordinate.fromLngLat(t,n),a=[o.x-i.x,o.y-i.y,o.z-i.z];r||(r=[0,0,1]),r[2]=Math.abs(r[2]),this.orientation=jn(a,r)}setPitchBearing(t,r){this.orientation=Fn(e.degToRad(t),e.degToRad(-r))}}class Wn{constructor(t,r){this._transform=e.identity([]),this.orientation=r,this.position=t}get mercatorPosition(){const t=this.position;return new e.MercatorCoordinate(t[0],t[1],t[2])}get position(){const t=e.getColumn(this._transform,3);return[t[0],t[1],t[2]]}set position(t){var r;t&&e.setColumn(this._transform,3,[(r=t)[0],r[1],r[2],1])}get orientation(){return this._orientation}set orientation(t){this._orientation=t||e.identity$1([]),t&&Zn(this._transform,this._orientation)}getPitchBearing(){const e=this.forward(),t=this.right();return{bearing:Math.atan2(-t[1],t[0]),pitch:Math.atan2(Math.sqrt(e[0]*e[0]+e[1]*e[1]),-e[2])}}setPitchBearing(e,t){this._orientation=Fn(e,t),Zn(this._transform,this._orientation)}forward(){const t=e.getColumn(this._transform,2);return[-t[0],-t[1],-t[2]]}up(){const t=e.getColumn(this._transform,1);return[-t[0],-t[1],-t[2]]}right(){const t=e.getColumn(this._transform,0);return[t[0],t[1],t[2]]}getCameraToWorld(t,r){const n=new Float64Array(16);return e.invert(n,this.getWorldToCamera(t,r)),n}getWorldToCameraPosition(t,r,n){const i=this.position;e.scale$2(i,i,-t);const o=new Float64Array(16);return e.fromScaling(o,[n,n,n]),e.translate(o,o,i),o[10]*=r,o}getWorldToCamera(t,r){const n=new Float64Array(16),i=new Float64Array(4),o=this.position;return e.conjugate(i,this._orientation),e.scale$2(o,o,-t),e.fromQuat(n,i),e.translate(n,n,o),n[1]*=-1,n[5]*=-1,n[9]*=-1,n[13]*=-1,n[8]*=r,n[9]*=r,n[10]*=r,n[11]*=r,n}getCameraToClipPerspective(t,r,n,i){const o=new Float64Array(16);return e.perspective(o,t,r,n,i),o}getDistanceToElevation(t,r=!1){const n=0===t?0:e.mercatorZfromAltitude(t,r?e.latFromMercatorY(this.position[1]):this.position[1]),i=this.forward();return(n-this.position[2])/i[2]}clone(){return new Wn([...this.position],[...this.orientation])}}function Kn(t,r){const n=Hn(t.projection,t.zoom,t.width,t.height),i=function(t,r,n,i,o){const a=new e.LngLat(n.lng-180*qn,n.lat),s=new e.LngLat(n.lng+180*qn,n.lat),u=t.project(a.lng,a.lat),c=t.project(s.lng,s.lat),l=-Math.atan2(c.y-u.y,c.x-u.x),h=e.MercatorCoordinate.fromLngLat(n);h.y=e.clamp(h.y,-.999975,.999975);const f=h.toLngLat(),d=t.project(f.lng,f.lat),p=e.MercatorCoordinate.fromLngLat(f);p.x+=qn;const m=p.toLngLat(),g=t.project(m.lng,m.lat),y=Xn(g.x-d.x,g.y-d.y,l),v=e.MercatorCoordinate.fromLngLat(f);v.y+=qn;const _=v.toLngLat(),b=t.project(_.lng,_.lat),x=Xn(b.x-d.x,b.y-d.y,l),w=Math.abs(y.x)/Math.abs(x.y),k=e.identity([]);e.rotateZ(k,k,-l*(1-(o?0:i)));const A=e.identity([]);return e.scale(A,A,[1,1-(1-w)*i,1]),A[4]=-x.x/x.y*i,e.rotateZ(A,A,l),e.multiply(A,k,A),A}(t.projection,0,t.center,n,r),o=Gn(t);return e.scale(i,i,[o,o,1]),i}function Gn(t){const r=t.projection,n=Hn(t.projection,t.zoom,t.width,t.height),i=Yn(r,t.center),o=Yn(r,e.LngLat.convert(r.center));return Math.pow(2,i*n+(1-n)*o)}function Hn(t,r,n,i,o=1/0){const a=t.range;if(!a)return 0;const s=Math.min(o,Math.max(n,i)),u=Math.log(s/1024)/Math.LN2;return e.smoothstep(a[0]+u,a[1]+u,r)}const qn=1/4e4;function Yn(t,r){const n=e.clamp(r.lat,-e.MAX_MERCATOR_LATITUDE,e.MAX_MERCATOR_LATITUDE),i=new e.LngLat(r.lng-180*qn,n),o=new e.LngLat(r.lng+180*qn,n),a=t.project(i.lng,n),s=t.project(o.lng,n),u=e.MercatorCoordinate.fromLngLat(i),c=e.MercatorCoordinate.fromLngLat(o),l=s.x-a.x,h=s.y-a.y,f=c.x-u.x,d=c.y-u.y,p=Math.sqrt((f*f+d*d)/(l*l+h*h));return Math.log(p)/Math.LN2}function Xn(e,t,r){const n=Math.cos(r),i=Math.sin(r);return{x:e*n-t*i,y:e*i+t*n}}class Qn{constructor(t,r,n,i,o,a,s){this.tileSize=512,this._renderWorldCopies=void 0===o||o,this._minZoom=t||0,this._maxZoom=r||22,this._minPitch=null==n?0:n,this._maxPitch=null==i?60:i,this.setProjection(a),this.setMaxBounds(s),this.width=0,this.height=0,this._center=new e.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Un,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new Wn,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const e=new Qn(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return e._elevation=this._elevation,e._centerAltitude=this._centerAltitude,e._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,e.tileSize=this.tileSize,e.mercatorFromTransition=this.mercatorFromTransition,e.width=this.width,e.height=this.height,e.cameraElevationReference=this.cameraElevationReference,e._center=this._center,e._setZoom(this.zoom),e._seaLevelZoom=this._seaLevelZoom,e.angle=this.angle,e._fov=this._fov,e._pitch=this._pitch,e._nearZ=this._nearZ,e._farZ=this._farZ,e._averageElevation=this._averageElevation,e._unmodified=this._unmodified,e._edgeInsets=this._edgeInsets.clone(),e._camera=this._camera.clone(),e._calcMatrices(),e.freezeTileCoverage=this.freezeTileCoverage,e.frustumCorners=this.frustumCorners,e}get elevation(){return this._elevation}set elevation(e){this._elevation!==e&&(this._elevation=e,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(e,t=!1){const r=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(null==this._seaLevelZoom||r)&&this._updateCameraOnTerrain(),(e||r)&&this._constrainCamera(t),this._calcMatrices()}getProjection(){return e.pick(this.projection,["name","center","parallels"])}setProjection(r){this.projectionOptions=r||{name:"mercator"};const n=this.projection?this.getProjection():void 0;this.projection=e.getProjection(this.projectionOptions);const i=!t(n,this.getProjection());return i&&this._calcMatrices(),this.mercatorFromTransition=!1,i}setMercatorFromTransition(){const t=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=e.getProjection({name:"mercator"});const r=t!==this.projection.name;return r&&this._calcMatrices(),r}get minZoom(){return this._minZoom}set minZoom(e){this._minZoom!==e&&(this._minZoom=e,this.zoom=Math.max(this.zoom,e))}get maxZoom(){return this._maxZoom}set maxZoom(e){this._maxZoom!==e&&(this._maxZoom=e,this.zoom=Math.min(this.zoom,e))}get minPitch(){return this._minPitch}set minPitch(e){this._minPitch!==e&&(this._minPitch=e,this.pitch=Math.max(this.pitch,e))}get maxPitch(){return this._maxPitch}set maxPitch(e){this._maxPitch!==e&&(this._maxPitch=e,this.pitch=Math.min(this.pitch,e))}get renderWorldCopies(){return this._renderWorldCopies&&!0===this.projection.supportsWorldCopies}set renderWorldCopies(e){void 0===e?e=!0:null===e&&(e=!1),this._renderWorldCopies=e}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const e=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(e))}get cameraWorldSize(){const e=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(e))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return e.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new e.pointGeometry(this.width,this.height)}get bearing(){return e.wrap(this.rotation,-180,180)}set bearing(e){this.rotation=e}get rotation(){return-this.angle/Math.PI*180}set rotation(t){const r=-t*Math.PI/180;var n;this.angle!==r&&(this._unmodified=!1,this.angle=r,this._calcMatrices(),this.rotationMatrix=(n=new e.ARRAY_TYPE(4),e.ARRAY_TYPE!=Float32Array&&(n[1]=0,n[2]=0),n[0]=1,n[3]=1,n),function(e,t,r){var n=t[0],i=t[1],o=t[2],a=t[3],s=Math.sin(r),u=Math.cos(r);e[0]=n*u+o*s,e[1]=i*u+a*s,e[2]=n*-s+o*u,e[3]=i*-s+a*u}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(t){const r=e.clamp(t,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==r&&(this._unmodified=!1,this._pitch=r,this._calcMatrices())}get aspect(){return this.width/this.height}get fovX(){return this._fov}get fovY(){const e=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/e)}set fov(t){t=Math.max(.01,Math.min(60,t)),this._fov!==t&&(this._unmodified=!1,this._fov=e.degToRad(t),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(e){this._averageElevation=e,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(e){const t=Math.min(Math.max(e,this.minZoom),this.maxZoom);this._zoom!==t&&(this._unmodified=!1,this._setZoom(t),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(e){this._zoom=e,this.scale=this.zoomScale(e),this.tileZoom=Math.floor(e),this.zoomFraction=e-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const e=this._elevation;this._centerAltitude=e.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=e.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){void 0!==this._centerAltitudeValidForExaggeration&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const t=this._elevation,r=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],n=this.horizonLineFromTop();let i=0,o=0;for(let a=0;a<r.length;a++){const s=new e.pointGeometry(r[a][0]*this.width,n+r[a][1]*(this.height-n)),u=t.pointCoordinate(s);if(!u)continue;const c=1/Math.hypot(u[0]-this._camera.position[0],u[1]-this._camera.position[1]);i+=u[3]*c,o+=c}return 0===o?NaN:i/o}get center(){return this._center}set center(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._terrainEnabled()&&("ground"===this.cameraElevationReference?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(null==this._seaLevelZoom||!this._elevation)return;const e=this._seaLevelZoom,t=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),r=this.pixelsPerMeter/this.worldSize*t,n=this._mercatorZfromZoom(e),i=this._mercatorZfromZoom(this._maxZoom),o=Math.max(n-r,i);this._setZoom(this._zoomFromMercatorZ(o))}get padding(){return this._edgeInsets.toJSON()}set padding(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}computeZoomRelativeTo(t){const r=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,t.toAltitude()));let n;n=t.z<this._camera.position[2]?[r.x,r.y,r.z]:[t.x,t.y,t.z];const i=e.length(e.sub([],this._camera.position,n));return e.clamp(this._zoomFromMercatorZ(i),this._minZoom,this._maxZoom)}setFreeCameraOptions(t){if(!this.height)return;if(!t.position&&!t.orientation)return;this._updateCameraState();let r=!1;if(t.orientation&&!e.exactEquals(t.orientation,this._camera.orientation)&&(r=this._setCameraOrientation(t.orientation)),t.position){const n=[t.position.x,t.position.y,t.position.z];e.exactEquals$1(n,this._camera.position)||(this._setCameraPosition(n),r=!0)}r&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const t=this._camera.position,r=new Vn;return r.position=new e.MercatorCoordinate(t[0],t[1],t[2]),r.orientation=this._camera.orientation,r._elevation=this.elevation,r._renderWorldCopies=this.renderWorldCopies,r}_setCameraOrientation(t){if(!e.length$1(t))return!1;e.normalize$1(t,t);const r=e.transformQuat([],[0,0,-1],t),n=e.transformQuat([],[0,-1,0],t);if(n[2]<0)return!1;const i=jn(r,n);return!!i&&(this._camera.orientation=i,!0)}_setCameraPosition(t){const r=this.zoomScale(this.minZoom)*this.tileSize,n=this.zoomScale(this.maxZoom)*this.tileSize,i=this.cameraToCenterDistance;t[2]=e.clamp(t[2],i/n,i/r),this._camera.position=t}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(e){return this._edgeInsets.equals(e)}interpolatePadding(e,t,r){this._unmodified=!1,this._edgeInsets.interpolate(e,t,r),this._constrain(),this._calcMatrices()}coveringZoomLevel(e){const t=(e.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/e.tileSize));return Math.max(0,t)}getVisibleUnwrappedCoordinates(t){const r=[new e.UnwrappedTileID(0,t)];if(this.renderWorldCopies){const n=this.pointCoordinate(new e.pointGeometry(0,0)),i=this.pointCoordinate(new e.pointGeometry(this.width,0)),o=this.pointCoordinate(new e.pointGeometry(this.width,this.height)),a=this.pointCoordinate(new e.pointGeometry(0,this.height)),s=Math.floor(Math.min(n.x,i.x,o.x,a.x)),u=Math.floor(Math.max(n.x,i.x,o.x,a.x)),c=1;for(let l=s-c;l<=u+c;l++)0!==l&&r.push(new e.UnwrappedTileID(l,t))}return r}coveringTiles(t){let r=this.coveringZoomLevel(t);const n=r,i=this.elevation&&!t.isTerrainDEM,o="mercator"===this.projection.name;if(void 0!==t.minzoom&&r<t.minzoom)return[];void 0!==t.maxzoom&&r>t.maxzoom&&(r=t.maxzoom);const a=this.locationCoordinate(this.center),s=this.center.lat,u=1<<r,c=[u*a.x,u*a.y,0],l="globe"===this.projection.name,h=!l,f=e.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,r,h),d=l?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),p=u*e.mercatorZfromAltitude(1,this.center.lat),m=this._camera.position[2]/e.mercatorZfromAltitude(1,this.center.lat),g=[u*d.x,u*d.y,m*(h?1:p)],y=this.cameraToCenterDistance/t.tileSize*(t.roundZoom?1:.502),v=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?r:0,_=t.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,b=t.isTerrainDEM?-_:this._elevation?this._elevation.getMinElevationBelowMSL():0,x=this.projection.isReprojectedInTileSpace?Gn(this):1,w=t=>{const r=1/4e4,n=new e.MercatorCoordinate(t.x+r,t.y,t.z),i=new e.MercatorCoordinate(t.x,t.y+r,t.z),o=t.toLngLat(),a=n.toLngLat(),s=i.toLngLat(),u=this.locationCoordinate(o),c=this.locationCoordinate(a),l=this.locationCoordinate(s),h=Math.hypot(c.x-u.x,c.y-u.y),f=Math.hypot(l.x-u.x,l.y-u.y);return Math.sqrt(h*f)*x/r},k=t=>{const r=_,n=b;return{aabb:e.tileAABB(this,u,0,0,0,t,n,r,this.projection),zoom:0,x:0,y:0,minZ:n,maxZ:r,wrap:t,fullyVisible:!1}},A=[];let E=[];const S=r,T=t.reparseOverscaled?n:r,M=e=>e*e,I=M((m-this._centerAltitude)*p),P=e=>{if(!this._elevation||!e.tileID||!o)return;const t=this._elevation.getMinMaxForTile(e.tileID),r=e.aabb;t?(r.min[2]=t.min,r.max[2]=t.max,r.center[2]=(r.min[2]+r.max[2])/2):(e.shouldSplit=C(e),e.shouldSplit||(r.min[2]=r.max[2]=r.center[2]=this._centerAltitude))},C=t=>{if(t.zoom<v)return!0;if(t.zoom===S)return!1;if(null!=t.shouldSplit)return t.shouldSplit;const r=t.aabb.distanceX(g),o=t.aabb.distanceY(g);let a=I,u=1;if(l){a=M(t.aabb.distanceZ(g));const r=Math.pow(2,t.zoom),n=e.latFromMercatorY((t.y+1)/r),i=e.latFromMercatorY(t.y/r),o=Math.min(Math.max(s,n),i),c=e.circumferenceAtLatitude(o)/e.circumferenceAtLatitude(s);if(u=o===s?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,c/this._mercatorScaleRatio),this.zoom<=e.GLOBE_ZOOM_THRESHOLD_MIN&&t.zoom===S-1&&c>=.9)return!0}else if(i&&(a=M(t.aabb.distanceZ(g)*p)),this.projection.isReprojectedInTileSpace&&n<=5){const r=Math.pow(2,t.zoom),n=w(new e.MercatorCoordinate((t.x+.5)/r,(t.y+.5)/r));u=n>.85?1:n}const c=r*r+o*o+a,h=M((1<<S-t.zoom)*y*u*((e,t)=>{if(t*M(.707)<e)return 1;const r=Math.sqrt(t/e);return r/(1.4144271570014144+(Math.pow(1.1,r-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(a,I),c));return c<h};if(this.renderWorldCopies)for(let e=1;e<=3;e++)A.push(k(-e)),A.push(k(e));for(A.push(k(0));A.length>0;){const n=A.pop(),a=n.x,s=n.y;let h=n.fullyVisible;if(!h){const e=n.aabb.intersects(f);if(0===e)continue;h=2===e}if(n.zoom!==S&&C(n))for(let t=0;t<4;t++){const r=(a<<1)+t%2,c=(s<<1)+(t>>1),f={aabb:o?n.aabb.quadrant(t):e.tileAABB(this,u,n.zoom+1,r,c,n.wrap,n.minZ,n.maxZ,this.projection),zoom:n.zoom+1,x:r,y:c,wrap:n.wrap,fullyVisible:h,tileID:void 0,shouldSplit:void 0,minZ:n.minZ,maxZ:n.maxZ};i&&!l&&(f.tileID=new e.OverscaledTileID(n.zoom+1===S?T:n.zoom+1,n.wrap,n.zoom+1,r,c),P(f)),A.push(f)}else{const i=n.zoom===S?T:n.zoom;if(t.minzoom&&t.minzoom>i)continue;const o=c[0]-(.5+a+(n.wrap<<n.zoom))*(1<<r-n.zoom),u=c[1]-.5-s,l=n.tileID?n.tileID:new e.OverscaledTileID(i,n.wrap,n.zoom,a,s);E.push({tileID:l,distanceSq:o*o+u*u})}}if(this.fogCullDistSq){const r=this.fogCullDistSq,n=this.horizonLineFromTop();E=E.filter((i=>{const o=[0,0,0,1],a=[e.EXTENT,e.EXTENT,0,1],s=this.calculateFogTileMatrix(i.tileID.toUnwrapped());e.transformMat4$1(o,o,s),e.transformMat4$1(a,a,s);const u=e.getAABBPointSquareDist(o,a);if(0===u)return!0;let c=!1;const l=this._elevation;if(l&&u>r&&0!==n){const r=this.calculateProjMatrix(i.tileID.toUnwrapped());let o;t.isTerrainDEM||(o=l.getMinMaxForTile(i.tileID)),o||(o={min:b,max:_});const a=e.furthestTileCorner(this.rotation),s=[a[0]*e.EXTENT,a[1]*e.EXTENT,o.max];e.transformMat4(s,s,r),c=(1-s[1])*this.height*.5<n}return u<r||c}))}return E.sort(((e,t)=>e.distanceSq-t.distanceSq)).map((e=>e.tileID))}resize(e,t){this.width=e,this.height=t,this.pixelsToGLUnits=[2/e,-2/t],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(e){return Math.pow(2,e)}scaleZoom(e){return Math.log(e)/Math.LN2}project(t){const r=e.clamp(t.lat,-e.MAX_MERCATOR_LATITUDE,e.MAX_MERCATOR_LATITUDE),n=this.projection.project(t.lng,r);return new e.pointGeometry(n.x*this.worldSize,n.y*this.worldSize)}unproject(e){return this.projection.unproject(e.x/this.worldSize,e.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/e.mercatorZfromAltitude(1,this.center.lat)/this.worldSize}setLocationAtPoint(t,r){let n,i;const o=this.centerPoint;if("globe"===this.projection.name){const e=this.worldSize;n=(r.x-o.x)/e,i=(r.y-o.y)/e}else{const e=this.pointCoordinate(r),t=this.pointCoordinate(o);n=e.x-t.x,i=e.y-t.y}const a=this.locationCoordinate(t);this.setLocation(new e.MercatorCoordinate(a.x-n,a.y-i))}setLocation(e){this.center=this.coordinateLocation(e),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(e){return this.projection.locationPoint(this,e)}locationPoint3D(e){return this.projection.locationPoint(this,e,!0)}pointLocation(e){return this.coordinateLocation(this.pointCoordinate(e))}pointLocation3D(e){return this.coordinateLocation(this.pointCoordinate3D(e))}locationCoordinate(t,r){const n=r?e.mercatorZfromAltitude(r,t.lat):void 0,i=this.projection.project(t.lng,t.lat);return new e.MercatorCoordinate(i.x,i.y,n)}coordinateLocation(e){return this.projection.unproject(e.x,e.y)}pointRayIntersection(t,r){const n=null!=r?r:this._centerAltitude,i=[t.x,t.y,0,1],o=[t.x,t.y,1,1];e.transformMat4$1(i,i,this.pixelMatrixInverse),e.transformMat4$1(o,o,this.pixelMatrixInverse);const a=o[3];e.scale$1(i,i,1/i[3]),e.scale$1(o,o,1/a);const s=i[2],u=o[2];return{p0:i,p1:o,t:s===u?0:(n-s)/(u-s)}}screenPointToMercatorRay(t){const r=[t.x,t.y,0,1],n=[t.x,t.y,1,1];return e.transformMat4$1(r,r,this.pixelMatrixInverse),e.transformMat4$1(n,n,this.pixelMatrixInverse),e.scale$1(r,r,1/r[3]),e.scale$1(n,n,1/n[3]),r[2]=e.mercatorZfromAltitude(r[2],this._center.lat)*this.worldSize,n[2]=e.mercatorZfromAltitude(n[2],this._center.lat)*this.worldSize,e.scale$1(r,r,1/this.worldSize),e.scale$1(n,n,1/this.worldSize),new e.Ray([r[0],r[1],r[2]],e.normalize([],e.sub([],n,r)))}rayIntersectionCoordinate(t){const{p0:r,p1:n,t:i}=t,o=e.mercatorZfromAltitude(r[2],this._center.lat),a=e.mercatorZfromAltitude(n[2],this._center.lat);return new e.MercatorCoordinate(e.number(r[0],n[0],i)/this.worldSize,e.number(r[1],n[1],i)/this.worldSize,e.number(o,a,i))}pointCoordinate(e,t=this._centerAltitude){return this.projection.pointCoordinate(this,e.x,e.y,t)}pointCoordinate3D(t){if(!this.elevation)return this.pointCoordinate(t);let r=this.projection.pointCoordinate3D(this,t.x,t.y);if(r)return new e.MercatorCoordinate(r[0],r[1],r[2]);let n=0,i=this.horizonLineFromTop();if(t.y>i)return this.pointCoordinate(t);const o=.02*i,a=t.clone();for(let s=0;s<10&&i-n>o;s++){a.y=e.number(n,i,.66);const t=this.projection.pointCoordinate3D(this,a.x,a.y);t?(i=a.y,r=t):n=a.y}return r?new e.MercatorCoordinate(r[0],r[1],r[2]):this.pointCoordinate(t)}isPointAboveHorizon(e){return this.projection.isPointAboveHorizon(this,e)}_coordinatePoint(t,r){const n=r&&this.elevation?this.elevation.getAtPointOrZero(t,this._centerAltitude):this._centerAltitude,i=[t.x*this.worldSize,t.y*this.worldSize,n+t.toAltitude(),1];return e.transformMat4$1(i,i,this.pixelMatrix),i[3]>0?new e.pointGeometry(i[0]/i[3],i[1]/i[3]):new e.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:t,left:r}=this._edgeInsets,n=this.height-this._edgeInsets.bottom,i=this.width-this._edgeInsets.right,o=this.pointLocation3D(new e.pointGeometry(r,t)),a=this.pointLocation3D(new e.pointGeometry(i,t)),s=this.pointLocation3D(new e.pointGeometry(i,n)),u=this.pointLocation3D(new e.pointGeometry(r,n));let c=Math.min(o.lng,a.lng,s.lng,u.lng),l=Math.max(o.lng,a.lng,s.lng,u.lng),h=Math.min(o.lat,a.lat,s.lat,u.lat),f=Math.max(o.lat,a.lat,s.lat,u.lat);const d=Math.pow(2,-this.zoom)/16*270,p="globe"===this.projection.name?1:4,m=(t,r,n,i,o)=>{const a=(t+n)/2,s=(r+i)/2,u=new e.pointGeometry(a,s),{lng:g,lat:y}=this.pointLocation3D(u),v=Math.max(0,c-g,h-y,g-l,y-f);c=Math.min(c,g),l=Math.max(l,g),h=Math.min(h,y),f=Math.max(f,y),(o<p||v>d)&&(m(t,r,a,s,o+1),m(a,s,n,i,o+1))};if(m(r,t,i,t,1),m(i,t,i,n,1),m(i,n,r,n,1),m(r,n,r,t,1),"globe"===this.projection.name){const[t,r]=e.polesInViewport(this);t?(f=90,l=180,c=-180):r&&(h=-90,l=180,c=-180)}return new e.LngLatBounds(new e.LngLat(c,h),new e.LngLat(l,f))}_getBoundsRectangular(t,r){const{top:n,left:i}=this._edgeInsets,o=this.height-this._edgeInsets.bottom,a=this.width-this._edgeInsets.right,s=new e.pointGeometry(i,n),u=new e.pointGeometry(a,n),c=new e.pointGeometry(a,o),l=new e.pointGeometry(i,o);let h=this.pointCoordinate(s,t),f=this.pointCoordinate(u,t);const d=this.pointCoordinate(c,r),p=this.pointCoordinate(l,r),m=(e,t)=>(t.y-e.y)/(t.x-e.x);return h.y>1&&f.y>=0?h=new e.MercatorCoordinate((1-p.y)/m(p,h)+p.x,1):h.y<0&&f.y<=1&&(h=new e.MercatorCoordinate(-p.y/m(p,h)+p.x,0)),f.y>1&&h.y>=0?f=new e.MercatorCoordinate((1-d.y)/m(d,f)+d.x,1):f.y<0&&h.y<=1&&(f=new e.MercatorCoordinate(-d.y/m(d,f)+d.x,0)),(new e.LngLatBounds).extend(this.coordinateLocation(h)).extend(this.coordinateLocation(f)).extend(this.coordinateLocation(p)).extend(this.coordinateLocation(d))}_getBoundsRectangularTerrain(){const e=this.elevation;if(!e.visibleDemTiles.length||e.isUsingMockSource())return this._getBoundsRectangular(0,0);const t=e.visibleDemTiles.reduce(((e,t)=>{if(t.dem){const r=t.dem.tree;e.min=Math.min(e.min,r.minimums[0]),e.max=Math.max(e.max,r.maximums[0])}return e}),{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(t.min*e.exaggeration(),t.max*e.exaggeration())}getBounds(){return"mercator"===this.projection.name||"equirectangular"===this.projection.name?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(e=!0){const t=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,r=this.height/2-t*(1-this._horizonShift);return e?Math.max(0,r):r}getMaxBounds(){return this.maxBounds}setMaxBounds(t){this.maxBounds=t,this.minLat=-e.MAX_MERCATOR_LATITUDE,this.maxLat=e.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,t&&(this.minLat=t.getSouth(),this.maxLat=t.getNorth(),this.minLng=t.getWest(),this.maxLng=t.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=e.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=e.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=e.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=e.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(e,t){return this.projection.createTileMatrix(this,t,e)}calculateDistanceTileData(t){const r=t.key,n=this._distanceTileDataCache;if(n[r])return n[r];const i=t.canonical,o=1/this.height,a=this.cameraWorldSize,s=a/this.zoomScale(i.z),u=(i.x+Math.pow(2,i.z)*t.wrap)*s,c=i.y*s,l=this.point;l.x*=a/this.worldSize,l.y*=a/this.worldSize;const h=this.angle,f=Math.sin(-h),d=-Math.cos(-h);return n[r]={bearing:[f,d],center:[(l.x-u)*o,(l.y-c)*o],scale:s/e.EXTENT*o},n[r]}calculateFogTileMatrix(t){const r=t.key,n=this._fogTileMatrixCache;if(n[r])return n[r];const i=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,t);return e.multiply(i,this.worldToFogMatrix,i),n[r]=new Float32Array(i),n[r]}calculateProjMatrix(t,r=!1){const n=t.key,i=r?this._alignedProjMatrixCache:this._projMatrixCache;if(i[n])return i[n];const o=this.calculatePosMatrix(t,this.worldSize);return e.multiply(o,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:r?this.alignedProjMatrix:this.projMatrix,o),i[n]=new Float32Array(o),i[n]}calculatePixelsToTileUnitsMatrix(t){const r=t.tileID.key,n=this._pixelsToTileUnitsCache;if(n[r])return n[r];const i=function(t,r){const{scale:n}=t.tileTransform,i=n*e.EXTENT/(t.tileSize*Math.pow(2,r.zoom-t.tileID.overscaledZ+t.tileID.canonical.z));return o=new Float32Array(4),u=(a=r.inverseAdjustmentMatrix)[1],c=a[2],l=a[3],f=(s=[i,i])[1],o[0]=a[0]*(h=s[0]),o[1]=u*h,o[2]=c*f,o[3]=l*f,o;var o,a,s,u,c,l,h,f}(t,this);return n[r]=i,n[r]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if("globe"===this.projection.name){const t=1/this.worldSize,r=e.fromScaling([],[t,t,t]);return e.multiply(r,r,this.globeMatrix),r}}recenterOnTerrain(){if(!this._elevation||"globe"===this.projection.name)return;const t=this._elevation;this._updateCameraState();const r=e.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,n=this._computeCameraPosition(r),i=this._camera.forward(),o=e.mercatorZfromAltitude(1,this._center.lat);n[2]/=o,i[2]/=o,e.normalize(i,i);const a=t.raycast(n,i,t.exaggeration());if(a){const t=e.scaleAndAdd([],n,i,a),r=new e.MercatorCoordinate(t[0],t[1],e.mercatorZfromAltitude(t[2],e.latFromMercatorY(t[1]))),s=(r.z+e.length([r.x-n[0],r.y-n[1],r.z-n[2]*o]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(s),this._centerAltitude=r.toAltitude(),this._center=this.coordinateLocation(r),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(t=!1){if(!this._elevation)return;const r=this._elevation,n=e.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,i=this._computeCameraPosition(n),o=r.getAtPointOrZero(new e.MercatorCoordinate(...i)),a=this.pixelsPerMeter/this.worldSize*o,s=this._minimumHeightOverTerrain(),u=i[2]-a;if(u<=s)if(u<0||t){const t=this.locationCoordinate(this._center,this._centerAltitude),r=[i[0],i[1],t.z-i[2]],n=e.length(r);r[2]-=(s-u)/this._pixelsPerMercatorPixel;const o=e.length(r);if(0===o)return;e.scale$2(r,r,n/o*this._pixelsPerMercatorPixel),this._camera.position=[i[0],i[1],t.z*this._pixelsPerMercatorPixel-r[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const t="globe"===this.projection.name||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||t){const r=this.center;return r.lat=e.clamp(r.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!t)&&(r.lng=e.clamp(r.lng,this.minLng,this.maxLng)),this.center=r,void(this._constraining=!1)}const r=this._unmodified,{x:n,y:i}=this.point;let o=0,a=n,s=i;const u=this.width/2,c=this.height/2,l=this.worldMinY*this.scale,h=this.worldMaxY*this.scale;if(i-c<l&&(s=l+c),i+c>h&&(s=h-c),h-l<this.height&&(o=Math.max(o,this.height/(h-l)),s=(h+l)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const e=this.worldMinX*this.scale,t=this.worldMaxX*this.scale,r=this.worldSize/2-(e+t)/2;a=(n+r+this.worldSize)%this.worldSize-r,a-u<e&&(a=e+u),a+u>t&&(a=t-u),t-e<this.width&&(o=Math.max(o,this.width/(t-e)),a=(t+e)/2)}a===n&&s===i||(this.center=this.unproject(new e.pointGeometry(a,s))),o&&(this.zoom+=this.scaleZoom(o)),this._constrainCamera(),this._unmodified=r,this._constraining=!1}_minZoomForBounds(){let e=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(e=Math.max(e,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),e}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const t=this.centerOffset,r=this.pixelsPerMeter;"globe"===this.projection.name&&(this._mercatorScaleRatio=e.mercatorZfromAltitude(1,this.center.lat)/e.mercatorZfromAltitude(1,e.GLOBE_SCALE_MATCH_LATITUDE));const n=Hn(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,n),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const i="meters"===this.projection.zAxisUnit?r:1,o=this._camera.getWorldToCamera(this.worldSize,i),a=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);a[8]=2*-t.x/this.width,a[9]=2*t.y/this.height;let s=e.mul([],a,o);if(this.projection.isReprojectedInTileSpace){const t=this.locationCoordinate(this.center),r=e.identity([]);e.translate(r,r,[t.x*this.worldSize,t.y*this.worldSize,0]),e.multiply(r,r,Kn(this)),e.translate(r,r,[-t.x*this.worldSize,-t.y*this.worldSize,0]),e.multiply(s,s,r),this.inverseAdjustmentMatrix=function(e){const t=Kn(e,!0);return v([],[t[0],t[1],t[4],t[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=e.scale([],s,[this.worldSize,this.worldSize,this.worldSize/i,1]),this.projMatrix=s,this.invProjMatrix=e.invert(new Float64Array(16),this.projMatrix);const u=e.invert([],a);this.frustumCorners=e.FrustumCorners.fromInvProjectionMatrix(u,this.horizonLineFromTop(),this.height);const c=new Float32Array(16);e.identity(c),e.scale(c,c,[1,-1,1]),e.rotateX(c,c,this._pitch),e.rotateZ(c,c,this.angle);const l=e.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),h=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;l[8]=2*-t.x/this.width,l[9]=2*(t.y+h)/this.height,this.skyboxMatrix=e.multiply(c,l,c);const f=this.point,d=f.x,p=f.y,m=this.width%2/2,g=this.height%2/2,y=Math.cos(this.angle),_=Math.sin(this.angle),b=d-Math.round(d)+y*m+_*g,x=p-Math.round(p)+y*g+_*m,w=new Float64Array(s);if(e.translate(w,w,[b>.5?b-1:b,x>.5?x-1:x,0]),this.alignedProjMatrix=w,s=e.create(),e.scale(s,s,[this.width/2,-this.height/2,1]),e.translate(s,s,[1,-1,0]),this.labelPlaneMatrix=s,s=e.create(),e.scale(s,s,[1,-1,1]),e.translate(s,s,[-1,-1,0]),e.scale(s,s,[2/this.width,2/this.height,1]),this.glCoordMatrix=s,this.pixelMatrix=e.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},s=e.invert(new Float64Array(16),this.pixelMatrix),!s)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=s,"globe"===this.projection.name||this.mercatorFromTransition){this.globeMatrix=e.calculateGlobeMatrix(this);const t=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=e.transformMat4(t,t,o),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=s;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const t=this.cameraWorldSizeForFog,r=this.cameraPixelsPerMeter,n=this._camera.position,i=1/this.height/this._pixelsPerMercatorPixel,o=[t,t,r];e.scale$2(o,o,i),e.scale$2(n,n,-1),e.multiply$2(n,n,o);const a=e.create();e.translate(a,a,n),e.scale(a,a,o),this.mercatorFogMatrix=a,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(t,r,i)}_computeCameraPosition(e){const t=(e=e||this.pixelsPerMeter)/this.pixelsPerMeter,r=this._camera.forward(),n=this.point,i=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*t-e/this.worldSize*this._centerAltitude;return[n.x/this.worldSize-r[0]*i,n.y/this.worldSize-r[1]*i,e/this.worldSize*this._centerAltitude-r[2]*i]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(t){const r=this._maxCameraBoundsDistance()*Math.cos(this._pitch),n=this._camera.position[2],i=t[2];let o=1;this.projection.wrap&&(this.center=this.center.wrap()),i>0&&(o=Math.min((r-n)/i,1)),this._camera.position=e.scaleAndAdd([],this._camera.position,t,o),this._updateStateFromCamera()}_updateStateFromCamera(){const t=this._camera.position,r=this._camera.forward(),{pitch:n,bearing:i}=this._camera.getPitchBearing(),o=e.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,a=this._mercatorZfromZoom(this._maxZoom)*Math.cos(e.degToRad(this._maxPitch)),s=Math.max((t[2]-o)/Math.cos(n),a),u=this._zoomFromMercatorZ(s);e.scaleAndAdd(t,t,r,s),this._pitch=e.clamp(n,e.degToRad(this.minPitch),e.degToRad(this.maxPitch)),this.angle=e.wrap(i,-Math.PI,Math.PI),this._setZoom(e.clamp(u,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new e.MercatorCoordinate(t[0],t[1],t[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(e){return Math.pow(2,e)*this.tileSize}_mercatorZfromZoom(e){return this.cameraToCenterDistance/this._worldSizeFromZoom(e)}_minimumHeightOverTerrain(){const e=Math.min((null!=this._seaLevelZoom?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(e)}_zoomFromMercatorZ(e){return this.scaleZoom(this.cameraToCenterDistance/(e*this.tileSize))}zoomFromMercatorZAdjusted(t){let r=0,n=e.GLOBE_ZOOM_THRESHOLD_MAX,i=0,o=1/0;for(;n-r>1e-6&&n>r;){const e=r+.5*(n-r),a=this.tileSize*Math.pow(2,e),s=this.getCameraToCenterDistance(this.projection,e,a),u=this.scaleZoom(s/(t*this.tileSize)),c=Math.abs(e-u);c<o&&(o=c,i=e),e<u?r=e:n=e}return i}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(e.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(t,r){const n=Math.min(t.x,r.x),i=Math.max(t.x,r.x),o=Math.min(t.y,r.y),a=Math.max(t.y,r.y);if(o<this.horizonLineFromTop(!1))return!0;if("mercator"!==this.projection.name)return!1;const s=[new e.pointGeometry(n,o),new e.pointGeometry(i,a),new e.pointGeometry(n,a),new e.pointGeometry(i,o)],u=this.renderWorldCopies?-3:0,c=this.renderWorldCopies?4:1;for(const e of s){const t=this.pointRayIntersection(e);if(t.t<0)return!0;const r=this.rayIntersectionCoordinate(t);if(r.x<u||r.y<0||r.x>c||r.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+e.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new e.pointGeometry(0,0),new e.pointGeometry(this.width,this.height))}zoomDeltaToMovement(t,r){const n=e.length(e.sub([],this._camera.position,t)),i=this._zoomFromMercatorZ(n)+r;return n-this._mercatorZfromZoom(i)}getCameraPoint(){if("globe"===this.projection.name){const t=function([t,r,n],i){const o=[t,r,n,1];e.transformMat4$1(o,o,i);const a=o[3]=Math.max(o[3],1e-6);return o[0]/=a,o[1]/=a,o[2]/=a,o}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new e.pointGeometry(t[0],t[1])}{const t=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new e.pointGeometry(0,t))}}getCameraToCenterDistance(e,t=this.zoom,r=this.worldSize){const n=Hn(e,t,this.width,this.height,1024),i=e.pixelSpaceConversion(this.center.lat,r,n);return.5/Math.tan(.5*this._fov)*this.height*i}getWorldToCameraMatrix(){const t=this._camera.getWorldToCamera(this.worldSize,"meters"===this.projection.zAxisUnit?this.pixelsPerMeter:1);return"globe"===this.projection.name&&e.multiply(t,t,this.globeMatrix),t}}function $n(e,t){let r=!1,n=null;const i=()=>{n=null,r&&(e(),n=setTimeout(i,t),r=!1)};return()=>(r=!0,n||i(),n)}class Jn{constructor(t){this._hashName=t&&encodeURIComponent(t),e.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=$n(this._updateHashUnthrottled.bind(this),300)}addTo(t){return this._map=t,e.window.addEventListener("hashchange",this._onHashChange,!1),t.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),e.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const t=this._map;if(!t)return"";const r=ei(t);if(this._hashName){const t=this._hashName;let n=!1;const i=e.window.location.hash.slice(1).split("&").map((e=>{const i=e.split("=")[0];return i===t?(n=!0,`${i}=${r}`):e})).filter((e=>e));return n||i.push(`${t}=${r}`),`#${i.join("&")}`}return`#${r}`}_getCurrentHash(){const t=e.window.location.hash.replace("#","");if(this._hashName){let e;return t.split("&").map((e=>e.split("="))).forEach((t=>{t[0]===this._hashName&&(e=t)})),(e&&e[1]||"").split("/")}return t.split("/")}_onHashChange(){const e=this._map;if(!e)return!1;const t=this._getCurrentHash();if(t.length>=3&&!t.some((e=>isNaN(e)))){const r=e.dragRotate.isEnabled()&&e.touchZoomRotate.isEnabled()?+(t[3]||0):e.getBearing();return e.jumpTo({center:[+t[2],+t[1]],zoom:+t[0],bearing:r,pitch:+(t[4]||0)}),!0}return!1}_updateHashUnthrottled(){const t=e.window.location.href.replace(/(#.+)?$/,this.getHashString());e.window.history.replaceState(e.window.history.state,null,t)}}function ei(e,t){const r=e.getCenter(),n=Math.round(100*e.getZoom())/100,i=Math.ceil((n*Math.LN2+Math.log(512/360/.5))/Math.LN10),o=Math.pow(10,i),a=Math.round(r.lng*o)/o,s=Math.round(r.lat*o)/o,u=e.getBearing(),c=e.getPitch();let l=t?`/${a}/${s}/${n}`:`${n}/${s}/${a}`;return(u||c)&&(l+="/"+Math.round(10*u)/10),c&&(l+=`/${Math.round(c)}`),l}const ti={linearity:.3,easing:e.bezier(0,0,.3,1)},ri=e.extend({deceleration:2500,maxSpeed:1400},ti),ni=e.extend({deceleration:20,maxSpeed:1400},ti),ii=e.extend({deceleration:1e3,maxSpeed:360},ti),oi=e.extend({deceleration:1e3,maxSpeed:90},ti);class ai{constructor(e){this._map=e,this.clear()}clear(){this._inertiaBuffer=[]}record(t){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:e.exported.now(),settings:t})}_drainInertiaBuffer(){const t=this._inertiaBuffer,r=e.exported.now();for(;t.length>0&&r-t[0].time>160;)t.shift()}_onMoveEnd(t){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const r={zoom:0,bearing:0,pitch:0,pan:new e.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:e}of this._inertiaBuffer)r.zoom+=e.zoomDelta||0,r.bearing+=e.bearingDelta||0,r.pitch+=e.pitchDelta||0,e.panDelta&&r.pan._add(e.panDelta),e.around&&(r.around=e.around),e.pinchAround&&(r.pinchAround=e.pinchAround);const n=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,i={};if(r.pan.mag()){const o=ui(r.pan.mag(),n,e.extend({},ri,t||{}));i.offset=r.pan.mult(o.amount/r.pan.mag()),i.center=this._map.transform.center,si(i,o)}if(r.zoom){const e=ui(r.zoom,n,ni);i.zoom=this._map.transform.zoom+e.amount,si(i,e)}if(r.bearing){const t=ui(r.bearing,n,ii);i.bearing=this._map.transform.bearing+e.clamp(t.amount,-179,179),si(i,t)}if(r.pitch){const e=ui(r.pitch,n,oi);i.pitch=this._map.transform.pitch+e.amount,si(i,e)}if(i.zoom||i.bearing){const e=void 0===r.pinchAround?r.around:r.pinchAround;i.around=e?this._map.unproject(e):this._map.getCenter()}return this.clear(),i.noMoveStart=!0,i}}function si(e,t){(!e.duration||e.duration<t.duration)&&(e.duration=t.duration,e.easing=t.easing)}function ui(t,r,n){const{maxSpeed:i,linearity:o,deceleration:a}=n,s=e.clamp(t*o/(r/1e3),-i,i),u=Math.abs(s)/(a*o);return{easing:n.easing,duration:1e3*u,amount:s*(u/2)}}class ci extends e.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,r,n,i={}){const o=p(r.getCanvasContainer(),n),a=r.unproject(o);super(t,e.extend({point:o,lngLat:a,originalEvent:n},i)),this._defaultPrevented=!1,this.target=r}}class li extends e.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(t,r,n){const i="touchend"===t?n.changedTouches:n.touches,o=m(r.getCanvasContainer(),i),a=o.map((e=>r.unproject(e))),s=o.reduce(((e,t,r,n)=>e.add(t.div(n.length))),new e.pointGeometry(0,0));super(t,{points:o,point:s,lngLats:a,lngLat:r.unproject(s),originalEvent:n}),this._defaultPrevented=!1}}class hi extends e.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,t,r){super(e,{originalEvent:r}),this._defaultPrevented=!1}}class fi{constructor(e,t){this._map=e,this._clickTolerance=t.clickTolerance}reset(){this._mousedownPos=void 0}wheel(e){return this._firePreventable(new hi(e.type,this._map,e))}mousedown(e,t){return this._mousedownPos=t,this._firePreventable(new ci(e.type,this._map,e))}mouseup(e){this._map.fire(new ci(e.type,this._map,e))}preclick(t){const r=e.extend({},t);r.type="preclick",this._map.fire(new ci(r.type,this._map,r))}click(e,t){this._mousedownPos&&this._mousedownPos.dist(t)>=this._clickTolerance||(this.preclick(e),this._map.fire(new ci(e.type,this._map,e)))}dblclick(e){return this._firePreventable(new ci(e.type,this._map,e))}mouseover(e){this._map.fire(new ci(e.type,this._map,e))}mouseout(e){this._map.fire(new ci(e.type,this._map,e))}touchstart(e){return this._firePreventable(new li(e.type,this._map,e))}touchmove(e){this._map.fire(new li(e.type,this._map,e))}touchend(e){this._map.fire(new li(e.type,this._map,e))}touchcancel(e){this._map.fire(new li(e.type,this._map,e))}_firePreventable(e){if(this._map.fire(e),e.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class di{constructor(e){this._map=e}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(e){this._map.fire(new ci(e.type,this._map,e))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new ci("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(e){this._delayContextMenu?this._contextMenuEvent=e:this._map.fire(new ci(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class pi{constructor(e,t){this._map=e,this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=t.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(e,t){this.isEnabled()&&e.shiftKey&&0===e.button&&(l(),this._startPos=this._lastPos=t,this._active=!0)}mousemoveWindow(e,t){if(!this._active)return;const r=t,n=this._startPos,i=this._lastPos;if(!n||!i||i.equals(r)||!this._box&&r.dist(n)<this._clickTolerance)return;this._lastPos=r,this._box||(this._box=o("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",e));const a=Math.min(n.x,r.x),s=Math.max(n.x,r.x),u=Math.min(n.y,r.y),c=Math.max(n.y,r.y);this._map._requestDomTask((()=>{this._box&&(this._box.style.transform=`translate(${a}px,${u}px)`,this._box.style.width=s-a+"px",this._box.style.height=c-u+"px")}))}mouseupWindow(t,r){if(!this._active)return;const n=this._startPos,i=r;if(n&&0===t.button){if(this.reset(),d(),n.x!==i.x||n.y!==i.y)return this._map.fire(new e.Event("boxzoomend",{originalEvent:t})),{cameraAnimation:e=>e.fitScreenCoordinates(n,i,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",t)}}keydown(e){this._active&&27===e.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",e))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),h(),delete this._startPos,delete this._lastPos}_fireEvent(t,r){return this._map.fire(new e.Event(t,{originalEvent:r}))}}function mi(e,t){const r={};for(let n=0;n<e.length;n++)r[e[n].identifier]=t[n];return r}class gi{constructor(e){this.reset(),this.numTouches=e.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(t,r,n){(this.centroid||n.length>this.numTouches)&&(this.aborted=!0),this.aborted||(0===this.startTime&&(this.startTime=t.timeStamp),n.length===this.numTouches&&(this.centroid=function(t){const r=new e.pointGeometry(0,0);for(const e of t)r._add(e);return r.div(t.length)}(r),this.touches=mi(n,r)))}touchmove(e,t,r){if(this.aborted||!this.centroid)return;const n=mi(r,t);for(const i in this.touches){const e=this.touches[i],t=n[i];(!t||t.dist(e)>30)&&(this.aborted=!0)}}touchend(e,t,r){if((!this.centroid||e.timeStamp-this.startTime>500)&&(this.aborted=!0),0===r.length){const e=!this.aborted&&this.centroid;if(this.reset(),e)return e}}}class yi{constructor(e){this.singleTap=new gi(e),this.numTaps=e.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(e,t,r){this.singleTap.touchstart(e,t,r)}touchmove(e,t,r){this.singleTap.touchmove(e,t,r)}touchend(e,t,r){const n=this.singleTap.touchend(e,t,r);if(n){const t=e.timeStamp-this.lastTime<500,r=!this.lastTap||this.lastTap.dist(n)<30;if(t&&r||this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=n,this.count===this.numTaps)return this.reset(),n}}}class vi{constructor(){this._zoomIn=new yi({numTouches:1,numTaps:2}),this._zoomOut=new yi({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(e,t,r){this._zoomIn.touchstart(e,t,r),this._zoomOut.touchstart(e,t,r)}touchmove(e,t,r){this._zoomIn.touchmove(e,t,r),this._zoomOut.touchmove(e,t,r)}touchend(e,t,r){const n=this._zoomIn.touchend(e,t,r),i=this._zoomOut.touchend(e,t,r);return n?(this._active=!0,e.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:t=>t.easeTo({duration:300,zoom:t.getZoom()+1,around:t.unproject(n)},{originalEvent:e})}):i?(this._active=!0,e.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:t=>t.easeTo({duration:300,zoom:t.getZoom()-1,around:t.unproject(i)},{originalEvent:e})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const _i={0:1,2:2};class bi{constructor(e){this.reset(),this._clickTolerance=e.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(e,t){return!1}_move(e,t){return{}}mousedown(e,t){if(this._lastPoint)return;const r=g(e);this._correctButton(e,r)&&(this._lastPoint=t,this._eventButton=r)}mousemoveWindow(e,t){const r=this._lastPoint;if(r)if(e.preventDefault(),null!=this._eventButton&&function(e,t){const r=_i[t];return void 0===e.buttons||(e.buttons&r)!==r}(e,this._eventButton))this.reset();else if(this._moved||!(t.dist(r)<this._clickTolerance))return this._moved=!0,this._lastPoint=t,this._move(r,t)}mouseupWindow(e){this._lastPoint&&g(e)===this._eventButton&&(this._moved&&d(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class xi extends bi{mousedown(e,t){super.mousedown(e,t),this._lastPoint&&(this._active=!0)}_correctButton(e,t){return 0===t&&!e.ctrlKey}_move(e,t){return{around:t,panDelta:t.sub(e)}}}class wi extends bi{_correctButton(e,t){return 0===t&&e.ctrlKey||2===t}_move(e,t){const r=.8*(t.x-e.x);if(r)return this._active=!0,{bearingDelta:r}}contextmenu(e){e.preventDefault()}}class ki extends bi{_correctButton(e,t){return 0===t&&e.ctrlKey||2===t}_move(e,t){const r=-.5*(t.y-e.y);if(r)return this._active=!0,{pitchDelta:r}}contextmenu(e){e.preventDefault()}}class Ai{constructor(t,r){this._map=t,this._el=t.getCanvasContainer(),this._minTouches=1,this._clickTolerance=r.clickTolerance||1,this.reset(),e.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new e.pointGeometry(0,0)}touchstart(e,t,r){return this._calculateTransform(e,t,r)}touchmove(t,r,n){if(this._active&&!(n.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(1===n.length&&!e.isFullscreen())return void this._showTouchPanBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return t.cancelable&&t.preventDefault(),this._calculateTransform(t,r,n)}}touchend(e,t,r){this._calculateTransform(e,t,r),this._active&&r.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(t,r,n){n.length>0&&(this._active=!0);const i=mi(n,r),o=new e.pointGeometry(0,0),a=new e.pointGeometry(0,0);let s=0;for(const e in i){const t=i[e],r=this._touches[e];r&&(o._add(t),a._add(t.sub(r)),s++,i[e]=t)}if(this._touches=i,s<this._minTouches||!a.mag())return;const u=a.div(s);return this._sum._add(u),this._sum.mag()<this._clickTolerance?void 0:{around:o.div(s),panDelta:u}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=o("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout((()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")}),500)}}class Ei{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(e){}_move(e,t,r){return{}}touchstart(e,t,r){this._firstTwoTouches||r.length<2||(this._firstTwoTouches=[r[0].identifier,r[1].identifier],this._start([t[0],t[1]]))}touchmove(e,t,r){const n=this._firstTwoTouches;if(!n)return;e.preventDefault();const[i,o]=n,a=Si(r,t,i),s=Si(r,t,o);if(!a||!s)return;const u=this._aroundCenter?null:a.add(s).div(2);return this._move([a,s],u,e)}touchend(e,t,r){if(!this._firstTwoTouches)return;const[n,i]=this._firstTwoTouches,o=Si(r,t,n),a=Si(r,t,i);o&&a||(this._active&&d(),this.reset())}touchcancel(){this.reset()}enable(e){this._enabled=!0,this._aroundCenter=!!e&&"center"===e.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Si(e,t,r){for(let n=0;n<e.length;n++)if(e[n].identifier===r)return t[n]}function Ti(e,t){return Math.log(e/t)/Math.LN2}class Mi extends Ei{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(e){this._startDistance=this._distance=e[0].dist(e[1])}_move(e,t){const r=this._distance;if(this._distance=e[0].dist(e[1]),this._active||!(Math.abs(Ti(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Ti(this._distance,r),pinchAround:t}}}function Ii(e,t){return 180*e.angleWith(t)/Math.PI}class Pi extends Ei{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}_move(e,t){const r=this._vector;if(this._vector=e[0].sub(e[1]),r&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:Ii(this._vector,r),pinchAround:t}}_isBelowThreshold(e){this._minDiameter=Math.min(this._minDiameter,e.mag());const t=25/(Math.PI*this._minDiameter)*360,r=this._startVector;if(!r)return!1;const n=Ii(e,r);return Math.abs(n)<t}}function Ci(e){return Math.abs(e.y)>Math.abs(e.x)}class Bi extends Ei{constructor(e){super(),this._map=e}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(e){this._lastPoints=e,Ci(e[0].sub(e[1]))&&(this._valid=!1)}_move(t,r,n){const i=this._lastPoints;if(!i)return;const o=t[0].sub(i[0]),a=t[1].sub(i[1]);return this._map._cooperativeGestures&&!e.isFullscreen()&&n.touches.length<3||(this._valid=this.gestureBeginsVertically(o,a,n.timeStamp),!this._valid)?void 0:(this._lastPoints=t,this._active=!0,{pitchDelta:(o.y+a.y)/2*-.5})}gestureBeginsVertically(e,t,r){if(void 0!==this._valid)return this._valid;const n=e.mag()>=2,i=t.mag()>=2;if(!n&&!i)return;if(!n||!i)return null==this._firstMove&&(this._firstMove=r),r-this._firstMove<100&&void 0;const o=e.y>0==t.y>0;return Ci(e)&&Ci(t)&&o}}const Di={panStep:100,bearingStep:15,pitchStep:10};class Ri{constructor(){const e=Di;this._panStep=e.panStep,this._bearingStep=e.bearingStep,this._pitchStep=e.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(e){if(e.altKey||e.ctrlKey||e.metaKey)return;let t=0,r=0,n=0,i=0,o=0;switch(e.keyCode){case 61:case 107:case 171:case 187:t=1;break;case 189:case 109:case 173:t=-1;break;case 37:e.shiftKey?r=-1:(e.preventDefault(),i=-1);break;case 39:e.shiftKey?r=1:(e.preventDefault(),i=1);break;case 38:e.shiftKey?n=1:(e.preventDefault(),o=-1);break;case 40:e.shiftKey?n=-1:(e.preventDefault(),o=1);break;default:return}return this._rotationDisabled&&(r=0,n=0),{cameraAnimation:a=>{const s=a.getZoom();a.easeTo({duration:300,easeId:"keyboardHandler",easing:Li,zoom:t?Math.round(s)+t*(e.shiftKey?2:1):s,bearing:a.getBearing()+r*this._bearingStep,pitch:a.getPitch()+n*this._pitchStep,offset:[-i*this._panStep,-o*this._panStep],center:a.getCenter()},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Li(e){return e*(2-e)}const Oi=4.000244140625;class zi{constructor(t,r){this._map=t,this._el=t.getCanvasContainer(),this._handler=r,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,e.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(e){this._defaultZoomRate=e}setWheelZoomRate(e){this._wheelZoomRate=e}isEnabled(){return!!this._enabled}isActive(){return this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!e&&"center"===e.around,this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(t){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(t.ctrlKey||t.metaKey||this.isZooming()||e.isFullscreen()))return void this._showBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let r=t.deltaMode===e.window.WheelEvent.DOM_DELTA_LINE?40*t.deltaY:t.deltaY;const n=e.exported.now(),i=n-(this._lastWheelEventTime||0);this._lastWheelEventTime=n,0!==r&&r%Oi==0?this._type="wheel":0!==r&&Math.abs(r)<4?this._type="trackpad":i>400?(this._type=null,this._lastValue=r,this._timeout=setTimeout(this._onTimeout,40,t)):this._type||(this._type=Math.abs(i*r)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,r+=this._lastValue)),t.shiftKey&&r&&(r/=4),this._type&&(this._lastWheelEvent=t,this._delta-=r,this._active||this._start(t)),t.preventDefault()}_onTimeout(e){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(e)}_start(e){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const t=p(this._el,e);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:t,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId)return;if(this._frameId=null,!this.isActive())return;const t=this._map.transform;"wheel"===this._type&&t.projection.wrap&&(t._center.lng>=180||t._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const r=()=>t._terrainEnabled()&&this._aroundCoord?t.computeZoomRelativeTo(this._aroundCoord):t.zoom;if(0!==this._delta){const e="wheel"===this._type&&Math.abs(this._delta)>Oi?this._wheelZoomRate:this._defaultZoomRate;let n=2/(1+Math.exp(-Math.abs(this._delta*e)));this._delta<0&&0!==n&&(n=1/n);const i=r(),o=Math.pow(2,i),a="number"==typeof this._targetZoom?t.zoomScale(this._targetZoom):o;this._targetZoom=Math.min(t.maxZoom,Math.max(t.minZoom,t.scaleZoom(a*n))),"wheel"===this._type&&(this._startZoom=i,this._easing=this._smoothOutEasing(200)),this._delta=0}const n="number"==typeof this._targetZoom?this._targetZoom:r(),i=this._startZoom,o=this._easing;let a,s=!1;if("wheel"===this._type&&i&&o){const t=Math.min((e.exported.now()-this._lastWheelEventTime)/200,1),r=o(t);a=e.number(i,n,r),t<1?this._frameId||(this._frameId=!0):s=!0}else a=n,s=!0;return this._active=!0,s&&(this._active=!1,this._finishTimeout=setTimeout((()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout}),200)),{noInertia:!0,needsRenderFrame:!s,zoomDelta:a-r(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(t){let r=e.ease;if(this._prevEase){const t=this._prevEase,n=(e.exported.now()-t.start)/t.duration,i=t.easing(n+.01)-t.easing(n),o=.27/Math.sqrt(i*i+1e-4)*.01,a=Math.sqrt(.0729-o*o);r=e.bezier(o,a,.25,1)}return this._prevEase={start:e.exported.now(),duration:t,easing:r},r}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=o("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(e.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout((()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")}),200)}}class Ni{constructor(e,t){this._clickZoom=e,this._tapZoom=t}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Ui{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(e,t){return e.preventDefault(),{cameraAnimation:r=>{r.easeTo({duration:300,zoom:r.getZoom()+(e.shiftKey?-1:1),around:r.unproject(t)},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Zi{constructor(){this._tap=new yi({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(e,t,r){this._swipePoint||(this._tapTime&&e.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?r.length>0&&(this._swipePoint=t[0],this._swipeTouch=r[0].identifier):this._tap.touchstart(e,t,r))}touchmove(e,t,r){if(this._tapTime){if(this._swipePoint){if(r[0].identifier!==this._swipeTouch)return;const n=t[0],i=n.y-this._swipePoint.y;return this._swipePoint=n,e.preventDefault(),this._active=!0,{zoomDelta:i/128}}}else this._tap.touchmove(e,t,r)}touchend(e,t,r){this._tapTime?this._swipePoint&&0===r.length&&this.reset():this._tap.touchend(e,t,r)&&(this._tapTime=e.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Fi{constructor(e,t,r){this._el=e,this._mousePan=t,this._touchPan=r}enable(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class ji{constructor(e,t,r){this._pitchWithRotate=e.pitchWithRotate,this._mouseRotate=t,this._mousePitch=r}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Vi{constructor(e,t,r,n){this._el=e,this._touchZoom=t,this._touchRotate=r,this._tapDragZoom=n,this._rotationDisabled=!1,this._enabled=!0}enable(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Wi=e=>e.zoom||e.drag||e.pitch||e.rotate;class Ki extends e.Event{}class Gi{constructor(){this.constants=[1,1,.01],this.radius=0}setup(t,r){const n=e.sub([],r,t);this.radius=e.length(n[2]<0?e.div([],n,this.constants):[n[0],n[1],0])}projectRay(t){e.div(t,t,this.constants),e.normalize(t,t),e.mul$1(t,t,this.constants);const r=e.scale$2([],t,this.radius);if(r[2]>0){const t=e.scale$2([],[0,0,1],e.dot(r,[0,0,1])),n=e.scale$2([],e.normalize([],[r[0],r[1],0]),this.radius),i=e.add([],r,e.scale$2([],e.sub([],e.add([],n,t),r),2));r[0]=i[0],r[1]=i[1]}return r}}function Hi(e){return e.panDelta&&e.panDelta.mag()||e.zoomDelta||e.bearingDelta||e.pitchDelta}class qi{constructor(t,r){this._map=t,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new ai(t),this._bearingSnap=r.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Gi,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(r),e.bindAll(["handleEvent","handleWindowEvent"],this);const n=this._el;this._listeners=[[n,"touchstart",{passive:!0}],[n,"touchmove",{passive:!1}],[n,"touchend",void 0],[n,"touchcancel",void 0],[n,"mousedown",void 0],[n,"mousemove",void 0],[n,"mouseup",void 0],[e.window.document,"mousemove",{capture:!0}],[e.window.document,"mouseup",void 0],[n,"mouseover",void 0],[n,"mouseout",void 0],[n,"dblclick",void 0],[n,"click",void 0],[n,"keydown",{capture:!1}],[n,"keyup",void 0],[n,"wheel",{passive:!1}],[n,"contextmenu",void 0],[e.window,"blur",void 0]];for(const[i,o,a]of this._listeners)i.addEventListener(o,i===e.window.document?this.handleWindowEvent:this.handleEvent,a)}destroy(){for(const[t,r,n]of this._listeners)t.removeEventListener(r,t===e.window.document?this.handleWindowEvent:this.handleEvent,n)}_addDefaultHandlers(e){const t=this._map,r=t.getCanvasContainer();this._add("mapEvent",new fi(t,e));const n=t.boxZoom=new pi(t,e);this._add("boxZoom",n);const i=new vi,o=new Ui;t.doubleClickZoom=new Ni(o,i),this._add("tapZoom",i),this._add("clickZoom",o);const a=new Zi;this._add("tapDragZoom",a);const s=t.touchPitch=new Bi(t);this._add("touchPitch",s);const u=new wi(e),c=new ki(e);t.dragRotate=new ji(e,u,c),this._add("mouseRotate",u,["mousePitch"]),this._add("mousePitch",c,["mouseRotate"]);const l=new xi(e),h=new Ai(t,e);t.dragPan=new Fi(r,l,h),this._add("mousePan",l),this._add("touchPan",h,["touchZoom","touchRotate"]);const f=new Pi,d=new Mi;t.touchZoomRotate=new Vi(r,d,f,a),this._add("touchRotate",f,["touchPan","touchZoom"]),this._add("touchZoom",d,["touchPan","touchRotate"]),this._add("blockableMapEvent",new di(t));const p=t.scrollZoom=new zi(t,this);this._add("scrollZoom",p,["mousePan"]);const m=t.keyboard=new Ri;this._add("keyboard",m);for(const g of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])e.interactive&&e[g]&&t[g].enable(e[g])}_add(e,t,r){this._handlers.push({handlerName:e,handler:t,allowed:r}),this._handlersById[e]=t}stop(e){if(!this._updatingCamera){for(const{handler:e}of this._handlers)e.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[]}}isActive(){for(const{handler:e}of this._handlers)if(e.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Wi(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(e,t,r){for(const n in e)if(n!==r&&(!t||t.indexOf(n)<0))return!0;return!1}handleWindowEvent(e){this.handleEvent(e,`${e.type}Window`)}_getMapTouches(e){const t=[];for(const r of e)this._el.contains(r.target)&&t.push(r);return t}handleEvent(e,t){this._updatingCamera=!0;const r="renderFrame"===e.type,n=r?void 0:e,i={needsRenderFrame:!1},o={},a={},s=e.touches?this._getMapTouches(e.touches):void 0,u=s?m(this._el,s):r?void 0:p(this._el,e);for(const{handlerName:h,handler:f,allowed:d}of this._handlers){if(!f.isEnabled())continue;let r;this._blockedByActive(a,d,h)?f.reset():f[t||e.type]&&(r=f[t||e.type](e,u,s),this.mergeHandlerResult(i,o,r,h,n),r&&r.needsRenderFrame&&this._triggerRenderFrame()),(r||f.isActive())&&(a[h]=f)}const c={};for(const h in this._previousActiveHandlers)a[h]||(c[h]=n);this._previousActiveHandlers=a,(Object.keys(c).length||Hi(i))&&(this._changes.push([i,o,c]),this._triggerRenderFrame()),(Object.keys(a).length||Hi(i))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:l}=i;l&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],l(this._map))}mergeHandlerResult(t,r,n,i,o){if(!n)return;e.extend(t,n);const a={handlerName:i,originalEvent:n.originalEvent||o};void 0!==n.zoomDelta&&(r.zoom=a),void 0!==n.panDelta&&(r.drag=a),void 0!==n.pitchDelta&&(r.pitch=a),void 0!==n.bearingDelta&&(r.rotate=a)}_applyChanges(){const t={},r={},n={};for(const[i,o,a]of this._changes)i.panDelta&&(t.panDelta=(t.panDelta||new e.pointGeometry(0,0))._add(i.panDelta)),i.zoomDelta&&(t.zoomDelta=(t.zoomDelta||0)+i.zoomDelta),i.bearingDelta&&(t.bearingDelta=(t.bearingDelta||0)+i.bearingDelta),i.pitchDelta&&(t.pitchDelta=(t.pitchDelta||0)+i.pitchDelta),void 0!==i.around&&(t.around=i.around),void 0!==i.aroundCoord&&(t.aroundCoord=i.aroundCoord),void 0!==i.pinchAround&&(t.pinchAround=i.pinchAround),i.noInertia&&(t.noInertia=i.noInertia),e.extend(r,o),e.extend(n,a);this._updateMapTransform(t,r,n),this._changes=[]}_updateMapTransform(t,r,n){const i=this._map,o=i.transform,a=e=>[e.x,e.y,e.z];if((e=>{const t=this._eventsInProgress.drag;return t&&!this._handlersById[t.handlerName].isActive()})()&&!Hi(t)){const e=o.zoom;o.cameraElevationReference="sea",o.recenterOnTerrain(),o.cameraElevationReference="ground",e!==o.zoom&&this._map._update(!0)}if(o._isCameraConstrained&&i._stop(!0),!Hi(t))return void this._fireEvents(r,n,!0);let{panDelta:s,zoomDelta:u,bearingDelta:c,pitchDelta:l,around:h,aroundCoord:f,pinchAround:d}=t;o._isCameraConstrained&&(u>0&&(u=0),o._isCameraConstrained=!1),void 0!==d&&(h=d),(u||(e=>r.drag&&!this._eventsInProgress.drag)())&&h&&(this._dragOrigin=a(o.pointCoordinate3D(h)),this._trackingEllipsoid.setup(o._camera.position,this._dragOrigin)),o.cameraElevationReference="sea",i._stop(!0),h=h||i.transform.centerPoint,c&&(o.bearing+=c),l&&(o.pitch+=l),o._updateCameraState();const p=[0,0,0];if(s)if("mercator"===o.projection.name){const e=this._trackingEllipsoid.projectRay(o.screenPointToMercatorRay(h).dir),t=this._trackingEllipsoid.projectRay(o.screenPointToMercatorRay(h.sub(s)).dir);p[0]=t[0]-e[0],p[1]=t[1]-e[1]}else{const t=o.pointCoordinate(h);if("globe"===o.projection.name){s=s.rotate(-o.angle);const r=o._pixelsPerMercatorPixel/o.worldSize;p[0]=-s.x*e.mercatorScale(e.latFromMercatorY(t.y))*r,p[1]=-s.y*e.mercatorScale(o.center.lat)*r}else{const e=o.pointCoordinate(h.sub(s));t&&e&&(p[0]=e.x-t.x,p[1]=e.y-t.y)}}const m=o.zoom,g=[0,0,0];if(u){const t=a(f||o.pointCoordinate3D(h)),r={dir:e.normalize([],e.sub([],t,o._camera.position))};if(r.dir[2]<0){const n=o.zoomDeltaToMovement(t,u);e.scale$2(g,r.dir,n)}}const y=e.add(p,p,g);o._translateCameraConstrained(y),u&&Math.abs(o.zoom-m)>1e-4&&o.recenterOnTerrain(),o.cameraElevationReference="ground",this._map._update(),t.noInertia||this._inertia.record(t),this._fireEvents(r,n,!0)}_fireEvents(t,r,n){const i=Wi(this._eventsInProgress),o=Wi(t),a={};for(const e in t){const{originalEvent:r}=t[e];this._eventsInProgress[e]||(a[`${e}start`]=r),this._eventsInProgress[e]=t[e]}!i&&o&&this._fireEvent("movestart",o.originalEvent);for(const e in a)this._fireEvent(e,a[e]);o&&this._fireEvent("move",o.originalEvent);for(const e in t){const{originalEvent:r}=t[e];this._fireEvent(e,r)}const s={};let u;for(const e in this._eventsInProgress){const{handlerName:t,originalEvent:n}=this._eventsInProgress[e];this._handlersById[t].isActive()||(delete this._eventsInProgress[e],u=r[t]||n,s[`${e}end`]=u)}for(const e in s)this._fireEvent(e,s[e]);const c=Wi(this._eventsInProgress);if(n&&(i||o)&&!c){this._updatingCamera=!0;const t=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),r=e=>0!==e&&-this._bearingSnap<e&&e<this._bearingSnap;t?(r(t.bearing||this._map.getBearing())&&(t.bearing=0),this._map.easeTo(t,{originalEvent:u})):(this._map.fire(new e.Event("moveend",{originalEvent:u})),r(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(t,r){this._map.fire(new e.Event(t,r?{originalEvent:r}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((e=>{this._frameId=void 0,this.handleEvent(new Ki("renderFrame",{timeStamp:e})),this._applyChanges()}))}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}const Yi="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Xi extends e.Evented{constructor(t,r){super(),this._moving=!1,this._zooming=!1,this.transform=t,this._bearingSnap=r.bearingSnap,e.bindAll(["_renderFrameCallback"],this)}getCenter(){return new e.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(e,t){return this.jumpTo({center:e},t)}panBy(t,r,n){return t=e.pointGeometry.convert(t).mult(-1),this.panTo(this.transform.center,e.extend({offset:t},r),n)}panTo(t,r,n){return this.easeTo(e.extend({center:t},r),n)}getZoom(){return this.transform.zoom}setZoom(e,t){return this.jumpTo({zoom:e},t),this}zoomTo(t,r,n){return this.easeTo(e.extend({zoom:t},r),n)}zoomIn(e,t){return this.zoomTo(this.getZoom()+1,e,t),this}zoomOut(e,t){return this.zoomTo(this.getZoom()-1,e,t),this}getBearing(){return this.transform.bearing}setBearing(e,t){return this.jumpTo({bearing:e},t),this}getPadding(){return this.transform.padding}setPadding(e,t){return this.jumpTo({padding:e},t),this}rotateTo(t,r,n){return this.easeTo(e.extend({bearing:t},r),n)}resetNorth(t,r){return this.rotateTo(0,e.extend({duration:1e3},t),r),this}resetNorthPitch(t,r){return this.easeTo(e.extend({bearing:0,pitch:0,duration:1e3},t),r),this}snapToNorth(e,t){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,t):this}getPitch(){return this.transform.pitch}setPitch(e,t){return this.jumpTo({pitch:e},t),this}cameraForBounds(t,r){t=e.LngLatBounds.convert(t);const n=r&&r.bearing||0,i=r&&r.pitch||0,o=t.getNorthWest(),a=t.getSouthEast();return this._cameraForBounds(this.transform,o,a,n,i,r)}_extendCameraOptions(t){const r={top:0,bottom:0,right:0,left:0};if("number"==typeof(t=e.extend({padding:r,offset:[0,0],maxZoom:this.transform.maxZoom},t)).padding){const e=t.padding;t.padding={top:e,bottom:e,right:e,left:e}}return t.padding=e.extend(r,t.padding),t}_minimumAABBFrustumDistance(e,t){const r=t.max[0]-t.min[0],n=t.max[1]-t.min[1];return r/n>e.aspect?r/(2*Math.tan(.5*e.fovX)*e.aspect):n/(2*Math.tan(.5*e.fovY)*e.aspect)}_cameraForBoundsOnGlobe(t,r,n,i,o,a){const s=t.clone(),u=this._extendCameraOptions(a);s.bearing=i,s.pitch=o;const c=e.LngLat.convert(r),l=e.LngLat.convert(n),h=.5*(c.lat+l.lat),f=.5*(c.lng+l.lng),d=e.latLngToECEF(h,f),p=e.normalize([],d),m=e.normalize([],e.cross([],p,[0,1,0])),g=e.cross([],m,p),y=[m[0],m[1],m[2],0,g[0],g[1],g[2],0,p[0],p[1],p[2],0,0,0,0,1],v=[d,e.latLngToECEF(c.lat,c.lng),e.latLngToECEF(l.lat,c.lng),e.latLngToECEF(l.lat,l.lng),e.latLngToECEF(c.lat,l.lng),e.latLngToECEF(h,c.lng),e.latLngToECEF(h,l.lng),e.latLngToECEF(c.lat,f),e.latLngToECEF(l.lat,f)];let _=e.Aabb.fromPoints(v.map((t=>[e.dot(m,t),e.dot(g,t),e.dot(p,t)])));const b=e.transformMat4([],_.center,y);0===e.squaredLength(b)&&e.set(b,0,0,1),e.normalize(b,b),e.scale$2(b,b,e.GLOBE_RADIUS),s.center=e.ecefToLatLng(b);const x=s.getWorldToCameraMatrix(),w=e.invert(new Float64Array(16),x);_=e.Aabb.applyTransform(_,e.multiply([],x,y)),e.transformMat4(b,b,x);const k=.5*(_.max[2]-_.min[2]),A=this._minimumAABBFrustumDistance(s,_),E=e.scale$2([],[0,0,1],k),S=e.add(E,b,E),T=A+(0===s.pitch?0:e.distance(b,S)),M=s.globeCenterInViewSpace,I=e.sub([],b,[M[0],M[1],M[2]]);e.normalize(I,I),e.scale$2(I,I,T);const P=e.add([],b,I);e.transformMat4(P,P,w);const C=e.earthRadius/e.GLOBE_RADIUS,B=e.length(P),D=e.mercatorZfromAltitude(Math.max(B*C-e.earthRadius,Number.EPSILON),0),R=Math.min(s.zoomFromMercatorZAdjusted(D),u.maxZoom);return R>.5*(e.GLOBE_ZOOM_THRESHOLD_MIN+e.GLOBE_ZOOM_THRESHOLD_MAX)?(s.setProjection({name:"mercator"}),s.zoom=R,this._cameraForBounds(s,r,n,i,o,a)):{center:s.center,zoom:R,bearing:i,pitch:o}}queryTerrainElevation(t,r){const n=this.transform.elevation;return n?(r=e.extend({},{exaggerated:!0},r),n.getAtPoint(e.MercatorCoordinate.fromLngLat(t),null,r.exaggerated)):null}_cameraForBounds(t,r,n,i,o,a){if("globe"===t.projection.name)return this._cameraForBoundsOnGlobe(t,r,n,i,o,a);const s=t.clone(),u=this._extendCameraOptions(a),c=s.padding;s.bearing=i,s.pitch=o;const l=e.LngLat.convert(r),h=e.LngLat.convert(n),f=new e.LngLat(l.lng,h.lat),d=new e.LngLat(h.lng,l.lat),p=s.project(l),m=s.project(h),g=this.queryTerrainElevation(l),y=this.queryTerrainElevation(h),v=this.queryTerrainElevation(f),_=this.queryTerrainElevation(d),b=[[p.x,p.y,Math.min(g||0,y||0,v||0,_||0)],[m.x,m.y,Math.max(g||0,y||0,v||0,_||0)]];let x=e.Aabb.fromPoints(b);const w=s.getWorldToCameraMatrix(),k=e.invert(new Float64Array(16),w);x=e.Aabb.applyTransform(x,w);const A=e.sub([],x.max,x.min),E=c.left||0,S=c.right||0,T=c.bottom||0,M=c.top||0,{left:I,right:P,top:C,bottom:B}=u.padding,D=.5*(E+S),R=.5*(M+T),L=Math.min(s.scaleZoom(s.scale*Math.min((s.width-(E+S+I+P))/A[0],(s.height-(T+M+B+C))/A[1])),u.maxZoom),O=s.scale/s.zoomScale(L);x=new e.Aabb([x.min[0]-(I+D)*O,x.min[1]-(B+R)*O,x.min[2]],[x.max[0]+(P+D)*O,x.max[1]+(C+R)*O,x.max[2]]);const z=.5*A[2],N=this._minimumAABBFrustumDistance(s,x),U=[0,0,1,0];e.transformMat4$1(U,U,w),e.normalize$2(U,U);const Z=e.scale$2([],U,N+z),F=e.add([],x.center,Z),j=("number"==typeof u.offset.x&&"number"==typeof u.offset.y?new e.pointGeometry(u.offset.x,u.offset.y):e.pointGeometry.convert(u.offset)).rotate(-e.degToRad(i));x.center[0]-=j.x*O,x.center[1]+=j.y*O,e.transformMat4(x.center,x.center,k),e.transformMat4(F,F,k);const V=[x.center[0],x.center[1],F[2]*s.pixelsPerMeter];e.scale$2(V,V,1/s.worldSize);const W=e.lngFromMercatorX(V[0]),K=e.latFromMercatorY(V[1]),G=Math.min(s._zoomFromMercatorZ(V[2]),u.maxZoom),H=new e.LngLat(W,K);return s.mercatorFromTransition&&G<.5*(e.GLOBE_ZOOM_THRESHOLD_MIN+e.GLOBE_ZOOM_THRESHOLD_MAX)?(s.setProjection({name:"globe"}),s.zoom=G,this._cameraForBounds(s,r,n,i,o,a)):{center:H,zoom:G,bearing:i,pitch:o}}fitBounds(e,t,r){const n=this.cameraForBounds(e,t);return this._fitInternal(n,t,r)}fitScreenCoordinates(t,r,n,i,o){const a=e.pointGeometry.convert(t),s=e.pointGeometry.convert(r),u=new e.pointGeometry(Math.min(a.x,s.x),Math.min(a.y,s.y)),c=new e.pointGeometry(Math.max(a.x,s.x),Math.max(a.y,s.y));if("mercator"===this.transform.projection.name&&this.transform.anyCornerOffEdge(a,s))return this;const l=this.transform.pointLocation3D(u),h=this.transform.pointLocation3D(c),f=this.transform.pointLocation3D(new e.pointGeometry(u.x,c.y)),d=this.transform.pointLocation3D(new e.pointGeometry(c.x,u.y)),p=[Math.min(l.lng,h.lng,f.lng,d.lng),Math.min(l.lat,h.lat,f.lat,d.lat)],m=[Math.max(l.lng,h.lng,f.lng,d.lng),Math.max(l.lat,h.lat,f.lat,d.lat)],g=i&&i.pitch?i.pitch:this.getPitch(),y=this._cameraForBounds(this.transform,p,m,n,g,i);return this._fitInternal(y,i,o)}_fitInternal(t,r,n){return t?(delete(r=e.extend(t,r)).padding,r.linear?this.easeTo(r,n):this.flyTo(r,n)):this}jumpTo(t,r){this.stop();const n=t.preloadOnly?this.transform.clone():this.transform;let i=!1,o=!1,a=!1;return"zoom"in t&&n.zoom!==+t.zoom&&(i=!0,n.zoom=+t.zoom),void 0!==t.center&&(n.center=e.LngLat.convert(t.center)),"bearing"in t&&n.bearing!==+t.bearing&&(o=!0,n.bearing=+t.bearing),"pitch"in t&&n.pitch!==+t.pitch&&(a=!0,n.pitch=+t.pitch),null==t.padding||n.isPaddingEqual(t.padding)||(n.padding=t.padding),t.preloadOnly?(this._preloadTiles(n),this):(this.fire(new e.Event("movestart",r)).fire(new e.Event("move",r)),i&&this.fire(new e.Event("zoomstart",r)).fire(new e.Event("zoom",r)).fire(new e.Event("zoomend",r)),o&&this.fire(new e.Event("rotatestart",r)).fire(new e.Event("rotate",r)).fire(new e.Event("rotateend",r)),a&&this.fire(new e.Event("pitchstart",r)).fire(new e.Event("pitch",r)).fire(new e.Event("pitchend",r)),this.fire(new e.Event("moveend",r)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||e.warnOnce(Yi),this.transform.getFreeCameraOptions()}setFreeCameraOptions(t,r){const n=this.transform;if(!n.projection.supportsFreeCamera)return e.warnOnce(Yi),this;this.stop();const i=n.zoom,o=n.pitch,a=n.bearing;n.setFreeCameraOptions(t);const s=i!==n.zoom,u=o!==n.pitch,c=a!==n.bearing;return this.fire(new e.Event("movestart",r)).fire(new e.Event("move",r)),s&&this.fire(new e.Event("zoomstart",r)).fire(new e.Event("zoom",r)).fire(new e.Event("zoomend",r)),c&&this.fire(new e.Event("rotatestart",r)).fire(new e.Event("rotate",r)).fire(new e.Event("rotateend",r)),u&&this.fire(new e.Event("pitchstart",r)).fire(new e.Event("pitch",r)).fire(new e.Event("pitchend",r)),this.fire(new e.Event("moveend",r)),this}easeTo(t,r){this._stop(!1,t.easeId),(!1===(t=e.extend({offset:[0,0],duration:500,easing:e.ease},t)).animate||!t.essential&&e.exported.prefersReducedMotion)&&(t.duration=0);const n=this.transform,i=this.getZoom(),o=this.getBearing(),a=this.getPitch(),s=this.getPadding(),u="zoom"in t?+t.zoom:i,c="bearing"in t?this._normalizeBearing(t.bearing,o):o,l="pitch"in t?+t.pitch:a,h="padding"in t?t.padding:n.padding,f=e.pointGeometry.convert(t.offset);let d,p,m;if("globe"===n.projection.name){const r=e.MercatorCoordinate.fromLngLat(n.center),i=f.rotate(-n.angle);r.x+=i.x/n.worldSize,r.y+=i.y/n.worldSize;const o=r.toLngLat(),a=e.LngLat.convert(t.center||o);this._normalizeCenter(a),d=n.centerPoint.add(i),p=new e.pointGeometry(r.x,r.y).mult(n.worldSize),m=new e.pointGeometry(e.mercatorXfromLng(a.lng),e.mercatorYfromLat(a.lat)).mult(n.worldSize).sub(p)}else{d=n.centerPoint.add(f);const r=n.pointLocation(d),i=e.LngLat.convert(t.center||r);this._normalizeCenter(i),p=n.project(r),m=n.project(i).sub(p)}const g=n.zoomScale(u-i);let y,v;t.around&&(y=e.LngLat.convert(t.around),v=n.locationPoint(y));const _=this._zooming||u!==i,b=this._rotating||o!==c,x=this._pitching||l!==a,w=!n.isPaddingEqual(h),k=n=>k=>{if(_&&(n.zoom=e.number(i,u,k)),b&&(n.bearing=e.number(o,c,k)),x&&(n.pitch=e.number(a,l,k)),w&&(n.interpolatePadding(s,h,k),d=n.centerPoint.add(f)),y)n.setLocationAtPoint(y,v);else{const e=n.zoomScale(n.zoom-i),t=u>i?Math.min(2,g):Math.max(.5,g),r=Math.pow(t,1-k),o=n.unproject(p.add(m.mult(k*r)).mult(e));n.setLocationAtPoint(n.renderWorldCopies?o.wrap():o,d)}return t.preloadOnly||this._fireMoveEvents(r),n};if(t.preloadOnly){const e=this._emulate(k,t.duration,n);return this._preloadTiles(e),this}const A={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=_,this._rotating=b,this._pitching=x,this._padding=w,this._easeId=t.easeId,this._prepareEase(r,t.noMoveStart,A),this._ease(k(n),(e=>{n.recenterOnTerrain(),this._afterEase(r,e)}),t),this}_prepareEase(t,r,n={}){this._moving=!0,this.transform.cameraElevationReference="sea",r||n.moving||this.fire(new e.Event("movestart",t)),this._zooming&&!n.zooming&&this.fire(new e.Event("zoomstart",t)),this._rotating&&!n.rotating&&this.fire(new e.Event("rotatestart",t)),this._pitching&&!n.pitching&&this.fire(new e.Event("pitchstart",t))}_fireMoveEvents(t){this.fire(new e.Event("move",t)),this._zooming&&this.fire(new e.Event("zoom",t)),this._rotating&&this.fire(new e.Event("rotate",t)),this._pitching&&this.fire(new e.Event("pitch",t))}_afterEase(t,r){if(this._easeId&&r&&this._easeId===r)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const n=this._zooming,i=this._rotating,o=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,n&&this.fire(new e.Event("zoomend",t)),i&&this.fire(new e.Event("rotateend",t)),o&&this.fire(new e.Event("pitchend",t)),this.fire(new e.Event("moveend",t))}flyTo(t,r){if(!t.essential&&e.exported.prefersReducedMotion){const n=e.pick(t,["center","zoom","bearing","pitch","around"]);return this.jumpTo(n,r)}this.stop(),t=e.extend({offset:[0,0],speed:1.2,curve:1.42,easing:e.ease},t);const n=this.transform,i=this.getZoom(),o=this.getBearing(),a=this.getPitch(),s=this.getPadding(),u="zoom"in t?e.clamp(+t.zoom,n.minZoom,n.maxZoom):i,c="bearing"in t?this._normalizeBearing(t.bearing,o):o,l="pitch"in t?+t.pitch:a,h="padding"in t?t.padding:n.padding,f=n.zoomScale(u-i),d=e.pointGeometry.convert(t.offset);let p=n.centerPoint.add(d);const m=n.pointLocation(p),g=e.LngLat.convert(t.center||m);this._normalizeCenter(g);const y=n.project(m),v=n.project(g).sub(y);let _=t.curve;const b=Math.max(n.width,n.height),x=b/f,w=v.mag();if("minZoom"in t){const r=e.clamp(Math.min(t.minZoom,i,u),n.minZoom,n.maxZoom),o=b/n.zoomScale(r-i);_=Math.sqrt(o/w*2)}const k=_*_;function A(e){const t=(x*x-b*b+(e?-1:1)*k*k*w*w)/(2*(e?x:b)*k*w);return Math.log(Math.sqrt(t*t+1)-t)}function E(e){return(Math.exp(e)-Math.exp(-e))/2}function S(e){return(Math.exp(e)+Math.exp(-e))/2}const T=A(0);let M=function(e){return S(T)/S(T+_*e)},I=function(e){return b*((S(T)*(E(t=T+_*e)/S(t))-E(T))/k)/w;var t},P=(A(1)-T)/_;if(Math.abs(w)<1e-6||!isFinite(P)){if(Math.abs(b-x)<1e-6)return this.easeTo(t,r);const e=x<b?-1:1;P=Math.abs(Math.log(x/b))/_,I=function(){return 0},M=function(t){return Math.exp(e*_*t)}}t.duration="duration"in t?+t.duration:1e3*P/("screenSpeed"in t?+t.screenSpeed/_:+t.speed),t.maxDuration&&t.duration>t.maxDuration&&(t.duration=0);const C=o!==c,B=l!==a,D=!n.isPaddingEqual(h),R=n=>f=>{const m=f*P,_=1/M(m);n.zoom=1===f?u:i+n.scaleZoom(_),C&&(n.bearing=e.number(o,c,f)),B&&(n.pitch=e.number(a,l,f)),D&&(n.interpolatePadding(s,h,f),p=n.centerPoint.add(d));const b=1===f?g:n.unproject(y.add(v.mult(I(m))).mult(_));return n.setLocationAtPoint(n.renderWorldCopies?b.wrap():b,p),n._updateCameraOnTerrain(),t.preloadOnly||this._fireMoveEvents(r),n};if(t.preloadOnly){const e=this._emulate(R,t.duration,n);return this._preloadTiles(e),this}return this._zooming=!0,this._rotating=C,this._pitching=B,this._padding=D,this._prepareEase(r,!1),this._ease(R(n),(()=>this._afterEase(r)),t),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(e,t){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const e=this._onEaseEnd;this._onEaseEnd=void 0,e.call(this,t)}if(!e){const e=this.handlers;e&&e.stop(!1)}return this}_ease(t,r,n){!1===n.animate||0===n.duration?(t(1),r()):(this._easeStart=e.exported.now(),this._easeOptions=n,this._onEaseFrame=t,this._onEaseEnd=r,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const t=Math.min((e.exported.now()-this._easeStart)/this._easeOptions.duration,1),r=this._onEaseFrame;r&&r(this._easeOptions.easing(t)),t<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(t,r){t=e.wrap(t,-180,180);const n=Math.abs(t-r);return Math.abs(t-360-r)<n&&(t-=360),Math.abs(t+360-r)<n&&(t+=360),t}_normalizeCenter(e){const t=this.transform;if(!t.renderWorldCopies||t.maxBounds)return;const r=e.lng-t.center.lng;e.lng+=r>180?-360:r<-180?360:0}_emulate(e,t,r){const n=Math.ceil(15*t/1e3),i=[],o=e(r.clone());for(let a=0;a<=n;a++){const e=o(a/n);i.push(e.clone())}return i}}class Qi{constructor(t={}){this.options=t,e.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(e){const t=this.options&&this.options.compact;return this._map=e,this._container=o("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=o("button","mapboxgl-ctrl-attrib-button",this._container),o("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=o("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),t&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===t&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(e,t){const r=this._map._getUIString(`AttributionControl.${t}`);e.setAttribute("aria-label",r),e.removeAttribute("title"),e.firstElementChild&&e.firstElementChild.setAttribute("title",r)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let t=this._editLink;t||(t=this._editLink=this._container.querySelector(".mapbox-improve-map"));const r=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||e.config.ACCESS_TOKEN}];if(t){const n=r.reduce(((e,t,n)=>(t.value&&(e+=`${t.key}=${t.value}${n<r.length-1?"&":""}`),e)),"?");t.href=`${e.config.FEEDBACK_URL}/${n}#${ei(this._map,!0)}`,t.rel="noopener nofollow",this._setElementTitle(t,"MapFeedback")}}_updateData(e){!e||"metadata"!==e.sourceDataType&&"visibility"!==e.sourceDataType&&"style"!==e.dataType||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let e=[];if(this._map.style.stylesheet){const e=this._map.style.stylesheet;this.styleOwner=e.owner,this.styleId=e.id}const t=this._map.style._sourceCaches;for(const n in t){const r=t[n];if(r.used){const t=r.getSource();t.attribution&&e.indexOf(t.attribution)<0&&e.push(t.attribution)}}e.sort(((e,t)=>e.length-t.length)),e=e.filter(((t,r)=>{for(let n=r+1;n<e.length;n++)if(e[n].indexOf(t)>=0)return!1;return!0})),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=[...this.options.customAttribution,...e]:e.unshift(this.options.customAttribution));const r=e.join(" | ");r!==this._attribHTML&&(this._attribHTML=r,e.length?(this._innerContainer.innerHTML=r,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class $i{constructor(){e.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(e){this._map=e,this._container=o("div","mapboxgl-ctrl");const t=o("a","mapboxgl-ctrl-logo");return t.target="_blank",t.rel="noopener nofollow",t.href="https://www.mapbox.com/",t.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),t.setAttribute("rel","noopener nofollow"),this._container.appendChild(t),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(e){e&&"metadata"!==e.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const e=this._map.style._sourceCaches;if(0===Object.entries(e).length)return!0;for(const t in e){const r=e[t].getSource();if(r.hasOwnProperty("mapbox_logo")&&!r.mapbox_logo)return!1}return!0}_updateCompact(){const e=this._container.children;if(e.length){const t=e[0];this._map.getCanvasContainer().offsetWidth<250?t.classList.add("mapboxgl-compact"):t.classList.remove("mapboxgl-compact")}}}class Ji{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(e){const t=++this._id;return this._queue.push({callback:e,id:t,cancelled:!1}),t}remove(e){const t=this._currentlyRunning,r=t?this._queue.concat(t):this._queue;for(const n of r)if(n.id===e)return void(n.cancelled=!0)}run(e=0){const t=this._currentlyRunning=this._queue;this._queue=[];for(const r of t)if(!r.cancelled&&(r.callback(e),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function eo(t,r,n){if(t=new e.LngLat(t.lng,t.lat),r){const i=new e.LngLat(t.lng-360,t.lat),o=new e.LngLat(t.lng+360,t.lat),a=360*Math.ceil(Math.abs(t.lng-n.center.lng)/360),s=n.locationPoint(t).distSqr(r),u=r.x<0||r.y<0||r.x>n.width||r.y>n.height;n.locationPoint(i).distSqr(r)<s&&(u||Math.abs(i.lng-n.center.lng)<a)?t=i:n.locationPoint(o).distSqr(r)<s&&(u||Math.abs(o.lng-n.center.lng)<a)&&(t=o)}for(;Math.abs(t.lng-n.center.lng)>180;){const e=n.locationPoint(t);if(e.x>=0&&e.y>=0&&e.x<=n.width&&e.y<=n.height)break;t.lng>n.center.lng?t.lng-=360:t.lng+=360}return t}const to={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class ro extends e.Evented{constructor(t,r){if(super(),(t instanceof e.window.HTMLElement||r)&&(t=e.extend({element:t},r)),e.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=t&&t.anchor||"center",this._color=t&&t.color||"#3FB1CE",this._scale=t&&t.scale||1,this._draggable=t&&t.draggable||!1,this._clickTolerance=t&&t.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=t&&t.rotation||0,this._rotationAlignment=t&&t.rotationAlignment||"auto",this._pitchAlignment=t&&t.pitchAlignment&&t.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=t&&t.occludedOpacity||.2,t&&t.element)this._element=t.element,this._offset=e.pointGeometry.convert(t&&t.offset||[0,0]);else{this._defaultMarker=!0,this._element=o("div");const r=41,n=27,i=a("svg",{display:"block",height:r*this._scale+"px",width:n*this._scale+"px",viewBox:`0 0 ${n} ${r}`},this._element),s=a("radialGradient",{id:"shadowGradient"},a("defs",{},i));a("stop",{offset:"10%","stop-opacity":.4},s),a("stop",{offset:"100%","stop-opacity":.05},s),a("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},i),a("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},i),a("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},i),a("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},i),this._offset=e.pointGeometry.convert(t&&t.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",(e=>{e.preventDefault()})),this._element.addEventListener("mousedown",(e=>{e.preventDefault()}));const n=this._element.classList;for(const e in to)n.remove(`mapboxgl-marker-anchor-${e}`);n.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(e){return e===this._map||(this.remove(),this._map=e,e.getCanvasContainer().appendChild(this._element),e.on("move",this._updateMoving),e.on("moveend",this._update),e.on("remove",this._clearFadeTimer),e._addMarker(this),this.setDraggable(this._draggable),this._update(),e.on("click",this._onMapClick)),this}remove(){const e=this._map;return e&&(e.off("click",this._onMapClick),e.off("move",this._updateMoving),e.off("moveend",this._update),e.off("mousedown",this._addDragHandler),e.off("touchstart",this._addDragHandler),e.off("mouseup",this._onUp),e.off("touchend",this._onUp),e.off("mousemove",this._onMove),e.off("touchmove",this._onMove),e.off("remove",this._clearFadeTimer),e._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(t){return this._lngLat=e.LngLat.convert(t),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){const t=38.1,r=13.5,n=Math.sqrt(Math.pow(r,2)/2);e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-t],"bottom-left":[n,-1*(t-r+n)],"bottom-right":[-n,-1*(t-r+n)],left:[r,-1*(t-r)],right:[-r,-1*(t-r)]}:this._offset}this._popup=e,e._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(e){const t=e.code,r=e.charCode||e.keyCode;"Space"!==t&&"Enter"!==t&&32!==r&&13!==r||this.togglePopup()}_onMapClick(e){const t=e.originalEvent.target,r=this._element;this._popup&&(t===r||r.contains(t))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const e=this._popup;return e?(e.isOpen()?(e.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(e.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const e=this._map,t=this._pos;if(!e||!t)return!1;const r=e.unproject(t),n=e.getFreeCameraOptions();if(!n.position)return!1;const i=n.position.toLngLat();return i.distanceTo(r)<.9*i.distanceTo(this._lngLat)}_evaluateOpacity(){const t=this._map;if(!t)return;const r=this._pos;if(!r||r.x<0||r.x>t.transform.width||r.y<0||r.y>t.transform.height)return void this._clearFadeTimer();const n=t.unproject(r);let i;t._showingGlobe()&&e.isLngLatBehindGlobe(t.transform,this._lngLat)?i=0:(i=1-t._queryFogOpacity(n),t.transform._terrainEnabled()&&t.getTerrain()&&this._behindTerrain()&&(i*=this._occludedOpacity)),this._element.style.opacity=`${i}`,this._element.style.pointerEvents=i>0?"auto":"none",this._popup&&this._popup._setOpacity(i),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const e=this._pos;if(!e||!this._map)return;const t=this._offset.mult(this._scale);this._element.style.transform=`\n            translate(${e.x}px,${e.y}px)\n            ${to[this._anchor]}\n            ${this._calculateXYTransform()} ${this._calculateZTransform()}\n            translate(${t.x}px,${t.y}px)\n        `}_calculateXYTransform(){const t=this._pos,r=this._map,n=this.getPitchAlignment();if(!r||!t||"map"!==n)return"";if(!r._showingGlobe()){const e=r.getPitch();return e?`rotateX(${e}deg)`:""}const i=e.radToDeg(e.globeTiltAtLngLat(r.transform,this._lngLat)),o=t.sub(e.globeCenterToScreenPoint(r.transform)),a=Math.abs(o.x)+Math.abs(o.y);if(0===a)return"";const s=i/a;return`rotateX(${-o.y*s}deg) rotateY(${o.x*s}deg)`}_calculateZTransform(){const t=this._pos,r=this._map;if(!r||!t)return"";let n=0;const i=this.getRotationAlignment();if("map"===i)if(r._showingGlobe()){const t=r.project(new e.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),i=r.project(new e.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(t);n=e.radToDeg(Math.atan2(i.y,i.x))-90}else n=-r.getBearing();else if("horizon"===i){const i=e.smoothstep(4,6,r.getZoom()),o=e.globeCenterToScreenPoint(r.transform);o.y+=i*r.transform.height;const a=t.sub(o),s=e.radToDeg(Math.atan2(a.y,a.x));n=(s>90?s-270:s+90)*(1-i)}return n+=this._rotation,n?`rotateZ(${n}deg)`:""}_update(t){e.window.cancelAnimationFrame(this._updateFrameId);const r=this._map;r&&(r.transform.renderWorldCopies&&(this._lngLat=eo(this._lngLat,this._pos,r.transform)),this._pos=r.project(this._lngLat),!0===t?this._updateFrameId=e.window.requestAnimationFrame((()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())})):this._pos=this._pos.round(),r._requestDomTask((()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(r._showingGlobe()||r.getTerrain()||r.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))})))}getOffset(){return this._offset}setOffset(t){return this._offset=e.pointGeometry.convert(t),this._update(),this}_onMove(t){const r=this._map;if(!r)return;const n=this._pointerdownPos,i=this._positionDelta;if(n&&i){if(!this._isDragging){const e=this._clickTolerance||r._clickTolerance;if(t.point.dist(n)<e)return;this._isDragging=!0}this._pos=t.point.sub(i),this._lngLat=r.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new e.Event("dragstart"))),this.fire(new e.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const t=this._map;t&&(t.off("mousemove",this._onMove),t.off("touchmove",this._onMove)),"active"===this._state&&this.fire(new e.Event("dragend")),this._state="inactive"}_addDragHandler(e){const t=this._map,r=this._pos;t&&r&&this._element.contains(e.originalEvent.target)&&(e.preventDefault(),this._positionDelta=e.point.sub(r),this._pointerdownPos=e.point,this._state="pending",t.on("mousemove",this._onMove),t.on("touchmove",this._onMove),t.once("mouseup",this._onUp),t.once("touchend",this._onUp))}setDraggable(e){this._draggable=!!e;const t=this._map;return t&&(e?(t.on("mousedown",this._addDragHandler),t.on("touchstart",this._addDragHandler)):(t.off("mousedown",this._addDragHandler),t.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(e){return this._rotation=e||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(e){return this._rotationAlignment=e||"auto",this._update(),this}getRotationAlignment(){return"auto"===this._rotationAlignment||"horizon"===this._rotationAlignment&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(e){return this._pitchAlignment=e||"auto",this._update(),this}getPitchAlignment(){return"auto"===this._pitchAlignment?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(e){return this._occludedOpacity=e||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const no={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},io=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function oo(t=new e.pointGeometry(0,0),r="bottom"){if("number"==typeof t){const n=Math.round(Math.sqrt(.5*Math.pow(t,2)));switch(r){case"top":return new e.pointGeometry(0,t);case"top-left":return new e.pointGeometry(n,n);case"top-right":return new e.pointGeometry(-n,n);case"bottom":return new e.pointGeometry(0,-t);case"bottom-left":return new e.pointGeometry(n,-n);case"bottom-right":return new e.pointGeometry(-n,-n);case"left":return new e.pointGeometry(t,0);case"right":return new e.pointGeometry(-t,0)}return new e.pointGeometry(0,0)}return t instanceof e.pointGeometry||Array.isArray(t)?e.pointGeometry.convert(t):e.pointGeometry.convert(t[r]||[0,0])}class ao{constructor(e){this.jumpTo(e)}getValue(t){if(t<=this._startTime)return this._start;if(t>=this._endTime)return this._end;const r=e.easeCubicInOut((t-this._startTime)/(this._endTime-this._startTime));return this._start*(1-r)+this._end*r}isEasing(e){return e>=this._startTime&&e<=this._endTime}jumpTo(e){this._startTime=-1/0,this._endTime=-1/0,this._start=e,this._end=e}easeTo(e,t,r){this._start=this.getValue(t),this._end=e,this._startTime=t,this._endTime=t+r}}const so={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},uo={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},co={showCompass:!0,showZoom:!0,visualizePitch:!1};class lo{constructor(t,r,n=!1){this._clickTolerance=10,this.element=r,this.mouseRotate=new wi({clickTolerance:t.dragRotate._mouseRotate._clickTolerance}),this.map=t,n&&(this.mousePitch=new ki({clickTolerance:t.dragRotate._mousePitch._clickTolerance})),e.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),r.addEventListener("mousedown",this.mousedown),r.addEventListener("touchstart",this.touchstart,{passive:!1}),r.addEventListener("touchmove",this.touchmove),r.addEventListener("touchend",this.touchend),r.addEventListener("touchcancel",this.reset)}down(e,t){this.mouseRotate.mousedown(e,t),this.mousePitch&&this.mousePitch.mousedown(e,t),l()}move(e,t){const r=this.map,n=this.mouseRotate.mousemoveWindow(e,t),i=n&&n.bearingDelta;if(i&&r.setBearing(r.getBearing()+i),this.mousePitch){const n=this.mousePitch.mousemoveWindow(e,t),i=n&&n.pitchDelta;i&&r.setPitch(r.getPitch()+i)}}off(){const e=this.element;e.removeEventListener("mousedown",this.mousedown),e.removeEventListener("touchstart",this.touchstart,{passive:!1}),e.removeEventListener("touchmove",this.touchmove),e.removeEventListener("touchend",this.touchend),e.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){h(),e.window.removeEventListener("mousemove",this.mousemove),e.window.removeEventListener("mouseup",this.mouseup)}mousedown(t){this.down(e.extend({},t,{ctrlKey:!0,preventDefault:()=>t.preventDefault()}),p(this.element,t)),e.window.addEventListener("mousemove",this.mousemove),e.window.addEventListener("mouseup",this.mouseup)}mousemove(e){this.move(e,p(this.element,e))}mouseup(e){this.mouseRotate.mouseupWindow(e),this.mousePitch&&this.mousePitch.mouseupWindow(e),this.offTemp()}touchstart(e){1!==e.targetTouches.length?this.reset():(this._startPos=this._lastPos=m(this.element,e.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>e.preventDefault()},this._startPos))}touchmove(e){1!==e.targetTouches.length?this.reset():(this._lastPos=m(this.element,e.targetTouches)[0],this.move({preventDefault:()=>e.preventDefault()},this._lastPos))}touchend(e){0===e.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const ho={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},fo={maxWidth:100,unit:"metric"};function po(e,t,r){const n=mo(t),i=n/t,o={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"}[r];this._map._requestDomTask((()=>{this._container.style.width=e*i+"px",this._container.innerHTML=`${n}&nbsp;${o}`}))}function mo(e){const t=Math.pow(10,`${Math.floor(e)}`.length-1);let r=e/t;return r=r>=10?10:r>=5?5:r>=3?3:r>=2?2:r>=1?1:function(e){const t=Math.pow(10,Math.ceil(-Math.log(e)/Math.LN10));return Math.round(e*t)/t}(r),t*r}const go={version:e.version,supported:r,setRTLTextPlugin:e.setRTLTextPlugin,getRTLTextPluginStatus:e.getRTLTextPluginStatus,Map:class extends Xi{constructor(t){if(e.LivePerformanceUtils.mark(e.PerformanceMarkers.create),null!=(t=e.extend({},uo,t)).minZoom&&null!=t.maxZoom&&t.minZoom>t.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=t.minPitch&&null!=t.maxPitch&&t.minPitch>t.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=t.minPitch&&t.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=t.maxPitch&&t.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(t.antialias&&e.isSafariWithAntialiasingBug(e.window)&&(t.antialias=!1,e.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Qn(t.minZoom,t.maxZoom,t.minPitch,t.maxPitch,t.renderWorldCopies),t),this._interactive=t.interactive,this._minTileCacheSize=t.minTileCacheSize,this._maxTileCacheSize=t.maxTileCacheSize,this._failIfMajorPerformanceCaveat=t.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=t.preserveDrawingBuffer,this._antialias=t.antialias,this._useWebGL2=t.useWebGL2,this._trackResize=t.trackResize,this._bearingSnap=t.bearingSnap,this._refreshExpiredTiles=t.refreshExpiredTiles,this._fadeDuration=t.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=t.crossSourceCollisions,this._collectResourceTiming=t.collectResourceTiming,this._optimizeForTerrain=t.optimizeForTerrain,this._language=this._parseLanguage(t.language),this._worldview=t.worldview,this._renderTaskQueue=new Ji,this._domRenderTaskQueue=new Ji,this._controls=[],this._markers=[],this._popups=[],this._mapId=e.uniqueId(),this._locale=e.extend({},so,t.locale),this._clickTolerance=t.clickTolerance,this._cooperativeGestures=t.cooperativeGestures,this._performanceMetricsCollection=t.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new ao(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new e.RequestManager(t.transformRequest,t.accessToken,t.testMode),this._silenceAuthErrors=!!t.testMode,"string"==typeof t.container){if(this._container=e.window.document.getElementById(t.container),!this._container)throw new Error(`Container '${t.container}' not found.`)}else{if(!(t.container instanceof e.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=t.container}if(this._container.childNodes.length>0&&e.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),t.maxBounds&&this.setMaxBounds(t.maxBounds),e.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",(()=>this._update(!1))),this.on("moveend",(()=>this._update(!1))),this.on("zoom",(()=>this._update(!0))),void 0!==e.window&&(e.window.addEventListener("online",this._onWindowOnline,!1),e.window.addEventListener("resize",this._onWindowResize,!1),e.window.addEventListener("orientationchange",this._onWindowResize,!1),e.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),e.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new qi(this,t),this._localFontFamily=t.localFontFamily,this._localIdeographFontFamily=t.localIdeographFontFamily,t.style&&this.setStyle(t.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),t.projection&&this.setProjection(t.projection),this._hash=t.hash&&new Jn("string"==typeof t.hash&&t.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:t.center,zoom:t.zoom,bearing:t.bearing,pitch:t.pitch}),t.bounds&&(this.resize(),this.fitBounds(t.bounds,e.extend({},t.fitBoundsOptions,{duration:0})))),this.resize(),t.attributionControl&&this.addControl(new Qi({customAttribution:t.customAttribution})),this._logoControl=new $i,this.addControl(this._logoControl,t.logoPosition),this.on("style.load",(()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)})),this.on("data",(t=>{this._update("style"===t.dataType),this.fire(new e.Event(`${t.dataType}data`,t))})),this.on("dataloading",(t=>{this.fire(new e.Event(`${t.dataType}dataloading`,t))}))}_getMapId(){return this._mapId}addControl(t,r){if(void 0===r&&(r=t.getDefaultPosition?t.getDefaultPosition():"top-right"),!t||!t.onAdd)return this.fire(new e.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const n=t.onAdd(this);this._controls.push(t);const i=this._controlPositions[r];return-1!==r.indexOf("bottom")?i.insertBefore(n,i.firstChild):i.appendChild(n),this}removeControl(t){if(!t||!t.onRemove)return this.fire(new e.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const r=this._controls.indexOf(t);return r>-1&&this._controls.splice(r,1),t.onRemove(this),this}hasControl(e){return this._controls.indexOf(e)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(t){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const r=!this._moving;return r&&this.fire(new e.Event("movestart",t)).fire(new e.Event("move",t)),this.fire(new e.Event("resize",t)),r&&this.fire(new e.Event("moveend",t)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(t){return this.transform.setMaxBounds(e.LngLatBounds.convert(t)),this._update()}setMinZoom(t){if((t=null==t?-2:t)>=-2&&t<=this.transform.maxZoom)return this.transform.minZoom=t,this._update(),this.getZoom()<t?this.setZoom(t):this.fire(new e.Event("zoomstart")).fire(new e.Event("zoom")).fire(new e.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(t){if((t=null==t?22:t)>=this.transform.minZoom)return this.transform.maxZoom=t,this._update(),this.getZoom()>t?this.setZoom(t):this.fire(new e.Event("zoomstart")).fire(new e.Event("zoom")).fire(new e.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(t){if((t=null==t?0:t)<0)throw new Error("minPitch must be greater than or equal to 0");if(t>=0&&t<=this.transform.maxPitch)return this.transform.minPitch=t,this._update(),this.getPitch()<t?this.setPitch(t):this.fire(new e.Event("pitchstart")).fire(new e.Event("pitch")).fire(new e.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(t){if((t=null==t?85:t)>85)throw new Error("maxPitch must be less than or equal to 85");if(t>=this.transform.minPitch)return this.transform.maxPitch=t,this._update(),this.getPitch()>t?this.setPitch(t):this.fire(new e.Event("pitchstart")).fire(new e.Event("pitch")).fire(new e.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(e){return this.transform.renderWorldCopies=e,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(t){return"auto"===t?e.window.navigator.language:Array.isArray(t)?0===t.length?void 0:t.map((t=>"auto"===t?e.window.navigator.language:t)):t}setLanguage(e){const t=this._parseLanguage(e);if(!this.style||t===this._language)return this;this._language=t,this.style._reloadSources();for(const r of this._controls)r._setLanguage&&r._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(e){return this.style&&e!==this._worldview?(this._worldview=e,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return"globe"===this.transform.projection.name}setProjection(e){return this._lazyInitEmptyStyle(),e?"string"==typeof e&&(e={name:e}):e=null,this._useExplicitProjection=!!e,this._prioritizeAndUpdateProjection(e,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if("globe"!==this.getProjection().name)return;const t=this.transform,r=t.projection.name;let n;"globe"===r&&t.zoom>=e.GLOBE_ZOOM_THRESHOLD_MAX?(t.setMercatorFromTransition(),n=!0):"mercator"===r&&t.zoom<e.GLOBE_ZOOM_THRESHOLD_MAX&&(t.setProjection({name:"globe"}),n=!0),n&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(e,t){return this._updateProjection(e||t||{name:"mercator"})}_updateProjection(t){let r;if(r="globe"===t.name&&this.transform.zoom>=e.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(t),this.style.applyProjectionUpdate(),r){this.painter.clearBackgroundTiles();for(const e in this.style._sourceCaches)this.style._sourceCaches[e].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(t){return this.transform.locationPoint3D(e.LngLat.convert(t))}unproject(t){return this.transform.pointLocation3D(e.pointGeometry.convert(t))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(e,t,r){if("mouseenter"===e||"mouseover"===e){let n=!1;const i=i=>{const o=t.filter((e=>this.getLayer(e))),a=o.length?this.queryRenderedFeatures(i.point,{layers:o}):[];a.length?n||(n=!0,r.call(this,new ci(e,this,i.originalEvent,{features:a}))):n=!1},o=()=>{n=!1};return{layers:new Set(t),listener:r,delegates:{mousemove:i,mouseout:o}}}if("mouseleave"===e||"mouseout"===e){let n=!1;const i=i=>{const o=t.filter((e=>this.getLayer(e)));(o.length?this.queryRenderedFeatures(i.point,{layers:o}):[]).length?n=!0:n&&(n=!1,r.call(this,new ci(e,this,i.originalEvent)))},o=t=>{n&&(n=!1,r.call(this,new ci(e,this,t.originalEvent)))};return{layers:new Set(t),listener:r,delegates:{mousemove:i,mouseout:o}}}{const n=e=>{const n=t.filter((e=>this.getLayer(e))),i=n.length?this.queryRenderedFeatures(e.point,{layers:n}):[];i.length&&(e.features=i,r.call(this,e),delete e.features)};return{layers:new Set(t),listener:r,delegates:{[e]:n}}}}on(e,t,r){if(void 0===r)return super.on(e,t);Array.isArray(t)||(t=[t]);const n=this._createDelegatedListener(e,t,r);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[e]=this._delegatedListeners[e]||[],this._delegatedListeners[e].push(n);for(const i in n.delegates)this.on(i,n.delegates[i]);return this}once(e,t,r){if(void 0===r)return super.once(e,t);Array.isArray(t)||(t=[t]);const n=this._createDelegatedListener(e,t,r);for(const i in n.delegates)this.once(i,n.delegates[i]);return this}off(e,t,r){if(void 0===r)return super.off(e,t);t=new Set(Array.isArray(t)?t:[t]);const n=(e,t)=>{if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0},i=this._delegatedListeners?this._delegatedListeners[e]:void 0;return i&&(e=>{for(let i=0;i<e.length;i++){const o=e[i];if(o.listener===r&&n(o.layers,t)){for(const e in o.delegates)this.off(e,o.delegates[e]);return e.splice(i,1),this}}})(i),this}queryRenderedFeatures(t,r){return this.style?(void 0!==r||void 0===t||t instanceof e.pointGeometry||Array.isArray(t)||(r=t,t=void 0),this.style.queryRenderedFeatures(t=t||[[0,0],[this.transform.width,this.transform.height]],r=r||{},this.transform)):[]}querySourceFeatures(e,t){return this.style.querySourceFeatures(e,t)}setStyle(t,r){return!1!==(r=e.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},r)).diff&&r.localIdeographFontFamily===this._localIdeographFontFamily&&r.localFontFamily===this._localFontFamily&&this.style&&t?(this._diffStyle(t,r),this):(this._localIdeographFontFamily=r.localIdeographFontFamily,this._localFontFamily=r.localFontFamily,this._updateStyle(t,r))}_getUIString(e){const t=this._locale[e];if(null==t)throw new Error(`Missing UI string '${e}'`);return t}_updateStyle(e,t){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),e&&(this.style=new Jt(this,t||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof e?this.style.loadURL(e):this.style.loadJSON(e)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Jt(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(t,r){if("string"==typeof t){const n=this._requestManager.normalizeStyleURL(t),i=this._requestManager.transformRequest(n,e.ResourceType.Style);e.getJSON(i,((t,n)=>{t?this.fire(new e.ErrorEvent(t)):n&&this._updateDiff(n,r)}))}else"object"==typeof t&&this._updateDiff(t,r)}_updateDiff(t,r){try{this.style.setState(t)&&this._update(!0)}catch(n){e.warnOnce(`Unable to perform style diff: ${n.message||n.error||n}.  Rebuilding the style from scratch.`),this._updateStyle(t,r)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(e.warnOnce("There is no style added to the map."),!1)}addSource(e,t){return this._lazyInitEmptyStyle(),this.style.addSource(e,t),this._update(!0)}isSourceLoaded(e){return!!this.style&&this.style._isSourceCacheLoaded(e)}areTilesLoaded(){const e=this.style&&this.style._sourceCaches;for(const t in e){const r=e[t]._tiles;for(const e in r){const t=r[e];if("loaded"!==t.state&&"errored"!==t.state)return!1}}return!0}addSourceType(e,t,r){this._lazyInitEmptyStyle(),this.style.addSourceType(e,t,r)}removeSource(e){return this.style.removeSource(e),this._updateTerrain(),this._update(!0)}getSource(e){return this.style.getSource(e)}addImage(t,r,{pixelRatio:n=1,sdf:i=!1,stretchX:o,stretchY:a,content:s}={}){if(this._lazyInitEmptyStyle(),r instanceof e.window.HTMLImageElement||e.window.ImageBitmap&&r instanceof e.window.ImageBitmap){const{width:u,height:c,data:l}=e.exported.getImageData(r);this.style.addImage(t,{data:new e.RGBAImage({width:u,height:c},l),pixelRatio:n,stretchX:o,stretchY:a,content:s,sdf:i,version:0})}else if(void 0===r.width||void 0===r.height)this.fire(new e.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:u,height:c}=r,l=r;this.style.addImage(t,{data:new e.RGBAImage({width:u,height:c},new Uint8Array(l.data)),pixelRatio:n,stretchX:o,stretchY:a,content:s,sdf:i,version:0,userImage:l}),l.onAdd&&l.onAdd(this,t)}}updateImage(t,r){const n=this.style.getImage(t);if(!n)return void this.fire(new e.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const i=r instanceof e.window.HTMLImageElement||e.window.ImageBitmap&&r instanceof e.window.ImageBitmap?e.exported.getImageData(r):r,{width:o,height:a}=i;void 0!==o&&void 0!==a?o===n.data.width&&a===n.data.height?(n.data.replace(i.data,!(r instanceof e.window.HTMLImageElement||e.window.ImageBitmap&&r instanceof e.window.ImageBitmap)),this.style.updateImage(t,n)):this.fire(new e.ErrorEvent(new Error(`The width and height of the updated image (${o}, ${a})\n                must be that same as the previous version of the image\n                (${n.data.width}, ${n.data.height})`))):this.fire(new e.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(t){return t?!!this.style.getImage(t):(this.fire(new e.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(e){this.style.removeImage(e)}loadImage(t,r){e.getImage(this._requestManager.transformRequest(t,e.ResourceType.Image),((t,n)=>{r(t,n instanceof e.window.HTMLImageElement?e.exported.getImageData(n):n)}))}listImages(){return this.style.listImages()}addLayer(e,t){return this._lazyInitEmptyStyle(),this.style.addLayer(e,t),this._update(!0)}moveLayer(e,t){return this.style.moveLayer(e,t),this._update(!0)}removeLayer(e){return this.style.removeLayer(e),this._update(!0)}getLayer(e){return this.style.getLayer(e)}setLayerZoomRange(e,t,r){return this.style.setLayerZoomRange(e,t,r),this._update(!0)}setFilter(e,t,r={}){return this.style.setFilter(e,t,r),this._update(!0)}getFilter(e){return this.style.getFilter(e)}setPaintProperty(e,t,r,n={}){return this.style.setPaintProperty(e,t,r,n),this._update(!0)}getPaintProperty(e,t){return this.style.getPaintProperty(e,t)}setLayoutProperty(e,t,r,n={}){return this.style.setLayoutProperty(e,t,r,n),this._update(!0)}getLayoutProperty(e,t){return this.style.getLayoutProperty(e,t)}setLight(e,t={}){return this._lazyInitEmptyStyle(),this.style.setLight(e,t),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(e){return this._lazyInitEmptyStyle(),!e&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(e),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(e){return this._lazyInitEmptyStyle(),this.style.setFog(e),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(t){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(e.LngLat.convert(t),this.transform):0}setFeatureState(e,t){return this.style.setFeatureState(e,t),this._update()}removeFeatureState(e,t){return this.style.removeFeatureState(e,t),this._update()}getFeatureState(e){return this.style.getFeatureState(e)}_updateContainerDimensions(){if(!this._container)return;const t=this._container.getBoundingClientRect().width||400,r=this._container.getBoundingClientRect().height||300;let n,i,o,a=this._container;for(;a&&(!i||!o);){const t=e.window.getComputedStyle(a).transform;t&&"none"!==t&&(n=t.match(/matrix.*\((.+)\)/)[1].split(", "),n[0]&&"0"!==n[0]&&"1"!==n[0]&&(i=n[0]),n[3]&&"0"!==n[3]&&"1"!==n[3]&&(o=n[3])),a=a.parentElement}this._containerWidth=i?Math.abs(t/i):t,this._containerHeight=o?Math.abs(r/o):r}_detectMissingCSS(){"rgb(250, 128, 114)"!==e.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&e.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const e=this._container;e.classList.add("mapboxgl-map"),(this._missingCSSCanary=o("div","mapboxgl-canary",e)).style.visibility="hidden",this._detectMissingCSS();const t=this._canvasContainer=o("div","mapboxgl-canvas-container",e);this._interactive&&t.classList.add("mapboxgl-interactive"),this._canvas=o("canvas","mapboxgl-canvas",t),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const r=this._controlContainer=o("div","mapboxgl-control-container",e),n=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((e=>{n[e]=o("div",`mapboxgl-ctrl-${e}`,r)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(t,r){const n=e.exported.devicePixelRatio||1;this._canvas.width=n*Math.ceil(t),this._canvas.height=n*Math.ceil(r),this._canvas.style.width=`${t}px`,this._canvas.style.height=`${r}px`}_addMarker(e){this._markers.push(e)}_removeMarker(e){const t=this._markers.indexOf(e);-1!==t&&this._markers.splice(t,1)}_addPopup(e){this._popups.push(e)}_removePopup(e){const t=this._popups.indexOf(e);-1!==t&&this._popups.splice(t,1)}_setupPainter(){const t=e.extend({},r.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),n=this._useWebGL2&&this._canvas.getContext("webgl2",t),i=n||this._canvas.getContext("webgl",t)||this._canvas.getContext("experimental-webgl",t);i?(this._useWebGL2&&!n&&e.warnOnce("Failed to create WebGL 2 context. Using WebGL 1."),e.storeAuthState(i,!0),this.painter=new Nn(i,this.transform,!!n),this.on("data",(e=>{"source"===e.dataType&&this.painter.setTileLoadedFlag(!0)})),e.exported$1.testSupport(i)):this.fire(new e.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(t){t.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new e.Event("webglcontextlost",{originalEvent:t}))}_contextRestored(t){this._setupPainter(),this.resize(),this._update(),this.fire(new e.Event("webglcontextrestored",{originalEvent:t}))}_onMapScroll(e){if(e.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(e){return this.style?(this._styleDirty=this._styleDirty||e,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(e){return this._update(),this._renderTaskQueue.add(e)}_cancelRenderFrame(e){this._renderTaskQueue.remove(e)}_requestDomTask(e){!this.loaded()||this.loaded()&&!this.isMoving()?e():this._domRenderTaskQueue.add(e)}_render(t){let r;const n=this.painter.context.extTimerQuery,i=e.exported.now();if(this.listens("gpu-timing-frame")&&(r=n.createQueryEXT(),n.beginQueryEXT(n.TIME_ELAPSED_EXT,r)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],e.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],e.window.performance.now())),this._renderTaskQueue.run(t),this._domRenderTaskQueue.run(t),this._removed)return;this._updateProjectionTransition();const o=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const t=this.transform.zoom,r=this.transform.pitch,n=e.exported.now(),i=new e.EvaluationParameters(t,{now:n,fadeDuration:o,pitch:r,transition:this.style.getTransition()});this.style.update(i)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let a=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),a=this._updateAverageElevation(i),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):a=this._updateAverageElevation(i),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,o,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:o,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new e.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new e.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),r){const t=e.exported.now()-i;n.endQueryEXT(n.TIME_ELAPSED_EXT,r),setTimeout((()=>{const o=n.getQueryObjectEXT(r,n.QUERY_RESULT_EXT)/1e6;n.deleteQueryEXT(r),this.fire(new e.Event("gpu-timing-frame",{cpuTime:t,gpuTime:o})),e.window.performance.mark("frame-gpu",{startTime:i,detail:{gpuTime:o}})}),50)}if(this.listens("gpu-timing-layer")){const t=this.painter.collectGpuTimers();setTimeout((()=>{const r=this.painter.queryGpuTimers(t);this.fire(new e.Event("gpu-timing-layer",{layerTimes:r}))}),50)}if(this.listens("gpu-timing-deferred-render")){const t=this.painter.collectDeferredRenderGpuQueries();setTimeout((()=>{const r=this.painter.queryGpuTimeDeferredRender(t);this.fire(new e.Event("gpu-timing-deferred-render",{gpuTime:r}))}),50)}const s=this._sourcesDirty||this._styleDirty||this._placementDirty||a;if(s||this._repaint)this.triggerRepaint();else{const t=!this.isMoving()&&this.loaded();if(t&&(a=this._updateAverageElevation(i,!0)),a)this.triggerRepaint();else if(this._triggerFrame(!1),t&&(this.fire(new e.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const t=this._calculateSpeedIndex();this.fire(new e.Event("speedindexcompleted",{speedIndex:t})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||s||(this._fullyLoaded=!0,e.LivePerformanceUtils.mark(e.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&e.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(e){for(const t of this._markers)e&&!this.getRenderWorldCopies()&&(t._lngLat=t._lngLat.wrap()),t._update();for(const t of this._popups)!e||this.getRenderWorldCopies()||t._trackPointer||(t._lngLat=t._lngLat.wrap()),t._update()}_updateAverageElevation(e,t=!1){const r=e=>(this.transform.averageElevation=e,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return 0!==this.transform.averageElevation&&r(0);if((t||e-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(e)){const t=this.transform.averageElevation;let n=this.transform.sampleAverageElevation(),i=!1;this.transform.elevation&&(i=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(n)?n=0:this._averageElevationLastSampledAt=e;const o=Math.abs(t-n);if(o>1){if(this._isInitialLoad||i)return this._averageElevation.jumpTo(n),r(n);this._averageElevation.easeTo(n,e,300)}else if(o>1e-4)return this._averageElevation.jumpTo(n),r(n)}return!!this._averageElevation.isEasing(e)&&r(this._averageElevation.getValue(e))}_authenticate(){e.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,(t=>{if(t&&(t.message===e.AUTH_ERR_MSG||401===t.status)){const t=this.painter.context.gl;e.storeAuthState(t,!1),this._logoControl instanceof $i&&this._logoControl._updateLogo(),t&&t.clear(t.DEPTH_BUFFER_BIT|t.COLOR_BUFFER_BIT|t.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new e.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}})),e.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,(()=>{}))}_updateTerrain(){const e=this._isDragging();this.painter.updateTerrain(this.style,e)}_calculateSpeedIndex(){const e=this.painter.canvasCopy(),t=this.painter.getCanvasCopiesAndTimestamps();t.timeStamps.push(performance.now());const r=this.painter.context.gl,n=r.createFramebuffer();function i(e){r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,e,0);const t=new Uint8Array(r.drawingBufferWidth*r.drawingBufferHeight*4);return r.readPixels(0,0,r.drawingBufferWidth,r.drawingBufferHeight,r.RGBA,r.UNSIGNED_BYTE,t),t}return r.bindFramebuffer(r.FRAMEBUFFER,n),this._canvasPixelComparison(i(e),t.canvasCopies.map(i),t.timeStamps)}_canvasPixelComparison(e,t,r){let n=r[1]-r[0];const i=e.length/4;for(let o=0;o<t.length;o++){const a=t[o];let s=0;for(let t=0;t<a.length;t+=4)a[t]===e[t]&&a[t+1]===e[t+1]&&a[t+2]===e[t+2]&&a[t+3]===e[t+3]&&(s+=1);n+=(r[o+2]-r[o+1])*(1-s/i)}return n}remove(){this._hash&&this._hash.remove();for(const e of this._controls)e.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),void 0!==e.window&&(e.window.removeEventListener("resize",this._onWindowResize,!1),e.window.removeEventListener("orientationchange",this._onWindowResize,!1),e.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),e.window.removeEventListener("online",this._onWindowOnline,!1),e.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const t=this.painter.context.gl.getExtension("WEBGL_lose_context");t&&t.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),e.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new e.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(t){this._renderNextFrame=this._renderNextFrame||t,this.style&&!this._frame&&(this._frame=e.exported.frame((e=>{const t=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,t&&this._render(e)})))}_preloadTiles(t){const r=this.style?Object.values(this.style._sourceCaches):[];return e.asyncAll(r,((e,r)=>e._preloadTiles(t,r)),(()=>{this.triggerRepaint()})),this}_onWindowOnline(){this._update()}_onWindowResize(e){this._trackResize&&this.resize({originalEvent:e})._update()}_onVisibilityChange(){"hidden"===e.window.document.visibilityState&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(e){this._showTileBoundaries!==e&&(this._showTileBoundaries=e,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(e){this._showTerrainWireframe!==e&&(this._showTerrainWireframe=e,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(e){this._speedIndexTiming!==e&&(this._speedIndexTiming=e,this._update())}get showPadding(){return!!this._showPadding}set showPadding(e){this._showPadding!==e&&(this._showPadding=e,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(e){this._showCollisionBoxes!==e&&(this._showCollisionBoxes=e,e?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(e){this._showOverdrawInspector!==e&&(this._showOverdrawInspector=e,this._update())}get repaint(){return!!this._repaint}set repaint(e){this._repaint!==e&&(this._repaint=e,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(e){this._vertices=e,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(e){this._showTileAABBs!==e&&(this._showTileAABBs=e,e&&this._update())}_setCacheLimits(t,r){e.setCacheLimits(t,r)}get version(){return e.version}},NavigationControl:class{constructor(t){this.options=e.extend({},co,t),this._container=o("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",(e=>e.preventDefault())),this.options.showZoom&&(e.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",(e=>{this._map&&this._map.zoomIn({},{originalEvent:e})})),o("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",(e=>{this._map&&this._map.zoomOut({},{originalEvent:e})})),o("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(e.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",(e=>{const t=this._map;t&&(this.options.visualizePitch?t.resetNorthPitch({},{originalEvent:e}):t.resetNorth({},{originalEvent:e}))})),this._compassIcon=o("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const e=this._map;if(!e)return;const t=e.getZoom(),r=t===e.getMaxZoom(),n=t===e.getMinZoom();this._zoomInButton.disabled=r,this._zoomOutButton.disabled=n,this._zoomInButton.setAttribute("aria-disabled",r.toString()),this._zoomOutButton.setAttribute("aria-disabled",n.toString())}_rotateCompassArrow(){const e=this._map;if(!e)return;const t=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(e.transform.pitch*(Math.PI/180)),.5)}) rotateX(${e.transform.pitch}deg) rotateZ(${e.transform.angle*(180/Math.PI)}deg)`:`rotate(${e.transform.angle*(180/Math.PI)}deg)`;e._requestDomTask((()=>{this._compassIcon&&(this._compassIcon.style.transform=t)}))}onAdd(e){return this._map=e,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),e.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&e.on("pitch",this._rotateCompassArrow),e.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new lo(e,this._compass,this.options.visualizePitch)),this._container}onRemove(){const e=this._map;e&&(this._container.remove(),this.options.showZoom&&e.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&e.off("pitch",this._rotateCompassArrow),e.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(e,t){const r=o("button",e,this._container);return r.type="button",r.addEventListener("click",t),r}_setButtonTitle(e,t){if(!this._map)return;const r=this._map._getUIString(`NavigationControl.${t}`);e.setAttribute("aria-label",r),e.firstElementChild&&e.firstElementChild.setAttribute("title",r)}},GeolocateControl:class extends e.Evented{constructor(t){super(),this.options=e.extend({geolocation:e.window.navigator.geolocation},ho,t),e.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=$n(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(e){return this._map=e,this._container=o("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){void 0!==this._geolocationWatchID&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(t){const r=(e=!!this.options.geolocation)=>{this._supportsGeolocation=e,t(e)};void 0!==this._supportsGeolocation?t(this._supportsGeolocation):void 0!==e.window.navigator.permissions?e.window.navigator.permissions.query({name:"geolocation"}).then((e=>r("denied"!==e.state))).catch((()=>r())):r()}_isOutOfMapMaxBounds(e){const t=this._map.getMaxBounds(),r=e.coords;return!!t&&(r.longitude<t.getWest()||r.longitude>t.getEast()||r.latitude<t.getSouth()||r.latitude>t.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(t){if(this._map){if(this._isOutOfMapMaxBounds(t))return this._setErrorState(),this.fire(new e.Event("outofmaxbounds",t)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=t,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(t),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(t),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new e.Event("geolocate",t)),this._finish()}}_updateCamera(t){const r=new e.LngLat(t.coords.longitude,t.coords.latitude),n=t.coords.accuracy,i=this._map.getBearing(),o=e.extend({bearing:i},this.options.fitBoundsOptions);this._map.fitBounds(r.toBounds(n),o,{geolocateSource:!0})}_updateMarker(t){if(t){const r=new e.LngLat(t.coords.longitude,t.coords.latitude);this._accuracyCircleMarker.setLngLat(r).addTo(this._map),this._userLocationDotMarker.setLngLat(r).addTo(this._map),this._accuracy=t.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const t=this._map.transform,r=e.mercatorZfromAltitude(1,t._center.lat)*t.worldSize,n=Math.ceil(2*this._accuracy*r);this._circleElement.style.width=`${n}px`,this._circleElement.style.height=`${n}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&"number"==typeof this._heading?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(t){if(this._map){if(this.options.trackUserLocation)if(1===t.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const e=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",e),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",e),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===t.code&&this._noTimeout)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new e.Event("error",t)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(t){if(void 0!==this._map){if(this._container.addEventListener("contextmenu",(e=>e.preventDefault())),this._geolocateButton=o("button","mapboxgl-ctrl-geolocate",this._container),o("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===t){e.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const t=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",t),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",t)}else{const e=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",e),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",e)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=o("div","mapboxgl-user-location"),this._dotElement.appendChild(o("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(o("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new ro({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=o("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new ro({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(t=>{t.geolocateSource||"ACTIVE_LOCK"!==this._watchState||t.originalEvent&&"resize"===t.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new e.Event("trackuserlocationend")))}))}}_onDeviceOrientation(e){this._userLocationDotMarker&&(e.webkitCompassHeading?this._heading=e.webkitCompassHeading:!0===e.absolute&&(this._heading=-1*e.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return e.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new e.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new e.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new e.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let e;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(e={maximumAge:6e5,timeout:0},this._noTimeout=!0):(e=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,e),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const t=()=>{e.window.addEventListener("ondeviceorientationabsolute"in e.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};void 0!==e.window.DeviceMotionEvent&&"function"==typeof e.window.DeviceMotionEvent.requestPermission?DeviceOrientationEvent.requestPermission().then((e=>{"granted"===e&&t()})).catch(console.error):t()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),e.window.removeEventListener("deviceorientation",this._onDeviceOrientation),e.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Qi,ScaleControl:class{constructor(t){this.options=e.extend({},fo,t),function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"narrow",unit:"meter"}),!0}catch(e){return!1}}()||(this._setScale=po.bind(this)),e.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const e=this.options.maxWidth||100,t=this._map,r=t._containerHeight/2,n=t._containerWidth/2-e/2,i=t.unproject([n,r]),o=t.unproject([n+e,r]),a=i.distanceTo(o);if("imperial"===this.options.unit){const t=3.2808*a;t>5280?this._setScale(e,t/5280,"mile"):this._setScale(e,t,"foot")}else"nautical"===this.options.unit?this._setScale(e,a/1852,"nautical-mile"):a>=1e3?this._setScale(e,a/1e3,"kilometer"):this._setScale(e,a,"meter")}_setScale(e,t,r){const n=mo(t),i=n/t;this._map._requestDomTask((()=>{this._container.style.width=e*i+"px",this._container.innerHTML="nautical-mile"!==r?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"narrow",unit:r}).format(n):`${n}&nbsp;nm`}))}onAdd(e){return this._map=e,this._language=e.getLanguage(),this._container=o("div","mapboxgl-ctrl mapboxgl-ctrl-scale",e.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(e){this._language=e,this._update()}setUnit(e){this.options.unit=e,this._update()}},FullscreenControl:class{constructor(t){this._fullscreen=!1,t&&t.container&&(t.container instanceof e.window.HTMLElement?this._container=t.container:e.warnOnce("Full screen control 'container' must be a DOM element.")),e.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in e.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in e.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(t){return this._map=t,this._container||(this._container=this._map.getContainer()),this._controlContainer=o("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",e.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,e.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!e.window.document.fullscreenEnabled&&!e.window.document.webkitFullscreenEnabled)}_setupUI(){const t=this._fullscreenButton=o("button","mapboxgl-ctrl-fullscreen",this._controlContainer);o("span","mapboxgl-ctrl-icon",t).setAttribute("aria-hidden","true"),t.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),e.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const e=this._getTitle();this._fullscreenButton.setAttribute("aria-label",e),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",e)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(e.window.document.fullscreenElement||e.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?e.window.document.exitFullscreen?e.window.document.exitFullscreen():e.window.document.webkitCancelFullScreen&&e.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends e.Evented{constructor(t){super(),this.options=e.extend(Object.create(no),t),e.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(t&&t.className?t.className.trim().split(/\s+/):[])}addTo(t){return this._map&&this.remove(),this._map=t,this.options.closeOnClick&&t.on("preclick",this._onClose),this.options.closeOnMove&&t.on("move",this._onClose),t.on("remove",this.remove),this._update(),t._addPopup(this),this._focusFirstElement(),this._trackPointer?(t.on("mousemove",this._onMouseEvent),t.on("mouseup",this._onMouseEvent),t._canvasContainer.classList.add("mapboxgl-track-pointer")):t.on("move",this._update),this.fire(new e.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const t=this._map;return t&&(t.off("move",this._update),t.off("move",this._onClose),t.off("preclick",this._onClose),t.off("click",this._onClose),t.off("remove",this.remove),t.off("mousemove",this._onMouseEvent),t.off("mouseup",this._onMouseEvent),t.off("drag",this._onMouseEvent),t._canvasContainer&&t._canvasContainer.classList.remove("mapboxgl-track-pointer"),t._removePopup(this),this._map=void 0),this.fire(new e.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(t){this._lngLat=e.LngLat.convert(t),this._pos=null,this._trackPointer=!1,this._update();const r=this._map;return r&&(r.on("move",this._update),r.off("mousemove",this._onMouseEvent),r._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const e=this._map;return e&&(e.off("move",this._update),e.on("mousemove",this._onMouseEvent),e.on("drag",this._onMouseEvent),e._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(t){return this.setDOMContent(e.window.document.createTextNode(t))}setHTML(t){const r=e.window.document.createDocumentFragment(),n=e.window.document.createElement("body");let i;for(n.innerHTML=t;i=n.firstChild,i;)r.appendChild(i);return this.setDOMContent(r)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(e){return this.options.maxWidth=e,this._update(),this}setDOMContent(e){let t=this._content;if(t)for(;t.hasChildNodes();)t.firstChild&&t.removeChild(t.firstChild);else t=this._content=o("div","mapboxgl-popup-content",this._container||void 0);if(t.appendChild(e),this.options.closeButton){const e=this._closeButton=o("button","mapboxgl-popup-close-button",t);e.type="button",e.setAttribute("aria-label","Close popup"),e.setAttribute("aria-hidden","true"),e.innerHTML="&#215;",e.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(e){return this._classList.add(e),this._updateClassList(),this}removeClassName(e){return this._classList.delete(e),this._updateClassList(),this}setOffset(e){return this.options.offset=e,this._update(),this}toggleClassName(e){let t;return this._classList.delete(e)?t=!1:(this._classList.add(e),t=!0),this._updateClassList(),t}_onMouseEvent(e){this._update(e.point)}_getAnchor(e){if(this.options.anchor)return this.options.anchor;const t=this._map,r=this._container,n=this._pos;if(!t||!r||!n)return"bottom";const i=r.offsetWidth,o=r.offsetHeight,a=n.x<i/2,s=n.x>t.transform.width-i/2;if(n.y+e<o)return a?"top-left":s?"top-right":"top";if(n.y>t.transform.height-o){if(a)return"bottom-left";if(s)return"bottom-right"}return a?"left":s?"right":"bottom"}_updateClassList(){const e=this._container;if(!e)return;const t=[...this._classList];t.push("mapboxgl-popup"),this._anchor&&t.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&t.push("mapboxgl-popup-track-pointer"),e.className=t.join(" ")}_update(t){const r=this._map,n=this._content;if(!r||!this._lngLat&&!this._trackPointer||!n)return;let i=this._container;if(i||(i=this._container=o("div","mapboxgl-popup",r.getContainer()),this._tip=o("div","mapboxgl-popup-tip",i),i.appendChild(n)),this.options.maxWidth&&i.style.maxWidth!==this.options.maxWidth&&(i.style.maxWidth=this.options.maxWidth),r.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=eo(this._lngLat,this._pos,r.transform)),!this._trackPointer||t){const e=this._pos=this._trackPointer&&t?t:r.project(this._lngLat),n=oo(this.options.offset),i=this._anchor=this._getAnchor(n.y),o=oo(this.options.offset,i),a=e.add(o).round();r._requestDomTask((()=>{this._container&&i&&(this._container.style.transform=`${to[i]} translate(${a.x}px,${a.y}px)`)}))}if(!this._marker&&r._showingGlobe()){const t=e.isLngLatBehindGlobe(r.transform,this._lngLat)?0:1;this._setOpacity(t)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const e=this._container.querySelector(io);e&&e.focus()}_onClose(){this.remove()}_setOpacity(e){this._container&&(this._container.style.opacity=`${e}`),this._content&&(this._content.style.pointerEvents=e?"auto":"none")}},Marker:ro,Style:Jt,LngLat:e.LngLat,LngLatBounds:e.LngLatBounds,Point:e.pointGeometry,MercatorCoordinate:e.MercatorCoordinate,FreeCameraOptions:Vn,Evented:e.Evented,config:e.config,prewarm:function(){je().acquire(Ue)},clearPrewarmedResources:function(){const e=Fe;e&&(e.isPreloaded()&&1===e.numActive()?(e.release(Ue),Fe=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return e.config.ACCESS_TOKEN},set accessToken(t){e.config.ACCESS_TOKEN=t},get baseApiUrl(){return e.config.API_URL},set baseApiUrl(t){e.config.API_URL=t},get workerCount(){return Ze.workerCount},set workerCount(e){Ze.workerCount=e},get maxParallelImageRequests(){return e.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(t){e.config.MAX_PARALLEL_IMAGE_REQUESTS=t},clearStorage(t){e.clearTileCache(t)},workerUrl:"",workerClass:null,setNow:e.exported.setNow,restoreNow:e.exported.restoreNow};return go})),r}()},7420:function(){},5856:function(){},6601:function(){},4642:function(e,t,r){var n=r(3801);function i(e){var t,r;function i(t,r){try{var a=e[t](r),s=a.value,u=s instanceof n;Promise.resolve(u?s.v:s).then((function(r){if(u){var n="return"===t?"return":"next";if(!s.k||r.done)return i(n,r);r=e[n](r).value}o(a.done?"return":"normal",r)}),(function(e){i("throw",e)}))}catch(c){o("throw",c)}}function o(e,n){switch(e){case"return":t.resolve({value:n,done:!0});break;case"throw":t.reject(n);break;default:t.resolve({value:n,done:!1})}(t=t.next)?i(t.key,t.arg):r=null}this._invoke=function(e,n){return new Promise((function(o,a){var s={key:e,arg:n,resolve:o,reject:a,next:null};r?r=r.next=s:(t=r=s,i(e,n))}))},"function"!=typeof e.return&&(this.return=void 0)}i.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},i.prototype.next=function(e){return this._invoke("next",e)},i.prototype.throw=function(e){return this._invoke("throw",e)},i.prototype.return=function(e){return this._invoke("return",e)},e.exports=i,e.exports.__esModule=!0,e.exports.default=e.exports},3801:function(e){e.exports=function(e,t){this.v=e,this.k=t},e.exports.__esModule=!0,e.exports.default=e.exports},3897:function(e){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n},e.exports.__esModule=!0,e.exports.default=e.exports},5372:function(e){e.exports=function(e){if(Array.isArray(e))return e},e.exports.__esModule=!0,e.exports.default=e.exports},3405:function(e,t,r){var n=r(3897);e.exports=function(e){if(Array.isArray(e))return n(e)},e.exports.__esModule=!0,e.exports.default=e.exports},6115:function(e){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},e.exports.__esModule=!0,e.exports.default=e.exports},7156:function(e){function t(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,i)}e.exports=function(e){return function(){var r=this,n=arguments;return new Promise((function(i,o){var a=e.apply(r,n);function s(e){t(a,i,o,s,u,"next",e)}function u(e){t(a,i,o,s,u,"throw",e)}s(void 0)}))}},e.exports.__esModule=!0,e.exports.default=e.exports},6737:function(e,t,r){var n=r(3801);e.exports=function(e){return new n(e,0)},e.exports.__esModule=!0,e.exports.default=e.exports},6690:function(e){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.__esModule=!0,e.exports.default=e.exports},3515:function(e,t,r){var n=r(6015),i=r(9617);function o(t,r,a){return i()?(e.exports=o=Reflect.construct.bind(),e.exports.__esModule=!0,e.exports.default=e.exports):(e.exports=o=function(e,t,r){var i=[null];i.push.apply(i,t);var o=new(Function.bind.apply(e,i));return r&&n(o,r.prototype),o},e.exports.__esModule=!0,e.exports.default=e.exports),o.apply(null,arguments)}e.exports=o,e.exports.__esModule=!0,e.exports.default=e.exports},9728:function(e,t,r){var n=r(4062);function i(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,n(i.key),i)}}e.exports=function(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e},e.exports.__esModule=!0,e.exports.default=e.exports},4704:function(e,t,r){var n=r(6116);e.exports=function(e,t){var r="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=n(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){u=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(u)throw a}}}},e.exports.__esModule=!0,e.exports.default=e.exports},6389:function(e,t,r){var n=r(3808),i=r(9617),o=r(4993);e.exports=function(e){var t=i();return function(){var r,i=n(e);if(t){var a=n(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return o(this,r)}},e.exports.__esModule=!0,e.exports.default=e.exports},8416:function(e,t,r){var n=r(4062);e.exports=function(e,t,r){return(t=n(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e},e.exports.__esModule=!0,e.exports.default=e.exports},1588:function(e,t,r){var n=r(1753);function i(){return"undefined"!==typeof Reflect&&Reflect.get?(e.exports=i=Reflect.get.bind(),e.exports.__esModule=!0,e.exports.default=e.exports):(e.exports=i=function(e,t,r){var i=n(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},e.exports.__esModule=!0,e.exports.default=e.exports),i.apply(this,arguments)}e.exports=i,e.exports.__esModule=!0,e.exports.default=e.exports},3808:function(e){function t(r){return e.exports=t=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},e.exports.__esModule=!0,e.exports.default=e.exports,t(r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},1655:function(e,t,r){var n=r(6015);e.exports=function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&n(e,t)},e.exports.__esModule=!0,e.exports.default=e.exports},4836:function(e){e.exports=function(e){return e&&e.__esModule?e:{default:e}},e.exports.__esModule=!0,e.exports.default=e.exports},6035:function(e){e.exports=function(e){return-1!==Function.toString.call(e).indexOf("[native code]")},e.exports.__esModule=!0,e.exports.default=e.exports},9617:function(e){e.exports=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}},e.exports.__esModule=!0,e.exports.default=e.exports},9498:function(e){e.exports=function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)},e.exports.__esModule=!0,e.exports.default=e.exports},8872:function(e){e.exports=function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,a,s=[],u=!0,c=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);u=!0);}catch(l){c=!0,i=l}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw i}}return s}},e.exports.__esModule=!0,e.exports.default=e.exports},2218:function(e){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},2281:function(e){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports.default=e.exports},2122:function(e,t,r){var n=r(8416);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}e.exports=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e},e.exports.__esModule=!0,e.exports.default=e.exports},4993:function(e,t,r){var n=r(8698).default,i=r(6115);e.exports=function(e,t){if(t&&("object"===n(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return i(e)},e.exports.__esModule=!0,e.exports.default=e.exports},7061:function(e,t,r){var n=r(8698).default;function i(){"use strict";e.exports=i=function(){return t},e.exports.__esModule=!0,e.exports.default=e.exports;var t={},r=Object.prototype,o=r.hasOwnProperty,a=Object.defineProperty||function(e,t,r){e[t]=r.value},s="function"==typeof Symbol?Symbol:{},u=s.iterator||"@@iterator",c=s.asyncIterator||"@@asyncIterator",l=s.toStringTag||"@@toStringTag";function h(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{h({},"")}catch(C){h=function(e,t,r){return e[t]=r}}function f(e,t,r,n){var i=t&&t.prototype instanceof m?t:m,o=Object.create(i.prototype),s=new M(n||[]);return a(o,"_invoke",{value:A(e,r,s)}),o}function d(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(C){return{type:"throw",arg:C}}}t.wrap=f;var p={};function m(){}function g(){}function y(){}var v={};h(v,u,(function(){return this}));var _=Object.getPrototypeOf,b=_&&_(_(I([])));b&&b!==r&&o.call(b,u)&&(v=b);var x=y.prototype=m.prototype=Object.create(v);function w(e){["next","throw","return"].forEach((function(t){h(e,t,(function(e){return this._invoke(t,e)}))}))}function k(e,t){function r(i,a,s,u){var c=d(e[i],e,a);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==n(h)&&o.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,s,u)}),(function(e){r("throw",e,s,u)})):t.resolve(h).then((function(e){l.value=e,s(l)}),(function(e){return r("throw",e,s,u)}))}u(c.arg)}var i;a(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,i){r(e,n,t,i)}))}return i=i?i.then(o,o):o()}})}function A(e,t,r){var n="suspendedStart";return function(i,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw o;return P()}for(r.method=i,r.arg=o;;){var a=r.delegate;if(a){var s=E(a,r);if(s){if(s===p)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=d(e,t,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===p)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}function E(e,t){var r=t.method,n=e.iterator[r];if(void 0===n)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,E(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),p;var i=d(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,p;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,p):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,p)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function M(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function I(e){if(e){var t=e[u];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,n=function t(){for(;++r<e.length;)if(o.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return n.next=n}}return{next:P}}function P(){return{value:void 0,done:!0}}return g.prototype=y,a(x,"constructor",{value:y,configurable:!0}),a(y,"constructor",{value:g,configurable:!0}),g.displayName=h(y,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,h(e,l,"GeneratorFunction")),e.prototype=Object.create(x),e},t.awrap=function(e){return{__await:e}},w(k.prototype),h(k.prototype,c,(function(){return this})),t.AsyncIterator=k,t.async=function(e,r,n,i,o){void 0===o&&(o=Promise);var a=new k(f(e,r,n,i),o);return t.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},w(x),h(x,l,"Generator"),h(x,u,(function(){return this})),h(x,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},t.values=I,M.prototype={constructor:M,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(T),!e)for(var t in this)"t"===t.charAt(0)&&o.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(r,n){return a.type="throw",a.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n],a=i.completion;if("root"===i.tryLoc)return r("end");if(i.tryLoc<=this.prev){var s=o.call(i,"catchLoc"),u=o.call(i,"finallyLoc");if(s&&u){if(this.prev<i.catchLoc)return r(i.catchLoc,!0);if(this.prev<i.finallyLoc)return r(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return r(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return r(i.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,p):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),T(r),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;T(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:I(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),p}},t}e.exports=i,e.exports.__esModule=!0,e.exports.default=e.exports},6015:function(e){function t(r,n){return e.exports=t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},e.exports.__esModule=!0,e.exports.default=e.exports,t(r,n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},7424:function(e,t,r){var n=r(5372),i=r(8872),o=r(6116),a=r(2218);e.exports=function(e,t){return n(e)||i(e,t)||o(e,t)||a()},e.exports.__esModule=!0,e.exports.default=e.exports},1753:function(e,t,r){var n=r(3808);e.exports=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=n(e)););return e},e.exports.__esModule=!0,e.exports.default=e.exports},861:function(e,t,r){var n=r(3405),i=r(9498),o=r(6116),a=r(2281);e.exports=function(e){return n(e)||i(e)||o(e)||a()},e.exports.__esModule=!0,e.exports.default=e.exports},5036:function(e,t,r){var n=r(8698).default;e.exports=function(e,t){if("object"!==n(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!==n(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)},e.exports.__esModule=!0,e.exports.default=e.exports},4062:function(e,t,r){var n=r(8698).default,i=r(5036);e.exports=function(e){var t=i(e,"string");return"symbol"===n(t)?t:String(t)},e.exports.__esModule=!0,e.exports.default=e.exports},8698:function(e){function t(r){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},6116:function(e,t,r){var n=r(3897);e.exports=function(e,t){if(e){if("string"===typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}},e.exports.__esModule=!0,e.exports.default=e.exports},8186:function(e,t,r){var n=r(4642);e.exports=function(e){return function(){return new n(e.apply(this,arguments))}},e.exports.__esModule=!0,e.exports.default=e.exports},3496:function(e,t,r){var n=r(3808),i=r(6015),o=r(6035),a=r(3515);function s(t){var r="function"===typeof Map?new Map:void 0;return e.exports=s=function(e){if(null===e||!o(e))return e;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof r){if(r.has(e))return r.get(e);r.set(e,t)}function t(){return a(e,arguments,n(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),i(t,e)},e.exports.__esModule=!0,e.exports.default=e.exports,s(t)}e.exports=s,e.exports.__esModule=!0,e.exports.default=e.exports},4687:function(e,t,r){var n=r(7061)();e.exports=n;try{regeneratorRuntime=n}catch(i){"object"===typeof globalThis?globalThis.regeneratorRuntime=n:Function("r","regeneratorRuntime = r")(n)}},907:function(e,t,r){"use strict";function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}r.d(t,{Z:function(){return n}})},3878:function(e,t,r){"use strict";function n(e){if(Array.isArray(e))return e}r.d(t,{Z:function(){return n}})},7326:function(e,t,r){"use strict";function n(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}r.d(t,{Z:function(){return n}})},5861:function(e,t,r){"use strict";function n(e,t,r,n,i,o,a){try{var s=e[o](a),u=s.value}catch(c){return void r(c)}s.done?t(u):Promise.resolve(u).then(n,i)}function i(e){return function(){var t=this,r=arguments;return new Promise((function(i,o){var a=e.apply(t,r);function s(e){n(a,i,o,s,u,"next",e)}function u(e){n(a,i,o,s,u,"throw",e)}s(void 0)}))}}r.d(t,{Z:function(){return i}})},5671:function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}r.d(t,{Z:function(){return n}})},3144:function(e,t,r){"use strict";r.d(t,{Z:function(){return o}});var n=r(9142);function i(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(0,n.Z)(i.key),i)}}function o(e,t,r){return t&&i(e.prototype,t),r&&i(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}},7762:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var n=r(181);function i(e,t){var r="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=(0,n.Z)(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){u=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(u)throw a}}}}},9388:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});var n=r(1120),i=r(8814),o=r(2963);function a(e){var t=(0,i.Z)();return function(){var r,i=(0,n.Z)(e);if(t){var a=(0,n.Z)(this).constructor;r=Reflect.construct(i,arguments,a)}else r=i.apply(this,arguments);return(0,o.Z)(this,r)}}},4942:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var n=r(9142);function i(e,t,r){return(t=(0,n.Z)(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}},1752:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var n=r(1120);function i(){return i="undefined"!==typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=(0,n.Z)(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},i.apply(this,arguments)}},1120:function(e,t,r){"use strict";function n(e){return n=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},n(e)}r.d(t,{Z:function(){return n}})},136:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var n=r(9611);function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&(0,n.Z)(e,t)}},8814:function(e,t,r){"use strict";function n(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}r.d(t,{Z:function(){return n}})},9199:function(e,t,r){"use strict";function n(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}r.d(t,{Z:function(){return n}})},5267:function(e,t,r){"use strict";function n(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}r.d(t,{Z:function(){return n}})},1413:function(e,t,r){"use strict";r.d(t,{Z:function(){return o}});var n=r(4942);function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}},4925:function(e,t,r){"use strict";function n(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}r.d(t,{Z:function(){return n}})},2963:function(e,t,r){"use strict";r.d(t,{Z:function(){return o}});var n=r(1002),i=r(7326);function o(e,t){if(t&&("object"===(0,n.Z)(t)||"function"===typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return(0,i.Z)(e)}},4165:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var n=r(1002);function i(){i=function(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",c=a.toStringTag||"@@toStringTag";function l(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(P){l=function(e,t,r){return e[t]=r}}function h(e,t,r,n){var i=t&&t.prototype instanceof p?t:p,a=Object.create(i.prototype),s=new T(n||[]);return o(a,"_invoke",{value:k(e,r,s)}),a}function f(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(P){return{type:"throw",arg:P}}}e.wrap=h;var d={};function p(){}function m(){}function g(){}var y={};l(y,s,(function(){return this}));var v=Object.getPrototypeOf,_=v&&v(v(M([])));_&&_!==t&&r.call(_,s)&&(y=_);var b=g.prototype=p.prototype=Object.create(y);function x(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function w(e,t){function i(o,a,s,u){var c=f(e[o],e,a);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==(0,n.Z)(h)&&r.call(h,"__await")?t.resolve(h.__await).then((function(e){i("next",e,s,u)}),(function(e){i("throw",e,s,u)})):t.resolve(h).then((function(e){l.value=e,s(l)}),(function(e){return i("throw",e,s,u)}))}u(c.arg)}var a;o(this,"_invoke",{value:function(e,r){function n(){return new t((function(t,n){i(e,r,t,n)}))}return a=a?a.then(n,n):n()}})}function k(e,t,r){var n="suspendedStart";return function(i,o){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===i)throw o;return I()}for(r.method=i,r.arg=o;;){var a=r.delegate;if(a){var s=A(a,r);if(s){if(s===d)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=f(e,t,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===d)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}function A(e,t){var r=t.method,n=e.iterator[r];if(void 0===n)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,A(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),d;var i=f(n,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,d;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function S(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function M(e){if(e){var t=e[s];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(r.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:I}}function I(){return{value:void 0,done:!0}}return m.prototype=g,o(b,"constructor",{value:g,configurable:!0}),o(g,"constructor",{value:m,configurable:!0}),m.displayName=l(g,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,l(e,c,"GeneratorFunction")),e.prototype=Object.create(b),e},e.awrap=function(e){return{__await:e}},x(w.prototype),l(w.prototype,u,(function(){return this})),e.AsyncIterator=w,e.async=function(t,r,n,i,o){void 0===o&&(o=Promise);var a=new w(h(t,r,n,i),o);return e.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},x(b),l(b,c,"Generator"),l(b,s,(function(){return this})),l(b,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),r=[];for(var n in t)r.push(n);return r.reverse(),function e(){for(;r.length;){var n=r.pop();if(n in t)return e.value=n,e.done=!1,e}return e.done=!0,e}},e.values=M,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(S),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(r,n){return a.type="throw",a.arg=e,t.next=r,n&&(t.method="next",t.arg=void 0),!!n}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return n("end");if(o.tryLoc<=this.prev){var s=r.call(o,"catchLoc"),u=r.call(o,"finallyLoc");if(s&&u){if(this.prev<o.catchLoc)return n(o.catchLoc,!0);if(this.prev<o.finallyLoc)return n(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return n(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return n(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,d):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),S(r),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var i=n.arg;S(r)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:M(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),d}},e}},9611:function(e,t,r){"use strict";function n(e,t){return n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},n(e,t)}r.d(t,{Z:function(){return n}})},9439:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});var n=r(3878);var i=r(181),o=r(5267);function a(e,t){return(0,n.Z)(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,a,s=[],u=!0,c=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);u=!0);}catch(l){c=!0,i=l}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(c)throw i}}return s}}(e,t)||(0,i.Z)(e,t)||(0,o.Z)()}},3433:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});var n=r(907);var i=r(9199),o=r(181);function a(e){return function(e){if(Array.isArray(e))return(0,n.Z)(e)}(e)||(0,i.Z)(e)||(0,o.Z)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},9142:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var n=r(1002);function i(e){var t=function(e,t){if("object"!==(0,n.Z)(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!==(0,n.Z)(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===(0,n.Z)(t)?t:String(t)}},1002:function(e,t,r){"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}r.d(t,{Z:function(){return n}})},181:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var n=r(907);function i(e,t){if(e){if("string"===typeof e)return(0,n.Z)(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?(0,n.Z)(e,t):void 0}}},8737:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});var n=r(1120),i=r(9611);var o=r(8814);function a(e,t,r){return a=(0,o.Z)()?Reflect.construct.bind():function(e,t,r){var n=[null];n.push.apply(n,t);var o=new(Function.bind.apply(e,n));return r&&(0,i.Z)(o,r.prototype),o},a.apply(null,arguments)}function s(e){var t="function"===typeof Map?new Map:void 0;return s=function(e){if(null===e||(r=e,-1===Function.toString.call(r).indexOf("[native code]")))return e;var r;if("function"!==typeof e)throw new TypeError("Super expression must either be null or a function");if("undefined"!==typeof t){if(t.has(e))return t.get(e);t.set(e,o)}function o(){return a(e,arguments,(0,n.Z)(this).constructor)}return o.prototype=Object.create(e.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),(0,i.Z)(o,e)},s(e)}},9344:function(e,t,r){"use strict";function n(e,t,r){return t<=e&&e<=r}function i(e){if(void 0===e)return{};if(e===Object(e))return e;throw TypeError("Could not convert argument to dictionary")}r.r(t),r.d(t,{TextDecoder:function(){return l},TextEncoder:function(){return h}});var o=-1;function a(e){this.tokens=[].slice.call(e)}a.prototype={endOfStream:function(){return!this.tokens.length},read:function(){return this.tokens.length?this.tokens.shift():o},prepend:function(e){if(Array.isArray(e))for(var t=e;t.length;)this.tokens.unshift(t.pop());else this.tokens.unshift(e)},push:function(e){if(Array.isArray(e))for(var t=e;t.length;)this.tokens.push(t.shift());else this.tokens.push(e)}};var s=-1;function u(e,t){if(e)throw TypeError("Decoder error");return t||65533}var c="utf-8";function l(e,t){if(!(this instanceof l))return new l(e,t);if((e=void 0!==e?String(e).toLowerCase():c)!==c)throw new Error("Encoding not supported. Only utf-8 is supported");t=i(t),this._streaming=!1,this._BOMseen=!1,this._decoder=null,this._fatal=Boolean(t.fatal),this._ignoreBOM=Boolean(t.ignoreBOM),Object.defineProperty(this,"encoding",{value:"utf-8"}),Object.defineProperty(this,"fatal",{value:this._fatal}),Object.defineProperty(this,"ignoreBOM",{value:this._ignoreBOM})}function h(e,t){if(!(this instanceof h))return new h(e,t);if((e=void 0!==e?String(e).toLowerCase():c)!==c)throw new Error("Encoding not supported. Only utf-8 is supported");t=i(t),this._streaming=!1,this._encoder=null,this._options={fatal:Boolean(t.fatal)},Object.defineProperty(this,"encoding",{value:"utf-8"})}function f(e){var t=e.fatal,r=0,i=0,a=0,c=128,l=191;this.handler=function(e,h){if(h===o&&0!==a)return a=0,u(t);if(h===o)return s;if(0===a){if(n(h,0,127))return h;if(n(h,194,223))a=1,r=h-192;else if(n(h,224,239))224===h&&(c=160),237===h&&(l=159),a=2,r=h-224;else{if(!n(h,240,244))return u(t);240===h&&(c=144),244===h&&(l=143),a=3,r=h-240}return r<<=6*a,null}if(!n(h,c,l))return r=a=i=0,c=128,l=191,e.prepend(h),u(t);if(c=128,l=191,r+=h-128<<6*(a-(i+=1)),i!==a)return null;var f=r;return r=a=i=0,f}}function d(e){e.fatal;this.handler=function(e,t){if(t===o)return s;if(n(t,0,127))return t;var r,i;n(t,128,2047)?(r=1,i=192):n(t,2048,65535)?(r=2,i=224):n(t,65536,1114111)&&(r=3,i=240);for(var a=[(t>>6*r)+i];r>0;){var u=t>>6*(r-1);a.push(128|63&u),r-=1}return a}}l.prototype={decode:function(e,t){var r;r="object"===typeof e&&e instanceof ArrayBuffer?new Uint8Array(e):"object"===typeof e&&"buffer"in e&&e.buffer instanceof ArrayBuffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(0),t=i(t),this._streaming||(this._decoder=new f({fatal:this._fatal}),this._BOMseen=!1),this._streaming=Boolean(t.stream);for(var n,o=new a(r),u=[];!o.endOfStream()&&(n=this._decoder.handler(o,o.read()))!==s;)null!==n&&(Array.isArray(n)?u.push.apply(u,n):u.push(n));if(!this._streaming){do{if((n=this._decoder.handler(o,o.read()))===s)break;null!==n&&(Array.isArray(n)?u.push.apply(u,n):u.push(n))}while(!o.endOfStream());this._decoder=null}return u.length&&(-1===["utf-8"].indexOf(this.encoding)||this._ignoreBOM||this._BOMseen||(65279===u[0]?(this._BOMseen=!0,u.shift()):this._BOMseen=!0)),function(e){for(var t="",r=0;r<e.length;++r){var n=e[r];n<=65535?t+=String.fromCharCode(n):(n-=65536,t+=String.fromCharCode(55296+(n>>10),56320+(1023&n)))}return t}(u)}},h.prototype={encode:function(e,t){e=e?String(e):"",t=i(t),this._streaming||(this._encoder=new d(this._options)),this._streaming=Boolean(t.stream);for(var r,n=[],o=new a(function(e){for(var t=String(e),r=t.length,n=0,i=[];n<r;){var o=t.charCodeAt(n);if(o<55296||o>57343)i.push(o);else if(56320<=o&&o<=57343)i.push(65533);else if(55296<=o&&o<=56319)if(n===r-1)i.push(65533);else{var a=e.charCodeAt(n+1);if(56320<=a&&a<=57343){var s=1023&o,u=1023&a;i.push(65536+(s<<10)+u),n+=1}else i.push(65533)}n+=1}return i}(e));!o.endOfStream()&&(r=this._encoder.handler(o,o.read()))!==s;)Array.isArray(r)?n.push.apply(n,r):n.push(r);if(!this._streaming){for(;(r=this._encoder.handler(o,o.read()))!==s;)Array.isArray(r)?n.push.apply(n,r):n.push(r);this._encoder=null}return new Uint8Array(n)}}}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var o=t[n]={id:n,loaded:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.loaded=!0,o.exports}r.m=e,r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,{a:t}),t},function(){var e,t=Object.getPrototypeOf?function(e){return Object.getPrototypeOf(e)}:function(e){return e.__proto__};r.t=function(n,i){if(1&i&&(n=this(n)),8&i)return n;if("object"===typeof n&&n){if(4&i&&n.__esModule)return n;if(16&i&&"function"===typeof n.then)return n}var o=Object.create(null);r.r(o);var a={};e=e||[null,t({}),t([]),t(t)];for(var s=2&i&&n;"object"==typeof s&&!~e.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach((function(e){a[e]=function(){return n[e]}}));return a.default=function(){return n},r.d(o,a),o}}(),r.d=function(e,t){for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.f={},r.e=function(e){return Promise.all(Object.keys(r.f).reduce((function(t,n){return r.f[n](e,t),t}),[]))},r.u=function(e){return"static/js/"+e+"."+{59:"ef2245e9",126:"6d4f5dc9",483:"ebf99054",608:"10938815",724:"f8d926fb",997:"abc30035"}[e]+".chunk.js"},r.miniCssF=function(e){},r.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e={},t="ohr-frontend:";r.l=function(n,i,o,a){if(e[n])e[n].push(i);else{var s,u;if(void 0!==o)for(var c=document.getElementsByTagName("script"),l=0;l<c.length;l++){var h=c[l];if(h.getAttribute("src")==n||h.getAttribute("data-webpack")==t+o){s=h;break}}s||(u=!0,(s=document.createElement("script")).charset="utf-8",s.timeout=120,r.nc&&s.setAttribute("nonce",r.nc),s.setAttribute("data-webpack",t+o),s.src=n),e[n]=[i];var f=function(t,r){s.onerror=s.onload=null,clearTimeout(d);var i=e[n];if(delete e[n],s.parentNode&&s.parentNode.removeChild(s),i&&i.forEach((function(e){return e(r)})),t)return t(r)},d=setTimeout(f.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=f.bind(null,s.onerror),s.onload=f.bind(null,s.onload),u&&document.head.appendChild(s)}}}(),r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},r.p="/ohr/",function(){var e={179:0};r.f.j=function(t,n){var i=r.o(e,t)?e[t]:void 0;if(0!==i)if(i)n.push(i[2]);else{var o=new Promise((function(r,n){i=e[t]=[r,n]}));n.push(i[2]=o);var a=r.p+r.u(t),s=new Error;r.l(a,(function(n){if(r.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var o=n&&("load"===n.type?"missing":n.type),a=n&&n.target&&n.target.src;s.message="Loading chunk "+t+" failed.\n("+o+": "+a+")",s.name="ChunkLoadError",s.type=o,s.request=a,i[1](s)}}),"chunk-"+t,t)}};var t=function(t,n){var i,o,a=n[0],s=n[1],u=n[2],c=0;if(a.some((function(t){return 0!==e[t]}))){for(i in s)r.o(s,i)&&(r.m[i]=s[i]);if(u)u(r)}for(t&&t(n);c<a.length;c++)o=a[c],r.o(e,o)&&e[o]&&e[o][0](),e[o]=0},n=self.webpackChunkohr_frontend=self.webpackChunkohr_frontend||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}(),function(){"use strict";var e,t=r(2791),n=r(1250),i=r(9439),o=r(6322);!function(e){e.Mainnet="mainnet-beta",e.Testnet="testnet",e.Devnet="devnet"}(e||(e={}));var a,s=r(3433),u=r(4925),c=r(4165),l=r(5861),h=r(5671),f=r(3144),d=r(136),p=r(9388),m=r(7762),g=r(7143),y=r(8737),v=function(e){(0,d.Z)(r,e);var t=(0,p.Z)(r);function r(e,n){var i;return(0,h.Z)(this,r),(i=t.call(this,e)).error=n,i}return(0,f.Z)(r)}((0,y.Z)(Error)),_=function(e){(0,d.Z)(r,e);var t=(0,p.Z)(r);function r(){var e;return(0,h.Z)(this,r),(e=t.apply(this,arguments)).name="WalletNotReadyError",e}return(0,f.Z)(r)}(v),b=function(e){(0,d.Z)(r,e);var t=(0,p.Z)(r);function r(){var e;return(0,h.Z)(this,r),(e=t.apply(this,arguments)).name="WalletLoadError",e}return(0,f.Z)(r)}(v),x=function(e){(0,d.Z)(r,e);var t=(0,p.Z)(r);function r(){var e;return(0,h.Z)(this,r),(e=t.apply(this,arguments)).name="WalletConfigError",e}return(0,f.Z)(r)}(v),w=function(e){(0,d.Z)(r,e);var t=(0,p.Z)(r);function r(){var e;return(0,h.Z)(this,r),(e=t.apply(this,arguments)).name="WalletConnectionError",e}return(0,f.Z)(r)}(v),k=function(e){(0,d.Z)(r,e);var t=(0,p.Z)(r);function r(){var e;return(0,h.Z)(this,r),(e=t.apply(this,arguments)).name="WalletDisconnectedError",e}return(0,f.Z)(r)}(v),A=function(e){(0,d.Z)(r,e);var t=(0,p.Z)(r);function r(){var e;return(0,h.Z)(this,r),(e=t.apply(this,arguments)).name="WalletDisconnectionError",e}return(0,f.Z)(r)}(v),E=function(e){(0,d.Z)(r,e);var t=(0,p.Z)(r);function r(){var e;return(0,h.Z)(this,r),(e=t.apply(this,arguments)).name="WalletAccountError",e}return(0,f.Z)(r)}(v),S=function(e){(0,d.Z)(r,e);var t=(0,p.Z)(r);function r(){var e;return(0,h.Z)(this,r),(e=t.apply(this,arguments)).name="WalletPublicKeyError",e}return(0,f.Z)(r)}(v),T=function(e){(0,d.Z)(r,e);var t=(0,p.Z)(r);function r(){var e;return(0,h.Z)(this,r),(e=t.apply(this,arguments)).name="WalletNotConnectedError",e}return(0,f.Z)(r)}(v),M=function(e){(0,d.Z)(r,e);var t=(0,p.Z)(r);function r(){var e;return(0,h.Z)(this,r),(e=t.apply(this,arguments)).name="WalletSendTransactionError",e}return(0,f.Z)(r)}(v),I=function(e){(0,d.Z)(r,e);var t=(0,p.Z)(r);function r(){var e;return(0,h.Z)(this,r),(e=t.apply(this,arguments)).name="WalletSignMessageError",e}return(0,f.Z)(r)}(v),P=function(e){(0,d.Z)(r,e);var t=(0,p.Z)(r);function r(){var e;return(0,h.Z)(this,r),(e=t.apply(this,arguments)).name="WalletSignTransactionError",e}return(0,f.Z)(r)}(v),C=function(e){(0,d.Z)(r,e);var t=(0,p.Z)(r);function r(){var e;return(0,h.Z)(this,r),(e=t.apply(this,arguments)).name="WalletTimeoutError",e}return(0,f.Z)(r)}(v),B=function(e){(0,d.Z)(r,e);var t=(0,p.Z)(r);function r(){var e;return(0,h.Z)(this,r),(e=t.apply(this,arguments)).name="WalletWindowBlockedError",e}return(0,f.Z)(r)}(v),D=function(e){(0,d.Z)(r,e);var t=(0,p.Z)(r);function r(){var e;return(0,h.Z)(this,r),(e=t.apply(this,arguments)).name="WalletWindowClosedError",e}return(0,f.Z)(r)}(v);!function(e){e.Installed="Installed",e.NotDetected="NotDetected",e.Loadable="Loadable",e.Unsupported="Unsupported"}(a||(a={}));var R=function(e){(0,d.Z)(r,e);var t=(0,p.Z)(r);function r(){return(0,h.Z)(this,r),t.apply(this,arguments)}return(0,f.Z)(r,[{key:"connected",get:function(){return!!this.publicKey}},{key:"autoConnect",value:function(){var e=(0,l.Z)((0,c.Z)().mark((function e(){return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.connect();case 2:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"prepareTransaction",value:function(){var e=(0,l.Z)((0,c.Z)().mark((function e(t,r){var n,i,o=arguments;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=o.length>2&&void 0!==o[2]?o[2]:{},i=this.publicKey){e.next=4;break}throw new T;case 4:if(t.feePayer=t.feePayer||i,e.t0=t.recentBlockhash,e.t0){e.next=10;break}return e.next=9,r.getLatestBlockhash({commitment:n.preflightCommitment,minContextSlot:n.minContextSlot});case 9:e.t0=e.sent.blockhash;case 10:return t.recentBlockhash=e.t0,e.abrupt("return",t);case 12:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()}]),r}(g);function L(e){if("undefined"!==typeof window&&"undefined"!==typeof document){var t=[],r=setInterval(n,1e3);t.push((function(){return clearInterval(r)})),"loading"===document.readyState&&(document.addEventListener("DOMContentLoaded",n,{once:!0}),t.push((function(){return document.removeEventListener("DOMContentLoaded",n)}))),"complete"!==document.readyState&&(window.addEventListener("load",n,{once:!0}),t.push((function(){return window.removeEventListener("load",n)}))),n()}function n(){if(e()){var r,n=(0,m.Z)(t);try{for(n.s();!(r=n.n()).done;){(0,r.value)()}}catch(i){n.e(i)}finally{n.f()}}}}function O(){if(!navigator)return!1;var e=navigator.userAgent.toLowerCase(),t=e.includes("iphone")||e.includes("ipad"),r=e.includes("safari");return t&&r}function z(e){return"version"in e}var N=["signers"],U=function(e){(0,d.Z)(r,e);var t=(0,p.Z)(r);function r(){return(0,h.Z)(this,r),t.apply(this,arguments)}return(0,f.Z)(r,[{key:"sendTransaction",value:function(){var e=(0,l.Z)((0,c.Z)().mark((function e(t,r){var n,i,o,a,l,h,f,d=arguments;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=d.length>2&&void 0!==d[2]?d[2]:{},i=!0,e.prev=2,!z(t)){e.next=26;break}if(this.supportedTransactionVersions){e.next=6;break}throw new M("Sending versioned transactions isn't supported by this wallet");case 6:if(this.supportedTransactionVersions.has(t.version)){e.next=8;break}throw new M("Sending transaction version ".concat(t.version," isn't supported by this wallet"));case 8:return e.prev=8,e.next=11,this.signTransaction(t);case 11:return t=e.sent,o=t.serialize(),e.next=15,r.sendRawTransaction(o,n);case 15:case 38:return e.abrupt("return",e.sent);case 18:if(e.prev=18,e.t0=e.catch(8),!(e.t0 instanceof P)){e.next=23;break}throw i=!1,e.t0;case 23:throw new M(null===e.t0||void 0===e.t0?void 0:e.t0.message,e.t0);case 24:e.next=47;break;case 26:return e.prev=26,l=n.signers,h=(0,u.Z)(n,N),e.next=30,this.prepareTransaction(t,r,h);case 30:return t=e.sent,(null===l||void 0===l?void 0:l.length)&&(a=t).partialSign.apply(a,(0,s.Z)(l)),e.next=34,this.signTransaction(t);case 34:return t=e.sent,f=t.serialize(),e.next=38,r.sendRawTransaction(f,h);case 41:if(e.prev=41,e.t1=e.catch(26),!(e.t1 instanceof P)){e.next=46;break}throw i=!1,e.t1;case 46:throw new M(null===e.t1||void 0===e.t1?void 0:e.t1.message,e.t1);case 47:e.next=53;break;case 49:throw e.prev=49,e.t2=e.catch(2),i&&this.emit("error",e.t2),e.t2;case 53:case"end":return e.stop()}}),e,this,[[2,49],[8,18],[26,41]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"signAllTransactions",value:function(){var e=(0,l.Z)((0,c.Z)().mark((function e(t){var r,n,i,o,a,s,u;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=(0,m.Z)(t),e.prev=1,r.s();case 3:if((n=r.n()).done){e.next=12;break}if(!z(i=n.value)){e.next=10;break}if(this.supportedTransactionVersions){e.next=8;break}throw new P("Signing versioned transactions isn't supported by this wallet");case 8:if(this.supportedTransactionVersions.has(i.version)){e.next=10;break}throw new P("Signing transaction version ".concat(i.version," isn't supported by this wallet"));case 10:e.next=3;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(1),r.e(e.t0);case 17:return e.prev=17,r.f(),e.finish(17);case 20:o=[],a=(0,m.Z)(t),e.prev=22,a.s();case 24:if((s=a.n()).done){e.next=33;break}return u=s.value,e.t1=o,e.next=29,this.signTransaction(u);case 29:e.t2=e.sent,e.t1.push.call(e.t1,e.t2);case 31:e.next=24;break;case 33:e.next=38;break;case 35:e.prev=35,e.t3=e.catch(22),a.e(e.t3);case 38:return e.prev=38,a.f(),e.finish(38);case 41:return e.abrupt("return",o);case 42:case"end":return e.stop()}}),e,this,[[1,14,17,20],[22,35,38,41]])})));return function(t){return e.apply(this,arguments)}}()}]),r}(R),Z=function(e){(0,d.Z)(r,e);var t=(0,p.Z)(r);function r(){return(0,h.Z)(this,r),t.apply(this,arguments)}return(0,f.Z)(r)}(U),F=["signers"],j=function(e){(0,d.Z)(r,e);var t=(0,p.Z)(r);function r(){var e;return(0,h.Z)(this,r),(e=t.call(this)).name="Phantom",e.url="https://phantom.app",e.icon="data:image/svg+xml;base64,PHN2ZyBmaWxsPSJub25lIiBoZWlnaHQ9IjM0IiB3aWR0aD0iMzQiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGxpbmVhckdyYWRpZW50IGlkPSJhIiB4MT0iLjUiIHgyPSIuNSIgeTE9IjAiIHkyPSIxIj48c3RvcCBvZmZzZXQ9IjAiIHN0b3AtY29sb3I9IiM1MzRiYjEiLz48c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiM1NTFiZjkiLz48L2xpbmVhckdyYWRpZW50PjxsaW5lYXJHcmFkaWVudCBpZD0iYiIgeDE9Ii41IiB4Mj0iLjUiIHkxPSIwIiB5Mj0iMSI+PHN0b3Agb2Zmc2V0PSIwIiBzdG9wLWNvbG9yPSIjZmZmIi8+PHN0b3Agb2Zmc2V0PSIxIiBzdG9wLWNvbG9yPSIjZmZmIiBzdG9wLW9wYWNpdHk9Ii44MiIvPjwvbGluZWFyR3JhZGllbnQ+PGNpcmNsZSBjeD0iMTciIGN5PSIxNyIgZmlsbD0idXJsKCNhKSIgcj0iMTciLz48cGF0aCBkPSJtMjkuMTcwMiAxNy4yMDcxaC0yLjk5NjljMC02LjEwNzQtNC45NjgzLTExLjA1ODE3LTExLjA5NzUtMTEuMDU4MTctNi4wNTMyNSAwLTEwLjk3NDYzIDQuODI5NTctMTEuMDk1MDggMTAuODMyMzctLjEyNDYxIDYuMjA1IDUuNzE3NTIgMTEuNTkzMiAxMS45NDUzOCAxMS41OTMyaC43ODM0YzUuNDkwNiAwIDEyLjg0OTctNC4yODI5IDEzLjk5OTUtOS41MDEzLjIxMjMtLjk2MTktLjU1MDItMS44NjYxLTEuNTM4OC0xLjg2NjF6bS0xOC41NDc5LjI3MjFjMCAuODE2Ny0uNjcwMzggMS40ODQ3LTEuNDkwMDEgMS40ODQ3LS44MTk2NCAwLTEuNDg5OTgtLjY2ODMtMS40ODk5OC0xLjQ4NDd2LTIuNDAxOWMwLS44MTY3LjY3MDM0LTEuNDg0NyAxLjQ4OTk4LTEuNDg0Ny44MTk2MyAwIDEuNDkwMDEuNjY4IDEuNDkwMDEgMS40ODQ3em01LjE3MzggMGMwIC44MTY3LS42NzAzIDEuNDg0Ny0xLjQ4OTkgMS40ODQ3LS44MTk3IDAtMS40OS0uNjY4My0xLjQ5LTEuNDg0N3YtMi40MDE5YzAtLjgxNjcuNjcwNi0xLjQ4NDcgMS40OS0xLjQ4NDcuODE5NiAwIDEuNDg5OS42NjggMS40ODk5IDEuNDg0N3oiIGZpbGw9InVybCgjYikiLz48L3N2Zz4K",e.supportedTransactionVersions=new Set(["legacy",0]),e._readyState="undefined"===typeof window||"undefined"===typeof document?a.Unsupported:a.NotDetected,e._disconnected=function(){var t=e._wallet;t&&(t.off("disconnect",e._disconnected),t.off("accountChanged",e._accountChanged),e._wallet=null,e._publicKey=null,e.emit("error",new k),e.emit("disconnect"))},e._accountChanged=function(t){var r=e._publicKey;if(r){try{t=new o.PublicKey(t.toBytes())}catch(n){return void e.emit("error",new S(null===n||void 0===n?void 0:n.message,n))}r.equals(t)||(e._publicKey=t,e.emit("connect",t))}},e._connecting=!1,e._wallet=null,e._publicKey=null,e._readyState!==a.Unsupported&&(O()?(e._readyState=a.Loadable,e.emit("readyStateChange",e._readyState)):L((function(){var t,r,n;return!!(null!==(t=window.phantom)&&void 0!==t&&null!==(r=t.solana)&&void 0!==r&&r.isPhantom||null!==(n=window.solana)&&void 0!==n&&n.isPhantom)&&(e._readyState=a.Installed,e.emit("readyStateChange",e._readyState),!0)}))),e}return(0,f.Z)(r,[{key:"publicKey",get:function(){return this._publicKey}},{key:"connecting",get:function(){return this._connecting}},{key:"readyState",get:function(){return this._readyState}},{key:"autoConnect",value:function(){var e=(0,l.Z)((0,c.Z)().mark((function e(){return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.readyState!==a.Installed){e.next=3;break}return e.next=3,this.connect();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"connect",value:function(){var e=(0,l.Z)((0,c.Z)().mark((function e(){var t,r,n,i,s;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!this.connected&&!this.connecting){e.next=3;break}return e.abrupt("return");case 3:if(this.readyState!==a.Loadable){e.next=8;break}return r=encodeURIComponent(window.location.href),n=encodeURIComponent(window.location.origin),window.location.href="https://phantom.app/ul/browse/".concat(r,"?ref=").concat(n),e.abrupt("return");case 8:if(this.readyState===a.Installed){e.next=10;break}throw new _;case 10:if(this._connecting=!0,(i=(null===(t=window.phantom)||void 0===t?void 0:t.solana)||window.solana).isConnected){e.next=21;break}return e.prev=13,e.next=16,i.connect();case 16:e.next=21;break;case 18:throw e.prev=18,e.t0=e.catch(13),new w(null===e.t0||void 0===e.t0?void 0:e.t0.message,e.t0);case 21:if(i.publicKey){e.next=23;break}throw new E;case 23:e.prev=23,s=new o.PublicKey(i.publicKey.toBytes()),e.next=30;break;case 27:throw e.prev=27,e.t1=e.catch(23),new S(null===e.t1||void 0===e.t1?void 0:e.t1.message,e.t1);case 30:i.on("disconnect",this._disconnected),i.on("accountChanged",this._accountChanged),this._wallet=i,this._publicKey=s,this.emit("connect",s),e.next=41;break;case 37:throw e.prev=37,e.t2=e.catch(0),this.emit("error",e.t2),e.t2;case 41:return e.prev=41,this._connecting=!1,e.finish(41);case 44:case"end":return e.stop()}}),e,this,[[0,37,41,44],[13,18],[23,27]])})));return function(){return e.apply(this,arguments)}}()},{key:"disconnect",value:function(){var e=(0,l.Z)((0,c.Z)().mark((function e(){var t;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this._wallet)){e.next=14;break}return t.off("disconnect",this._disconnected),t.off("accountChanged",this._accountChanged),this._wallet=null,this._publicKey=null,e.prev=6,e.next=9,t.disconnect();case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(6),this.emit("error",new A(null===e.t0||void 0===e.t0?void 0:e.t0.message,e.t0));case 14:this.emit("disconnect");case 15:case"end":return e.stop()}}),e,this,[[6,11]])})));return function(){return e.apply(this,arguments)}}()},{key:"sendTransaction",value:function(){var e=(0,l.Z)((0,c.Z)().mark((function e(t,r){var n,i,o,a,l,h,f,d=arguments;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=d.length>2&&void 0!==d[2]?d[2]:{},e.prev=1,i=this._wallet){e.next=5;break}throw new T;case 5:if(e.prev=5,o=n.signers,a=(0,u.Z)(n,F),!z(t)){e.next=11;break}(null===o||void 0===o?void 0:o.length)&&t.sign(o),e.next=15;break;case 11:return e.next=13,this.prepareTransaction(t,r,a);case 13:t=e.sent,(null===o||void 0===o?void 0:o.length)&&(l=t).partialSign.apply(l,(0,s.Z)(o));case 15:return a.preflightCommitment=a.preflightCommitment||r.commitment,e.next=18,i.signAndSendTransaction(t,a);case 18:return h=e.sent,f=h.signature,e.abrupt("return",f);case 23:if(e.prev=23,e.t0=e.catch(5),!(e.t0 instanceof v)){e.next=27;break}throw e.t0;case 27:throw new M(null===e.t0||void 0===e.t0?void 0:e.t0.message,e.t0);case 28:e.next=34;break;case 30:throw e.prev=30,e.t1=e.catch(1),this.emit("error",e.t1),e.t1;case 34:case"end":return e.stop()}}),e,this,[[1,30],[5,23]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"signTransaction",value:function(){var e=(0,l.Z)((0,c.Z)().mark((function e(t){var r;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r=this._wallet){e.next=4;break}throw new T;case 4:return e.prev=4,e.next=7,r.signTransaction(t);case 7:if(e.t0=e.sent,e.t0){e.next=10;break}e.t0=t;case 10:return e.abrupt("return",e.t0);case 13:throw e.prev=13,e.t1=e.catch(4),new P(null===e.t1||void 0===e.t1?void 0:e.t1.message,e.t1);case 16:e.next=22;break;case 18:throw e.prev=18,e.t2=e.catch(0),this.emit("error",e.t2),e.t2;case 22:case"end":return e.stop()}}),e,this,[[0,18],[4,13]])})));return function(t){return e.apply(this,arguments)}}()},{key:"signAllTransactions",value:function(){var e=(0,l.Z)((0,c.Z)().mark((function e(t){var r;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r=this._wallet){e.next=4;break}throw new T;case 4:return e.prev=4,e.next=7,r.signAllTransactions(t);case 7:if(e.t0=e.sent,e.t0){e.next=10;break}e.t0=t;case 10:return e.abrupt("return",e.t0);case 13:throw e.prev=13,e.t1=e.catch(4),new P(null===e.t1||void 0===e.t1?void 0:e.t1.message,e.t1);case 16:e.next=22;break;case 18:throw e.prev=18,e.t2=e.catch(0),this.emit("error",e.t2),e.t2;case 22:case"end":return e.stop()}}),e,this,[[0,18],[4,13]])})));return function(t){return e.apply(this,arguments)}}()},{key:"signMessage",value:function(){var e=(0,l.Z)((0,c.Z)().mark((function e(t){var r,n,i;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r=this._wallet){e.next=4;break}throw new T;case 4:return e.prev=4,e.next=7,r.signMessage(t);case 7:return n=e.sent,i=n.signature,e.abrupt("return",i);case 12:throw e.prev=12,e.t0=e.catch(4),new I(null===e.t0||void 0===e.t0?void 0:e.t0.message,e.t0);case 15:e.next=21;break;case 17:throw e.prev=17,e.t1=e.catch(0),this.emit("error",e.t1),e.t1;case 21:case"end":return e.stop()}}),e,this,[[0,17],[4,12]])})));return function(t){return e.apply(this,arguments)}}()}]),r}(Z),V=r(1413),W=["signers"],K=function(e){(0,d.Z)(r,e);var t=(0,p.Z)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if((0,h.Z)(this,r),(e=t.call(this)).name="Glow",e.url="https://glow.app",e.icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAMAAABrrFhUAAAB4FBMVEUAAACjON6dNNyjONd7C+GIHNq1S+K9W+O3TeLAVOe6TuSJHtqcMdPBVeiuQt2kOdeRJc7AVeeyRd95COR9DeF7CuKWKtCaL9KoPdr78/789/7//f+zPt7u0Pi7ROG5SuK9TOT67/315PzVYfHAT+bx1Pry4PuiMNWmMdaqN9moM9fv2vqvOdvtzff15/ysN9mxO9yzRN/13/ysPdz46Py/SeTFVemPE+/EUOe5QeC3P+DJW+y9SOOfLtPZYvT46/2TGOu2R+GNEPKaI9/PXO7t1fjbZfWgLNfu0/jIV+rQX++ZKdCQIdSWIOGmN9iYJNvCVOjRVe/CTOaKE+eZKNSgKd2TIdnLV+yECfGfKdqKEO2dJ9ylL9iNHdr02/uHC/KjLdp+BfCcKdbKU+t7B+eUJs+dLNKTHeG+ROXUW/GLGeCFFd6PHN+JDfOuQd3JS+vNWu2EEeGOF+WiNtbOUe2BDOf02fuSGuWOFOuUJdPWXfGFDuvMT+yVHOWIF9vCSOiZJteACeyLHNV9C+N4A+x1A+mGGOPHUOmKHN2aLtKFEOWXHubarPLXju7CfevoxvffuPXQmu7QfuvnvfXJje3dnPHBauTOcOu4bfDjp/SqUOytStugNu6yXd6bKueVNOUmkAxzAAAAGXRSTlMAIxB+3D9C/WLfo2CcxcXf34TffL6cvc/vU7i1KQAAOkJJREFUeNrElMFuqlAQhivICpLehFofgb6ET1CjCwk7drZNwA0SFqYJ8Upq1Ke+/wwz9hwurtT2m5lT0933z+jDLRgMPN/3w3AEnoihkAt1l10PU3SHN+aP8EwEQeC6ru973sB5+GWgHY4gW5jk1LlNjSFruy13FLEz5KGP/p9X5Xg8jp8D1/cGDz+N44WjYd6cKRorAozBDgHUaIX1YV13lo8WdS5OgKfrrxwFDsL1fuogHH80bHrcG/MEUAbqv6PC37ROU3v/zI7mjYb/ofZd/TfUUeyVyQQ9Du5/C174tGxsEEFViX7znYEF++/0AlJF/MmbS+Dtb2C7QZmQvHA2R5uM3Ttm4ITDJWg6EVTwRwsNHwBaqQ0QgrpTEa28wQat9Bx/+5q77/Lo3ycD72nJWOpsL/4NTV4Q3evP2krrQ4rz7zCdog3gzxFg/Wg27/nqvxvyR5qyLCPUJIomUeDdT395tucAyL8p+EEAyt5MwOBwsN0TLmRgAn3lLG4e/yvswdmerctyIoUUwNi/i76eAA3Loxu8NKeWYr/fFwu8pyzPEUSW11mW1TX1IevY69/pFC36SSL2cbyJ2RyNR3kXe4H0eaShj8H7eLsrGOj2vxo8/AlTVeTN6ixPb1GcsgL6GUWAb0IGyJ8TYFbpCtghYEg9QYM2gVh4pbHtgS4fq9fF4wi6BIMb/fSJPRfbV7AXOILWXi8A+idM1gvrrwiSp1a2WpsY+hguiuCSP906tPkC+nFvcf1DtV8qpE+jQF5ZIAHaPqYvgwPkoU9vukosNlr4SPom6m/IR2hOAK8ym83KWWlx9ffAGen1f9tTG/IoNlcWSgbWFy8A/miTrVYM7AhIHk36SiTAEto96PfAuW79JP5Fj/IX/gafmIXtvpcS5TXNCupo3j2eD06ASKnnsNf1b7cxdWzxrlj2ZfTyEkWia9RMX+bxil+CEOpfNEszgcriE71g4P/J5sJ6sRbIXAIgPmhA8pEw8/m8fbYEJ2DKm/r29l+QgOhe5IpfAmf0j9SyaWkjisIwrS0I7bbgIn/AUDBlFm4Ds8hKs2lloouQILrLIiATGAQDycZf3ed85c4dTTX2Oefe+LF6znlndGv2eQKUh7XKNzQ8oE5BigD6mFvxlam7OTef6N+r99h4CrL1z3/P74JcX+xzTuVw5Xz0Mfj0ZauE/kblOQ9afDbKs5hzuKhnTQDXMgLg9kupezEPrqgLs7+SekojwFtKL3D/3F5xccBeL/+CuwWPwUcef8jyr/pBs25aeAT0LGX90A0A8nSoI8/+XZ71y6Fh/jTPuZun+Ef2Q7+vgjgDd2EfoJ//MYFvBB+4N5tbGv3Zeq++FFxzHPbPZbD7WjMQj74yZgIXF2NPQHoIuvrJHlrr79v+T+mckC/8KCfHB/pvFey3txv8Z7cz/BNNhok3DIB2edG3DNS1qtPBlbgbZTkuYwREwNefE/LJX+j3+5f95Fvo9uOmikspvZSjg17/4c8ERB//dgAqumoPICH6Qo2/URvy7gt/2z/rl97p34wFVZ5oz0ejOTUy/46+4f7hzSn0FPY9aEiUo4P9Af3ZZqbs078mAKlSAuItWC/VnwkYZm5XaZg+TT3d2ADUH338R7hLOaGf9m/OdIIfKTEMncDB/gTAJ8DlEah2NHQ3AKuV+HNgpfrBfRuxd0pB9DlywWQ+gVEbt4+nP20fzpL4Ty86wa89DMcHPv9BSkCFv16N1nU1NfsUACbg21/VMoM6oea4O2OpFAHcXf9m4owS2V8/9++r/dkplcw5r3N5+d4JfL0N/7DfaK1lCFWbaTWdTq+b9v6BCbB7j0A2gMd72OmXbD8Y0+g7XXt4GQBfPnVWnLnkgJO+WFiZPingTXny6b3//4S+uQdVNaua2D76Qpb/AHd62B4A9o++/6BkAoEFwNiz/zwA7i9Y9tW6p6dHFxBDcMjA2/8PfO74awJcn9PZPvqcYJXA3dj5Gzt3lw9CPgUgi0CuH/4uj77lfoB3gm8W3Rgwgbf+K/6xNdzfymH/0EiZfh4AXgDOkh4OaZnDMA2ADAS5fjlO+kFXHzJ/DUCkfzAoegPoLVoFi0WWAV6G39/8A5DvP6MKEKdoKrE6TwkAnYDKox+8OoCbMtt/sDcA/vYHe/cNlF5ONgM6ZnD0zxeA+cf+YdPVb/RMXybg/Bx/118Nawp9G8AL/449144/O/3JngCEvQ1AMH0aYw5N/er1aPvJX9rN5bWpIIzi+BYFFz7AqOSWLBTflSKloQsTEFcuBR+BVHBbQUEUpIviMjFtbSmllv6tnvkePTN37qRW6ZmZGxvr4nfmfN8MCQKfMTgxtQHk/Y/5dzl+uv/OzwR81QTgdcU1Go1evsR8SX6sV3Tg1bs0AYM7gzuYoG8KAOBBpAb4tpuehAXpu3ORBVPawLW0/DFzA4ZhQGoB8Q8SMB/wJQMSA2hlRAMCfFjkBz6m0TMB0JImAPjgN/wkAbr7c6CfJbvimwFYeHovMBWL4EzS/+gA2PEwftUyxnDYRwSUHvhvA7zQm4z+2SjI8GHASGT8YJcl9K/wIP8SDBB6237Meybtf1IAef1z88GukjciC84WDKidgGkBEN8cEANE/f686huGw2OAHuOZ4pMfCwEYRfjGj2kGhOeLpRdLA5HwswCCAdx/zATf4amPmHiPKSgVwZVaAJRcZ7b/y8vgDwnoiwVmgEzh9weebgCeFgDDpwVAlwX5/mMGiQGDgd0ATcr/2NsfJiWZ73bJTx/owKniCQA5PwbF64/zQ8M+ZA0Q8gpgAr5KBFgBln5Mp9ceIOjUm7CWVANRHADQewBmzYFI3Vvdbneh+wQO9Gr8qIKg4klwjfyEfx0eQ+M/CD/xYQCWByBYUGsBkDuA7dfhGWACVPQB9W9SfnNA+EGv4glICf3CAvAXYEAPSm1wBy6VOmC9/0F5BcAAzP6yBiDil6fBf/YAIAIrGGkPBD5FAzwARp8HgAbMzTXhgx0jqIfpiqrAe+HZUgdUC8guz1oHcFkCpAWYvAnOB3ywi4TYEwDt7Uy2xutrnU7rpqjVub+2Pt6YnKtyA1Sof0zgqwGYNID4EOBdPRggj5CENARNEbioXwA4PS3AyPlZA6p5SughwfcegCXa35mMO0Au6v7mxrm75GcFRB8CCL/guwGsfvK32712L8oAliYA4lGYBeADO0C6/8N8/xv52QSUHvtvCdgj+yHqbE6qmL92CfLyB37Cj/B3ia8WVJEJUyNwJnwFCDEAbP/N/OgBhQBYBr56DGTnx4j7UdQZb98dDOhAnACI/HEFOL2pCqtHWRdojMA14ce3PzwANQJ5/pmAsgHGji6I+O9P1m7+k9Ymv5t64F29A0BpACDlT9SrggniQ9wGahE4cfAdsNKzBZT4+4UA1LW/C/p/1+YEBtzLWsADVUMCJPqJqoopEHq/DpxMvgeCYACvQAJPlfe/HACM3a1C8o9SC7/LPSA5AS0BNXgoFEJV7wPpdfA0+P0b0OYPQModsJwAbv7/6eF2/FF48yWILSDBD8tf1AD2gUtxC9QEQJL/1YS/0P+oZv6dqfg3dOrjUHUmtY8CD/hn4wuw81NAp5gBMSBqg1eiAKyyA/AAsNtfKQAU8W83UxOb5DfiUbLgl1qg/HkPzM4AaLFytWVUtaPgFCvA+YGPscoEJOkfEr/IT/ycnha4iFx+jxYEAx6zBbAC8v1fxAgGtDGzCHgGLvEMcPE7cOC78v5XdIC1nyNhMgEyigngr6UWbHsPVEkFMACgjwxok32x5oCHAOcAz4Afwv/+g9KTf+iiAYfw763X6ZOf/En0JBHsDvxNar1KL4LpHUDwGQFhl4HpOUgicJ63IJXhvwZ/Af/wApi0GuC5u3zBYDRu2Ip+lT9Eam2kPZABqDfARagK0yKgFvBKGBw45S2ABqgF+ArsSPtPA/aeJ/SOxx+zzJPTX5O/zEL0qCoYUA8AJPz2jKvAE3BZ+U9GLcBEAwr4BQO2ai3PFP0pfsr7GTTTIL+U18IGSyA2oJscAAeawZIU0AA6oE3gjLcASPFX2QBKNwDyU779hjRNtMbtoBl8W15pURSC5kMw5a+wPAfsA0kXOMtbQJIAsH9X/iOcAFr9bHT/p/q/T1LQ+mkGzBZKYJGamUEGsCoXbwPeBa/mFQB8LOcf/k0BjDaiA+wYlKZg/EQc4D0wSwAF+pm4EUT3wQtJD/zCCgj4UHr9L+Sf8Vf84+DPU/BoxvlZAbUO+FTgRfInJsAjYFehT94DvqQJ8Bvw3wRgt8XtP07RgkfbWQ+o7/9TYcfS13oNQNflHij/ASY2wL4ErtV/Tk9NDP8Y6WmB6w9v5/7aZhWHccVLRUHw9kO80L6hBrUaFdu1IJIpFBWVjnlBNm84UFj7SyeSiSjiYMY1TROb1Rrb+a/6fO/n5OStlzmfc96TqKB8nvOc75t0fb/uugHCXxqwsgITlB8GLKQGyGeB2+kmcMX41QDAWw2o/wJEwzX+3/jjpgBdTwPgDjj9wgpdC4nKCNBt4D4yQB8C0gAI/od/9xNAfwq/gesWKkLQdwPK/cfmqwF+BiIDbsA9dBcUA74W0W8Bx03wHP8haNCX+CU/1LDl1pgRGRiGAWGBJUCO/0qRgNSAO+ibABug+MiAHgDAn9Pb4GufFviJAetJ8Ws0MCG8ykL8eMF0W+LdTchq4dJ8+V1Y+FV/4QDdBx9OA8APAcCANAEn7v/O6qCyO5/BhwfhREhcMldkoVVl/ya3q0ZxCGBAyY+L+c2BxbIKmAF3SgL8CEBUACQBmPJnwHUGrA9Wj1rOX6/woRRnRC4FFvoiKeGIWFANHp97wmuACehMD15e8bIYEVjIDKCvQ5spP+DVAZZwY62vf50jfAgU/H+rR8MHUUQk3pcpeey5ucfnm6gDVgLiLuDxx8KvZkFEIAy4UhoAAV62/1x5/EP08be1c/ry4VLKfxNW8PAJYbUhHmPVAzLC5wAUYHXA9z9LANAJfsUPwfSNEF+GcwPUAvsNKFx5BBw/7v8j/F7A0ahxSxVumCWtuWcff/wX+TxA/O5A3AMF/+zK4uLiAl2lAfRJ6Hbm31b+LAEYLDhQ//kPWzGBAwhBQ1Vh3ALlh2T0Ir4MLTT1MyGdgcCPMwB8SgBbIJpfCAfEgLskALkD51LVff6dMD/UPoIB72YhqGzcGk/25ujPx1/Ys/vhr/4T0eC3/OPiCNghyMvg3TCABH6W8tMw5fQhFH+Iq99Qfkv+aMnRQ5kL/40T7fHTT9OPRHb9dtiYyz8IMz+T8/678kMgn4XvKxMAJftPi+OHdpwfOgQ/6XD9nyWg+jf4o5f4h+PPzi833IHWgpVA49ftF3otA5KBLAH3sAHcAKLmBOh9cHVaI+eHmjv6sNQfg8bfS0BF17+pGvizUv4Twpde6jcgc+C3tARqAII+IpA6IF8GHrqyLQG4RgZcKwwA+rnVkn9g/KIxJ+Aq5h+jEjB/X2H6q6sqnJo2ibQ/x78wSgn4pQFFBnbjBKQF0Oj51TKQnIE71AAE4Bqkz0GeS7U6S0eV8psm9tTwVbMAqipQJJxVAR//sFT5T/aP6bdm5bfl5lFwzAIpA8oPxR3wrPJHAEoD9FPANrUB0Mdf/9qAVsJfEefQ+cmCwbpsoe8l1KgdVb7/9jqVpHb/+BV/au7p568rv2fgkyIB2H58CMglBsQZeOC2R7a3v6bhDQC+pcc/DZ7GDI2dvzIdMj+m6HCdmTENqWI1Sn76R+EVzdw8qTLjr754RQzgBMwbfzhwPSkBtv8YZ/MUBD8bcC++DcMBiA3Qh4Czp0ASnaYJHQl/YOGltcMlIDQZVaVKfD/qNf+sIu0fywPEkYB+o3TgQAJg9DQXCZ9nmQAzYBuKBMgRwLAEkPhXYMsDQPgdQ+sMQB/axPjjcFjNNCETg2besOL90vgrbx9iCThopEoOARng4v3HsqYGlA7AgIe3SVkCsodAcGHRAOA6LQdA8t9JHGh1we0maC8l8uCmtDQ6juZB4IfIgOfyEumHIBKAIfSsxVBUwdSAa6IIAMZlOMD0wh9//l15AXB1MAaCHxG4aQ+G4+Op/jF6BAZWHXMHGqeSACySBSaEYHFN+HMD7mcDwgHgk/ghQMxVnr77GPCg7/wdF3nQ+i7n36Srt0nXZPyPTVgfHbzCjbSCP4rgEqHzCcnLwJ4bcJYdCBVVoM4APgTpU5CrMiIBkzgAUxok+GDH2sPa6232oC8ng/56x+NCk18wptUajo5/zvvnZQY8NeDsRQbiEPwaCWDsMGCtPANhwJUsAcYfFjA6Llar4De1uoGP2SP+ngzVxmQwHu4JepCHBet7o8HxV9FFL+2gZPzQvvB7qQwH3vA/EWD4OABra2vGv5hEAAZYR1Cit88BKb/8Dnzo0G4AnVKDogTABKX/HtfHNKA/fj8eDMaj/lA1Go3Gg4Pjr37+hhT4ZgDRYxr/XFXIHdjVBOQG0H1gdgQehAHKzxZwAtAR4TKG7b+hFwGojcDFi3QEeoSf6PuP2QLT24UMXy3w+Pv+awnsn2DAshhAnwCNXSZCMIOfDLBOmJQAa4AC/EhAxn/o/O1Ou8LAmzbT03oI9ovE30PrPNl6WuWd49fzg90TMLsCQr9Xs+QRKBIAer0TrpU3QjJAdJWWd6+GBSKCvlwGoGLkSoa+wJGh8GNhD1gRAOd/GwMz7aaZN1HEDE3tPwegPgPLOf8aLxBlwBQ1gBNwRR24ui3faC/RCAMu1wQAvApu/LBkQvS9q9h/zICP/e+FBbVNJIHPY2b+6R5Y60BEIHZfBimNwDxLDJBWoIQfjcDCAFYZAMaFBRBeXCPuGMcuyBL0zi5DE1AG4BvwJyr4B3zjqD8Eb2QBcC3yIppRBNmAbWXHoFczoAxARfD5YFXt1jvcMi/1gLUlAQhFAj7AAH/gSw/N8vzrs7P79B/CVBPKCPxKd0HbfSxYhd8DYA5EDUAb3DwCl1j+FLhpzwNQNw63ROQDzd4WsW9R+Le8i2YeAOCHyu0Peub/ndmxYC0MKCKwFlqUmUcABoBd+DEUXgZagAh86Ogv+dtDghcLMHHBAtHHNQFI+YV+6vNPdA+iHwbucgBUFc8iAil/fgoEPz0Dt20CHxc74Am4JNJH4N2GvhiAA1DvwA3BReM4lXXQpGGNdL9R/g+ijfJ7mNQ6EtPw38puf/rY4HrHpZ+k4zSoAb/FCWAFf/HTcTJAxQmwCHAbGEt/xKAVARCV/O3B1iXtm8aDuUWgtz66eAd4lrDTOqODquHHc7NzgR8hYCOiDDbOiAPBHg6o0gSorl2UBOgRgLgPSvTC8BIIzELE7mfgyxB7AAEdF1ags6SJLhblx+4zPhbb/ah+SeeIUadUJS5EBH6RBET+g39NzsDMBFgAQI+pNSBNwBAGcABO1A3tmCZT36cNVGX7pYsqVuw87T6GKGue7Pj22CyfgOXCAjsHEoEn9QyclIAFws8NoI9wYFd8PgTY+HgQ/sgrwIkaaLswdwGDuscx/Abv/gZetI3qD8Q+pS8Kfn9car5zkjwCp+pPwJmpM2AGXNzkLsCMbl2gTuc6tACcrCHgIfZAV+Br21S84JXpOQCEX9KXN3/rm/YLth+jTnYjuA7+mRYY/mKSABPzwwFeoK4UAH8I/vSeBeBkLd0g5ugXt4GZigygBrLcQRfCEvQqo4/tBzxpn+CX/zICT+oRKFR+I8wNIHShNwNCN+gERADqNbFOYRs09B2odUA/hNA41fQ5FLufGhB9k5YhOIBFFYaUZ6CsARhn3ADmLwzASPvA8QOgch/ACZAANNsna8z7XvQM8wQAO/idniX4UIb/jPVMeP5gWdShJSwIWRncXVH8+gjUJwBL1yXwmN1+BKDZbLoNpR3DIM+lm7+B6dvPw/QK0ef4WdeMZ0cM7+Io8BQrIgL7HoAyA6xIgP9PQDQBOb/gd2m2ogQ2obbMWboB/lLaM9Kap85QRp+dfusatW/obYxUHgM1oJEa8NOpIgJRBMwALYKSgK5Z8F0XDSCIf6c7kXsA6Bkdrzwg+2v7G83JLAMYH9d5mucz8NdJSm+KtnFp07A2sDEz+igLePEIvJwYcIouT8BaGPBqHIHvv/cEcACC/zSaP5AHh3YCmq62v9FVPRioAdErbQML6FneNvPzaBj3OVuAMdU3L7afdUAGGH+YkBYGM+B68Bt+fQLAbwZsSRvkpA0i8PFmpztMDGjxJYo3bfOgnwbg/eiWF/xZx7hQ0TVPy9+zqnHbIqBrqU5SBDj+GKd4YBJ+/oXwVTaA6MEvBmCgD3TCT+pGCWDUFkYTSzN945HYMwNAThbU8efw2e7nj4pbw4hhWxyIWQiHgA1YFgNAjxIARQL0ThgJQP2LAACfZAFwdW9wCaAAKG2bkf1Nlof3s0Zx3CMt2gWGMv5i+5P8m/baoghBfQTezIpgODD9o+HbLAAia4E/ZUCXamBWAmACLfEGw4LRnBC/4bPOswPWLC3k/KqsZ3RC/wIvhg9ZNaw1YPes4WsEwoLFMzgBJE1AHgHgk7L9RzUcSwngAADWlnhDabAwDBhfQ+AKenlFuyzf/Y+KpqnJ8beuYXOC7/zt2QZUXgVB/9MFOgai9PtA1ACgO34YAH2XaagnQHMur0quPkQ0xnoEYv9d2fZ/hvGRbD8cyPsFPa8GRL8U3ARSGXvpgFZBLv8/Af+C8mMm9wFLgP0/0KIGCH83d2A9NcAy0G61gj0OQrMv/FCQJx5oqzjGJ2UtI/OekYGPazfD57W+CCxLAuQEYLK8CCxEDQD7j/z/gepFDehSAMKALzHTEtDiBRJm5EFccO2l6T+fROAzDFpMH5mYvrz7RQBIfYMPE06ognoXvIBTAAOsDJgFkQDQs3oegUv6Ew2z4B28Wg0U7ta0mjKhFg8+Alz04AIug5c3oeAvm0VBwu7aF+bEAMzaIvAyGwD8C6gDloDAx7QEkAW9qIGQFoF3MCBaJlwDEQADTlV68ZLy57LNLwPwjPLnx3/agCfkkza4m/CB8We5oAbsEi1t/wWWOHBGIpAmwALQI36rAdEF/Ttc8OLQSkAddf76uycA+x/4uGp3vwyApd/VbsZXEFyqMgKZAT8RPE0xgEKgRSASoAbo7osB0Qedf7A1Lgw4UQfgB75l4LzhY6mPv/PXBOBPys7tJ64qjOJVY+o16otaK6WFTlERtQwYLV7SWJSi9mKaEqMSY2PFxAhJDYmmCY0vjQmUFgpIGv9X13fba1/mUF3nMjNeHtZvr+/bew4zZ05n7zfUPpJgAHBUTQAA9g2A2g//ECNQ9AD84Q4BoH+zT607gHLYubcAvhGx/X19YPm/kRNQ++XNchTAYZgPBraLvBJaANspAAUA+oc8Af4roLD/Hey3AJCAu+yBjHq37lysekBjH3t9u9Dy6ke4p3Z98CF95hSsIPIIGIBNser+CeC9S7EWZBOEDIAiwDXsFsCXm0fZA0dqBu3L+/5zCSkAHf0/3BfrX+w2AxLAqwagfvuN3aVdseyCPQJQBK5LeRMggLAfBVADmCWAjhZY1MM9vfIBVfa7OyAXQGo/BO/Y7bSlrtkICAMTgxAoAUx5CwgxA5dsKsxXghoAQ2B/zviy0qkAMO6m47GVA2j8d9qvbhfIBhjD/6oR2PJBj4dWU+CA08cG4PZtBMAInM8jcMmaABPACoD8V4CqAPx0AgB8EhhX/wcjWJcSeLh/I9B2ALNf3Tb8nY1klEGILBBJmgePZAF4FwhwSgAMgQGIFui/gxkFcLFsgkcdQG573DcRwRiA2v/XrX+6L94BVDeLo38DwPQz/ykAdo6FwG0oCJzHFgnQErAm4CVAAvUc+AkBaAnQN7aSBB7IYN1KwGe/cv3TUf8QO6DK218OYBI7VtqtyIEA3rtd9QACYA0gARAB6CSAv+PE7+Bgkxc/YSXcJIAswreDCADyxj/sU+0CMJTyT/sh4SAAaJePVAmAywCM/3lNACcCJiD3f/UX7QDZj+B4EpAAWQeN0HWbfr4MAHrhQ+wPaAAIvqu2b3eNHwgABCwEB4oJYAWgBbAJQHFJgAAgAIB9yAPwSYw/fhjNALxVuBwPGhx6fSQAqBn/jgCw/ov7hVKeAEyzxiFYtBHwpSAAsAMsnIfePZ+KQNyzBByBfHIBCWAAZPcewJWwe20fWAcG4GtV2f6prvzTfwtA7E8yBrKJ+LwBcNsBuOqJkADcPpTG3xKAXQGcUAAjZpGO/RgnCW+Ct3j1uwHQ+m8ngMEAJjH+CiEYpCBMYVMSUEyDt6Hcv7QC1oBfGQUAlSZAFQFQAgmALITYAzzu6jpynyOxEuj2X8e/vQRG+9TWJCKgG62ThR1AEQmYUvtOQErAqiAmQlUA+O7PlIAvr8YvAToDfUkAYrgoBI5/Vg73fgj7GYAu+yUA+m8BjFgGJsM2/WevIwGT6Y3AwoIQWDD/DqA7ARfhHs4pDcSmLYQ8ADb8yXdwYCDu4zcTTZ3pZ/7pvqMBMgGSgawR1idsLIFeJADOPQIkwIVA3QMuQjQvIdBF4d1YCI0PlFKxklDdAQBXd/dvABT+W+1OZjVg403/bAUBYCI6wAISgF3l/knAAXzBACQCFAisE0AHAT9qAB3L/3r9f/AEcEbPhydDWQ8clIApBbBtABauLUBKwWUEmADYVwCeAGw1AawM70cJjB8gMvgnADSrX9rv/hsA1PiHjk+SgJ1om3tKwH4AUPO0XyyFDIB8aNsB+Md46h/Du3iHCXiICOAz/dtf4/+Njvybe78CMFCTpQrjLAdbCuOiqANwkQEAMAIOQBPgAZAdrulf9Pf/A/BAAUDff1b6by+A0j8vgZQ/GwRZCibC+Sk7Ff75xAFsGQAYN7EPFguBQ2JfE/AFe4CcywT0/x8A/9yLMChXfy0Be/9XNEDaD9nL7SoAZRTSamDqhALYM//UiiNgDRgAIyD+2QPgWa1/YwHAyS+K/jcAQwDQ2Dfntf0k1n81+kSwU/g/hd02YpAtAGgASGBGM0ACJ50AAMSXtwyAC97FNwCYTuHd0H8GsH4FAExE0LZ/Eujof/QPGASQE4CMgrrXScAATBYAVlZWFlayubBNgAKIDHyDDQhkj5LAPJgAzGIL8SmFhSABcPrj5f9m+neJ/ToAlK2EOO7MgO9WAX5ZfKL2D5UALnkCYN0Q6KeXmQB7MBgxDWAtHI5BgU8rGHcSgG8/o30TAYgq+1Az/ARwuAnAIs6LiiBqIS0D9mMdCPtQICCAVAL86pKNPzzrZntoNwDAprknB4ehe8yC6ccim+7XPfxtB3zffj3MAQxn7rFxl5eL+jDCSSBLQALANhgAmICrmoCLkQEyMApfcxowl7O+EQifPUgVQP/Mf+X/7e7xf18kZ0cwAY9BgBDUvQeAPXAlJgECUARG4JITAACzbwREt2j+Gyh9tvWUTwNhk5sT4bOJK1ECY5qAdvLDHwAPan+8YbwpUrCPuOf2Pfl8IAB9M0z/LIK6DQKAILiqBYAIQBeVgQkUzP8tdkFGnb6LBKwTAET7B+XflLm38FNCYMesLqpVL/5F1gF29kADEPYZAb84RgAYf5N/iUPk/kkA/0y64MAEBASe7l+hf89+2/1oH2rLP90pNSewt7iItEvgZefQZ/UQPXAD9nMA56ILtAlIkgiYxDalAK72y2kg3OuZu/dAyD/8WF/9MP9R/V0XwCL/xyCc5VESMLy4CN8CYbFYCSAU8Sp64N5NAqCsDbIJEMBVScCtIPDND5n/H6QAQOCEdUF3HxD4klkYg/8PLQBV/Pl7ad3tjw0Q1pMsA5uIgMVeQHj64yQNIiYBtgAZfQgR4ExQJuDHmAR/D/8/AMDXsI5DdQsqm8BsBoGjP4vn0N0rP1zvAJB//rWq/9q/D3yJYGdRA6BFQAQ4DAqqw9eB2zdvOgDaZxvkRIhZIH2DXwBcDQBqHwDkQ+14eatqAux4DkMeoyruXZHvPjT+Ofqmjukv818A0G6wtQi5ddusF0QJsAUIgN8WFi7D/+VzJgVAAiyBHxUAhC+xiX3oa0oIQLdujflKQEfa7OLsDyZ7+s91AOB3Pvlzye34w34NoMh/HYFhA5AlINci3wuvSAAuw6xavywQuBpSRQ2kBEBXDEBFwPxDm/F+aLZS9Q/GrqMC1H85/cvsb+IHAAavf2m/JiBNQCGkEOQCAJsEewjAb7/BrJnvigAB/GgA4B87ARQJuJJqYPZArV/h9/7Ki99F+Lv6P/PfyJoACGBzAhoFChVgV4MUwOWFc3kCCCDvglYC9vVtVdgnANMVqwFrAgdplwD40Q8r/3b51z3/txIoux4AJyDmmQMCmJcOIC0gEsAIdCQgKoAEKgTy71gDB+nBdQAI/wMXPzg6/LP+g8AHVQSG1HwhEoirQRPWAi+7dSCYd//QIABMQADABU07cF1HauCK6B/OA93avp4BUO+Mfzn8fPvf+C9/MosEpAag8aIERJYDzgEggArA6HsC5ueFQQ3gkpeABYA1AMG3CQwSgbETnAc6db8JAPx31L/5J4D2F7Owf6B7ENhdXI0aoGI6iFXQ8s2b6AAWgJ9//lnME4AsB2dAIAHgFEAAMvCZtAag+1kbHJqNkz1hBbADMP3038a/+c28LAAiQ+A6OYQA6E6ldsBV0E34dwDnfsY+D5UJIACMf7QABqCS18CDsg3SOp9uf84AtG/9Wf2dy1/aJwArgyX9RzuWgGBAZS0QBcAEmOa1CLgaJIDnpQIaAESQA0AblIsCCmBIdhxVCHZRAc0X/zn3t/5pnwBY/5SHYGlvFd5Xx3GulFpgb1n9MwHz2ByASv5UEE3gSQCA8hJoAwAedRuEX9mwk4OeL6QAcPFL/53tn+Xf/lwOtXRsaenY0CrMrzYBKFrgbxEAAHCxCvQieQ0ACFoAlMZCIxAXxmAWMgi26b6OALADDux+NN+Mfwtg2o5pOS19sCQENlYXJQBCYRxHHYC2BcpG/wAww2mAAH7EDVxMrICKwHX8S74jUvtGQU/2uGsdkA2g6f2mgf4ZfwKgLANLSydXxb0icK0yAEckADmAeSAY/Xl+dHQeGEAgpoEZAuDd+zgJmMZ0U5l/SC4NTr1lAKA5bFAg2GYHzH4pPgfQ7d9U268QLEF3hYDEQM84VGkOFP/RAuAeCEZFFoEVAgABA0D7SuB6IkBhVJ3A53xDEO5xThzuMwCsfyn+7sVPs/4hgHBPLQEB2qAZt14gT4sAWAVAmP7UPgDMWwAsAjPoAYMAMAFyPSdCQAKobgD4/FTeBeYm5Mws9BmA8meyu6/9Mv7Y2vy3CDQClKcgOgADwP4HBCKLwLmVmRn41xKAagDXr4v9H+ifGbgO4T+qIgACc1b+eHaP/r0B9Duq//jx3b29rQ3X1tbe7u7Jevw7tLS0tVqrXAWrfxDwBojxH5UT2yAQeAIA4CUCAIG4i4td0cIhAocPIQGACMhaYMojMJtvCADv/RwNsF+O/tnDexs769tzcz3ss3Ozs71eb67nmri7v7G1d9KHv5vAV0MNgHoKgHTw//jj5z/EvkkJlACePfQiAcBeBkCMi+xRCWgE/knLQe99OGy/92EA8G//FZd9Tx/eugfnFKzDf6vt/Y29k5n/r3yjNjoDsMUASP/D4dZ187dE8L+gNfBuDYD+FQAFACIAgPCJMSwHIwLY49QvCiCb/mB+Y108z85RcC8HznKarSns7M1U3gPBUh0BaYHWAbeXAcD9ewJGM/lEcE67gDVBAjAFgBh9NaQA2AX6fFPIVQB0j/6L/nd4C+aH5nDImbI60ANnIWHexzMI9jsB78ntIBSHI9gYGICjR+ZTAMy9A/jDMyAR0HkA8hpoAfBWPpWI4D5XQ2HfA8AGEPYPb2yrb84Vg4UE0D61ub/1VRIQrE1Pr2F7b2i1h83EKXBf/AcAcc8AsAewBgzAM4MT4IIfJMDkAIBgln3QNJsFIC0AZOw3hyhNQKeQAOy0nzHYyxHkXaBXd8AiAAEAR0wDo04AALwHPAUA3QF4DTsJMAP6tnhqBATEu6tv/tP4n76zTt+y6Qs9wEF3ymqgS5sbM04AhbAm29pmr0f/fBvMDugRGC2lBGYgJAD+HQAJ0L8BoMoQ3GMRRATuZP4BYHhjk0tlWlcNToBs3WIMtAzW9no9+JejLgB2gI/U8kfYmAFNgAFgAtoCaP2/FgCMgRSBL4dMd/u5/8M++LZYnMAc4SMvmxKoO0Iv2mGrcY/BltmXA7rbE/vw3xQAhNH34Q8IKkUQACwCLxx6rADQjP8b2AZk4AFmgqIN7Ga3voV996fmITzB5gFozBMC9v+AQLWwqgQ4A9QFAOno0zwToDpfAWAHoH1jADkDpuC+LYcmT42rn/X0ZwCzPzE0MTE3IeM/FAlQFHje0Q57B9dAi2CjVyyBdqIAIPP/EQBg8HE4BJ8Iw78n4Onk/y8HkI9/CEFgBlRlG+hH/mHf/NuwT5hvP+P1rGxFAyyrgHXQhSAAXNssGsAyAfj4W/0rAPq3ElhRAJcA4IkcQBMAOKI0AmRwIbUBZOCON4Bhs2+b7ZZ+tS4IojOoPAqMAHUgguXltbXltT3xHw1gYbnugBp/kXIoegCnAQB4XAG0/nlVX8o6EMSyEEIbCALb9n/079O+JgCGgwIeZnFoEeCZcTAKZp8xEM2lbYD2Z0AACHbYAOfNPwNgBFQMQERgRmQA8IuT1RTY3tFMKbiiDwiDf45GI3yg/8edTfiESWfAk21zeCHuxbofegox/Q+Pwsay6NpQrAD22gIQ53pAZQKg6AHvAsAjBuAvCwCcVffzAwA7vBUIAYdw3wiM3Jf/48G62mUGsFebw4nh50YRgQWguw6EwF40wOXlpgN+hD2pXg3PpB7wCACwA0QA2m+0GYiog9A9JTBhw+9Df5D/WS8FeXAIOLI2kFrhw7V/DgT24Z8NkAGAfScw+qluXAxFBM5bCTx66FB0AAIob2lH4ZUAyBisg8DsAxl+eJMAQAGAIEjATt4WsUwwAL6r/VxD2LpgrC4O7YFATyeAfAnkAXD/nz4sAfjl6efVP0qAARCTvKOHHZoCy4ApCNwZe+3OOBZEUuO5e7LgFv9SW4IslHxlyNWwusauh51b+QIIyZ8/cXQbHGL86d/cf4qdTcACQAD469hhBUD/TQN4G7uLCAKAzAnj98b66/q+CBkwhVUcAaKgwDYJ/xMegCHPPk5BQFh0MPAF0OL88sYkht8bAN8FswF4GTADBiBWgs8CwIuSgDoAF/hnvVJMgan/2oNTRz5GJ5QMBAKPerite0L+JNogACgFaM4QYPNz63/SF0AnNpZXNP91AXgEIgHsAZn/GQfwDOyLCKD5Rnsfx5v9Nx1AMHAMm9oJfUU0MUiKoc5BahMiWw9g/MM23aeaoLJLIJPivl4BRP1bDbgGJ+ApAHjMAOQVcKFw3+/DPvwrAgj+k4TVuhPA+4JeTYBloQeHPxBwGvAnZp/55+7SN4Dx5cibzD9nAI4/xCbAJsgEvAAAT5ctEPYvXKhuakf12QsoJfAxCIw7gQ4KEgI9kwMB6FP4rHoAdxzuf4T+1T6U/EM+/h0AoCwBTwDA46kCxkiAf9fq93lbU1EiIIj881/3lMAUvrTERtApLpZqyehDDEC9M/42/6t7jn8RAHOvJ9GgaVAWggDwCAFAN8bMfwqAePfd1Q8ElN1sDgQYgg6xIKAKQk8OH+0O+/SP26aGfwLIGgBkCEaRAUlAaoPwr8KXBrAQ1HmQADwAr1+wHoDh7wsBV98gvF0ikGXC7sgrbAQMQZc4TRICJV47hz/8H9li/MM/J0DzzgQwAkUCsAyAXkpzwI0bYzcUQPhPACimoNDwSDQChGBubuI/qiVA89Uew/+xtf9RWC/8Q3kDZAKcQMcyAHrG/EM3UAL0/7oCoP1Xcwb9AgEycdpuOfifQ8CVUgXAoEQK2uG39neO7lXW/4IAAwDVACDxLwSeUgBPGwD6B4BIAOwXt7QqYoB/r977ViobJ17xXkgEne5dRFCItln9kxz+Izs+9ysA5p/+KSTAFoOpBUCcBESPA0D4v3Ej9w8ZANinLAtWCYDAzz9YGWgIJlcflgJeLxgsdU77HH6Jf9b96wUQ/ZcJ4CwQ7wRsEoAeZQLgvwTA73O3CMCm1s5RD8EIPrrYe3gh2DujLgA+J9C+3yz0Zlv+HH8CSHXQtIB4M/juo4dUzzMBJQBIC6BVtIRwjif64riEIBCsdiLg+6LODEz0aF/Tj7WPDv8e3/wX/jkD0L7tQDA4AeiB3gXZA9S/SyqbAajFnqhh0CfQzgmpgxNThmCcDLpAdKqnMvueflQ/F38Hjz81ygAUk6D2wOiCat9LAHL/TuDVbhUTpJ2P4/MDCQFjcPCaqB1/iOGP9E+M3hTV/q3+sdF+XQFcCfN6kLSAaAK6ChAGuX8I7gv/ZwZBwFbd/rVGAAZD/y8D7r6w38OFwNY/pP47AuAI0iTAOUDWga4X473wjQrAoI+0d3EwCHbecgSYEYzBuNTzAf2gY/BpH5e+9VJw65/V32m/bYKoAGkBoccsAfks2DcCdQCwq/AwgACzQASIgc4JqwhCXQ3F2yJ96BXuZeL30Yd9UVf+OxoAFwJ5ACIBL4R/rAQ8AFAEIAHgLR2S3vfHzqZABGRgEExptDkJ0rslfyT/0Zwhs88CoP9y/EeTCKCzB6ICQi/pm+G2BACAovX3/c4Gorocompw3poAApsVjYFBSBgoeod5uLfoq32v/RoA819eAoFz3UzpzUC9DJRFwJNqnTUwFj0AcgD1dzrju/xJXUGIyjl5V2MABg4BFBSDgaAWoUmId8Y195j49veWkzgDlv1fpGlX/yKF4BNBcTGAq4AnMgCPpiag9rH1X/cA/EoC4fwYDiIIKaMWxta2/14/GACCUQCHWiMq+6kg/obw0N41Mb6Ggx2ge/4f1RM3fc0CYAs8f0krgHqxnAUusAQq/3Rv32tXBl2N8YwyOYlSUAaA4BQcBMWfSUrm4X4H7s15HoBknzMA4x8MrAxsHTRKAvU7QbbBKgEO4NVIwGlYeT99pUFPOGyHoi2KX86TbJvDW6gFhwAKygEkku30o7FmHu6PbG9cW7PBl4d2BoB7VVn/Mf66Q6j/rgDYKogRiGkgawF4058K4PTpVACNLAZymP8ztZTP7samQRAOLlhW2+HcRn5qe2dmbc3th+Lyf9kAIdqPAOR1UAJw/1wE5BEggJgFISQgAHgABgOA2AzkqP0bvuG9nc1xWASIVkfN+9btNZfaX+uYANv6H/UDmz31BAz6qyBbICPgABgBUdh/9fSZM6cVQJcMQRRDq2zy2MUnxu9uTqyOHDmqOjI1NbS5vbOxNbO0tLaG3aXu6V8BVAEY5QogtpgCcOqqgBnOgXkE6N8yEAkwCPxWd5fMXetcdtZPDnGpFc2HmP92BqB/dcwm4C8+yqbAUQaAHaCIwFhFIEsAAnD6YQDS/NAMPHY5+fnYmaX3sZXu12xbSwS0+xX51w7QOf6Q9/7Bw99cDGz1CPxn82DfaiBmAahugh/IaXhwDBwDB9/+6RJ23+AaEUjuVeHfnVf5p//mCmAQ4AJAX5d/EWMAuAYo9Jh3QVXZBdEDAOAs/Wdf7tSzZ8BEwyaOP3zL0Z0A+s8SMNA/lwCcAXyvA8DxtwDwbVCpR58TAFwK9Z1AGYGzdG9nEf+Bq1gu6iv3zvF3BAwACbD7037rn1MACRQtwOy31wLZAes+2DQBSLqg+T8r9ulf86/usctWSQccUsNnjtG9RP8Y7ScItK8EOPzWAJJ9NsBR+rfUKwH3zjVw9akAdsBGz3ApxBqIAIDAaU2Al746H/5gePgDVw1hCf0uhh0vfGua/xrd19N/W//4LrT45x9BiUDEK+H2T8I/AYh/FkBbBDealYC6x24IIJh3Bm4dDMDBGTQQuHX5h6ax5/4h3Boe9pv+d84DYO3N/uSBs8545UXArABoXwLw5KOHOvVIXgNsAgHgrEi8GwMxHgoCpBBn9WxP3L4hYOPHN0AQgOks/V8pghj/azH8Nv7zVgFOADIAFM2XCwDOAN16LACwC8osQAAQnGMXJdfHSaBJgvrFA31XCdDvgDAAX4n929jUv98U7vLlFf82+LwkYBT+1X6a97KCkIMfEM8nQGwsgK424ASgvAaQAQUgXfCsRiAYwDn8Hz+OAximiQAHfIvUvj8WUuc4sLnM/W0WgN8STMcf0gTo+AcB2iaK0RD9138LOLANtF2APUC64FlxDgZmH7ax47BzLSkF2MfRaBoyBmF/TbL/3m3VtaQFIRD2kYBRBCAEAhECq4IMwDz2wv9BDYBtQAi4f9YAS4BtQCnoNGAR8BywKzAK0JId2vH4tVBjoOYh/7XoZRJQ97wlmBYAirr4MlAqAP9ILPZEoB7/J9kAugm8DACpBIiADLIeYC7NOxkcnwYGmCxugkEO04V93XX0Re6e/oXAyoLZRwSg5I8UfOCr3teO/2H6P0BPpwio+f6vv/pKiCEYzsQEZDJz8MqTGaf/TF/F8GsAVOV9oc9FA4BgrBJ983nr/zwvAvwvAkxAMRNk9mUHgW6pZ2NCtfbRAGGfHYD+IQUwLxVg5rDTcoWBX5Mtxp/+H6rHog1eIIHTTQaIQDPQyQD1EF7xorFvAHzscdB/DWAeAEZBwPtbGwX6Z/t3vcsV4H8jwC4A+0bg1wzA8Fmal/NxmQs7ExAg6D//Vvx708i+IIAMAX8fp0oAlAY4eaVvumf8PQD0/38IeBfQUxYBIggI0PFh+m01zYciBCenxbnsMK8A6J8JYASgPAE5DrpX87V95P9/6d/izp+1kRiI4l4vKOvFdvBVKY642ebKI7AEXLm0K5HmvkUI3PeHe9LM5K2klTnsmPz0x06KwHt6M1pIsd3TXysCMcEiAGZqANCDEogOW/z8PHuoH4bh7W2I8g15S7ae/8nkw4CPsxgQjjdLwJlDofyT6H+o6q8/D0xrAPz+WY1AbIMX9A/6CcnxR3wMyuswFQ/5StAPRL95AF1ngxlg7LX0Vb4ZYPf/NQ78kgjIZYgAvGMkjfAZg8CDug8DAj9ggw1T9HXgYgDW+DoKagCYWBCwJAS93Hn0qfzxSv1guQ4ZeDFgASPAEJTkwmWXGUkcCPKB7qMhAQhFAKgfU1C91B2X2EP5Wv79cnEd7acD75oBjMQE1sB/ZMAMqCbA4/iVUwTypQ+YB2gEMgC/qnZA9dTP9ndVGaANGNGCIgVVihgwBKUJwHtsdIAWiAMHyJeN0ifYr6byR3Bl/FkGvAmyDBwnPGfSGYecIawCy4CHAZ4OKAcxAaI+dKAUDvHYOQ6UzssP7JaL23CP9i8CZoBlYKTdkPL3WQXEmTng4xbVez96YAaEhYP8ozkQYepDmOSMlYU//pmVW9xOiypgBhILjvSAHTE3oWTI8TEE0I8ZGDFpAQi3GU2ow9r3PP6badZsBOIA9BtHsq9QGoBRWGA5MCwFYUghIAtiwrwRvPdOIn/TUMPNdfCShQBjzoNYCHlH0L3qgRf5r/pdsVaAKTmAOig0+Vgfc+oPo+A3bvGVdFv2gawOaEJZD7waZcMigwxM4NkRzQEM2mClcNKQJ4mPG+Rjp/yvxq1pgVC3YC/7bDVgowWYZoHXGfGAPmAG+OJUOeyTjpB6KOdrdUfIvwdN91hJAT3IfYDoI2MwfzlMrwa64DPGBFEr/YHSgfcbtL670bTbLAVhJNAEpqFoCLXeCNKCyCy4jA/q3eLONG6tJogBrISUoidgS/uCUvGAPmQ2YIRNpxjjw+dq1/Hs78vStf32iZUwfUC84MM+8YF1gZXfD9hYEIqv8rDpO3d/8WUWOviwfRITFH677ENigzBTEjqJxySrVd/vOtcsvpll41zXtW3b9zAE/FAgXGb+4CgWpGmQNfPYuFI2oAe73a7rnGu+RPc/7NDmX/6EDAkAAAAASUVORK5CYII=",e.supportedTransactionVersions=null,e._readyState="undefined"===typeof window||"undefined"===typeof document?a.Unsupported:a.NotDetected,e._disconnected=function(){var t=e._wallet;t&&(t.off("disconnect",e._disconnected),e._wallet=null,e._publicKey=null,e.emit("error",new k),e.emit("disconnect"))},e._connecting=!1,e._wallet=null,e._publicKey=null,e._network=n.network||null,e._readyState!==a.Unsupported){var i=function t(r){"object"===typeof r.data&&r.data.__glow_loaded&&(e._readyState!==a.Installed&&(e._readyState=a.Installed,e.emit("readyStateChange",e._readyState)),window.removeEventListener("message",t))};window.addEventListener("message",i),L((function(){var t;return!(null===(t=window.glowSolana)||void 0===t||!t.isGlow)&&(window.removeEventListener("message",i),e._readyState!==a.Installed&&(e._readyState=a.Installed,e.emit("readyStateChange",e._readyState)),!0)}))}return e}return(0,f.Z)(r,[{key:"publicKey",get:function(){return this._publicKey}},{key:"connecting",get:function(){return this._connecting}},{key:"connected",get:function(){var e;return!(null===(e=this._wallet)||void 0===e||!e.isConnected)}},{key:"readyState",get:function(){return this._readyState}},{key:"connect",value:function(){var e=(0,l.Z)((0,c.Z)().mark((function e(){var t,r;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!this.connected&&!this.connecting){e.next=3;break}return e.abrupt("return");case 3:if(this._readyState===a.Installed){e.next=5;break}throw new _;case 5:return this._connecting=!0,t=window.glowSolana,e.prev=7,e.next=10,t.connect();case 10:e.next=15;break;case 12:throw e.prev=12,e.t0=e.catch(7),new w(null===e.t0||void 0===e.t0?void 0:e.t0.message,e.t0);case 15:if(t.publicKey){e.next=17;break}throw new E;case 17:e.prev=17,r=new o.PublicKey(t.publicKey.toBytes()),e.next=24;break;case 21:throw e.prev=21,e.t1=e.catch(17),new S(null===e.t1||void 0===e.t1?void 0:e.t1.message,e.t1);case 24:t.on("disconnect",this._disconnected),this._wallet=t,this._publicKey=r,this.emit("connect",r),e.next=34;break;case 30:throw e.prev=30,e.t2=e.catch(0),this.emit("error",e.t2),e.t2;case 34:return e.prev=34,this._connecting=!1,e.finish(34);case 37:case"end":return e.stop()}}),e,this,[[0,30,34,37],[7,12],[17,21]])})));return function(){return e.apply(this,arguments)}}()},{key:"disconnect",value:function(){var e=(0,l.Z)((0,c.Z)().mark((function e(){var t;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this._wallet)){e.next=13;break}return t.off("disconnect",this._disconnected),this._wallet=null,this._publicKey=null,e.prev=5,e.next=8,t.disconnect();case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(5),this.emit("error",new A(null===e.t0||void 0===e.t0?void 0:e.t0.message,e.t0));case 13:this.emit("disconnect");case 14:case"end":return e.stop()}}),e,this,[[5,10]])})));return function(){return e.apply(this,arguments)}}()},{key:"sendTransaction",value:function(){var e=(0,l.Z)((0,c.Z)().mark((function e(t,r){var n,i,o,a,l,h,f,d=arguments;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=d.length>2&&void 0!==d[2]?d[2]:{},e.prev=1,i=this._wallet){e.next=5;break}throw new T;case 5:return e.prev=5,a=n.signers,l=(0,u.Z)(n,W),e.next=9,this.prepareTransaction(t,r,l);case 9:return t=e.sent,(null===a||void 0===a?void 0:a.length)&&(o=t).partialSign.apply(o,(0,s.Z)(a)),l.preflightCommitment=l.preflightCommitment||r.commitment,e.next=14,i.signAndSendTransaction(t,(0,V.Z)((0,V.Z)({},l),{},{network:this._network}));case 14:return h=e.sent,f=h.signature,e.abrupt("return",f);case 19:if(e.prev=19,e.t0=e.catch(5),!(e.t0 instanceof v)){e.next=23;break}throw e.t0;case 23:throw new M(null===e.t0||void 0===e.t0?void 0:e.t0.message,e.t0);case 24:e.next=30;break;case 26:throw e.prev=26,e.t1=e.catch(1),this.emit("error",e.t1),e.t1;case 30:case"end":return e.stop()}}),e,this,[[1,26],[5,19]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"signTransaction",value:function(){var e=(0,l.Z)((0,c.Z)().mark((function e(t){var r;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r=this._wallet){e.next=4;break}throw new T;case 4:return e.prev=4,e.next=7,r.signTransaction(t,this._network);case 7:if(e.t0=e.sent,e.t0){e.next=10;break}e.t0=t;case 10:return e.abrupt("return",e.t0);case 13:throw e.prev=13,e.t1=e.catch(4),new P(null===e.t1||void 0===e.t1?void 0:e.t1.message,e.t1);case 16:e.next=22;break;case 18:throw e.prev=18,e.t2=e.catch(0),this.emit("error",e.t2),e.t2;case 22:case"end":return e.stop()}}),e,this,[[0,18],[4,13]])})));return function(t){return e.apply(this,arguments)}}()},{key:"signAllTransactions",value:function(){var e=(0,l.Z)((0,c.Z)().mark((function e(t){var r;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r=this._wallet){e.next=4;break}throw new T;case 4:return e.prev=4,e.next=7,r.signAllTransactions(t,this._network);case 7:if(e.t0=e.sent,e.t0){e.next=10;break}e.t0=t;case 10:return e.abrupt("return",e.t0);case 13:throw e.prev=13,e.t1=e.catch(4),new P(null===e.t1||void 0===e.t1?void 0:e.t1.message,e.t1);case 16:e.next=22;break;case 18:throw e.prev=18,e.t2=e.catch(0),this.emit("error",e.t2),e.t2;case 22:case"end":return e.stop()}}),e,this,[[0,18],[4,13]])})));return function(t){return e.apply(this,arguments)}}()},{key:"signMessage",value:function(){var e=(0,l.Z)((0,c.Z)().mark((function e(t){var r,n,i;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r=this._wallet){e.next=4;break}throw new T;case 4:return e.prev=4,e.next=7,r.signMessage(t);case 7:return n=e.sent,i=n.signature,e.abrupt("return",i);case 12:throw e.prev=12,e.t0=e.catch(4),new I(null===e.t0||void 0===e.t0?void 0:e.t0.message,e.t0);case 15:e.next=21;break;case 17:throw e.prev=17,e.t1=e.catch(0),this.emit("error",e.t1),e.t1;case 21:case"end":return e.stop()}}),e,this,[[0,17],[4,12]])})));return function(t){return e.apply(this,arguments)}}()}]),r}(Z),G=r(792),H=function(e){(0,d.Z)(r,e);var t=(0,p.Z)(r);function r(){var e;return(0,h.Z)(this,r),(e=t.call(this)).name="Slope",e.url="https://slope.finance",e.icon="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTI4IiBoZWlnaHQ9IjEyOCIgdmlld0JveD0iMCAwIDEyOCAxMjgiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxMjgiIGhlaWdodD0iMTI4IiByeD0iNjQiIGZpbGw9IiM2RTY2RkEiLz4KPHBhdGggZD0iTTI3Ljk0NzUgNTIuMTU5Nkw1MS45ODI2IDI4LjA1NzJMNzIuNjA5OCA3LjY1Mzg5QzczLjg3MzQgNi40MDQwMSA3Ni4wMTc4IDcuMjk5MSA3Ni4wMTc4IDkuMDc2NDJMNzYuMDE4NyA1Mi4xNTlMNTEuOTgzNiA3Ni4xMjY4TDI3Ljk0NzUgNTIuMTU5NloiIGZpbGw9InVybCgjcGFpbnQwX2xpbmVhcl8zNzk1XzI1NTQzKSIvPgo8cGF0aCBkPSJNMTAwLjA1MyA3NS45OTNMNzYuMDE4IDUxLjk1OEw1MS45ODI5IDc1Ljk5MzFMNTEuOTgyOSAxMTguOTI0QzUxLjk4MjkgMTIwLjcwMyA1NC4xMzEyIDEyMS41OTcgNTUuMzkzNyAxMjAuMzQzTDEwMC4wNTMgNzUuOTkzWiIgZmlsbD0idXJsKCNwYWludDFfbGluZWFyXzM3OTVfMjU1NDMpIi8+CjxwYXRoIGQ9Ik0yNy45NDcgNTIuMTYwMUg0NC42ODM5QzQ4LjcxNDcgNTIuMTYwMSA1MS45ODIyIDU1LjQyNzYgNTEuOTgyMiA1OS40NTgzVjc2LjEyNjlIMzUuMjQ1M0MzMS4yMTQ2IDc2LjEyNjkgMjcuOTQ3IDcyLjg1OTQgMjcuOTQ3IDY4LjgyODdWNTIuMTYwMVoiIGZpbGw9IiNGMUYwRkYiLz4KPHBhdGggZD0iTTc2LjAxNzggNTIuMTYwMUg5Mi43NTQ3Qzk2Ljc4NTUgNTIuMTYwMSAxMDAuMDUzIDU1LjQyNzYgMTAwLjA1MyA1OS40NTgzVjc2LjEyNjlIODMuMzE2MUM3OS4yODU0IDc2LjEyNjkgNzYuMDE3OCA3Mi44NTk0IDc2LjAxNzggNjguODI4N1Y1Mi4xNjAxWiIgZmlsbD0iI0YxRjBGRiIvPgo8ZGVmcz4KPGxpbmVhckdyYWRpZW50IGlkPSJwYWludDBfbGluZWFyXzM3OTVfMjU1NDMiIHgxPSI1MS45ODMxIiB5MT0iNy4wNzE1NSIgeDI9IjUxLjk4MzEiIHkyPSI3Ni4xMjY4IiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+CjxzdG9wIHN0b3AtY29sb3I9IiNBOEFERkYiLz4KPHN0b3Agb2Zmc2V0PSIwLjY0ODU1NiIgc3RvcC1jb2xvcj0id2hpdGUiLz4KPC9saW5lYXJHcmFkaWVudD4KPGxpbmVhckdyYWRpZW50IGlkPSJwYWludDFfbGluZWFyXzM3OTVfMjU1NDMiIHgxPSI3Ni4wMTgiIHkxPSI1MS45NTgiIHgyPSI3Ni4wMTgiIHkyPSIxMjAuOTI4IiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSI+CjxzdG9wIG9mZnNldD0iMC4yNjA3ODQiIHN0b3AtY29sb3I9IiNCNkJBRkYiLz4KPHN0b3Agb2Zmc2V0PSIxIiBzdG9wLWNvbG9yPSIjRTRFMkZGIi8+CjwvbGluZWFyR3JhZGllbnQ+CjwvZGVmcz4KPC9zdmc+Cg==",e.supportedTransactionVersions=null,e._readyState="undefined"===typeof window||"undefined"===typeof document?a.Unsupported:a.NotDetected,e._connecting=!1,e._wallet=null,e._publicKey=null,e._readyState!==a.Unsupported&&L((function(){return!("function"!==typeof window.Slope&&!window.slopeApp)&&(e._readyState=a.Installed,e.emit("readyStateChange",e._readyState),!0)})),e}return(0,f.Z)(r,[{key:"publicKey",get:function(){return this._publicKey}},{key:"connecting",get:function(){return this._connecting}},{key:"readyState",get:function(){return this._readyState}},{key:"connect",value:function(){var e=(0,l.Z)((0,c.Z)().mark((function e(){var t,r,n,i;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!this.connected&&!this.connecting){e.next=3;break}return e.abrupt("return");case 3:if(this._readyState===a.Installed&&"function"===typeof window.Slope){e.next=5;break}throw new _;case 5:return this._connecting=!0,t=new window.Slope,e.prev=7,e.next=10,t.connect();case 10:n=e.sent,r=n.data,e.next=17;break;case 14:throw e.prev=14,e.t0=e.catch(7),new w(null===e.t0||void 0===e.t0?void 0:e.t0.message,e.t0);case 17:if(r.publicKey){e.next=19;break}throw new E;case 19:e.prev=19,i=new o.PublicKey(r.publicKey),e.next=26;break;case 23:throw e.prev=23,e.t1=e.catch(19),new S(null===e.t1||void 0===e.t1?void 0:e.t1.message,e.t1);case 26:this._wallet=t,this._publicKey=i,this.emit("connect",i),e.next=35;break;case 31:throw e.prev=31,e.t2=e.catch(0),this.emit("error",e.t2),e.t2;case 35:return e.prev=35,this._connecting=!1,e.finish(35);case 38:case"end":return e.stop()}}),e,this,[[0,31,35,38],[7,14],[19,23]])})));return function(){return e.apply(this,arguments)}}()},{key:"disconnect",value:function(){var e=(0,l.Z)((0,c.Z)().mark((function e(){var t,r,n;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this._wallet)){e.next=22;break}return this._wallet=null,this._publicKey=null,e.prev=4,e.prev=5,e.next=8,t.disconnect();case 8:n=e.sent,r=n.msg,e.next=15;break;case 12:throw e.prev=12,e.t0=e.catch(5),new A(null===e.t0||void 0===e.t0?void 0:e.t0.message,e.t0);case 15:if("ok"===r){e.next=17;break}throw new A(r);case 17:e.next=22;break;case 19:e.prev=19,e.t1=e.catch(4),this.emit("error",e.t1);case 22:this.emit("disconnect");case 23:case"end":return e.stop()}}),e,this,[[4,19],[5,12]])})));return function(){return e.apply(this,arguments)}}()},{key:"signTransaction",value:function(){var e=(0,l.Z)((0,c.Z)().mark((function e(t){var r,n,i,a,s,u,l;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r=this._wallet){e.next=4;break}throw new T;case 4:return e.prev=4,n=G.encode(t.serializeMessage()),e.next=8,r.signTransaction(n);case 8:if(i=e.sent,a=i.msg,(s=i.data).publicKey&&s.signature){e.next=13;break}throw new P(a);case 13:return u=new o.PublicKey(s.publicKey),l=G.decode(s.signature),t.addSignature(u,l),e.abrupt("return",t);case 19:if(e.prev=19,e.t0=e.catch(4),!(e.t0 instanceof v)){e.next=23;break}throw e.t0;case 23:throw new P(null===e.t0||void 0===e.t0?void 0:e.t0.message,e.t0);case 24:e.next=30;break;case 26:throw e.prev=26,e.t1=e.catch(0),this.emit("error",e.t1),e.t1;case 30:case"end":return e.stop()}}),e,this,[[0,26],[4,19]])})));return function(t){return e.apply(this,arguments)}}()},{key:"signAllTransactions",value:function(){var e=(0,l.Z)((0,c.Z)().mark((function e(t){var r,n,i,a,s,u,l,h,f;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r=this._wallet){e.next=4;break}throw new T;case 4:return e.prev=4,i=t.map((function(e){return G.encode(e.serializeMessage())})),e.next=8,r.signAllTransactions(i);case 8:if(a=e.sent,s=a.msg,u=a.data,l=t.length,u.publicKey&&(null===(n=u.signatures)||void 0===n?void 0:n.length)===l){e.next=14;break}throw new P(s);case 14:for(h=new o.PublicKey(u.publicKey),f=0;f<l;f++)t[f].addSignature(h,G.decode(u.signatures[f]));return e.abrupt("return",t);case 19:if(e.prev=19,e.t0=e.catch(4),!(e.t0 instanceof v)){e.next=23;break}throw e.t0;case 23:throw new P(null===e.t0||void 0===e.t0?void 0:e.t0.message,e.t0);case 24:e.next=30;break;case 26:throw e.prev=26,e.t1=e.catch(0),this.emit("error",e.t1),e.t1;case 30:case"end":return e.stop()}}),e,this,[[0,26],[4,19]])})));return function(t){return e.apply(this,arguments)}}()},{key:"signMessage",value:function(){var e=(0,l.Z)((0,c.Z)().mark((function e(t){var r,n;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r=this._wallet){e.next=4;break}throw new T;case 4:return e.prev=4,e.next=7,r.signMessage(t);case 7:return n=e.sent,e.abrupt("return",G.decode(n.data.signature));case 11:throw e.prev=11,e.t0=e.catch(4),new I(null===e.t0||void 0===e.t0?void 0:e.t0.message,e.t0);case 14:e.next=20;break;case 16:throw e.prev=16,e.t1=e.catch(0),this.emit("error",e.t1),e.t1;case 20:case"end":return e.stop()}}),e,this,[[0,16],[4,11]])})));return function(t){return e.apply(this,arguments)}}()}]),r}(Z),q=function(e){(0,d.Z)(n,e);var t=(0,p.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,h.Z)(this,n),(e=t.call(this)).name="Solflare",e.url="https://solflare.com",e.icon="data:image/svg+xml;base64,PHN2ZyBmaWxsPSJub25lIiBoZWlnaHQ9IjUwIiB2aWV3Qm94PSIwIDAgNTAgNTAiIHdpZHRoPSI1MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+PGxpbmVhckdyYWRpZW50IGlkPSJhIj48c3RvcCBvZmZzZXQ9IjAiIHN0b3AtY29sb3I9IiNmZmMxMGIiLz48c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiNmYjNmMmUiLz48L2xpbmVhckdyYWRpZW50PjxsaW5lYXJHcmFkaWVudCBpZD0iYiIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiIHgxPSI2LjQ3ODM1IiB4Mj0iMzQuOTEwNyIgeGxpbms6aHJlZj0iI2EiIHkxPSI3LjkyIiB5Mj0iMzMuNjU5MyIvPjxyYWRpYWxHcmFkaWVudCBpZD0iYyIgY3g9IjAiIGN5PSIwIiBncmFkaWVudFRyYW5zZm9ybT0ibWF0cml4KDQuOTkyMTg4MzIgMTIuMDYzODc5NjMgLTEyLjE4MTEzNjU1IDUuMDQwNzEwNzQgMjIuNTIwMiAyMC42MTgzKSIgZ3JhZGllbnRVbml0cz0idXNlclNwYWNlT25Vc2UiIHI9IjEiIHhsaW5rOmhyZWY9IiNhIi8+PHBhdGggZD0ibTI1LjE3MDggNDcuOTEwNGMuNTI1IDAgLjk1MDcuNDIxLjk1MDcuOTQwM3MtLjQyNTcuOTQwMi0uOTUwNy45NDAyLS45NTA3LS40MjA5LS45NTA3LS45NDAyLjQyNTctLjk0MDMuOTUwNy0uOTQwM3ptLTEuMDMyOC00NC45MTU2NWMuNDY0Ni4wMzgzNi44Mzk4LjM5MDQuOTAyNy44NDY4MWwxLjEzMDcgOC4yMTU3NGMuMzc5OCAyLjcxNDMgMy42NTM1IDMuODkwNCA1LjY3NDMgMi4wNDU5bDExLjMyOTEtMTAuMzExNThjLjI3MzMtLjI0ODczLjY5ODktLjIzMTQ5Ljk1MDcuMDM4NTEuMjMwOS4yNDc3Mi4yMzc5LjYyNjk3LjAxNjEuODgyNzdsLTkuODc5MSAxMS4zOTU4Yy0xLjgxODcgMi4wOTQyLS40NzY4IDUuMzY0MyAyLjI5NTYgNS41OTc4bDguNzE2OC44NDAzYy40MzQxLjA0MTguNzUxNy40MjM0LjcwOTMuODUyNC0uMDM0OS4zNTM3LS4zMDc0LjYzOTUtLjY2MjguNjk0OWwtOS4xNTk0IDEuNDMwMmMtMi42NTkzLjM2MjUtMy44NjM2IDMuNTExNy0yLjEzMzkgNS41NTc2bDMuMjIgMy43OTYxYy4yNTk0LjMwNTguMjE4OC43NjE1LS4wOTA4IDEuMDE3OC0uMjYyMi4yMTcyLS42NDE5LjIyNTYtLjkxMzguMDIwM2wtMy45Njk0LTIuOTk3OGMtMi4xNDIxLTEuNjEwOS01LjIyOTctLjI0MTctNS40NTYxIDIuNDI0M2wtLjg3NDcgMTAuMzk3NmMtLjAzNjIuNDI5NS0uNDE3OC43NDg3LS44NTI1LjcxMy0uMzY5LS4wMzAzLS42NjcxLS4zMDk3LS43MTcxLS42NzIxbC0xLjM4NzEtMTAuMDQzN2MtLjM3MTctMi43MTQ0LTMuNjQ1NC0zLjg5MDQtNS42NzQzLTIuMDQ1OWwtMTIuMDUxOTUgMTAuOTc0Yy0uMjQ5NDcuMjI3MS0uNjM4MDkuMjExNC0uODY4LS4wMzUtLjIxMDk0LS4yMjYyLS4yMTczNS0uNTcyNC0uMDE0OTMtLjgwNmwxMC41MTgxOC0xMi4xMzg1YzEuODE4Ny0yLjA5NDIuNDg0OS01LjM2NDQtMi4yODc2LTUuNTk3OGwtOC43MTg3Mi0uODQwNWMtLjQzNDEzLS4wNDE4LS43NTE3Mi0uNDIzNS0uNzA5MzYtLjg1MjQuMDM0OTMtLjM1MzcuMzA3MzktLjYzOTQuNjYyNy0uNjk1bDkuMTUzMzgtMS40Mjk5YzIuNjU5NC0uMzYyNSAzLjg3MTgtMy41MTE3IDIuMTQyMS01LjU1NzZsLTIuMTkyLTIuNTg0MWMtLjMyMTctLjM3OTItLjI3MTMtLjk0NDMuMTEyNi0xLjI2MjEuMzI1My0uMjY5NC43OTYzLS4yNzk3IDEuMTMzNC0uMDI0OWwyLjY5MTggMi4wMzQ3YzIuMTQyMSAxLjYxMDkgNS4yMjk3LjI0MTcgNS40NTYxLTIuNDI0M2wuNzI0MS04LjU1OTk4Yy4wNDU3LS41NDA4LjUyNjUtLjk0MjU3IDEuMDczOS0uODk3Mzd6bS0yMy4xODczMyAyMC40Mzk2NWMuNTI1MDQgMCAuOTUwNjcuNDIxLjk1MDY3Ljk0MDNzLS40MjU2My45NDAzLS45NTA2Ny45NDAzYy0uNTI1MDQxIDAtLjk1MDY3LS40MjEtLjk1MDY3LS45NDAzcy40MjU2MjktLjk0MDMuOTUwNjctLjk0MDN6bTQ3LjY3OTczLS45NTQ3Yy41MjUgMCAuOTUwNy40MjEuOTUwNy45NDAzcy0uNDI1Ny45NDAyLS45NTA3Ljk0MDItLjk1MDctLjQyMDktLjk1MDctLjk0MDIuNDI1Ny0uOTQwMy45NTA3LS45NDAzem0tMjQuNjI5Ni0yMi40Nzk3Yy41MjUgMCAuOTUwNi40MjA5NzMuOTUwNi45NDAyNyAwIC41MTkzLS40MjU2Ljk0MDI3LS45NTA2Ljk0MDI3LS41MjUxIDAtLjk1MDctLjQyMDk3LS45NTA3LS45NDAyNyAwLS41MTkyOTcuNDI1Ni0uOTQwMjcuOTUwNy0uOTQwMjd6IiBmaWxsPSJ1cmwoI2IpIi8+PHBhdGggZD0ibTI0LjU3MSAzMi43NzkyYzQuOTU5NiAwIDguOTgwMi0zLjk3NjUgOC45ODAyLTguODgxOSAwLTQuOTA1My00LjAyMDYtOC44ODE5LTguOTgwMi04Ljg4MTlzLTguOTgwMiAzLjk3NjYtOC45ODAyIDguODgxOWMwIDQuOTA1NCA0LjAyMDYgOC44ODE5IDguOTgwMiA4Ljg4MTl6IiBmaWxsPSJ1cmwoI2MpIi8+PC9zdmc+",e.supportedTransactionVersions=new Set(["legacy",0]),e._readyState="undefined"===typeof window||"undefined"===typeof document?a.Unsupported:a.Loadable,e._disconnected=function(){var t=e._wallet;t&&(t.off("disconnect",e._disconnected),e._wallet=null,e._publicKey=null,e.emit("error",new k),e.emit("disconnect"))},e._accountChanged=function(t){if(t){var r=e._publicKey;if(r){try{t=new o.PublicKey(t.toBytes())}catch(n){return void e.emit("error",new S(null===n||void 0===n?void 0:n.message,n))}r.equals(t)||(e._publicKey=t,e.emit("connect",t))}}},e._connecting=!1,e._publicKey=null,e._wallet=null,e._config=r,e._readyState!==a.Unsupported&&L((function(){var t;return!!(null!==(t=window.solflare)&&void 0!==t&&t.isSolflare||window.SolflareApp)&&(e._readyState=a.Installed,e.emit("readyStateChange",e._readyState),!0)})),e}return(0,f.Z)(n,[{key:"publicKey",get:function(){return this._publicKey}},{key:"connecting",get:function(){return this._connecting}},{key:"connected",get:function(){var e;return!(null===(e=this._wallet)||void 0===e||!e.connected)}},{key:"readyState",get:function(){return this._readyState}},{key:"autoConnect",value:function(){var e=(0,l.Z)((0,c.Z)().mark((function e(){return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.readyState===a.Loadable&&O()){e.next=3;break}return e.next=3,this.connect();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"connect",value:function(){var e=(0,l.Z)((0,c.Z)().mark((function e(){var t,n,i,s,u;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!this.connected&&!this.connecting){e.next=3;break}return e.abrupt("return");case 3:if(this._readyState===a.Loadable||this._readyState===a.Installed){e.next=5;break}throw new _;case 5:if(this.readyState!==a.Loadable||!O()){e.next=10;break}return t=encodeURIComponent(window.location.href),n=encodeURIComponent(window.location.origin),window.location.href="https://solflare.com/ul/v1/browse/".concat(t,"?ref=").concat(n),e.abrupt("return");case 10:return e.prev=10,e.next=13,r.e(59).then(r.bind(r,7059));case 13:i=e.sent.default,e.next=19;break;case 16:throw e.prev=16,e.t0=e.catch(10),new b(null===e.t0||void 0===e.t0?void 0:e.t0.message,e.t0);case 19:e.prev=19,s=new i({network:this._config.network}),e.next=26;break;case 23:throw e.prev=23,e.t1=e.catch(19),new x(null===e.t1||void 0===e.t1?void 0:e.t1.message,e.t1);case 26:if(this._connecting=!0,s.connected){e.next=36;break}return e.prev=28,e.next=31,s.connect();case 31:e.next=36;break;case 33:throw e.prev=33,e.t2=e.catch(28),new w(null===e.t2||void 0===e.t2?void 0:e.t2.message,e.t2);case 36:if(s.publicKey){e.next=38;break}throw new w;case 38:e.prev=38,u=new o.PublicKey(s.publicKey.toBytes()),e.next=45;break;case 42:throw e.prev=42,e.t3=e.catch(38),new S(null===e.t3||void 0===e.t3?void 0:e.t3.message,e.t3);case 45:s.on("disconnect",this._disconnected),s.on("accountChanged",this._accountChanged),this._wallet=s,this._publicKey=u,this.emit("connect",u),e.next=56;break;case 52:throw e.prev=52,e.t4=e.catch(0),this.emit("error",e.t4),e.t4;case 56:return e.prev=56,this._connecting=!1,e.finish(56);case 59:case"end":return e.stop()}}),e,this,[[0,52,56,59],[10,16],[19,23],[28,33],[38,42]])})));return function(){return e.apply(this,arguments)}}()},{key:"disconnect",value:function(){var e=(0,l.Z)((0,c.Z)().mark((function e(){var t;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this._wallet)){e.next=14;break}return t.off("disconnect",this._disconnected),t.off("accountChanged",this._accountChanged),this._wallet=null,this._publicKey=null,e.prev=6,e.next=9,t.disconnect();case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(6),this.emit("error",new A(null===e.t0||void 0===e.t0?void 0:e.t0.message,e.t0));case 14:this.emit("disconnect");case 15:case"end":return e.stop()}}),e,this,[[6,11]])})));return function(){return e.apply(this,arguments)}}()},{key:"signTransaction",value:function(){var e=(0,l.Z)((0,c.Z)().mark((function e(t){var r;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r=this._wallet){e.next=4;break}throw new T;case 4:return e.prev=4,e.next=7,r.signTransaction(t);case 7:if(e.t0=e.sent,e.t0){e.next=10;break}e.t0=t;case 10:return e.abrupt("return",e.t0);case 13:throw e.prev=13,e.t1=e.catch(4),new P(null===e.t1||void 0===e.t1?void 0:e.t1.message,e.t1);case 16:e.next=22;break;case 18:throw e.prev=18,e.t2=e.catch(0),this.emit("error",e.t2),e.t2;case 22:case"end":return e.stop()}}),e,this,[[0,18],[4,13]])})));return function(t){return e.apply(this,arguments)}}()},{key:"signAllTransactions",value:function(){var e=(0,l.Z)((0,c.Z)().mark((function e(t){var r;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r=this._wallet){e.next=4;break}throw new T;case 4:return e.prev=4,e.next=7,r.signAllTransactions(t);case 7:if(e.t0=e.sent,e.t0){e.next=10;break}e.t0=t;case 10:return e.abrupt("return",e.t0);case 13:throw e.prev=13,e.t1=e.catch(4),new P(null===e.t1||void 0===e.t1?void 0:e.t1.message,e.t1);case 16:e.next=22;break;case 18:throw e.prev=18,e.t2=e.catch(0),this.emit("error",e.t2),e.t2;case 22:case"end":return e.stop()}}),e,this,[[0,18],[4,13]])})));return function(t){return e.apply(this,arguments)}}()},{key:"signMessage",value:function(){var e=(0,l.Z)((0,c.Z)().mark((function e(t){var r;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r=this._wallet){e.next=4;break}throw new T;case 4:return e.prev=4,e.next=7,r.signMessage(t,"utf8");case 7:return e.abrupt("return",e.sent);case 10:throw e.prev=10,e.t0=e.catch(4),new I(null===e.t0||void 0===e.t0?void 0:e.t0.message,e.t0);case 13:e.next=19;break;case 15:throw e.prev=15,e.t1=e.catch(0),this.emit("error",e.t1),e.t1;case 19:case"end":return e.stop()}}),e,this,[[0,15],[4,10]])})));return function(t){return e.apply(this,arguments)}}()}]),n}(Z),Y=["signers"],X=function(e){(0,d.Z)(n,e);var t=(0,p.Z)(n);function n(){var e,r=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{params:{showTorusButton:!1}}).params,i=void 0===r?{showTorusButton:!1}:r;return(0,h.Z)(this,n),(e=t.call(this)).name="Torus",e.url="https://tor.us",e.icon="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzMiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMyAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iMTYuNSIgY3k9IjE2IiByPSIxNiIgZmlsbD0iIzAzNjRGRiIvPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTExLjIxODYgOS40OTIxOUMxMC40NTM5IDkuNDkyMTkgOS44MzM5OCAxMC4xMTIxIDkuODMzOTggMTAuODc2OFYxMi40ODk4QzkuODMzOTggMTMuMjU0NSAxMC40NTM5IDEzLjg3NDQgMTEuMjE4NiAxMy44NzQ0SDEzLjY2ODRWMjIuODk3NkMxMy42Njg0IDIzLjY2MjMgMTQuMjg4MyAyNC4yODIyIDE1LjA1MyAyNC4yODIySDE2LjY2NkMxNy40MzA3IDI0LjI4MjIgMTguMDUwNiAyMy42NjIzIDE4LjA1MDYgMjIuODk3NlYxMi41MDE1QzE4LjA1MDYgMTIuNDk3NiAxOC4wNTA2IDEyLjQ5MzcgMTguMDUwNiAxMi40ODk4VjEwLjg3NjhDMTguMDUwNiAxMC4xMTIxIDE3LjQzMDcgOS40OTIxOSAxNi42NjYgOS40OTIxOUgxNS4wNTNIMTEuMjE4NloiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGQ9Ik0yMS4zMzc2IDEzLjg3NDRDMjIuNTQ3NyAxMy44NzQ0IDIzLjUyODcgMTIuODkzNCAyMy41Mjg3IDExLjY4MzNDMjMuNTI4NyAxMC40NzMyIDIyLjU0NzcgOS40OTIxOSAyMS4zMzc2IDkuNDkyMTlDMjAuMTI3NSA5LjQ5MjE5IDE5LjE0NjUgMTAuNDczMiAxOS4xNDY1IDExLjY4MzNDMTkuMTQ2NSAxMi44OTM0IDIwLjEyNzUgMTMuODc0NCAyMS4zMzc2IDEzLjg3NDRaIiBmaWxsPSJ3aGl0ZSIvPgo8L3N2Zz4K",e.supportedTransactionVersions=null,e._readyState="undefined"===typeof window||"undefined"===typeof document?a.Unsupported:a.Loadable,e._connecting=!1,e._wallet=null,e._publicKey=null,e._params=i,e}return(0,f.Z)(n,[{key:"publicKey",get:function(){return this._publicKey}},{key:"connecting",get:function(){return this._connecting}},{key:"connected",get:function(){var e;return!(null===(e=this._wallet)||void 0===e||!e.isLoggedIn)}},{key:"readyState",get:function(){return this._readyState}},{key:"connect",value:function(){var e=(0,l.Z)((0,c.Z)().mark((function e(){var t,n,i,s;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!this.connected&&!this.connecting){e.next=3;break}return e.abrupt("return");case 3:if(this._readyState===a.Loadable){e.next=5;break}throw new _;case 5:return this._connecting=!0,e.prev=6,e.next=9,Promise.all([r.e(724),r.e(997)]).then(r.bind(r,3724));case 9:t=e.sent.default,e.next=15;break;case 12:throw e.prev=12,e.t0=e.catch(6),new b(null===e.t0||void 0===e.t0?void 0:e.t0.message,e.t0);case 15:e.prev=15,n=window.torus||new t,e.next=22;break;case 19:throw e.prev=19,e.t1=e.catch(15),new x(null===e.t1||void 0===e.t1?void 0:e.t1.message,e.t1);case 22:if(n.isInitialized){e.next=31;break}return e.prev=23,e.next=26,n.init(this._params);case 26:e.next=31;break;case 28:throw e.prev=28,e.t2=e.catch(23),new w(null===e.t2||void 0===e.t2?void 0:e.t2.message,e.t2);case 31:return e.prev=31,e.next=34,n.login();case 34:i=e.sent,e.next=40;break;case 37:throw e.prev=37,e.t3=e.catch(31),new E(null===e.t3||void 0===e.t3?void 0:e.t3.message,e.t3);case 40:e.prev=40,s=new o.PublicKey(i[0]),e.next=47;break;case 44:throw e.prev=44,e.t4=e.catch(40),new S(null===e.t4||void 0===e.t4?void 0:e.t4.message,e.t4);case 47:this._wallet=n,this._publicKey=s,this.emit("connect",s),e.next=56;break;case 52:throw e.prev=52,e.t5=e.catch(0),this.emit("error",e.t5),e.t5;case 56:return e.prev=56,this._connecting=!1,e.finish(56);case 59:case"end":return e.stop()}}),e,this,[[0,52,56,59],[6,12],[15,19],[23,28],[31,37],[40,44]])})));return function(){return e.apply(this,arguments)}}()},{key:"disconnect",value:function(){var e=(0,l.Z)((0,c.Z)().mark((function e(){var t;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this._wallet)){e.next=13;break}if(this._wallet=null,this._publicKey=null,e.prev=4,!t.isLoggedIn){e.next=8;break}return e.next=8,t.cleanUp();case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(4),this.emit("error",new A(null===e.t0||void 0===e.t0?void 0:e.t0.message,e.t0));case 13:this.emit("disconnect");case 14:case"end":return e.stop()}}),e,this,[[4,10]])})));return function(){return e.apply(this,arguments)}}()},{key:"sendTransaction",value:function(){var e=(0,l.Z)((0,c.Z)().mark((function e(t,r){var n,i,o,a,l,h,f,d=arguments;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=d.length>2&&void 0!==d[2]?d[2]:{},e.prev=1,i=this._wallet){e.next=5;break}throw new T;case 5:return e.prev=5,a=n.signers,l=(0,u.Z)(n,Y),e.next=9,this.prepareTransaction(t,r,l);case 9:return t=e.sent,(null===a||void 0===a?void 0:a.length)&&(o=t).partialSign.apply(o,(0,s.Z)(a)),l.preflightCommitment=l.preflightCommitment||r.commitment,e.next=14,i.signAndSendTransaction(t,l);case 14:return h=e.sent,f=h.signature,e.abrupt("return",f);case 19:if(e.prev=19,e.t0=e.catch(5),!(e.t0 instanceof v)){e.next=23;break}throw e.t0;case 23:throw new M(null===e.t0||void 0===e.t0?void 0:e.t0.message,e.t0);case 24:e.next=30;break;case 26:throw e.prev=26,e.t1=e.catch(1),this.emit("error",e.t1),e.t1;case 30:case"end":return e.stop()}}),e,this,[[1,26],[5,19]])})));return function(t,r){return e.apply(this,arguments)}}()},{key:"signTransaction",value:function(){var e=(0,l.Z)((0,c.Z)().mark((function e(t){var r;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r=this._wallet){e.next=4;break}throw new T;case 4:return e.prev=4,e.next=7,r.signTransaction(t);case 7:if(e.t0=e.sent,e.t0){e.next=10;break}e.t0=t;case 10:return e.abrupt("return",e.t0);case 13:throw e.prev=13,e.t1=e.catch(4),new P(null===e.t1||void 0===e.t1?void 0:e.t1.message,e.t1);case 16:e.next=22;break;case 18:throw e.prev=18,e.t2=e.catch(0),this.emit("error",e.t2),e.t2;case 22:case"end":return e.stop()}}),e,this,[[0,18],[4,13]])})));return function(t){return e.apply(this,arguments)}}()},{key:"signAllTransactions",value:function(){var e=(0,l.Z)((0,c.Z)().mark((function e(t){var r;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r=this._wallet){e.next=4;break}throw new T;case 4:return e.prev=4,e.next=7,r.signAllTransactions(t);case 7:if(e.t0=e.sent,e.t0){e.next=10;break}e.t0=t;case 10:return e.abrupt("return",e.t0);case 13:throw e.prev=13,e.t1=e.catch(4),new P(null===e.t1||void 0===e.t1?void 0:e.t1.message,e.t1);case 16:e.next=22;break;case 18:throw e.prev=18,e.t2=e.catch(0),this.emit("error",e.t2),e.t2;case 22:case"end":return e.stop()}}),e,this,[[0,18],[4,13]])})));return function(t){return e.apply(this,arguments)}}()},{key:"signMessage",value:function(){var e=(0,l.Z)((0,c.Z)().mark((function e(t){var r;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r=this._wallet){e.next=4;break}throw new T;case 4:return e.prev=4,e.next=7,r.signMessage(t);case 7:return e.abrupt("return",e.sent);case 10:throw e.prev=10,e.t0=e.catch(4),new I(null===e.t0||void 0===e.t0?void 0:e.t0.message,e.t0);case 13:e.next=19;break;case 15:throw e.prev=15,e.t1=e.catch(0),this.emit("error",e.t1),e.t1;case 19:case"end":return e.stop()}}),e,this,[[0,15],[4,10]])})));return function(t){return e.apply(this,arguments)}}()}]),n}(Z),Q=r(670),$=r(9778).Buffer;var J=1<<31>>>0;function ee(e){return(e|J)>>>0}var te=5,re=6,ne=0,ie=1,oe=1,ae=2,se=255,ue=224;function ce(e,t){return le.apply(this,arguments)}function le(){return(le=(0,l.Z)((0,c.Z)().mark((function e(t,r){var n;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,de(t,te,ne,r);case 2:return n=e.sent,e.abrupt("return",new o.PublicKey(n));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function he(e,t,r){return fe.apply(this,arguments)}function fe(){return(fe=(0,l.Z)((0,c.Z)().mark((function e(t,r,n){var i,o,a;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(i=$.alloc(1)).writeUInt8(1,0),o=z(r)?r.message.serialize():r.serializeMessage(),a=$.concat([i,n,o]),e.next=6,de(t,re,ie,a);case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function de(e,t,r,n){return pe.apply(this,arguments)}function pe(){return pe=(0,l.Z)((0,c.Z)().mark((function e(t,r,n,i){var o,a,s,u,l;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=0,a=0,!(i.length>se)){e.next=14;break}case 3:if(!(i.length-a>se)){e.next=14;break}return s=i.slice(a,a+se),e.next=7,t.send(ue,r,n,o|ae,s);case 7:if(2===e.sent.length){e.next=10;break}throw new Q.rZ(Q.WC.INCORRECT_DATA);case 10:o|=oe,a+=se,e.next=3;break;case 14:return u=i.slice(a),e.next=17,t.send(ue,r,n,o,u);case 17:return l=e.sent,e.abrupt("return",l.slice(0,l.length-2));case 19:case"end":return e.stop()}}),e)}))),pe.apply(this,arguments)}var me=function(e){(0,d.Z)(n,e);var t=(0,p.Z)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,h.Z)(this,n),(e=t.call(this)).name="Ledger",e.url="https://ledger.com",e.icon="data:image/svg+xml;base64,PHN2ZyB2aWV3Qm94PSIwIDAgMzUgMzUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsbD0iI2ZmZiI+PHBhdGggZD0ibTIzLjU4OCAwaC0xNnYyMS41ODNoMjEuNnYtMTZhNS41ODUgNS41ODUgMCAwIDAgLTUuNi01LjU4M3oiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDUuNzM5KSIvPjxwYXRoIGQ9Im04LjM0MiAwaC0yLjc1N2E1LjU4NSA1LjU4NSAwIDAgMCAtNS41ODUgNS41ODV2Mi43NTdoOC4zNDJ6Ii8+PHBhdGggZD0ibTAgNy41OWg4LjM0MnY4LjM0MmgtOC4zNDJ6IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwIDUuNzM5KSIvPjxwYXRoIGQ9Im0xNS4xOCAyMy40NTFoMi43NTdhNS41ODUgNS41ODUgMCAwIDAgNS41ODUtNS42di0yLjY3MWgtOC4zNDJ6IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxMS40NzggMTEuNDc4KSIvPjxwYXRoIGQ9Im03LjU5IDE1LjE4aDguMzQydjguMzQyaC04LjM0MnoiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDUuNzM5IDExLjQ3OCkiLz48cGF0aCBkPSJtMCAxNS4xOHYyLjc1N2E1LjU4NSA1LjU4NSAwIDAgMCA1LjU4NSA1LjU4NWgyLjc1N3YtOC4zNDJ6IiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgwIDExLjQ3OCkiLz48L2c+PC9zdmc+",e.supportedTransactionVersions=new Set(["legacy",0]),e._readyState="undefined"!==typeof window&&"undefined"!==typeof document&&"undefined"!==typeof navigator&&navigator.hid?a.Loadable:a.Unsupported,e._disconnected=function(){var t=e._transport;t&&(t.off("disconnect",e._disconnected),e._transport=null,e._publicKey=null,e.emit("error",new k),e.emit("disconnect"))},e._derivationPath=r.derivationPath||function(e,t){var r=void 0!==e?void 0===t?3:4:2,n=$.alloc(1+4*r),i=n.writeUInt8(r,0);return i=n.writeUInt32BE(ee(44),i),i=n.writeUInt32BE(ee(501),i),void 0!==e&&(i=n.writeUInt32BE(ee(e),i),void 0!==t&&n.writeUInt32BE(ee(t),i)),n}(0,0),e._connecting=!1,e._transport=null,e._publicKey=null,e}return(0,f.Z)(n,[{key:"publicKey",get:function(){return this._publicKey}},{key:"connecting",get:function(){return this._connecting}},{key:"readyState",get:function(){return this._readyState}},{key:"connect",value:function(){var e=(0,l.Z)((0,c.Z)().mark((function e(){var t,n,i;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!this.connected&&!this.connecting){e.next=3;break}return e.abrupt("return");case 3:if(this._readyState===a.Loadable){e.next=5;break}throw new _;case 5:return this._connecting=!0,e.prev=6,e.next=9,r.e(126).then(r.bind(r,4126));case 9:t=e.sent.default,e.next=15;break;case 12:throw e.prev=12,e.t0=e.catch(6),new b(null===e.t0||void 0===e.t0?void 0:e.t0.message,e.t0);case 15:return e.prev=15,e.next=18,t.create();case 18:n=e.sent,e.next=24;break;case 21:throw e.prev=21,e.t1=e.catch(15),new w(null===e.t1||void 0===e.t1?void 0:e.t1.message,e.t1);case 24:return e.prev=24,e.next=27,ce(n,this._derivationPath);case 27:i=e.sent,e.next=33;break;case 30:throw e.prev=30,e.t2=e.catch(24),new S(null===e.t2||void 0===e.t2?void 0:e.t2.message,e.t2);case 33:n.on("disconnect",this._disconnected),this._transport=n,this._publicKey=i,this.emit("connect",i),e.next=43;break;case 39:throw e.prev=39,e.t3=e.catch(0),this.emit("error",e.t3),e.t3;case 43:return e.prev=43,this._connecting=!1,e.finish(43);case 46:case"end":return e.stop()}}),e,this,[[0,39,43,46],[6,12],[15,21],[24,30]])})));return function(){return e.apply(this,arguments)}}()},{key:"disconnect",value:function(){var e=(0,l.Z)((0,c.Z)().mark((function e(){var t;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this._transport)){e.next=13;break}return t.off("disconnect",this._disconnected),this._transport=null,this._publicKey=null,e.prev=5,e.next=8,t.close();case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(5),this.emit("error",new A(null===e.t0||void 0===e.t0?void 0:e.t0.message,e.t0));case 13:this.emit("disconnect");case 14:case"end":return e.stop()}}),e,this,[[5,10]])})));return function(){return e.apply(this,arguments)}}()},{key:"signTransaction",value:function(){var e=(0,l.Z)((0,c.Z)().mark((function e(t){var r,n,i;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r=this._transport,n=this._publicKey,r&&n){e.next=5;break}throw new T;case 5:return e.prev=5,e.next=8,he(r,t,this._derivationPath);case 8:i=e.sent,t.addSignature(n,i),e.next=15;break;case 12:throw e.prev=12,e.t0=e.catch(5),new P(null===e.t0||void 0===e.t0?void 0:e.t0.message,e.t0);case 15:return e.abrupt("return",t);case 18:throw e.prev=18,e.t1=e.catch(0),this.emit("error",e.t1),e.t1;case 22:case"end":return e.stop()}}),e,this,[[0,18],[5,12]])})));return function(t){return e.apply(this,arguments)}}()}]),n}(U),ge=function(t){(0,d.Z)(i,t);var n=(0,p.Z)(i);function i(){var t,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=r.provider,s=r.network,u=void 0===s?e.Mainnet:s,c=r.timeout,l=void 0===c?1e4:c;return(0,h.Z)(this,i),(t=n.call(this)).supportedTransactionVersions=null,t._readyState="undefined"===typeof window||"undefined"===typeof document?a.Unsupported:a.NotDetected,t._disconnected=function(){var e=t._wallet;e&&(e.off("disconnect",t._disconnected),t._wallet=null,t._publicKey=null,t.emit("error",new k),t.emit("disconnect"))},t._provider=o,t._network=u,t._timeout=l,t._connecting=!1,t._wallet=null,t._publicKey=null,t._readyState!==a.Unsupported&&("string"===typeof t._provider?t._readyState=a.Loadable:L((function(){var e;return"function"===typeof(null===(e=window.sollet)||void 0===e?void 0:e.postMessage)&&(t._readyState=a.Installed,t.emit("readyStateChange",t._readyState),!0)}))),t}return(0,f.Z)(i,[{key:"publicKey",get:function(){return this._publicKey}},{key:"connecting",get:function(){return this._connecting}},{key:"connected",get:function(){var e;return!(null===(e=this._wallet)||void 0===e||!e.connected)}},{key:"readyState",get:function(){return this._readyState}},{key:"connect",value:function(){var e=(0,l.Z)((0,c.Z)().mark((function e(){var t,n,i,s,u,l,h,f=this;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!this.connected&&!this.connecting){e.next=3;break}return e.abrupt("return");case 3:if(this._readyState===a.Loadable||this._readyState===a.Installed){e.next=5;break}throw new _;case 5:return this._connecting=!0,t=this._provider||window.sollet,e.prev=7,e.next=10,r.e(608).then(r.bind(r,8608));case 10:n=e.sent.default,e.next=16;break;case 13:throw e.prev=13,e.t0=e.catch(7),new b(null===e.t0||void 0===e.t0?void 0:e.t0.message,e.t0);case 16:e.prev=16,i=new n(t,this._network),e.next=23;break;case 20:throw e.prev=20,e.t1=e.catch(16),new x(null===e.t1||void 0===e.t1?void 0:e.t1.message,e.t1);case 23:return e.prev=23,s=i.handleDisconnect,e.prev=25,e.next=28,new Promise((function(e,r){var n=function t(){u&&clearTimeout(u),i.off("connect",t),e()};if(i.handleDisconnect=function(){i.off("connect",n),r(new D);for(var e=arguments.length,t=new Array(e),o=0;o<e;o++)t[o]=arguments[o];return s.apply(i,t)},i.on("connect",n),i.connect().catch((function(e){i.off("connect",n),r(e)})),"string"===typeof t){var o=0;l=setInterval((function(){var e=i._popup;e?e.closed&&r(new D):o>50&&r(new B),o++}),100)}else u=setTimeout((function(){return r(new C)}),f._timeout)}));case 28:return e.prev=28,i.handleDisconnect=s,l&&clearInterval(l),e.finish(28);case 32:e.next=39;break;case 34:if(e.prev=34,e.t2=e.catch(23),!(e.t2 instanceof v)){e.next=38;break}throw e.t2;case 38:throw new w(null===e.t2||void 0===e.t2?void 0:e.t2.message,e.t2);case 39:if(i.publicKey){e.next=41;break}throw new E;case 41:e.prev=41,h=new o.PublicKey(i.publicKey.toBytes()),e.next=48;break;case 45:throw e.prev=45,e.t3=e.catch(41),new S(null===e.t3||void 0===e.t3?void 0:e.t3.message,e.t3);case 48:i.on("disconnect",this._disconnected),this._wallet=i,this._publicKey=h,this.emit("connect",h),e.next=58;break;case 54:throw e.prev=54,e.t4=e.catch(0),this.emit("error",e.t4),e.t4;case 58:return e.prev=58,this._connecting=!1,e.finish(58);case 61:case"end":return e.stop()}}),e,this,[[0,54,58,61],[7,13],[16,20],[23,34],[25,,28,32],[41,45]])})));return function(){return e.apply(this,arguments)}}()},{key:"disconnect",value:function(){var e=(0,l.Z)((0,c.Z)().mark((function e(){var t,r;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this._wallet)){e.next=17;break}return t.off("disconnect",this._disconnected),this._wallet=null,this._publicKey=null,r=t.handleDisconnect,e.prev=6,e.next=9,new Promise((function(e,n){var i=setTimeout((function(){return e()}),250);t.handleDisconnect=function(){clearTimeout(i),e(),t._responsePromises=new Map;for(var n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return r.apply(t,o)},t.disconnect().then((function(){clearTimeout(i),e()}),(function(t){clearTimeout(i),"Wallet disconnected"===(null===t||void 0===t?void 0:t.message)?e():n(t)}))}));case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(6),this.emit("error",new A(null===e.t0||void 0===e.t0?void 0:e.t0.message,e.t0));case 14:return e.prev=14,t.handleDisconnect=r,e.finish(14);case 17:this.emit("disconnect");case 18:case"end":return e.stop()}}),e,this,[[6,11,14,17]])})));return function(){return e.apply(this,arguments)}}()},{key:"signTransaction",value:function(){var e=(0,l.Z)((0,c.Z)().mark((function e(t){var r;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r=this._wallet){e.next=4;break}throw new T;case 4:return e.prev=4,e.next=7,r.signTransaction(t);case 7:if(e.t0=e.sent,e.t0){e.next=10;break}e.t0=t;case 10:return e.abrupt("return",e.t0);case 13:throw e.prev=13,e.t1=e.catch(4),new P(null===e.t1||void 0===e.t1?void 0:e.t1.message,e.t1);case 16:e.next=22;break;case 18:throw e.prev=18,e.t2=e.catch(0),this.emit("error",e.t2),e.t2;case 22:case"end":return e.stop()}}),e,this,[[0,18],[4,13]])})));return function(t){return e.apply(this,arguments)}}()},{key:"signAllTransactions",value:function(){var e=(0,l.Z)((0,c.Z)().mark((function e(t){var r;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r=this._wallet){e.next=4;break}throw new T;case 4:return e.prev=4,e.next=7,r.signAllTransactions(t);case 7:if(e.t0=e.sent,e.t0){e.next=10;break}e.t0=t;case 10:return e.abrupt("return",e.t0);case 13:throw e.prev=13,e.t1=e.catch(4),new P(null===e.t1||void 0===e.t1?void 0:e.t1.message,e.t1);case 16:e.next=22;break;case 18:throw e.prev=18,e.t2=e.catch(0),this.emit("error",e.t2),e.t2;case 22:case"end":return e.stop()}}),e,this,[[0,18],[4,13]])})));return function(t){return e.apply(this,arguments)}}()},{key:"signMessage",value:function(){var e=(0,l.Z)((0,c.Z)().mark((function e(t){var r,n,i;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r=this._wallet){e.next=4;break}throw new T;case 4:return e.prev=4,e.next=7,r.sign(t,"utf8");case 7:return n=e.sent,i=n.signature,e.abrupt("return",Uint8Array.from(i));case 12:throw e.prev=12,e.t0=e.catch(4),new I(null===e.t0||void 0===e.t0?void 0:e.t0.message,e.t0);case 15:e.next=21;break;case 17:throw e.prev=17,e.t1=e.catch(0),this.emit("error",e.t1),e.t1;case 21:case"end":return e.stop()}}),e,this,[[0,17],[4,12]])})));return function(t){return e.apply(this,arguments)}}()}]),i}(Z),ye=["provider"],ve=function(e){(0,d.Z)(r,e);var t=(0,p.Z)(r);function r(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=n.provider,o=void 0===i?"https://www.sollet.io":i,a=(0,u.Z)(n,ye);return(0,h.Z)(this,r),(e=t.call(this,(0,V.Z)({provider:o},a))).name="Sollet",e.url="https://www.sollet.io",e.icon="data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjUzMCIgd2lkdGg9IjUzMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBkPSJtLTEtMWg1MzJ2NTMyaC01MzJ6IiBmaWxsPSJub25lIi8+PGcgZmlsbD0iIzAwZmZhMyI+PHBhdGggZD0ibTg4Ljg4OTM1IDM3Mi45ODIwMWMzLjE5My0zLjE5IDcuNTIyLTQuOTgyIDEyLjAzNS00Ljk4Mmg0MTYuNDYxYzcuNTg2IDAgMTEuMzg0IDkuMTc0IDYuMDE3IDE0LjUzNmwtODIuMjkxIDgyLjIyNmMtMy4xOTMgMy4xOTEtNy41MjIgNC45ODMtMTIuMDM2IDQuOTgzaC00MTYuNDYwMWMtNy41ODY2IDAtMTEuMzg0NS05LjE3NC02LjAxNzgtMTQuNTM3bDgyLjI5MTktODIuMjI2eiIvPjxwYXRoIGQ9Im04OC44ODkzNSA2NS45ODI1YzMuMTkzLTMuMTkwNCA3LjUyMi00Ljk4MjUgMTIuMDM1LTQuOTgyNWg0MTYuNDYxYzcuNTg2IDAgMTEuMzg0IDkuMTczOSA2LjAxNyAxNC41MzYzbC04Mi4yOTEgODIuMjI2N2MtMy4xOTMgMy4xOS03LjUyMiA0Ljk4Mi0xMi4wMzYgNC45ODJoLTQxNi40NjAxYy03LjU4NjYgMC0xMS4zODQ1LTkuMTc0LTYuMDE3OC0xNC41MzZsODIuMjkxOS04Mi4yMjY1eiIvPjxwYXRoIGQ9Im00NDEuMTExMzUgMjE5LjEwOTVjLTMuMTkzLTMuMTktNy41MjItNC45ODItMTIuMDM2LTQuOTgyaC00MTYuNDYwMWMtNy41ODY2IDAtMTEuMzg0NSA5LjE3My02LjAxNzggMTQuNTM2bDgyLjI5MTkgODIuMjI2YzMuMTkzIDMuMTkgNy41MjIgNC45ODMgMTIuMDM1IDQuOTgzaDQxNi40NjFjNy41ODYgMCAxMS4zODQtOS4xNzQgNi4wMTctMTQuNTM3eiIvPjwvZz48L3N2Zz4=",e}return(0,f.Z)(r)}(ge),_e=function(e){(0,d.Z)(r,e);var t=(0,p.Z)(r);function r(){var e;return(0,h.Z)(this,r),(e=t.apply(this,arguments)).name="Sollet (Extension)",e.url="https://chrome.google.com/webstore/detail/sollet/fhmfendgdocmcbmfikdcogofphimnkno",e.icon="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAP50lEQVR4AeyZRZIcMRBFNbQ3MzSZVqalV2ZmuJXZTWZmOoZXZjiBtwapazOU8/9MThRcoEHZEa8zVCBF6P1iN/8r1f0QcKVGGC43/AjAsv9jWLYP1MHnUsP/w/qpcj1IuWH0EnRCN3REV+psHx0CR6d0C1LXYPavjAWAdbgEdOVZdPYJtTCQtnsPo+CG7tThWXU6XCYZ59k0jGhdVKqH93qUTytIFmvvyzcgXZ3N+6NLOqXbgushV1iwHon5pZ1MoE7ZhPY7fkpdCt3Scda5y5zyF2PD76n8IMbgkIYgfKdrdT7ssHAYoBFexyHfQkDXYNY9/5iEC3rNnwRiDDSTdE3nwLm19d9DpYb/wJV2zY8AdUzndM+j/wCwiYkMOqd7BuAG0sCFdvTHwxSd0z3f/H3mQtRpVmPQSV3TPc8Af9mwlzwRoa7pngGwU3+k0L2L98OOQfcu5gkwBjoAhgXAsAAYFgDDAmBYAAwLQEWpkmYKlykWgEGBYmsK2+tueFlz3cvKa15WXPWyTFkOVmDZKqxbi23W171U0v01IBaAnqZUz0unRIpdeMnLosteVkPulnaQnXc7sudJR468SOT060TOvEnk2MtEDjxLZNfDjmy7E2RTK8gqBGLx5bn9l16ZCw5DUMuEoVS3APSAeI+aHuWUtQjSNkIixc6wdw5AsjtdGy/z+17btm3btv3+bdu2bdvXtm3b9+4YSb/zy+ap25WaSTJ3Zie7Vd1VXdnhTuU8fdTnPH3quJJ5cHHVzNpSN5tznslVfFPzfMPwfWb/317jWqr5Zm/ZN+v3eWbG5rp5bFnVnDe5bH73ZNF87LacAIUGERj0GxwAsljx3HiEwJVVjvr+7RMFc/eCaiBEhKupoT/1vGe9zkUjCpB9Zd+MX18z504qm6/em8dkoCHQNL0GggPAWywb/Yor+oVw1MiSWbC9bgmXK6u9f9Y9CTt58j7er896Akh4rdZ9M3ljzRw6rITw0Qr4F70AggOAVj2rnRX4t2eLZulOCT4QloS2HwjmwIeAxBQobK2ybp9nzppQNu+5MQCCrZUa0wFgQFQ+dv79N+XM48uqhiHhMC113u3Bd7b8f/gXp48v8xvRSnIWeewA0M2Vj63/ySOFwMYzpN4ZPtNvZ1VHZ3og6K0yFwLCsl2e+dPTRX4npgkz1SkIHAAkfLz7fz5XxAZL+LErXs9FVbhAE532a8kmRIBrDoR7Flb5zUQO0gQOAJ2u/L8/W7SctHSCl3DtlZte1QsQyUDT8wISA9+EiOH1VwsEDgBtTdvm/+jhAnG6VptufKwgPEut95V9M31TvREiVgKn7bDhJbRJAKr/vlA0x4wqBSHeLXMrZvjqmlm525OmkcloS+MIBBv7PPOBm8lCOg3QttPHqsHb5wau2eMZhr2a41a9gDJhQ80cPKw/kUOqFzOCt04EwXxFeEXD8Lwyf/zvr9yTNyeMKZlJG2oSqKXqTfPfEckf9FV888nbc8okOgC0s/pxoBAQmTxGrQ3hz9xSN798vBDk+hHwG67Zn73TfLs1o8/z/8n4AQj2Db79QME8vKRqKqFWSDQLFgA+4QDQ/up/e6j6yewx5JTFCd8L58VTy+Ty+byEe0A33879AwK0BEAgI2g7l82Gns85ABz4ti0rcOKGmlZcqkQNtv3/L9kXydV3YZMp/D6AALDOnFAOVb5A4ADQ1W3cVzVu8i8fS179tto/aWwgfDaCZEYGxCxp02nxjno/OB0AujsV9hFLy/a38rol/CeWVfmMveoHFKDE98NWSzs5AHR1vqmx0t59Y84o2+c1W/3WTSY8/NLdeex+TzJv2gC6fnbFBqgDQBdXF+neREdLUcFTy6tEC9qE6ZmGOnpUyY4IHAA6trHW6sKeR9O99rBt/8HDSoR6fLanPsovLB/FAaDL6vWGGPVq32Di8i+G6v9tPYxQSO9+5s68KVSVC3AA6MpU8uexpVbyp8lQOnhL3jPvu6n3qVZVAq0OM5SeA0B3phJAw1bJw44HwPJdXia7bfxPfBUlheqeA0BXATByTToArNjtyfPPJFS9Y35FZWLBb9Ksu1RwZwB4bmU6AGwvZLPbJl/ltPFly1dxGqBnSSC7nPsb9+VVqt3zbOVvnigEQt6W98yOwv4JMHeXfLN2r8dOpANAuyvr/MnlRADIQTxxbIltXuUBel6djAZqNd/fmK4iKP1UqTd1dS1jbKWBZWfnbK33eIUhUF3pR2g5MU0SvqsISuldI0zsJl06dp1/bDLoiBEl85KwI6gnqy39qm5b+G43MAyxRmizJWYzSNoBe0tCCO0hEAzB3j0HAISGLSe1y96+ABBXDKKIYM1ez3zhrjw+ROZ1+Q4AnWfaWMlWpi0+GpA/sKvoU+xJJEENYPpqIAeAwVkKTlGmnRJOCgmZDLqGPntnXt28qv0basJxfQF40tM3h5U3KUGg9+UrvrltXoXafJJL7DGoidOBYahUBdOGjQBzFQk4fUOI3luu+ziUmAZIItAsgAFw2SwgDgCD2RQc9EJRWiAWBFEgRLt5t+Y9c/+iqvnbM0Xz4VuCtDNmgqhDvXyDkAXEtYYhJCpxk0EQAwQ5inboOGJNzZw9sUznEU4n0YccSLss3AEge+4fNIEqhVjR6buCo70DUTBobtjn4TzSJgZfECXgAI/iDzmRWRFAuO5ggQCBoL73ltQhnKANEsBgkz4wdC3WfFrC2O2j8ocEE1P7FVkAwfEDcFWS6HN35iFykmMYEWK7DCAR7RDxG/JVP9ie/vPTRRxHNBG/J0sgOIoYagBRzWdMKEPgZAOBa+p28OaNnaYVJQw8RPARYZoAoriKeg0CRxIle4xJ+PQdeXP7/AoFml2jjPGbOJHamVTvP23lJJmIIGxt4ADQY5OAJgAIOG43zamQDrYcvKhaN8yucQPBFvbtB/LUI2g307GEZUEZF5iFEAgfvjXXcN5K1AkgrAgY0rKIJTOBMBlVL+hIJmnFVrYKUxwAsgICjprCt+8/VDBXzahgu639BF2jgNDz7WsEBhXCH7yZrWwLBA4A2QGBq+hdAcW37s8HVG7PrqhB3RIN/aIcg20nmhjUAGrvoZcgcABI6Ovnb1Q0YCCef3fIJXxaCAhSxE3AkAgE+3mBYGfRM99sgO1VNggcALIHgzTD2y02cQGC7iIqfGlJgyDKzhCmSTYJKDIHVAl/7q68tqJdUehgnG+3AME2sTaGeA1yioeWVE2ftQuZlhcIwKhYFdC92WmAoXXABKsV9U3G71N35M0V08tmT8lPtRElEFRDENw8t8L36HsdAIbawROEdVQbf/L2PCwk0cqjliXrSi3z4OePwVYmU+AAMOQiineGyaaXhYWq+YTiFD2UPwDRlTqXnAYY4qHlSy7t47gZ2r+SWUstTfH7J4uirXMAGMqpZ4pGcBR/KOra2MYVOYQGvgPK0BwAUt1sdQnFdA9JKFkAARC8+NI+ziOSqm/pC0gDoDE4kIqE1NscAJLbp7hRMZPQKjMQ2GBYsrOe2LcgEFBP8IokM+A6g5j9BNFs6lC4GZ2spHeqBzDbOkVSy/FkVpYZYE+CzySTWTkA0AtAOTeFmzSJarLVy00lhav4OrMmVopSYBS3NpliySypKnIaICUAWtCw6mbD+y8AZB4dQFMjM9BsCABzt9UxX2m+2wFgkQDg+dG8vLZedRxLpplDEjzj1qWjs2GPAcC2kxp2APD9VjdTmyxDhs9oQ58HBa4DQAcAiBzEkM+Ue0dsJmkBQK0AIaQDQIcAEAjYz8cMZOVU6SAJUr0pAEDI2PhcX6daywFAN/rfzxcpzQYAmXIYrNuXzgmk0eQ1nfktDgBWXA2TWGZx9dvD1c++gH5XQh4A6rtOIxcHADsUvNe6oVklgq6ekUxqLQ1w3OiSA0BnAMhepdrH2VEBvC2f7lALfjOElq/peFvYAUC2Fv6gHtPC9V/fGW4G0YSSxGImsM7cDJdhN36nA4DdtEkxJ1rAPihqwLeDX3SpCCuSj7OTuWLnUP5KF6qCHACkBViFrEhurjj83zYAq152+/8v3QfVTHBQhR2S+jFbwZv6PPP+LhJaOwBYQND5vKeMK1HrT/2eTg/pmPvHbjAh4UNZGC1gCFaTkbT6aVNrozDUAeDNEQAktWYJCDB8XDqtzAlimIWm3D8CRbOp17XaVQdIPd9vnyhS5m3Z/Hjhy/ZP3dSJ7Xe7gVZzZ/qz+ynVomsX7h+yheTfXwUgrIOjyeFT+s3zXHnM87z+svCsYXgGoYtha1rqPo3wpRngLfjyPW03h7iSMG7+pI01ncQRS/jAc8xW7Vz8jYkYs7aGv9BwxsrmP88X6QKiXDs4no7r754sBqePndUADSxi87bVoYmxfQ4LjPHCl9b613PFA1H9riQMZ+lDt+TMI0uqhpG+Pcs2DR3RxmikIpqw1b6Ef+xo2+t3JqDtIgu0ACoZj5sTRJuv8NTcPwIEU909zP2vN3mPHd75KbuD0ViHDEP4HR1j67iCxb0DCIi9qacrVGO4gPy0q9tPmAfEGKJohMMkOxW+A4DtDKqChpuKU3ZHEy6gmk3/wjTdH0nEkw8vqRLr27wAEr4DwEBwAaERNuc8CcACg1S7ZudCj36/HivMY9W/LOAeRviOI6gnXEAkfN57U84cOqwEEbStFaLaQc6ZgJE4oz6BzTMk8mnONaTdi80dEUG8zbGE9RYIRAuK6WHzPHJkCapXEkK20FpmEb3IjDqXfoQ5dFpjtV8wpSwKGKbNE6iOpl5PRxP3dqt7V04jfEBHjiiZm+dUzPCGhli8sx6c5VeoWs5jkytJJNq4yES+sKpmrp5ZMf94tggzKSnm6AEUmTt6jiaOaxP6F1QzgEBgrFQA8/6bcpBKNsBRgB08sN0khH71eMH87NGC+f6DBWhd6EriO8j/K3MIwKLs4YN5xbvuYAmLKWIGTAaCBByvtlLATFLCPMfrat54uz4/lM4PcABIBgaz6YYQr7kTQ/7XnhncNAyDUdhtxQKIIxJmF8QClZiMZAoOjMENOLABd8A5Fhfel/yQigmo8w5ffuPYF38P14pbxzgAxgEwDoBxAIwDYBwAB6CjYZYI7lPuSvViLJDpAqum3Je3qbN4URZDGf/7cc8O8BSXG3uqaZ3ZNe4JwG28qNRFYCoV9wTgWixsAQzOcZ/Ou9dV7svD9KL5A6EJxzjHPQFgF7iZDgXDpxeobXCMa5yLlJSItVAIhjtVBu2aXQCzwzGuxeg+ZT0E9Uy8jAOaC4HJIR/H4Xp0z4OfgI2gfaGBcwgaOBOYUn/k4xbHh85prMRvhzjN3XAfn4j3Qc2q/lh0BCA6nOEOcIlT3P5xveKRLtUQ1LUmA/1bJeVR9Stb/NGBs3CHw61IuJVjMTunAYc7AYfCjdCEjxP9fSV6TX5WfRf1/10gGZzgBkfhqscdDkXCKW7F7Fp8A1/JJyULf6X2AAAAAElFTkSuQmCC",e}return(0,f.Z)(r)}(ge),be=(0,t.createContext)({});var xe=function(e){var r=e.children,n=e.endpoint,i=e.config,a=void 0===i?{commitment:"confirmed"}:i,s=(0,t.useMemo)((function(){return new o.Connection(n,a)}),[n,a]);return t.createElement(be.Provider,{value:{connection:s}},r)},we={ERROR_ASSOCIATION_PORT_OUT_OF_RANGE:"ERROR_ASSOCIATION_PORT_OUT_OF_RANGE",ERROR_FORBIDDEN_WALLET_BASE_URL:"ERROR_FORBIDDEN_WALLET_BASE_URL",ERROR_SECURE_CONTEXT_REQUIRED:"ERROR_SECURE_CONTEXT_REQUIRED",ERROR_SESSION_CLOSED:"ERROR_SESSION_CLOSED",ERROR_SESSION_TIMEOUT:"ERROR_SESSION_TIMEOUT",ERROR_WALLET_NOT_FOUND:"ERROR_WALLET_NOT_FOUND"},ke=function(e){(0,d.Z)(r,e);var t=(0,p.Z)(r);function r(){var e;(0,h.Z)(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];var a=i[0],s=i[1],u=i[2];return(e=t.call(this,s)).code=a,e.data=u,e.name="SolanaMobileWalletAdapterError",e}return(0,f.Z)(r)}((0,y.Z)(Error)),Ae=function(e){(0,d.Z)(r,e);var t=(0,p.Z)(r);function r(){var e;(0,h.Z)(this,r);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];var a=i[0],s=i[1],u=i[2],c=i[3];return(e=t.call(this,u)).code=s,e.data=c,e.jsonRpcMessageId=a,e.name="SolanaMobileWalletAdapterProtocolError",e}return(0,f.Z)(r)}((0,y.Z)(Error));function Ee(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{u(n.next(e))}catch(t){o(t)}}function s(e){try{u(n.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))}function Se(e,t){return Ee(this,void 0,void 0,(0,c.Z)().mark((function r(){var n,i,o;return(0,c.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,crypto.subtle.exportKey("raw",e);case 2:return n=r.sent,r.next=5,crypto.subtle.sign({hash:"SHA-256",name:"ECDSA"},t,n);case 5:return i=r.sent,(o=new Uint8Array(n.byteLength+i.byteLength)).set(new Uint8Array(n),0),o.set(new Uint8Array(i),n.byteLength),r.abrupt("return",o);case 10:case"end":return r.stop()}}),r)})))}var Te=4;function Me(e){if(e>=4294967296)throw new Error("Outbound sequence number overflow. The maximum sequence number is 32-bytes.");var t=new ArrayBuffer(Te);return new DataView(t).setUint32(0,e,!1),new Uint8Array(t)}function Ie(){return Ee(this,void 0,void 0,(0,c.Z)().mark((function e(){return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,crypto.subtle.generateKey({name:"ECDSA",namedCurve:"P-256"},!1,["sign"]);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))}function Pe(){return Ee(this,void 0,void 0,(0,c.Z)().mark((function e(){return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,crypto.subtle.generateKey({name:"ECDH",namedCurve:"P-256"},!1,["deriveKey","deriveBits"]);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))}var Ce,Be=12;function De(e,t){return Ee(this,void 0,void 0,(0,c.Z)().mark((function r(){var n,i,o,a,s;return(0,c.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=JSON.stringify(e),i=Me(e.id),o=new Uint8Array(Be),crypto.getRandomValues(o),r.next=6,crypto.subtle.encrypt(Le(i,o),t,(new TextEncoder).encode(n));case 6:return a=r.sent,(s=new Uint8Array(i.byteLength+o.byteLength+a.byteLength)).set(new Uint8Array(i),0),s.set(new Uint8Array(o),i.byteLength),s.set(new Uint8Array(a),i.byteLength+o.byteLength),r.abrupt("return",s);case 12:case"end":return r.stop()}}),r)})))}function Re(e,t){return Ee(this,void 0,void 0,(0,c.Z)().mark((function r(){var n,i,o,a,s,u;return(0,c.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=e.slice(0,Te),i=e.slice(Te,Te+Be),o=e.slice(Te+Be),r.next=5,crypto.subtle.decrypt(Le(n,i),t,o);case 5:if(a=r.sent,s=Oe().decode(a),u=JSON.parse(s),!Object.hasOwnProperty.call(u,"error")){r.next=10;break}throw new Ae(u.id,u.error.code,u.error.message);case 10:return r.abrupt("return",u);case 11:case"end":return r.stop()}}),r)})))}function Le(e,t){return{additionalData:e,iv:t,name:"AES-GCM",tagLength:128}}function Oe(){return void 0===Ce&&(Ce=new TextDecoder("utf-8")),Ce}function ze(e,t,r){return Ee(this,void 0,void 0,(0,c.Z)().mark((function n(){var o,a,s,u,l,h,f;return(0,c.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Promise.all([crypto.subtle.exportKey("raw",t),crypto.subtle.importKey("raw",e,{name:"ECDH",namedCurve:"P-256"},!1,[])]);case 2:return o=n.sent,a=(0,i.Z)(o,2),s=a[0],u=a[1],n.next=8,crypto.subtle.deriveBits({name:"ECDH",public:u},r,256);case 8:return l=n.sent,n.next=11,crypto.subtle.importKey("raw",l,"HKDF",!1,["deriveKey"]);case 11:return h=n.sent,n.next=14,crypto.subtle.deriveKey({name:"HKDF",hash:"SHA-256",salt:new Uint8Array(s),info:new Uint8Array},h,{name:"AES-GCM",length:128},!1,["encrypt","decrypt"]);case 14:return f=n.sent,n.abrupt("return",f);case 16:case"end":return n.stop()}}),n)})))}function Ne(e){if(e<49152||e>65535)throw new ke(we.ERROR_ASSOCIATION_PORT_OUT_OF_RANGE,"Association port number must be between 49152 and 65535. ".concat(e," given."),{port:e});return e}function Ue(e){for(var t="",r=new Uint8Array(e),n=r.byteLength,i=0;i<n;i++)t+=String.fromCharCode(r[i]);return window.btoa(t)}var Ze="solana-wallet";function Fe(e){return e.replace(/(^\/+|\/+$)/g,"").split("/")}function je(e,t){var r=null;if(t){try{r=new URL(t)}catch(i){}if("https:"!==(null===r||void 0===r?void 0:r.protocol))throw new ke(we.ERROR_FORBIDDEN_WALLET_BASE_URL,"Base URLs supplied by wallets must be valid `https` URLs")}r||(r=new URL("".concat(Ze,":/")));var n=e.startsWith("/")?e:[].concat((0,s.Z)(Fe(r.pathname)),(0,s.Z)(Fe(e))).join("/");return new URL(n,r)}function Ve(e,t,r){return Ee(this,void 0,void 0,(0,c.Z)().mark((function n(){var i,o,a,s;return(0,c.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=Ne(t),n.next=3,crypto.subtle.exportKey("raw",e);case 3:return o=n.sent,a=Ue(o),(s=je("v1/associate/local",r)).searchParams.set("association",a.replace(/[/+=]/g,(function(e){return{"/":"_","+":"-","=":"."}[e]}))),s.searchParams.set("port","".concat(i)),n.abrupt("return",s);case 9:case"end":return n.stop()}}),n)})))}var We={Firefox:0,Other:1};var Ke=null;function Ge(e,t){return Ee(this,void 0,void 0,(0,c.Z)().mark((function r(){var n,i,o,a;return(0,c.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=Ne(49152+Math.floor(16384*Math.random())),r.next=3,Ve(e,n,t);case 3:if("https:"!==(i=r.sent).protocol){r.next=8;break}window.location.assign(i),r.next=26;break;case 8:r.prev=8,o=-1!==navigator.userAgent.indexOf("Firefox/")?We.Firefox:We.Other,r.t0=o,r.next=r.t0===We.Firefox?13:r.t0===We.Other?15:20;break;case 13:return s=i,null==Ke&&((Ke=document.createElement("iframe")).style.display="none",document.body.appendChild(Ke)),Ke.contentWindow.location.href=s.toString(),r.abrupt("break",21);case 15:return a=new Promise((function(e,t){function r(){clearTimeout(i),window.removeEventListener("blur",n)}function n(){r(),e()}window.addEventListener("blur",n);var i=setTimeout((function(){r(),t()}),2e3)})),window.location.assign(i),r.next=19,a;case 19:return r.abrupt("break",21);case 20:case 21:r.next=26;break;case 23:throw r.prev=23,r.t1=r.catch(8),new ke(we.ERROR_WALLET_NOT_FOUND,"Found no installed wallet that supports the mobile wallet protocol.");case 26:return r.abrupt("return",n);case 27:case"end":return r.stop()}var s}),r,null,[[8,23]])})))}var He={retryDelayScheduleMs:[150,150,200,500,500,750,750,1e3],timeoutMs:3e4},qe="com.solana.mobilewalletadapter.v1";function Ye(){if("undefined"===typeof window||!0!==window.isSecureContext)throw new ke(we.ERROR_SECURE_CONTEXT_REQUIRED,"The mobile wallet adapter protocol must be used in a secure context (`https`).")}function Xe(e){var t;try{t=new URL(e)}catch(r){throw new ke(we.ERROR_FORBIDDEN_WALLET_BASE_URL,"Invalid base URL supplied by wallet")}if("https:"!==t.protocol)throw new ke(we.ERROR_FORBIDDEN_WALLET_BASE_URL,"Base URLs supplied by wallets must be valid `https` URLs")}function Qe(e,t){return Ee(this,void 0,void 0,(0,c.Z)().mark((function r(){var n,i,o,a,u,l,h,f,d=this;return(0,c.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return Ye(),r.next=3,Ie();case 3:return n=r.sent,r.next=6,Ge(n.publicKey,null===t||void 0===t?void 0:t.baseUri);case 6:return i=r.sent,o="ws://localhost:".concat(i,"/solana-wallet"),u=function(){var e=(0,s.Z)(He.retryDelayScheduleMs);return function(){return e.length>1?e.shift():e[0]}}(),l=1,h=0,f={__type:"disconnected"},r.abrupt("return",new Promise((function(t,r){var s,p,m,g={},y=function e(){return Ee(d,void 0,void 0,(0,c.Z)().mark((function t(){var r,n;return(0,c.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("connecting"===f.__type){t.next=3;break}return console.warn("Expected adapter state to be `connecting` at the moment the websocket opens. "+"Got `".concat(f.__type,"`.")),t.abrupt("return");case 3:return r=f.associationKeypair,s.removeEventListener("open",e),t.next=7,Pe();case 7:return n=t.sent,t.t0=s,t.next=11,Se(n.publicKey,r.privateKey);case 11:t.t1=t.sent,t.t0.send.call(t.t0,t.t1),f={__type:"hello_req_sent",associationPublicKey:r.publicKey,ecdhPrivateKey:n.privateKey};case 14:case"end":return t.stop()}}),t)})))},v=function(e){e.wasClean?f={__type:"disconnected"}:r(new ke(we.ERROR_SESSION_CLOSED,"The wallet session dropped unexpectedly (".concat(e.code,": ").concat(e.reason,")."),{closeEvent:e})),p()},_=function(e){return Ee(d,void 0,void 0,(0,c.Z)().mark((function e(){return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(p(),!(Date.now()-a>=He.timeoutMs)){e.next=5;break}r(new ke(we.ERROR_SESSION_TIMEOUT,"Failed to connect to the wallet websocket on port ".concat(i,"."))),e.next=8;break;case 5:return e.next=7,new Promise((function(e){var t=u();m=window.setTimeout(e,t)}));case 7:x();case 8:case"end":return e.stop()}}),e)})))},b=function(n){return Ee(d,void 0,void 0,(0,c.Z)().mark((function i(){var o,a,u,d,m,y,v,_;return(0,c.Z)().wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,n.data.arrayBuffer();case 2:o=i.sent,i.t0=f.__type,i.next="connected"===i.t0?6:"hello_req_sent"===i.t0?30:51;break;case 6:if(i.prev=6,a=o.slice(0,Te),(u=new DataView(a).getUint32(0,!1))===h+1){i.next=11;break}throw new Error("Encrypted message has invalid sequence number");case 11:return h=u,i.next=14,Re(o,f.sharedSecret);case 14:d=i.sent,m=g[d.id],delete g[d.id],m.resolve(d.result),i.next=29;break;case 20:if(i.prev=20,i.t1=i.catch(6),!(i.t1 instanceof Ae)){i.next=28;break}y=g[i.t1.jsonRpcMessageId],delete g[i.t1.jsonRpcMessageId],y.reject(i.t1),i.next=29;break;case 28:throw i.t1;case 29:return i.abrupt("break",51);case 30:return i.next=32,ze(o,f.associationPublicKey,f.ecdhPrivateKey);case 32:return v=i.sent,f={__type:"connected",sharedSecret:v},_=new Proxy({},{get:function(e,t){if(null==e[t]){var r=t.toString().replace(/[A-Z]/g,(function(e){return"_".concat(e.toLowerCase())})).toLowerCase();e[t]=function(e){return Ee(this,void 0,void 0,(0,c.Z)().mark((function n(){var i;return(0,c.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=l++,n.t0=s,n.next=4,De({id:i,jsonrpc:"2.0",method:r,params:null!==e&&void 0!==e?e:{}},v);case 4:return n.t1=n.sent,n.t0.send.call(n.t0,n.t1),n.abrupt("return",new Promise((function(e,r){g[i]={resolve:function(n){switch(t){case"authorize":case"reauthorize":var i=n.wallet_uri_base;if(null!=i)try{Xe(i)}catch(o){return void r(o)}}e(n)},reject:r}})));case 7:case"end":return n.stop()}}),n)})))}}return e[t]},defineProperty:function(){return!1},deleteProperty:function(){return!1}}),i.prev=35,i.t2=t,i.next=39,e(_);case 39:i.t3=i.sent,(0,i.t2)(i.t3),i.next=46;break;case 43:i.prev=43,i.t4=i.catch(35),r(i.t4);case 46:return i.prev=46,p(),s.close(),i.finish(46);case 50:return i.abrupt("break",51);case 51:case"end":return i.stop()}}),i,null,[[6,20],[35,43,46,50]])})))},x=function(){p&&p(),f={__type:"connecting",associationKeypair:n},void 0===a&&(a=Date.now()),(s=new WebSocket(o,[qe])).addEventListener("open",y),s.addEventListener("close",v),s.addEventListener("error",_),s.addEventListener("message",b),p=function(){window.clearTimeout(m),s.removeEventListener("open",y),s.removeEventListener("close",v),s.removeEventListener("error",_),s.removeEventListener("message",b)}};x()})));case 13:case"end":return r.stop()}}),r)})))}var $e=r(6315);function Je(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]])}return r}function et(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{u(n.next(e))}catch(t){o(t)}}function s(e){try{u(n.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))}function tt(e){var t;return window.btoa((t=String.fromCharCode).call.apply(t,[null].concat((0,s.Z)(e))))}function rt(e){return new Uint8Array(window.atob(e).split("").map((function(e){return e.charCodeAt(0)})))}function nt(e){return tt("version"in e?e.serialize():e.serialize({requireAllSignatures:!1,verifySignatures:!1}))}function it(e){return"legacy"===o.VersionedMessage.deserializeMessageVersion(e)?o.Transaction.from(e):o.VersionedTransaction.deserialize(e)}function ot(e,t){return et(this,void 0,void 0,(0,c.Z)().mark((function r(){var n;return(0,c.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=function(t){var r=new Proxy({},{get:function(e,r){if(null==e[r])switch(r){case"signAndSendTransactions":e[r]=function(e){var r=e.minContextSlot,n=e.transactions,i=Je(e,["minContextSlot","transactions"]);return et(this,void 0,void 0,(0,c.Z)().mark((function e(){var o,a,s,u;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=n.map(nt),e.next=3,t.signAndSendTransactions(Object.assign(Object.assign(Object.assign({},i),null!=r?{options:{min_context_slot:r}}:null),{payloads:o}));case 3:return a=e.sent,s=a.signatures,u=s.map(rt).map($e.encode),e.abrupt("return",u);case 7:case"end":return e.stop()}}),e)})))};break;case"signMessages":e[r]=function(e){var r=e.payloads,n=Je(e,["payloads"]);return et(this,void 0,void 0,(0,c.Z)().mark((function e(){var i,o,a,s;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=r.map(tt),e.next=3,t.signMessages(Object.assign(Object.assign({},n),{payloads:i}));case 3:return o=e.sent,a=o.signed_payloads,s=a.map(rt),e.abrupt("return",s);case 7:case"end":return e.stop()}}),e)})))};break;case"signTransactions":e[r]=function(e){var r=e.transactions,n=Je(e,["transactions"]);return et(this,void 0,void 0,(0,c.Z)().mark((function e(){var i,o,a,s,u;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=r.map(nt),e.next=3,t.signTransactions(Object.assign(Object.assign({},n),{payloads:i}));case 3:return o=e.sent,a=o.signed_payloads,s=a.map(rt),u=s.map(it),e.abrupt("return",u);case 8:case"end":return e.stop()}}),e)})))};break;default:e[r]=t[r]}return e[r]},defineProperty:function(){return!1},deleteProperty:function(){return!1}});return e(r)},r.next=3,Qe(n,t);case 3:return r.abrupt("return",r.sent);case 4:case"end":return r.stop()}}),r)})))}function at(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{u(n.next(e))}catch(t){o(t)}}function s(e){try{u(n.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))}var st="Mobile Wallet Adapter";function ut(e){var t,r=(t=e,new Uint8Array(window.atob(t).split("").map((function(e){return e.charCodeAt(0)}))));return new o.PublicKey(r)}function ct(e){return"version"in e}var lt=function(e){(0,d.Z)(r,e);var t=(0,p.Z)(r);function r(e){var n;return(0,h.Z)(this,r),(n=t.call(this)).supportedTransactionVersions=new Set(["legacy",0]),n.name=st,n.url="https://solanamobile.com/wallets",n.icon="data:image/svg+xml;base64,PHN2ZyBmaWxsPSJub25lIiBoZWlnaHQ9IjI4IiB3aWR0aD0iMjgiIHZpZXdCb3g9Ii0zIDAgMjggMjgiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsbD0iI0RDQjhGRiI+PHBhdGggZD0iTTE3LjQgMTcuNEgxNXYyLjRoMi40di0yLjRabTEuMi05LjZoLTIuNHYyLjRoMi40VjcuOFoiLz48cGF0aCBkPSJNMjEuNiAzVjBoLTIuNHYzaC0zLjZWMGgtMi40djNoLTIuNHY2LjZINC41YTIuMSAyLjEgMCAxIDEgMC00LjJoMi43VjNINC41QTQuNSA0LjUgMCAwIDAgMCA3LjVWMjRoMjEuNnYtNi42aC0yLjR2NC4ySDIuNFYxMS41Yy41LjMgMS4yLjQgMS44LjVoNy41QTYuNiA2LjYgMCAwIDAgMjQgOVYzaC0yLjRabTAgNS43YTQuMiA0LjIgMCAxIDEtOC40IDBWNS40aDguNHYzLjNaIi8+PC9nPjwvc3ZnPg==",n._connecting=!1,n._connectionGeneration=0,n._readyState="undefined"!==typeof window&&window.isSecureContext&&"undefined"!==typeof document&&/android/i.test(navigator.userAgent)?a.Loadable:a.Unsupported,n._authorizationResultCache=e.authorizationResultCache,n._addressSelector=e.addressSelector,n._appIdentity=e.appIdentity,n._cluster=e.cluster,n._onWalletNotFound=e.onWalletNotFound,n._readyState!==a.Unsupported&&n._authorizationResultCache.get().then((function(e){e&&n.declareWalletAsInstalled()})),n}return(0,f.Z)(r,[{key:"publicKey",get:function(){if(null==this._publicKey&&null!=this._selectedAddress)try{this._publicKey=ut(this._selectedAddress)}catch(e){throw new S(e instanceof Error&&(null===e||void 0===e?void 0:e.message)||"Unknown error",e)}return this._publicKey?this._publicKey:null}},{key:"connected",get:function(){return!!this._authorizationResult}},{key:"connecting",get:function(){return this._connecting}},{key:"readyState",get:function(){return this._readyState}},{key:"declareWalletAsInstalled",value:function(){this._readyState!==a.Installed&&this.emit("readyStateChange",this._readyState=a.Installed)}},{key:"runWithGuard",value:function(e){return at(this,void 0,void 0,(0,c.Z)().mark((function t(){return(0,c.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e();case 3:return t.abrupt("return",t.sent);case 6:throw t.prev=6,t.t0=t.catch(0),this.emit("error",t.t0),t.t0;case 10:case"end":return t.stop()}}),t,this,[[0,6]])})))}},{key:"autoConnect_DO_NOT_USE_OR_YOU_WILL_BE_FIRED",value:function(){return at(this,void 0,void 0,(0,c.Z)().mark((function e(){return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.autoConnect();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})))}},{key:"autoConnect",value:function(){return at(this,void 0,void 0,(0,c.Z)().mark((function e(){var t=this;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.connecting&&!this.connected){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.runWithGuard((function(){return at(t,void 0,void 0,(0,c.Z)().mark((function e(){var t;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._readyState===a.Installed||this._readyState===a.Loadable){e.next=2;break}throw new _;case 2:return this._connecting=!0,e.prev=3,e.next=6,this._authorizationResultCache.get();case 6:(t=e.sent)&&this.handleAuthorizationResult(t),e.next=13;break;case 10:throw e.prev=10,e.t0=e.catch(3),new w(e.t0 instanceof Error&&e.t0.message||"Unknown error",e.t0);case 13:return e.prev=13,this._connecting=!1,e.finish(13);case 16:case"end":return e.stop()}}),e,this,[[3,10,13,16]])})))}));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)})))}},{key:"connect",value:function(){return at(this,void 0,void 0,(0,c.Z)().mark((function e(){var t=this;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.connecting&&!this.connected){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.runWithGuard((function(){return at(t,void 0,void 0,(0,c.Z)().mark((function e(){var t,r=this;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._readyState===a.Installed||this._readyState===a.Loadable){e.next=2;break}throw new _;case 2:return this._connecting=!0,e.prev=3,e.next=6,this._authorizationResultCache.get();case 6:if(!(t=e.sent)){e.next=10;break}return this.handleAuthorizationResult(t),e.abrupt("return");case 10:return e.next=12,this.transact((function(e){return at(r,void 0,void 0,(0,c.Z)().mark((function t(){var r;return(0,c.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.authorize({cluster:this._cluster,identity:this._appIdentity});case 2:r=t.sent,Promise.all([this._authorizationResultCache.set(r),this.handleAuthorizationResult(r)]);case 4:case"end":return t.stop()}}),t,this)})))}));case 12:e.next=17;break;case 14:throw e.prev=14,e.t0=e.catch(3),new w(e.t0 instanceof Error&&e.t0.message||"Unknown error",e.t0);case 17:return e.prev=17,this._connecting=!1,e.finish(17);case 20:case"end":return e.stop()}}),e,this,[[3,14,17,20]])})))}));case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)})))}},{key:"handleAuthorizationResult",value:function(e){var t;return at(this,void 0,void 0,(0,c.Z)().mark((function r(){var n,i;return(0,c.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n=null==this._authorizationResult||(null===(t=this._authorizationResult)||void 0===t?void 0:t.accounts.length)!==e.accounts.length||this._authorizationResult.accounts.some((function(t,r){return t.address!==e.accounts[r].address})),this._authorizationResult=e,this.declareWalletAsInstalled(),!n){r.next=8;break}return r.next=6,this._addressSelector.select(e.accounts.map((function(e){return e.address})));case 6:(i=r.sent)!==this._selectedAddress&&(this._selectedAddress=i,delete this._publicKey,this.emit("connect",this.publicKey));case 8:case"end":return r.stop()}}),r,this)})))}},{key:"performReauthorization",value:function(e,t){return at(this,void 0,void 0,(0,c.Z)().mark((function r(){var n;return(0,c.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,e.reauthorize({auth_token:t});case 3:n=r.sent,Promise.all([this._authorizationResultCache.set(n),this.handleAuthorizationResult(n)]),r.next=11;break;case 7:throw r.prev=7,r.t0=r.catch(0),this.disconnect(),new k(r.t0 instanceof Error&&(null===r.t0||void 0===r.t0?void 0:r.t0.message)||"Unknown error",r.t0);case 11:case"end":return r.stop()}}),r,this,[[0,7]])})))}},{key:"disconnect",value:function(){return at(this,void 0,void 0,(0,c.Z)().mark((function e(){return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this._authorizationResultCache.clear(),this._connecting=!1,this._connectionGeneration++,delete this._authorizationResult,delete this._publicKey,delete this._selectedAddress,this.emit("disconnect");case 7:case"end":return e.stop()}}),e,this)})))}},{key:"transact",value:function(e){var t;return at(this,void 0,void 0,(0,c.Z)().mark((function r(){var n,i,o;return(0,c.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=null===(t=this._authorizationResult)||void 0===t?void 0:t.wallet_uri_base,i=n?{baseUri:n}:void 0,o=this._connectionGeneration,r.prev=3,r.next=6,ot(e,i);case 6:return r.abrupt("return",r.sent);case 9:if(r.prev=9,r.t0=r.catch(3),this._connectionGeneration===o){r.next=14;break}return r.next=14,new Promise((function(){}));case 14:if(!(r.t0 instanceof Error&&"SolanaMobileWalletAdapterError"===r.t0.name&&"ERROR_WALLET_NOT_FOUND"===r.t0.code)){r.next=17;break}return r.next=17,this._onWalletNotFound(this);case 17:throw r.t0;case 18:case"end":return r.stop()}}),r,this,[[3,9]])})))}},{key:"assertIsAuthorized",value:function(){if(!this._authorizationResult||!this._selectedAddress)throw new T;return{authToken:this._authorizationResult.auth_token,selectedAddress:this._selectedAddress}}},{key:"performSignTransactions",value:function(e){return at(this,void 0,void 0,(0,c.Z)().mark((function t(){var r,n,i=this;return(0,c.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=this.assertIsAuthorized(),n=r.authToken,t.prev=1,t.next=4,this.transact((function(t){return at(i,void 0,void 0,(0,c.Z)().mark((function r(){var i;return(0,c.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.performReauthorization(t,n);case 2:return r.next=4,t.signTransactions({transactions:e});case 4:return i=r.sent,r.abrupt("return",i);case 6:case"end":return r.stop()}}),r,this)})))}));case 4:return t.abrupt("return",t.sent);case 7:throw t.prev=7,t.t0=t.catch(1),new P(null===t.t0||void 0===t.t0?void 0:t.t0.message,t.t0);case 10:case"end":return t.stop()}}),t,this,[[1,7]])})))}},{key:"sendTransaction",value:function(e,t,r){return at(this,void 0,void 0,(0,c.Z)().mark((function n(){var o=this;return(0,c.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,this.runWithGuard((function(){return at(o,void 0,void 0,(0,c.Z)().mark((function n(){var o,a,s,u=this;return(0,c.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o=this.assertIsAuthorized(),a=o.authToken,s=null===r||void 0===r?void 0:r.minContextSlot,n.prev=2,n.next=5,this.transact((function(n){return at(u,void 0,void 0,(0,c.Z)().mark((function o(){var u,l,h,f,d,p,m,g,y,v=this;return(0,c.Z)().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return u=function(){var e,n;switch(t.commitment){case"confirmed":case"finalized":case"processed":e=t.commitment;break;default:e="finalized"}switch(null===r||void 0===r?void 0:r.preflightCommitment){case"confirmed":case"finalized":case"processed":n=r.preflightCommitment;break;case void 0:n=e;default:n="finalized"}return("finalized"===n?2:"confirmed"===n?1:0)<("finalized"===e?2:"confirmed"===e?1:0)?n:e},o.next=3,Promise.all([n.getCapabilities(),this.performReauthorization(n,a),ct(e)?null:at(v,void 0,void 0,(0,c.Z)().mark((function r(){var n,i,o;return(0,c.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(e.feePayer||(e.feePayer=null!==(n=this.publicKey)&&void 0!==n?n:void 0),null!=e.recentBlockhash){r.next=7;break}return r.next=4,t.getLatestBlockhash({commitment:u()});case 4:i=r.sent,o=i.blockhash,e.recentBlockhash=o;case 7:case"end":return r.stop()}}),r,this)})))]);case 3:if(l=o.sent,h=(0,i.Z)(l,3),f=h[0],h[1],h[2],!f.supports_sign_and_send_transactions){o.next=15;break}return o.next=11,n.signAndSendTransactions({minContextSlot:s,transactions:[e]});case 11:return d=o.sent,o.abrupt("return",d[0]);case 15:return o.next=17,n.signTransactions({transactions:[e]});case 17:if(p=o.sent,m=(0,i.Z)(p,1),!ct(g=m[0])){o.next=26;break}return o.next=23,t.sendTransaction(g);case 23:case 29:return o.abrupt("return",o.sent);case 26:return y=g.serialize(),o.next=29,t.sendRawTransaction(y,Object.assign(Object.assign({},r),{preflightCommitment:u()}));case 30:case"end":return o.stop()}}),o,this)})))}));case 5:return n.abrupt("return",n.sent);case 8:throw n.prev=8,n.t0=n.catch(2),new M(null===n.t0||void 0===n.t0?void 0:n.t0.message,n.t0);case 11:case"end":return n.stop()}}),n,this,[[2,8]])})))}));case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}}),n,this)})))}},{key:"signTransaction",value:function(e){return at(this,void 0,void 0,(0,c.Z)().mark((function t(){var r=this;return(0,c.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.runWithGuard((function(){return at(r,void 0,void 0,(0,c.Z)().mark((function t(){var r,n,o;return(0,c.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.performSignTransactions([e]);case 2:return r=t.sent,n=(0,i.Z)(r,1),o=n[0],t.abrupt("return",o);case 6:case"end":return t.stop()}}),t,this)})))}));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)})))}},{key:"signAllTransactions",value:function(e){return at(this,void 0,void 0,(0,c.Z)().mark((function t(){var r=this;return(0,c.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.runWithGuard((function(){return at(r,void 0,void 0,(0,c.Z)().mark((function t(){var r;return(0,c.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.performSignTransactions(e);case 2:return r=t.sent,t.abrupt("return",r);case 4:case"end":return t.stop()}}),t,this)})))}));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)})))}},{key:"signMessage",value:function(e){return at(this,void 0,void 0,(0,c.Z)().mark((function t(){var r=this;return(0,c.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.runWithGuard((function(){return at(r,void 0,void 0,(0,c.Z)().mark((function t(){var r,n,o,a=this;return(0,c.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=this.assertIsAuthorized(),n=r.authToken,o=r.selectedAddress,t.prev=1,t.next=4,this.transact((function(t){return at(a,void 0,void 0,(0,c.Z)().mark((function r(){var a,s,u,l;return(0,c.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,this.performReauthorization(t,n);case 2:return r.next=4,t.signMessages({addresses:[o],payloads:[e]});case 4:return a=r.sent,s=(0,i.Z)(a,1),u=s[0],l=u.slice(-64),r.abrupt("return",l);case 9:case"end":return r.stop()}}),r,this)})))}));case 4:return t.abrupt("return",t.sent);case 7:throw t.prev=7,t.t0=t.catch(1),new I(null===t.t0||void 0===t.t0?void 0:t.t0.message,t.t0);case 10:case"end":return t.stop()}}),t,this,[[1,7]])})))}));case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)})))}}]),r}(Z);var ht="SolanaMobileWalletAdapterDefaultAuthorizationCache";function ft(){var e;try{e=window.localStorage}catch(t){}return{clear:function(){return at(this,void 0,void 0,(0,c.Z)().mark((function r(){return(0,c.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(e){r.next=2;break}return r.abrupt("return");case 2:try{e.removeItem(ht)}catch(t){}case 3:case"end":return r.stop()}}),r)})))},get:function(){return at(this,void 0,void 0,(0,c.Z)().mark((function t(){return(0,c.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return");case 2:return t.prev=2,t.abrupt("return",JSON.parse(e.getItem(ht))||void 0);case 6:t.prev=6,t.t0=t.catch(2);case 8:case"end":return t.stop()}}),t,null,[[2,6]])})))},set:function(r){return at(this,void 0,void 0,(0,c.Z)().mark((function n(){return(0,c.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e){n.next=2;break}return n.abrupt("return");case 2:try{e.setItem(ht,JSON.stringify(r))}catch(t){}case 3:case"end":return n.stop()}}),n)})))}}}function dt(e){return at(this,void 0,void 0,(0,c.Z)().mark((function t(){return(0,c.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:"undefined"!==typeof window&&window.location.assign(e.url);case 1:case"end":return t.stop()}}),t)})))}var pt="solana:signAndSendTransaction",mt="solana:signTransaction",gt="standard:connect",yt="standard:events";var vt=function(e){return gt in e.features&&yt in e.features&&(pt in e.features||mt in e.features)},_t=r(7326),bt="solana:signMessage",xt="solana:mainnet",wt="solana:devnet",kt="solana:testnet",At="solana:localnet";var Et="https://api.mainnet-beta.solana.com";function St(e){switch(e){case"processed":case"confirmed":case"finalized":case void 0:return e;case"recent":return"processed";case"single":case"singleGossip":return"confirmed";case"max":case"root":return"finalized";default:return}}var Tt="standard:disconnect";function Mt(e,t){if(e===t)return!0;var r=e.length;if(r!==t.length)return!1;for(var n=0;n<r;n++)if(e[n]!==t[n])return!1;return!0}new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakMap;var It,Pt,Ct,Bt,Dt,Rt,Lt,Ot,zt,Nt,Ut,Zt,Ft,jt,Vt=r(2812),Wt=["signers"],Kt=function(e,t,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"===typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,r):i?i.value=r:t.set(e,r),r},Gt=function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"===typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)},Ht=function(e){(0,d.Z)(r,e);var t=(0,p.Z)(r);function r(e){var n,i=e.wallet;(0,h.Z)(this,r),n=t.call(this),It.add((0,_t.Z)(n)),Pt.set((0,_t.Z)(n),void 0),Ct.set((0,_t.Z)(n),void 0),Bt.set((0,_t.Z)(n),void 0),Dt.set((0,_t.Z)(n),void 0),Rt.set((0,_t.Z)(n),void 0),Lt.set((0,_t.Z)(n),void 0),Ot.set((0,_t.Z)(n),"undefined"===typeof window||"undefined"===typeof document?a.Unsupported:a.Installed),Ut.set((0,_t.Z)(n),(function(e){if(Gt((0,_t.Z)(n),Pt,"f")&&Gt((0,_t.Z)(n),Ct,"f")&&"accounts"in e){var t=Gt((0,_t.Z)(n),Rt,"f").accounts[0];if(!t)return Gt((0,_t.Z)(n),It,"m",Nt).call((0,_t.Z)(n)),n.emit("error",new k),void n.emit("disconnect");if(t!==Gt((0,_t.Z)(n),Pt,"f")){var r;try{r=new o.PublicKey(t.publicKey)}catch(i){return Gt((0,_t.Z)(n),It,"m",Nt).call((0,_t.Z)(n)),n.emit("error",new S(null===i||void 0===i?void 0:i.message)),void n.emit("disconnect")}Gt((0,_t.Z)(n),It,"m",zt).call((0,_t.Z)(n),t,r),n.emit("connect",r)}}})),Kt((0,_t.Z)(n),Rt,i,"f");var s=pt in i.features?i.features[pt].supportedTransactionVersions:i.features[mt].supportedTransactionVersions;return Kt((0,_t.Z)(n),Lt,Mt(s,["legacy"])?null:new Set(s),"f"),Kt((0,_t.Z)(n),Pt,null,"f"),Kt((0,_t.Z)(n),Ct,null,"f"),Kt((0,_t.Z)(n),Bt,!1,"f"),n}return(0,f.Z)(r,[{key:"supportedTransactionVersions",get:function(){return Gt(this,Lt,"f")}},{key:"name",get:function(){return Gt(this,Rt,"f").name}},{key:"icon",get:function(){return Gt(this,Rt,"f").icon}},{key:"url",get:function(){return"https://github.com/solana-labs/wallet-standard"}},{key:"publicKey",get:function(){return Gt(this,Ct,"f")}},{key:"connecting",get:function(){return Gt(this,Bt,"f")}},{key:"readyState",get:function(){return Gt(this,Ot,"f")}},{key:"wallet",get:function(){return Gt(this,Rt,"f")}},{key:"standard",get:function(){return!0}},{key:"connect",value:function(){var e=(0,l.Z)((0,c.Z)().mark((function e(){var t,r;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!this.connected&&!this.connecting){e.next=3;break}return e.abrupt("return");case 3:if(Gt(this,Ot,"f")===a.Installed){e.next=5;break}throw new _;case 5:if(Kt(this,Bt,!0,"f"),Gt(this,Rt,"f").accounts.length){e.next=15;break}return e.prev=7,e.next=10,Gt(this,Rt,"f").features[gt].connect();case 10:e.next=15;break;case 12:throw e.prev=12,e.t0=e.catch(7),new w(null===e.t0||void 0===e.t0?void 0:e.t0.message,e.t0);case 15:if(Gt(this,Rt,"f").accounts.length){e.next=17;break}throw new E;case 17:t=Gt(this,Rt,"f").accounts[0],e.prev=18,r=new o.PublicKey(t.publicKey),e.next=25;break;case 22:throw e.prev=22,e.t1=e.catch(18),new S(null===e.t1||void 0===e.t1?void 0:e.t1.message,e.t1);case 25:Kt(this,Dt,Gt(this,Rt,"f").features[yt].on("change",Gt(this,Ut,"f")),"f"),Gt(this,It,"m",zt).call(this,t,r),this.emit("connect",r),e.next=34;break;case 30:throw e.prev=30,e.t2=e.catch(0),this.emit("error",e.t2),e.t2;case 34:return e.prev=34,Kt(this,Bt,!1,"f"),e.finish(34);case 37:case"end":return e.stop()}}),e,this,[[0,30,34,37],[7,12],[18,22]])})));return function(){return e.apply(this,arguments)}}()},{key:"disconnect",value:function(){var e=(0,l.Z)((0,c.Z)().mark((function e(){return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(Tt in Gt(this,Rt,"f").features)){e.next=9;break}return e.prev=1,e.next=4,Gt(this,Rt,"f").features[Tt].disconnect();case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(1),this.emit("error",new A(null===e.t0||void 0===e.t0?void 0:e.t0.message,e.t0));case 9:Gt(this,It,"m",Nt).call(this),this.emit("disconnect");case 11:case"end":return e.stop()}}),e,this,[[1,6]])})));return function(){return e.apply(this,arguments)}}()},{key:"sendTransaction",value:function(){var e=(0,l.Z)((0,c.Z)().mark((function e(t,r){var n,o,a,l,h,f,d,p,m,g,y,_,b,w,k=arguments;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=k.length>2&&void 0!==k[2]?k[2]:{},e.prev=1,o=Gt(this,Pt,"f")){e.next=5;break}throw new T;case 5:if(!(pt in Gt(this,Rt,"f").features)){e.next=17;break}if(!o.features.includes(pt)){e.next=10;break}a=pt,e.next=15;break;case 10:if(!(mt in Gt(this,Rt,"f").features)||!o.features.includes(mt)){e.next=14;break}a=mt,e.next=15;break;case 14:throw new E;case 15:e.next=24;break;case 17:if(!(mt in Gt(this,Rt,"f").features)){e.next=23;break}if(o.features.includes(mt)){e.next=20;break}throw new E;case 20:a=mt,e.next=24;break;case 23:throw new x;case 24:if(c=r.rpcEndpoint,l=c.includes(Et)?xt:/\bdevnet\b/i.test(c)?wt:/\btestnet\b/i.test(c)?kt:/\blocalhost\b/i.test(c)||/\b127\.0\.0\.1\b/.test(c)?At:xt,o.chains.includes(l)){e.next=27;break}throw new M;case 27:if(e.prev=27,h=n.signers,f=(0,u.Z)(n,Wt),!z(t)){e.next=34;break}(null===h||void 0===h?void 0:h.length)&&t.sign(h),d=t.serialize(),e.next=39;break;case 34:return e.next=36,this.prepareTransaction(t,r,f);case 36:t=e.sent,(null===h||void 0===h?void 0:h.length)&&(p=t).partialSign.apply(p,(0,s.Z)(h)),d=new Uint8Array(t.serialize({requireAllSignatures:!1,verifySignatures:!1}));case 39:if(a!==pt){e.next=48;break}return e.next=42,Gt(this,Rt,"f").features[pt].signAndSendTransaction({account:o,chain:l,transaction:d,options:{preflightCommitment:St(f.preflightCommitment||r.commitment),skipPreflight:f.skipPreflight,maxRetries:f.maxRetries,minContextSlot:f.minContextSlot}});case 42:return m=e.sent,g=(0,i.Z)(m,1),y=g[0],e.abrupt("return",Vt.encode(y.signature));case 48:return e.next=50,Gt(this,Rt,"f").features[mt].signTransaction({account:o,chain:l,transaction:d,options:{preflightCommitment:St(f.preflightCommitment||r.commitment),minContextSlot:f.minContextSlot}});case 50:return _=e.sent,b=(0,i.Z)(_,1),w=b[0],e.next=55,r.sendRawTransaction(w.signedTransaction,(0,V.Z)((0,V.Z)({},f),{},{preflightCommitment:St(f.preflightCommitment||r.commitment)}));case 55:return e.abrupt("return",e.sent);case 56:e.next=63;break;case 58:if(e.prev=58,e.t0=e.catch(27),!(e.t0 instanceof v)){e.next=62;break}throw e.t0;case 62:throw new M(null===e.t0||void 0===e.t0?void 0:e.t0.message,e.t0);case 63:e.next=69;break;case 65:throw e.prev=65,e.t1=e.catch(1),this.emit("error",e.t1),e.t1;case 69:case"end":return e.stop()}var c}),e,this,[[1,65],[27,58]])})));return function(t,r){return e.apply(this,arguments)}}()}]),r}(R);Pt=new WeakMap,Ct=new WeakMap,Bt=new WeakMap,Dt=new WeakMap,Rt=new WeakMap,Lt=new WeakMap,Ot=new WeakMap,Ut=new WeakMap,It=new WeakSet,zt=function(e,t){Kt(this,Pt,e,"f"),Kt(this,Ct,t,"f"),null!==e&&void 0!==e&&e.features.includes(mt)?(this.signTransaction=Gt(this,It,"m",Zt),this.signAllTransactions=Gt(this,It,"m",Ft)):(delete this.signTransaction,delete this.signAllTransactions),null!==e&&void 0!==e&&e.features.includes(bt)?this.signMessage=Gt(this,It,"m",jt):delete this.signMessage},Nt=function(){var e=Gt(this,Dt,"f");e&&(Kt(this,Dt,void 0,"f"),e()),Gt(this,It,"m",zt).call(this,null,null)},Zt=function(){var e=(0,l.Z)((0,c.Z)().mark((function e(t){var r,n,i;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r=Gt(this,Pt,"f")){e.next=4;break}throw new T;case 4:if(mt in Gt(this,Rt,"f").features){e.next=6;break}throw new x;case 6:if(r.features.includes(mt)){e.next=8;break}throw new E;case 8:return e.prev=8,e.next=11,Gt(this,Rt,"f").features[mt].signTransaction({account:r,transaction:z(t)?t.serialize():new Uint8Array(t.serialize({requireAllSignatures:!1,verifySignatures:!1}))});case 11:return n=e.sent,i=n[0].signedTransaction,e.abrupt("return",z(t)?o.VersionedTransaction.deserialize(i):o.Transaction.from(i));case 16:if(e.prev=16,e.t0=e.catch(8),!(e.t0 instanceof v)){e.next=20;break}throw e.t0;case 20:throw new P(null===e.t0||void 0===e.t0?void 0:e.t0.message,e.t0);case 21:e.next=27;break;case 23:throw e.prev=23,e.t1=e.catch(0),this.emit("error",e.t1),e.t1;case 27:case"end":return e.stop()}}),e,this,[[0,23],[8,16]])})));return function(t){return e.apply(this,arguments)}}(),Ft=function(){var e=(0,l.Z)((0,c.Z)().mark((function e(t){var r,n,i;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r=Gt(this,Pt,"f")){e.next=4;break}throw new T;case 4:if(mt in Gt(this,Rt,"f").features){e.next=6;break}throw new x;case 6:if(r.features.includes(mt)){e.next=8;break}throw new P;case 8:return e.prev=8,e.next=11,(n=Gt(this,Rt,"f").features[mt]).signTransaction.apply(n,(0,s.Z)(t.map((function(e){return{account:r,transaction:z(e)?e.serialize():new Uint8Array(e.serialize({requireAllSignatures:!1,verifySignatures:!1}))}}))));case 11:return i=e.sent,e.abrupt("return",t.map((function(e,t){var r=i[t].signedTransaction;return z(e)?o.VersionedTransaction.deserialize(r):o.Transaction.from(r)})));case 15:throw e.prev=15,e.t0=e.catch(8),new P(null===e.t0||void 0===e.t0?void 0:e.t0.message,e.t0);case 18:e.next=24;break;case 20:throw e.prev=20,e.t1=e.catch(0),this.emit("error",e.t1),e.t1;case 24:case"end":return e.stop()}}),e,this,[[0,20],[8,15]])})));return function(t){return e.apply(this,arguments)}}(),jt=function(){var e=(0,l.Z)((0,c.Z)().mark((function e(t){var r,n;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r=Gt(this,Pt,"f")){e.next=4;break}throw new T;case 4:if(bt in Gt(this,Rt,"f").features){e.next=6;break}throw new x;case 6:if(r.features.includes(bt)){e.next=8;break}throw new I;case 8:return e.prev=8,e.next=11,Gt(this,Rt,"f").features[bt].signMessage({account:r,message:t});case 11:return n=e.sent,e.abrupt("return",n[0].signature);case 15:throw e.prev=15,e.t0=e.catch(8),new I(null===e.t0||void 0===e.t0?void 0:e.t0.message,e.t0);case 18:e.next=24;break;case 20:throw e.prev=20,e.t1=e.catch(0),this.emit("error",e.t1),e.t1;case 24:case"end":return e.stop()}}),e,this,[[0,20],[8,15]])})));return function(t){return e.apply(this,arguments)}}();var qt,Yt=function(e,t,r,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"===typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(e,r):i?i.value=r:t.set(e,r),r},Xt=function(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"===typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)},Qt=void 0,$t=new Set,Jt={};function er(){if(Qt)return Qt;if(Qt=Object.freeze({register:tr,get:rr,on:nr}),"undefined"===typeof window)return Qt;var e=Object.freeze({register:tr});try{window.addEventListener("wallet-standard:register-wallet",(function(t){return(0,t.detail)(e)}))}catch(t){console.error("wallet-standard:register-wallet event listener could not be added\n",t)}try{window.dispatchEvent(new ar(e))}catch(t){console.error("wallet-standard:app-ready event could not be dispatched\n",t)}return Qt}function tr(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return r=r.filter((function(e){return!$t.has(e)})),r.length?(r.forEach((function(e){return $t.add(e)})),null===(e=Jt.register)||void 0===e||e.forEach((function(e){return ir((function(){return e.apply(void 0,(0,s.Z)(r))}))})),function(){var e;r.forEach((function(e){return $t.delete(e)})),null===(e=Jt.unregister)||void 0===e||e.forEach((function(e){return ir((function(){return e.apply(void 0,(0,s.Z)(r))}))}))}):function(){}}function rr(){return(0,s.Z)($t)}function nr(e,t){var r;return(null===(r=Jt[e])||void 0===r?void 0:r.push(t))||(Jt[e]=[t]),function(){var r;Jt[e]=null===(r=Jt[e])||void 0===r?void 0:r.filter((function(e){return t!==e}))}}function ir(e){try{e()}catch(t){console.error(t)}}var or,ar=function(e){(0,d.Z)(r,e);var t=(0,p.Z)(r);function r(e){var n;return(0,h.Z)(this,r),n=t.call(this,"wallet-standard:app-ready",{bubbles:!1,cancelable:!1,composed:!1}),qt.set((0,_t.Z)(n),void 0),Yt((0,_t.Z)(n),qt,e,"f"),n}return(0,f.Z)(r,[{key:"detail",get:function(){return Xt(this,qt,"f")}},{key:"type",get:function(){return"wallet-standard:app-ready"}},{key:"preventDefault",value:function(){throw new Error("preventDefault cannot be called")}},{key:"stopImmediatePropagation",value:function(){throw new Error("stopImmediatePropagation cannot be called")}},{key:"stopPropagation",value:function(){throw new Error("stopPropagation cannot be called")}}]),r}((0,y.Z)(Event));function sr(e){var r=ur((function(){return function(){if(Qt)return Qt;if(Qt=er(),"undefined"===typeof window)return Qt;var e=window.navigator.wallets||[];if(!Array.isArray(e))return console.error("window.navigator.wallets is not an array"),Qt;var t=Qt.register,r=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];return r.forEach((function(e){return ir((function(){return e({register:t})}))}))};try{Object.defineProperty(window.navigator,"wallets",{value:Object.freeze({push:r})})}catch(n){return console.error("window.navigator.wallets could not be set"),Qt}return r.apply(void 0,(0,s.Z)(e)),Qt}()})),n=r.get,o=r.on,a=(0,t.useState)((function(){return cr(n())})),u=(0,i.Z)(a,2),c=u[0],l=u[1],h=ur((function(){return new Set}));return(0,t.useEffect)((function(){var e=[o("register",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return l((function(e){return[].concat((0,s.Z)(e),(0,s.Z)(cr(t)))}))})),o("unregister",(function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return l((function(e){return e.filter((function(e){return t.some((function(t){return t===e.wallet}))}))}))}))];return function(){return e.forEach((function(e){return e()}))}}),[o]),(0,t.useMemo)((function(){return[].concat((0,s.Z)(c),(0,s.Z)(e.filter((function(e){var t=e.name;return!c.some((function(e){return e.name===t}))||(h.has(t)||(h.add(t),console.warn("".concat(t," was registered as a Standard Wallet. The Wallet Adapter for ").concat(t," can be removed from your app."))),!1)}))))}),[c,e,h])}function ur(e){var r=(0,t.useRef)();return r.current||(r.current={value:e()}),r.current.value}function cr(e){return e.filter(vt).map((function(e){return new Ht({wallet:e})}))}qt=new WeakMap,function(e){e[e.DESKTOP_WEB=0]="DESKTOP_WEB",e[e.MOBILE_WEB=1]="MOBILE_WEB"}(or||(or={}));var lr=function(e){(0,d.Z)(r,e);var t=(0,p.Z)(r);function r(){var e;return(0,h.Z)(this,r),(e=t.apply(this,arguments)).name="WalletNotSelectedError",e}return(0,f.Z)(r)}(v),hr=[],fr={autoConnect:!1,connecting:!1,connected:!1,disconnecting:!1,select:function(e){console.error(dr("get","select"))},connect:function(){return Promise.reject(console.error(dr("get","connect")))},disconnect:function(){return Promise.reject(console.error(dr("get","disconnect")))},sendTransaction:function(e,t,r){return Promise.reject(console.error(dr("get","sendTransaction")))},signTransaction:function(e){return Promise.reject(console.error(dr("get","signTransaction")))},signAllTransactions:function(e){return Promise.reject(console.error(dr("get","signAllTransactions")))},signMessage:function(e){return Promise.reject(console.error(dr("get","signMessage")))}};function dr(e,t){return"You have tried to "+" ".concat(e,' "').concat(t,'"')+" on a WalletContext without providing one. Make sure to render a WalletProvider as an ancestor of the component that uses WalletContext"}Object.defineProperty(fr,"wallets",{get:function(){return console.error(dr("read","wallets")),hr}}),Object.defineProperty(fr,"wallet",{get:function(){return console.error(dr("read","wallet")),null}}),Object.defineProperty(fr,"publicKey",{get:function(){return console.error(dr("read","publicKey")),null}});var pr,mr=(0,t.createContext)(fr);function gr(){return(0,t.useContext)(mr)}function yr(e){var r=e.children,n=e.wallets,o=e.adapter,u=e.isUnloadingRef,h=e.onAutoConnectRequest,f=e.onConnectError,d=e.onError,p=e.onSelectWallet,m=(0,t.useRef)(!1),g=(0,t.useState)(!1),y=(0,i.Z)(g,2),v=y[0],b=y[1],x=(0,t.useRef)(!1),w=(0,t.useState)(!1),k=(0,i.Z)(w,2),A=k[0],E=k[1],S=(0,t.useState)((function(){var e;return null!==(e=null===o||void 0===o?void 0:o.publicKey)&&void 0!==e?e:null})),M=(0,i.Z)(S,2),I=M[0],P=M[1],C=(0,t.useState)((function(){var e;return null!==(e=null===o||void 0===o?void 0:o.connected)&&void 0!==e&&e})),B=(0,i.Z)(C,2),D=B[0],R=B[1],L=(0,t.useRef)(d);(0,t.useEffect)((function(){return L.current=d,function(){L.current=void 0}}),[d]);var O=(0,t.useRef)((function(e,t){return u.current||(L.current?L.current(e,t):(console.error(e,t),e instanceof _&&"undefined"!==typeof window&&t&&window.open(t.url,"_blank"))),e})),z=(0,t.useState)((function(){return n.map((function(e){return{adapter:e,readyState:e.readyState}})).filter((function(e){return e.readyState!==a.Unsupported}))})),N=(0,i.Z)(z,2),U=N[0],Z=N[1];(0,t.useEffect)((function(){function e(e){var t=this;Z((function(r){var n=r.findIndex((function(e){return e.adapter===t}));if(-1===n)return r;var i=r[n].adapter;return[].concat((0,s.Z)(r.slice(0,n)),[{adapter:i,readyState:e}],(0,s.Z)(r.slice(n+1))).filter((function(e){return e.readyState!==a.Unsupported}))}))}return Z((function(e){return n.map((function(t,r){var n=e[r];return n&&n.adapter===t&&n.readyState===t.readyState?n:{adapter:t,readyState:t.readyState}})).filter((function(e){return e.readyState!==a.Unsupported}))})),n.forEach((function(t){return t.on("readyStateChange",e,t)})),function(){n.forEach((function(t){return t.off("readyStateChange",e,t)}))}}),[o,n]);var F=(0,t.useMemo)((function(){var e;return null!==(e=U.find((function(e){return e.adapter===o})))&&void 0!==e?e:null}),[o,U]);(0,t.useEffect)((function(){if(o){var e=function(e){P(e),m.current=!1,b(!1),R(!0),x.current=!1,E(!1)},t=function(){u.current||(P(null),m.current=!1,b(!1),R(!1),x.current=!1,E(!1))},r=function(e){O.current(e,o)};return o.on("connect",e),o.on("disconnect",t),o.on("error",r),function(){o.off("connect",e),o.off("disconnect",t),o.off("error",r),t()}}}),[o,u]);var j=(0,t.useRef)(!1);(0,t.useEffect)((function(){return function(){j.current=!1}}),[o]),(0,t.useEffect)((function(){j.current||m.current||D||!h||(null===F||void 0===F?void 0:F.readyState)!==a.Installed&&(null===F||void 0===F?void 0:F.readyState)!==a.Loadable||(m.current=!0,b(!0),j.current=!0,(0,l.Z)((0,c.Z)().mark((function e(){return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h();case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),f();case 8:return e.prev=8,b(!1),m.current=!1,e.finish(8);case 12:case"end":return e.stop()}}),e,null,[[0,5,8,12]])})))())}),[D,h,f,F]);var V=(0,t.useCallback)(function(){var e=(0,l.Z)((0,c.Z)().mark((function e(t,r,n){return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o){e.next=2;break}throw O.current(new lr);case 2:if(D){e.next=4;break}throw O.current(new T,o);case 4:return e.next=6,o.sendTransaction(t,r,n);case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)})));return function(t,r,n){return e.apply(this,arguments)}}(),[o,D]),W=(0,t.useMemo)((function(){return o&&"signTransaction"in o?function(){var e=(0,l.Z)((0,c.Z)().mark((function e(t){return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(D){e.next=2;break}throw O.current(new T,o);case 2:return e.next=4,o.signTransaction(t);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}():void 0}),[o,D]),K=(0,t.useMemo)((function(){return o&&"signAllTransactions"in o?function(){var e=(0,l.Z)((0,c.Z)().mark((function e(t){return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(D){e.next=2;break}throw O.current(new T,o);case 2:return e.next=4,o.signAllTransactions(t);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}():void 0}),[o,D]),G=(0,t.useMemo)((function(){return o&&"signMessage"in o?function(){var e=(0,l.Z)((0,c.Z)().mark((function e(t){return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(D){e.next=2;break}throw O.current(new T,o);case 2:return e.next=4,o.signMessage(t);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}():void 0}),[o,D]),H=(0,t.useCallback)((0,l.Z)((0,c.Z)().mark((function e(){var t,r;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(m.current||x.current||null!==F&&void 0!==F&&F.adapter.connected)){e.next=2;break}return e.abrupt("return");case 2:if(F){e.next=4;break}throw O.current(new lr);case 4:if(t=F.adapter,(r=F.readyState)===a.Installed||r===a.Loadable){e.next=7;break}throw O.current(new _,t);case 7:return m.current=!0,b(!0),e.prev=9,e.next=12,t.connect();case 12:e.next=18;break;case 14:throw e.prev=14,e.t0=e.catch(9),f(),e.t0;case 18:return e.prev=18,b(!1),m.current=!1,e.finish(18);case 22:case"end":return e.stop()}}),e,null,[[9,14,18,22]])}))),[f,F]),q=(0,t.useCallback)((0,l.Z)((0,c.Z)().mark((function e(){return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!x.current){e.next=2;break}return e.abrupt("return");case 2:if(o){e.next=4;break}return e.abrupt("return");case 4:return x.current=!0,E(!0),e.prev=6,e.next=9,o.disconnect();case 9:return e.prev=9,E(!1),x.current=!1,e.finish(9);case 13:case"end":return e.stop()}}),e,null,[[6,,9,13]])}))),[o]);return t.createElement(mr.Provider,{value:{autoConnect:!!h,wallets:U,wallet:F,publicKey:I,connected:D,connecting:v,disconnecting:A,select:p,connect:H,disconnect:q,sendTransaction:V,signTransaction:W,signAllTransactions:K,signMessage:G}},r)}function vr(e){return function(e){var t=e.adapters,r=e.userAgentString;return t.some((function(e){return e.name!==st&&e.readyState===a.Installed}))?or.DESKTOP_WEB:r&&/android/i.test(r)&&!function(e){return/(WebView|Version\/.+(Chrome)\/(\d+)\.(\d+)\.(\d+)\.(\d+)|; wv\).+(Chrome)\/(\d+)\.(\d+)\.(\d+)\.(\d+))/i.test(e)}(r)?or.MOBILE_WEB:or.DESKTOP_WEB}({adapters:e,userAgentString:function(){var e,t;return void 0===pr&&(pr=null!==(e=null===(t=globalThis.navigator)||void 0===t?void 0:t.userAgent)&&void 0!==e?e:null),pr}()})===or.MOBILE_WEB}function _r(){var e=globalThis.location;if(null!=e)return"".concat(e.protocol,"//").concat(e.host)}function br(e){var r=e.children,n=e.wallets,o=e.autoConnect,a=e.localStorageKey,u=void 0===a?"walletName":a,l=e.onError,h=(0,t.useContext)(be).connection,f=sr(n),d=(0,t.useMemo)((function(){if(!vr(f))return null;var e,t=f.find((function(e){return e.name===st}));return t||new lt({addressSelector:{select:function(e){return at(this,void 0,void 0,(0,c.Z)().mark((function t(){return(0,c.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",e[0]);case 1:case"end":return t.stop()}}),t)})))}},appIdentity:{uri:_r()},authorizationResultCache:ft(),cluster:(e=null===h||void 0===h?void 0:h.rpcEndpoint,e?/devnet/i.test(e)?"devnet":/testnet/i.test(e)?"testnet":"mainnet-beta":"mainnet-beta"),onWalletNotFound:dt})}),[f,null===h||void 0===h?void 0:h.rpcEndpoint]),p=(0,t.useMemo)((function(){return null==d||-1!==f.indexOf(d)?f:[d].concat((0,s.Z)(f))}),[f,d]),m=function(e,r){var n=(0,t.useState)((function(){try{var t=localStorage.getItem(e);if(t)return JSON.parse(t)}catch(n){"undefined"!==typeof window&&console.error(n)}return r})),i=n[0],o=(0,t.useRef)(!0);return(0,t.useEffect)((function(){if(o.current)o.current=!1;else try{null===i?localStorage.removeItem(e):localStorage.setItem(e,JSON.stringify(i))}catch(t){"undefined"!==typeof window&&console.error(t)}}),[i,e]),n}(u,vr(f)?st:null),g=(0,i.Z)(m,2),y=g[0],v=g[1],_=(0,t.useMemo)((function(){var e;return null!==(e=p.find((function(e){return e.name===y})))&&void 0!==e?e:null}),[p,y]),b=(0,t.useCallback)((function(e){y!==e&&(_&&_.name!==st&&_.disconnect(),v(e))}),[_,v,y]);(0,t.useEffect)((function(){if(null!=_)return _.on("disconnect",e),function(){_.off("disconnect",e)};function e(){k.current||y===st&&vr(f)||v(null)}}),[_,f,v,y]);var x=(0,t.useRef)(!1),w=(0,t.useMemo)((function(){if(!0===o&&_)return function(){return x.current?_.connect():_.autoConnect()}}),[_,o]),k=(0,t.useRef)(!1);(0,t.useEffect)((function(){if(y!==st||!vr(f))return window.addEventListener("beforeunload",e),function(){window.removeEventListener("beforeunload",e)};function e(){k.current=!0}k.current=!1}),[f,y]);var A=(0,t.useCallback)((function(){_&&_.name!==st&&b(null)}),[_,b]),E=(0,t.useCallback)((function(e){x.current=!0,b(e)}),[b]);return t.createElement(yr,{wallets:p,adapter:_,isUnloadingRef:k,onAutoConnectRequest:w,onConnectError:A,onError:l,onSelectWallet:E},r)}var xr={setVisible:function(e){console.error(wr("call","setVisible"))},visible:!1};function wr(e,t){return"You have tried to "+" ".concat(e,' "').concat(t,'"')+" on a WalletModalContext without providing one. Make sure to render a WalletModalProvider as an ancestor of the component that uses WalletModalContext"}Object.defineProperty(xr,"visible",{get:function(){return console.error(wr("read","visible")),!1}});var kr=(0,t.createContext)(xr);function Ar(){return(0,t.useContext)(kr)}var Er=r(4164),Sr=function(e){var r=e.id,n=e.children,i=e.expanded,o=void 0!==i&&i,a=(0,t.useRef)(null),s=(0,t.useRef)(!0);return(0,t.useLayoutEffect)((function(){o?function(){var e=a.current;e&&requestAnimationFrame((function(){e.style.height=e.scrollHeight+"px"}))}():function(){var e=a.current;e&&requestAnimationFrame((function(){e.style.height=e.offsetHeight+"px",e.style.overflow="hidden",requestAnimationFrame((function(){e.style.height="0"}))}))}()}),[o]),(0,t.useLayoutEffect)((function(){var e=a.current;if(e)return s.current&&(t(),s.current=!1),e.addEventListener("transitionend",r),function(){return e.removeEventListener("transitionend",r)};function t(){e&&(e.style.overflow=o?"initial":"hidden",o&&(e.style.height="auto"))}function r(r){e&&r.target===e&&"height"===r.propertyName&&t()}}),[o]),t.createElement("div",{className:"wallet-adapter-collapse",id:r,ref:a,role:"region",style:{height:0,transition:s.current?void 0:"height 250ms ease-out"}},n)},Tr=function(e){return t.createElement("button",{className:"wallet-adapter-button ".concat(e.className||""),disabled:e.disabled,style:e.style,onClick:e.onClick,tabIndex:e.tabIndex||0,type:"button"},e.startIcon&&t.createElement("i",{className:"wallet-adapter-button-start-icon"},e.startIcon),e.children,e.endIcon&&t.createElement("i",{className:"wallet-adapter-button-end-icon"},e.endIcon))},Mr=["wallet"],Ir=function(e){var r=e.wallet,n=(0,u.Z)(e,Mr);return r&&t.createElement("img",(0,V.Z)({src:r.adapter.icon,alt:"".concat(r.adapter.name," icon")},n))},Pr=function(e){var r=e.handleClick,n=e.tabIndex,i=e.wallet;return t.createElement("li",null,t.createElement(Tr,{onClick:r,startIcon:t.createElement(Ir,{wallet:i}),tabIndex:n},i.adapter.name,i.readyState===a.Installed&&t.createElement("span",null,"Detected")))},Cr=function(){return t.createElement("svg",{width:"97",height:"96",viewBox:"0 0 97 96",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t.createElement("circle",{cx:"48.5",cy:"48",r:"48",fill:"url(#paint0_linear_880_5115)",fillOpacity:"0.1"}),t.createElement("circle",{cx:"48.5",cy:"48",r:"47",stroke:"url(#paint1_linear_880_5115)",strokeOpacity:"0.4",strokeWidth:"2"}),t.createElement("g",{clipPath:"url(#clip0_880_5115)"},t.createElement("path",{d:"M65.5769 28.1523H31.4231C27.6057 28.1523 24.5 31.258 24.5 35.0754V60.9215C24.5 64.7389 27.6057 67.8446 31.4231 67.8446H65.5769C69.3943 67.8446 72.5 64.7389 72.5 60.9215V35.0754C72.5 31.258 69.3943 28.1523 65.5769 28.1523ZM69.7308 52.1523H59.5769C57.2865 52.1523 55.4231 50.289 55.4231 47.9985C55.4231 45.708 57.2864 43.8446 59.5769 43.8446H69.7308V52.1523ZM69.7308 41.0754H59.5769C55.7595 41.0754 52.6539 44.1811 52.6539 47.9985C52.6539 51.8159 55.7595 54.9215 59.5769 54.9215H69.7308V60.9215C69.7308 63.2119 67.8674 65.0754 65.5769 65.0754H31.4231C29.1327 65.0754 27.2692 63.212 27.2692 60.9215V35.0754C27.2692 32.785 29.1326 30.9215 31.4231 30.9215H65.5769C67.8673 30.9215 69.7308 32.7849 69.7308 35.0754V41.0754Z",fill:"url(#paint2_linear_880_5115)"}),t.createElement("path",{d:"M61.4231 46.6172H59.577C58.8123 46.6172 58.1924 47.2371 58.1924 48.0018C58.1924 48.7665 58.8123 49.3863 59.577 49.3863H61.4231C62.1878 49.3863 62.8077 48.7664 62.8077 48.0018C62.8077 47.2371 62.1878 46.6172 61.4231 46.6172Z",fill:"url(#paint3_linear_880_5115)"})),t.createElement("defs",null,t.createElement("linearGradient",{id:"paint0_linear_880_5115",x1:"3.41664",y1:"98.0933",x2:"103.05",y2:"8.42498",gradientUnits:"userSpaceOnUse"},t.createElement("stop",{stopColor:"#9945FF"}),t.createElement("stop",{offset:"0.14",stopColor:"#8A53F4"}),t.createElement("stop",{offset:"0.42",stopColor:"#6377D6"}),t.createElement("stop",{offset:"0.79",stopColor:"#24B0A7"}),t.createElement("stop",{offset:"0.99",stopColor:"#00D18C"}),t.createElement("stop",{offset:"1",stopColor:"#00D18C"})),t.createElement("linearGradient",{id:"paint1_linear_880_5115",x1:"3.41664",y1:"98.0933",x2:"103.05",y2:"8.42498",gradientUnits:"userSpaceOnUse"},t.createElement("stop",{stopColor:"#9945FF"}),t.createElement("stop",{offset:"0.14",stopColor:"#8A53F4"}),t.createElement("stop",{offset:"0.42",stopColor:"#6377D6"}),t.createElement("stop",{offset:"0.79",stopColor:"#24B0A7"}),t.createElement("stop",{offset:"0.99",stopColor:"#00D18C"}),t.createElement("stop",{offset:"1",stopColor:"#00D18C"})),t.createElement("linearGradient",{id:"paint2_linear_880_5115",x1:"25.9583",y1:"68.7101",x2:"67.2337",y2:"23.7879",gradientUnits:"userSpaceOnUse"},t.createElement("stop",{stopColor:"#9945FF"}),t.createElement("stop",{offset:"0.14",stopColor:"#8A53F4"}),t.createElement("stop",{offset:"0.42",stopColor:"#6377D6"}),t.createElement("stop",{offset:"0.79",stopColor:"#24B0A7"}),t.createElement("stop",{offset:"0.99",stopColor:"#00D18C"}),t.createElement("stop",{offset:"1",stopColor:"#00D18C"})),t.createElement("linearGradient",{id:"paint3_linear_880_5115",x1:"58.3326",y1:"49.4467",x2:"61.0002",y2:"45.4453",gradientUnits:"userSpaceOnUse"},t.createElement("stop",{stopColor:"#9945FF"}),t.createElement("stop",{offset:"0.14",stopColor:"#8A53F4"}),t.createElement("stop",{offset:"0.42",stopColor:"#6377D6"}),t.createElement("stop",{offset:"0.79",stopColor:"#24B0A7"}),t.createElement("stop",{offset:"0.99",stopColor:"#00D18C"}),t.createElement("stop",{offset:"1",stopColor:"#00D18C"})),t.createElement("clipPath",{id:"clip0_880_5115"},t.createElement("rect",{width:"48",height:"48",fill:"white",transform:"translate(24.5 24)"}))))},Br=function(e){var r=e.className,n=void 0===r?"":r,o=e.container,s=void 0===o?"body":o,u=(0,t.useRef)(null),c=gr(),l=c.wallets,h=c.select,f=Ar().setVisible,d=(0,t.useState)(!1),p=(0,i.Z)(d,2),g=p[0],y=p[1],v=(0,t.useState)(!1),_=(0,i.Z)(v,2),b=_[0],x=_[1],w=(0,t.useState)(null),k=(0,i.Z)(w,2),A=k[0],E=k[1],S=(0,t.useMemo)((function(){var e,t=[],r=[],n=[],i=(0,m.Z)(l);try{for(i.s();!(e=i.n()).done;){var o=e.value;o.readyState===a.NotDetected?n.push(o):o.readyState===a.Loadable?r.push(o):o.readyState===a.Installed&&t.push(o)}}catch(c){i.e(c)}finally{i.f()}var s=[],u=[];return t.length?(s=t,u=[].concat(r,n)):r.length?(s=r,u=n):u=n,[s,u]}),[l]),T=(0,i.Z)(S,2),M=T[0],I=T[1],P=(0,t.useCallback)((function(){x(!1),setTimeout((function(){return f(!1)}),150)}),[f]),C=(0,t.useCallback)((function(e){e.preventDefault(),P()}),[P]),B=(0,t.useCallback)((function(e,t){h(t),C(e)}),[h,C]),D=(0,t.useCallback)((function(){return y(!g)}),[g]),R=(0,t.useCallback)((function(e){var t=u.current;if(t){var r=t.querySelectorAll("button"),n=r[0],i=r[r.length-1];e.shiftKey?document.activeElement===n&&(i.focus(),e.preventDefault()):document.activeElement===i&&(n.focus(),e.preventDefault())}}),[u]);return(0,t.useLayoutEffect)((function(){var e=function(e){"Escape"===e.key?P():"Tab"===e.key&&R(e)},t=window.getComputedStyle(document.body).overflow;return setTimeout((function(){return x(!0)}),0),document.body.style.overflow="hidden",window.addEventListener("keydown",e,!1),function(){document.body.style.overflow=t,window.removeEventListener("keydown",e,!1)}}),[P,R]),(0,t.useLayoutEffect)((function(){return E(document.querySelector(s))}),[s]),A&&(0,Er.createPortal)(t.createElement("div",{"aria-labelledby":"wallet-adapter-modal-title","aria-modal":"true",className:"wallet-adapter-modal ".concat(b&&"wallet-adapter-modal-fade-in"," ").concat(n),ref:u,role:"dialog"},t.createElement("div",{className:"wallet-adapter-modal-container"},t.createElement("div",{className:"wallet-adapter-modal-wrapper"},t.createElement("button",{onClick:C,className:"wallet-adapter-modal-button-close"},t.createElement("svg",{width:"14",height:"14"},t.createElement("path",{d:"M14 12.461 8.3 6.772l5.234-5.233L12.006 0 6.772 5.234 1.54 0 0 1.539l5.234 5.233L0 12.006l1.539 1.528L6.772 8.3l5.69 5.7L14 12.461z"}))),M.length?t.createElement(t.Fragment,null,t.createElement("h1",{className:"wallet-adapter-modal-title"},"Connect a wallet on Solana to continue"),t.createElement("ul",{className:"wallet-adapter-modal-list"},M.map((function(e){return t.createElement(Pr,{key:e.adapter.name,handleClick:function(t){return B(t,e.adapter.name)},wallet:e})})),I.length?t.createElement(Sr,{expanded:g,id:"wallet-adapter-modal-collapse"},I.map((function(e){return t.createElement(Pr,{key:e.adapter.name,handleClick:function(t){return B(t,e.adapter.name)},tabIndex:g?0:-1,wallet:e})}))):null),I.length?t.createElement("button",{className:"wallet-adapter-modal-list-more",onClick:D,tabIndex:0},t.createElement("span",null,g?"Less ":"More ","options"),t.createElement("svg",{width:"13",height:"7",viewBox:"0 0 13 7",xmlns:"http://www.w3.org/2000/svg",className:"".concat(g?"wallet-adapter-modal-list-more-icon-rotate":"")},t.createElement("path",{d:"M0.71418 1.626L5.83323 6.26188C5.91574 6.33657 6.0181 6.39652 6.13327 6.43762C6.24844 6.47872 6.37371 6.5 6.50048 6.5C6.62725 6.5 6.75252 6.47872 6.8677 6.43762C6.98287 6.39652 7.08523 6.33657 7.16774 6.26188L12.2868 1.626C12.7753 1.1835 12.3703 0.5 11.6195 0.5H1.37997C0.629216 0.5 0.224175 1.1835 0.71418 1.626Z"}))):null):t.createElement(t.Fragment,null,t.createElement("h1",{className:"wallet-adapter-modal-title"},"You'll need a wallet on Solana to continue"),t.createElement("div",{className:"wallet-adapter-modal-middle"},t.createElement(Cr,null)),I.length?t.createElement(t.Fragment,null,t.createElement("button",{className:"wallet-adapter-modal-list-more",onClick:D,tabIndex:0},t.createElement("span",null,g?"Hide ":"Already have a wallet? View ","options"),t.createElement("svg",{width:"13",height:"7",viewBox:"0 0 13 7",xmlns:"http://www.w3.org/2000/svg",className:"".concat(g?"wallet-adapter-modal-list-more-icon-rotate":"")},t.createElement("path",{d:"M0.71418 1.626L5.83323 6.26188C5.91574 6.33657 6.0181 6.39652 6.13327 6.43762C6.24844 6.47872 6.37371 6.5 6.50048 6.5C6.62725 6.5 6.75252 6.47872 6.8677 6.43762C6.98287 6.39652 7.08523 6.33657 7.16774 6.26188L12.2868 1.626C12.7753 1.1835 12.3703 0.5 11.6195 0.5H1.37997C0.629216 0.5 0.224175 1.1835 0.71418 1.626Z"}))),t.createElement(Sr,{expanded:g,id:"wallet-adapter-modal-collapse"},t.createElement("ul",{className:"wallet-adapter-modal-list"},I.map((function(e){return t.createElement(Pr,{key:e.adapter.name,handleClick:function(t){return B(t,e.adapter.name)},tabIndex:g?0:-1,wallet:e})}))))):null))),t.createElement("div",{className:"wallet-adapter-modal-overlay",onMouseDown:C})),A)},Dr=["children"],Rr=function(e){var r=e.children,n=(0,u.Z)(e,Dr),o=(0,t.useState)(!1),a=(0,i.Z)(o,2),s=a[0],c=a[1];return t.createElement(kr.Provider,{value:{visible:s,setVisible:c}},r,s&&t.createElement(Br,(0,V.Z)({},n)))},Lr=r.p+"static/media/ohr2.9a19ab9d0e5de8ecbd48.png",Or=["children","disabled","onClick"],zr=function(e){var r=e.children,n=e.disabled,i=e.onClick,o=(0,u.Z)(e,Or),a=gr(),s=a.wallet,c=a.connect,l=a.connecting,h=a.connected,f=(0,t.useCallback)((function(e){i&&i(e),e.defaultPrevented||c().catch((function(){}))}),[i,c]),d=(0,t.useMemo)((function(){return r||(l?"Connecting ...":h?"Connected":s?"Connect":"Connect Wallet")}),[r,l,h,s]);return t.createElement(Tr,(0,V.Z)({className:"wallet-adapter-button-trigger",disabled:n||!s||l||h,startIcon:s?t.createElement(Ir,{wallet:s}):void 0,onClick:f},o),d)},Nr=["children","onClick"],Ur=function(e){var r=e.children,n=void 0===r?"Select Wallet":r,i=e.onClick,o=(0,u.Z)(e,Nr),a=Ar(),s=a.visible,c=a.setVisible,l=(0,t.useCallback)((function(e){i&&i(e),e.defaultPrevented||c(!s)}),[i,c,s]);return t.createElement(Tr,(0,V.Z)({className:"wallet-adapter-button-trigger",onClick:l},o),n)},Zr=["children"],Fr=function(e){var r=e.children,n=(0,u.Z)(e,Zr),o=gr(),a=o.publicKey,s=o.wallet,h=o.disconnect,f=Ar().setVisible,d=(0,t.useState)(!1),p=(0,i.Z)(d,2),m=p[0],g=p[1],y=(0,t.useState)(!1),v=(0,i.Z)(y,2),_=v[0],b=v[1],x=(0,t.useRef)(null),w=(0,t.useMemo)((function(){return null===a||void 0===a?void 0:a.toBase58()}),[a]),k=(0,t.useMemo)((function(){return r||(s&&w?w.slice(0,4)+".."+w.slice(-4):null)}),[r,s,w]),A=(0,t.useCallback)((0,l.Z)((0,c.Z)().mark((function e(){return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!w){e.next=5;break}return e.next=3,navigator.clipboard.writeText(w);case 3:g(!0),setTimeout((function(){return g(!1)}),400);case 5:case"end":return e.stop()}}),e)}))),[w]),E=(0,t.useCallback)((function(){b(!0)}),[]),S=(0,t.useCallback)((function(){b(!1)}),[]),T=(0,t.useCallback)((function(){f(!0),S()}),[f,S]);return(0,t.useEffect)((function(){var e=function(e){var t=x.current;t&&!t.contains(e.target)&&S()};return document.addEventListener("mousedown",e),document.addEventListener("touchstart",e),function(){document.removeEventListener("mousedown",e),document.removeEventListener("touchstart",e)}}),[x,S]),s?w?t.createElement("div",{className:"wallet-adapter-dropdown"},t.createElement(Tr,(0,V.Z)({"aria-expanded":_,className:"wallet-adapter-button-trigger",style:(0,V.Z)({pointerEvents:_?"none":"auto"},n.style),onClick:E,startIcon:t.createElement(Ir,{wallet:s})},n),k),t.createElement("ul",{"aria-label":"dropdown-list",className:"wallet-adapter-dropdown-list ".concat(_&&"wallet-adapter-dropdown-list-active"),ref:x,role:"menu"},t.createElement("li",{onClick:A,className:"wallet-adapter-dropdown-list-item",role:"menuitem"},m?"Copied":"Copy address"),t.createElement("li",{onClick:T,className:"wallet-adapter-dropdown-list-item",role:"menuitem"},"Change wallet"),t.createElement("li",{onClick:h,className:"wallet-adapter-dropdown-list-item",role:"menuitem"},"Disconnect"))):t.createElement(zr,(0,V.Z)({},n),r):t.createElement(Ur,(0,V.Z)({},n),r)},jr=r(184);var Vr=function(e){var t=e.ear;return(0,jr.jsx)("div",{className:"central-inner-container",children:(0,jr.jsx)("button",{className:"huge-ear",children:(0,jr.jsx)("img",{src:t,alt:"Ear recording button"})})})};var Wr=function(e){var r=e.recording,n=e.recUrl,o=(0,t.useState)(7),a=(0,i.Z)(o,2),s=a[0],u=a[1];return(0,t.useEffect)((function(){u(7)}),[n]),(0,t.useEffect)((function(){var e;return r&&s>0&&(e=setTimeout((function(){u((function(e){return e-1}))}),1e3)),function(){return clearTimeout(e)}}),[r,s]),(0,t.useEffect)((function(){r||u(s)}),[r]),(0,jr.jsxs)("div",{className:"timer",children:[" 00.0",s]})},Kr=function(e){var r=e.ear,n=(e.setVisualisationView,e.onRecorded),o=e.setView,a=(0,t.useState)(!1),s=(0,i.Z)(a,2),u=s[0],h=s[1],f=(0,t.useState)(!1),d=(0,i.Z)(f,2),p=d[0],m=d[1],g=(0,t.useState)(null),y=(0,i.Z)(g,2),v=y[0],_=y[1],b=function(){var e=(0,l.Z)((0,c.Z)().mark((function e(){var t,r,i;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h(!0),e.next=3,navigator.mediaDevices.getUserMedia({audio:!0});case 3:t=e.sent,navigator.getUserMedia&&console.log("RECORDING STARTED"),r=new MediaRecorder(t),i=[],r.ondataavailable=function(e){i.push(e.data)},r.onstop=function(){var e=(0,l.Z)((0,c.Z)().mark((function e(t){var r,o;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("RECORDING STOPPED"),r=new Blob(i,{type:"audio/wav; codecs=0"}),o=URL.createObjectURL(r),n(r),_(o),h(!1),m(!0);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),r.start(),setTimeout((function(){r.stop()}),7e3);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),x=function(){var e=(0,l.Z)((0,c.Z)().mark((function e(){return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:v&&new Audio(v).play();case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,jr.jsxs)(jr.Fragment,{children:[(0,jr.jsxs)("div",{className:"central-inner-container",children:[(0,jr.jsx)(Wr,{recording:u,recUrl:v}),(0,jr.jsxs)("div",{className:"recording-container",children:[(0,jr.jsx)("button",{className:p?"huge-ear":"huge-ear rec",disabled:p,onClick:b,children:(0,jr.jsx)("img",{src:r,alt:"Ear recording button"})}),(0,jr.jsx)("div",{children:(0,jr.jsx)("p",{className:"text",children:"press the ear to record a sound"})})]})]}),p?(0,jr.jsxs)("div",{className:"btn-group btn-group-vertical grupped",children:[(0,jr.jsx)("button",{className:"btn",onClick:x,children:"play"}),(0,jr.jsx)("button",{className:"btn",onClick:function(){window.confirm("Are you sure you want to discard your audio?")&&(m(!1),_(null))},children:"discard"}),(0,jr.jsx)("button",{className:"btn",onClick:function(){o("map"),m(!1)},children:"continue"})]}):null]})},Gr=function(){gr();return(0,jr.jsx)("div",{className:"flex justify-center\t",children:(0,jr.jsx)(Fr,{className:"wallet-button glowing-border"})})},Hr=r(3373),qr=r.n(Hr);function Yr(e){var t,r,n="";if("string"==typeof e||"number"==typeof e)n+=e;else if("object"==typeof e)if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(r=Yr(e[t]))&&(n&&(n+=" "),n+=r);else for(t in e)e[t]&&(n&&(n+=" "),n+=t);return n}function Xr(){for(var e,t,r=0,n="";r<arguments.length;)(e=arguments[r++])&&(t=Yr(e))&&(n&&(n+=" "),n+=t);return n}var Qr=function(e){var r=e.style,n=(0,t.useRef)(null),o=(0,t.useRef)(null),a=(0,t.useState)(-70.9),s=(0,i.Z)(a,2),u=s[0],c=s[1],l=(0,t.useState)(42.35),h=(0,i.Z)(l,2),f=h[0],d=h[1],p=(0,t.useState)(1.25),m=(0,i.Z)(p,2),g=m[0],y=m[1];return qr().accessToken="pk.eyJ1Ijoibm9hbWllMjIiLCJhIjoiY2xmMmoxZjYwMGowdjN5cG5vMXJzY2J4eCJ9.R1-JKFMkvmsuDf7Mk-CoNg",(0,t.useEffect)((function(){o.current||(o.current=new(qr().Map)({container:n.current,style:"mapbox://styles/mapbox/dark-v10",center:[u,f],zoom:g}))})),(0,t.useEffect)((function(){o.current&&o.current.on("move",(function(){c(o.current.getCenter().lng.toFixed(4)),d(o.current.getCenter().lat.toFixed(4)),y(o.current.getZoom().toFixed(2))}))})),(0,jr.jsx)("div",{ref:n,className:Xr(r,"m-box")})};var $r=function(e){var t=e.setView;return(0,jr.jsxs)("button",{className:"home-btn",onClick:function(){window.confirm("Are you sure you want to go back to the main page? You will lose your recording.")&&t("")},children:[(0,jr.jsx)("h1",{className:"app-title",children:"\xf8hr"}),(0,jr.jsx)("h1",{className:"app-title-top",children:"\xf8hr"})]})};var Jr=function(e){var t=e.setView;return(0,jr.jsxs)("div",{className:"navbar bg-base-100",children:[(0,jr.jsxs)("div",{className:"flex-1",children:[(0,jr.jsx)($r,{setView:t}),(0,jr.jsx)("input",{type:"checkbox",id:"my-modal-5",className:"modal-toggle"}),(0,jr.jsx)("label",{htmlFor:"my-modal-5",className:"modal cursor-pointer",children:(0,jr.jsx)("label",{className:"relative",htmlFor:"",children:(0,jr.jsx)(Qr,{style:"map-container"})})})]}),(0,jr.jsx)("div",{className:"flex-none gap-2",children:(0,jr.jsx)("div",{className:"dropdown dropdown-end",children:(0,jr.jsx)(Gr,{className:"btn btn-active"})})})]})};var en,tn=function(){return(0,jr.jsxs)("div",{className:"navbar bg-base-100",children:[(0,jr.jsxs)("div",{className:"flex-1",children:[(0,jr.jsx)("label",{htmlFor:"my-modal-4",className:"btn btn-ghost normal-case text-xl",children:"how it works"}),(0,jr.jsx)("input",{type:"checkbox",id:"my-modal-4",className:"modal-toggle"}),(0,jr.jsx)("label",{htmlFor:"my-modal-4",className:"modal cursor-pointer",children:(0,jr.jsx)("label",{className:"modal-box relative",htmlFor:"",children:(0,jr.jsxs)("div",{className:"py-4",children:[(0,jr.jsx)("h1",{children:"Inspired to capture a moment?"}),(0,jr.jsxs)("ol",{children:[(0,jr.jsx)("li",{children:"1. Hold the \ud83d\udc42 button to record sound"}),(0,jr.jsx)("li",{children:"2. Listen, continue or re-record"}),(0,jr.jsx)("li",{children:"3. If you want, add your location"}),(0,jr.jsx)("li",{children:"4. A unique visual is generated for you"}),(0,jr.jsx)("li",{children:"5. Mint your audio NFT!"})]})]})})})]}),(0,jr.jsx)("div",{className:"flex-none gap-2",children:(0,jr.jsx)("div",{className:"flex-1",children:(0,jr.jsx)("a",{className:"btn btn-ghost text-xl fa-brands fa-twitter blue",href:"https://twitter.com/ohr_xyz",target:"_blank",rel:"noopener noreferrer"})})})]})},rn=r(4569),nn=r.n(rn),on=(r(5090),r(9778)),an=r(3717),sn=r(261),un=r(3340),cn=r(518),ln=r.n(cn),hn=r(3604),fn=r(6493),dn=r(3258),pn=r(9778).Buffer;function mn(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{u(n.next(e))}catch(t){o(t)}}function s(e){try{u(n.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}u((n=n.apply(e,t||[])).next())}))}!function(e){e.USD="usd",e.EUR="eur",e.AR="ar",e.SOL="sol"}(en||(en={}));var gn;"object"==typeof self?self.FormData:window.FormData,Math.pow(10,9),Math.pow(10,12);!function(e){e[e.MainnetBeta=101]="MainnetBeta",e[e.Testnet=102]="Testnet",e[e.Devnet=103]="Devnet"}(gn||(gn={}));var yn={devnet:{endpoint:(0,o.clusterApiUrl)("devnet"),ChainId:gn.Devnet},"mainnet-beta":{endpoint:"https://api.metaplex.solana.com/",ChainId:gn.MainnetBeta},"mainnet-beta (Solana)":{endpoint:"https://api.mainnet-beta.solana.com",ChainId:gn.MainnetBeta},"mainnet-beta (Serum)":{endpoint:"https://solana-api.projectserum.com/",ChainId:gn.MainnetBeta},testnet:{endpoint:(0,o.clusterApiUrl)("testnet"),ChainId:gn.Testnet}},vn=(o.Connection,function(e){return mn(void 0,void 0,void 0,(0,c.Z)().mark((function t(){var r,n;return(0,c.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,nn().get(e);case 3:return r=t.sent,n=r.data,t.abrupt("return",n);case 8:throw t.prev=8,t.t0=t.catch(0),new Error("unable to get metadata json from url ".concat(e));case 11:case"end":return t.stop()}}),t,null,[[0,8]])})))}),_n=(un.Transaction,function(e){(0,d.Z)(r,e);var t=(0,p.Z)(r);function r(e,n){var i;(0,h.Z)(this,r);var a=e.feePayer,s=n.newAccountPubkey,u=n.lamports,c=n.decimals,l=n.owner,f=n.freezeAuthority;return(i=t.call(this,e)).add(o.SystemProgram.createAccount({fromPubkey:a,newAccountPubkey:s,lamports:u,space:an.MintLayout.span,programId:an.TOKEN_PROGRAM_ID})),i.add(an.Token.createInitMintInstruction(an.TOKEN_PROGRAM_ID,s,null!==c&&void 0!==c?c:0,null!==l&&void 0!==l?l:a,null!==f&&void 0!==f?f:a)),i}return(0,f.Z)(r)}(un.Transaction)),bn=function(e){(0,d.Z)(r,e);var t=(0,p.Z)(r);function r(e,n){var i;(0,h.Z)(this,r);var a=e.feePayer,s=n.newAccountPubkey,u=n.lamports,c=n.mint,l=n.owner;return(i=t.call(this,e)).add(o.SystemProgram.createAccount({fromPubkey:a,newAccountPubkey:s,lamports:u,space:an.AccountLayout.span,programId:an.TOKEN_PROGRAM_ID})),i.add(an.Token.createInitAccountInstruction(an.TOKEN_PROGRAM_ID,c,s,null!==l&&void 0!==l?l:a)),i}return(0,f.Z)(r)}(un.Transaction),xn=function(e){(0,d.Z)(r,e);var t=(0,p.Z)(r);function r(e,n){var i;(0,h.Z)(this,r);var a=e.feePayer,s=n.associatedTokenAddress,u=n.walletAddress,c=n.splTokenMintAddress;return(i=t.call(this,e)).add(new o.TransactionInstruction({keys:[{pubkey:a,isSigner:!0,isWritable:!0},{pubkey:s,isSigner:!1,isWritable:!0},{pubkey:null!==u&&void 0!==u?u:a,isSigner:!1,isWritable:!1},{pubkey:c,isSigner:!1,isWritable:!1},{pubkey:o.SystemProgram.programId,isSigner:!1,isWritable:!1},{pubkey:an.TOKEN_PROGRAM_ID,isSigner:!1,isWritable:!1},{pubkey:o.SYSVAR_RENT_PUBKEY,isSigner:!1,isWritable:!1}],programId:an.ASSOCIATED_TOKEN_PROGRAM_ID,data:on.Buffer.from([])})),i}return(0,f.Z)(r)}(un.Transaction),wn=function(e){(0,d.Z)(r,e);var t=(0,p.Z)(r);function r(e,n){var i;(0,h.Z)(this,r);var o=e.feePayer,a=n.mint,s=n.dest,u=n.authority,c=n.amount;return(i=t.call(this,e)).add(an.Token.createMintToInstruction(an.TOKEN_PROGRAM_ID,a,s,null!==u&&void 0!==u?u:o,[],new(ln())(c).toNumber())),i}return(0,f.Z)(r)}(un.Transaction);function kn(e,t){return mn(this,void 0,void 0,(0,c.Z)().mark((function r(){var n,i,a,s,u,l;return(0,c.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n=o.Keypair.generate(),r.next=3,e.getMinimumBalanceForRentExemption(an.MintLayout.span);case 3:return i=r.sent,a=new _n({feePayer:t},{newAccountPubkey:n.publicKey,lamports:i}),r.next=7,an.Token.getAssociatedTokenAddress(an.ASSOCIATED_TOKEN_PROGRAM_ID,an.TOKEN_PROGRAM_ID,n.publicKey,t);case 7:return s=r.sent,u=new xn({feePayer:t},{associatedTokenAddress:s,splTokenMintAddress:n.publicKey}),l=new wn({feePayer:t},{mint:n.publicKey,dest:s,amount:1}),r.abrupt("return",{mint:n,createMintTx:a,createAssociatedTokenAccountTx:u,mintToTx:l,recipient:s});case 11:case"end":return r.stop()}}),r)})))}function An(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return mn(this,void 0,void 0,(0,c.Z)().mark((function n(){var i,a,s,u;return(0,c.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=o.Keypair.generate(),n.next=3,e.getMinimumBalanceForRentExemption(an.AccountLayout.span);case 3:return a=n.sent,s=new bn({feePayer:t},{newAccountPubkey:i.publicKey,lamports:r+a,mint:an.NATIVE_MINT}),u=(new un.Transaction).add(an.Token.createCloseAccountInstruction(an.TOKEN_PROGRAM_ID,i.publicKey,t,t,[])),n.abrupt("return",{account:i,createTokenAccountTx:s,closeTokenAccountTx:u});case 7:case"end":return n.stop()}}),n)})))}function En(e){var t=e.authority,r=void 0===t?o.Keypair.generate():t,n=e.account,i=e.owner,a=e.amount;return{authority:r,createApproveTx:(new o.Transaction).add(an.Token.createApproveInstruction(an.TOKEN_PROGRAM_ID,n,r.publicKey,i,[],a)),createRevokeTx:(new o.Transaction).add(an.Token.createRevokeInstruction(an.TOKEN_PROGRAM_ID,n,i,[]))}}var Sn=function(e){var t=e.connection,r=e.wallet,n=e.txs,i=e.signers,o=void 0===i?[]:i,a=e.options;return mn(void 0,void 0,void 0,(0,c.Z)().mark((function e(){var i,u;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=un.Transaction.fromCombined(n,{feePayer:r.publicKey}),e.next=3,t.getRecentBlockhash();case 3:return i.recentBlockhash=e.sent.blockhash,o.length&&(u=i).partialSign.apply(u,(0,s.Z)(o)),e.next=7,r.signTransaction(i);case 7:return i=e.sent,e.abrupt("return",t.sendRawTransaction(i.serialize(),a));case 9:case"end":return e.stop()}}),e)})))},Tn=function(){function e(t){var r=t.beforeTransactions,n=void 0===r?[]:r,i=t.transactions,o=t.afterTransactions,a=void 0===o?[]:o;(0,h.Z)(this,e),this.signers=[],this.beforeTransactions=n,this.transactions=i,this.afterTransactions=a}return(0,f.Z)(e,[{key:"addSigner",value:function(e){this.signers.push(e)}},{key:"addBeforeTransaction",value:function(e){this.beforeTransactions.push(e)}},{key:"addTransaction",value:function(e){this.transactions.push(e)}},{key:"addAfterTransaction",value:function(e){this.afterTransactions.push(e)}},{key:"toTransactions",value:function(){return[].concat((0,s.Z)(this.beforeTransactions),(0,s.Z)(this.transactions),(0,s.Z)(this.afterTransactions))}},{key:"toInstructions",value:function(){return this.toTransactions().flatMap((function(e){return e.instructions}))}}]),e}(),Mn=function(e){var t=e.connection,r=e.wallet,n=e.auction,i=e.bidderPotToken,a=e.destAccount;return mn(void 0,void 0,void 0,(0,c.Z)().mark((function e(){var s,u,l,h,f,d,p,m,g,y,v,_,b;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=r.publicKey,e.next=3,hn.AuctionManager.getPDA(n);case 3:return u=e.sent,e.next=6,hn.AuctionManager.load(t,u);case 6:return l=e.sent,e.next=9,l.getAuction(t);case 9:return h=e.sent,f=h.data.tokenMint,d=new o.PublicKey(f),p=new o.PublicKey(l.data.vault),e.next=15,dn.AuctionExtended.getPDA(p);case 15:return m=e.sent,e.next=18,dn.BidderPot.getPDA(n,s);case 18:return g=e.sent,e.next=21,dn.BidderMetadata.getPDA(n,s);case 21:return y=e.sent,e.next=24,t.getMinimumBalanceForRentExemption(an.AccountLayout.span);case 24:return v=e.sent,e.next=27,In({destAccount:a,bidder:s,accountRentExempt:v,bidderPot:g,bidderPotToken:i,bidderMeta:y,auction:n,auctionExtended:m,auctionTokenMint:d,vault:p});case 27:return _=e.sent,e.next=30,Sn({connection:t,wallet:r,txs:_.toTransactions(),signers:_.signers});case 30:return b=e.sent,e.abrupt("return",{txId:b});case 32:case"end":return e.stop()}}),e)})))},In=function(e){var t=e.destAccount,r=e.bidder,n=e.accountRentExempt,i=e.bidderPot,a=e.bidderPotToken,s=e.bidderMeta,u=e.auction,l=e.auctionExtended,h=e.auctionTokenMint,f=e.vault;return mn(void 0,void 0,void 0,(0,c.Z)().mark((function e(){var d,p,m,g,y;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return d=new Tn({transactions:[]}),t||(p=o.Keypair.generate(),m=new bn({feePayer:r},{newAccountPubkey:p.publicKey,lamports:n,mint:an.NATIVE_MINT}),g=(new un.Transaction).add(an.Token.createCloseAccountInstruction(an.TOKEN_PROGRAM_ID,p.publicKey,r,r,[])),d.addTransaction(m),d.addAfterTransaction(g),d.addSigner(p),t=p.publicKey),y=new dn.CancelBid({feePayer:r},{bidder:r,bidderToken:t,bidderPot:i,bidderPotToken:a,bidderMeta:s,auction:u,auctionExtended:l,tokenMint:h,resource:f}),d.addTransaction(y),e.abrupt("return",d);case 5:case"end":return e.stop()}}),e)})))},Pn=function(e){var t=e.connection,r=e.wallet,n=e.amount,i=e.auction,a=e.bidderPotToken;return mn(void 0,void 0,void 0,(0,c.Z)().mark((function e(){var s,u,l,h,f,d,p,m,g,y,v,_,b,x,w,k,A,E,S,T,M,I,P,C;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=r.publicKey,e.next=3,t.getMinimumBalanceForRentExemption(an.AccountLayout.span);case 3:return u=e.sent,e.next=6,hn.AuctionManager.getPDA(i);case 6:return l=e.sent,e.next=9,hn.AuctionManager.load(t,l);case 9:return h=e.sent,e.next=12,h.getAuction(t);case 12:return f=e.sent,d=f.data.tokenMint,p=new o.PublicKey(d),m=new o.PublicKey(h.data.vault),e.next=18,dn.AuctionExtended.getPDA(m);case 18:return g=e.sent,e.next=21,dn.BidderPot.getPDA(i,s);case 21:return y=e.sent,e.next=24,dn.BidderMetadata.getPDA(i,s);case 24:if(v=e.sent,_=new Tn({transactions:[]}),!a){e.next=32;break}return e.next=29,In({destAccount:null,bidder:s,accountRentExempt:u,bidderPot:y,bidderPotToken:a,bidderMeta:v,auction:i,auctionExtended:g,auctionTokenMint:p,vault:m});case 29:_=e.sent,e.next=37;break;case 32:b=o.Keypair.generate(),x=new bn({feePayer:s},{newAccountPubkey:b.publicKey,lamports:u,mint:p,owner:i}),_.addSigner(b),_.addTransaction(x),a=b.publicKey;case 37:return e.next=39,An(t,s,n.toNumber()+2*u);case 39:return w=e.sent,k=w.account,A=w.createTokenAccountTx,E=w.closeTokenAccountTx,_.addTransaction(A),_.addAfterTransaction(E),_.addSigner(k),S=En({account:k.publicKey,owner:s,amount:n.toNumber()}),T=S.authority,M=S.createApproveTx,I=S.createRevokeTx,_.addTransaction(M),_.addAfterTransaction(I),_.addSigner(T),P=new dn.PlaceBid({feePayer:s},{bidder:s,bidderToken:k.publicKey,bidderPot:y,bidderPotToken:a,bidderMeta:v,auction:i,auctionExtended:g,tokenMint:p,transferAuthority:T.publicKey,amount:n,resource:m}),_.addTransaction(P),e.next=54,Sn({connection:t,wallet:r,txs:_.toTransactions(),signers:_.signers});case 54:return C=e.sent,e.abrupt("return",{txId:C,bidderPotToken:a,bidderMeta:v});case 56:case"end":return e.stop()}}),e)})))},Cn=function(e){var t=e.connection,r=e.wallet,n=e.store,a=e.auction;return mn(void 0,void 0,void 0,(0,c.Z)().mark((function e(){var s,u,l,h,f,d,p,m,g,y,v,_,b,x,w,k,A,E,S;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=r.publicKey,e.next=3,t.getMinimumBalanceForRentExemption(an.AccountLayout.span);case 3:return u=e.sent,e.next=6,hn.AuctionManager.getPDA(a);case 6:return l=e.sent,e.next=9,hn.AuctionManager.load(t,l);case 9:return h=e.sent,e.next=12,sn.Vault.load(t,h.data.vault);case 12:return f=e.sent,d=new o.PublicKey(f.data.fractionMint),e.next=16,dn.AuctionExtended.getPDA(f.pubkey);case 16:return p=e.sent,e.next=19,f.getSafetyDepositBoxes(t);case 19:return m=e.sent,g=(0,i.Z)(m,1),y=g[0],v=new o.PublicKey(y.data.tokenMint),_=new o.PublicKey(y.data.store),e.next=26,dn.BidderMetadata.getPDA(a,s);case 26:return b=e.sent,e.next=29,Dn(a,b);case 29:return x=e.sent,e.next=32,hn.SafetyDepositConfig.getPDA(l,y.pubkey);case 32:return w=e.sent,e.next=35,sn.Vault.getPDA(f.pubkey);case 35:return k=e.sent,e.next=38,fn.Metadata.getPDA(v);case 38:return A=e.sent,e.next=41,Bn({accountRentExempt:u,tokenMint:v,bidder:s,bidderMeta:b,store:n,vault:f.pubkey,auction:a,auctionExtended:p,auctionManager:l,fractionMint:d,safetyDepositTokenStore:_,safetyDeposit:y.pubkey,bidRedemption:x,safetyDepositConfig:w,transferAuthority:k,metadata:A});case 41:return E=e.sent,e.next=44,Sn({connection:t,wallet:r,txs:E.toTransactions(),signers:E.signers});case 44:return S=e.sent,e.abrupt("return",{txId:S});case 46:case"end":return e.stop()}}),e)})))},Bn=function(e){var t=e.accountRentExempt,r=e.bidder,n=e.tokenMint,i=e.store,a=e.vault,s=e.auction,u=e.auctionManager,l=e.auctionExtended,h=e.bidRedemption,f=e.bidderMeta,d=e.safetyDepositTokenStore,p=e.safetyDeposit,m=e.fractionMint,g=e.safetyDepositConfig,y=e.transferAuthority,v=e.metadata;return mn(void 0,void 0,void 0,(0,c.Z)().mark((function e(){var _,b,x,w,k;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return _=new Tn({transactions:[]}),b=o.Keypair.generate(),x=new bn({feePayer:r},{newAccountPubkey:b.publicKey,lamports:t,mint:n}),_.addSigner(b),_.addTransaction(x),w=new hn.RedeemFullRightsTransferBid({feePayer:r},{store:i,vault:a,auction:s,auctionManager:u,bidRedemption:h,bidMetadata:f,safetyDepositTokenStore:d,destination:b.publicKey,safetyDeposit:p,fractionMint:m,bidder:r,safetyDepositConfig:g,auctionExtended:l,transferAuthority:y,newAuthority:r,masterMetadata:v}),_.addTransaction(w),k=new fn.UpdatePrimarySaleHappenedViaToken({feePayer:r},{metadata:v,owner:r,tokenAccount:b.publicKey}),_.addTransaction(k),e.abrupt("return",_);case 10:case"end":return e.stop()}}),e)})))},Dn=function(e,t){return mn(void 0,void 0,void 0,(0,c.Z)().mark((function r(){return(0,c.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,o.PublicKey.findProgramAddress([pn.from(hn.MetaplexProgram.PREFIX),e.toBuffer(),t.toBuffer()],hn.MetaplexProgram.PUBKEY);case 2:return r.abrupt("return",r.sent[0]);case 3:case"end":return r.stop()}}),r)})))},Rn=function(e){var t=e.connection,r=e.wallet,n=e.store,a=e.auction;return mn(void 0,void 0,void 0,(0,c.Z)().mark((function e(){var s,u,l,h,f,d,p,m,g,y,v,_,b,x,w,k,A,E,S,T,M,I,P,C,B,D,R,L,O,z,N,U,Z,F,j,V,W;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=r.publicKey,e.next=3,dn.Auction.load(t,a);case 3:return u=e.sent,l=u.data.bidState,e.next=7,hn.AuctionManager.getPDA(a);case 7:return h=e.sent,e.next=10,hn.AuctionManager.load(t,h);case 10:return f=e.sent,e.next=13,sn.Vault.load(t,f.data.vault);case 13:return d=e.sent,e.next=16,dn.AuctionExtended.getPDA(d.pubkey);case 16:return p=e.sent,e.next=19,d.getSafetyDepositBoxes(t);case 19:return m=e.sent,g=(0,i.Z)(m,1),y=g[0],v=new o.PublicKey(y.data.tokenMint),_=new o.PublicKey(y.data.store),e.next=26,dn.BidderMetadata.getPDA(a,s);case 26:return b=e.sent,e.next=29,Dn(a,b);case 29:return x=e.sent,e.next=32,hn.SafetyDepositConfig.getPDA(h,y.pubkey);case 32:return w=e.sent,e.next=35,kn(t,r.publicKey);case 35:return k=e.sent,A=k.mint,E=k.createMintTx,S=k.createAssociatedTokenAccountTx,T=k.mintToTx,M=k.recipient,I=A.publicKey,e.next=44,fn.Metadata.getPDA(I);case 44:return P=e.sent,e.next=47,fn.Edition.getPDA(I);case 47:return C=e.sent,e.next=50,fn.Metadata.getPDA(v);case 50:return B=e.sent,e.next=53,fn.MasterEdition.getPDA(v);case 53:return D=e.sent,e.next=56,fn.MasterEdition.load(t,D);case 56:return R=e.sent,e.next=59,hn.PrizeTrackingTicket.getPDA(h,v);case 59:return L=e.sent,e.prev=60,e.next=63,hn.PrizeTrackingTicket.load(t,L);case 63:O=e.sent,e.next=69;break;case 66:e.prev=66,e.t0=e.catch(60),O=null;case 69:return z=l.getWinnerIndex(s.toBase58())||0,N=On(z),U=(null===O||void 0===O?void 0:O.data.supplySnapshot)||R.data.supply,Z=U.add(N),e.next=75,fn.EditionMarker.getPDA(v,Z);case 75:return F=e.sent,e.prev=76,e.next=79,fn.EditionMarker.load(t,F);case 79:if(j=e.sent,!j.data.editionTaken(Z.toNumber())){e.next=83;break}throw new Error("The edition is already taken");case 83:e.next=87;break;case 85:e.prev=85,e.t1=e.catch(76);case 87:return e.next=89,Ln({bidder:s,bidderMeta:b,store:n,vault:d.pubkey,destination:M,auction:a,auctionExtended:p,auctionManager:h,safetyDepositTokenStore:_,safetyDeposit:y.pubkey,bidRedemption:x,safetyDepositConfig:w,metadata:B,newMint:I,newMetadata:P,newEdition:C,masterEdition:D,editionMarker:F,prizeTrackingTicket:L,editionOffset:N,winIndex:new(ln())(z)});case 89:return(V=e.sent).addSigner(A),V.addBeforeTransaction(E),V.addBeforeTransaction(S),V.addBeforeTransaction(T),e.next=96,Sn({connection:t,wallet:r,txs:V.toTransactions(),signers:V.signers});case 96:return W=e.sent,e.abrupt("return",{txId:W});case 98:case"end":return e.stop()}}),e,null,[[60,66],[76,85]])})))},Ln=function(e){var t=e.bidder,r=e.destination,n=e.store,i=e.vault,o=e.auction,a=e.auctionManager,s=e.auctionExtended,u=e.bidRedemption,l=e.bidderMeta,h=e.safetyDepositTokenStore,f=e.safetyDeposit,d=e.safetyDepositConfig,p=e.metadata,m=e.newMint,g=e.newMetadata,y=e.newEdition,v=e.masterEdition,_=e.editionMarker,b=e.prizeTrackingTicket,x=e.winIndex,w=e.editionOffset;return mn(void 0,void 0,void 0,(0,c.Z)().mark((function e(){var k,A,E;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return k=new Tn({transactions:[]}),A=new hn.RedeemPrintingV2Bid({feePayer:t},{store:n,vault:i,auction:o,auctionManager:a,bidRedemption:u,bidMetadata:l,safetyDepositTokenStore:h,destination:r,safetyDeposit:f,bidder:t,safetyDepositConfig:d,auctionExtended:s,newMint:m,newEdition:y,newMetadata:g,metadata:p,masterEdition:v,editionMark:_,prizeTrackingTicket:b,winIndex:x,editionOffset:w}),k.addTransaction(A),E=new fn.UpdatePrimarySaleHappenedViaToken({feePayer:t},{metadata:g,owner:t,tokenAccount:r}),k.addTransaction(E),e.abrupt("return",k);case 6:case"end":return e.stop()}}),e)})))};function On(e){return new(ln())(1).add(new(ln())(e))}var zn=function(e){var t=e.connection,r=e.wallet,n=e.store,a=e.auction;return mn(void 0,void 0,void 0,(0,c.Z)().mark((function e(){var s,u,l,h,f,d,p,m,g,y,v,_,b,x,w,k,A,E,S,T,M,I,P,C,B,D,R,L,O,z,N,U,Z,F,j,V,W,K,G,H,q,Y,X,Q,$,J,ee,te,re,ne,ie;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=new Tn({transactions:[]}),u=new Tn({transactions:[]}),l=r.publicKey,e.next=5,dn.Auction.load(t,a);case 5:return h=e.sent,f=h.data,d=f.bidState,p=f.tokenMint,e.next=11,hn.AuctionManager.getPDA(a);case 11:return m=e.sent,e.next=14,hn.AuctionManager.load(t,m);case 14:return g=e.sent,e.next=17,sn.Vault.load(t,g.data.vault);case 17:return y=e.sent,e.next=20,dn.AuctionExtended.getPDA(y.pubkey);case 20:return v=e.sent,e.next=23,y.getSafetyDepositBoxes(t);case 23:return _=e.sent,b=(0,i.Z)(_,1),x=b[0],w=new o.PublicKey(x.data.tokenMint),k=new o.PublicKey(x.data.store),e.next=30,dn.BidderMetadata.getPDA(a,l);case 30:return A=e.sent,e.next=33,Dn(a,A);case 33:return E=e.sent,e.next=36,hn.SafetyDepositConfig.getPDA(m,x.pubkey);case 36:return S=e.sent,e.next=39,hn.SafetyDepositConfig.load(t,S);case 39:return T=e.sent,M=T.data.participationConfig.fixedPrice,I=new o.PublicKey(g.data.acceptPayment),e.next=44,kn(t,r.publicKey);case 44:return P=e.sent,C=P.mint,B=P.createMintTx,D=P.createAssociatedTokenAccountTx,R=P.mintToTx,L=P.recipient,s.addSigner(C),s.addTransaction(B),s.addTransaction(D),s.addTransaction(R),O=C.publicKey,e.next=57,fn.Metadata.getPDA(O);case 57:return z=e.sent,e.next=60,fn.Edition.getPDA(O);case 60:return N=e.sent,e.next=63,fn.Metadata.getPDA(w);case 63:return U=e.sent,e.next=66,fn.MasterEdition.getPDA(w);case 66:return Z=e.sent,e.next=69,fn.MasterEdition.load(t,Z);case 69:return F=e.sent,e.next=72,hn.PrizeTrackingTicket.getPDA(m,w);case 72:return j=e.sent,V=d.getWinnerIndex(l.toBase58()),W=F.data.supply.add(new(ln())(1)),e.next=77,fn.EditionMarker.getPDA(w,W);case 77:if(K=e.sent,p!==an.NATIVE_MINT.toBase58()){e.next=91;break}return e.next=81,An(t,l,M.toNumber());case 81:H=e.sent,q=H.account,Y=H.createTokenAccountTx,X=H.closeTokenAccountTx,G=q.publicKey,s.addTransaction(Y),s.addSigner(q),u.addAfterTransaction(X),e.next=94;break;case 91:return e.next=93,an.Token.getAssociatedTokenAddress(an.ASSOCIATED_TOKEN_PROGRAM_ID,an.TOKEN_PROGRAM_ID,new o.PublicKey(p),l);case 93:G=e.sent;case 94:return Q=En({account:G,owner:l,amount:M.toNumber()}),$=Q.authority,J=Q.createApproveTx,ee=Q.createRevokeTx,u.addTransaction(J),u.addAfterTransaction(ee),u.addSigner($),te=new hn.RedeemParticipationBidV3({feePayer:l},{store:n,vault:y.pubkey,auction:a,auctionManager:m,bidRedemption:E,bidMetadata:A,safetyDepositTokenStore:k,destination:L,safetyDeposit:x.pubkey,bidder:l,safetyDepositConfig:S,auctionExtended:v,newMint:O,newEdition:N,newMetadata:z,metadata:U,masterEdition:Z,editionMark:K,prizeTrackingTicket:j,winIndex:null!==V?new(ln())(V):null,transferAuthority:$.publicKey,tokenPaymentAccount:G,acceptPaymentAccount:I}),u.addTransaction(te),re=new fn.UpdatePrimarySaleHappenedViaToken({feePayer:l},{metadata:z,owner:l,tokenAccount:L}),u.addTransaction(re),e.next=104,Sn({connection:t,wallet:r,txs:s.toTransactions(),signers:s.signers});case 104:return ne=e.sent,e.next=107,t.confirmTransaction(ne,"finalized");case 107:return e.next=109,Sn({connection:t,wallet:r,txs:u.toTransactions(),signers:u.signers});case 109:return ie=e.sent,e.abrupt("return",{txIds:[ne,ie]});case 111:case"end":return e.stop()}}),e)})))};function Nn(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.nonWinningConstraint,n=t.winnerConstraint!==hn.WinningConstraint.NoParticipationPrize,i=r!==hn.NonWinningConstraint.NoParticipationPrize;return null===e&&i||null!==e&&n}var Un=function(e){var t=e.connection,r=e.wallet,n=e.store,i=e.auction,a=e.bidderPotToken;return mn(void 0,void 0,void 0,(0,c.Z)().mark((function e(){var s,u,l,h,f,d,p,m,g,y,v,_;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=r.publicKey,e.next=3,hn.AuctionManager.getPDA(i);case 3:return u=e.sent,e.next=6,hn.AuctionManager.load(t,u);case 6:return l=e.sent,h=new o.PublicKey(l.data.vault),e.next=10,dn.Auction.load(t,i);case 10:return f=e.sent,d=f.data.tokenMint,p=new o.PublicKey(l.data.acceptPayment),e.next=15,dn.AuctionExtended.getPDA(h);case 15:return m=e.sent,g=new o.PublicKey(d),e.next=19,dn.BidderPot.getPDA(i,s);case 19:return y=e.sent,e.next=22,Zn({auctionTokenMint:g,bidder:s,store:n,vault:h,auction:i,auctionExtended:m,auctionManager:u,acceptPayment:p,bidderPot:y,bidderPotToken:a});case 22:return v=e.sent,e.next=25,Sn({connection:t,wallet:r,txs:v.toTransactions(),signers:v.signers});case 25:return _=e.sent,e.abrupt("return",{txId:_});case 27:case"end":return e.stop()}}),e)})))},Zn=function(e){var t=e.bidder,r=e.auctionTokenMint,n=e.store,i=e.vault,o=e.auction,a=e.auctionManager,s=e.auctionExtended,u=e.acceptPayment,l=e.bidderPot,h=e.bidderPotToken;return mn(void 0,void 0,void 0,(0,c.Z)().mark((function e(){var f,d;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f=new Tn({transactions:[]}),d=new hn.ClaimBid({feePayer:t},{store:n,vault:i,auction:o,auctionExtended:s,auctionManager:a,bidder:t,tokenMint:r,acceptPayment:u,bidderPot:l,bidderPotToken:h}),f.addTransaction(d),e.abrupt("return",f);case 4:case"end":return e.stop()}}),e)})))},Fn=Object.freeze({__proto__:null,addTokensToVault:function(e){var t=e.connection,r=e.wallet,n=e.vault,i=e.nfts;return mn(void 0,void 0,void 0,(0,c.Z)().mark((function e(){var a,s,u,l,h,f,d,p,g,y,v,_,b,x,w,k;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={feePayer:r.publicKey},s=[],e.next=4,sn.Vault.getPDA(n);case 4:return u=e.sent,e.next=7,t.getMinimumBalanceForRentExemption(an.AccountLayout.span);case 7:l=e.sent,h=(0,m.Z)(i),e.prev=9,h.s();case 11:if((f=h.n()).done){e.next=32;break}return d=f.value,p=new Tn({transactions:[]}),e.next=16,sn.SafetyDepositBox.getPDA(n,d.tokenMint);case 16:return g=e.sent,y=o.Keypair.generate(),v=new bn(a,{newAccountPubkey:y.publicKey,lamports:l,mint:d.tokenMint,owner:u}),p.addTransaction(v),p.addSigner(y),_=En({account:d.tokenAccount,owner:r.publicKey,amount:d.amount.toNumber()}),b=_.authority,x=_.createApproveTx,p.addTransaction(x),p.addSigner(b),w=new sn.AddTokenToInactiveVault(a,{vault:n,vaultAuthority:r.publicKey,tokenAccount:d.tokenAccount,tokenStoreAccount:y.publicKey,transferAuthority:b.publicKey,safetyDepositBox:g,amount:d.amount}),p.addTransaction(w),e.next=28,Sn({connection:t,wallet:r,txs:p.transactions,signers:p.signers});case 28:k=e.sent,s.push({txId:k,tokenStoreAccount:y.publicKey,tokenMint:d.tokenMint,tokenAccount:d.tokenAccount});case 30:e.next=11;break;case 32:e.next=37;break;case 34:e.prev=34,e.t0=e.catch(9),h.e(e.t0);case 37:return e.prev=37,h.f(),e.finish(37);case 40:return e.abrupt("return",{safetyDepositTokenStores:s});case 41:case"end":return e.stop()}}),e,null,[[9,34,37,40]])})))},sendTransaction:Sn,initStore:function(e){var t=e.connection,r=e.wallet,n=e.isPublic,i=void 0===n||n;return mn(void 0,void 0,void 0,(0,c.Z)().mark((function e(){var n,a,s;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,hn.Store.getPDA(r.publicKey);case 2:return n=e.sent,a=new hn.SetStore({feePayer:r.publicKey},{admin:new o.PublicKey(r.publicKey),store:n,isPublic:i}),e.next=6,Sn({connection:t,wallet:r,txs:[a]});case 6:return s=e.sent,e.abrupt("return",{storeId:n,txId:s});case 8:case"end":return e.stop()}}),e)})))},initStoreV2:function(e){var t=e.connection,r=e.wallet,n=e.settingsUri,i=void 0===n?null:n,a=e.isPublic,s=void 0===a||a;return mn(void 0,void 0,void 0,(0,c.Z)().mark((function e(){var n,a,u,l;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,hn.Store.getPDA(r.publicKey);case 2:return n=e.sent,e.next=5,hn.StoreConfig.getPDA(n);case 5:return a=e.sent,u=new hn.SetStoreV2({feePayer:r.publicKey},{admin:new o.PublicKey(r.publicKey),store:n,config:a,isPublic:s,settingsUri:i}),e.next=9,Sn({connection:t,wallet:r,txs:[u]});case 9:return l=e.sent,e.abrupt("return",{storeId:n,configId:a,txId:l});case 11:case"end":return e.stop()}}),e)})))},mintNFT:function(e){var t=e.connection,r=e.wallet,n=e.uri,i=e.maxSupply;return mn(void 0,void 0,void 0,(0,c.Z)().mark((function e(){var o,a,u,l,h,f,d,p,m,g,y,v,_,b,x,w,k;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,kn(t,r.publicKey);case 2:return o=e.sent,a=o.mint,u=o.createMintTx,l=o.createAssociatedTokenAccountTx,h=o.mintToTx,e.next=9,fn.Metadata.getPDA(a.publicKey);case 9:return f=e.sent,e.next=12,fn.MasterEdition.getPDA(a.publicKey);case 12:return d=e.sent,e.next=15,vn(n);case 15:return p=e.sent,m=p.name,g=p.symbol,y=p.seller_fee_basis_points,v=p.properties.creators,_=v.reduce((function(e,t){var n=t.address,i=t.share,o=n===r.publicKey.toString(),a=new fn.Creator({address:n,share:i,verified:o});return e=[].concat((0,s.Z)(e),[a])}),[]),b=new fn.MetadataDataData({name:m,symbol:g,uri:n,sellerFeeBasisPoints:y,creators:_}),x=new fn.CreateMetadata({feePayer:r.publicKey},{metadata:f,metadataData:b,updateAuthority:r.publicKey,mint:a.publicKey,mintAuthority:r.publicKey}),w=new fn.CreateMasterEdition({feePayer:r.publicKey},{edition:d,metadata:f,updateAuthority:r.publicKey,mint:a.publicKey,mintAuthority:r.publicKey,maxSupply:i||0===i?new(ln())(i):null}),e.next=26,Sn({connection:t,signers:[a],txs:[u,x,l,h,w],wallet:r});case 26:return k=e.sent,e.abrupt("return",{txId:k,mint:a.publicKey,metadata:f,edition:d});case 28:case"end":return e.stop()}}),e)})))},mintEditionFromMaster:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.connection,r=e.wallet,n=e.masterEditionMint,i=e.updateAuthority;return mn(void 0,void 0,void 0,(0,c.Z)().mark((function e(){var o,a,s,u,l,h,f,d,p,m,g,y,v,_,b,x;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fn.MasterEdition.getPDA(n);case 2:return o=e.sent,e.next=5,fn.Metadata.getPDA(n);case 5:return a=e.sent,e.next=8,un.Account.getInfo(t,o);case 8:return s=e.sent,u=new fn.MasterEdition(o,s).data,l=u.supply.add(new(ln())(1)),e.next=13,kn(t,r.publicKey);case 13:return h=e.sent,f=h.mint,d=h.createMintTx,p=h.createAssociatedTokenAccountTx,m=h.mintToTx,e.next=20,an.Token.getAssociatedTokenAddress(an.ASSOCIATED_TOKEN_PROGRAM_ID,an.TOKEN_PROGRAM_ID,n,r.publicKey);case 20:return g=e.sent,e.next=23,fn.Metadata.getPDA(f.publicKey);case 23:return y=e.sent,e.next=26,fn.EditionMarker.getPDA(n,l);case 26:return v=e.sent,e.next=29,fn.Edition.getPDA(f.publicKey);case 29:return _=e.sent,b=new fn.MintNewEditionFromMasterEditionViaToken({feePayer:r.publicKey},{edition:_,metadata:y,updateAuthority:null!==i&&void 0!==i?i:r.publicKey,mint:f.publicKey,mintAuthority:r.publicKey,masterEdition:o,masterMetadata:a,editionMarker:v,tokenOwner:r.publicKey,tokenAccount:g,editionValue:l}),e.next=33,Sn({connection:t,signers:[f],txs:[d,p,m,b],wallet:r});case 33:return x=e.sent,e.abrupt("return",{txId:x,mint:f.publicKey,metadata:y,edition:_});case 35:case"end":return e.stop()}}),e)})))},createMetadata:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.connection,r=e.wallet,n=e.editionMint,i=e.metadataData,o=e.updateAuthority;return mn(void 0,void 0,void 0,(0,c.Z)().mark((function e(){var a,s;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fn.Metadata.getPDA(n);case 2:return a=e.sent,s=new fn.CreateMetadata({feePayer:r.publicKey},{metadata:a,metadataData:i,updateAuthority:null!==o&&void 0!==o?o:r.publicKey,mint:n,mintAuthority:r.publicKey}),e.abrupt("return",Sn({connection:t,signers:[],txs:[s],wallet:r}));case 5:case"end":return e.stop()}}),e)})))},createMasterEdition:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.connection,r=e.wallet,n=e.editionMint,i=e.updateAuthority,o=e.maxSupply;return mn(void 0,void 0,void 0,(0,c.Z)().mark((function e(){var a,s,u;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fn.Metadata.getPDA(n);case 2:return a=e.sent,e.next=5,fn.MasterEdition.getPDA(n);case 5:return s=e.sent,u=new fn.CreateMasterEdition({feePayer:r.publicKey},{edition:s,metadata:a,updateAuthority:null!==i&&void 0!==i?i:r.publicKey,mint:n,mintAuthority:r.publicKey,maxSupply:o}),e.abrupt("return",Sn({connection:t,signers:[],txs:[u],wallet:r}));case 8:case"end":return e.stop()}}),e)})))},signMetadata:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.connection,r=e.wallet,n=e.editionMint,i=e.signer;return mn(void 0,void 0,void 0,(0,c.Z)().mark((function e(){var o,a;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fn.Metadata.getPDA(n);case 2:return o=e.sent,a=new fn.SignMetadata({feePayer:r.publicKey},{metadata:o,creator:i?i.publicKey:r.publicKey}),e.next=6,Sn({connection:t,signers:i?[i]:[],txs:[a],wallet:r});case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e)})))},updateMetadata:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.connection,r=e.wallet,n=e.editionMint,i=e.newMetadataData,o=e.newUpdateAuthority,a=e.primarySaleHappened;return mn(void 0,void 0,void 0,(0,c.Z)().mark((function e(){var s,u;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fn.Metadata.getPDA(n);case 2:return s=e.sent,u=new fn.UpdateMetadata({feePayer:r.publicKey},{metadata:s,updateAuthority:r.publicKey,metadataData:i,newUpdateAuthority:o,primarySaleHappened:a}),e.abrupt("return",Sn({connection:t,signers:[],txs:[u],wallet:r}));case 5:case"end":return e.stop()}}),e)})))},cancelBid:Mn,getCancelBidTransactions:In,placeBid:Pn,redeemFullRightsTransferBid:Cn,getRedeemFRTBidTransactions:Bn,getBidRedemptionPDA:Dn,redeemPrintingV2Bid:Rn,getRedeemPrintingV2BidTransactions:Ln,getEditionOffset:On,redeemParticipationBidV3:zn,isEligibleForParticipationPrize:Nn,claimBid:Un,getClaimBidTransactions:Zn,instantSale:function(e){var t=e.connection,r=e.wallet,n=e.store,o=e.auction;return mn(void 0,void 0,void 0,(0,c.Z)().mark((function e(){var a,u,l,h,f,d,p,m,g,y,v,_,b,x,w,k,A,E,S,T,M,I,P,C,B,D,R,L,O,z,N;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=[],e.next=3,hn.AuctionManager.getPDA(o);case 3:return u=e.sent,e.next=6,hn.AuctionManager.load(t,u);case 6:return l=e.sent,e.next=9,sn.Vault.load(t,l.data.vault);case 9:return h=e.sent,e.next=12,dn.AuctionExtended.getPDA(h.pubkey);case 12:return f=e.sent,e.next=15,dn.AuctionExtended.load(t,f);case 15:return d=e.sent,p=d.data.instantSalePrice,e.next=19,h.getSafetyDepositBoxes(t);case 19:return m=e.sent,g=(0,i.Z)(m,1),y=g[0],e.next=24,hn.SafetyDepositConfig.getPDA(u,y.pubkey);case 24:return v=e.sent,e.next=27,hn.SafetyDepositConfig.load(t,v);case 27:return _=e.sent,b=_.data,x=b.winningConfigType,w=b.participationConfig,e.next=33,Pn({connection:t,wallet:r,amount:p,auction:o});case 33:return k=e.sent,A=k.txId,E=k.bidderPotToken,a.push(A),e.next=39,t.confirmTransaction(A,"finalized");case 39:return e.next=41,dn.Auction.load(t,o);case 41:if(S=e.sent,T=S.data.bidState,M=T.getWinnerIndex(r.publicKey.toBase58()),!(null!==M)){e.next=69;break}e.t0=x,e.next=e.t0===hn.WinningConfigType.FullRightsTransfer?49:e.t0===hn.WinningConfigType.PrintingV2?55:61;break;case 49:return e.next=51,Cn({connection:t,wallet:r,store:n,auction:o});case 51:return I=e.sent,P=I.txId,a.push(P),e.abrupt("break",62);case 55:return e.next=57,Rn({connection:t,wallet:r,store:n,auction:o});case 57:return C=e.sent,B=C.txId,a.push(B),e.abrupt("break",62);case 61:throw new Error("".concat(x," winning type isn't supported yet"));case 62:return e.next=64,Un({connection:t,wallet:r,store:n,auction:o,bidderPotToken:E});case 64:D=e.sent,R=D.txId,a.push(R),e.next=74;break;case 69:return e.next=71,Mn({connection:t,wallet:r,auction:o,bidderPotToken:E});case 71:L=e.sent,O=L.txId,a.push(O);case 74:if(!Nn(M,w)){e.next=81;break}return e.next=78,zn({connection:t,wallet:r,store:n,auction:o});case 78:z=e.sent,(N=z.txIds).push.apply(N,(0,s.Z)(N));case 81:return e.abrupt("return",{txIds:a});case 82:case"end":return e.stop()}}),e)})))},burnToken:function(e){var t=e.connection,r=e.wallet,n=e.token,i=e.mint,o=e.amount,a=e.owner,s=e.close,u=void 0===s||s;return mn(void 0,void 0,void 0,(0,c.Z)().mark((function e(){var s,l;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=new un.Transaction({feePayer:r.publicKey}).add(an.Token.createBurnInstruction(an.TOKEN_PROGRAM_ID,i,n,null!==a&&void 0!==a?a:r.publicKey,[],o)),u&&s.add(an.Token.createCloseAccountInstruction(an.TOKEN_PROGRAM_ID,n,r.publicKey,null!==a&&void 0!==a?a:r.publicKey,[])),e.next=4,Sn({connection:t,wallet:r,txs:[s]});case 4:return l=e.sent,e.abrupt("return",{txId:l});case 6:case"end":return e.stop()}}),e)})))},sendToken:function(e){var t=e.connection,r=e.wallet,n=e.source,i=e.destination,o=e.mint,a=e.amount;return mn(void 0,void 0,void 0,(0,c.Z)().mark((function e(){var s,u,l,h;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=[],e.next=3,an.Token.getAssociatedTokenAddress(an.ASSOCIATED_TOKEN_PROGRAM_ID,an.TOKEN_PROGRAM_ID,o,i);case 3:return u=e.sent,l={feePayer:r.publicKey},e.prev=5,e.next=8,un.Account.load(t,u);case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(5),s.push(new xn(l,{associatedTokenAddress:u,splTokenMintAddress:o,walletAddress:i}));case 13:return s.push(new un.Transaction(l).add(an.Token.createTransferInstruction(an.TOKEN_PROGRAM_ID,n,u,r.publicKey,[],a))),e.next=16,Sn({connection:t,wallet:r,txs:s});case 16:return h=e.sent,e.abrupt("return",{txId:h});case 18:case"end":return e.stop()}}),e,null,[[5,10]])})))},prepareTokenAccountAndMintTxs:kn,createWrappedAccountTxs:An,createApproveTxs:En,closeVault:function(e){var t=e.connection,r=e.wallet,n=e.vault,i=e.priceMint;return mn(void 0,void 0,void 0,(0,c.Z)().mark((function e(){var a,s,u,l,h,f,d,p,m,g,y,v,_,b,x,w,k,A,E,S,T,M,I;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getMinimumBalanceForRentExemption(an.AccountLayout.span);case 2:return a=e.sent,e.next=5,sn.Vault.getPDA(n);case 5:return s=e.sent,u=new Tn({transactions:[]}),l={feePayer:r.publicKey},e.next=10,sn.Vault.load(t,n);case 10:return h=e.sent,f=h.data,d=f.fractionMint,p=f.fractionTreasury,m=f.redeemTreasury,g=f.pricingLookupAddress,y=new o.PublicKey(d),v=new o.PublicKey(p),_=new o.PublicKey(m),b=new o.PublicKey(g),x=new sn.ActivateVault(l,{vault:n,numberOfShares:new(ln())(0),fractionMint:y,fractionTreasury:v,fractionMintAuthority:s,vaultAuthority:r.publicKey}),u.addTransaction(x),w=o.Keypair.generate(),k=new bn(l,{newAccountPubkey:w.publicKey,lamports:a,mint:y,owner:r.publicKey}),u.addTransaction(k),u.addSigner(w),A=o.Keypair.generate(),E=new bn(l,{newAccountPubkey:A.publicKey,lamports:a,mint:i,owner:r.publicKey}),u.addTransaction(E),u.addSigner(A),S=o.Keypair.generate(),T=function(e){return(new un.Transaction).add(an.Token.createApproveInstruction(an.TOKEN_PROGRAM_ID,e.publicKey,S.publicKey,r.publicKey,[],0))},u.addTransaction(T(A)),u.addTransaction(T(w)),u.addSigner(S),M=new sn.CombineVault(l,{vault:n,outstandingShareTokenAccount:w.publicKey,payingTokenAccount:A.publicKey,fractionMint:y,fractionTreasury:v,redeemTreasury:_,burnAuthority:s,externalPriceAccount:b,transferAuthority:S.publicKey,vaultAuthority:r.publicKey,newVaultAuthority:r.publicKey}),u.addTransaction(M),e.next=39,Sn({connection:t,signers:u.signers,txs:u.transactions,wallet:r});case 39:return I=e.sent,e.abrupt("return",{txId:I});case 41:case"end":return e.stop()}}),e)})))},createExternalPriceAccount:function(e){var t=e.connection,r=e.wallet;return mn(void 0,void 0,void 0,(0,c.Z)().mark((function e(){var n,i,a,s,u,l,h,f;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new Tn({transactions:[]}),i={feePayer:r.publicKey},e.next=4,t.getMinimumBalanceForRentExemption(sn.Vault.MAX_EXTERNAL_ACCOUNT_SIZE);case 4:return a=e.sent,s=o.Keypair.generate(),u=new sn.ExternalPriceAccountData({pricePerShare:new(ln())(0),priceMint:an.NATIVE_MINT.toBase58(),allowedToCombine:!0}),l=(new un.Transaction).add(o.SystemProgram.createAccount({fromPubkey:r.publicKey,newAccountPubkey:s.publicKey,lamports:a,space:sn.Vault.MAX_EXTERNAL_ACCOUNT_SIZE,programId:sn.VaultProgram.PUBKEY})),n.addTransaction(l),n.addSigner(s),h=new sn.UpdateExternalPriceAccount(i,{externalPriceAccount:s.publicKey,externalPriceAccountData:u}),n.addTransaction(h),e.next=14,Sn({connection:t,signers:n.signers,txs:n.transactions,wallet:r});case 14:return f=e.sent,e.abrupt("return",{txId:f,externalPriceAccount:s.publicKey,priceMint:an.NATIVE_MINT});case 16:case"end":return e.stop()}}),e)})))},createVault:function(e){var t=e.connection,r=e.wallet,n=e.priceMint,i=void 0===n?an.NATIVE_MINT:n,a=e.externalPriceAccount;return mn(void 0,void 0,void 0,(0,c.Z)().mark((function e(){var n,s,u,l,h,f,d,p,m,g,y,v,_,b,x;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.getMinimumBalanceForRentExemption(an.AccountLayout.span);case 2:return n=e.sent,e.next=5,t.getMinimumBalanceForRentExemption(an.MintLayout.span);case 5:return s=e.sent,e.next=8,t.getMinimumBalanceForRentExemption(sn.Vault.MAX_VAULT_SIZE);case 8:return u=e.sent,l=o.Keypair.generate(),e.next=12,sn.Vault.getPDA(l.publicKey);case 12:return h=e.sent,f=new Tn({transactions:[]}),d=o.Keypair.generate(),p=new _n({feePayer:r.publicKey},{newAccountPubkey:d.publicKey,lamports:s,owner:h,freezeAuthority:h}),f.addTransaction(p),f.addSigner(d),m=o.Keypair.generate(),g=new bn({feePayer:r.publicKey},{newAccountPubkey:m.publicKey,lamports:n,mint:i,owner:h}),f.addTransaction(g),f.addSigner(m),y=o.Keypair.generate(),v=new bn({feePayer:r.publicKey},{newAccountPubkey:y.publicKey,lamports:n,mint:d.publicKey,owner:h}),f.addTransaction(v),f.addSigner(y),_=(new un.Transaction).add(o.SystemProgram.createAccount({fromPubkey:r.publicKey,newAccountPubkey:l.publicKey,lamports:u,space:sn.Vault.MAX_VAULT_SIZE,programId:sn.VaultProgram.PUBKEY})),f.addTransaction(_),f.addSigner(l),b=new sn.InitVault({feePayer:r.publicKey},{vault:l.publicKey,vaultAuthority:r.publicKey,fractionalTreasury:y.publicKey,pricingLookupAddress:a,redeemTreasury:m.publicKey,fractionalMint:d.publicKey,allowFurtherShareCreation:!0}),f.addTransaction(b),e.next=33,Sn({connection:t,signers:f.signers,txs:f.transactions,wallet:r});case 33:return x=e.sent,e.abrupt("return",{txId:x,vault:l.publicKey,fractionMint:d.publicKey,redeemTreasury:m.publicKey,fractionTreasury:y.publicKey});case 35:case"end":return e.stop()}}),e)})))},initAuction:function(e){var t=e.connection,r=e.wallet,n=e.vault,o=e.auctionSettings;return mn(void 0,void 0,void 0,(0,c.Z)().mark((function e(){var a,s,u,l,h,f,d,p;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a={feePayer:r.publicKey},e.next=3,Promise.all([dn.Auction.getPDA(n),dn.AuctionExtended.getPDA(n)]);case 3:return s=e.sent,u=(0,i.Z)(s,2),l=u[0],h=u[1],f=new dn.CreateAuctionArgs(Object.assign(Object.assign({},o),{authority:r.publicKey.toBase58(),resource:n.toBase58()})),d=new dn.CreateAuction(a,{args:f,auction:l,creator:r.publicKey,auctionExtended:h}),e.next=11,Sn({connection:t,signers:[],txs:[d],wallet:r});case 11:return p=e.sent,e.abrupt("return",{txId:p,auction:l});case 13:case"end":return e.stop()}}),e)})))}}),jn=r(7567),Vn=r.n(jn),Wn=(r(169),r(2576));Wn.struct,Wn.u32,Wn.ns64,r(9778).Buffer;var Kn=function(e){e.blob;var t=new o.Connection((0,o.clusterApiUrl)("devnet"),"confirmed"),r=gr();function n(){return(n=(0,l.Z)((0,c.Z)().mark((function e(){return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.publicKey){e.next=2;break}throw new T;case 2:return t.getBalance(r.publicKey).then((function(e){console.log(e/o.LAMPORTS_PER_SOL,"lamp sol")})),e.next=5,Fn.mintNFT({connection:t,wallet:r,uri:"https://www.arweave.net/1r-ImuiIxFl18UQolAoBnwLDMVcjkVAHruhtsaBpA7U?ext=json",maxSupply:1}).catch((function(e){return console.error(e)}));case 5:e.sent;case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Vn().init({host:"arweave.net",port:443,protocol:"https"}),(0,jr.jsx)("button",{className:"btn btn-ghost big",onClick:function(){return n.apply(this,arguments)},children:"mint NFT"})},Gn=6.8,Hn=function(e){var r=e.blob,n=e.setView,o=(0,t.useState)(null),a=(0,i.Z)(o,2),s=a[0],u=a[1],h=(0,t.useState)(null),f=(0,i.Z)(h,2),d=f[0],p=f[1],m=(0,t.useRef)(),g=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.x,n=e.y,i=e.w,o=e.h,a=t.backgroundColor,s=void 0===a?"skyblue":a;d.beginPath(),d.fillStyle=s,d.fillRect(r,n,i,o)};(0,t.useEffect)((function(){function e(){return e=(0,l.Z)((0,c.Z)().mark((function e(t){var r,n,i,o,a,s;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=URL.createObjectURL(t),n=new AudioContext,e.next=4,fetch(r);case 4:return i=e.sent,e.next=7,i.arrayBuffer();case 7:return o=e.sent,e.next=10,n.decodeAudioData(o);case 10:a=e.sent,s=a.getChannelData(0),u(s);case 13:case"end":return e.stop()}}),e)}))),e.apply(this,arguments)}var t=m.current;t.width=t.clientWidth,t.height=t.clientHeight,p(t.getContext("2d")),function(t){e.apply(this,arguments)}(r)}),[]),(0,t.useEffect)((function(){function e(){return e=(0,l.Z)((0,c.Z)().mark((function e(t){var r,n,i,o,a,s;return(0,c.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=URL.createObjectURL(t),n=new AudioContext,e.next=4,fetch(r);case 4:return i=e.sent,e.next=7,i.arrayBuffer();case 7:return o=e.sent,e.next=10,n.decodeAudioData(o);case 10:a=e.sent,s=a.getChannelData(0),u(s);case 13:case"end":return e.stop()}}),e)}))),e.apply(this,arguments)}var t=m.current;t.width=t.clientWidth,t.height=t.clientHeight,p(t.getContext("2d")),function(t){e.apply(this,arguments)}(r)}),[]),(0,t.useEffect)((function(){function e(e){var t=e.toString(16);return 1==t.length?"0"+t:t}function t(t,r,n){return"#"+e(t)+e(r)+e(n)}if(s){for(var r=[],n=3e3;n<=3020;n++){var i=t(Math.floor(1e8*Math.abs(s[n]))%256,Math.floor(1e10*Math.abs(s[n]))%256,Math.floor(1e12*Math.abs(s[n]))%256);r.push(i)}for(var o=0;o<130;o++)for(var a=0;a<130;a++){g({x:o*Gn,y:a*Gn,w:Gn,h:Gn},{backgroundColor:r[(o+a*(u=50,Math.floor(Math.random()*u)))%r.length]})}}var u}),[s]);return(0,jr.jsxs)("div",{className:"central-inner-container",children:[(0,jr.jsx)("div",{className:"CanvasVisual",children:(0,jr.jsx)("canvas",{ref:m})}),(0,jr.jsxs)("div",{className:"vis-btns",children:[(0,jr.jsx)(Kn,{blob:r}),(0,jr.jsx)("div",{className:"back-btn",children:(0,jr.jsx)("button",{className:"btn btn-ghost",onClick:function(){n("map")},children:"back"})})]})]})};var qn=function(){return(0,jr.jsxs)("div",{className:"welcome-container",children:[(0,jr.jsx)("h1",{className:"title",children:"capture the moment in sound"}),(0,jr.jsx)("div",{className:"landing-text",children:(0,jr.jsx)("div",{className:"subtitle",children:(0,jr.jsx)("h2",{children:"hear, record & mint your audio NFT"})})})]})},Yn=t.createContext(null);function Xn(e){return{longitude:e.center.lng,latitude:e.center.lat,zoom:e.zoom,pitch:e.pitch,bearing:e.bearing,padding:e.padding}}function Qn(e,t){var r=t.viewState||t,n=!1;if("longitude"in r&&"latitude"in r){var i=e.center;e.center=new i.constructor(r.longitude,r.latitude),n=n||i!==e.center}if("zoom"in r){var o=e.zoom;e.zoom=r.zoom,n=n||o!==e.zoom}if("bearing"in r){var a=e.bearing;e.bearing=r.bearing,n=n||a!==e.bearing}if("pitch"in r){var s=e.pitch;e.pitch=r.pitch,n=n||s!==e.pitch}return r.padding&&!e.isPaddingEqual(r.padding)&&(n=!0,e.padding=r.padding),n}var $n=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function Jn(e){if(!e)return null;if("string"===typeof e)return e;if("toJS"in e&&(e=e.toJS()),!e.layers)return e;var t,r={},n=(0,m.Z)(e.layers);try{for(n.s();!(t=n.n()).done;){var i=t.value;r[i.id]=i}}catch(a){n.e(a)}finally{n.f()}var o=e.layers.map((function(e){var t=r[e.ref],n=null;if("interactive"in e&&delete(n=(0,V.Z)({},e)).interactive,t){delete(n=n||(0,V.Z)({},e)).ref;var i,o=(0,m.Z)($n);try{for(o.s();!(i=o.n()).done;){var s=i.value;s in t&&(n[s]=t[s])}}catch(a){o.e(a)}finally{o.f()}}return n||e}));return(0,V.Z)((0,V.Z)({},e),{},{layers:o})}function ei(e,t){if(e===t)return!0;if(!e||!t)return!1;if(Array.isArray(e)){if(!Array.isArray(t)||e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(!ei(e[r],t[r]))return!1;return!0}if(Array.isArray(t))return!1;if("object"===typeof e&&"object"===typeof t){var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(var o=0,a=n;o<a.length;o++){var s=a[o];if(!t.hasOwnProperty(s))return!1;if(!ei(e[s],t[s]))return!1}return!0}return!1}var ti={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},ri={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},ni={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},ii=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],oi=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"],ai=function(){function e(t,r,n){var i=this;(0,h.Z)(this,e),this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=function(e){var t=i.props[ni[e.type]];t&&t(e)},this._onPointerEvent=function(e){"mousemove"!==e.type&&"mouseout"!==e.type||i._updateHover(e);var t=i.props[ti[e.type]];if(t){if(i.props.interactiveLayerIds&&"mouseover"!==e.type&&"mouseout"!==e.type){var r=i._hoveredFeatures||i._map.queryRenderedFeatures(e.point,{layers:i.props.interactiveLayerIds});e.features=r}t(e),delete e.features}},this._onCameraEvent=function(e){if(!i._internalUpdate){var t=i.props[ri[e.type]];t&&t(e)}e.type in i._deferredEvents&&(i._deferredEvents[e.type]=!1)},this._MapClass=t,this.props=r,this._initialize(n)}return(0,f.Z)(e,[{key:"map",get:function(){return this._map}},{key:"transform",get:function(){return this._renderTransform}},{key:"setProps",value:function(e){var t=this.props;this.props=e;var r=this._updateSettings(e,t);r&&this._createShadowTransform(this._map);var n=this._updateSize(e),i=this._updateViewState(e,!0);this._updateStyle(e,t),this._updateStyleComponents(e,t),this._updateHandlers(e,t),(r||n||i&&!this._map.isMoving())&&this.redraw()}},{key:"_initialize",value:function(e){var t=this,r=this.props,n=(0,V.Z)((0,V.Z)((0,V.Z)({},r),r.initialViewState),{},{accessToken:r.mapboxAccessToken||si()||null,container:e,style:Jn(r.mapStyle)}),i=n.initialViewState||n.viewState||n;if(Object.assign(n,{center:[i.longitude||0,i.latitude||0],zoom:i.zoom||0,pitch:i.pitch||0,bearing:i.bearing||0}),r.gl){var o=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=function(){return HTMLCanvasElement.prototype.getContext=o,r.gl}}var a=new this._MapClass(n);i.padding&&a.setPadding(i.padding),r.cursor&&(a.getCanvas().style.cursor=r.cursor),this._createShadowTransform(a);var s=a._render;a._render=function(e){t._inRender=!0,s.call(a,e),t._inRender=!1};var u=a._renderTaskQueue.run;a._renderTaskQueue.run=function(e){u.call(a._renderTaskQueue,e),t._onBeforeRepaint()},a.on("render",(function(){return t._onAfterRepaint()}));var c=a.fire;for(var l in a.fire=this._fireEvent.bind(this,c),a.on("resize",(function(){t._renderTransform.resize(a.transform.width,a.transform.height)})),a.on("styledata",(function(){return t._updateStyleComponents(t.props,{})})),a.on("sourcedata",(function(){return t._updateStyleComponents(t.props,{})})),ti)a.on(l,this._onPointerEvent);for(var h in ri)a.on(h,this._onCameraEvent);for(var f in ni)a.on(f,this._onEvent);this._map=a}},{key:"recycle",value:function(){var t=this.map.getContainer().querySelector("[mapboxgl-children]");null===t||void 0===t||t.remove(),e.savedMaps.push(this)}},{key:"destroy",value:function(){this._map.remove()}},{key:"redraw",value:function(){var e=this._map;!this._inRender&&e.style&&(e._frame&&(e._frame.cancel(),e._frame=null),e._render())}},{key:"_createShadowTransform",value:function(e){var t=function(e){var t=e.clone();return t.pixelsToGLUnits=e.pixelsToGLUnits,t}(e.transform);e.painter.transform=t,this._renderTransform=t}},{key:"_updateSize",value:function(e){var t=e.viewState;if(t){var r=this._map;if(t.width!==r.transform.width||t.height!==r.transform.height)return r.resize(),!0}return!1}},{key:"_updateViewState",value:function(e,t){if(this._internalUpdate)return!1;var r=this._map,n=this._renderTransform,i=n.zoom,o=n.pitch,a=n.bearing,s=r.isMoving();s&&(n.cameraElevationReference="sea");var u=Qn(n,(0,V.Z)((0,V.Z)({},Xn(r.transform)),e));if(s&&(n.cameraElevationReference="ground"),u&&t){var c=this._deferredEvents;c.move=!0,c.zoom||(c.zoom=i!==n.zoom),c.rotate||(c.rotate=a!==n.bearing),c.pitch||(c.pitch=o!==n.pitch)}return s||Qn(r.transform,e),u}},{key:"_updateSettings",value:function(e,t){for(var r=this._map,n=!1,i=0,o=ii;i<o.length;i++){var a=o[i];a in e&&!ei(e[a],t[a])&&(n=!0,r["set".concat(a[0].toUpperCase()).concat(a.slice(1))](e[a]))}return n}},{key:"_updateStyle",value:function(e,t){if(e.cursor!==t.cursor&&(this._map.getCanvas().style.cursor=e.cursor),e.mapStyle!==t.mapStyle){var r={diff:e.styleDiffing};return"localIdeographFontFamily"in e&&(r.localIdeographFontFamily=e.localIdeographFontFamily),this._map.setStyle(Jn(e.mapStyle),r),!0}return!1}},{key:"_updateStyleComponents",value:function(e,t){var r=this._map,n=!1;return r.style.loaded()&&("light"in e&&!ei(e.light,t.light)&&(n=!0,r.setLight(e.light)),"fog"in e&&!ei(e.fog,t.fog)&&(n=!0,r.setFog(e.fog)),"terrain"in e&&!ei(e.terrain,t.terrain)&&(e.terrain&&!r.getSource(e.terrain.source)||(n=!0,r.setTerrain(e.terrain)))),n}},{key:"_updateHandlers",value:function(e,t){for(var r=this._map,n=!1,i=0,o=oi;i<o.length;i++){var a=o[i],s=e[a];ei(s,t[a])||(n=!0,s?r[a].enable(s):r[a].disable())}return n}},{key:"_updateHover",value:function(e){var t,r=this.props;if(r.interactiveLayerIds&&(r.onMouseMove||r.onMouseEnter||r.onMouseLeave)){var n,i=e.type,o=(null===(t=this._hoveredFeatures)||void 0===t?void 0:t.length)>0;if("mousemove"===i)try{n=this._map.queryRenderedFeatures(e.point,{layers:r.interactiveLayerIds})}catch(s){n=[]}else n=[];var a=n.length>0;!a&&o&&(e.type="mouseleave",this._onPointerEvent(e)),this._hoveredFeatures=n,a&&!o&&(e.type="mouseenter",this._onPointerEvent(e)),e.type=i}else this._hoveredFeatures=null}},{key:"_fireEvent",value:function(e,t,r){var n=this._map,i=n.transform,o="string"===typeof t?t:t.type;return"move"===o&&this._updateViewState(this.props,!1),o in ri&&("object"===typeof t&&(t.viewState=Xn(i)),this._map.isMoving())?(n.transform=this._renderTransform,e.call(n,t,r),n.transform=i,n):(e.call(n,t,r),n)}},{key:"_onBeforeRepaint",value:function(){var e=this,t=this._map;for(var r in this._internalUpdate=!0,this._deferredEvents)this._deferredEvents[r]&&t.fire(r);this._internalUpdate=!1;var n=this._map.transform;this._map.transform=this._renderTransform,this._onAfterRepaint=function(){e._map.transform=n}}}],[{key:"reuse",value:function(t,r){var n=e.savedMaps.pop();if(!n)return null;var i=n.map,o=i.getContainer();for(r.className=o.className;o.childNodes.length>0;)r.appendChild(o.childNodes[0]);i._container=r,n.setProps((0,V.Z)((0,V.Z)({},t),{},{styleDiffing:!1})),i.resize();var a=t.initialViewState;return a&&(a.bounds?i.fitBounds(a.bounds,(0,V.Z)((0,V.Z)({},a.fitBoundsOptions),{},{duration:0})):n._updateViewState(a,!1)),i.isStyleLoaded()?i.fire("load"):i.once("styledata",(function(){return i.fire("load")})),n}}]),e}();function si(){var e=null;if("undefined"!==typeof location){var t=/access_token=([^&\/]*)/.exec(location.search);e=t&&t[1]}try{e=e||{NODE_ENV:"production",PUBLIC_URL:"/ohr",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.MapboxAccessToken}catch(r){}try{e=e||{NODE_ENV:"production",PUBLIC_URL:"/ohr",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_MAPBOX_ACCESS_TOKEN}catch(n){}return e}ai.savedMaps=[];var ui=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function ci(e,t){if(!e)return null;var r,n=e.map,i={getMap:function(){return n},getCenter:function(){return e.transform.center},getZoom:function(){return e.transform.zoom},getBearing:function(){return e.transform.bearing},getPitch:function(){return e.transform.pitch},getPadding:function(){return e.transform.padding},getBounds:function(){return e.transform.getBounds()},project:function(r){return e.transform.locationPoint(t.LngLat.convert(r))},unproject:function(r){return e.transform.pointLocation(t.Point.convert(r))},queryTerrainElevation:function(t,r){var i=n.transform;n.transform=e.transform;var o=n.queryTerrainElevation(t,r);return n.transform=i,o}},o=(0,m.Z)(function(e){var t=new Set,r=e;for(;r;){var n,i=(0,m.Z)(Object.getOwnPropertyNames(r));try{for(i.s();!(n=i.n()).done;){var o=n.value;"_"!==o[0]&&"function"===typeof e[o]&&"fire"!==o&&"setEventedParent"!==o&&t.add(o)}}catch(a){i.e(a)}finally{i.f()}r=Object.getPrototypeOf(r)}return Array.from(t)}(n));try{for(o.s();!(r=o.n()).done;){var a=r.value;a in i||ui.includes(a)||(i[a]=n[a].bind(n))}}catch(s){o.e(s)}finally{o.f()}return i}var li="undefined"!==typeof document?t.useLayoutEffect:t.useEffect,hi=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];var fi=t.createContext(null),di={minZoom:0,maxZoom:22,minPitch:0,maxPitch:60,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,mapStyle:{version:8,sources:{},layers:[]},styleDiffing:!0,projection:"mercator",renderWorldCopies:!0,onError:function(e){return console.error(e.error)},RTLTextPlugin:"https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"},pi=(0,t.forwardRef)((function(e,n){var o=(0,t.useContext)(Yn),a=(0,t.useState)(null),s=(0,i.Z)(a,2),u=s[0],c=s[1],l=(0,t.useRef)(),h=(0,t.useRef)({mapLib:null,map:null}).current;(0,t.useEffect)((function(){var t,n=e.mapLib,i=!0;return Promise.resolve(n||r.e(483).then(r.t.bind(r,5483,23))).then((function(r){if(i){if(r.Map||(r=r.default),!r||!r.Map)throw new Error("Invalid mapLib");if(!r.supported(e))throw new Error("Map is not supported by this browser");!function(e,t){var r,n=(0,m.Z)(hi);try{for(n.s();!(r=n.n()).done;){var i=r.value;i in t&&(e[i]=t[i])}}catch(o){n.e(o)}finally{n.f()}t.RTLTextPlugin&&e.getRTLTextPluginStatus&&"unavailable"===e.getRTLTextPluginStatus()&&e.setRTLTextPlugin(t.RTLTextPlugin,(function(e){e&&console.error(e)}),!1)}(r,e),e.reuseMaps&&(t=ai.reuse(e,l.current)),t||(t=new ai(r.Map,e,l.current)),h.map=ci(t,r),h.mapLib=r,c(t),null===o||void 0===o||o.onMapMount(h.map,e.id)}})).catch((function(t){e.onError({type:"error",target:null,originalEvent:null,error:t})})),function(){i=!1,t&&(null===o||void 0===o||o.onMapUnmount(e.id),e.reuseMaps?t.recycle():t.destroy())}}),[]),li((function(){u&&u.setProps(e)})),(0,t.useImperativeHandle)(n,(function(){return h.map}),[u]);var f=(0,t.useMemo)((function(){return(0,V.Z)({position:"relative",width:"100%",height:"100%"},e.style)}),[e.style]);return t.createElement("div",{id:e.id,ref:l,style:f},u&&t.createElement(fi.Provider,{value:h},t.createElement("div",{"mapboxgl-children":""},e.children)))}));pi.displayName="Map",pi.defaultProps=di;var mi=pi,gi=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function yi(e,t){if(e&&t){var r=e.style;for(var n in t){var i=t[n];Number.isFinite(i)&&!gi.test(n)?r[n]="".concat(i,"px"):r[n]=i}}}function vi(e){var r=(0,t.useContext)(fi),n=r.map,i=r.mapLib,o=(0,t.useRef)({props:e});o.current.props=e;var a=(0,t.useMemo)((function(){var r=!1;t.Children.forEach(e.children,(function(e){e&&(r=!0)}));var n=(0,V.Z)((0,V.Z)({},e),{},{element:r?document.createElement("div"):null}),s=new i.Marker(n).setLngLat([e.longitude,e.latitude]);return s.getElement().addEventListener("click",(function(e){var t,r;null===(r=(t=o.current.props).onClick)||void 0===r||r.call(t,{type:"click",target:s,originalEvent:e})})),s.on("dragstart",(function(e){var t,r,n=e;n.lngLat=a.getLngLat(),null===(r=(t=o.current.props).onDragStart)||void 0===r||r.call(t,n)})),s.on("drag",(function(e){var t,r,n=e;n.lngLat=a.getLngLat(),null===(r=(t=o.current.props).onDrag)||void 0===r||r.call(t,n)})),s.on("dragend",(function(e){var t,r,n=e;n.lngLat=a.getLngLat(),null===(r=(t=o.current.props).onDragEnd)||void 0===r||r.call(t,n)})),s}),[]);return(0,t.useEffect)((function(){return a.addTo(n.getMap()),function(){a.remove()}}),[]),(0,t.useEffect)((function(){yi(a.getElement(),e.style)}),[e.style]),a.getLngLat().lng===e.longitude&&a.getLngLat().lat===e.latitude||a.setLngLat([e.longitude,e.latitude]),e.offset&&!function(e,t){var r=Array.isArray(e)?e[0]:e?e.x:0,n=Array.isArray(e)?e[1]:e?e.y:0,i=Array.isArray(t)?t[0]:t?t.x:0,o=Array.isArray(t)?t[1]:t?t.y:0;return r===i&&n===o}(a.getOffset(),e.offset)&&a.setOffset(e.offset),a.isDraggable()!==e.draggable&&a.setDraggable(e.draggable),a.getRotation()!==e.rotation&&a.setRotation(e.rotation),a.getRotationAlignment()!==e.rotationAlignment&&a.setRotationAlignment(e.rotationAlignment),a.getPitchAlignment()!==e.pitchAlignment&&a.setPitchAlignment(e.pitchAlignment),a.getPopup()!==e.popup&&a.setPopup(e.popup),(0,Er.createPortal)(e.children,a.getElement())}vi.defaultProps={draggable:!1,popup:null,rotation:0,rotationAlignment:"auto",pitchAlignment:"auto"};t.memo(vi);function _i(e){return new Set(e?e.trim().split(/\s+/):[])}t.memo((function(e){var r=(0,t.useContext)(fi),n=r.map,i=r.mapLib,o=(0,t.useMemo)((function(){return document.createElement("div")}),[]),a=(0,t.useRef)({props:e});a.current.props=e;var s=(0,t.useMemo)((function(){var t=(0,V.Z)({},e),r=new i.Popup(t).setLngLat([e.longitude,e.latitude]);return r.once("open",(function(e){var t,r;null===(r=(t=a.current.props).onOpen)||void 0===r||r.call(t,e)})),r}),[]);if((0,t.useEffect)((function(){var e=function(e){var t,r;null===(r=(t=a.current.props).onClose)||void 0===r||r.call(t,e)};return s.on("close",e),s.setDOMContent(o).addTo(n.getMap()),function(){s.off("close",e),s.isOpen()&&s.remove()}}),[]),(0,t.useEffect)((function(){yi(s.getElement(),e.style)}),[e.style]),s.isOpen()&&(s.getLngLat().lng===e.longitude&&s.getLngLat().lat===e.latitude||s.setLngLat([e.longitude,e.latitude]),e.offset&&!ei(s.options.offset,e.offset)&&s.setOffset(e.offset),s.options.anchor===e.anchor&&s.options.maxWidth===e.maxWidth||(s.options.anchor=e.anchor,s.setMaxWidth(e.maxWidth)),s.options.className!==e.className)){var u,c=_i(s.options.className),l=_i(e.className),h=(0,m.Z)(c);try{for(h.s();!(u=h.n()).done;){var f=u.value;l.has(f)||s.removeClassName(f)}}catch(y){h.e(y)}finally{h.f()}var d,p=(0,m.Z)(l);try{for(p.s();!(d=p.n()).done;){var g=d.value;c.has(g)||s.addClassName(g)}}catch(y){p.e(y)}finally{p.f()}s.options.className=e.className}return(0,Er.createPortal)(e.children,o)}));var bi=function(e,r,n,i){var o=(0,t.useContext)(fi),a=(0,t.useMemo)((function(){return e(o)}),[]);return(0,t.useEffect)((function(){var e=i||n||r,t="function"===typeof r&&"function"===typeof n?r:null,s="function"===typeof n?n:"function"===typeof r?r:null,u=o.map;return u.hasControl(a)||(u.addControl(a,null===e||void 0===e?void 0:e.position),t&&t(o)),function(){s&&s(o),u.hasControl(a)&&u.removeControl(a)}}),[]),a};t.memo((function(e){var r=bi((function(t){return new t.mapLib.AttributionControl(e)}),{position:e.position});return(0,t.useEffect)((function(){yi(r._container,e.style)}),[e.style]),null}));t.memo((function(e){var r=bi((function(t){return new t.mapLib.FullscreenControl({container:e.containerId&&document.getElementById(e.containerId)})}),{position:e.position});return(0,t.useEffect)((function(){yi(r._controlContainer,e.style)}),[e.style]),null}));var xi=(0,t.forwardRef)((function(e,r){var n=(0,t.useRef)({props:e}),i=bi((function(t){var r=new t.mapLib.GeolocateControl(e),i=r._setupUI;return r._setupUI=function(e){r._container.hasChildNodes()||i(e)},r.on("geolocate",(function(e){var t,r;null===(r=(t=n.current.props).onGeolocate)||void 0===r||r.call(t,e)})),r.on("error",(function(e){var t,r;null===(r=(t=n.current.props).onError)||void 0===r||r.call(t,e)})),r.on("outofmaxbounds",(function(e){var t,r;null===(r=(t=n.current.props).onOutOfMaxBounds)||void 0===r||r.call(t,e)})),r.on("trackuserlocationstart",(function(e){var t,r;null===(r=(t=n.current.props).onTrackUserLocationStart)||void 0===r||r.call(t,e)})),r.on("trackuserlocationend",(function(e){var t,r;null===(r=(t=n.current.props).onTrackUserLocationEnd)||void 0===r||r.call(t,e)})),r}),{position:e.position});return n.current.props=e,(0,t.useImperativeHandle)(r,(function(){return{trigger:function(){return i.trigger()}}}),[]),(0,t.useEffect)((function(){yi(i._container,e.style)}),[e.style]),null}));xi.displayName="GeolocateControl";var wi=t.memo(xi);t.memo((function(e){var r=bi((function(t){return new t.mapLib.NavigationControl(e)}),{position:e.position});return(0,t.useEffect)((function(){yi(r._container,e.style)}),[e.style]),null}));function ki(e){var r=bi((function(t){return new t.mapLib.ScaleControl(e)}),{position:e.position});return r.options.unit===e.unit&&r.options.maxWidth===e.maxWidth||(r.options.maxWidth=e.maxWidth,r.setUnit(e.unit)),(0,t.useEffect)((function(){yi(r._container,e.style)}),[e.style]),null}ki.defaultProps={unit:"metric",maxWidth:100};t.memo(ki);var Ai=function(e){var r=e.setView,n=(0,t.useState)(),o=(0,i.Z)(n,2),a=o[0],s=o[1];return(0,t.useEffect)((function(){"geolocation"in navigator&&navigator.geolocation.getCurrentPosition((function(e){s(e.coords),console.log("current location",e.coords)}))}),[]),(0,jr.jsx)("div",{className:"central-inner-container",children:(0,jr.jsx)("div",{className:"map-view-container",children:a?(0,jr.jsxs)(jr.Fragment,{children:[(0,jr.jsx)("h1",{className:"subtitle-location",children:"do you want to add your location?"}),(0,jr.jsx)("div",{className:"map-container-flow",children:(0,jr.jsx)(mi,{mapboxAccessToken:"pk.eyJ1Ijoibm9hbWllMjIiLCJhIjoiY2xmMmoxZjYwMGowdjN5cG5vMXJzY2J4eCJ9.R1-JKFMkvmsuDf7Mk-CoNg",mapStyle:"mapbox://styles/mapbox/dark-v9",initialViewState:{longitude:null===a||void 0===a?void 0:a.longitude,latitude:null===a||void 0===a?void 0:a.latitude,zoom:10},children:(0,jr.jsx)(wi,{positionOptions:{enableHighAccuracy:!0},fitBoundsOptions:{maxZoom:12},trackUserLocation:!0,showAccuracyCircle:!0,showUserLocation:!0})})}),(0,jr.jsx)("div",{children:(0,jr.jsxs)("div",{className:"map-btns",children:[(0,jr.jsx)("button",{className:"btn btn-ghost big",onClick:function(){return r("visual")&&console.log(a)},children:"yes"}),(0,jr.jsx)("button",{className:"btn btn-ghost big",onClick:function(){return r("visual")},children:"no"})]})})]}):(0,jr.jsxs)("div",{class:"loader",children:[(0,jr.jsx)("div",{class:"wave"}),(0,jr.jsx)("div",{class:"wave"}),(0,jr.jsx)("div",{class:"wave"}),(0,jr.jsx)("div",{class:"wave"}),(0,jr.jsx)("div",{class:"wave"}),(0,jr.jsx)("div",{class:"wave"}),(0,jr.jsx)("div",{class:"wave"}),(0,jr.jsx)("div",{class:"wave"}),(0,jr.jsx)("div",{class:"wave"}),(0,jr.jsx)("div",{class:"wave"})]})})})},Ei=function(){var e,r=gr(),n=(0,t.useState)(""),o=(0,i.Z)(n,2),a=o[0],s=o[1],u=(0,t.useState)(null),c=(0,i.Z)(u,2),l=c[0],h=c[1];switch((0,t.useEffect)((function(){r.publicKey&&"map"!==a&&"visual"!==a&&s("recording")}),[r.publicKey,a]),a){case"recording":e=(0,jr.jsx)(Kr,{ear:Lr,onRecorded:function(e){h(e)},setView:s});break;case"map":e=(0,jr.jsx)(Ai,{blob:l,setView:s});break;case"visual":e=(0,jr.jsx)(Hn,{blob:l,setView:s});break;default:e=(0,jr.jsx)(Vr,{ear:Lr})}return(0,jr.jsxs)("div",{className:"grad",children:[(0,jr.jsx)(Jr,{setView:s}),r.publicKey?(0,jr.jsxs)("div",{className:"central-outer-container",children:[(0,jr.jsx)("div",{children:e}),(0,jr.jsx)("div",{children:!r.publicKey&&(0,jr.jsx)(qn,{})})]}):(0,jr.jsxs)("div",{className:"central-outer-container",children:[(0,jr.jsx)(Vr,{ear:Lr}),(0,jr.jsx)("div",{children:!r.publicKey&&(0,jr.jsx)(qn,{})})]}),(0,jr.jsx)(tn,{})]})};r(9752);var Si=function(){var r=e.Devnet,n=(0,t.useMemo)((function(){return(0,o.clusterApiUrl)(r)}),[r]),a=(0,t.useState)(!1),s=(0,i.Z)(a,2),u=(s[0],s[1],(0,t.useMemo)((function(){return[new j,new K,new H,new q({solNetwork:r}),new X,new me,new _e,new ve]}),[r]));return gr(),(0,jr.jsx)(xe,{endpoint:n,children:(0,jr.jsx)(br,{wallets:u,children:(0,jr.jsx)(Rr,{children:(0,jr.jsx)("div",{className:"App",children:(0,jr.jsx)(Ei,{})})})})})};window.Buffer=window.Buffer||on.Buffer,n.createRoot(document.getElementById("root")).render((0,jr.jsx)(Si,{}))}()}();
//# sourceMappingURL=main.295907cf.js.map